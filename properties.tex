\input{preamble}

% OK, start here.
%
\begin{document}

\title{Properties of schemes}


\maketitle

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we introduce some absolute properties of schemes.
A basic reference is \cite{EGA}.





\section{Integral, irreducible, and reduced schemes}
\label{section-integral}

\begin{definition}
\label{definition-integral}
Let $X$ be a scheme. We say $X$ is {\it integral} if for every affine open
$\text{Spec}(R) = U \subset X$ the ring $R$ is an integral domain.
\end{definition}

\begin{lemma}
\label{lemma-characterize-reduced}
Let $X$ be a scheme.
The following are equivalent.
\begin{enumerate}
\item The scheme $X$ is reduced, see
Schemes, Definition \ref{schemes-definition-reduced}.
\item There exists an affine open covering $X = \bigcup U_i$
such that each $\Gamma(U_i, \mathcal{O}_X)$ is reduced.
\item For every affine open $U \subset X$ the ring
$\mathcal{O}_X(U)$ is reduced.
\item For every open $U \subset X$ the ring $\mathcal{O}_X(U)$ is reduced.
\end{enumerate}
\end{lemma}

\begin{proof}
See Schemes, Lemmas \ref{schemes-lemma-reduced} and
\ref{schemes-lemma-affine-reduced}.
\end{proof}

\begin{lemma}
\label{lemma-characterize-integral}
A scheme $X$ is integral if and only if it is reduced and irreducible.
\end{lemma}

\begin{proof}
If $X$ is irreducible, then every affine open $\text{Spec}(R) = U \subset X$
is irreducible. If $X$ is reduced, then $R$ is reduced, by
Lemma \ref{lemma-characterize-reduced} above. Hence $R$ is reduced
and $(0)$ is a prime ideal, i.e., $R$ is an integral domain.

\medskip\noindent
If $X$ is integral, then for every affine open $\text{Spec}(R) = U \subset X$
the ring $R$ is reduced and hence $X$ is reduced by
Lemma \ref{lemma-characterize-reduced}. Moreover, every affine open
is irreducible. We will show that any two nonempty
affine opens $U, V$ of $X$ intersect,
which will imply that $X$ is irreducible. Namely, if $U \cap V$
is empty, then $U \cup V$ is an affine open of $X$, see
Schemes, Lemma \ref{schemes-lemma-disjoint-union-affines}.
But a disjoint union of nonempty affines is not irreducible,
a contradiction.
\end{proof}















\section{Types of schemes defined by properties of rings}
\label{section-properties-rings}

\noindent
In this section we study what properties of rings
allow one to define local properties of schemes.

\begin{definition}
\label{definition-property-local}
Let $P$ be a property of rings.
We say that $P$ is {\it local} if the following hold:
\begin{enumerate}
\item For any ring $R$, and any $f \in R$ we have
$P(R) \Rightarrow P(R_f)$.
\item For any ring $R$, and $f_i \in R$ such that
$(f_1, \ldots, f_n) = R$ then
$\forall i, P(R_{f_i}) \Rightarrow P(R)$.
\end{enumerate}
\end{definition}

\begin{definition}
\label{definition-locally-P}
Let $P$ be a property of rings. Let $X$ be a scheme.
We say $X$ {\it is locally $P$} if for any $x \in X$
there exists an affine open neighbourhood $U$ of $x$
in $X$ such that $\mathcal{O}_X(U)$ has property $P$.
\end{definition}

\noindent
This is only a good notion if the property is local.
Even if $P$ is a local property we will not
automatically use this definition to say that a scheme is
``locally $P$'' unless we also explicitly state the definition
elsewhere.

\begin{lemma}
\label{lemma-locally-P}
Let $X$ be a scheme. Let $P$ be a local property of rings.
The following are equivalent:
\begin{enumerate}
\item The scheme $X$ is locally $P$.
\item For every affine open $U \subset X$ the property
$P(\mathcal{O}_X(U))$ holds.
\item There exists an affine open covering $X = \bigcup U_i$ such that
each $\mathcal{O}_X(U_i)$ satisfies $P$.
\item There exists an open covering $X = \bigcup X_j$
such that each open subscheme $X_j$ is locally $P$.
\end{enumerate}
Moreover, if $X$ is locally $P$ then every open subscheme
is locally $P$.
\end{lemma}

\begin{proof}
Of course (1) $\Leftrightarrow$ (3) and (2) $\Rightarrow$ (1).
If (3) $\Rightarrow$ (2), then the final statement of the lemma
holds and it follows easily that (4) is also equivalent to (1).
Thus we show (3) $\Rightarrow$ (2).

\medskip\noindent
Let $X = \bigcup U_i$ be an affine open covering, say
$U_i = \text{Spec}(R_i)$. Assume $P(R_i)$.
Let $\text{Spec}(R) = U \subset X$ be an arbitrary affine open.
By Schemes, Lemma \ref{schemes-lemma-good-subcover}
there exists a standard covering of $U = \text{Spec}(R)$ by
standard opens $D(f_j)$ such that each ring $R_{f_j}$ is a
principal localization of one of the rings $R_i$. By
Definition \ref{definition-property-local} (1) we get $P(R_{f_j})$.
Whereupon $P(R)$ by Definition \ref{definition-property-local} (2).
\end{proof}

\noindent
Here is a sample application.

\begin{lemma}
\label{lemma-reduced-is-locally-reduced}
Let $X$ be a scheme. Then $X$ is reduced if and only if $X$ is
``locally reduced'' in the sense of Definition \ref{definition-locally-P}.
\end{lemma}

\begin{proof}
This is clear from Lemma \ref{lemma-characterize-reduced}.
\end{proof}

\begin{lemma}
\label{lemma-properties-local}
The following properties of a ring $R$ are local.
\begin{enumerate}
\item (Cohen-Macauley.)
The ring $R$ is Noetherian and CM, see
Algebra, Definition \ref{algebra-definition-ring-CM}.
\item (Regular.)
The ring $R$ is Noetherian and regular, see
Algebra, Definition \ref{algebra-definition-regular}.
\item (Absolutely Noetherian.)
The ring $R$ is of finite type over $Z$.
\item (Catenary.)
The ring $R$ is catenary, see
Algebra, Definition \ref{algebra-definition-catenary}.
\item (Universally Catenary.)
The ring $R$ is universally catenary, see
Algebra, Definition \ref{algebra-definition-universally-catenary}.
\item Add more here as needed.\footnote{But we only list those properties
here which we have not already dealt with separately somewhere else.}
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}















\section{Noetherian schemes}
\label{section-noetherian}

\begin{definition}
\label{definition-noetherian}
Let $X$ be a scheme.
\begin{enumerate}
\item We say $X$ is {\it locally Noetherian} if every
$x \in X$ has an affine open neighbourhood
$\text{Spec}(R) = U \subset X$ such that the ring $R$ is Noetherian.
\item We say $X$ is {\it Noetherian} if $X$ is Noetherian
and quasi-compact.
\end{enumerate}
\end{definition}

\noindent
Here is the standard result characterizing locally Noetherian schemes.

\begin{lemma}
\label{lemma-locally-Noetherian}
Let $X$ be a scheme. The following are equivalent:
\begin{enumerate}
\item The scheme $X$ is locally Noetherian.
\item For every affine open $U \subset X$ the ring $\mathcal{O}_X(U)$
is Noetherian.
\item There exists an affine open covering $X = \bigcup U_i$ such that
each $\mathcal{O}_X(U_i)$ is Noetherian.
\item There exists an open covering $X = \bigcup X_j$
such that each open subscheme $X_j$ is locally Noetherian.
\end{enumerate}
Moreover, if $X$ is locally Noetherian then every open subscheme
is locally Noetherian.
\end{lemma}

\begin{proof}
To show this it suffices to show that being Noetherian is a local
property of rings, see Lemma \ref{lemma-locally-P}.
Any localization of a Noetherian ring is Noetherian, see 
Algebra, Lemma \ref{algebra-lemma-Noetherian-permanence}.
By Algebra, Lemma \ref{algebra-lemma-cover} we see the second
property to Definition \ref{definition-property-local}.
\end{proof}

\begin{lemma}
\label{lemma-immersion-into-noetherian}
Any immersion $Z \to X$ with $X$ locally Noetherian is quasi-compact.
\end{lemma}

\begin{proof}
A closed immersion is clearly quasi-compact.
A composition of quasi-compact morphisms is quasi-compact,
see Topology, Lemma \ref{topology-lemma-composition-quasi-compact}.
Hence it suffices to show that an open immersion into
a locally Noetherian scheme is quasi-compact.
Using Schemes, Lemma \ref{schemes-lemma-quasi-compact-affine}
we reduce to the case where $X$ is affine.
Here we win because any open subset of the spectrum
of a Noetherian ring is quasi-compact (for example
combine Algebra, Lemma \ref{algebra-lemma-Noetherian-topology} and
Topology, Lemmas \ref{topology-lemma-Noetherian} and
\ref{topology-lemma-constructible-Noetherian-space}).
\end{proof}

\begin{lemma}
\label{lemma-locally-Noetherian-quasi-separated}
A locally Noetherian scheme is quasi-separated.
\end{lemma}

\begin{proof}
By Schemes, Lemma \ref{schemes-lemma-characterize-quasi-separated}
we have to show that the intersection $U \cap V$ of two
affine opens of $X$ is quasi-compact. This follows from
Lemma \ref{lemma-immersion-into-noetherian} above on
considering the open immersion $U \cap V \to U$ for example.
(But really it is just because any open of the spectrum of a
Noetherian ring is quasi-compact.)
\end{proof}








\section{Jacobson schemes}
\label{section-jacobson}

\begin{definition}
\label{definition-jacobson}
A scheme $S$ is said to be {\it Jacobson} if its underlying topological
space is Jacobson, see Topology, Section \ref{topology-section-space-jacobson}.
\end{definition}

\noindent
Recall that a ring $R$ is Jacobson if every radical ideal of $R$
is the intersection of maximal ideals, see Algebra Definition
\ref{algebra-definition-ring-jacobson}.

\begin{lemma}
\label{lemma-affine-jacobson}
An affine scheme $\text{Spec}(R)$ is Jacobson if and only if
the ring $R$ is Jacobson.
\end{lemma}

\begin{proof}
This is Algebra, Lemma \ref{algebra-lemma-jacobson}.
\end{proof}

\noindent
Here is the standard result characterizing Jacobson schemes.
Intuitively it claims that Jacobson $\Leftrightarrow$ locally Jacobson.

\begin{lemma}
\label{lemma-locally-jacobson}
Let $X$ be a scheme. The following are equivalent:
\begin{enumerate}
\item The scheme $X$ is Jacobson.
\item The scheme $X$ is ``locally Jacobson'' in the sense of
Definition \ref{definition-locally-P}.
\item For every affine open $U \subset X$ the ring $\mathcal{O}_X(U)$
is Jacobson.
\item There exists an affine open covering $X = \bigcup U_i$ such that
each $\mathcal{O}_X(U_i)$ is Jacobson.
\item There exists an open covering $X = \bigcup X_j$
such that each open subscheme $X_j$ is Jacobson.
\end{enumerate}
Moreover, if $X$ is Jacobson then every open subscheme
is Jacobson.
\end{lemma}

\begin{proof}
The final assertion of the lemma holds by
Topology, Lemma \ref{topology-lemma-jacobson-inherited}.
The equivalence of (5) and (1) is
Topology, Lemma \ref{topology-lemma-jacobson-local}.
Hence, using Lemma \ref{lemma-affine-jacobson},
we see that (1) $\Leftrightarrow$ (2).
To finish proving the lemma it suffices to show that ``Jacobson''
is a local property of rings, see Lemma \ref{lemma-locally-P}.
Any localization of a Jacobson ring at an element is Jacobson, see 
Algebra, Lemma \ref{algebra-lemma-Jacobson-invert-element}.
Suppose $R$ is a ring, $f_1, \ldots, f_n \in R$ generate the unit
ideal and each $R_{f_i}$ is Jacobson. Then we see that
$\text{Spec}(R) = \bigcup D(f_i)$ is a union of open subsets
which are all Jacobson, and hence $\text{Spec}(R)$ is Jacobson
by Topology, Lemma \ref{topology-lemma-jacobson-local} again.
This proves the second property of Definition \ref{definition-property-local}.
\end{proof}













\section{Quasi-affine schemes}
\label{section-quasi-affine}

\begin{definition}
\label{definition-quasi-affine}
A scheme $X$ is called {\it quasi-affine} if it is quasi-compact
and isomorphic to an open subscheme of an affine scheme.
\end{definition}

\begin{lemma}
\label{lemma-invert-f-sections}
Let $X$ be a scheme. Let $f \in \Gamma(X, \mathcal{O}_X)$.
Denote $X_f$ the maximal open subscheme of $X$ where $f$ is invertible, see
Schemes, Lemma \ref{schemes-lemma-f-open} or
Modules, Lemma \ref{modules-lemma-s-open}.
If $X$ is quasi-compact and quasi-separated, the canonical map
$$
\Gamma(X, \mathcal{O}_X)_f \longrightarrow \Gamma(X_f, \mathcal{O}_X)
$$
is an isomorphism. Moreover, if $\mathcal{F}$ is a quasi-coherent
sheaf of $\mathcal{O}_X$-modules the map
$$
\Gamma(X, \mathcal{F})_f \longrightarrow \Gamma(X_f, \mathcal{F})
$$
is an isomorphism.
\end{lemma}

\begin{proof}
Write $R = \Gamma(X, \mathcal{O}_X)$.
Consider the canonical morphism
$$
\varphi : X \longrightarrow \text{Spec}(R)
$$
of schemes, see
Scheme, Lemma \ref{schemes-lemma-morphism-into-affine}.
Then the inverse image of the standard open $D(f)$ on the
right hand side is $X_f$ on the left hand side.
Moreover, since $X$ is assumed quasi-compact and quasi-separated
the morphism $\varphi$ is quasi-compact and quasi-separated,
see Schemes, Lemma \ref{schemes-lemma-quasi-compact-affine} and
\ref{schemes-lemma-compose-after-separated}. Hence by
Schemes, Lemma \ref{schemes-lemma-push-forward-quasi-coherent}
we see that $\varphi_*\mathcal{F}$ is quasi-coherent.
Hence we see that $\varphi_*\mathcal{F} = \widetilde M$
with $M = \Gamma(X, \mathcal{F})$ as an $R$-module.
Thus we see that
$$
\Gamma(X_f, \mathcal{F}) =
\Gamma(D(f), \varphi_*\mathcal{F}) = 
\Gamma(D(f), \widetilde M) = M_f
$$
which is exactly the content of the lemma. The case of
$\mathcal{F} = \mathcal{O}_X$ will given the first displayed isomorphism
of the lemma.
\end{proof}

\begin{lemma}
\label{lemma-quasi-affine}
Let $X$ be a scheme. Then $X$ is quasi-affine if and only if
the canonical morphism
$$
X \longrightarrow \text{Spec}(\Gamma(X, \mathcal{O}_X))
$$
from Schemes, Lemma \ref{schemes-lemma-morphism-into-affine} is
a quasi-compact open immersion.
\end{lemma}

\begin{proof}
If the displayed morphism is a quasi-compact open immersion then
$X$ is ismorphic to a quasi-compact open subscheme of
$\text{Spec}(\Gamma(X, \mathcal{O}_X))$ and clearly $X$ is quasi-affine.

\medskip\noindent
Assume $X$ is quasi-affine, say $X \subset \text{Spec}(R)$ is
quasi-compact open. This in particular implies that $X$ is
separated, see
Schemes, Lemma \ref{schemes-lemma-subscheme-of-separated-scheme}.
Let $A = \Gamma(X, \mathcal{O}_X)$.
Consider the ring map $R \to A$ coming from
$R = \Gamma(\text{Spec}(R), \mathcal{O}_{\text{Spec}(R)})$
and the restriction mapping of the sheaf $\mathcal{O}_{\text{Spec}(R)}$.
By Schemes, Lemma \ref{schemes-lemma-morphism-into-affine}
we obtain a factorization:
$$
X \longrightarrow
\text{Spec}(A) \longrightarrow
\text{Spec}(R)
$$
of the inclusion morphism. Let $x \in X$. Choose $f \in R$ such that
$x \in D(f)$ and $D(f) \subset X$. Denote $a \in A$ the image of $f$
in $A$. The open $X_a$ of Lemma \ref{lemma-invert-f-sections}
above is equal to $D(f) \subset X$ and hence $A_a \cong R_f$ by the
conclusion of that lemma.
Hence $D(f) \to \text{Spec}(A)$ is an isomorphism onto a standard affine open
of $\text{Spec}(A)$. Since $X$ can be covered by such affine opens
$D(f)$ we win.
\end{proof}









\section{Extending quasi-coherent sheaves}
\label{section-extending-quasi-coherent-sheaves}



\begin{lemma}
\label{lemma-finite-type-module}
Let $X = \text{Spec}(R)$ be an affine scheme.
The quasi-coherent sheaf of $\mathcal{O}_X$-modules
$\widetilde M$ is a finite type $\mathcal{O}_X$-module
if and only if $M$ is a finite $R$-module.
\end{lemma}

\begin{proof}
Assume $\widetilde M$ is a finite type $\mathcal{O}_X$-module.
This means there exists an open covering of $X$ such that
$\widetilde M$ restricted to the members of this covering is
globally generated by finitely many sections.
Thus there also exists a standard open covering
$X = \bigcup_{i = 1, \ldots, n} D(f_i)$ such that $\widetilde M|_{D(f_i)}$
is generated by finitely many sections. Thus $M_{f_i}$ is finitely
generated for each $i$. Hence we conclude by
Algebra, Lemma \ref{algebra-lemma-cover}.
\end{proof}

\begin{lemma}
\label{lemma-extend-trivial}
Let $j : U \to X$ be a quasi-compact open immersion of schemes.
\begin{enumerate}
\item Any quasi-coherent sheaf on $U$ extends to a quasi-coherent
sheaf on $X$.
\item Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$.
Let $\mathcal{G} \subset \mathcal{F}|_U$ be a quasi-coherent
subsheaf. There exists a quasi-coherent subsheaf $\mathcal{H}$ of
$\mathcal{F}$ such that $\mathcal{H}|_U = \mathcal{G}$
as subsheaves of $\mathcal{F}|_U$.
\end{enumerate}
\end{lemma}

\begin{proof}
An immersion is separated
(see Schemes, Lemma \ref{schemes-lemma-immersions-monomorphisms})
and $j$ is quasi-compact by assumption.
Hence for any quasi-coherent sheaf $\mathcal{G}$ on $U$ the sheaf
$j_*\mathcal{G}$ is an extension to $X$. See
Schemes, Lemma \ref{schemes-lemma-push-forward-quasi-coherent} and
Sheaves, Section \ref{sheaves-section-open-immersions}.

\medskip\noindent
Assume $\mathcal{F}$, $\mathcal{G}$ are as in (2).
Then $j_*\mathcal{G}$ is a quasi-coherent sheaf on $X$ (see above).
It is a subsheaf of $j_*j^*\mathcal{F}$.
Hence the kernel
$$
\mathcal{H} =
\text{ker}(\mathcal{F} \oplus j_* \mathcal{G}
\longrightarrow j_*j^*\mathcal{F})
$$
is quasi-coherent as well, see
Schemes, Section \ref{schemes-section-quasi-coherent}.
It is formal to check that $\mathcal{H} \subset \mathcal{F}$ and that
$\mathcal{H}|_U = \mathcal{G}$ (using the material in
Sheaves, Section \ref{sheaves-section-open-immersions} again).
\end{proof}

\begin{lemma}
\label{lemma-extend}
Let $X$ be a quasi-compact and quasi-separated scheme.
Let $U \subset X$ be a quasi-compact open.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $\mathcal{G} \subset \mathcal{F}|_U$ be a quasi-coherent
$\mathcal{O}_U$-submodule which is of finite type. Then
there exists a quasi-coherent submodule $\mathcal{G}' \subset \mathcal{F}$
which is of finite type such that $\mathcal{G}'|_U = \mathcal{G}$.
\end{lemma}

\begin{proof}
Let $n$ be the minimal number of affine opens $U_i \subset X$,
$i = 1, \ldots , n$ such that $X = U \cup \bigcup U_i$.
(Here we use that $X$ is quasi-compact.) Suppose
we can prove the lemma for the case $n = 1$. Then we can successively
extend $\mathcal{G}$
to a $\mathcal{G}_1$ over $U \cup U_1$
to a $\mathcal{G}_2$ over $U \cup U_1 \cup U_2$
to a $\mathcal{G}_3$ over $U \cup U_1 \cup U_2 \cup U_3$,
and so on.
Thus we reduce to the case $n = 1$.

\medskip\noindent
Thus we may assume that $X = U \cup V$ with $V$ affine.
Since $X$ is quasi-separated and $U$ quasi-compact,
we see that $U \cap V \subset V$ is quasi-compact.
It suffices to prove the lemma for
the system $(V, U \cap V, \mathcal{F}|_V, \mathcal{G}|_{U \cap V})$
since we can glue the resulting sheaf $\mathcal{G}'$ over $V$
to the given sheaf $\mathcal{G}$ over $U$ along the common value
over $U \cap V$.
Thus we reduce to the case where $X$ is affine.

\medskip\noindent
Assume $X = \text{Spec}(R)$. Write $\mathcal{F} = \widetilde M$
for some $R$-module $M$. By Lemma \ref{lemma-extend-trivial} above we may
find a quasi-coherent subsheaf $\mathcal{H} \subset \mathcal{F}$
which restricts to $\mathcal{G}$ over $U$.
Write $\mathcal{H} = \widetilde N$ for some $R$-module $N$.
For every $u \in U$ there exists an $f \in R$ such that
$u \in D(f) \subset U$ and such that $N_f$ is finitely generated,
see Lemma \ref{lemma-finite-type-module}.
Since $U$ is quasi-compact we can cover it by finitely
many $D(f_i)$ such that $N_{f_i}$ is generated by
finitely many elements, say $x_{i, 1}/f_i^N, \ldots, x_{i, r_i}/f_i^N$.
Let $N' \subset N$ be the submodule generated by the elements
$x_{i, j}$. Then the subsheaf
$\mathcal{G} := \widetilde{N'} \subset \mathcal{H} \subset \mathcal{F}$
works.
\end{proof}












\section{Ample invertible sheaves}
\label{section-ample}

\noindent
Recall from Modules, Lemma \ref{modules-lemma-s-open}
that given an invertible sheaf $\mathcal{L}$ on a locally ringed
space $X$, and given a global section $s$ of $\mathcal{L}$
the set $X_s = \{x \in X \mid s \not \in \mathfrak m_x\mathcal{L}_x\}$
is open. A general remark is that
$X_s \cap X_{s'} = X_{ss'}$, where $ss'$ denote
the section $s \otimes s' \in \Gamma(X, \mathcal{L}\otimes \mathcal{L}')$.

\begin{definition}
\label{definition-ample}
Let $X$ be a scheme.
Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
We say {\it $\mathcal{L}$ is ample} if
\begin{enumerate}
\item $X$ is quasi-compact, and
\item for every $x \in X$ there exists an $n \geq 1$
and $s \in \Gamma(X, \mathcal{L}^{\otimes n})$ such
that $x \in X_s$ and $X_s$ is affine.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-ample-power-ample}
Let $X$ be a scheme. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Let $n \geq 1$. Then $\mathcal{L}$ is ample if and only if
$\mathcal{L}^{\otimes n}$ is ample.
\end{lemma}

\begin{proof}
This follows from the fact that $X_{s^n} = X_s$.
\end{proof}

\begin{lemma}
\label{lemma-affine-cap-s-open}
Let $X$ be a scheme. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Let $s \in \Gamma(X, \mathcal{L})$. For any affine $U \subset X$
the intersection $U \cap X_s$ is affine.
\end{lemma}

\begin{proof}
This translates into the following algebra problem.
Let $R$ be a ring. Let $N$ be an invertible $R$-module
(i.e., locally free of rank 1). Let $s \in N$ be an element.
Then $U = \{\mathfrak p \mid s \not \in \mathfrak p N\}$ is
an affine open subset of $\text{Spec}(R)$. This you can see
as follows. Think of $s$ as an $R$-module map $R \to N$.
This gives rise to $R$-module maps $N^{\otimes k} \to N^{\otimes k + 1}$.
Consider
$$
R' = \text{colim}_n\ N^{\otimes n}
$$
with transition maps as above. Define an $R$-algebra structure on $R'$ by
the rule $x \cdot y = x \otimes y \in N^{\otimes n + m}$
if $x \in N^{\otimes n}$ and $y \in N^{\otimes m}$. We claim that
$\text{Spec}(R') \to \text{Spec}(R)$ is an open immersion with
image $U$.

\medskip\noindent
To prove this is a local question on $\text{Spec}(R)$.
Let $\mathfrak p \in \text{Spec}(R)$. Pick $f \in R$,
$f \not \in \mathfrak p$ such that $N_f \cong R_f$ as a module.
Replacing $R$ by $R_f$, $N$ by $N_f$ and $R'$ by
$R'_f = \text{colim} N_f^{\otimes n}$ we may assume that $N \cong R$.
Say $N = R$. In this case $s$ is an element of $R$ and it is
easy to see that $R' \cong R_s$. Thus the lemma follows.
\end{proof}

\noindent
Recall that given a scheme $X$ and an invertible sheaf $\mathcal{L}$
on $X$ we get a graded ring
$\Gamma_*(X, \mathcal{L}) =
\bigoplus_{n \geq 0} \Gamma(X, \mathcal{L}^{\otimes n})$,
see Modules, Definition \ref{modules-definition-gamma-star}.
Also, given a sheaf of $\mathcal{O}_X$-modules we have the
graded $\Gamma_*(X, \mathcal{L})$-module
$\Gamma_*(X, \mathcal{F}) = \Gamma_*(X, \mathcal{L}, \mathcal{F})$.

\begin{lemma}
\label{lemma-invert-s-sections}
Let $X$ be a scheme. Let $\mathcal{L}$ be an invertible sheaf on $X$.
Let $s \in \Gamma(X, \mathcal{L})$.
If $X$ is quasi-compact and quasi-separated, the canonical map
$$
\Gamma_*(X, \mathcal{L})_{(s)}
\longrightarrow
\Gamma(X_s, \mathcal{O})
$$
which maps $a/s^n$ to $a \otimes s^{-n}$ is an isomorphism.
Moreover, if $\mathcal{F}$ is a quasi-coherent $\mathcal{O}_X$-module
then the map
$$
\Gamma_*(X, \mathcal{L}, \mathcal{F})_{(s)}
\longrightarrow
\Gamma(X_s, \mathcal{F})
$$
is an isomorphism.
\end{lemma}

\begin{proof}
Consider the scheme
$$
\pi :
L^* = \underline{\text{Spec}}_X\left(
\bigoplus\nolimits_{n \in \mathbf{Z}} \mathcal{L}^{\otimes n}
\right)
\longrightarrow
X
$$
see Constructions, Section \ref{constructions-section-spec}.
Since the inverse image $\pi^{-1}(U)$ of every affine open
$U \subset X$ is affine (see
Constructions, Lemma \ref{constructions-lemma-spec-properties}),
it follows that $L^*$ quasi-compact and separated,
since $X$ is assumed quasi-compact and separated (use 
Schemes, Lemma \ref{schemes-lemma-characterize-quasi-separated}).
Note that $s$ gives rise to an element $f \in \Gamma(L^*, \mathcal{O})$, via
$\pi_*\mathcal{O}_{L^*} =
\bigoplus_{n \in \mathbf{Z}} \mathcal{L}^{\otimes n}$.
Note that $(L^*)_f = \pi^{-1}(X_s)$. Hence we have
\begin{eqnarray*}
(\bigoplus\nolimits_{n \in \mathbf{Z}} \Gamma(X, \mathcal{L}^{\otimes n}))_s
& = &
\Gamma(L^*, \mathcal{O}_{L^*})_f \\
& = &
\Gamma((L^*)_f, \mathcal{O}_{L^*}) \\
& = &
\bigoplus\nolimits_{n \in \mathbf{Z}} \Gamma(X_s, \mathcal{L}^{\otimes n})
\end{eqnarray*}
where the middle ``$=$'' is Lemma \ref{lemma-invert-f-sections}.
The first statement of the lemma follows from this equality by looking at
degree zero terms. The second statement follows on considering
the sheaf of $\mathcal{O}_{L^*}$-modules $\pi^*\mathcal{F}$
using that
$\pi_*\pi^*\mathcal{F} = \bigoplus_{n \in \mathbf{Z}}
\mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{L}^{\otimes n}$.
\end{proof}

\begin{lemma}
\label{lemma-affine-s-opens}
Let $X$ be a scheme. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Assume the open sets $X_s$, where $s \in \Gamma(X, \mathcal{L}^{\otimes n})$
and $n \geq 1$, form a basis for the topology on $X$.
Then among those opens, the open sets $X_s$ which are affine
form a basis for the topology on $X$.
\end{lemma}

\begin{proof}
Let $x \in X$. Choose an affine open neighbourhood
$\text{Spec}(R) = U \subset X$ of $x$.
By assumption, there exists
a $n \geq 1$ and a $s \in \Gamma(X, \mathcal{L}^{\otimes n})$
such that $X_s \subset U$. By Lemma \ref{lemma-affine-cap-s-open} above
the intersection $X_s = U \cap X_s$ is affine.
Since $U$ can be chosen arbitrarily small we win.
\end{proof}

\begin{lemma}
\label{lemma-affine-s-opens-cover-quasi-separated}
Let $X$ be a scheme. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Assume for every point $x$ of $X$ there exists $n \geq 1$ and
$s \in \Gamma(X, \mathcal{L}^{\otimes n})$ such that
$x \in X_s$ and $X_s$ is affine. Then $X$ is quasi-separated.
\end{lemma}

\begin{proof}
By assumption we can find a covering of $X$ by affine opens of the form $X_s$.
By Schemes, Lemma \ref{schemes-lemma-characterize-quasi-separated}
it suffices to show that $X_s \cap X_{s'}$ is quasi-compact
whenever $X_s$ is affine. This is true by Lemma \ref{lemma-affine-cap-s-open}.
\end{proof}

\begin{lemma}
\label{lemma-map-into-proj}
Let $X$ be a scheme. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Set $S = \Gamma_*(X, \mathcal{L})$ as a graded ring.
If every point of $X$ is contained in one of the
open subschemes $X_s$, for some $s \in S_{+}$ homogeneous, then
there is a canonical morphism of schemes
$$
f : X \longrightarrow Y = \text{Proj}(S),
$$
to the homogeneous spectrum of $S$ (see
Constructions, Section \ref{constructions-section-proj}).
This morphism has the following properties
\begin{enumerate}
\item $f^{-1}(D_{+}(s)) = X_s$ for any $s \in S_{+}$ homogeneous,
\item there are isomorphisms $f^*\mathcal{O}_Y(n) \to \mathcal{L}^{\otimes n}$
compatible with multiplication maps, see Constructions,
Equation (\ref{constructions-equation-multiply}), and
\item the maps
$S_n \to
\Gamma(Y, \mathcal{O}_Y(n)) \to
\Gamma(X, \mathcal{L}^{\otimes n})$
are equal to the identity maps.
\end{enumerate}
\end{lemma}

\begin{proof}
For any integer $d \geq 1$ set $X_d = \bigcup_{s \in S_d} X_s$.
By assumption we have $X = \bigcup_{d \geq 1} X_d$.
Clearly we have a graded ring map
$\psi^d : S^{(d)} \to \Gamma_*(X_d, \mathcal{L}^{\otimes d})$ as
in Constructions, Section \ref{constructions-section-morphisms-proj}.
This corresponds to a morphism of schemes $X_d \to \text{Proj}(S)$.
Clearly, the morphisms $X_d \to \text{Proj}(S)$ agree on the
overlaps $X_d \cap X_{d'}$ as discussed in the material preceding
Constructions, Lemma \ref{constructions-lemma-proj-functor}.
Hence we get the morphism as desired.
\end{proof}

\begin{lemma}
\label{lemma-map-into-proj-quasi-compact}
Let $X$ be a scheme. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Set $S = \Gamma_*(X, \mathcal{L})$.
Assume (a) every point of $X$ is contained in one of the
open subschemes $X_s$, for some $s \in S_{+}$ homogeneous, 
and (b) $X$ is quasi-compact. Then the canonical morphism of schemes
$f : X \longrightarrow \text{Proj}(S)$ of Lemma \ref{lemma-map-into-proj}
above is quasi-compact.
\end{lemma}

\begin{proof}
It suffices to show that $f^{-1}(D_{+}(s))$ is quasi-compact
for any $s \in S_{+}$ homogeneous. Write
$X = \bigcup_{i = 1, \ldots, n} X_i$ as a finite union of
affine opens. By Lemma \ref{lemma-affine-cap-s-open} each intersection 
$X_s \cap X_i$ is affine. Hence $X_s = \bigcup_{i = 1, \ldots, n} X_s \cap X_i$
is quasi-compact.
\end{proof}

\begin{lemma}
\label{lemma-ample-immersion-into-proj}
Let $X$ be a scheme. Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
Set $S = \Gamma_*(X, \mathcal{L})$.
Assume $\mathcal{L}$ is ample. Then the canonical morphism of schemes
$f : X \longrightarrow \text{Proj}(S)$ of Lemma \ref{lemma-map-into-proj}
is an open immersion.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-affine-s-opens-cover-quasi-separated} we see
that $X$ is quasi-separated. Choose finitely many
$s_1, \ldots, s_n \in S_{+}$ homogeneous
such that $X_{s_i}$ are affine, and $X = \bigcup X_{s_i}$.
Say $s_i$ has degree $d_i$. The inverse image of
$D_{+}(s_i)$ under $f$ is $X_{s_i}$, see Lemma \ref{lemma-map-into-proj}.
By Lemma \ref{lemma-invert-s-sections} the ring map
$$
(S^{(d_i)})_{(s_i)} = \Gamma(D_{+}(s_i), \mathcal{O}_{\text{Proj}(S)})
\longrightarrow
\Gamma(X_{s_i}, \mathcal{O}_X)
$$
is an isomorphism. Hence $f$ induces an isomorphism
$X_{s_i} \to D_{+}(s_i)$. Thus $f$ is an isomorphism of $X$ onto the open
subscheme $\bigcup_{i = 1, \ldots, n} D_{+}(s_i)$ of $\text{Proj}(S)$.
\end{proof}

\begin{lemma}
\label{lemma-open-in-proj-ample}
Let $X$ be a scheme.
Let $S$ be a graded ring. Assume $X$ is quasi-compact,
and assume there exists an open immersion
$$
j : X \longrightarrow Y = \text{Proj}(S).
$$
Then $j^*\mathcal{O}_Y(d)$ is ample for some $d > 0$.
\end{lemma}

\begin{proof}
This is Constructions, Lemma \ref{constructions-lemma-ample-on-proj}.
\end{proof}

\begin{proposition}
\label{proposition-characterize-ample}
Let $X$ be a quasi-compact scheme.
Let $\mathcal{L}$ be an invertible sheaf on $X$.
Set $S = \Gamma_*(X, \mathcal{L})$.
The following are equivalent:
\begin{enumerate}
\item
\label{item-ample}
$\mathcal{L}$ is ample,
\item
\label{item-immersion}
the open sets $X_s$, with $s \in S_{+}$ homogeneous,
cover $X$ and the associated morphism $X \to \text{Proj}(S)$
is an open immersion,
\item
\label{item-s-basis}
the open sets $X_s$, with $s \in S_{+}$ homogeneous,
form a basis for the topology of $X$,
\item
\label{item-s-affine-basis}
the open sets $X_s$, with $s \in S_{+}$ homogeneous,
which are affine form a basis for the topology of $X$,
\item
\label{item-qc-gg}
for every quasi-coherent sheaf $\mathcal{F}$ on $X$
the sum of the images of the canonical maps
$$
\Gamma(X, \mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{L}^{\otimes n})
\otimes_{\mathbf{Z}} \mathcal{L}^{\otimes -n}
\longrightarrow
\mathcal{F}
$$
with $n \geq 1$ equals $\mathcal{F}$.
\item
\label{item-qc-i-gg}
same property as (\ref{item-qc-gg}) with $\mathcal{F}$
ranging over all quasi-coherent sheaves of ideals.
If $X$ is quasi-separated as well as quasi-compact then
these conditions are also equivalent to
\item
\label{item-c-gg}
$X$ is quasi-separated and
for every quasi-coherent sheaf $\mathcal{F}$ of finite type on $X$
there exists an integer $n_0$ such that
$\mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{L}^{\otimes n}$
is globally generated for all $n \geq n_0$,
\item
\label{item-c-q}
$X$ is quasi-separated and
for every quasi-coherent sheaf $\mathcal{F}$ of finite type on $X$
there exist integers $n > 0$, $k \geq 0$ such that
$\mathcal{F}$ is a quotient of a direct sum of $k$ copies of
$\mathcal{L}^{\otimes - n}$,
\item
\label{item-c-i-q}
same as in (\ref{item-c-q}) with $\mathcal{F}$ ranging over all
sheaves of ideals of finite type on $X$.
\end{enumerate}
\end{proposition}

\begin{proof}
Lemma \ref{lemma-ample-immersion-into-proj} is
(\ref{item-ample}) $\Rightarrow$ (\ref{item-immersion}).
Lemmas \ref{lemma-ample-power-ample} and \ref{lemma-open-in-proj-ample}
provide the implication
(\ref{item-ample}) $\Leftarrow$ (\ref{item-immersion}).
The implications (\ref{item-immersion}) $\Rightarrow$
(\ref{item-s-affine-basis}) $\Rightarrow$ (\ref{item-s-basis})
are clear from Constructions, Section \ref{constructions-section-proj}.
Lemma \ref{lemma-affine-s-opens} is
(\ref{item-s-basis}) $\Rightarrow$ (\ref{item-ample}).
Thus we see that the first 4 conditions are all equivalent.

\medskip\noindent
Assume the equivalent conditions (1) -- (4).
Note that in particular $X$ is separated (as an open
subscheme of the separated scheme $\text{Proj}(S)$).
Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$.
Choose $s \in S_{+}$ homogeneous such that $X_s$ is affine.
We claim that any section $m \in \Gamma(X_s, \mathcal{F})$
is in the image of one of the maps displayed in
(\ref{item-qc-gg}) above. This will imply (\ref{item-qc-gg})
since these affines $X_s$ cover $X$.
Namely, by Lemma \ref{lemma-invert-s-sections} we may write
$m$ as the image of $m' \otimes s^{-n}$ for some
$n \geq 1$, some
$m' \in \Gamma(X, \mathcal{F} \otimes \mathcal{L}^{\otimes n})$.
This proves the claim.

\medskip\noindent
Clearly (\ref{item-qc-gg}) $\Rightarrow$ (\ref{item-qc-i-gg}).
Let us assume (\ref{item-qc-i-gg}) and prove $\mathcal{L}$ is
ample. Pick $x \in X$. Let $U \subset X$ be an affine open
which contains $x$. Set $Z = X \setminus U$. We may think of
$Z$ as a reduced closed subscheme, see
Schemes, Section \ref{schemes-section-reduced}.
Let $\mathcal{I} \subset \mathcal{O}_X$ be the quasi-coherent
sheaf of ideals corresponding to the closed subscheme $Z$.
By assumption (\ref{item-qc-i-gg}), there exists an $n \geq 1$ and a section
$s \in \Gamma(X, \mathcal{I} \otimes \mathcal{L}^{\otimes n})$
such that $s$ does not vanish at $x$ (more precisely such that
$s \not \in \mathfrak m_x \mathcal{I}_x \otimes \mathcal{L}_x^{\otimes n}$).
We may think of $s$ as a section of $\mathcal{L}^{\otimes n}$.
Since it clearly vanishes along $Z$ we see that
$X_s \subset U$. Hence $X_s$ is affine, see
Lemma \ref{lemma-affine-cap-s-open}.
This proves that $\mathcal{L}$ is ample.
At this point we have proved that (1) -- (6) are equivalent.

\medskip\noindent
Assume the equivalent conditions (1) -- (6).
By (1) we can find elements $s_i \in S_{d_i}$ with $d_i \geq 1$
such that $X = \bigcup_{i = 1, \ldots, n} X_{s_i}$.
Set $d = d_1\ldots d_n$. It follows that $\mathcal{L}^{\otimes d}$
is globally generated by $s_1^{d/d_1}, \ldots, s_n^{d/d_n}$.
Fix a $j \in \{0, \ldots, d - 1\}$. For any point $x \in X$ there
exists an $n \geq 1$ and a gloabl section $s$ of $\mathcal{L}^{j + dn}$
which does not vanish at $x$, as follows from (\ref{item-qc-gg}) applied
to $\mathcal{F} = \mathcal{L}^{\otimes j}$ and ample invertible
sheaf $\mathcal{L}^{\otimes d}$. Since $X$ is quasi-compact there
we may find a finite list of integers $n_{i}$ and global sections
$s_i$ of $\mathcal{L}^{j + dn_{i}}$ which do not vanish at any point of $X$.
Since $\mathcal{L}^d$ is globally generated this means that
$\mathcal{L}^{j + dn}$ is globally generated where $n = \max\{n_i\}$.
Since we proved this for every congruence class mod $d$ we
conclude that there exists an $n_0 = n_0(\mathcal{L})$ such that
$\mathcal{L}^{\otimes n}$ is globally generated for all $n \geq n_0$.

\medskip\noindent
To be continued...
\end{proof}
















\section{Miscellaneous}
\label{section-misc}

\begin{lemma}
\label{lemma-maximal-points-affine}
Let $X$ be a quasi-separated scheme.
Let $Z_1, \ldots, Z_n$ be pairwise distinct irreducible components of $X$,
see Topology, Section \ref{topology-section-irreducible-components}.
Let $\eta_i \in Z_i$ be their generic points, see
Schemes, Lemma \ref{schemes-lemma-scheme-sober}.
There exist affine open neighbourhoods $\eta_i \in U_i$
such that $U_i \cap U_j = \emptyset$ for all $i \not = j$.
In particular, $U = U_1 \cup \ldots \cup U_n$ is an affine
open containing all of the points $\eta_1, \ldots, \eta_n$.
\end{lemma}

\begin{proof}
Let $V_i$ be any affine open containing $\eta_i$
and disjoint from the closed set $Z_1 \cup \ldots \hat Z_i \ldots \cup Z_n$.
Since $X$ is quasi-separated for each $i$ the union
$W_i = \bigcup_{j, j \not = i} V_i \cap V_j$ is a quasi-compact
open of $V_i$ not containing $\eta_i$. 
We can find open neighbourhoods $U_i \subset V_i$
containing $\eta_i$ and disjoint from $W_i$ by
Algebra, Lemma \ref{algebra-lemma-standard-open-containing-maximal-point}.
Finally, $U$ is affine since it is the spectrum of
the ring $R_1 \times \ldots \times R_n$ where $R_i = \mathcal{O}_X(U_i)$,
see Schemes, Lemma \ref{schemes-lemma-disjoint-union-affines}.
\end{proof}

\begin{remark}
\label{remark-maximal-points-affine}
Lemma \ref{lemma-maximal-points-affine} above is false if $X$
is not quasi-separated. Here is an example. Take
$R = \mathbf{Q}[x, y_1, y_2, \ldots]/((x-i)y_i)$.
Consider the minimal prime ideal $\mathfrak p = (y_1, y_2, \ldots)$
of $R$. Glue two copies of $\text{Spec}(R)$ along the
(not quasi-compact) open $\text{Spec}(R) \setminus V(\mathfrak p)$
to get a scheme $X$ (glueing as in
Schemes, Example \ref{schemes-example-affine-space-zero-doubled}).
Then the two maximal points of $X$ corresponding to $\mathfrak p$
are not contained in a common affine open. The reason is
that any open of $\text{Spec}(R)$ containing $\mathfrak p$
contains infinitely many of the ``lines'' $x = i$, $y_j = 0$,
$j \not = i$ with parameter $y_i$. Details omitted.
\end{remark}






\input{chapters}

\bibliography{my}
\bibliographystyle{alpha}

\end{document}
