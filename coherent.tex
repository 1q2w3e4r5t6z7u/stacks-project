\input{preamble}

% OK, start here.
%
\begin{document}

\title{Coherent Cohomology}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
The title of this chapter is a bit of a lie because we
will first prove a number of results on the cohomology of quasi-coherent
sheaves. Having done this we wil elaborate on cohomology of
coherent sheaves in the Noetherian setting.
A fundamental reference is \cite{EGA}.



\section{Cech cohomology of quasi-coherent sheaves}
\label{section-cech-quasi-coherent}

\noindent
Let $X$ be a scheme.
Let $U \subset X$ be an affine open.
Recall that a {\it standard open covering} of $U$ is a covering
of the form $\mathcal{U} : U = \bigcup_{i = 1}^n D(f_i)$
where $f_1, \ldots, f_n \in \Gamma(U, \mathcal{O}_X)$ generate
the unit ideal, see
Schemes, Definition \ref{schemes-definition-standard-covering}.

\begin{lemma}
\label{lemma-cech-cohomology-quasi-coherent-trivial}
Let $X$ be a scheme.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $\mathcal{U} : U = \bigcup_{i = 1}^n D(f_i)$ be a standard
open covering of an affine open of $X$.
Then $\check{H}^p(\mathcal{U}, \mathcal{F}) = 0$ for
all $p > 0$.
\end{lemma}

\begin{proof}
Write $U = \text{Spec}(A)$ for some ring $A$.
In other words, $f_1, \ldots, f_n$ are elements of $A$
which generate the unit ideal of $A$.
Write $\mathcal{F}|_U = \widetilde{M}$ for some $A$-module $M$.
Clearly the Cech complex
$\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})$
is identified with the complex
$$
\prod_{i_0} M_{f_{i_0}} \to
\prod_{i_0i_1} M_{f_{i_0}f_{i_1}} \to
\prod_{i_0i_1i_2} M_{f_{i_0}f_{i_1}f_{i_2}} \to
\ldots
$$
We are asked to show that the extended complex
\begin{equation}
\label{equation-extended}
0 \to
M \to
\prod_{i_0} M_{f_{i_0}} \to
\prod_{i_0i_1} M_{f_{i_0}f_{i_1}} \to
\prod_{i_0i_1i_2} M_{f_{i_0}f_{i_1}f_{i_2}} \to
\ldots
\end{equation}
(whose truncation we have studied in
Algebra, Lemma \ref{algebra-lemma-cover-module}) is exact.
It suffices to show that (\ref{equation-extended})
is exact after localizing at a prime $\mathfrak p$, see
Algebra, Lemma \ref{algebra-lemma-characterize-zero-local}.
In fact we will show that the extended complex localized
at $\mathfrak p$ is homotopic to zero.

\medskip\noindent
There exists an index $i$ such that $f_i \not \in \mathfrak p$.
Choose and fix such an element $i_{\text{fix}}$. Note that
$M_{f_{i_{\text{fix}}}, \mathfrak p} = M_{\mathfrak p}$. Similarly
for a localization at a product $f_{i_0} \ldots f_{i_p}$ and $\mathfrak p$
we can drop any $f_{i_j}$ for which $i_j = i_{\text{fix}}$.
Let us define a homotopy
$$
h :
\prod\nolimits_{i_0 \ldots i_{p + 1}}
M_{f_{i_0} \ldots f_{i_{p + 1}}, \mathfrak p}
\longrightarrow
\prod\nolimits_{i_0 \ldots i_p}
M_{f_{i_0} \ldots f_{i_p}, \mathfrak p}
$$
by the rule
$$
h(s)_{i_0 \ldots i_p} = s_{i_{\text{fix}} i_0 \ldots i_p}
$$
(This is ``dual'' to the homotopy in the proof of
Cohomology, Lemma \ref{cohomology-lemma-homology-complex}.)
In other words, $h : \prod_{i_0} M_{f_{i_0}, \mathfrak p} \to M$
is projection onto the factor
$M_{f_{i_{\text{fix}}}, \mathfrak p} = M_{\mathfrak p}$ and in general
the map $h$ equal projection onto the factors
$M_{f_{i_{\text{fix}}} f_{i_1} \ldots f_{i_{p + 1}}, \mathfrak p}
= M_{f_{i_1} \ldots f_{i_{p + 1}}, \mathfrak p}$. We compute
\begin{align*}
(dh + hd)(s)_{i_0 \ldots i_p}
= &
\sum_{j = 0}^p
(-1)^j
h(s)_{i_0 \ldots \hat i_j \ldots i_p}
+
d(s)_{i_{\text{fix}} i_0 \ldots i_p}\\
= &
\sum_{j = 0}^p
(-1)^j
s_{i_{\text{fix}} i_0 \ldots \hat i_j \ldots i_p}
+
s_{i_0 \ldots i_p}
+
\sum_{j = 0}^p
(-1)^{j + 1}
s_{i_{\text{fix}} i_0 \ldots \hat i_j \ldots i_p} \\
= &
s_{i_0 \ldots i_p}
\end{align*}
This proves the identity map is homotopic to zero as desired.
\end{proof}

\begin{lemma}
\label{lemma-quasi-coherent-affine-cohomology-zero}
Let $X$ be a scheme.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
For any affine open $U \subset X$ we have
$H^p(U, \mathcal{F}) = 0$ for all $p > 0$.
\end{lemma}

\begin{proof}
We are going to apply
Cohomology, Lemma \ref{cohomology-lemma-cech-vanish-basis}.
As our basis $\mathcal{B}$ for the topology of $X$ we are going to use
the affine opens of $X$.
As our set $\text{Cov}$ of open coverings we are going to use the standard
open coverings of affine opens of $X$.
Next we check that conditions (1), (2) and (3) of
Cohomology, Lemma \ref{cohomology-lemma-cech-vanish-basis}
hold. Note that the intersection of standard opens in an affine is
another standard open. Hence property (1) holds. 
The coverings form a cofinal system of open coverings of any element
of $\mathcal{B}$, see
Schemes, Lemma \ref{schemes-lemma-standard-open}.
Hence (2) holds.
Finally, condition (3) of the lemma follows from
Lemma \ref{lemma-cech-cohomology-quasi-coherent-trivial}.
\end{proof}

\begin{lemma}
\label{lemma-relative-affine-vanishing}
Let $f : X \to S$ be a morphism of schemes.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
If $f$ is affine then $R^if_*\mathcal{F} = 0$ for all $i > 0$.
\end{lemma}

\begin{proof}
According to
Cohomology, Lemma \ref{cohomology-lemma-describe-higher-direct-images}
the sheaf
$R^if_*\mathcal{F}$ is the sheaf associated to the presheaf
$V \mapsto H^i(f^{-1}(V), \mathcal{F}|_{f^{-1}(V)})$.
By assumption, whenever $V$ is affine we have that $f^{-1}(V)$ is
affine, see Morphisms, Definition \ref{morphisms-definition-affine}.
By Lemma \ref{lemma-quasi-coherent-affine-cohomology-zero} we conclude that
$H^i(f^{-1}(V), \mathcal{F}|_{f^{-1}(V)}) = 0$
whenever $V$ is affine. Since $S$ has a basis consisting of affine
opens we win.
\end{proof}

\begin{lemma}
\label{lemma-cech-cohomology-quasi-coherent}
Let $X$ be a scheme.
Let $\mathcal{U} : X = \bigcup_{i \in I} U_i$ be an open covering such that
$U_{i_0 \ldots i_p}$ is affine open for all $p \ge 0$ and all
$i_0, \ldots, i_p \in I$
In this case for any quasi-coherent sheaf $\mathcal{F}$ we have
$$
\check{H}^p(\mathcal{U}, \mathcal{F}) = H^p(X, \mathcal{F})
$$
for all $p$.
\end{lemma}

\begin{proof}
In view of Lemma \ref{lemma-quasi-coherent-affine-cohomology-zero}
this is a special case of
Comology, Lemma \ref{cohomology-lemma-cech-spectral-sequence-application}.
\end{proof}















\section{Quasi-coherence of higher direct images}
\label{section-quasi-coherence}

\begin{lemma}
\label{lemma-vanishing-nr-affines}
Let $X$ be a quasi-compact separated scheme.
Let $t \geq 1$ be the minimal number of affine opens needed to
cover $X$.
Then $H^n(X, \mathcal{F}) = 0$ for all $n \geq t$ and all
quasi-coherent sheaves $\mathcal{F}$.
\end{lemma}

\begin{proof}
First proof.
By induction on $t$.
If $t = 1$ the result follows from
Lemma \ref{lemma-quasi-coherent-affine-cohomology-zero}.
If $t > 1$ write $X = U \cup V$ with $V$ affine open and
$U = U_1 \cup \ldots \cup U_{t - 1}$ a union of $t - 1$ open affines.
Note that in this case
$U \cap V =  (U_1 \cap V) \cup \ldots (U_{t - 1} \cap V)$
is also a union of $t - 1$ affine open subschemes, see
Schemes, Lemma \ref{schemes-lemma-characterize-separated}.
We apply the Mayer-Vietoris long exact sequence
$$
0 \to
H^0(X, \mathcal{F}) \to
H^0(U, \mathcal{F}) \oplus H^0(V, \mathcal{F}) \to
H^0(U \cap V, \mathcal{F}) \to
H^1(X, \mathcal{F}) \to \ldots
$$
see Cohomology, Lemma \ref{cohomology-lemma-mayer-vietoris}.
By induction we see that $H^i(U, \mathcal{F})$,
$H^i(U, \mathcal{F})$, $H^i(U, \mathcal{F})$ are zero for
$i \geq t - 1$. It follows immediately that $H^i(X, \mathcal{F})$
is zero for $i \geq t$.

\medskip\noindent
Second proof. 
Let $\mathcal{U} : X = \bigcup_{i = 1}^t U_i$ be a finite affine open
covering. Since $X$ is separated the multiple intersections
$U_{i_0 \ldots i_p}$ are all affine, see 
Schemes, Lemma \ref{schemes-lemma-characterize-separated}.
By Lemma \ref{lemma-cech-cohomology-quasi-coherent} the Cech
cohomology groups $\check{H}^p(\mathcal{U}, \mathcal{F})$
agree with the cohomology groups. By
Cohomology, Lemma \ref{cohomology-lemma-alternating-usual}
the Cech cohomology groups may be computed using the alternating
Cech complex $\check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F})$.
As the covering consists of $t$ elements we see immediately
that $\check{\mathcal{C}}_{alt}^p(\mathcal{U}, \mathcal{F}) = 0$
for all $p \geq t$. Hence the result follows.
\end{proof}

\begin{lemma}
\label{lemma-quasi-coherence-higher-direct-images}
Let $f : X \to S$ be a morphism of schemes.
Assume that $f$ is quasi-separated and quasi-compact.
\begin{enumerate}
\item For any quasi-coherent $\mathcal{O}_X$-module $\mathcal{F}$ the
higher direct images $R^pf_*\mathcal{F}$ are quasi-coherent on $S$.
\item If $S$ is quasi-compact, there exists an integer $n = n(X, S, f)$
such that $R^pf_*\mathcal{F} = 0$ for all $p \geq n$ and any
quasi-coherent sheaf $\mathcal{F}$ on $X$.
\end{enumerate}
\end{lemma}

\begin{proof}
Note that under the hypotheses of the lemma the sheaf
$R^0f_*\mathcal{F} = f_*\mathcal{F}$ is quasi-coherent by
Schemes, Lemma \ref{schemes-lemma-push-forward-quasi-coherent}.

\medskip\noindent
We will repeatedly use
Cohomology, Lemma \ref{cohomology-lemma-localize-higher-direct-images}
to see that forming higher direct images commutes with restriction.
Being quasi-coherent is local on $S$ and in order to prove (1) we
may assume $S$ is affine.

\medskip\noindent
Suppose $S = \bigcup_{i = 1, \ldots m} S_i$ is a finite affine open covering.
Assume $n_i$ works in (2) for the morphism $f^{-1}(S_i) \to S_i$.
Then we see that $n = \max\{n_i\}$ works for $X \to S$ in (2).
Hence we may assume $S$ is affine in order to prove (2) as well.

\medskip\noindent
Assume $S$ is affine and $f$ quasi-compact and separated.
Let $t \geq 1$ be the minimal number of affine opens needed to cover $X$.
We will prove this case of the lemma by induction on $t$ and we will in
addition show that setting $n = t$ in (2) works.
If $t = 1$ then the morphism $f$ is affine by
Morphisms, Lemma \ref{morphisms-lemma-morphism-affines-affine}
and (1) and (2) (with $n = 1$)
both follow from Lemma \ref{lemma-relative-affine-vanishing}.
If $t > 1$ write $X = U \cup V$ with $V$ affine open and
$U = U_1 \cup \ldots \cup U_{t - 1}$ a union of $t - 1$ open affines.
Note that in this case
$U \cap V =  (U_1 \cap V) \cup \ldots (U_{t - 1} \cap V)$
is also a union of $t - 1$ affine open subschemes, see
Schemes, Lemma \ref{schemes-lemma-characterize-separated}.
We will apply the relative Mayer-Vietoris sequence
$$
0 \to
f_*\mathcal{F} \to
a_*(\mathcal{F}|_U) \oplus b_*(\mathcal{F}|_V) \to
c_*(\mathcal{F}|_{U \cap V}) \to
R^1f_*\mathcal{F} \to \ldots
$$
see Cohomology, Lemma \ref{cohomology-lemma-relative-mayer-vietoris}.
By induction we see that
$R^pa_*\mathcal{F}$, $R^pb_*\mathcal{F}$ and $R^pc_*\mathcal{F}$
are all quasi-coherent and zero when $p \geq t - 1$. This immediately
implies the desired vanishing. It also implies that each of sheaves
$R^pf_*\mathcal{F}$ is quasi-coherent since it sits in the middle of a short
exact sequence with a cokernel of a map between quasi-coherent sheaves
on the left and a kernel of a map between quasi-coherent sheaves on the right.
Use the results on quasi-coherent sheaves in
Schemes, Section \ref{schemes-section-quasi-coherent} to see
this is sufficient to conclude.

\medskip\noindent
Assume $S$ is affine and $f$ quasi-compact and quasi-separated.
Let $t \geq 1$ be the minimal number of affine opens needed to cover $X$.
We will prove this case of lemma by induction on $t$. We have seen above
that this will imply the lemma in general.
If $t = 1$ then the morphism $f$ is affine by
Morphisms, Lemma \ref{morphisms-lemma-morphism-affines-affine}
and (1) and (2) (with $n = 1$)
both follow from Lemma \ref{lemma-relative-affine-vanishing}.
If $t > 1$ write $X = U \cup V$ with $V$ affine open and
$U$ a union of $t - 1$ open affines.
Note that in this case $U \cap V$ is an open subscheme of an affine
scheme and hence separated (see
Schemes, Lemma \ref{schemes-lemma-affine-separated}).
We will apply the relative Mayer-Vietoris sequence
$$
0 \to
f_*\mathcal{F} \to
a_*(\mathcal{F}|_U) \oplus b_*(\mathcal{F}|_V) \to
c_*(\mathcal{F}|_{U \cap V}) \to
R^1f_*\mathcal{F} \to \ldots
$$
see Cohomology, Lemma \ref{cohomology-lemma-relative-mayer-vietoris}.
By induction there exist integers $n_a, n_b, n_c$ such that
$R^pa_*\mathcal{F}$, $R^pb_*\mathcal{F}$ and $R^pc_*\mathcal{F}$
are all quasi-coherent and zero when $p \geq \max\{n_a, n_b, n_c\}$.
This immediately implies the vanishing in (2) with
$n = \max\{n_a, n_b, n_c\} + 1$. It also implies that each of sheaves
$R^pf_*\mathcal{F}$ is quasi-coherent since it sits in the middle of a short
exact sequence with a cokernel of a map between quasi-coherent sheaves
on the left and a kernel of a map between quasi-coherent sheaves on the right.
Use the results on quasi-coherent sheaves in
Schemes, Section \ref{schemes-section-quasi-coherent} to see
this is sufficient to conclude.
\end{proof}

\begin{lemma}
\label{lemma-quasi-coherence-higher-direct-images-application}
Let $f : X \to S$ be a morphism of schemes.
Assume that $f$ is quasi-separated and quasi-compact.
Assume $S$ is affine.
For any quasi-coherent $\mathcal{O}_X$-module $\mathcal{F}$
we have
$$
H^q(X, \mathcal{F}) = H^0(S, R^qf_*\mathcal{F})
$$
for all $q \in \mathbf{Z}$.
\end{lemma}

\begin{proof}
Consider the Leray spectral sequence $E_2^{p, q} = H^p(S, R^qf_*\mathcal{F})$
converging to $H^{p + q}(X, \mathcal{F})$, see
Cohomology, Lemma \ref{cohomology-lemma-Leray}.
By Lemma \ref{lemma-quasi-coherence-higher-direct-images}
we see that the sheaves $R^qf_*\mathcal{F}$ are quasi-coherent.
By Lemma \ref{lemma-quasi-coherent-affine-cohomology-zero}
we see that $E_2^{p, q} = 0$ when $p > 0$.
Hence the spectral sequence degenerates at $E_2$ and we win.
\end{proof}








\section{Coherent sheaves on Noetherian schemes}
\label{section-coherent-sheaves}

\noindent
Allthough it is possible to consider coherent sheaves on non-Noetherian
schemes we will almost always assume the base scheme is Noetherian when
we consider coherent sheaves. Here is a characterization of coherent
sheaves on Noetherian schemes.

\begin{lemma}
\label{lemma-coherent-Noetherian}
Let $X$ be a locally Noetherian scheme.
Let $\mathcal{F}$ be an $\mathcal{O}_X$-module.
The following are equivalent
\begin{enumerate}
\item $\mathcal{F}$ is coherent,
\item $\mathcal{F}$ is a quasi-coherent, finite type $\mathcal{O}_X$-module,
\item $\mathcal{F}$ is a finitely presented $\mathcal{O}_X$-module,
\item for any affine open $\text{Spec}(A) = U \subset X$ we have
$\mathcal{F}|_U = \widetilde M$ with $M$ a finite $A$-module, and
\item there exists an affine open covering $X = \bigcup U_i$,
$U_i = \text{Spec}(A_i)$ such that each
$\mathcal{F}|_{U_i} = \widetilde M_i$ with $M_i$ a finite $A_i$-module.
\end{enumerate}
In particular $\mathcal{O}_X$ is coherent, any invertible
$\mathcal{O}_X$-module is coherent, and more generally any
finite locally free $\mathcal{O}_X$-module is invertible.
\end{lemma}

\begin{proof}
The implications (1) $\Rightarrow$ (2) and (1) $\Rightarrow$ (3) hold
in general, see
Modules, Lemma \ref{modules-lemma-coherent-finite-presentation}.
If $\mathcal{F}$ is finitely presented then $\mathcal{F}$ is
quasi-coherent, see
Modules, Lemma \ref{modules-lemma-finite-presentation-quasi-coherent}.
Hence also (3) $\Rightarrow$ (2).

\medskip\noindent
Assume $\mathcal{F}$ is a quasi-coherent, finite type $\mathcal{O}_X$-module.
By
Properties, Lemma \ref{properties-lemma-finite-type-module}
we see that on any affine open
$\text{Spec}(A) = U \subset X$ we have $\mathcal{F}|_U = \widetilde M$
with $M$ a finite $A$-module. Since $A$ is Noetherian we see that
$M$ has a finite resolution
$$
A^{\oplus m} \to A^{\oplus n} \to M \to 0.
$$
Hence $\mathcal{F}$ is of finite presentation by
Properties, Lemma \ref{properties-lemma-finite-presentation-module}.
In other words (2) $\Rightarrow$ (3).

\medskip\noindent
By Modules, Lemma \ref{modules-lemma-coherent-structure-sheaf} it suffices
to show that $\mathcal{O}_X$ is coherent in order to show that (3)
implies (1). Thus we have to show: given any open $U \subset X$ and
any finite collection of sections $f_i \in \mathcal{O}_X(U)$,
$i = 1, \ldots, n$ the kernel of the map
$\bigoplus_{i = 1, \ldots, n} \mathcal{O}_U \to \mathcal{O}_U$
is of finite type. Since being of finite type is a local property
it suffices to check this in a neighbourhood of any $x \in U$.
Thus we may assume $U = \text{Spec}(A)$ is affine. In this case
$f_1, \ldots, f_n \in A$ are elements of $A$. Since $A$ is
Noetherian, see
Properties, Lemma \ref{properties-lemma-locally-Noetherian}
the kernel $K$ of the map $\bigoplus_{i = 1, \ldots, n} A \to A$
is a finite $A$-module. See for example
Algebra, Lemma \ref{algebra-lemma-Noetherian-basic}.
As the functor\ $\widetilde{ }$\ is exact, see
Schemes, Lemma \ref{schemes-lemma-spec-sheaves}
we get an exact sequence
$$
\widetilde K \to
\bigoplus\nolimits_{i = 1, \ldots, n} \mathcal{O}_U \to
\mathcal{O}_U
$$
and by
Properties, Lemma \ref{properties-lemma-finite-type-module}
again we see that $\widetilde K$ is of finite type. We conclude
that (1), (2) and (3) are all equivalent.

\medskip\noindent
It follows from
Properties, Lemma \ref{properties-lemma-finite-type-module}
that (2) implies (4). It is trivial that (4) implies (5).
The discussion in
Schemes, Section \ref{schemes-section-quasi-coherent}
show that (5) implies
that $\mathcal{F}$ is quasi-coherent and it is clear that (5)
implies that $\mathcal{F}$ is of finite type. Hence (5) implies
(2) and we win.
\end{proof}

\begin{lemma}
\label{lemma-coherent-abelian-Noetherian}
Let $X$ be a locally Noetherian scheme.
The category of coherent $\mathcal{O}_X$-modules is abelian.
More precisely, the kernel and cokernel of a map of coherent
$\mathcal{O}_X$-modules are coherent. Any extension
of coherent sheaves is coherent.
\end{lemma}

\begin{proof}
This is simply a restatement of
Modules, Lemma \ref{modules-lemma-coherent-abelian}
in a particular case.
\end{proof}

\noindent
The following lemma does not always hold for the category of coherent
$\mathcal{O}_X$-modules on a general ringed space $X$.

\begin{lemma}
\label{lemma-coherent-Noetherian-quasi-coherent-sub-quotient}
Let $X$ be a locally Noetherian scheme.
Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module.
Any quasi-coherent submodule of $\mathcal{F}$ is coherent.
Any quasi-coherent quotient module of $\mathcal{F}$ is coherent.
\end{lemma}

\begin{proof}
We may assume that $X$ is affine, say $X = \text{Spec}(A)$.
Properties, Lemma \ref{properties-lemma-locally-Noetherian}
implies that $A$ is Noetherian. Lemma \ref{lemma-coherent-Noetherian}
turns this into algebra. The algebraic counter part of
the lemma is that a quotient, or a submodule of a finite $A$-module
is a finite $A$-module, see for example
Algebra, Lemma \ref{algebra-lemma-Noetherian-basic}.
\end{proof}

\begin{lemma}
\label{lemma-finite-pushforward-coherent}
Let $f : X \to Y$ be a morphism of schemes.
Assume $f$ is finite and $X$, $Y$ locally Noetherian.
Then $f_*\mathcal{F}$ is coherent if $\mathcal{F}$ is
coherent.
\end{lemma}

\begin{proof}
Let $\text{Spec}(A) = V \subset Y$ be an affine open subset.
By Morphisms, Definition \ref{morphisms-definition-integral}
we see that $f^{-1}(V) = \text{Spec}(B)$ with $A \to B$ finite.
Lemma \ref{lemma-coherent-Noetherian}
turns the statement of the lemma into the following algebra
fact: If $M$ is a finite $B$-module, then $M$ is also finite
viewed as a $A$-module, see
Algebra, Lemma \ref{algebra-lemma-finite-module-over-finite-extension}.
\end{proof}

\noindent
In the situation of the lemma also the higher direct images are
coherent since they vanish, see Lemma \ref{lemma-relative-affine-vanishing}.
Our next goal is the show that this is always the case for a proper morphism
between locally Noetherian schemes.












\section{Cohomology of projective space}
\label{section-cohomology-projective-space}

\noindent
In this section we compute the cohomology of the twists of the
structure sheaf on $\mathbf{P}^n_S$ over a scheme $S$.
Recall that $\mathbf{P}^n_S$ was defined as the fibre product
$
\mathbf{P}^n_S = S \times_{\text{Spec}(\mathbf{Z})} \mathbf{P}^n_{\mathbf{Z}}
$
in Constructions, Definition \ref{constructions-definition-projective-space}.
It was shown to be equal to
$$
\mathbf{P}^n_S = \underline{\text{Proj}}_S(\mathcal{O}_S[T_0, \ldots, T_n])
$$
in Constructions, Section \ref{constructions-section-projective-bundle}.
In particular, projective space is a particular case of a projective bundle.
If $S = \text{Spec}(R)$ is affine then we have
$$
\mathbf{P}^n_S = \mathbf{P}^n_R = \text{Proj}(R[T_0, \ldots, T_n]).
$$
All these identifications are compatible and compatible with the constructions
of the twisted structure sheaves $\mathcal{O}_{\mathbf{P}^n_S}(d)$.

\medskip\noindent
Before we state the result we need some notation.
Let $R$ be a ring.
Recall that $R[T_0, \ldots, T_n]$ is a graded
$R$-algebra where each $T_i$ is homogenous of degree $1$.
Denote $(R[T_0, \ldots, T_n])_d$ the degree $d$ summand.
It is a finite free $R$-module of rank $\binom{n + d}{d}$
when $d \geq 0$ and zero else.
It has a basis consisting of monomials $T_0^{e_0} \ldots T_n^{e_n}$
with $\sum e_i = d$. We will also use the following notation:
$R[\frac{1}{T_0}, \ldots, \frac{1}{T_n}]$ denotes the $\mathbf{Z}$-graded
ring with $\frac{1}{T_i}$ in degree $-1$. In particular the
$\mathbf{Z}$-graded $R[\frac{1}{T_0}, \ldots, \frac{1}{T_n}]$ module
$$
\frac{1}{T_0 \ldots T_n} R[\frac{1}{T_0}, \ldots, \frac{1}{T_n}]
$$
which shows up in the statement below is zero in degrees
$\geq -n$, is free on the generator $\frac{1}{T_0 \ldots T_n}$
in degree $-n - 1$ and is free of rank $(-1)^n\binom{n + d}{d}$ for
$d \leq -n - 1$.

\begin{lemma}
\label{lemma-cohomology-projective-space-over-ring}
Let $R$ be a ring.
Let $n \geq 0$ be an integer.
We have
$$
H^q(\mathbf{P}^n, \mathcal{O}_{\mathbf{P}^n_R}(d)) =
\left\{
\begin{matrix}
(R[T_0, \ldots, T_n])_d & \text{if} & q = 0 \\
0 & \text{if} & q \not = 0, n \\
\left(\frac{1}{T_0 \ldots T_n} R[\frac{1}{T_0}, \ldots, \frac{1}{T_n}]\right)_d
& \text{if} & q = n
\end{matrix}
\right.
$$
\end{lemma}

\begin{proof}
We will use the standard affine open convering
$$
\mathcal{U} : \mathbf{P}^n_R = \bigcup\nolimits_{i = 0}^n D_{+}(T_i)
$$
to compute the cohomology using the Cech complex.
This is permissible by Lemma \ref{lemma-cech-cohomology-quasi-coherent}
since any intersection of finitely many affine $D_{+}(T_i)$ is also a
standard affine open (see
Constructions, Section \ref{constructions-section-proj}).
In fact, we can use the alternating or ordered Cech complex according to
Cohomology, Lemmas \ref{cohomology-lemma-ordered-alternating} and
\ref{cohomology-lemma-alternating-usual}.

\medskip\noindent
The ordering we will use on $\{0, \ldots, n\}$ is the usual one.
Hence the complex we are looking at has terms
$$
\check{\mathcal{C}}_{ord}^p(\mathcal{U}, \mathcal{O}_{\mathbf{P}_R}(d))
=
\bigoplus\nolimits_{i_0 < \ldots < i_p}
(R[T_0, \ldots, T_n, \frac{1}{T_{i_0} \ldots T_{i_p}}])_d
$$
Moreover, the maps are given by the usual formula
$$
d(s)_{i_0 \ldots i_{p + 1}} =
\sum\nolimits_{j = 0}^{p + 1} (-1)^j s_{i_0 \ldots \hat i_j \ldots i_{p + 1}}
$$
see Cohomology, Section \ref{cohomology-section-alternating-cech}.
Note that each term of this complex has a natural
$\mathbf{Z}^{n + 1}$-grading. Namely, we get this by declaring a monomial
$T_0^{e_0} \ldots T_n^{e_n}$ to be homogeneous with weight
$(e_0, \ldots, e_n) \in \mathbf{Z}^{n + 1}$. It is clear that the differential
given above respects the grading. In a formula we have
$$
\check{\mathcal{C}}_{ord}^\bullet(\mathcal{U}, \mathcal{O}_{\mathbf{P}_R}(d))
=
\bigoplus\nolimits_{\vec{e} \in \mathbf{Z}^{n + 1}}
\check{\mathcal{C}}^\bullet(\vec{e})
$$
where not all summand on the right hand side occur (see below).
Hence in order to compute the cohomology
modules of the complex it suffices to compute the cohomology of the graded
pieces and take the direct sum at the end.

\medskip\noindent
Fix $\vec{e} = (e_0, \ldots, e_n) \in \mathbf{Z}^{n + 1}$. In order for this
weight to occur in the complex above we need to assume
$e_0 + \ldots + e_n = d$ (if not then it occurs for a different twist of
the structure sheaf of course). Assuming this set
$$
NEG(\vec{e}) = \{i \in \{0, \ldots, n\} \mid e_i < 0\}.
$$
With this notation the weight $\vec{e}$ summand
$\check{\mathcal{C}}^\bullet(\vec{e})$ of the Cech complex above has
the following terms
$$
\check{\mathcal{C}}^p(\vec{e})
=
\bigoplus\nolimits_{i_0 < \ldots < i_p,
\ NEG(\vec{e}) \subset \{i_0, \ldots, i_p\}}
R \cdot T_0^{e_0} \ldots T_n^{e_n}
$$
In other words, the terms corresponding to $i_0 < \ldots < i_p$ such
that $NEG(\vec{e})$ is not contained in $\{i_0 \ldots i_p\}$ are zero.
The differential of the complex $\check{\mathcal{C}}^\bullet(\vec{e})$
is still given by the exact same formula as above.

\medskip\noindent
Suppose that $NEG(\vec{e}) = \{0, \ldots, n\}$, i.e., that all
exponents $e_i$ are negative.
In this case the complex $\check{\mathcal{C}}^\bullet(\vec{e})$ has
only one term, namely $\check{\mathcal{C}}^n(\vec{e}) = 
R \cdot \frac{1}{T^{-e_0} \ldots T^{-e_n}}$. Hence in this
case
$$
H^q(\check{\mathcal{C}}^\bullet(\vec{e})) =
\left\{
\begin{matrix}
R \cdot \frac{1}{T^{-e_0} \ldots T^{-e_n}} & \text{if} & q = n \\
0 & \text{if} & \text{else}
\end{matrix}
\right.
$$
The direct sum of all of these terms clearly gives the value
$$
\left(\frac{1}{T_0 \ldots T_n} R[\frac{1}{T_0}, \ldots, \frac{1}{T_n}]\right)_d
$$
in degree $n$ as stated in the lemma. Moreover these terms do not contribute
to cohomology in other degrees (also in accordance with the statement of the
lemma).

\medskip\noindent
Assume $NEG(\vec{e}) = \emptyset$. In this case the complex
$\check{\mathcal{C}}^\bullet(\vec{e})$ has a summand $R$ corresponding
to all $i_0 < \ldots < i_p$.
Let us compare the complex $\check{\mathcal{C}}^\bullet(\vec{e})$
to another complex. Namely, consider the affine open open covering
$$
\mathcal{V} : \text{Spec}(R) = \bigcup\nolimits_{i \in \{0, \ldots, n\}} V_i
$$
where $V_i = \text{Spec}(R)$ for all $i$. Consider the alternating
Cech complex
$$
\check{\mathcal{C}}_{ord}^\bullet(\mathcal{V}, \mathcal{O}_{\text{Spec}(R)})
$$
By the same reasoning as above this computes the cohomology of the
structure sheaf on $\text{Spec}(R)$. Hence we see that
$H^p(
\check{\mathcal{C}}_{ord}^\bullet(\mathcal{V}, \mathcal{O}_{\text{Spec}(R)})
) = R$ if $p = 0$ and is $0$ whenever $p > 0$.
For these facts, see
Lemma \ref{lemma-cech-cohomology-quasi-coherent-trivial} and its proof.
Note that also
$\check{\mathcal{C}}_{ord}^\bullet(\mathcal{V}, \mathcal{O}_{\text{Spec}(R)})$
has a summand $R$ for every $i_0 < \ldots < i_p$ and has exactly the same
differential as $\check{\mathcal{C}}^\bullet(\vec{e})$. In other words
these complexes are isomorphic complexes and hence have the same cohomology.
We conclude that
$$
H^q(\check{\mathcal{C}}^\bullet(\vec{e})) =
\left\{
\begin{matrix}
R \cdot T^{e_0} \ldots T^{e_n} & \text{if} & q = 0 \\
0 & \text{if} & \text{else}
\end{matrix}
\right.
$$
in the case that $NEG(\vec{e}) = \emptyset$.
The direct sum of all of these terms clearly gives the value
$$
(R[T_0, \ldots, T_n])_d
$$
in degree $0$ as stated in the lemma. Moreover these terms do not contribute
to cohomology in other degrees (also in accordance with the statement of the
lemma).

\medskip\noindent
To finish the proof of the lemma we have to show that the complexes
$\check{\mathcal{C}}^\bullet(\vec{e})$ are acyclic when
$NEG(\vec{e})$ is neither empty nor equal to $\{0, \ldots, n\}$.
Pick an index $i_{\text{fix}} \not \in NEG(\vec{e})$ (such an index exists).
Consider the map
$$
h :
\check{\mathcal{C}}^{p + 1}(\vec{e})
\to
\check{\mathcal{C}}^p(\vec{e})
$$
given by the rule
$$
h(s)_{i_0 \ldots i_p} = s_{i_{\text{fix}} i_0 \ldots i_p}
$$
(compare with the proof of
Lemma \ref{lemma-cech-cohomology-quasi-coherent-trivial}).
It is clear that this is well defined since
$$
NEG(\vec{e}) \subset \{i_0, \ldots, i_p\}
\Leftrightarrow
NEG(\vec{e}) \subset \{i_{\text{fix}}, i_0, \ldots, i_p\}
$$
Also $\check{\mathcal{C}}^0(\vec{e}) = 0$ so that this
formula does work for all $p$ including $p = - 1$.
The exact same (combinatorial) computation as in the
proof of Lemma \ref{lemma-cech-cohomology-quasi-coherent-trivial}
shows that
$$
(hd + dh)(s)_{i_0 \ldots i_p}
=
s_{i_0 \ldots i_p}
$$
Hence we see that the identity map of the complex
$\check{\mathcal{C}}^\bullet(\vec{e})$ is homotopic to zero
which implies that it is acyclic.
\end{proof}

\noindent
Before we state the relative version we need some notation.
Namely, recall that $\mathcal{O}_S[T_0, \ldots, T_n]$ is a graded
$\mathcal{O}_S$-module where each $T_i$ is homogenous of degree $1$.
Denote $(\mathcal{O}_S[T_0, \ldots, T_n])_d$ the degree $d$ summand.
It is a finite locally free sheaf of rank $\binom{n + d}{d}$ on $S$.

\begin{lemma}
\label{lemma-cohomology-projective-space-over-base}
Let $S$ be a scheme.
Let $n \geq 0$ be an integer.
Consider the structure morphism
$$
f : \mathbf{P}^n_S \longrightarrow S.
$$
We have
$$
R^qf_*(\mathcal{O}_{\mathbf{P}^n_S}(d)) =
\left\{
\begin{matrix}
(\mathcal{O}_S[T_0, \ldots, T_n])_d & \text{if} & q = 0 \\
0 & \text{if} & q \not = 0, n \\
\textit{Hom}_{\mathcal{O}_S}(
(\mathcal{O}_S[T_0, \ldots, T_n])_{- n - 1 - d}, \mathcal{O}_S)
& \text{if} & q = n
\end{matrix}
\right.
$$
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
Next we state the version for projective bundles associated to finite locally
free sheaves. Let $S$ be a scheme. Let $\mathcal{E}$ be a finite locally
free $\mathcal{O}_S$-module of constant rank $n + 1$, see
Modules, Section \ref{modules-section-locally-free}.
In this case we think of $\text{Sym}(\mathcal{E})$ as a graded
$\mathcal{O}_S$-module where $\mathcal{E}$ is the graded part of degree $1$.
And $\text{Sym}^d(\mathcal{E})$ is the degree $d$ summand.
It is a finite locally free sheaf of rank $\binom{n + d}{d}$ on $S$.
Recall that our normalization is that
$$
\pi :
\mathbf{P}(\mathcal{E})
=
\underline{\text{Proj}}_S(\text{Sym}(\mathcal{E}))
\longrightarrow
S
$$
and that there are natural maps
$\text{Sym}^d(\mathcal{E}) \to \pi_*\mathcal{O}_{\mathbf{P}(\mathcal{E})}(d)$.

\begin{lemma}
\label{lemma-cohomology-projective-bundle}
Let $S$ be a scheme.
Let $\mathcal{E}$ be a finite locally
free $\mathcal{O}_S$-module of constant rank $n + 1$.
Consider the structure morphism
$$
\pi : \mathbf{P}(\mathcal{E}) \longrightarrow S.
$$
We have
$$
R^q\pi_*(\mathcal{O}_{\mathbf{P}(\mathcal{E})}(d)) =
\left\{
\begin{matrix}
\text{Sym}^d(\mathcal{E}) & \text{if} & q = 0 \\
0 & \text{if} & q \not = 0, n \\
\textit{Hom}_{\mathcal{O}_S}(
\text{Sym}^{- n - 1 - d}(\mathcal{E})
\otimes_{\mathcal{O}_S}
\wedge^{n + 1}\mathcal{E},
\mathcal{O}_S)
& \text{if} & q = n
\end{matrix}
\right.
$$
These identifications are compatible with base change and
isomorphism between locally free sheaves.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}














\input{chapters}

\bibliography{my}
\bibliographystyle{alpha}

\end{document}
