\input{preamble}

% OK, start here.
%
\begin{document}

\title{Differential Graded Sheaves}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
This chapter is a continuation of the discussion started in
Differential Graded Algebra, Section \ref{dga-section-introduction}.
A survey paper is \cite{Keller-survey}.




\section{Conventions}
\label{section-conventions}

\noindent
In this chapter we hold on to the convention that {\it ring} means
commutative ring with $1$. If $R$ is a ring, then an {\it $R$-algebra $A$}
will be an $R$-module $A$ endowed with an $R$-bilinear map $A \times A \to A$
(multiplication) such that multiplication is associative and has an
identity.
In other words, these are unital associative $R$-algebras
such that the structure map $R \to A$ maps into the center of $A$.








\section{Sheaves of graded algebras}
\label{section-ga}

\noindent
Please skip this section.

\begin{definition}
\label{definition-ga}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. A
{\it sheaf of graded $\mathcal{O}$-algebras}
or a {\it sheaf of graded algebras} on $(\mathcal{C}, \mathcal{O})$
is given by a family $\mathcal{A}^n$ indexed by $n \in \mathbf{Z}$
of $\mathcal{O}$-modules endowed with $\mathcal{O}$-bilinear maps
$$
\mathcal{A}^n \times \mathcal{A}^m \to \mathcal{A}^{n + m},\quad
(a, b) \longmapsto ab
$$
called the multiplication maps with the following properties
\begin{enumerate}
\item multiplication is associative, and
\item there is a global section $1$ of $\mathcal{A}^0$
which is a two-sided identity for multiplication.
\end{enumerate}
We often denote such a structure $\mathcal{A}$.
A {\it homomorphism of graded $\mathcal{O}$-algebras}
$f : \mathcal{A} \to \mathcal{B}$ is a family of maps
$f^n : \mathcal{A}^n \to \mathcal{B}^n$
of $\mathcal{O}$-modules compatible with the multiplication maps.
\end{definition}

\noindent
Given a graded $\mathcal{O}$-algebra $\mathcal{A}$
and an object $U \in \Ob(\mathcal{C})$ we use the notation
$$
\mathcal{A}(U) =
\Gamma(U, \mathcal{A}) =
\bigoplus\nolimits_{n \in \mathbf{Z}} \mathcal{A}^n(U)
$$
This is a graded $\mathcal{O}(U)$-algebra.

\begin{remark}
\label{remark-functoriality-ga}
Let $(f, f^\sharp) : (\Sh(\mathcal{C}), \mathcal{O}_\mathcal{C})
\to (\Sh(\mathcal{D}), \mathcal{O}_\mathcal{D})$
be a morphism of ringed topoi. We have
\begin{enumerate}
\item Let $\mathcal{A}$ be a graded $\mathcal{O}_\mathcal{C}$-algebra.
The multiplication maps of $\mathcal{A}$ induce multiplication maps
$f_*\mathcal{A}^n \times f_*\mathcal{A}^m \to f_*\mathcal{A}^{n + m}$
and via $f^\sharp$ we may view these as $\mathcal{O}_\mathcal{D}$-bilinear
maps. We will denote $f_*\mathcal{A}$ the graded
$\mathcal{O}_\mathcal{D}$-algebra we so obtain.
\item Let $\mathcal{B}$ be a graded
$\mathcal{O}_\mathcal{D}$-algebra. 
The multiplication maps of $\mathcal{B}$ induce multiplication maps
$f^*\mathcal{B}^n \times f^*\mathcal{B}^m \to f^*\mathcal{B}^{n + m}$
and using $f^\sharp$ we may view these as $\mathcal{O}_\mathcal{C}$-bilinear
maps. We will denote $f^*\mathcal{B}$
the graded $\mathcal{O}_\mathcal{C}$-algebra we so obtain.
\item The set of homomorphisms $f^*\mathcal{B} \to \mathcal{A}$
of graded $\mathcal{O}_\mathcal{C}$-algebras is in
$1$-to-$1$ correspondence with the set of homomorphisms
$\mathcal{B} \to f_*\mathcal{A}$ of graded $\mathcal{O}_\mathcal{C}$-algebras.
\end{enumerate}
Part (3) follows immediately from the usual adjunction between $f^*$ and $f_*$
on sheaves of modules.
\end{remark}




\section{Sheaves of graded modules}
\label{section-graded-modules}

\noindent
Please skip this section.

\begin{definition}
\label{definition-gm}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of graded algebras
on $(\mathcal{C}, \mathcal{O})$.
A (right) {\it graded $\mathcal{A}$-module} or (right)
{\it graded module} over $\mathcal{A}$
is given by a family $\mathcal{M}^n$ indexed by $n \in \mathbf{Z}$
of $\mathcal{O}$-modules endowed with
$\mathcal{O}$-bilinear maps
$$
\mathcal{M}^n \times \mathcal{A}^m \to \mathcal{M}^{n + m},\quad
(x, a) \longmapsto xa
$$
called the multiplication maps with the following properties
\begin{enumerate}
\item multiplication satisfies $(xa)a' = x(aa')$,
\item the identity section $1$ of $\mathcal{A}^0$
acts as the identity on $\mathcal{M}^n$ for all $n$.
\end{enumerate}
We often say ``let $\mathcal{M}$ be a graded $\mathcal{A}$-module''
to indicate this situation.
A {\it homomorphism of graded $\mathcal{A}$-modules}
$f : \mathcal{M} \to \mathcal{N}$ is a family of maps
$f^n : \mathcal{M}^n \to \mathcal{N}^n$
of $\mathcal{O}$-modules compatible with the multiplication maps.
The category of (right) graded $\mathcal{A}$-modules
is denoted $\text{Mod}_\mathcal{A}$.
\end{definition}

\noindent
We can define {\it left graded modules} in exactly the same manner
but our default in the chapter will be right modules.

\medskip\noindent
Given a graded $\mathcal{A}$-module $\mathcal{M}$
and an object $U \in \Ob(\mathcal{C})$ we use the notation
$$
\mathcal{M}(U) =
\Gamma(U, \mathcal{M}) =
\bigoplus\nolimits_{n \in \mathbf{Z}} \mathcal{M}^n(U)
$$
This is a (right) graded $\mathcal{A}(U)$-module.

\begin{lemma}
\label{lemma-gm-abelian}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a graded $\mathcal{O}$-algebra.
The category $\text{Mod}_\mathcal{A}$ is an abelian category
with the following properties
\begin{enumerate}
\item $\text{Mod}_\mathcal{A}$ has arbitrary direct sums,
\item $\text{Mod}_\mathcal{A}$ has arbitrary colimits,
\item filtered colimit in $\text{Mod}_\mathcal{A}$ are exact,
\item $\text{Mod}_\mathcal{A}$ has arbitrary products,
\item $\text{Mod}_\mathcal{A}$ has arbitrary limits.
\end{enumerate}
The functor
$$
\text{Mod}_\mathcal{A} \longrightarrow \textit{Mod}(\mathcal{O}),\quad
\mathcal{M} \longmapsto \mathcal{M}^n
$$
sending a graded $\mathcal{A}$-module to its $n$th term commutes
with all limits and colimits.
\end{lemma}

\noindent
The lemma says that we may take limits and colimits termwise. It
also says (or implies if you like) that the forgetful functor
$$
\text{Mod}_\mathcal{A}
\longrightarrow
\text{Mod}_\mathcal{O}
$$
from graded $\mathcal{A}$-modules to graded $\mathcal{O}$-modules
(where $\mathcal{O}$ is viewed as a graded $\mathcal{O}$-algebra
sitting in degree $0$) commutes with all limits and colimits.

\begin{proof}
Let us denote
$\text{gr}^n : \text{Mod}_\mathcal{A} \to \textit{Mod}(\mathcal{O})$
the functor in the statement of the lemma.
Consider a homomorphism $f : \mathcal{M} \to \mathcal{N}$
of graded $\mathcal{A}$-modules. The kernel
and cokernel of $f$ as maps of graded $\mathcal{O}$-modules
are additionally endowed with multiplication maps as in
Definition \ref{definition-gm}. Hence these are also
the kernel and cokernel in $\text{Mod}_\mathcal{A}$.
Thus $\text{Mod}_\mathcal{A}$ is an abelian category
and taking kernels and cokernels commutes with $\text{gr}^n$.

\medskip\noindent
To prove the existence of limits and colimits it is sufficient
to prove the existence of products and direct sums, see
Categories, Lemmas \ref{categories-lemma-limits-products-equalizers} and
\ref{categories-lemma-colimits-coproducts-coequalizers}.
The same lemmas show that
proving the commutation of limits and colimits with $\text{gr}^n$
follows if $\text{gr}^n$ commutes with direct sums and products.

\medskip\noindent
Let $\mathcal{M}_t$, $t \in T$ be a set of graded $\mathcal{A}$-modules.
Then we can consider the graded $\mathcal{A}$-module whose degree $n$
term is $\bigoplus_{t \in T} \mathcal{M}_t^n$ (with obvious multiplication
maps). The reader easily verifies that this is a direct sum in
$\text{Mod}_\mathcal{A}$. Similarly for products.

\medskip\noindent
Observe that $\text{gr}^n$ is an exact functor for all $n$ and that
a complex $\mathcal{M}_1 \to \mathcal{M}_2 \to \mathcal{M}_3$
of $\text{Mod}_\mathcal{A}$ is exact if and only if
$\text{gr}^n\mathcal{M}_1 \to \text{gr}^n\mathcal{M}_2 \to
\text{gr}^n\mathcal{M}_3$ is exact in $\textit{Mod}(\mathcal{O})$
for all $n$. Hence we conclude that (3) holds as filtered
colimits are exact in $\textit{Mod}(\mathcal{O})$;
it is a Grothendieck abelian category, see
Cohomology on Sites, Section \ref{sites-cohomology-section-unbounded}.
\end{proof}






\section{The graded category of sheaves of graded modules}
\label{section-gm-gr-cat}

\noindent
Please skip this section. This section is the analogue of
Differential Graded Algebra, Example \ref{dga-example-gm-gr-cat}.
For our conventions on graded categories, please see
Differential Graded Algebra, Section \ref{dga-section-graded}.

\medskip\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of graded algebras
on $(\mathcal{C}, \mathcal{O})$. We will construct
a graded category $\text{Mod}^{gr}_\mathcal{A}$ over
$R = \Gamma(\mathcal{C}, \mathcal{O})$
whose associated category $(\text{Mod}^{gr}_\mathcal{A})^0$
is the category of graded $\mathcal{A}$-modules. As objects
of $\text{Mod}^{gr}_\mathcal{A}$ we take right graded
$\mathcal{A}$-modules (see
Section \ref{section-graded-modules}). Given graded
$\mathcal{A}$-modules $\mathcal{L}$ and $\mathcal{M}$ we set
$$
\Hom_{\text{Mod}^{gr}_\mathcal{A}}(\mathcal{L}, \mathcal{M}) =
\bigoplus\nolimits_{n \in \mathbf{Z}} \Hom^n(\mathcal{L}, \mathcal{M})
$$
where
$\Hom^n(\mathcal{L}, \mathcal{M})$
is the set of right $\mathcal{A}$-module maps
$f : \mathcal{L} \to \mathcal{M}$ which
are homogeneous of degree $n$. More precisely, $f$ is given
by a family of maps $f : \mathcal{L}^i \to \mathcal{M}^{i + n}$
for $i \in \mathbf{Z}$ compatible with the multiplication
maps. In terms of components, we have that
$$
\Hom^n(\mathcal{L}, \mathcal{M})
\subset
\prod\nolimits_{p + q = n}
\Hom_\mathcal{O}(\mathcal{L}^{-q}, \mathcal{M}^p)
$$
(observe reversal of indices) is the subset consisting of those
$f = (f_{p, q})$ such that
$$
f_{p, q}(m a) = f_{p - i, q + i}(m)a
$$
for local sections $a$ of $\mathcal{A}^i$ and
$m$ of $\mathcal{L}^{-q - i}$. For graded $\mathcal{A}$-modules
$\mathcal{K}$, $\mathcal{L}$, $\mathcal{M}$
we define composition in $\text{Mod}^{gr}_\mathcal{A}$ via
the maps
$$
\Hom^m(\mathcal{L}, \mathcal{M}) \times
\Hom^n(\mathcal{K}, \mathcal{L}) \longrightarrow
\Hom^{n + m}(\mathcal{K}, \mathcal{M})
$$
by simple composition of right
$\mathcal{A}$-module maps: $(g, f) \mapsto g \circ f$.





\section{Tensor product for sheaves of graded modules}
\label{section-tensor-product}

\noindent
Please skip this section. This section is the analogue of part of
Differential Graded Algebra, Section \ref{dga-section-tensor-product}.

\medskip\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let $\mathcal{A}$
be a sheaf of graded algebras on $(\mathcal{C}, \mathcal{O})$.
Let $\mathcal{M}$ be a right graded $\mathcal{A}$-module
and let $\mathcal{N}$ be a left graded $\mathcal{A}$-module.
Then we define the {\it tensor product}
$\mathcal{M} \otimes_\mathcal{A} \mathcal{N}$
to be the graded $\mathcal{O}$-module whose degree $n$ term is
$$
(\mathcal{M} \otimes_\mathcal{A} \mathcal{N})^n =
\Coker\left(
\bigoplus\nolimits_{r + s + t = n} \mathcal{M}^r \otimes_\mathcal{O}
\mathcal{A}^s \otimes_\mathcal{O} \mathcal{N}^t
\longrightarrow
\bigoplus\nolimits_{p + q = n} \mathcal{M}^p \otimes_\mathcal{O} \mathcal{N}^q
\right)
$$
where the map sends the local section $x \otimes a \otimes y$
of $\mathcal{M}^r \otimes_\mathcal{O} \mathcal{A}^s
\otimes_\mathcal{O} \mathcal{N}^t$ to
$xa \otimes y - x \otimes ay$.
With this definition we have that
$(\mathcal{M} \otimes_\mathcal{A} \mathcal{N})^n$
is the sheafification of the presheaf
$U \mapsto (\mathcal{M}(U) \otimes_{\mathcal{A}(U)} \mathcal{N}(U))^n$
where the tensor product of graded modules is as defined in
Differential Graded Algebra, Section \ref{dga-section-tensor-product}.

\medskip\noindent
If we fix the left graded $\mathcal{A}$-module $\mathcal{N}$
we obtain a functor
$$
- \otimes_\mathcal{A} \mathcal{N} :
\text{Mod}_\mathcal{A}
\longrightarrow
\text{Mod}_\mathcal{O}
$$
where on the right hand side we have the category of graded
$\mathcal{O}$-modules where $\mathcal{O}$ is viewed as a
graded $\mathcal{O}$-algebra (sitting in degree $0$ to be sure).
This can be upgraded to a functor of graded categories
$$
- \otimes_\mathcal{A} \mathcal{N} :
\text{Mod}^{gr}_\mathcal{A}
\longrightarrow
\text{Mod}^{gr}_\mathcal{O}
$$
by sending homomorphisms of degree $n$ from $\mathcal{M} \to \mathcal{M}'$
to the induced map of degree $n$ from
$\mathcal{M} \otimes_\mathcal{A} \mathcal{N}$ to
$\mathcal{M}' \otimes_\mathcal{A} \mathcal{N}$.






\section{Internal hom for sheaves of graded modules}
\label{section-internal-hom-graded}

\noindent
We urge the reader to skip this section.

\medskip\noindent
We are going to need the sheafified version of the construction
in Section \ref{section-gm-gr-cat}.
Let $(\mathcal{C}, \mathcal{O})$, $\mathcal{A}$,
$\mathcal{M}$, $\mathcal{L}$ be as in Section \ref{section-gm-gr-cat}.
Then we define
$$
\SheafHom^{gr}_\mathcal{A}(\mathcal{M}, \mathcal{L})
$$
as the graded $\mathcal{O}$-module whose degree $n$ term
$$
\SheafHom^n_\mathcal{A}(\mathcal{M}, \mathcal{L})
\subset
\prod\nolimits_{p + q = n}
\SheafHom_\mathcal{O}(\mathcal{L}^{-q}, \mathcal{M}^p)
$$
is the subsheaf consisting of those local sections $f = (f_{p, q})$ such that
$$
f_{p, q}(m a) = f_{p - i, q + i}(m)a
$$
for local sections $a$ of $\mathcal{A}^i$ and
$m$ of $\mathcal{L}^{-q - i}$. As in Section \ref{section-gm-gr-cat}
there is a composition map
$$
\SheafHom^{gr}_\mathcal{A}(\mathcal{L}, \mathcal{M}) \otimes_\mathcal{O}
\SheafHom^{gr}_\mathcal{A}(\mathcal{K}, \mathcal{L})
\longrightarrow
\SheafHom^{gr}_\mathcal{A}(\mathcal{K}, \mathcal{M})
$$
where the left hand side is the tensor product of graded $\mathcal{O}$-modules
defined in Section \ref{section-tensor-product}.
This map is given by the composition map
$$
\SheafHom^m_\mathcal{A}(\mathcal{L}, \mathcal{M}) \otimes_\mathcal{O}
\SheafHom^n_\mathcal{A}(\mathcal{K}, \mathcal{L}) \longrightarrow
\SheafHom^{n + m}_\mathcal{A}(\mathcal{K}, \mathcal{M})
$$
defined by simple composition (locally).

\medskip\noindent
With these definitions we have
$$
\Hom_{\text{Mod}^{gr}_\mathcal{A}}(\mathcal{L}, \mathcal{M}) =
\Gamma(\mathcal{C}, \SheafHom^{gr}_\mathcal{A}(\mathcal{L}, \mathcal{M}))
$$
as graded $R$-modules compatible with composition.







\section{Sheaves of graded bimodules and tensor-hom adjunction}
\label{section-graded-bimodules}

\noindent
Please skip this section.

\begin{definition}
\label{definition-bimodule}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let $\mathcal{A}$
and $\mathcal{B}$ be a sheaves of graded algebras on
$(\mathcal{C}, \mathcal{O})$. A
{\it graded $(\mathcal{A}, \mathcal{B})$-bimodule}
is given by a family $\mathcal{M}^n$ indexed by $n \in \mathbf{Z}$
of $\mathcal{O}$-modules endowed with $\mathcal{O}$-bilinear maps
$$
\mathcal{M}^n \times \mathcal{B}^m \to \mathcal{M}^{n + m},\quad
(x, b) \longmapsto xb
$$
and
$$
\mathcal{A}^n \times \mathcal{M}^m \to \mathcal{M}^{n + m},\quad
(a, x) \longmapsto ax
$$
called the multiplication maps with the following properties
\begin{enumerate}
\item multiplication satisfies $a(a'x) = (aa')x$ and
$(xb)b' = x(bb')$,
\item $(ax)b = a(xb)$,
\item the identity section $1$ of $\mathcal{A}^0$ acts as the
identity by multiplication, and
\item the identity section $1$ of
$\mathcal{B}^0$ acts as the identity by multiplication.
\end{enumerate}
We often denote such a structure $\mathcal{M}$.
A {\it homomorphism of graded $(\mathcal{A}, \mathcal{B})$-bimodules}
$f : \mathcal{M} \to \mathcal{N}$ is a family of maps
$f^n : \mathcal{M}^n \to \mathcal{N}^n$
of $\mathcal{O}$-modules compatible with the multiplication maps.
\end{definition}

\noindent
Given a graded $(\mathcal{A}, \mathcal{B})$-bimodule $\mathcal{M}$
and an object $U \in \Ob(\mathcal{C})$ we use the notation
$$
\mathcal{M}(U) =
\Gamma(U, \mathcal{M}) =
\bigoplus\nolimits_{n \in \mathbf{Z}} \mathcal{M}^n(U)
$$
This is a graded $(\mathcal{A}(U), \mathcal{B}(U))$-bimodule.

\medskip\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let $\mathcal{A}$
and $\mathcal{B}$ be a sheaves of graded algebras on
$(\mathcal{C}, \mathcal{O})$. Let $\mathcal{M}$ be a right
graded $\mathcal{A}$-module and let $\mathcal{N}$ be a
graded $(\mathcal{A}, \mathcal{B})$-bimodule. In this case the
graded tensor product defined in Section \ref{section-tensor-product}
$$
\mathcal{M} \otimes_\mathcal{A} \mathcal{N}
$$
is a right graded $\mathcal{B}$-module with obvious multiplication maps.
This construction defines a functor and a functor of graded categories
$$
\otimes_\mathcal{A} \mathcal{N} :
\text{Mod}_\mathcal{A}
\longrightarrow
\text{Mod}_\mathcal{B}
\quad\text{and}\quad
\otimes_\mathcal{A} \mathcal{N} :
\text{Mod}^{gr}_\mathcal{A}
\longrightarrow
\text{Mod}^{gr}_\mathcal{B}
$$
by sending homomorphisms of degree $n$ from $\mathcal{M} \to \mathcal{M}'$
to the induced map of degree $n$ from
$\mathcal{M} \otimes_\mathcal{A} \mathcal{N}$ to
$\mathcal{M}' \otimes_\mathcal{A} \mathcal{N}$.

\medskip\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let $\mathcal{A}$
and $\mathcal{B}$ be a sheaves of graded algebras on
$(\mathcal{C}, \mathcal{O})$. Let $\mathcal{N}$ be a
graded $(\mathcal{A}, \mathcal{B})$-bimodule. Let 
$\mathcal{L}$ be a right graded $\mathcal{B}$-module.
In this case the graded internal hom
defined in Section \ref{section-internal-hom-graded}
$$
\SheafHom_\mathcal{B}^{gr}(\mathcal{N}, \mathcal{L})
$$
is a right graded $\mathcal{A}$-module with
multiplication maps\footnote{Our conventions are here
that this does not involve any signs.}
$$
\SheafHom^n_\mathcal{B}(\mathcal{N}, \mathcal{L})
\times \mathcal{A}^m
\longrightarrow
\SheafHom^{n + m}_\mathcal{B}(\mathcal{N}, \mathcal{L})
$$
sending a section $f = (f_{p,q})$ of
$\SheafHom^n_\mathcal{B}(\mathcal{N}, \mathcal{L})$ over $U$
and a section $a$ of $\mathcal{A}^m$ over $U$ to the section
$f a$ if $\SheafHom^{n + m}_\mathcal{B}(\mathcal{N}, \mathcal{L})$ over $U$
defined as the family of maps
$$
\mathcal{N}^{-q - m}|_U \xrightarrow{a \cdot -}
\mathcal{N}^{-q}|_U \xrightarrow{f_{p, q}}
\mathcal{M}^p|_U
$$
We omit the verification that this is well defined. This construction
defines a functor and a functor of graded categories
$$
\SheafHom_\mathcal{B}^{gr}(\mathcal{N}, -) :
\text{Mod}_\mathcal{B}
\longrightarrow
\text{Mod}_\mathcal{A}
\quad\text{and}\quad
\SheafHom_\mathcal{B}^{gr}(\mathcal{N}, -) :
\text{Mod}^{gr}_\mathcal{B}
\longrightarrow
\text{Mod}^{gr}_\mathcal{A}
$$
by sending homomorphisms of degree $n$ from $\mathcal{L} \to \mathcal{L}'$
to the induced map of degree $n$ from
$\SheafHom_\mathcal{B}^{gr}(\mathcal{N}, \mathcal{L})$ to
$\SheafHom_\mathcal{B}^{gr}(\mathcal{N}, \mathcal{L}')$.

\begin{lemma}
\label{lemma-tensor-hom-adjunction-gr}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let $\mathcal{A}$
and $\mathcal{B}$ be a sheaves of graded algebras on
$(\mathcal{C}, \mathcal{O})$. Let $\mathcal{M}$ be a right
graded $\mathcal{A}$-module. Let $\mathcal{N}$ be a
graded $(\mathcal{A}, \mathcal{B})$-bimodule. Let $\mathcal{L}$
be a right graded $\mathcal{B}$-module. With conventions as above
we have
$$
\Hom_{\text{Mod}_\mathcal{B}^{gr}}(
\mathcal{M} \otimes_\mathcal{A} \mathcal{N}, \mathcal{L}) =
\Hom_{\text{Mod}_\mathcal{A}^{gr}}(
\mathcal{M}, \SheafHom_\mathcal{B}^{gr}(\mathcal{N}, \mathcal{L}))
$$
and
$$
\SheafHom_\mathcal{B}^{gr}(
\mathcal{M} \otimes_\mathcal{A} \mathcal{N}, \mathcal{L}) =
\SheafHom_\mathcal{A}^{gr}(
\mathcal{M}, \SheafHom_\mathcal{B}^{gr}(\mathcal{N}, \mathcal{L}))
$$
functorially in $\mathcal{M}$, $\mathcal{N}$, $\mathcal{L}$.
\end{lemma}

\begin{proof}
Omitted. Hint: This follows by interpreting both sides as
$\mathcal{A}$-bilinear graded maps
$\psi : \mathcal{M} \times \mathcal{N} \to \mathcal{L}$
which are $\mathcal{B}$-linear on the right.
\end{proof}

\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let $\mathcal{A}$
and $\mathcal{B}$ be a sheaves of graded algebras on
$(\mathcal{C}, \mathcal{O})$.
As a special case of the above, suppose we are given
a homomorphism $\varphi : \mathcal{A} \to \mathcal{B}$
of graded $\mathcal{O}$-algebras. Then we obtain a functor
and a functor of graded categories
$$
\otimes_{\mathcal{A}, \varphi} \mathcal{B} :
\text{Mod}_\mathcal{A}
\longrightarrow
\text{Mod}_\mathcal{B}
\quad\text{and}\quad
\otimes_{\mathcal{A}, \varphi} \mathcal{B} :
\text{Mod}^{gr}_\mathcal{A}
\longrightarrow
\text{Mod}^{gr}_\mathcal{B}
$$
On the other hand, we have the restriction functors
$$
res_\varphi :
\text{Mod}_\mathcal{B}
\longrightarrow
\text{Mod}_\mathcal{A}
\quad\text{and}\quad
res_\varphi :
\text{Mod}^{gr}_\mathcal{B}
\longrightarrow
\text{Mod}^{gr}_\mathcal{A}
$$
We can use the lemma above to show these functors are adjoint to
each other (as usual with restriction and base change). Namely,
let us write ${}_\mathcal{A}\mathcal{B}_\mathcal{B}$ for
$\mathcal{B}$ viewed as a graded $(\mathcal{A}, \mathcal{B})$-bimodule.
Then for any right graded $\mathcal{B}$-module $\mathcal{L}$
we have
$$
\SheafHom_\mathcal{B}^{gr}({}_\mathcal{A}\mathcal{B}_\mathcal{B}, \mathcal{L})
= res_\varphi(\mathcal{L})
$$
as right graded $\mathcal{A}$-modules. Thus
Lemma \ref{lemma-tensor-hom-adjunction-gr}
tells us that we have a functorial isomorphism
$$
\Hom_{\text{Mod}_\mathcal{B}^{gr}}(
\mathcal{M} \otimes_{\mathcal{A}, \varphi} \mathcal{B}, \mathcal{L}) =
\Hom_{\text{Mod}_\mathcal{A}^{gr}}(
\mathcal{M}, res_\varphi(\mathcal{L}))
$$
We usually drop the dependence on $\varphi$ in this formula if it
is clear from context. In the same manner we obtain
the equality
$$
\SheafHom^{gr}_\mathcal{B}(
\mathcal{M} \otimes_\mathcal{A} \mathcal{B}, \mathcal{L}) =
\SheafHom_\mathcal{A}^{gr}(\mathcal{M}, \mathcal{L})
$$
of graded $\mathcal{O}$-modules.




\section{Pull and push for sheaves of graded modules}
\label{section-functoriality-graded}

\noindent
We advise the reader to skip this section.

\medskip\noindent
Let $(f, f^\sharp) : (\Sh(\mathcal{C}), \mathcal{O}_\mathcal{C})
\to (\Sh(\mathcal{D}), \mathcal{O}_\mathcal{D})$
be a morphism of ringed topoi. Let $\mathcal{A}$ be a
graded $\mathcal{O}_\mathcal{C}$-algebra. Let $\mathcal{B}$ be a
graded $\mathcal{O}_\mathcal{D}$-algebra.
Suppose we are given a map
$$
\varphi : f^{-1}\mathcal{B} \to \mathcal{A}
$$
of graded $f^{-1}\mathcal{O}_\mathcal{D}$-algebras or equivalently
$\varphi$ can be viewed as a map
$$
\varphi : \mathcal{B} \to f_*\mathcal{A}
$$
of graded $\mathcal{O}_\mathcal{D}$-algebras.
See Remark \ref{remark-functoriality-ga}.

\medskip\noindent
Let us define a functor
$$
f_* :
\text{Mod}_\mathcal{A}
\longrightarrow
\text{Mod}_\mathcal{B}
$$
Given a graded $\mathcal{A}$-module $\mathcal{M}$ we define
$f_*\mathcal{M}$ to be the graded $\mathcal{B}$-module
whose degree $n$ term is $f_*\mathcal{M}^n$. As multiplication
we use
$$
f_*\mathcal{M}^n \times \mathcal{B}^m
\xrightarrow{(\text{id}, \varphi^m)}
f_*\mathcal{M}^n \times f_*\mathcal{A}^m
\xrightarrow{f_*\mu_{n, m}}
f_*\mathcal{M}^{n + m}
$$
where $\mu_{n, m} : \mathcal{M}^n \times \mathcal{A}^m
\to \mathcal{M}^{n + m}$ is the multiplication map for $\mathcal{M}$
over $\mathcal{A}$. This uses that $f_*$ commutes with products.
The construction is clearly functorial in
$\mathcal{M}$ and we obtain our functor.

\medskip\noindent
Let us define a functor
$$
f^* :
\text{Mod}_\mathcal{B}
\longrightarrow
\text{Mod}_\mathcal{A}
$$
We will define this functor as a composite of functors
$$
\text{Mod}_\mathcal{B}
\xrightarrow{f^{-1}}
\text{Mod}_{f^{-1}\mathcal{B}}
\xrightarrow{ - \otimes_{f^{-1}\mathcal{B}} \mathcal{A}}
\text{Mod}_\mathcal{A}
$$
First, given a graded $\mathcal{B}$-module $\mathcal{N}$ we define
$f^{-1}\mathcal{N}$ to be the graded $f^{-1}\mathcal{B}$-module
whose degree $n$ term is $f^{-1}\mathcal{N}^n$. As multiplication
we use
$$
f^{-1}\nu_{n, m} :
f^{-1}\mathcal{N}^n \times f^{-1}\mathcal{B}^m
\longrightarrow
f^{-1}\mathcal{N}^{n + m}
$$
where $\nu_{n, m} : \mathcal{N}^n \times \mathcal{B}^m
\to \mathcal{N}^{n + m}$ is the multiplication map for $\mathcal{N}$
over $\mathcal{B}$. This uses that $f^{-1}$ commutes with products.
The construction is clearly functorial in
$\mathcal{N}$ and we obtain our functor $f^{-1}$.
Having said this, we can use the tensor
product discussion in Section \ref{section-graded-bimodules}
to define the functor
$$
- \otimes_{f^{-1}\mathcal{B}} \mathcal{A} :
\text{Mod}_{f^{-1}\mathcal{B}}
\longrightarrow
\text{Mod}_\mathcal{A}
$$
Finally, we set
$$
f^*\mathcal{N} =
f^{-1}\mathcal{N} \otimes_{f^{-1}\mathcal{B}, \varphi} \mathcal{A}
$$
as already foretold above.

\medskip\noindent
The functors $f_*$ and $f^*$ are readily enhanced to give
functors of graded categories
$$
f_* :
\text{Mod}^{gr}_\mathcal{A}
\longrightarrow
\text{Mod}^{gr}_\mathcal{B}
\quad\text{and}\quad
f^* :
\text{Mod}^{gr}_\mathcal{B}
\longrightarrow
\text{Mod}^{gr}_\mathcal{A}
$$
which do the same thing on underlying objects and are defined
by functoriality of the constructions on homogenous morphisms
of degree $n$.

\begin{lemma}
\label{lemma-adjunction-push-pull-gr}
In the situation above we have
$$
\Hom_{\text{Mod}_\mathcal{B}^{gr}}(
\mathcal{N}, f_*\mathcal{M}) =
\Hom_{\text{Mod}_\mathcal{A}^{gr}}(
f^*\mathcal{N}, \mathcal{M})
$$
\end{lemma}

\begin{proof}
Omitted. Hints: First prove that $f^{-1}$ and $f_*$ are adjoint
as functors between $\text{Mod}_\mathcal{B}$ and
$\text{Mod}_{f^{-1}\mathcal{B}}$ using the adjunction between
$f^{-1}$ and $f_*$ on sheaves of abelian groups.
Next, use the adjunction between base change and restriction
given in Section \ref{section-graded-bimodules}.
\end{proof}





\section{Localization and sheaves of graded modules}
\label{section-localize-graded}

\noindent
We advise the reader to skip this section.

\medskip\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $U \in \Ob(\mathcal{C})$ and denote
$$
j :
(\Sh(\mathcal{C}/U), \mathcal{O}_U)
\longrightarrow
(\Sh(\mathcal{C}), \mathcal{O})
$$
the corresponding localization morphism
(Modules on Sites, Section \ref{sites-modules-section-localize}).
Below we will use the following fact: for $\mathcal{O}_U$-modules
$\mathcal{M}_i$, $i = 1, 2$ and a $\mathcal{O}$-module $\mathcal{A}$
there is a canonical map
$$
j_! :
\Hom_{\mathcal{O}_U}(
\mathcal{M}_1 \otimes_{\mathcal{O}_U} \mathcal{A}|_U, \mathcal{M}_2)
\longrightarrow
\Hom_\mathcal{O}(
j_!\mathcal{M}_1 \otimes_\mathcal{O} \mathcal{A}, j_!\mathcal{M}_2)
$$
Namely, we have
$j_!(\mathcal{M}_1 \otimes_{\mathcal{O}_U} \mathcal{A}|_U) =
j_!\mathcal{M}_1 \otimes_\mathcal{O} \mathcal{A}$ by
Modules on Sites, Lemma \ref{sites-modules-lemma-j-shriek-and-tensor}.

\medskip\noindent
Let $\mathcal{A}$ be a graded $\mathcal{O}$-algebra.
We will denote $\mathcal{A}_U$ the restriction of $\mathcal{A}$
to $\mathcal{C}/U$, in other words, we have
$\mathcal{A}_U = j^*\mathcal{A} = j^{-1}\mathcal{A}$.
In Section \ref{section-functoriality-graded}
we have constructed adjoint functors
$$
j_* :
\text{Mod}^{gr}_{\mathcal{A}_U}
\longrightarrow
\text{Mod}^{gr}_\mathcal{A}
\quad\text{and}\quad
j^* :
\text{Mod}^{gr}_\mathcal{A}
\longrightarrow
\text{Mod}^{gr}_{\mathcal{A}_U}
$$
with $j^*$ left adjoint to $j_*$. We claim there is in addition an
exact functor
$$
j_! :
\text{Mod}^{gr}_{\mathcal{A}_U}
\longrightarrow
\text{Mod}^{gr}_\mathcal{A}
$$
left adjoint to $j^*$. Namely, given a graded $\mathcal{A}_U$-module
$\mathcal{M}$ we define $j_!\mathcal{M}$ to be the graded $\mathcal{A}$-module
whose degree $n$ term is $j_!\mathcal{M}^n$. As multiplication map
we use
$$
j_!\mu_{n, m} :
j_!\mathcal{M}^n \times \mathcal{A}^m \to
j_!\mathcal{M}^{n + m}
$$
where $\mu_{m, n} : \mathcal{M}^n \times \mathcal{A}^m \to \mathcal{M}^{n + m}$
is the given multiplication map. Given a homogeneous map
$f : \mathcal{M} \to \mathcal{M}'$ of degree $n$ of graded
$\mathcal{A}_U$-modules, we obtain a homogeneous map
$j_!f : j_!\mathcal{M} \to j_!\mathcal{M}'$ of degree $n$.
Thus we obtain our functor.

\begin{lemma}
\label{lemma-extension-by-zero-graded}
In the situation above we have
$$
\Hom_{\text{Mod}_\mathcal{A}^{gr}}(
j_!\mathcal{M}, \mathcal{N}) =
\Hom_{\text{Mod}_{\mathcal{A}_U}^{gr}}(
\mathcal{M}, j^*\mathcal{N})
$$
\end{lemma}

\begin{proof}
By the discussion in
Modules on Sites, Section \ref{sites-modules-section-localize}
the functors $j_!$ and $j^*$ on $\mathcal{O}$-modules are adjoint.
Thus if we only look at the $\mathcal{O}$-module structures
we know that
$$
\Hom_{\text{Mod}_\mathcal{O}^{gr}}(
j_!\mathcal{M}, \mathcal{N}) =
\Hom_{\text{Mod}_{\mathcal{O}_U}^{gr}}(
\mathcal{M}, j^*\mathcal{N})
$$
Then one has to check that these identifications map the
$\mathcal{A}$-module maps on the left hand side to the
$\mathcal{A}_U$-module maps on the right hand side.
To check this, given $\mathcal{O}_U$-linear maps
$f^n : \mathcal{M}^n \to j^*\mathcal{N}^{n + d}$
corresponding to $\mathcal{O}$-linear maps
$g^n : j_!\mathcal{M}^n \to \mathcal{N}^{n + d}$
it suffices to show that
$$
\xymatrix{
\mathcal{M}^n \otimes_{\mathcal{O}_U} \mathcal{A}_U^m
\ar[r]_{f^n \otimes 1} \ar[d] &
j^*\mathcal{N}^{n + d} \otimes_{\mathcal{O}_U} \mathcal{A}_U^m \ar[d] \\
\mathcal{M}^{n + m} \ar[r]^{f^{n + m}} &
j^*\mathcal{N}^{n + m + d}
}
$$
commutes if and only if
$$
\xymatrix{
j_!\mathcal{M}^n \otimes_\mathcal{O} \mathcal{A}^m
\ar[r]_{g^n \otimes 1} \ar[d] &
\mathcal{N}^{n + d} \otimes_\mathcal{O} \mathcal{A}_U^m \ar[d] \\
j_!\mathcal{M}^{n + m} \ar[r]^{g^{n + m}} &
\mathcal{N}^{n + m + d}
}
$$
commutes. However, we know that
\begin{align*}
\Hom_{\mathcal{O}_U}(\mathcal{M}^n \otimes_{\mathcal{O}_U} \mathcal{A}_U^m,
j^*\mathcal{N}^{n + d + m})
& =
\Hom_\mathcal{O}(j_!(\mathcal{M}^n \otimes_{\mathcal{O}_U} \mathcal{A}_U^m),
\mathcal{N}^{n + d + m}) \\
& =
\Hom_\mathcal{O}(j_!\mathcal{M}^n \otimes_\mathcal{O} \mathcal{A}^m,
\mathcal{N}^{n + d + m})
\end{align*}
by the already used
Modules on Sites, Lemma \ref{sites-modules-lemma-j-shriek-and-tensor}.
We omit the verification that shows that the obstruction to the
commutativity of the first diagram in the first group maps
to the obstruction to the commutativity of the second diagram
in the last group.
\end{proof}

\begin{lemma}
\label{lemma-tensor-with-extension-by-zero}
In the situation above, let $\mathcal{M}$ be a right graded
$\mathcal{A}_U$-module and let $\mathcal{N}$ be a left graded
$\mathcal{A}$-module. Then
$$
j_!\mathcal{M} \otimes_\mathcal{A} \mathcal{N} =
j_!(\mathcal{M} \otimes_{\mathcal{A}_U} \mathcal{N}|_U)
$$
as graded $\mathcal{O}$-modules functorially in $\mathcal{M}$
and $\mathcal{N}$.
\end{lemma}

\begin{proof}
Recall that the degree $n$ component of
$j_!\mathcal{M} \otimes_\mathcal{A} \mathcal{N}$ is the cokernel of
the canonical map
$$
\bigoplus\nolimits_{r + s + t = n}
j_!\mathcal{M}^r \otimes_\mathcal{O}
\mathcal{A}^s \otimes_\mathcal{O}
\mathcal{N}^t
\longrightarrow
\bigoplus\nolimits_{p + q = n}
j_!\mathcal{M}^p \otimes_\mathcal{O} \mathcal{N}^q
$$
See Section \ref{section-tensor-product}.
By Modules on Sites, Lemma \ref{sites-modules-lemma-j-shriek-and-tensor}
this is the same thing as the cokernel of
$$
\bigoplus\nolimits_{r + s + t = n}
j_!(\mathcal{M}^r \otimes_{\mathcal{O}_U}
\mathcal{A}^s|_U \otimes_{\mathcal{O}_U}
\mathcal{N}^t|_U)
\longrightarrow
\bigoplus\nolimits_{p + q = n}
j_!(\mathcal{M}^p \otimes_{\mathcal{O}_U} \mathcal{N}^q|_U)
$$
and we win. An alternative proof would be to redo the Yoneda
argument given in the proof of the lemma cited above.
\end{proof}








\section{Shift functors on sheaves of graded modules}
\label{section-shift}

\noindent
We urge the reader to skip this section. It turns out that sheaves
of graded modules over a graded algebra are an example of the phenomenon
discussed in
Differential Graded Algebra, Remark \ref{dga-remark-graded-shift-functors}.

\medskip\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of graded algebras
on $(\mathcal{C}, \mathcal{O})$.
Let $\mathcal{M}$ be a graded $\mathcal{A}$-module. Let $k \in \mathbf{Z}$.
We define the {\it $k$th shift of} $\mathcal{M}$, denoted $\mathcal{M}[k]$,
to be the graded $\mathcal{A}$-module whose $n$th part is given by
$$
(\mathcal{M}[k])^n = \mathcal{M}^{n + k}
$$
is the $(n + k)$th part of $\mathcal{M}$. As multiplication maps
$$
(\mathcal{M}[k])^n \times \mathcal{A}^m
\longrightarrow
(\mathcal{M}[k])^{n + m}
$$
we simply use the multiplication maps
$$
\mathcal{M}^{n + k} \times \mathcal{A}^m
\longrightarrow
\mathcal{M}[^{n + m + k}
$$
of $\mathcal{M}$. It is clear that we have defined a functor $[k]$,
that we have $[k + l] = [k] \circ [l]$, and that we have
$$
\Hom_{\text{Mod}^{gr}_\mathcal{A}}(\mathcal{L}, \mathcal{M}[k]) =
\Hom_{\text{Mod}^{gr}_\mathcal{A}}(\mathcal{L}, \mathcal{M})[k]
$$
(without the intervention of signs)
functorially in $\mathcal{M}$ and $\mathcal{L}$.
Thus we see indeed that the graded category of graded $\mathcal{A}$-modules
can be recovered from the ordinary category of graded $\mathcal{A}$-modules
and the shift functors as discussed in 
Differential Graded Algebra, Remark \ref{dga-remark-graded-shift-functors}.

\begin{lemma}
\label{lemma-gm-grothendieck-abelian}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a graded $\mathcal{O}$-algebra.
The category $\text{Mod}_\mathcal{A}$ is a Grothendieck abelian category.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-gm-abelian} and the definition of a Grothendieck
abelian category
(Injectives, Definition \ref{injectives-definition-grothendieck-conditions})
it suffices to
show that $\text{Mod}_\mathcal{A}$ has a generator. We claim that
$$
\mathcal{G} = \bigoplus\nolimits_{k, U} j_{U!}\mathcal{A}_U[k]
$$
is a generator where the sum is over all objects $U$ of $\mathcal{C}$
and $k \in \mathbf{Z}$. Indeed, given a graded $\mathcal{A}$-module
$\mathcal{M}$ if there are no nonzero maps from $\mathcal{G}$ to $\mathcal{M}$,
then we see that for all $k$ and $U$ we have
$$
\Hom_{\text{Mod}_\mathcal{A}}(j_{U!}\mathcal{A}_U[k], \mathcal{M}) =
\Hom_{\text{Mod}_{\mathcal{A}_U}}(\mathcal{A}_U[k], \mathcal{M}|_U) =
\Gamma(U, \mathcal{M}^{-k})
$$
is equal to zero. Hence $\mathcal{M}$ is zero.
\end{proof}









\section{Sheaves of differential graded algebras}
\label{section-dga}

\noindent
This section is the analogue of
Differential Graded Algebra, Section \ref{dga-section-dga}.

\begin{definition}
\label{definition-dga}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. A
{\it sheaf of differential graded $\mathcal{O}$-algebras}
or a {\it sheaf of differential graded algebras} on
$(\mathcal{C}, \mathcal{O})$ is a cochain complex
$\mathcal{A}^\bullet$ of $\mathcal{O}$-modules
endowed with $\mathcal{O}$-bilinear maps
$$
\mathcal{A}^n \times \mathcal{A}^m \to \mathcal{A}^{n + m},\quad
(a, b) \longmapsto ab
$$
called the multiplication maps with the following properties
\begin{enumerate}
\item multiplication is associative,
\item there is a global section $1$ of $\mathcal{A}^0$
which is a two-sided identity for multiplication,
\item for $U \in \Ob(\mathcal{C})$, $a \in \mathcal{A}^n(U)$, and
$b \in \mathcal{A}^m(U)$ we have
$$
\text{d}^{n + m}(ab) = \text{d}^n(a)b + (-1)^n a\text{d}^m(b)
$$
\end{enumerate}
We often denote such a structure $(\mathcal{A}, \text{d})$.
A {\it homomorphism of differential graded $\mathcal{O}$-algebras}
from $(\mathcal{A}, \text{d})$ to $(\mathcal{B}, \text{d})$ is a map
$f : \mathcal{A}^\bullet \to \mathcal{B}^\bullet$ of complexes
of $\mathcal{O}$-modules compatible with the multiplication maps.
\end{definition}

\noindent
Given a differential graded $\mathcal{O}$-algebra $(\mathcal{A}, \text{d})$
and an object $U \in \Ob(\mathcal{C})$ we use the notation
$$
\mathcal{A}(U) =
\Gamma(U, \mathcal{A}) =
\bigoplus\nolimits_{n \in \mathbf{Z}} \mathcal{A}^n(U)
$$
This is a differential graded $\mathcal{O}(U)$-algebra.

\medskip\noindent
As much as possible, we will think of a differential graded
$\mathcal{O}$-algebra $(\mathcal{A}, \text{d})$
as a graded $\mathcal{O}$-algebra $\mathcal{A}$ endowed with
the operator $\text{d} : \mathcal{A} \to \mathcal{A}$ of degree $1$
(where $\mathcal{A}$ is viewed as a graded $\mathcal{O}$-module)
satisfying the Leibniz rule given in the definition.

\begin{remark}
\label{remark-functoriality-dga}
Let $(f, f^\sharp) : (\Sh(\mathcal{C}), \mathcal{O}_\mathcal{C})
\to (\Sh(\mathcal{D}), \mathcal{O}_\mathcal{D})$
be a morphism of ringed topoi.
\begin{enumerate}
\item Let $(\mathcal{A}, \text{d})$ be a differential graded
$\mathcal{O}_\mathcal{C}$-algebra. The pushforward will be
the differential graded $\mathcal{O}_\mathcal{D}$-algebra
$(f_*\mathcal{A}, \text{d})$ where $f_*\mathcal{A}$ is as in
Remark \ref{remark-functoriality-ga} and
$\text{d} = f_*\text{d}$ as maps $f_*\mathcal{A}^n \to f_*\mathcal{A}^{n + 1}$.
We omit the verification that the Leibniz rule is satisfied.
\item Let $\mathcal{B}$ be a differential graded
$\mathcal{O}_\mathcal{D}$-algebra. The pullback will be the
differential graded $\mathcal{O}_\mathcal{C}$-algebra
$(f^*\mathcal{B}, \text{d})$ where $f^*\mathcal{B}$ is as in
Remark \ref{remark-functoriality-ga} and
$\text{d} = f^*\text{d}$ as maps $f^*\mathcal{B}^n \to f^*\mathcal{B}^{n + 1}$.
We omit the verification that the Leibniz rule is satisfied.
\item The set of homomorphisms $f^*\mathcal{B} \to \mathcal{A}$
of differential graded $\mathcal{O}_\mathcal{C}$-algebras is in
$1$-to-$1$ correspondence with the set of homomorphisms
$\mathcal{B} \to f_*\mathcal{A}$ of differential graded
$\mathcal{O}_\mathcal{D}$-algebras.
\end{enumerate}
Part (3) follows immediately from the usual adjunction between $f^*$ and $f_*$
on sheaves of modules.
\end{remark}
















\section{Sheaves of differential graded modules}
\label{section-modules}

\noindent
This section is the analogue of
Differential Graded Algebra, Section \ref{dga-section-modules}.

\begin{definition}
\label{definition-dgm}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $(\mathcal{A}, \text{d})$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$.
A (right) {\it differential graded $\mathcal{A}$-module} or (right)
{\it differential graded module} over $\mathcal{A}$
is a cochain complex $\mathcal{M}^\bullet$ endowed with
$\mathcal{O}$-bilinear maps
$$
\mathcal{M}^n \times \mathcal{A}^m \to \mathcal{M}^{n + m},\quad
(x, a) \longmapsto xa
$$
called the multiplication maps with the following properties
\begin{enumerate}
\item multiplication satisfies $(xa)a' = x(aa')$,
\item the identity section $1$ of $\mathcal{A}^0$
acts as the identity on $\mathcal{M}^n$ for all $n$,
\item for $U \in \Ob(\mathcal{C})$, $x \in \mathcal{M}^n(U)$, and
$a \in \mathcal{A}^m(U)$ we have
$$
\text{d}^{n + m}(xa) = \text{d}^n(x)a + (-1)^n x\text{d}^m(a)
$$
\end{enumerate}
We often say ``let $\mathcal{M}$ be a differential graded
$\mathcal{A}$-module'' to indicate this situation.
A {\it homomorphism of differential graded $\mathcal{A}$-modules}
from $\mathcal{M}$ to $\mathcal{N}$ is a map
$f : \mathcal{M}^\bullet \to \mathcal{N}^\bullet$ of complexes
of $\mathcal{O}$-modules compatible with the multiplication maps.
The category of (right) differential graded $\mathcal{A}$-modules
is denoted $\text{Mod}_{(\mathcal{A}, \text{d})}$.
\end{definition}

\noindent
We can define {\it left differential graded modules} in exactly the same manner
but our default in the chapter will be right modules.

\medskip\noindent
Given a differential graded $\mathcal{A}$-module $\mathcal{M}$
and an object $U \in \Ob(\mathcal{C})$ we use the notation
$$
\mathcal{M}(U) =
\Gamma(U, \mathcal{M}) =
\bigoplus\nolimits_{n \in \mathbf{Z}} \mathcal{M}^n(U)
$$
This is a (right) differential graded $\mathcal{A}(U)$-module.

\begin{lemma}
\label{lemma-dgm-abelian}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $(\mathcal{A}, \text{d})$ be a differential graded $\mathcal{O}$-algebra.
The category $\text{Mod}_{(\mathcal{A}, \text{d})}$ is an abelian category
with the following properties
\begin{enumerate}
\item $\text{Mod}_{(\mathcal{A}, \text{d})}$ has arbitrary direct sums,
\item $\text{Mod}_{(\mathcal{A}, \text{d})}$ has arbitrary colimits,
\item filtered colimit in $\text{Mod}_{(\mathcal{A}, \text{d})}$ are exact,
\item $\text{Mod}_{(\mathcal{A}, \text{d})}$ has arbitrary products,
\item $\text{Mod}_{(\mathcal{A}, \text{d})}$ has arbitrary limits.
\end{enumerate}
The forgetful functor
$$
\text{Mod}_{(\mathcal{A}, \text{d})}
\longrightarrow
\text{Mod}_\mathcal{A}
$$
sending a differential graded $\mathcal{A}$-module to its underlying
graded module commutes with all limits and colimits.
\end{lemma}

\begin{proof}
Let us denote
$F : \text{Mod}_{(\mathcal{A}, \text{d})} \to \text{Mod}_\mathcal{A}$
the functor in the statement of the lemma. Observe that
the category $\text{Mod}_\mathcal{A}$ has properties (1) -- (5), see
Lemma \ref{lemma-gm-abelian}.

\medskip\noindent
Consider a homomorphism $f : \mathcal{M} \to \mathcal{N}$
of graded $\mathcal{A}$-modules. The kernel
and cokernel of $f$ as maps of graded $\mathcal{A}$-modules
are additionally endowed with differentials as in
Definition \ref{definition-dgm}. Hence these are also
the kernel and cokernel in $\text{Mod}_{(\mathcal{A}, \text{d})}$.
Thus $\text{Mod}_{(\mathcal{A}, \text{d})}$ is an abelian category
and taking kernels and cokernels commutes with $F$.

\medskip\noindent
To prove the existence of limits and colimits it is sufficient
to prove the existence of products and direct sums, see
Categories, Lemmas \ref{categories-lemma-limits-products-equalizers} and
\ref{categories-lemma-colimits-coproducts-coequalizers}.
The same lemmas show that
proving the commutation of limits and colimits with $F$
follows if $F$ commutes with direct sums and products.

\medskip\noindent
Let $\mathcal{M}_t$, $t \in T$ be a set of differential
graded $\mathcal{A}$-modules. Then we can consider the direct
sum $\bigoplus \mathcal{M}_t$ as a graded $\mathcal{A}$-module.
Since the direct sum of graded modules is done termwise, it is
clear that $\bigoplus \mathcal{M}_t$ comes endowed with a differential.
The reader easily verifies that this is a direct sum in
$\text{Mod}_{(\mathcal{A}, \text{d})}$. Similarly for products.

\medskip\noindent
Observe that $F$ is an exact functor and that
a complex $\mathcal{M}_1 \to \mathcal{M}_2 \to \mathcal{M}_3$
of $\text{Mod}_{(\mathcal{A}, \text{d})}$ is exact if and only if
$F(\mathcal{M}_1) \to F(\mathcal{M}_2) \to F(\mathcal{M}_3)$
is exact in $\text{Mod}_\mathcal{A}$. Hence we conclude that (3)
holds as filtered colimits are exact in
$\textit{Mod}_\mathcal{A})$.
\end{proof}

\noindent
Combining Lemmas \ref{lemma-dgm-abelian} and \ref{lemma-gm-abelian}
we find that there is an exact and faithful functor
$$
\text{Mod}_{(\mathcal{A}, \text{d})} \longrightarrow \text{Comp}(\mathcal{O})
$$
of abelian categories. For a differential graded $\mathcal{A}$-module
$\mathcal{M}$ the cohomology $\mathcal{O}$-modules, denoted $H^i(\mathcal{M})$,
are defined as the cohomology of the complex of
$\mathcal{O}$-modules corresponding to $\mathcal{M}$.
Therefore, a short exact sequence 
$0 \to \mathcal{K} \to \mathcal{L} \to \mathcal{M} \to 0$
of differential graded $\mathcal{A}$-modules
gives rise to a long exact sequence
\begin{equation}
\label{equation-les}
H^n(\mathcal{K}) \to H^n(\mathcal{L}) \to H^n(\mathcal{M}) \to
H^{n + 1}(\mathcal{K})
\end{equation}
of cohomology modules, see
Homology, Lemma \ref{homology-lemma-long-exact-sequence-cochain}.

\medskip\noindent
Moreover, from now on we borrow all the terminology used for
complexes of modules. For example, we say that a differential
graded $\mathcal{A}$-module $\mathcal{M}$ is {\it acyclic} if
$H^k(\mathcal{M}) = 0$ for all $k \in \mathbf{Z}$. We say that a
homomorphism $\mathcal{M} \to \mathcal{N}$
of differential graded $\mathcal{A}$-modules is a {\it quasi-isomorphism}
if it induces isomorphisms $H^k(\mathcal{M}) \to H^k(\mathcal{N})$
for all $k \in \mathbf{Z}$. And so on and so forth.


















\section{The differential graded category of modules}
\label{section-dgm-dg-cat}

\noindent
This section is the analogue of
Differential Graded Algebra, Example \ref{dga-example-dgm-dg-cat}.
For our conventions on differential graded categories, please
see Differential Graded Algebra, Section \ref{dga-section-dga-categories}.

\medskip\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $(\mathcal{A}, \text{d})$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$. We will construct
a differential graded category
$$
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
$$
over $R = \Gamma(\mathcal{C}, \mathcal{O})$ whose associated category
of complexes is the category of differential graded $\mathcal{A}$-modules:
$$
\text{Mod}_{(\mathcal{A}, \text{d})} =
\text{Comp}(\text{Mod}^{dg}_{(\mathcal{A}, \text{d})})
$$
As objects of $\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}$ we take right
differential graded $\mathcal{A}$-modules, see
Section \ref{section-modules}. Given differential graded
$\mathcal{A}$-modules $\mathcal{L}$ and $\mathcal{M}$ we set
$$
\Hom_{\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}}(\mathcal{L}, \mathcal{M}) =
\Hom_{\text{Mod}^{gr}_\mathcal{A}}(\mathcal{L}, \mathcal{M}) =
\bigoplus\nolimits_{n \in \mathbf{Z}} \Hom^n(\mathcal{L}, \mathcal{M})
$$
as a graded $R$-module, see Section \ref{section-gm-gr-cat}.
In other words, the $n$th graded piece
$\Hom^n(\mathcal{L}, \mathcal{M})$ is the $R$-module of right
$\mathcal{A}$-module maps homogeneous of degree $n$.
For an element $f \in \Hom^n(\mathcal{L}, \mathcal{M})$ we set
$$
\text{d}(f) =
\text{d}_\mathcal{M} \circ f - (-1)^n f \circ \text{d}_\mathcal{L}
$$
To make sense of this we think of $\text{d}_\mathcal{M}$ and
$\text{d}_\mathcal{L}$ as graded $\mathcal{O}$-module maps and
we use composition of graded $\mathcal{O}$-module maps.
It is clear that $\text{d}(f)$ is homogeneous of
degree $n + 1$ as a graded $\mathcal{O}$-module map, and it is
$\mathcal{A}$-linear because for homogeneous local sections $x$ and $a$
of $\mathcal{M}$ and $\mathcal{A}$ we have
\begin{align*}
\text{d}(f)(xa)
& =
\text{d}_\mathcal{M}(f(x) a) - (-1)^n f (\text{d}_\mathcal{L}(xa)) \\
& =
\text{d}_\mathcal{M}(f(x)) a + (-1)^{\deg(x) + n} f(x) \text{d}(a) 
- (-1)^n f(\text{d}_\mathcal{L}(x)) a - (-1)^{n + \deg(x)} f(x) \text{d}(a) \\
& = \text{d}(f)(x) a
\end{align*}
as desired (observe that this calculation would not work without the
sign in the definition of our differential on $\Hom$).

\medskip\noindent
For differential graded $\mathcal{A}$-modules
$\mathcal{K}$, $\mathcal{L}$, $\mathcal{M}$
we have already defined the composition
$$
\Hom^m(\mathcal{L}, \mathcal{M}) \times
\Hom^n(\mathcal{K}, \mathcal{L}) \longrightarrow
\Hom^{n + m}(\mathcal{K}, \mathcal{M})
$$
in Section \ref{section-gm-gr-cat} by the usual composition
of maps of sheaves. This defines a map of differential graded modules
$$
\Hom_{\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}}(\mathcal{L}, \mathcal{M})
\otimes_R
\Hom_{\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}}(\mathcal{K}, \mathcal{L})
\longrightarrow
\Hom_{\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}}(\mathcal{K}, \mathcal{M})
$$
as required in
Differential Graded Algebra, Definition \ref{dga-definition-dga-category}
because
\begin{align*}
\text{d}(g \circ f) & =
\text{d}_\mathcal{M} \circ g \circ f
- (-1)^{n + m} g \circ f \circ \text{d}_\mathcal{K} \\
& =
\left(\text{d}_\mathcal{M} \circ g - (-1)^m g \circ \text{d}_L\right) \circ f
+ (-1)^m g \circ \left(\text{d}_\mathcal{L} \circ f
- (-1)^n f \circ \text{d}_\mathcal{K}\right) \\
& =
\text{d}(g) \circ f + (-1)^m g \circ \text{d}(f)
\end{align*}
if $f$ has degree $n$ and $g$ has degree $m$ as desired.






\section{Tensor product for sheaves of differential graded modules}
\label{section-tensor-product-dg}

\noindent
This section is the analogue of part of
Differential Graded Algebra, Section \ref{dga-section-tensor-product}.

\medskip\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let
$(\mathcal{A}, \text{d})$
be a sheaf of differential graded algebras on $(\mathcal{C}, \mathcal{O})$.
Let $\mathcal{M}$ be a right differential graded $\mathcal{A}$-module
and let $\mathcal{N}$ be a left differential graded $\mathcal{A}$-module.
In this situation we define the {\it tensor product}
$\mathcal{M} \otimes_\mathcal{A} \mathcal{N}$ as follows.
As a graded $\mathcal{O}$-module it is given by the construction
in Section \ref{section-tensor-product}. It comes endowed
with a differential
$$
\text{d}_{\mathcal{M} \otimes_\mathcal{A} \mathcal{N}} :
(\mathcal{M} \otimes_\mathcal{A} \mathcal{N})^n
\longrightarrow
(\mathcal{M} \otimes_\mathcal{A} \mathcal{N})^{n + 1}
$$
defined by the rule that
$$
\text{d}_{\mathcal{M} \otimes_\mathcal{A} \mathcal{N}}(x \otimes y) =
\text{d}_\mathcal{M}(x) \otimes y +
(-1)^{\deg(x)}x \otimes \text{d}_\mathcal{N}(y)
$$
for homogeneous local sections $x$ and $y$ of $\mathcal{M}$ and $\mathcal{N}$.
To see that this is well defined we have to show that
$\text{d}_{\mathcal{M} \otimes_\mathcal{A} \mathcal{N}}$ annihilates
elements of the form $xa \otimes y - x \otimes ay$ for homogeneous
local sections $x$, $a$, $y$ of $\mathcal{M}$, $\mathcal{A}$, $\mathcal{N}$.
We compute
\begin{align*}
&
\text{d}_{\mathcal{M} \otimes_\mathcal{A} \mathcal{N}}(
xa \otimes y - x \otimes ay) \\
& =
\text{d}_\mathcal{M}(xa) \otimes y + (-1)^{\deg(x) + \deg(a)}
xa \otimes \text{d}_\mathcal{N}(y)
-\text{d}_\mathcal{M}(x) \otimes ay - (-1)^{\deg(x)}
x \otimes \text{d}_\mathcal{N}(ay) \\
& =
\text{d}_\mathcal{M}(x)a \otimes y + (-1)^{\deg(x)}x\text{d}(a) \otimes y
+ (-1)^{\deg(x) + \deg(a)} xa \otimes \text{d}_\mathcal{N}(y) \\
&
-\text{d}_\mathcal{M}(x) \otimes ay - (-1)^{\deg(x)}
x \otimes \text{d}(a)y - (-1)^{\deg(x) +
\deg(a)} x\otimes a\text{d}_\mathcal{N}(y)
\end{align*}
then we observe that the elements
$$
\text{d}_\mathcal{M}(x)a \otimes y - \text{d}_\mathcal{M}(x) \otimes ay,\quad
x\text{d}(a) \otimes y - x \otimes \text{d}(a)y,\quad
\text{and}\quad
xa \otimes \text{d}_\mathcal{N}(y) - x\otimes a\text{d}_\mathcal{N}(y)
$$
map to zero in $\mathcal{M} \otimes_\mathcal{A} \mathcal{N}$
and we conclude. We omit the verification that
$\text{d}_{\mathcal{M} \otimes_\mathcal{A} \mathcal{N}} \circ
\text{d}_{\mathcal{M} \otimes_\mathcal{A} \mathcal{N}} = 0$.

\medskip\noindent
If we fix the left differential graded $\mathcal{A}$-module $\mathcal{N}$
we obtain a functor
$$
- \otimes_\mathcal{A} \mathcal{N} :
\text{Mod}_{(\mathcal{A}, \text{d})}
\longrightarrow
\text{Comp}(\mathcal{O})
$$
where on the right hand side we have the category of complexes of
$\mathcal{O}$-modules. This can be upgraded to a functor of
differential graded categories
$$
- \otimes_\mathcal{A} \mathcal{N} :
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
\longrightarrow
\text{Comp}^{dg}(\mathcal{O})
$$
On underlying graded objects, we send
a homomorphism $f : \mathcal{M} \to \mathcal{M}'$ of degree $n$ 
to the degree $n$ map
$f \otimes \text{id}_\mathcal{N} :
\mathcal{M} \otimes_\mathcal{A} \mathcal{N} \to
\mathcal{M}' \otimes_\mathcal{A} \mathcal{N}$, because
this is what we did in Section \ref{section-tensor-product}.
To show that this works, we have to verify that the map
$$
\Hom_{\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}}(\mathcal{M}, \mathcal{M}')
\longrightarrow
\Hom_{\text{Comp}^{dg}(\mathcal{O})}(
\mathcal{M} \otimes_\mathcal{A} \mathcal{N},
\mathcal{M}' \otimes_\mathcal{A} \mathcal{N})
$$
is compatible with differentials. To see this for $f$ as above
we have to show that
$$
(\text{d}_{\mathcal{M}'} \circ f - (-1)^n f \circ \text{d}_\mathcal{M})
\otimes \text{id}_\mathcal{N}
$$
is equal to
$$
\text{d}_{\mathcal{M}' \otimes_\mathcal{A} \mathcal{N}}
\circ (f \otimes \text{id}_\mathcal{N})
- (-1)^n (f \otimes \text{id}_\mathcal{N}) \circ
\text{d}_{\mathcal{M} \otimes_\mathcal{A} \mathcal{N}}
$$
Let us compute the effect of these operators on a local section
of the form $x \otimes y$ with $x$ and $y$ homogeneous local sections
of $\mathcal{M}$ and $\mathcal{N}$. For the first we obtain
$$
(\text{d}_{\mathcal{M}'}(f(x)) - (-1)^n f(\text{d}_\mathcal{M}(x))) \otimes y
$$
and for the second we obtain
\begin{align*}
&\text{d}_{\mathcal{M}' \otimes_\mathcal{A} \mathcal{N}}(f(x) \otimes y)
- (-1)^n (f \otimes \text{id}_\mathcal{N})(
\text{d}_{\mathcal{M} \otimes_\mathcal{A} \mathcal{N}}(x \otimes y) \\
& =
\text{d}_{\mathcal{M}'}(f(x)) \otimes y +
(-1)^{\deg(x) + n}f(x) \otimes \text{d}_\mathcal{N}(y) \\
&
-(-1)^n f(\text{d}_\mathcal{M}(x)) \otimes y
-(-1)^n (-1)^{\deg(x)}f(x) \otimes \text{d}_\mathcal{N}(y)
\end{align*}
which is indeeed the same local section.










\section{Internal hom for sheaves of differential graded modules}
\label{section-internal-hom-dg}

\noindent
We are going to need the sheafified version of the construction
in Section \ref{section-dgm-dg-cat}.
Let $(\mathcal{C}, \mathcal{O})$, $\mathcal{A}$,
$\mathcal{M}$, $\mathcal{L}$ be as in Section \ref{section-dgm-dg-cat}.
Then we define
$$
\SheafHom^{dg}_\mathcal{A}(\mathcal{M}, \mathcal{L}) =
\SheafHom^{gr}_\mathcal{A}(\mathcal{M}, \mathcal{L}) =
\bigoplus\nolimits_{n \in \mathbf{Z}}
\SheafHom^n_\mathcal{A}(\mathcal{M}, \mathcal{L})
$$
as a graded $\mathcal{O}$-module, see
Section \ref{section-internal-hom-graded}.
In other words, a section $f$ of the $n$th graded piece
$\SheafHom^n_\mathcal{A}(\mathcal{L}, \mathcal{M})$ over $U$
is a map of right $\mathcal{A}_U$-module map
$\mathcal{L}|_U \to \mathcal{M}|_U$ homogeneous of degree $n$.
For such $f$ we set
$$
\text{d}(f) =
\text{d}_\mathcal{M}|_U \circ f - (-1)^n f \circ \text{d}_\mathcal{L}|_U
$$
To make sense of this we think of $\text{d}_\mathcal{M}|_U$ and
$\text{d}_\mathcal{L}|_U$ as graded $\mathcal{O}_U$-module maps and
we use composition of graded $\mathcal{O}_U$-module maps.
It is clear that $\text{d}(f)$ is homogeneous of
degree $n + 1$ as a graded $\mathcal{O}_U$-module map.
Using the exact same computation as in Section \ref{section-dgm-dg-cat}
we see that $\text{d}(f)$ is $\mathcal{A}_U$-linear.

\medskip\noindent
As in Section \ref{section-dgm-dg-cat} there is a composition map
$$
\SheafHom^{dg}_\mathcal{A}(\mathcal{L}, \mathcal{M}) \otimes_\mathcal{O}
\SheafHom^{dg}_\mathcal{A}(\mathcal{K}, \mathcal{L})
\longrightarrow
\SheafHom^{dg}_\mathcal{A}(\mathcal{K}, \mathcal{M})
$$
where the left hand side is the tensor product of
differential graded $\mathcal{O}$-modules
defined in Section \ref{section-tensor-product-dg}. This map
is given by the composition map
$$
\SheafHom^m(\mathcal{L}, \mathcal{M}) \otimes_\mathcal{O}
\SheafHom^n(\mathcal{K}, \mathcal{L}) \longrightarrow
\SheafHom^{n + m}(\mathcal{K}, \mathcal{M})
$$
defined by simple composition (locally). Using the exact same
computation as in Section \ref{section-dgm-dg-cat} on local sections
we see that the composition map is a morphism of differential
graded $\mathcal{O}$-modules.

\medskip\noindent
With these definitions we have
$$
\Hom_{\text{Mod}^{dg}_\mathcal{A}}(\mathcal{L}, \mathcal{M}) =
\Gamma(\mathcal{C}, \SheafHom^{dg}_\mathcal{A}(\mathcal{L}, \mathcal{M}))
$$
as graded $R$-modules compatible with composition.









\section{Sheaves of differential graded bimodules and tensor-hom adjunction}
\label{section-dg-bimodules}

\noindent
This section is the analogue of part of
Differential Graded Algebra, Section \ref{dga-section-tensor-product}.

\begin{definition}
\label{definition-dg-bimodule}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let $\mathcal{A}$
and $\mathcal{B}$ be a sheaves of differential graded algebras on
$(\mathcal{C}, \mathcal{O})$. A
{\it differential graded $(\mathcal{A}, \mathcal{B})$-bimodule}
is given by a complex $\mathcal{M}^\bullet$
of $\mathcal{O}$-modules endowed with $\mathcal{O}$-bilinear maps
$$
\mathcal{M}^n \times \mathcal{B}^m \to \mathcal{M}^{n + m},\quad
(x, b) \longmapsto xb
$$
and
$$
\mathcal{A}^n \times \mathcal{M}^m \to \mathcal{M}^{n + m},\quad
(a, x) \longmapsto ax
$$
called the multiplication maps with the following properties
\begin{enumerate}
\item multiplication satisfies $a(a'x) = (aa')x$ and
$(xb)b' = x(bb')$,
\item $(ax)b = a(xb)$,
\item $\text{d}(ax) = \text{d}(a) x + (-1)^{\deg(a)}a \text{d}(x)$ and
$\text{d}(xb) = \text{d}(x) b + (-1)^{\deg(x)}x \text{d}(b)$,
\item the identity section $1$ of $\mathcal{A}^0$ acts as the
identity by multiplication, and
\item the identity section $1$ of
$\mathcal{B}^0$ acts as the identity by multiplication.
\end{enumerate}
We often denote such a structure $\mathcal{M}$ and sometimes
we write ${}_\mathcal{A}\mathcal{M}_\mathcal{B}$.
A {\it homomorphism of differential graded
$(\mathcal{A}, \mathcal{B})$-bimodules}
$f : \mathcal{M} \to \mathcal{N}$ is a map of complexes
$f : \mathcal{M}^\bullet \to \mathcal{N}^\bullet$
of $\mathcal{O}$-modules compatible with the multiplication maps.
\end{definition}

\noindent
Given a differential graded $(\mathcal{A}, \mathcal{B})$-bimodule $\mathcal{M}$
and an object $U \in \Ob(\mathcal{C})$ we use the notation
$$
\mathcal{M}(U) =
\Gamma(U, \mathcal{M}) =
\bigoplus\nolimits_{n \in \mathbf{Z}} \mathcal{M}^n(U)
$$
This is a differential graded $(\mathcal{A}(U), \mathcal{B}(U))$-bimodule.

\medskip\noindent
Observe that a differential graded $(\mathcal{A}, \mathcal{B})$-bimodule
$\mathcal{M}$ is the same thing as a right differential graded
$\mathcal{B}$-module which is also a left differential graded
$\mathcal{A}$-module such that the grading and differentials agree
and such that the $\mathcal{A}$-module structure commutes with
the $\mathcal{B}$-module structure. Here is a precise statement.

\begin{lemma}
\label{lemma-what-makes-a-bimodule-dg}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let $\mathcal{A}$
and $\mathcal{B}$ be a sheaves of differential graded algebras on
$(\mathcal{C}, \mathcal{O})$. Let $\mathcal{N}$ be a right differential
graded $\mathcal{B}$-module. There is a $1$-to-$1$ correspondence
between $(\mathcal{A}, \mathcal{B})$-bimodule structures on
$\mathcal{N}$ compatible with the given
differential graded $\mathcal{B}$-module structure and homomorphisms
$$
\mathcal{A}
\longrightarrow
\SheafHom^{dg}_\mathcal{B}(\mathcal{N}, \mathcal{N})
$$
of differential graded $\mathcal{O}$-algebras.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let $\mathcal{A}$
and $\mathcal{B}$ be a sheaves of differential graded algebras on
$(\mathcal{C}, \mathcal{O})$. Let $\mathcal{M}$ be a right
differential graded $\mathcal{A}$-module and let $\mathcal{N}$ be a
differential graded $(\mathcal{A}, \mathcal{B})$-bimodule. In this case the
differential graded tensor product defined in
Section \ref{section-tensor-product-dg}
$$
\mathcal{M} \otimes_\mathcal{A} \mathcal{N}
$$
is a right differential graded $\mathcal{B}$-module with
multiplication maps as in Section \ref{section-graded-bimodules}.
This construction defines a functor and a functor of graded categories
$$
\otimes_\mathcal{A} \mathcal{N} :
\text{Mod}_{(\mathcal{A}, \text{d})}
\longrightarrow
\text{Mod}_{(\mathcal{B}, \text{d})}
\quad\text{and}\quad
\otimes_\mathcal{A} \mathcal{N} :
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
\longrightarrow
\text{Mod}^{dg}_{(\mathcal{B}, \text{d})}
$$
by sending homomorphisms of degree $n$ from $\mathcal{M} \to \mathcal{M}'$
to the induced map of degree $n$ from
$\mathcal{M} \otimes_\mathcal{A} \mathcal{N}$ to
$\mathcal{M}' \otimes_\mathcal{A} \mathcal{N}$.

\medskip\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let $\mathcal{A}$
and $\mathcal{B}$ be a sheaves of differential graded algebras on
$(\mathcal{C}, \mathcal{O})$. Let $\mathcal{N}$ be a
differential graded $(\mathcal{A}, \mathcal{B})$-bimodule. Let 
$\mathcal{L}$ be a right differential graded $\mathcal{B}$-module.
In this case the differential graded internal hom
defined in Section \ref{section-internal-hom-dg}
$$
\SheafHom_\mathcal{B}^{dg}(\mathcal{N}, \mathcal{L})
$$
is a right differential graded $\mathcal{A}$-module where the
right graded $\mathcal{A}$-module structure is the one defined
in Section \ref{section-graded-bimodules}. Another way to define
the multiplication is the use the composition
$$
\SheafHom_\mathcal{B}^{dg}(\mathcal{N}, \mathcal{L})
\otimes_\mathcal{O} \mathcal{A}
\to
\SheafHom_\mathcal{B}^{dg}(\mathcal{N}, \mathcal{L})
\otimes_\mathcal{O} \SheafHom_\mathcal{B}^{dg}(\mathcal{N}, \mathcal{N})
\to
\SheafHom_\mathcal{B}^{dg}(\mathcal{N}, \mathcal{L})
$$
where the first arrow comes from Lemma \ref{lemma-what-makes-a-bimodule-dg}
and the second arrow is the composition of
Section \ref{section-internal-hom-dg}. Since these arrows are
both compatible with differentials, we conclude that we indeed
obtain a differential graded $\mathcal{A}$-module.
This construction
defines a functor and a functor of differential graded categories
$$
\SheafHom_\mathcal{B}^{dg}(\mathcal{N}, -) :
\text{Mod}_{(\mathcal{B}, \text{d})}
\longrightarrow
\text{Mod}_\mathcal{A}
\quad\text{and}\quad
\SheafHom_\mathcal{B}^{dg}(\mathcal{N}, -) :
\text{Mod}^{dg}_{(\mathcal{B}, \text{d})}
\longrightarrow
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
$$
by sending homomorphisms of degree $n$ from $\mathcal{L} \to \mathcal{L}'$
to the induced map of degree $n$ from
$\SheafHom_\mathcal{B}^{dg}(\mathcal{N}, \mathcal{L})$ to
$\SheafHom_\mathcal{B}^{dg}(\mathcal{N}, \mathcal{L}')$.

\begin{lemma}
\label{lemma-tensor-hom-adjunction-dg}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let $\mathcal{A}$
and $\mathcal{B}$ be a sheaves of differential graded algebras on
$(\mathcal{C}, \mathcal{O})$. Let $\mathcal{M}$ be a right
differential graded $\mathcal{A}$-module. Let $\mathcal{N}$ be a
differential graded $(\mathcal{A}, \mathcal{B})$-bimodule. Let $\mathcal{L}$
be a right differential graded $\mathcal{B}$-module. With conventions as above
we have
$$
\Hom_{\text{Mod}_{(\mathcal{B}, \text{d})}^{dg}}(
\mathcal{M} \otimes_\mathcal{A} \mathcal{N}, \mathcal{L}) =
\Hom_{\text{Mod}_{(\mathcal{A}, \text{d})}^{dg}}(
\mathcal{M}, \SheafHom_\mathcal{B}^{dg}(\mathcal{N}, \mathcal{L}))
$$
and
$$
\SheafHom_\mathcal{B}^{dg}(
\mathcal{M} \otimes_\mathcal{A} \mathcal{N}, \mathcal{L}) =
\SheafHom_\mathcal{A}^{dg}(
\mathcal{M}, \SheafHom_\mathcal{B}^{dg}(\mathcal{N}, \mathcal{L}))
$$
functorially in $\mathcal{M}$, $\mathcal{N}$, $\mathcal{L}$.
\end{lemma}

\begin{proof}
Omitted. Hint: On the graded level we have seen this is true in
Lemma \ref{lemma-tensor-hom-adjunction-gr}. Thus it suffices
to check the isomorphisms are compatible with differentials
which can be done by a computation on the level of local sections.
\end{proof}

\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site. Let $\mathcal{A}$
and $\mathcal{B}$ be a sheaves of differential graded algebras on
$(\mathcal{C}, \mathcal{O})$.
As a special case of the above, suppose we are given
a homomorphism $\varphi : \mathcal{A} \to \mathcal{B}$
of differential graded $\mathcal{O}$-algebras. Then we obtain a functor
and a functor of differential graded categories
$$
\otimes_{\mathcal{A}, \varphi} \mathcal{B} :
\text{Mod}_{(\mathcal{A}, \text{d})}
\longrightarrow
\text{Mod}_{(\mathcal{B}, \text{d})}
\quad\text{and}\quad
\otimes_{\mathcal{A}, \varphi} \mathcal{B} :
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
\longrightarrow
\text{Mod}^{dg}_{(\mathcal{B}, \text{d})}
$$
On the other hand, we have the restriction functors
$$
res_\varphi :
\text{Mod}_{(\mathcal{B}, \text{d})}
\longrightarrow
\text{Mod}_{(\mathcal{A}, \text{d})}
\quad\text{and}\quad
res_\varphi :
\text{Mod}^{dg}_{(\mathcal{B}, \text{d})}
\longrightarrow
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
$$
We can use the lemma above to show these functors are adjoint to
each other (as usual with restriction and base change). Namely,
let us write ${}_\mathcal{A}\mathcal{B}_\mathcal{B}$ for
$\mathcal{B}$ viewed as a differential graded
$(\mathcal{A}, \mathcal{B})$-bimodule.
Then for any right differential graded $\mathcal{B}$-module $\mathcal{L}$
we have
$$
\SheafHom_\mathcal{B}^{dg}({}_\mathcal{A}\mathcal{B}_\mathcal{B}, \mathcal{L})
= res_\varphi(\mathcal{L})
$$
as right differential graded $\mathcal{A}$-modules. Thus
Lemma \ref{lemma-tensor-hom-adjunction-gr}
tells us that we have a functorial isomorphism
$$
\Hom_{\text{Mod}_{(\mathcal{B}, \text{d})}^{dg}}(
\mathcal{M} \otimes_{\mathcal{A}, \varphi} \mathcal{B}, \mathcal{L}) =
\Hom_{\text{Mod}_{(\mathcal{A}, \text{d})}^{dg}}(
\mathcal{M}, res_\varphi(\mathcal{L}))
$$
We usually drop the dependence on $\varphi$ in this formula if it
is clear from context. In the same manner we obtain
the equality
$$
\SheafHom^{dg}_\mathcal{B}(
\mathcal{M} \otimes_\mathcal{A} \mathcal{B}, \mathcal{L}) =
\SheafHom_\mathcal{A}^{dg}(\mathcal{M}, \mathcal{L})
$$
of graded $\mathcal{O}$-modules.












\section{Pull and push for sheaves of differential graded modules}
\label{section-functoriality-dg}

\noindent
Let $(f, f^\sharp) : (\Sh(\mathcal{C}), \mathcal{O}_\mathcal{C})
\to (\Sh(\mathcal{D}), \mathcal{O}_\mathcal{D})$
be a morphism of ringed topoi. Let $\mathcal{A}$ be a differential
graded $\mathcal{O}_\mathcal{C}$-algebra. Let $\mathcal{B}$ be a
differential graded $\mathcal{O}_\mathcal{D}$-algebra.
Suppose we are given a map
$$
\varphi : f^{-1}\mathcal{B} \to \mathcal{A}
$$
of differential graded $f^{-1}\mathcal{O}_\mathcal{D}$-algebras or equivalently
$\varphi$ can be viewed as a map
$$
\varphi : \mathcal{B} \to f_*\mathcal{A}
$$
of differential graded $\mathcal{O}_\mathcal{D}$-algebras.
See Remark \ref{remark-functoriality-dga}.

\medskip\noindent
Let us define a functor
$$
f_* :
\text{Mod}_{(\mathcal{A}, \text{d})}
\longrightarrow
\text{Mod}_{(\mathcal{B}, \text{d})}
$$
Given a differential graded $\mathcal{A}$-module $\mathcal{M}$ we define
$f_*\mathcal{M}$ to be the graded $\mathcal{B}$-module constructed
in Section \ref{section-functoriality-graded} with differential
given by the maps $f_*d : f_*\mathcal{M}^n \to f_*\mathcal{M}^{n + 1}$.
The construction is clearly functorial in
$\mathcal{M}$ and we obtain our functor.

\medskip\noindent
Let us define a functor
$$
f^* :
\text{Mod}_{(\mathcal{B}, \text{d})}
\longrightarrow
\text{Mod}_{(\mathcal{A}, \text{d})}
$$
Given a differential graded $\mathcal{B}$-module $\mathcal{N}$
we define $f^*\mathcal{N}$ to be the graded $\mathcal{A}$-module
constructed in Section \ref{section-functoriality-graded}. Recall
that
$$
f^*\mathcal{N} = f^{-1}\mathcal{N} \otimes_{f^{-1}\mathcal{B}} \mathcal{A}
$$
Since $f^{-1}\mathcal{N}$ comes with the differentials
$f^{-1}\text{d} : f^{-1}\mathcal{N}^n \to f^{-1}\mathcal{N}^{n + 1}$
we can view this tensor product as an example of the
tensor product discussed in Section \ref{section-dg-bimodules}
which provides us with a differential.
The construction is clearly functorial in
$\mathcal{N}$ and we obtain our functor $f^*$.

\medskip\noindent
The functors $f_*$ and $f^*$ are readily enhanced to give
functors of differential graded categories
$$
f_* :
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
\longrightarrow
\text{Mod}^{dg}_{(\mathcal{B}, \text{d})}
\quad\text{and}\quad
f^* :
\text{Mod}^{dg}_{(\mathcal{B}, \text{d})}
\longrightarrow
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
$$
which do the same thing on underlying objects and are defined
by functoriality of the constructions on homogenous morphisms
of degree $n$.

\begin{lemma}
\label{lemma-adjunction-push-pull-dg}
In the situation above we have
$$
\Hom_{\text{Mod}_{(\mathcal{B}, \text{d})}^{dg}}(
\mathcal{N}, f_*\mathcal{M}) =
\Hom_{\text{Mod}_{(\mathcal{A}, \text{d})}^{dg}}(
f^*\mathcal{N}, \mathcal{M})
$$
\end{lemma}

\begin{proof}
Omitted. Hints: This is true for the underlying graded categories
by Lemma \ref{lemma-adjunction-push-pull-gr}. A calculation shows
that these isomorphisms are compatible with differentials.
\end{proof}















\section{Localization and sheaves of differential graded modules}
\label{section-localize-dg}

\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $U \in \Ob(\mathcal{C})$ and denote
$$
j :
(\Sh(\mathcal{C}/U), \mathcal{O}_U)
\longrightarrow
(\Sh(\mathcal{C}), \mathcal{O})
$$
the corresponding localization morphism
(Modules on Sites, Section \ref{sites-modules-section-localize}).
Below we will use the following fact: for $\mathcal{O}_U$-modules
$\mathcal{M}_i$, $i = 1, 2$ and a $\mathcal{O}$-module $\mathcal{A}$
there is a canonical map
$$
j_! :
\Hom_{\mathcal{O}_U}(
\mathcal{M}_1 \otimes_{\mathcal{O}_U} \mathcal{A}|_U, \mathcal{M}_2)
\longrightarrow
\Hom_\mathcal{O}(
j_!\mathcal{M}_1 \otimes_\mathcal{O} \mathcal{A}, j_!\mathcal{M}_2)
$$
Namely, we have
$j_!(\mathcal{M}_1 \otimes_{\mathcal{O}_U} \mathcal{A}|_U) =
j_!\mathcal{M}_1 \otimes_\mathcal{O} \mathcal{A}$ by
Modules on Sites, Lemma \ref{sites-modules-lemma-j-shriek-and-tensor}.

\medskip\noindent
Let $\mathcal{A}$ be a differential graded $\mathcal{O}$-algebra.
We will denote $\mathcal{A}_U$ the restriction of $\mathcal{A}$
to $\mathcal{C}/U$, in other words, we have
$\mathcal{A}_U = j^*\mathcal{A} = j^{-1}\mathcal{A}$.
In Section \ref{section-functoriality-dg}
we have constructed adjoint functors
$$
j_* :
\text{Mod}^{dg}_{(\mathcal{A}_U, \text{d})}
\longrightarrow
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
\quad\text{and}\quad
j^* :
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
\longrightarrow
\text{Mod}^{dg}_{(\mathcal{A}_U, \text{d})}
$$
with $j^*$ left adjoint to $j_*$. We claim there is in addition an
exact functor
$$
j_! :
\text{Mod}^{dg}_{(\mathcal{A}_U, \text{d})}
\longrightarrow
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
$$
right adjoint to $j_*$. Namely, given a differential graded
$\mathcal{A}_U$-module $\mathcal{M}$ we define $j_!\mathcal{M}$
to be the graded $\mathcal{A}$-module constructed in
Section \ref{section-localize-graded}
with differentials
$j_!\text{d} : j_!\mathcal{M}^n \to j_!\mathcal{M}^{n + 1}$.
Given a homogeneous map
$f : \mathcal{M} \to \mathcal{M}'$ of degree $n$ of differential graded
$\mathcal{A}_U$-modules, we obtain a homogeneous map
$j_!f : j_!\mathcal{M} \to j_!\mathcal{M}'$ of degree $n$
of differential graded $\mathcal{A}$-modules. We omit the
straightforward verification
that this construction is compatible with differentials.
Thus we obtain our functor.

\begin{lemma}
\label{lemma-extension-by-zero-dg}
In the situation above we have
$$
\Hom_{\text{Mod}_{(\mathcal{A}, \text{d})}^{dg}}(
j_!\mathcal{M}, \mathcal{N}) =
\Hom_{\text{Mod}_{(\mathcal{A}_U, \text{d})}^{dg}}(
\mathcal{M}, j^*\mathcal{N})
$$
\end{lemma}

\begin{proof}
Omitted. Hint: We have seen in Lemma \ref{lemma-extension-by-zero-graded}
that the lemma is true on graded level. Thus all that needs to be
checked is that the resulting isomorphism is compatible with differentials.
\end{proof}

\begin{lemma}
\label{lemma-tensor-with-extension-by-zero-dg}
In the situation above, let $\mathcal{M}$ be a right differential graded
$\mathcal{A}_U$-module and let $\mathcal{N}$ be a left differential graded
$\mathcal{A}$-module. Then
$$
j_!\mathcal{M} \otimes_\mathcal{A} \mathcal{N} =
j_!(\mathcal{M} \otimes_{\mathcal{A}_U} \mathcal{N}|_U)
$$
as complexes of $\mathcal{O}$-modules
functorially in $\mathcal{M}$ and $\mathcal{N}$.
\end{lemma}

\begin{proof}
As graded modules, this follows from
Lemma \ref{lemma-tensor-with-extension-by-zero}.
We omit the verification that this isomorphism
is compatible with differentials.
\end{proof}








\section{Shift functors on sheaves of differential graded modules}
\label{section-shift-dg}

\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$.
Let $\mathcal{M}$ be a differential graded $\mathcal{A}$-module.
Let $k \in \mathbf{Z}$. We define the {\it $k$th shift of} $\mathcal{M}$,
denoted $\mathcal{M}[k]$, as follows
\begin{enumerate}
\item as a graded $\mathcal{A}$-module we let $\mathcal{M}[k]$ be
as defined in Section \ref{section-shift},
\item the differential
$d_{\mathcal{M}[k]} : (\mathcal{M}[k])^n \to (\mathcal{M}[k])^{n + 1}$
is defined to be
$(-1)^k\text{d}_\mathcal{M} : \mathcal{M}^{n + k} \to \mathcal{M}^{n + k + 1}$.
\end{enumerate}
For a homomorphism $f : \mathcal{L} \to \mathcal{M}$ of $\mathcal{A}$-modules
homogeneous of degree $n$, we let $f[k] : \mathcal{L}[k] \to \mathcal{M}[k]$
be given by the same component maps as $f$. Then $f[k]$ is
a homogeneous $\mathcal{A}$-module map of degree $n$.
This gives a map
$$
\Hom_{\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}}(\mathcal{L}, \mathcal{M})
\longrightarrow
\Hom_{\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}}
(\mathcal{L}[k], \mathcal{M}[k])
$$
compatible with differentials (it follows from the fact
that the signs of the differentials of $\mathcal{L}$ and
$\mathcal{M}$ are changed by the same amount). These choices are
compatible with the choice in
Differential Graded Algebra, Definition \ref{dga-definition-shift}.
It is clear that we have defined a functor
$$
[k] :
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
\longrightarrow
\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}
$$
of differential graded categories and that we have
$[k + l] = [k] \circ [l]$.

\medskip\noindent
We claim that the isomorphism
$$
\Hom_{\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}}(\mathcal{L}, \mathcal{M}[k])
=
\Hom_{\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}}(\mathcal{L}, \mathcal{M})[k]
$$
defined in Section \ref{section-shift} on underlying graded modules
is compatible with
the differentials. To see this, suppose we have a right $\mathcal{A}$-module
map $f : \mathcal{L} \to \mathcal{M}[k]$ homogeneous of degree $n$; this
is an element of degree $n$ of the LHS. Denote
$f' : \mathcal{L} \to \mathcal{M}$ the homogeneous $\mathcal{A}$-module
map of degree $n + k$ with the {\bf same} component maps as $f$.
By our conventions, this is the corresponding element of degree $n$
of the RHS.
By definition of the differential of LHS we obtain
$$
\text{d}_{LHS}(f) =
\text{d}_{\mathcal{M}[k]} \circ f - (-1)^n f \circ \text{d}_\mathcal{L} =
(-1)^k\text{d}_\mathcal{M} \circ f - (-1)^n f \circ \text{d}_\mathcal{L}
$$
and for the differential on the RHS we obtain
$$
\text{d}_{RHS}(f') =
(-1)^k\left(
\text{d}_\mathcal{M} \circ f' - (-1)^{n + k} f' \circ \text{d}_\mathcal{L}
\right) =
(-1)^k\text{d}_\mathcal{M} \circ f' - (-1)^n f' \circ \text{d}_\mathcal{L}
$$
These maps have the same component maps and the proof is complete.










\section{The homotopy category}
\label{section-homotopy}

\noindent
This section is the analogue of
Differential Graded Algebra, Section \ref{dga-section-homotopy}.

\begin{definition}
\label{definition-homotopy}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$. Let
$f, g : \mathcal{M} \to \mathcal{N}$
be homomorphisms of differential graded $\mathcal{A}$-modules.
A {\it homotopy between $f$ and $g$} is a graded $\mathcal{A}$-module
map $h : \mathcal{M} \to \mathcal{N}$ homogeneous of degree $-1$
such that
$$
f - g = \text{d}_\mathcal{N} \circ h + h \circ \text{d}_\mathcal{M}
$$
If a homotopy exists, then we say $f$ and $g$ are {\it homotopic}.
\end{definition}

\noindent
In the situation of the definition, if we have maps
$a : \mathcal{K} \to \mathcal{M}$ and $c : \mathcal{N} \to \mathcal{L}$
then we see that
$$
\begin{matrix}
h\text{ is a homotopy} \\
\text{ between }f\text{ and } g
\end{matrix}
\quad
\Rightarrow
\quad
\begin{matrix}
c \circ h \circ a\text{ is a homotopy}\\
\text{between }
c \circ f \circ a\text{ and } c\circ g \circ a
\end{matrix}
$$
Thus we can define composition of homotopy classes of morphisms
in $\text{Mod}_{(\mathcal{A}, \text{d})}$.

\begin{definition}
\label{definition-complexes-notation}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$.
The {\it homotopy category}, denoted $K(\text{Mod}_{(\mathcal{A}, \text{d})})$,
is the category whose objects are the objects of
$\text{Mod}_{(\mathcal{A}, \text{d})}$ and whose morphisms are homotopy classes
of homomorphisms of differential graded $\mathcal{A}$-modules.
\end{definition}

\noindent
The notation $K(\text{Mod}_{(\mathcal{A}, \text{d})})$
is not standard but at least is
consistent with the use of $K(-)$ in other places of the Stacks project.

\medskip\noindent
In Differential Graded Algebra, Definition
\ref{dga-definition-homotopy-category-of-dga-category}
we have defined what we mean by the category of complexes
$\text{Comp}(\mathcal{S})$
and the homotopy category $K(\mathcal{S})$
of a differential graded category $\mathcal{S}$.
Applying this to the differential graded category
$\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}$ we obtain
$$
\text{Mod}_{(\mathcal{A}, \text{d})} =
\text{Comp}(\text{Mod}^{dg}_{(\mathcal{A}, \text{d})})
$$
(see discussion in Section \ref{section-dgm-dg-cat}) and we obtain
$$
K(\text{Mod}_{(\mathcal{A}, \text{d})}) =
K(\text{Mod}^{dg}_{(\mathcal{A}, \text{d})})
$$
To see that this last equality is true, note that we have the equality
$$
\text{d}_{\Hom_{\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}}
(\mathcal{M}, \mathcal{N})}(h) =
\text{d}_\mathcal{N} \circ h + h \circ \text{d}_\mathcal{M}
$$
when $h$ is as in Definition \ref{definition-homotopy}. We omit the
details.











\section{Cones and triangles}
\label{section-conclude-triangulated}

\noindent
In this section we use the material from
Differential Graded Algebra, Section \ref{dga-section-review}
to conclude that the homotopy category of the
category of differential graded $\mathcal{A}$-modules
is a triangulated category.

\begin{lemma}
\label{lemma-axioms-AB}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$.
The differential graded category
$\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}$
satisfies axioms (A) and (B) of
Differential Graded Algebra, Section \ref{dga-section-review}.
\end{lemma}

\begin{proof}
Suppose given differential graded $\mathcal{A}$-modules
$\mathcal{M}$ and $\mathcal{N}$. Consider the
differential graded $\mathcal{A}$-module $\mathcal{M} \oplus \mathcal{N}$
defined in the obvious manner. Then the coprojections
$i : \mathcal{M} \to \mathcal{M} \oplus \mathcal{N}$ and
$j : \mathcal{N} \to \mathcal{M} \oplus \mathcal{N}$ and the
projections
$p : \mathcal{M} \oplus \mathcal{N} \to \mathcal{N}$ and
$q : \mathcal{M} \oplus \mathcal{N} \to \mathcal{M}$
are morphisms of differential graded $\mathcal{A}$-modules.
Hence $i, j, p, q$ are homogeneous
of degree $0$ and closed, i.e., $\text{d}(i) = 0$, etc.
Thus this direct sum is a differential graded sum in the sense of
Differential Graded Algebra, Definition \ref{dga-definition-dg-direct-sum}.
This proves axiom (A).

\medskip\noindent
Axiom (B) was shown in Section \ref{section-shift-dg}.
\end{proof}

\medskip\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$.
Recall that a sequence
$$
0 \to \mathcal{K} \to \mathcal{L} \to \mathcal{N} \to 0
$$
in $\text{Mod}_{(\mathcal{A}, \text{d})}$
is called an {\it admissible short exact sequence}
(in Differential Graded Algebra, Section \ref{dga-section-review})
if it is split in $\text{Mod}_\mathcal{A}$. In other words, if it is split
as a sequence of graded $\mathcal{A}$-modules. Denote
$s : \mathcal{N} \to \mathcal{L}$ and
$\pi : \mathcal{L} \to \mathcal{K}$
graded $\mathcal{A}$-module splittings.
Combining Lemma \ref{lemma-axioms-AB} and 
Differential Graded Algebra, Lemma \ref{dga-lemma-get-triangle}
we obtain a triangle
$$
\mathcal{K} \to \mathcal{L} \to \mathcal{N} \to \mathcal{K}[1]
$$
where the arrow $\mathcal{N} \to \mathcal{K}[1]$ in the proof
of Differential Graded Algebra, Lemma \ref{dga-lemma-get-triangle}
is constructed as
$$
\delta = \pi \circ
\text{d}_{\Hom_{\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}}
(\mathcal{L}, \mathcal{M})}(s) =
\pi \circ \text{d}_\mathcal{L} \circ s -
\pi \circ s \circ \text{d}_\mathcal{N} =
\pi \circ \text{d}_\mathcal{L} \circ s
$$
with apologies for the horrendous notation. In any case, we see that
in our setting the boundary map $\delta$ as constructed in
Differential Graded Algebra, Lemma \ref{dga-lemma-get-triangle}
agrees on underlying complexes of $\mathcal{O}$-modules
with the usual boundary map used throughout the Stacks project
for termwise split short exact sequences of complexes, see
Derived Categories, Definition \ref{derived-definition-split-ses}.

\begin{definition}
\label{definition-cone}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$.
Let $f : \mathcal{K} \to \mathcal{L}$
be a homomorphism of differential graded $\mathcal{A}$-modules.
The {\it cone} of $f$ is the differential graded $\mathcal{A}$-module
$C(f)$ defined as follows:
\begin{enumerate}
\item the underlying complex of $\mathcal{O}$-modules
is the cone of the corresponding map
$f : \mathcal{K}^\bullet \to \mathcal{L}^\bullet$ of
complexes of $\mathcal{A}$-modules, i.e., we have
$C(f)^n = \mathcal{L}^n \oplus \mathcal{K}^{n + 1}$ and
differential
$$
d_{C(f)} =
\left(
\begin{matrix}
\text{d}_\mathcal{L} & f \\
0 & -\text{d}_\mathcal{K}
\end{matrix}
\right)
$$
\item the multiplication map
$$
C(f)^n \times \mathcal{A}^m \to C(f)^{n + m}
$$
is the direct sum of the multiplication map
$\mathcal{L}^n \times \mathcal{A}^m \to \mathcal{L}^{n + m}$
and the multiplication map
$\mathcal{K}^{n + 1} \times \mathcal{A}^m \to \mathcal{K}^{n + 1 + m}$.
\end{enumerate}
It comes equipped with canonical hommorphisms of differential graded
$\mathcal{A}$-modules $i : \mathcal{L} \to C(f)$
and $p : C(f) \to \mathcal{K}[1]$ induced by the obvious maps.
\end{definition}

\noindent
Observe that in the situation of the definition the sequence
$$
0 \to \mathcal{L} \to C(f) \to \mathcal{K}[1] \to 0
$$
is an addmissible short exact sequence.

\begin{lemma}
\label{lemma-axiom-C}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$.
The differential graded category
$\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}$
satisfies axiom (C) formulated in
Differential Graded Algebra, Situation \ref{dga-situation-ABC}.
\end{lemma}

\begin{proof}
Let $f : \mathcal{K} \to \mathcal{L}$
be a homomorphism of differential graded $\mathcal{A}$-modules.
By the above we have an admissible short exact sequence
$$
0 \to \mathcal{L} \to C(f) \to \mathcal{K}[1] \to 0
$$
To finish the proof we have to show that the boundary map
$$
\delta : \mathcal{K}[1] \to \mathcal{L}[1]
$$
associated to this (see discussion above) is equal to $f[1]$.
For the section $s : \mathcal{K}[1] \to C(f)$ we use in degree
$n$ the embeddding $\mathcal{K}^{n + 1} \to C(f)^n$. Then
in degree $n$ the map $\pi$ is given by the projections
$C(f)^n \to \mathcal{L}^n$. Then finally we have to compute
$$
\delta = \pi \circ \text{d}_{C(f)} \circ s
$$
(see discussion above). In matrix notation this is equal to
$$
\left(
\begin{matrix}
1 & 0
\end{matrix}
\right)
\left(
\begin{matrix}
\text{d}_\mathcal{L} & f \\
0 & -\text{d}_\mathcal{K}
\end{matrix}
\right)
\left(
\begin{matrix}
0 \\
1
\end{matrix}
\right) = f
$$
as desired.
\end{proof}

\noindent
At this point we know that all lemmas proved in
Differential Graded Algebra, Section \ref{dga-section-review}
are valid for the differential graded category
$\text{Mod}^{dg}_{(\mathcal{A}, \text{d})}$.
In particular, we have the following.

\begin{proposition}
\label{proposition-homotopy-category-triangulated}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$.
The homotopy category $K(\text{Mod}_{(\mathcal{A}, \text{d})})$
is a triangulated category where
\begin{enumerate}
\item the shift functors are those constructed in
Section \ref{section-shift-dg},
\item the distinghuished triangles are those triangles
in $K(\text{Mod}_{(\mathcal{A}, \text{d})})$ which are
isomorphic as a triangle to a triangle
$$
\mathcal{K} \to \mathcal{L} \to \mathcal{N}
\xrightarrow{\delta} \mathcal{K}[1],\quad\quad
\delta = \pi \circ \text{d}_\mathcal{L} \circ s
$$
constructed from an admissible short exact sequence
$0 \to \mathcal{K} \to \mathcal{L} \to \mathcal{N} \to 0$
in $\text{Mod}_{(\mathcal{A}, \text{d})}$ above.
\end{enumerate}
\end{proposition}

\begin{proof}
Recall that $K(\text{Mod}_{(\mathcal{A}, \text{d})}) =
K(\text{Mod}^{dg}_{(\mathcal{A}, \text{d})})$, see
Section \ref{section-homotopy}.
Having said this, the proposition
follows from Lemmas \ref{lemma-axioms-AB} and \ref{lemma-axiom-C}
and
Differential Graded Algebra, Proposition
\ref{dga-proposition-ABC-homotopy-category-triangulated}.
\end{proof}

\begin{remark}
\label{remark-cone-identity}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$. Let $C = C(\text{id}_\mathcal{A})$
be the cone on the identity map $\mathcal{A} \to \mathcal{A}$ viewed
as a map of differential graded $\mathcal{A}$-modules.
Then
$$
\Hom_{\text{Mod}_{(\mathcal{A}, \text{d})}}(C, \mathcal{M}) =
\{(x, y) \in
\Gamma(\mathcal{C}, \mathcal{M}^0) \times
\Gamma(\mathcal{C}, \mathcal{M}^{-1}) \mid
x = \text{d}(y)\}
$$
where the map from left to right sends $f$ to the pair $(x, y)$
where $x$ is the image of the global section $(0, 1)$ of
$C^{-1} = \mathcal{A}^{-1} \oplus \mathcal{A}^0$ and where
$y$ is the image of the global section $(1, 0)$ of
$C^0 = \mathcal{A}^0 \oplus \mathcal{A}^1$.
\end{remark}

\begin{lemma}
\label{lemma-dgm-grothendieck-abelian}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $(\mathcal{A}, \text{d})$ be a differential graded $\mathcal{O}$-algebra.
The category $\text{Mod}_{(\mathcal{A}, \text{d})}$
is a Grothendieck abelian category.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-dgm-abelian} and the definition of a Grothendieck
abelian category
(Injectives, Definition \ref{injectives-definition-grothendieck-conditions})
it suffices to
show that $\text{Mod}_{(\mathcal{A}, \text{d})}$
has a generator. For every object $U$ of $\mathcal{C}$ we denote
$C_U$ the cone on the identity map $\mathcal{A}_U \to \mathcal{A}_U$
as in Remark \ref{remark-cone-identity}. We claim that
$$
\mathcal{G} = \bigoplus\nolimits_{k, U} j_{U!}C_U[k]
$$
is a generator where the sum is over all objects $U$ of $\mathcal{C}$
and $k \in \mathbf{Z}$. Indeed, given a
differential graded $\mathcal{A}$-module $\mathcal{M}$
if there are no nonzero maps from $\mathcal{G}$ to $\mathcal{M}$,
then we see that for all $k$ and $U$ we have
\begin{align*}
\Hom_{\text{Mod}_\mathcal{A}}(j_{U!}C_U[k], \mathcal{M}) \\
& =
\Hom_{\text{Mod}_{\mathcal{A}_U}}(C_U[k], \mathcal{M}|_U) \\
& =
\{(x, y) \in \mathcal{M}^{-k}(U) \times \mathcal{M}^{-k - 1}(U) \mid
x = \text{d}(y)\}
\end{align*}
is equal to zero. Hence $\mathcal{M}$ is zero.
\end{proof}











\section{Flat resolutions}
\label{Section-P-resolutions}

\noindent
This section is the analogue of
Differential Graded Algebra, Section \ref{dga-section-P-resolutions}.

\medskip\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$. Let us call a right differential
graded $\mathcal{A}$-module $\mathcal{P}$ {\it good}
if
\begin{enumerate}
\item the functor
$\mathcal{N} \mapsto \mathcal{P} \otimes_\mathcal{A} \mathcal{N}$
is exact on the category of graded left $\mathcal{A}$-modules,
\item if $\mathcal{N}$ is an acyclic differential graded left
$\mathcal{A}$-module, then
$\mathcal{P} \otimes_\mathcal{A} \mathcal{N}$ is acyclic,
\item for any morphism $(f, f^\sharp) : (\Sh(\mathcal{C}'), \mathcal{O}')
\to (\Sh(\mathcal{C}), \mathcal{O})$
of ringed topoi and any differential graded $\mathcal{O}'$-algebra
$\mathcal{A}'$ and any map $\varphi : f^{-1}\mathcal{A} \to \mathcal{A}'$
of differential graded $f^{-1}\mathcal{O}_\mathcal{D}$-algebras we have
properties (1) and (2) for the pullback $f^*\mathcal{P}$
(Section \ref{section-functoriality-dg})
viewed as a differential graded $\mathcal{A}'$-module.
\end{enumerate}
The first condition means that $\mathcal{P}$ is flat as a right graded
$\mathcal{A}$-module, the second condition means that $\mathcal{P}$ is
K-flat in the sense of Spaltenstein (see Cohomology on
Sites, Section \ref{sites-cohomology-section-flat}), and
the third condition is that this holds after arbitrary base change.

\medskip\noindent
Perhaps surprisingly, there are many good modules.

\begin{lemma}
\label{lemma-supply-good}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$. Let $U \in \Ob(\mathcal{C})$.
Then $j_!\mathcal{A}_U$ is a good differential graded
$\mathcal{A}$-module.
\end{lemma}

\begin{proof}
Let $\mathcal{N}$ be a left graded $\mathcal{A}$-module.
By Lemma \ref{lemma-tensor-with-extension-by-zero} we have
$$
j_!\mathcal{A}_U \otimes_\mathcal{A} \mathcal{N} =
j_!(\mathcal{A}_U \otimes_{\mathcal{A}_U} \mathcal{N}|_U) =
j_!(\mathcal{N}_U)
$$
as graded modules.
Since both restriction to $U$ and $j_!$ are exact this proves
condition (1). The same argument works for (2) using
Lemma \ref{lemma-tensor-with-extension-by-zero-dg}.

\medskip\noindent
Consider a morphism $(f, f^\sharp) : (\Sh(\mathcal{C}'), \mathcal{O}')
\to (\Sh(\mathcal{C}), \mathcal{O})$
of ringed topoi, a differential graded $\mathcal{O}'$-algebra
$\mathcal{A}'$, and a map $\varphi : f^{-1}\mathcal{A} \to \mathcal{A}'$
of differential graded $f^{-1}\mathcal{O}$-algebras.
We have to show that
$$
f^*j_!\mathcal{A}_U =
f^{-1}j_!\mathcal{A}_U \otimes_{f^{-1}\mathcal{A}} \mathcal{A}'
$$
satisfies (1) and (2) for the ringed topos
$(\Sh(\mathcal{C}'), \mathcal{O}')$ endowed with the
sheaf of differential graded $\mathcal{O}'$-algebras
$\mathcal{A}'$. To prove this we may replace
$(\Sh(\mathcal{C}), \mathcal{O})$ and
$(\Sh(\mathcal{C}'), \mathcal{O}')$ by equivalent ringed topoi.
Thus by
Modules on Sites, Lemma
\ref{sites-modules-lemma-morphism-ringed-topoi-comes-from-morphism-ringed-sites}
we may assume that $f$ comes from a morphism of sites
$f : \mathcal{C} \to \mathcal{C}'$ given by the continuous
functor $u : \mathcal{C} \to \mathcal{C}'$.
In this case, set $U' = u(U)$ and denote
$j' : \Sh(\mathcal{C}'/U') \to \Sh(\mathcal{C}')$ the
corresponding localization morphism.
We obtain a commutative square of morphisms of ringed topoi
$$
\xymatrix{
(\Sh(\mathcal{C}'/U'), \mathcal{O}'_{U'})
\ar[rr]_{(j', (j')^\sharp)} \ar[d]_{(f', (f')^\sharp)} & &
(\Sh(\mathcal{C}'), \mathcal{O}')
\ar[d]^{(f, f^\sharp)} \\
(\Sh(\mathcal{C}/U), \mathcal{O}_U)
\ar[rr]^{(j, j^\sharp)} & &
(\Sh(\mathcal{C}), \mathcal{O}).
}
$$
and we have $f'_*(j')^{-1} = j^{-1}f_*$. See
Modules on Sites, Lemma
\ref{sites-modules-lemma-localize-morphism-ringed-sites}.
By uniqueness of adjoints we obtain
$f^{-1}j_! = j'_!(f')^{-1}$. Thus we obtain
\begin{align*}
f^*j_!\mathcal{A}_U
& =
f^{-1}j_!\mathcal{A}_U \otimes_{f^{-1}\mathcal{A}} \mathcal{A}' \\
& =
j'_!(f')^{-1}\mathcal{A}_U \otimes_{f^{-1}\mathcal{A}} \mathcal{A}' \\
& =
j'_!\left(
(f')^{-1}\mathcal{A}_U \otimes_{f^{-1}\mathcal{A}|_{U'}}
\mathcal{A}'|_{U'}\right) \\
& =
j'_!\mathcal{A}'_{U'}
\end{align*}
The first equation is the definition of the pullback of $j_!\mathcal{A}_U$
to a differential graded module over $\mathcal{A}'$.
The second equation because $f^{-1}j_! = j'_!(f')^{-1}$.
The third equation by Lemma \ref{lemma-tensor-with-extension-by-zero-dg}
applied to the ringed site $(\mathcal{C}', f^{-1}\mathcal{O})$ with
sheaf of differential graded algebras $f^{-1}\mathcal{A}$ and with
differential graded modules $(f')^{-1}\mathcal{A}_U$ on $\mathcal{C}'/U'$
and $\mathcal{A}'$ on $\mathcal{C}'$.
The fourth equation holds because of course we have
$(f')^{-1}\mathcal{A}_U = f^{-1}\mathcal{A}|_{U'}$.
Hence we see that the pullback is another module of the
same kind and we've proven conditions (1) and (2) for it above.
\end{proof}

\begin{lemma}
\label{lemma-good-admissible-ses}
et $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$. Let
$0 \to \mathcal{P} \to \mathcal{P}' \to \mathcal{P}'' \to 0$
be an admissible short exact sequence of differential graded
$\mathcal{A}$-modules. If two-out-of-three of these modules
are good, so is the third.
\end{lemma}

\begin{proof}
For condition (1) this is immediate as the sequence is a direct sum
at the graded level. For condition (2) note that for any
left differential graded $\mathcal{A}$-module, the sequence
$$
0 \to 
\mathcal{P} \otimes_\mathcal{A} \mathcal{N} \to
\mathcal{P}' \otimes_\mathcal{A} \mathcal{N} \to
\mathcal{P}'' \otimes_\mathcal{A} \mathcal{N} \to 0
$$
is an admissible short exact sequence of differential graded
$\mathcal{O}$-modules (since forgetting the differential
the tensor product is just taken in the category of graded modules).
Hence if two out of three are exact as complexes of $\mathcal{O}$-modules,
so is the third. Finally, the same argument shows that given
a morphism $(f, f^\sharp) : (\Sh(\mathcal{C}'), \mathcal{O}')
\to (\Sh(\mathcal{C}), \mathcal{O})$
of ringed topoi, a differential graded $\mathcal{O}'$-algebra
$\mathcal{A}'$, and a map $\varphi : f^{-1}\mathcal{A} \to \mathcal{A}'$
of differential graded $f^{-1}\mathcal{O}$-algebras
we have that
$$
0 \to f^*\mathcal{P} \to f^*\mathcal{P}' \to f^*\mathcal{P}'' \to 0
$$
is an admissible short exact sequence of differential graded
$\mathcal{A}'$-modules and the same argument as above applies here.
\end{proof}

\begin{lemma}
\label{lemma-good-direct-sum}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$. An arbitrary
direct sum of good differential graded $\mathcal{A}$-modules
is good. A filtered colimit of good differential graded
$\mathcal{A}$-modules is good. 
\end{lemma}

\begin{proof}
Omitted. Hint: direct sums and filtered colimits
commute with tensor products and with pullbacks.
\end{proof}

\begin{lemma}
\label{lemma-good-quotient}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$. Let $\mathcal{M}$
be a differential graded $\mathcal{A}$-module. There exists a homomorphism
$\mathcal{P} \to \mathcal{M}$ of differential graded $\mathcal{A}$-modules
with the following properties
\begin{enumerate}
\item $\mathcal{P} \to \mathcal{M}$ is surjective,
\item $\Ker(\text{d}_\mathcal{P}) \to \Ker(\text{d}_\mathcal{M})$
is surjective, and
\item $\mathcal{P}$ is good.
\end{enumerate}
\end{lemma}

\begin{proof}
Consider triples $(U, k, x)$ where $U$ is an object of $\mathcal{C}$,
$k \in \mathbf{Z}$, and $x$ is a section of $\mathcal{M}^k$ over $U$
with $\text{d}_\mathcal{M}(x) = 0$. Then we obtain a unique morphism
of differential graded $\mathcal{A}_U$-modules
$\varphi_x : \mathcal{A}_U[-k] \to \mathcal{M}|_U$
mapping $1$ to $x$. This is adjoint to a morphism
$\psi_x : j_{U!}\mathcal{A}_U[-k] \to \mathcal{M}$.
Observe that $1 \in \mathcal{A}_U(U)$ corresponds to
a section $1 \in j_{U!}\mathcal{A}_U[-k](U)$ of degree $k$
whose differential is zero and which is mapped to $x$ by $\psi_x$.
Thus if we consider the map
$$
\bigoplus\nolimits_{(U, k, x)} j_{U!}\mathcal{A}_U[-k]
\longrightarrow
\mathcal{M}
$$
then we will have conditions (2) and (3). Namely, the objects
$j_{U!}\mathcal{A}_U[-k]$ are good (Lemma \ref{lemma-supply-good})
and any direct sum of good objects is good (Lemma \ref{lemma-good-direct-sum}).

\medskip\noindent
Next, consider triples $(U, k, x)$ where $U$ is an object of $\mathcal{C}$,
$k \in \mathbf{Z}$, and $x$ is a section of $\mathcal{M}^k$ (not necessarily
annihilated by the differential). Then we can consider
the cone $C_U$ on the identity map $\mathcal{A}_U \to \mathcal{A}_U$
as in Remark \ref{remark-cone-identity}. The element $x$ will determine a map
$\varphi_x : C_U[-k - 1] \to \mathcal{A}_U$, see
Remark \ref{remark-cone-identity}. Now, since we have
an admissible short exact sequence
$$
0 \to \mathcal{A}_U \to C_U \to \mathcal{A}_U[1] \to 0
$$
we conclude that $j_{U!}C_U$ is a good module by
Lemma \ref{lemma-good-admissible-ses} and
the already used Lemma \ref{lemma-supply-good}.
As above we conclude that the direct sum of the maps
$\psi_x : j_{U!}C_U \to \mathcal{M}$ adjoint to the $\varphi_x$
$$
\bigoplus\nolimits_{(U, k, x)} j_{U!}C_U \longrightarrow \mathcal{M}
$$
is surjective. Taking the direct sum with the map produced
in the first paragraph we conclude.
\end{proof}

\begin{lemma}
\label{lemma-resolve}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$. Let $\mathcal{M}$
be a differential graded $\mathcal{A}$-module. There exists a homomorphism
$\mathcal{P} \to \mathcal{M}$ of differential graded $\mathcal{A}$-modules
with the following properties
\begin{enumerate}
\item $\mathcal{P} \to \mathcal{M}$ is a quasi-isomorphism, and
\item $\mathcal{P}$ is good.
\end{enumerate}
\end{lemma}

\begin{proof}
We urge the reader to read the proof of this lemma in the case of
differential graded modules first, see Differential Graded Algebra,
Lemma \ref{dga-lemma-resolve}. Set $\mathcal{M} = \mathcal{M}_0$.
We inductively choose short exact sequences
$$
0 \to \mathcal{M}_{i + 1} \to \mathcal{P}_i \to \mathcal{M}_i \to 0
$$
where the maps
$\mathcal{P}_i \to \mathcal{M}_i$ are chosen as in
Lemma \ref{lemma-good-quotient}.
This gives a ``resolution''
$$
\ldots \to \mathcal{P}_2 \xrightarrow{f_2}
\mathcal{P}_1 \xrightarrow{f_1} \mathcal{P}_0 \to \mathcal{M} \to 0
$$
Then we let $\mathcal{P}$ be the differential graded
$\mathcal{A}$-module defined as follows
\begin{enumerate}
\item as a graded $\mathcal{A}$-module we set
$\mathcal{P} = \bigoplus_{a \leq 0} \mathcal{P}_{-a}[-a]$, i.e.,
the degree $n$ part is given by
$\mathcal{P}^n = \bigoplus\nolimits_{a + b = n} \mathcal{P}_{-a}^b$,
\item the differential on $\mathcal{P}$ is as in the construction of
the total complex associated to a double complex given by
$$
\text{d}_\mathcal{P}(x) = f_{-a}(x) + (-1)^a \text{d}_{\mathcal{P}_{-a}}(x)
$$
for $x$ a local section of $\mathcal{P}_{-a}^b$.
\end{enumerate}
With these conventions $\mathcal{P}$ is indeed a
differential graded $\mathcal{A}$-module; we omit the details.
There is a map $\mathcal{P} \to \mathcal{M}$ of differential graded
$\mathcal{A}$-modules which is zero on the summands $\mathcal{P}_{-a}[-a]$
for $a < 0$ and the given map $\mathcal{P}_0 \to \mathcal{M}$ for $a = 0$.
Observe that we have
$$
\mathcal{P} = \colim_i F_i\mathcal{P}
$$
where $F_i\mathcal{P} \subset \mathcal{P}$ is the differential
graded $\mathcal{A}$-submodule whose underlying graded $\mathcal{A}$-module
is
$$
F_i\mathcal{P} =
\bigoplus\nolimits_{i \geq -a \geq 0} \mathcal{P}_{-a}[-a]
$$
It is immediate that the maps
$$
0 \to F_1\mathcal{P} \to F_2\mathcal{P} \to F_3\mathcal{P} \to
\ldots \to \mathcal{P}
$$
are all admissible monomorphisms and we have admissible short exact sequences
$$
0 \to F_i\mathcal{P} \to
F_{i + 1}\mathcal{P} \to
\mathcal{P}_{i + 1}[i + 1] \to 0
$$
By induction and Lemma \ref{lemma-good-admissible-ses}
we find that $F_i\mathcal{P}$ is a good differential graded
$\mathcal{A}$-module. Since $\mathcal{P} = \colim F_i\mathcal{P}$
we find that $\mathcal{P}$ is good by Lemma \ref{lemma-good-direct-sum}.

\medskip\noindent
Finally, we have to show that $\mathcal{P} \to \mathcal{M}$
is a quasi-isomorphism. If $\mathcal{C}$ has enough points, then
this follows from the elementary
Homology, Lemma \ref{homology-lemma-good-resolution-gives-qis}
by checking on stalks. In general, we can argue as follows
(this proof is far too long --- there is an alternative argument by
working with local sections as in the elementary proof but it
is also rather long).
Since filtered colimits are exact on the category of abelian
sheaves, we have
$$
H^d(\mathcal{P}) = \colim H^d(F_i\mathcal{P})
$$
We claim that for each $i \geq 0$ and $d \in \mathbf{Z}$
we have (a) a short exact sequence
$$
0 \to H^d(\mathcal{M}_{i + 1}[i]) \to
H^d(F_i\mathcal{P}) \to H^d(\mathcal{M}) \to 0
$$
where the second arrow comes from
$F_i\mathcal{P} \to \mathcal{P} \to \mathcal{M}$
and (b) the composition
$$
H^d(\mathcal{M}_{i + 1}[i]) \to
H^d(F_i\mathcal{P}) \to
H^d(F_{i + 1}\mathcal{P})
$$
is zero. It is clear that the claim suffices to finish the proof.

\medskip\noindent
Proof of the claim. For any $i \geq 0$ there is a map
$\mathcal{M}_{i + 1}[i] \to F_i\mathcal{P}$ coming from
the inclusion of $\mathcal{M}_{i + 1}$ into $\mathcal{P}_i$
as the kernel of $f_i$. Consider the short exact sequence
$$
0 \to \mathcal{M}_{i + 1}[i] \to F_i\mathcal{P} \to C_i \to 0
$$
of complexes of $\mathcal{O}$-modules defining $C_i$.
Observe that $C_0 = \mathcal{M}_0 = \mathcal{M}$.
Also, observe that $C_i$ is the total complex associated to the
double complex $C_i^{\bullet, \bullet}$ with columns
$$
\mathcal{M}_i = \mathcal{P}_i/\mathcal{M}_{i + 1},
\mathcal{P}_{i - 1}, \ldots, \mathcal{P}_0
$$
in degree $-i, -i + 1, \ldots, 0$. There is a map of double complexes
$C_i^{\bullet, \bullet} \to C_{i - 1}^{\bullet, \bullet}$ which is
$0$ on the column in degree $-i$, is the surjection
$\mathcal{P}_{i - 1} \to \mathcal{M}_{i - 1}$ in degree $-i + 1$,
and is the identity on the other columns.
Hence there are maps of complexes
$$
C_i \longrightarrow C_{i - 1}
$$
These maps are surjective quasi-isomorphisms because the kernel
is the total complex on the double complex with columns
$\mathcal{M}_i, \mathcal{M}_i$ in degrees $-i, -i + 1$ and
the identity map between these two columns. Using the
resulting identifications
$H^d(C_i) = H^d(C_{i - 1} = \ldots = H^d(\mathcal{M})$
this already shows we get a long exact sequence
$$
H^d(\mathcal{M}_{i + 1}[i]) \to
H^d(F_i\mathcal{P}) \to H^d(\mathcal{M}) \to
H^{d + 1}(\mathcal{M}_{i + 1}[i])
$$
from the short exact sequence of complexes above.
However, we also have the commutative diagram
$$
\xymatrix{
\mathcal{M}_{i + 2}[i + 1] \ar[r]_a & T_{i + 1} \ar[r] &
F_{i + 1}\mathcal{P} \ar[r] & C_{i + 1} \ar[d] \\
& \mathcal{M}_{i + 1}[i] \ar[r] \ar[u]^b &
F_i\mathcal{P} \ar[u] \ar[r] &
C_i
}
$$
where $T_{i + 1}$ is the total complex on the double complex
with columns $\mathcal{P}_{i + 1}, \mathcal{M}_{i + 1}$ placed
in degrees $-i - 1$ and $-i$. In other words, $T_{i + 1}$ is
a shift of the cone on the map
$\mathcal{P}_{i + 1} \to \mathcal{M}_{i + 1}$ and we find that
$a$ is a quasi-isomorphism and the map $a^{-1} \circ b$ is a shift of the
third map of the distinguished triangle in $D(\mathcal{O})$ associated
to the short exact sequence
$$
0 \to \mathcal{M}_{i + 2} \to \mathcal{P}_{i + 1} \to \mathcal{M}_{i + 1} \to 0
$$
The map $H^d(\mathcal{P}_{i + 1}) \to H^d(\mathcal{M}_{i + 1})$
is surjective because we chose our maps such that
$\Ker(\text{d}_{\mathcal{P}_{i + 1}}) \to
\Ker(\text{d}_{\mathcal{M}_{i + 1}})$ is surjective.
Thus we see that $a^{-1} \circ b$ is zero on cohomology sheaves.
This proves part (b) of the claim.
Since $T_{i + 1}$ is the kernel of the surjective map of complexes
$F_{i + 1}\mathcal{P} \to C_i$ we find a map of long exact
cohomology sequences
$$
\xymatrix{
H^d(T_{i + 1}) \ar[r] &
H^d(F_{i + 1}\mathcal{P}) \ar[r] &
H^d(\mathcal{M}) \ar[r] &
H^{d + 1}(T_{i + 1}) \\
H^d(\mathcal{M}_{i + 1}[i]) \ar[r] \ar[u] &
H^d(F_i\mathcal{P}) \ar[r] \ar[u] &
H^d(\mathcal{M}) \ar[r] \ar[u] &
H^{d + 1}(\mathcal{M}_{i + 1}[i]) \ar[u]
}
$$
Here we know, by the discussion above, that the vertical maps
on the outside are zero. Hence the maps
$H^d(F_{i + 1}\mathcal{P}) \to H^d(\mathcal{M})$
are surjective and part (a) of the claim follows.
More precisely, the claim follows for $i > 0$ and we leave the
claim for $i = 0$ to the reader (actually it suffices to prove
the claim for all $i \gg 0$ in order to get the lemma).
\end{proof}






\section{The differential graded hull of a graded module}
\label{section-dg-hull}

\noindent
The differential graded hull of a graded module $\mathcal{N}$ is
the result of applying the functor $G$ in the following lemma.

\begin{lemma}
\label{lemma-dg-hull}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$. The forgetful functor
$F : \text{Mod}_{(\mathcal{A}, \text{d})} \to \text{Mod}_\mathcal{A}$
has a left adjoint $G : \text{Mod}_\mathcal{A} \to
\text{Mod}_{(\mathcal{A}, \text{d})}$.
\end{lemma}

\begin{proof}
To prove the existence of $G$ we can use the adjoint functor theorem, see
Categories, Theorem \ref{categories-theorem-adjoint-functor} (observe that
we have switched the roles of $F$ and $G$). The exactness conditions on
$F$ are satisfied by Lemma \ref{lemma-dgm-abelian}. The set theoretic
condition can be seen as follows: suppose given a graded $\mathcal{A}$-module
$\mathcal{N}$. Then for any map
$$
\varphi : \mathcal{N} \longrightarrow F(\mathcal{M})
$$
we can consider the smallest differential graded $\mathcal{A}$-submodule
$\mathcal{M}' \subset \mathcal{M}$ with
$\Im(\varphi) \subset F(\mathcal{M}')$.
It is clear that $\mathcal{M}'$ is the image of the map
of graded $\mathcal{A}$-modules
$$
\mathcal{N} \oplus
\mathcal{N}[-1] \otimes_\mathcal{O} \mathcal{A}
\longrightarrow
\mathcal{M}
$$
defined by
$$
(n, \sum n_i \otimes a_i) \longmapsto
\varphi(n) + \sum \text{d}(\varphi(n_i)) a_i
$$
because the image of this map is easily seen to be a differential graded
submodule of $\mathcal{M}$.
Thus the number of possible isomorphism classes of these $\mathcal{M}'$
is bounded and we conclude.
\end{proof}

\noindent
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
Let $\mathcal{A}$ be a sheaf of differential graded algebras
on $(\mathcal{C}, \mathcal{O})$. Let $\mathcal{M}$ be a differential
graded $\mathcal{A}$-module and suppose we have a short exact sequence
$$
0 \to \mathcal{N} \to F(\mathcal{M}) \to \mathcal{N}' \to 0
$$
in $\text{Mod}_\mathcal{A}$. Then we obtain a canonical
graded $\mathcal{A}$-module homomorphism
$$
\overline{\text{d}} : \mathcal{N} \to \mathcal{N}'[1]
$$
as follows: given a local section $x$ of $\mathcal{N}$ denote
$\overline{\text{d}}(x)$ the image in $\mathcal{N}'$ of
$\text{d}_\mathcal{M}(x)$ when $x$ is viewed as a local section
of $\mathcal{M}$.

\begin{lemma}
\label{lemma-dg-hull-acyclic}
The functors $F, G$ of Lemma \ref{lemma-dg-hull} have
the following properties. Given a graded $\mathcal{A}$-module
$\mathcal{N}$ we have
\begin{enumerate}
\item the counit $\mathcal{N} \to F(G(\mathcal{N}))$ is injective,
\item the map $\overline{\text{d}} : \mathcal{N} \to
\Coker(\mathcal{N} \to F(G(\mathcal{N})))[1]$ is an isomorphism, and
\item $G(\mathcal{N})$ is an acyclic differential graded $\mathcal{A}$-module.
\end{enumerate}
\end{lemma}

\begin{proof}
We observe that property (3) is a consequence of properties (1) and (2).
Namely, if $s$ is a nonzero local section of $F(G(\mathcal{N}))$
with $\text{d}(s) = 0$, then $s$ cannot be in the image of
$\mathcal{N} \to F(G(\mathcal{N}))$. Hence we can write the image
$\overline{s}$ of $s$ in the cokernel as
$\overline{\text{d}}(s')$ for some local section $s'$ of $\mathcal{N}$.
Then we see that $s = \text{d}(s')$ because the difference
$s - \text{d}(s')$ is still in the kernel of $\text{d}$
and is contained in the image of the counit.

\medskip\noindent
Let us write temporarily $\mathcal{A}_{gr}$, respectively $\mathcal{A}_{dg}$
the sheaf $\mathcal{A}$ viewed as a (right) graded module over itself,
respectively as a (right) differential graded module over itself.
The most important case of the lemma is to understand what
is $G(\mathcal{A}_{gr})$. Of course $G(\mathcal{A}_{gr})$ is the object
of $\text{Mod}_{(\mathcal{A}, \text{d})}$ representing the
functor
$$
\mathcal{M} \longmapsto
\Hom_{\text{Mod}_\mathcal{A}}(\mathcal{A}_{gr}, F(\mathcal{M})) =
\Gamma(\mathcal{C}, \mathcal{M})
$$
By Remark \ref{remark-cone-identity} we see that this functor represented
by $C[-1]$ where $C$ is the cone on the identity of $\mathcal{A}_{dg}$.
We have a short exact sequence
$$
0 \to \mathcal{A}_{dg}[-1] \to C[-1] \to \mathcal{A}_{dg} \to 0
$$
in $\text{Mod}_{(\mathcal{A}, \text{d})}$ which is split by the
counit $\mathcal{A}_{gr} \to F(C[-1])$ in $\text{Mod}_\mathcal{A}$.
Thus $G(\mathcal{A}_{gr})$ satisfies properties (1) and (2).

\medskip\noindent
Let $U$ be an object of $\mathcal{C}$. Denote
$j_U : \mathcal{C}/U \to \mathcal{C}$ the localization morphism.
Denote $\mathcal{A}_U$ the restriction of $\mathcal{A}$ to $U$.
We will use the notation $\mathcal{A}_{U, gr}$ to denote
$\mathcal{A}_U$ viewed as a graded $\mathcal{A}_U$-module.
Denote $F_U : \text{Mod}_{(\mathcal{A}_U, \text{d})} \to
\text{Mod}_{\mathcal{A}_U}$ the forgetful functor and denote
$G_U$ its adjoint. Then we have the commutative diagrams
$$
\vcenter{
\xymatrix{
\text{Mod}_{(\mathcal{A}, \text{d})} \ar[d]_{j_U^*} \ar[r]_F &
\text{Mod}_\mathcal{A} \ar[d]^{j_U^*} \\
\text{Mod}_{(\mathcal{A}_U, \text{d})} \ar[r]^{F_U} &
\text{Mod}_{\mathcal{A}_U}
}
}
\quad\text{and}\quad
\vcenter{
\xymatrix{
\text{Mod}_{(\mathcal{A}_U, \text{d})} \ar[r]_{F_U} \ar[d]_{j_{U!}} &
\text{Mod}_{\mathcal{A}_U} \ar[d]^{j_{U!}} \\
\text{Mod}_{(\mathcal{A}, \text{d})} \ar[r]^F &
\text{Mod}_\mathcal{A}
}
}
$$
by the construction of $j^*_U$ and $j_{U!}$ in
Sections \ref{section-functoriality-graded},
\ref{section-functoriality-dg},
\ref{section-localize-graded}, and
\ref{section-localize-dg}.
By uniqueness of adjoints we obtain $j_{U!} \circ G_U = G \circ j_{U!}$.
Since $j_{U!}$ is an exact functor, we see that the properties
(1) and (2) for the counit
$\mathcal{A}_{U, gr} \to F_U(G_U(\mathcal{A}_{U, gr}))$
which we've seen in the previous part of the proof
imply properties (1) and (2) for the counit
$j_{U!}\mathcal{A}_{U, gr} \to F(G(j_{U!}\mathcal{A}_{U, gr})) =
j_{U!}F_U(G_U(\mathcal{A}_{U, gr}))$.

\medskip\noindent
In the proof of Lemma \ref{lemma-gm-grothendieck-abelian}
we have seen that any object
of $\text{Mod}_\mathcal{A}$ is a quotient of a direct sum
of copies of $j_{U!}\mathcal{A}_{U, gr}$. Since $G$ is a left
adjoint, we see that $G$ commutes with direct sums. Thus
properties (1) and (2) hold for direct sums of objects
for which they hold. Thus we see that every object $\mathcal{N}$
of $\text{Mod}_\mathcal{A}$ fits into an exact sequence
$$
\mathcal{N}_1 \to \mathcal{N}_0 \to \mathcal{N} \to 0
$$
such that (1) and (2) hold for $\mathcal{N}_1$ and $\mathcal{N}_0$.
We leave it to the reader to deduce (1) and (2) for
$\mathcal{N}$ using that $G$ is right exact.
\end{proof}




























\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
