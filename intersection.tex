\input{preamble}

% OK, start here.
%
\begin{document}

\title{Intersection Theory}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents


\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we construct the intersection product on the
Chow groups modulo rational equivalence on a nonsingular projective
variety over a fixed algebraically closed field $\mathbf{C}$.


\section{Conventions}
\label{section-conventions}

\noindent
We fix an algebraically closed ground field $\mathbf{C}$.
All schemes and varieties are over $\mathbf{C}$ and all
morphisms are over $\mathbf{C}$. A variety $X$ is
{\it nonsingular} if $X$ is a regular scheme (see
Properties, Definition \ref{properties-definition-regular}).
In our case this means that the morphism $X \to \Spec(\mathbf{C})$
is smooth (see
Varieties, Lemma \ref{varieties-lemma-geometrically-regular-smooth}).


\section{Cycles}
\label{section-cycles}

\noindent
Let $X$ be a nonsingular projective variety.
A {\it $k$-cycle} on $X$ is a finite formal sum $\sum n_i [Z_i]$
where each $Z_i$ is a closed subvariety of dimension $k$.
The {\it support} of $\alpha$ is the closed subset
$$
\text{Supp}(\alpha) = \bigcup\nolimits_{n_i \not = 0} Z_i \subset X
$$
of dimension $k$. The group of $k$-cycles is denoted $Z_k(X)$.
See Chow Homology, Section \ref{chow-section-cycles}.


\section{Cycle associated to closed subscheme}
\label{section-cycle-of-closed}

\noindent
Suppose that $X$ is a nonsingular projective variety and that $Z \subset X$
is a closed subscheme with $\dim(Z) \leq k$. Let $Z_i$ be the irreducible
components of $Z$ of dimension $k$ and let $n_i$ be the
{\it multiplicity of $Z_i$ in $Z$} defined as
$$
n_i = \text{length}_{\mathcal{O}_{X, Z_i}} \mathcal{O}_{Z, Z_i}
$$
where $\mathcal{O}_{X, Z_i}$, resp.\ $\mathcal{O}_{Z, Z_i}$ is the
local ring of $X$, resp.\ $Z$ at the generic point of $Z_i$.
We define the $k$-cycle associated to $Z$ to be the $k$-cycle
$$
[Z]_k = \sum n_i [Z_i].
$$
See Chow Homology, Section \ref{chow-section-cycle-of-closed-subscheme}.


\section{Cycle associated to a coherent sheaf}
\label{section-cycle-of-coherent-sheaf}

\noindent
Suppose that $X$ is a nonsingular projective variety and that $\mathcal{F}$
is a coherent $\mathcal{O}_X$-module on $X$ with
$\dim(\text{Supp}(\mathcal{F})) \leq k$.
Let $Z_i$ be the irreducible components of $\text{Supp}(\mathcal{F})$
of dimension $k$ and let $n_i$ be the
{\it multiplicity of $Z_i$ in $\mathcal{F}$} defined as
$$
n_i = \text{length}_{\mathcal{O}_{X, Z_i}} \mathcal{F}_{\xi_i}
$$
where $\mathcal{O}_{X, Z_i}$ is the
local ring of $X$ at the generic point $\xi_i$ of $Z_i$
and $\mathcal{F}_{\xi_i}$ is the stalk of $\mathcal{F}$ at this point.
We define the $k$-cycle associated to $\mathcal{F}$ to be the $k$-cycle
$$
[\mathcal{F}]_k = \sum n_i [Z_i].
$$
See Chow Homology, Section \ref{chow-section-cycle-of-coherent-sheaf}.
Note that, if $\dim(Z) \leq k$, then $[Z]_k = [\mathcal{O}_Z]_k$.


\section{Pushforward}
\label{section-pushforward}

\noindent
Suppose that $f : X \to Y$ is a morphism of nonsingular projective varieties.
Let $Z \subset X$ be a $k$-dimensional
closed subvariety. We define $f_*[Z]$ to be $0$ if $\dim(f(Z))<k$
and $d \cdot [f(Z)]$ if $\dim(f(Z)) = k$ where
$$
d = [\mathbf{C}(Z) : \mathbf{C}(f(Z))] = \deg(Z/f(Z))
$$
is the degree of the dominant morphism $Z \to f(Z)$, see
Morphisms, Definition \ref{morphisms-definition-degree}.
Let $\alpha = \sum n_i [Z_i]$ be a $k$-cycle on $Y$. The
{\it pushforward} of $\alpha$ is the sum $f_* \alpha = \sum n_i f_*[Z_i]$
where each $f_*[Z_i]$ is defined as above. This defines a homomorphism
$$
f_* : Z_k(X) \longrightarrow Z_k(Y)
$$
See Chow Homology, Section \ref{chow-section-proper-pushforward}.

\begin{lemma}
\label{lemma-push-coherent}
\begin{reference}
See \cite[Chapter V]{Serre_algebre_locale}.
\end{reference}
Suppose that $f : X \to Y$ is a morphism of projective nonsingular varieties.
Let $Z \subset X$ be a $k$-dimensional closed subvariety. Then
$f_*[Z] = [f_*\mathcal{O}_Z]_k$.
\end{lemma}

\begin{proof}
See Chow Homology, Lemma \ref{chow-lemma-cycle-push-sheaf}.
\end{proof}


\section{Flat pullback}
\label{section-flat-pullback}

\noindent
Suppose that $f : X \to Y$ is a flat morphism of nonsingular projective
varieties. Then there exists an integer $r \geq 0$ such that $f$ is of
relative dimension $r$, in other words all fibres have dimension
$r$\footnote{In fact, the converse is true as well: if $f : X \to Y$ is
a dominant morphism of nonsingular projective varieties and all fibres have
dimension $r$, then $f$ is flat. This follows from
Algebra, Lemma \ref{algebra-lemma-CM-over-regular-flat}.}.
Let $Z \subset X$ be a $k$-dimensional closed subvariety. We define
$f^*[Z]$ to be the $k + r$-cycle associated to the scheme theoretic
inverse image: $f^*[Z] = [f^{-1}(Z)]_{k + r}$. Let
$\alpha = \sum n_i [Z_i]$ be a $k$-cycle on $Y$. The {\it pullback} of
$\alpha$ is the sum $f_* \alpha = \sum n_i f^*[Z_i]$ where each $f^*[Z_i]$
is defined as above.

\begin{lemma}
\label{lemma-pullback}
Let $f : X \to Y$ be a flat morphism of nonsingular projective varieties
of relative dimension $r$.
Then $f^*[\mathcal{F}]_k = [f^*\mathcal{F}]_{k + r}$
if $\mathcal{F}$ is a coherent sheaf on $Y$ and the dimension of the
support of $\mathcal{F}$ is at most $k$.
\end{lemma}

\begin{proof}
See Chow Homology, Lemma \ref{chow-lemma-pullback-coherent}.
\end{proof}


\section{Rational Equivalence}
\label{section-rational-equivalence}

\noindent
We are going to define rational equivalence in a way which at first
glance may seem different from what you are used to, or from what
is in \cite[Chapter I]{F} or
Chow Homology, Section \ref{chow-section-rational-equivalence}.
However, in Section \ref{section-alternative} we will show that
the two notions agree.

\medskip\noindent
Let $X$ be a nonsingular projective variety. Let $W \subset X \times {\bf P}^1$
be a closed subvariety of dimension $k + 1$. Let $a, b$ be two distinct closed
points of ${\bf P}^1$. Assume that $X \times a$, $X \times b$ and $W$
intersect properly:
$$
\dim (W \cap X \times a) \leq k,\quad
\dim (W \cap X \times b) \leq k.
$$
This is true as soon as $W \to \mathbf{P}^1$ is dominant or if $W$ is
contained in a fibre of the projection over a closed point different from
$a$ or $b$ (this is an uninteresting case which we will discard). In this
situation the scheme theoretic fibre $W_a$ of the morphism
$W \to \mathbf{P}^1$ is equal to the scheme theoretic intersection
$X \times a \cap W$ in $X \times \mathbf{P}^1$. Identifying $X \times a$
and $X \times b$ with $X$ we may think of the fibres $W_a$ and $W_b$
as closed subschemes of $X$ of dimension $\leq k$. A basic example of a
rational equivalence is
$$
[W_a]_k \sim_{rat} [W_b]_k
$$
The cycles $[W_a]_k$ and $[W_b]_k$ are easy to compute in practice
(given $W$) because they are obtained by proper intersection with
a Cartier divisor (we will see this in
Section \ref{section-computing-intersection-multiplicities}).
Since the automorphism group of $\mathbf{P}^1$ is $2$-transitive we may
move the pair of closed points $a, b$ to any pair we like. A traditional
choice is to choose $a = 0$ and $b = \infty$.

\medskip\noindent
More generally, let $\alpha = \sum n_i [W_i]$ be a $(k + 1)$-cycle on
$X \times {\bf P}^1$.  Let $a_i, b_i$ be pairs of distinct closed points of
${\bf P}^1$. Assume that $X \times a_i$, $X \times b_i$ and $W_i$ intersect
properly, in other words, each $W_i, a_i, b_i$ satisfies the condition
discussed above. A {\it cycle rationally equivalent to zero} is any cycle
of the form
$$
\sum n_i([W_{i, a_i}]_k - [W_{i, b_i}]_k).
$$
This is indeed a $k$-cycle. The collection of $k$-cycles rationally
equivalent to zero is an additive subgroup of the group of $k$-cycles.
We say two $k$-cycles are {\it rationally equivalent}, notation
$\alpha \sim_{rat} \alpha'$, if $\alpha - \alpha'$ is a cycle rationally
equivalent to zero.

\medskip\noindent
We define
$$
A_k(X) = Z_k(X)/ \sim_{rat}
$$
to be the {\it Chow group of $k$-cycles on $X$}. We will see in
Lemma \ref{lemma-rational-equivalence}
that this agrees with the Chow group as defined in
Chow Homology, Definition \ref{chow-definition-rational-equivalence}.


\section{Rational equivalence and rational functions}
\label{section-alternative}

\noindent
Let $X$ be a nonsingular projective variety. Let $W \subset X$ be a subvariety
of dimension $k + 1$. Let $f \in \mathbf{C}(W)^*$ be a nonzero rational
function on $W$. For every subvariety $Z \subset W$ of dimension $k$
one can define the order of vanishing $\text{ord}_{W, Z}(f)$ of $f$ at
at $Z$. If $f$ is an element of the local ring $\mathcal{O}_{W, Z}$
of $W$ at $Z$, then one has
$$
\text{ord}_{W, Z}(f) = \text{length}_{\mathcal{O}_{X, z}} \mathcal{O}_{W, Z}
$$
where $\mathcal{O}_{X, Z}$, resp.\ $\mathcal{O}_{W, Z}$ is the
local ring of $X$, resp.\ $W$ at the generic point of $Z$. In general one
extends the definition by multiplicativity. The {\it principal divisor
associated to $f$} is
$$
\text{div}(f) = \text{div}_W(f) = \sum \text{ord}_{W, Z}(f)[Z]
$$
in $Z_k(X)$. See Chow Homology, Section \ref{chow-section-principal-divisors}.

\begin{lemma}
\label{lemma-rational-equivalence}
Let $X$ be a nonsingular projective variety. Let $W \subset X$ be a subvariety
of dimension $k + 1$. Let $f \in \mathbf{C}(W)^*$ be a nonzero rational
function on $W$. Then $\text{div}(f)$ is rationally equivalent to zero.
Conversely, these principal divisors generate the abelian group of
cycles rationally equivalent to zero.
\end{lemma}

\begin{proof}
The first assertion follows from
Chow Homology, Lemma \ref{chow-lemma-rational-function}.

\medskip\noindent
For the second, let $W \subset X \times \mathbf{P}^1$ be a closed
subvariety of dimension $k + 1$ which dominates $\mathbf{P}^1$.
We will show that $[W_0]_k - [W_\infty]_k$ is a principal divisor
which is what we have to prove. Let $W' \subset X$ be the image of
the projection to $X$. Then $W \to W'$ is proper and generically
finite\footnote{If $W \to W'$ is birational, then the result follows
from Chow Homology, Lemma \ref{chow-lemma-rational-function}.
Our task is to show that even if $W \to W'$
has degree $>1$ the basic rational equivalence
$[W_0]_k \sim_{rat} [W_\infty]_k$ comes from a principal divisor
on a subvariety of $X$.}. Let $f$ denote the projection $W \to \mathbf{P}^1$
viewed as an element of $\mathbf{C}(W)^*$. Let
$g = \text{Nm}(f) \in \mathbf{C}(W')^*$ be the norm. By
Chow Homology, Lemma \ref{chow-lemma-proper-pushforward-alteration} we have
$$
\text{div}_{W'}(g) = \text{pr}_{X, *}\text{div}_W(f)
$$
Since $\text{div}_W(f) = [W_0]_k - [W_\infty]_k$ the proof is complete.
\end{proof}


\section{Pushforward and rational equivalence}
\label{section-pushforward-and-rational-equivalence}

\noindent
Suppose that $f : X \to Y$ is a morphism of nonsingular projective varieties.
Let $\alpha \sim_{rat} 0$ be a $k$-cycle on
$X$ rationally equivalent to $0$. Then the {pushforward}
of $\alpha$ is rationally equivalent to zero:
$f_* \alpha \sim_{rat} 0$. See Chapter I of \cite{F} or
Chow Homology, Lemma \ref{chow-lemma-proper-pushforward-rational-equivalence}.

\medskip\noindent
Therefore we obtain a commutative diagram
$$
\xymatrix{
Z_k(X) \ar[r] \ar[d]_{f_*} & A_k(X) \ar[d]^{f_*} \\
Z_k(Y) \ar[r] & A_k(Y)
}
$$
of groups of $k$-cycles.


\section{Flat pullback and rational equivalence}
\label{section-flat-pullback-and-rational-equivalence}

\noindent
Suppose that $f : X \to Y$ is a flat morphism of relative dimension $r$
of nonsingular projective varieties.
Let $\alpha \sim_{rat} 0$ be a $k$-cycle on
$Y$ rationally equivalent to $0$. Then the pullback
of $\alpha$ is rationally equivalent to zero:
$f^* \alpha \sim_{rat} 0$. See Chapter I of \cite{F} or
Chow Homology, Lemma \ref{chow-lemma-flat-pullback-rational-equivalence}.

\medskip\noindent
Therefore we obtain a commutative diagram
$$
\xymatrix{
Z_k(X) \ar[r] & A_k(X) \\
Z_k(Y) \ar[r] \ar[u]^{f^*} & A_k(Y) \ar[u]_{f^*}
}
$$
of groups of $k$-cycles.


\section{Proper intersections}
\label{section-intersect-properly}

\noindent
First a few lemmas to get dimension estimates.

\begin{lemma}
\label{lemma-dimension-product-varieties}
Let $X$ and $Y$ be varieties. Then $X \times Y$ is a variety and
$\dim(X \times Y) = \dim(X) + \dim(Y)$.
\end{lemma}

\begin{proof}
The scheme $X \times Y = X \times_{\Spec(\mathbf{C})} Y$ is a variety by
Varieties, Lemma \ref{varieties-lemma-product-varieties}.
Choose closed points $x \in X$ and $y \in Y$.
Then $\dim(X) = \dim_x(X)$ and similarly for $Y$ and $X \times Y$
(see for example
Algebra, Lemma \ref{algebra-lemma-dimension-prime-polynomial-ring}).
The projection morphism $X \times Y \to Y$ is flat. Hence
$\dim_{(x, y)}(X \times Y) = \dim_x(X) + \dim_y(Y)$ by
Morphisms, Lemma \ref{morphisms-lemma-dimension-fibre-at-a-point-additive}.
\end{proof}

\medskip\noindent
Recall that a regular immersion $i : X \to Y$ is a closed immersion whose
corresponding sheaf of ideals is locally generated by a regular sequence, see
Divisors, Section \ref{divisors-section-regular-immersions}.
Moreover, the conormal sheaf $\mathcal{C}_{X/Y}$ is finite locally free of
rank equal to the length of the regular sequence. Let us say $i$ is a
{\it regular immersion of codimension $c$}
if $\mathcal{C}_{X/Y}$ is locally free of rank $c$.

\medskip\noindent
More generally, recall
(More on Morphisms, Section \ref{more-morphisms-section-lci})
that $f : X \to Y$ is a local complete intersection
morphism if we can cover $X$ by opens $U$ such that we can factor
$f|_U$ as
$$
\xymatrix{
U \ar[rr]_i \ar[rd] & & \mathbf{A}^n_Y \ar[ld] \\
& Y
}
$$
where $i$ is a Koszul regular immersion (if $Y$ is locally Noetherian
this is the same as asking $i$ to be a regular immersion, see
Divisors, Lemma \ref{divisors-lemma-regular-immersion-noetherian}).
Let us say that $f$ is a {\it local complete intersection morphism
of relative dimension $r$} if for any factorization as above, the
closed immersion $i$ has conormal sheaf of rank $n - r$ (in other
words if $i$ is a Koszul-regular immersion of codimension $n - r$
which in the Noetherian case just means it is regular immersion of
codimension $n - r$).

\begin{lemma}
\label{lemma-pullback-by-regular-immersion}
Let $f : X \to Y$ be a morphism of varieties.
\begin{enumerate}
\item If $Z \subset Y$ is a subvariety dimension $d$ and $f$ is a regular
immersion of codimension $c$, then every irreducible component
of $f^{-1}(Z)$ has dimension $\geq d - c$.
\item If $Z \subset Y$ is a subvariety of dimension $d$ and
$f$ is a local complete intersection morphism of relative dimension $r$,
then every irreducible component of $f^{-1}(Z)$ has dimension $\geq d + r$.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). We may work locally, hence we may assume that
$Y = \Spec(A)$ and $X = V(f_1, \ldots, f_c)$ where $f_1, \ldots, f_c$
is a regular sequence in $A$. If $Z = \Spec(A/\mathfrak p)$, then
we see that $f^{-1}(Z) = \Spec(A/\mathfrak p + (f_1, \ldots, f_c))$.
If $V$ is an irreducible component of $f^{-1}(Z)$, then we can
choose a closed point $v \in V$ not contained in any other irreducible
component of $f^{-1}(Z)$. Then
$$
\dim(Z) = \dim \mathcal{O}_{Z, v}
\quad\text{and}\quad
\dim(V) = \dim \mathcal{O}_{V, v} = \dim \mathcal{O}_{Z, v}/(f_1, \ldots, f_c)
$$
The first equality for example by
Algebra, Lemma \ref{algebra-lemma-dimension-prime-polynomial-ring}
and the second equality by our choice of closed point.
The result now follows from the fact that dividing by one element
in the maximal ideal decreases the dimension by at most $1$, see
Algebra, Lemma \ref{algebra-lemma-one-equation}.

\medskip\noindent
Proof of (2). Choose a factorization as in the definition of a
local complete intersection and apply (1). Some details omitted.
\end{proof}

\noindent
The following lemma demonstrates how reduction to the diagonal works.

\begin{lemma}
\label{lemma-intersect-in-smooth}
Suppose that $X$ is a nonsingular projective variety and that $W,V \subset X$
are closed subvarieties with $\dim(W) = s$ and $\dim(V) = r$. Then every
irreducible component $Z$ of $V \cap W$ has dimension $\geq r + s - \dim(X)$.
\end{lemma}

\begin{proof}
Since $X \to \Spec(\mathbf{C})$ is smooth the diagonal morphism
$\Delta : X \to X \times X$ is a regular immersion of codimension
$\dim(X)$. In fact, any closed immersion between nonsingular projective
varieties is a regular immersion, see Divisors,
Lemma \ref{divisors-lemma-immersion-smooth-into-smooth-regular-immersion}.
Since $V \cap W = \Delta^{-1}(V \times W)$ (scheme theoretically)
we conclude by Lemma \ref{lemma-pullback-by-regular-immersion}.
\end{proof}

\noindent
This lemma suggests the following definition.

\begin{definition}
\label{definition-proper-intersection}
Let $X$ be a nonsingular projective variety.
\begin{enumerate}
\item Let $W,V \subset X$ be closed subvarieties with
$\dim(W) = s$ and $\dim(V) = r$. We say that $W$ and $V$
{\it intersect properly} if $\dim(V \cap W) \leq r + s - \dim(X)$.
\item Let $\alpha = \sum n_i [W_i]$ be an $s$-cycle,
and $\beta = \sum_j m_j [V_j]$ be an $r$-cycle on $X$. We say
that $\alpha$ and $\beta$ {\it intersect properly} if
$W_i$ and $V_j$ intersect properly for all $i$ and $j$.
\end{enumerate}
\end{definition}


\section{Intersection multiplicities using Tor formula}
\label{section-tor-formula}

\noindent
A basic fact we will use frequently is that given sheaves of
modules $\mathcal{F}$, $\mathcal{G}$ on a ringed space $(X, \mathcal{O}_X)$
and a point $x \in X$ we have
$$
\text{Tor}_p^{\mathcal{O}_X}(\mathcal{F}, \mathcal{G})_x =
\text{Tor}_p^{\mathcal{O}_{X, x}}(\mathcal{F}_x, \mathcal{G}_x)
$$
as $\mathcal{O}_{X, x}$-modules. This can be seen in several ways
from our construction of derived tensor products in
Cohomology, Section \ref{cohomology-section-flat}, for example it follows from
Cohomology, Lemma \ref{cohomology-lemma-check-K-flat-stalks}.
Moreover, if $X$ is a scheme and $\mathcal{F}$ and $\mathcal{G}$
are quasi-coherent, then the modules
$\text{Tor}_p^{\mathcal{O}_X}(\mathcal{F}, \mathcal{G})$ are
quasi-coherent too, see
Derived Categories of Schemes, Lemma
\ref{perfect-lemma-quasi-coherence-tensor-product}.
More important for our purposes is the following result.

\begin{lemma}
\label{lemma-tensor-coherent}
Let $X$ be a locally Noetherian scheme.
\begin{enumerate}
\item If $\mathcal{F}$ and $\mathcal{G}$ are coherent $\mathcal{O}_X$-modules,
then $\text{Tor}_p^{\mathcal{O}_X}(\mathcal{F}, \mathcal{G})$ is too.
\item If $L$ and $K$ are in $D^-_{\textit{Coh}}(\mathcal{O}_X)$, then
so is $L \otimes_{\mathcal{O}_X}^\mathbf{L} K$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let us explain how to prove (1) in a more elementary way and part (2)
using prviously developed general theory.

\medskip\noindent
Proof of (1). Since formation of $\text{Tor}$ commutes with localization
we may assume $X$ is affine. Hence $X = \Spec(A)$ for some Noetherian
ring $A$ and $\mathcal{F}$, $\mathcal{G}$ correspond to finite $A$-modules
$M$ and $N$ (Cohomology of Schemes, Lemma
\ref{coherent-lemma-coherent-Noetherian}).
By Derived Categories of Schemes, Lemma
\ref{perfect-lemma-quasi-coherence-tensor-product} we may
compute the $\text{Tor}$'s by first computing the $\text{Tor}$'s
of $M$ and $N$ over $A$, and then taking the associated $\mathcal{O}_X$-module.
Since the modules $\text{Tor}_p^A(M, N)$ are finite by
Algebra, Lemma \ref{algebra-lemma-tor-noetherian}
we conclude.

\medskip\noindent
By Derived Categories of Schemes, Lemma
\ref{perfect-lemma-identify-pseudo-coherent-noetherian}
the assumption is equivalent to asking $L$ and $K$ to be
(locally) pseudo-coherent. Then $L \otimes_{\mathcal{O}_X}^\mathbf{L} K$
is pseudo-coherent by
Cohomology, Lemma \ref{cohomology-lemma-tensor-pseudo-coherent}.
\end{proof}

\begin{lemma}
\label{lemma-compute-tor-nonsingular}
Let $X$ be a nonsingular projective variety.
Let $\mathcal{F}$, $\mathcal{G}$ be coherent $\mathcal{O}_X$-modules.
The $\mathcal{O}_X$-module
$\text{Tor}_p^{\mathcal{O}_X}(\mathcal{F}, \mathcal{G})$
is coherent, has stalk at $x$ equal to
$\text{Tor}_p^{\mathcal{O}_{X, x}}(\mathcal{F}_x, \mathcal{G}_x)$,
is supported on
$\text{Supp}(\mathcal{F}) \cap \text{Supp}(\mathcal{G})$, and
is nonzero only for $p \in \{0, \ldots, \dim(X)\}$.
\end{lemma}

\begin{proof}
The result on stalks was discussed above and it implies the support
condition. The $\text{Tor}$'s are coherent by
Lemma \ref{lemma-tensor-coherent}. The vanishing of negative
$\text{Tor}$'s is immediate from the construction. The
vanishing of $\text{Tor}_p$ for $p > \dim(X)$ can be seen as follows:
he local rings $\mathcal{O}_{X, x}$ are regular
(as $X$ is nonsingular) of dimension $\leq \dim(X)$
(Algebra, Lemma \ref{algebra-lemma-dimension-prime-polynomial-ring}),
hence $\mathcal{O}_{X, x}$ has finite global dimension $\leq \dim(X)$
(Algebra, Lemma \ref{algebra-lemma-finite-gl-dim-finite-dim-regular})
which implies that $\text{Tor}$-groups of modules vanish beyond the dimension
(More on Algebra, Lemma \ref{more-algebra-lemma-finite-gl-dim-tor-dimension}).
\end{proof}

\noindent
Let $X$ be a nonsingular projective variety and $W, V \subset X$
be closed subvarieties with $\dim(W) = s$ and $\dim(V) = r$.
Assume $V$ and $W$ intersect properly.
In this case Lemma \ref{lemma-intersect-in-smooth} tells us all irreducible
components of $V \cap W$ have dimension equal to $r + s - \dim(X)$.
The sheaves $Tor_j^{\mathcal{O}_X}(\mathcal{O}_W, \mathcal{O}_V)$ are
coherent, supported on $V \cap W$, and zero if $j < 0$ or $j > \dim(X)$
(Lemma \ref{lemma-compute-tor-nonsingular}).
We define the {\it intersection product} as
$$
W \cdot V = \sum\nolimits_i (-1)^i
[\text{Tor}_i^{\mathcal{O}_X}(\mathcal{O}_W, \mathcal{O}_V)]_{r + s - \dim(X)}.
$$
We stress that this makes sense only because of our assumption that
$V$ and $W$ intersect properly. This fact will necessitate a moving
lemma in order to define the intersection product in general.

\medskip\noindent
With this notation, the cycle $V \cdot W$ is a formal linear
combination $\sum e_i Z_i$ of the irreducible components $Z_i$
of the intersection $V \cap W$. The integers $e_i$ are called
the {\it intersection multiplicities}
$$
e_i = e(X, V \cdot W, Z_i) =
\sum\nolimits_i
(-1)^i
\text{length}_{\mathcal{O}_{X, Z_i}}
\text{Tor}_i^{\mathcal{O}_{X, Z_i}}(\mathcal{O}_{W, Z_i}, \mathcal{O}_{V, Z_i})
$$
where $\mathcal{O}_{X, Z_i}$, resp.\ $\mathcal{O}_{W, Z_i}$,
resp.\ $\mathcal{O}_{V, Z_i}$ denotes the local ring of $X$, resp.\ $W$,
resp.\ $V$ at the generic point of $Z_i$.
These alternating sums of lengths of $\text{Tor}$'s satisfy many good
properties, as we wll see later on.


\section{Algebraic multiplicities}
\label{section-multiplicities}

\noindent
Let $(A, \mathfrak m, \kappa)$ be a Noetherian local ring.
Let $M$ be a finite $A$-module and let $I \subset A$ be an ideal
of definition (Algebra, Definition \ref{algebra-definition-ideal-definition}).
Recall that the function
$$
\chi_{I, M}(n) = \text{length}_A(M/I^nM) =
\sum\nolimits_{p = 0, \ldots, n - 1} \text{length}_A(I^pM/I^{p + 1}M)
$$
is a numerical polynomial
(Algebra, Proposition \ref{algebra-proposition-hilbert-function-polynomial}).
The degree of this polynomial is equal to $\dim(\text{Supp}(M))$ by
Algebra, Lemma \ref{algebra-lemma-support-dimension-d}.

\begin{definition}
\label{definition-multiplicity}
In the situation above, if $d \geq \dim(\text{Supp}(M))$, then we set
$e_I(M, d)$ equal to $0$ if $d > \dim(M)$ and equal to $d!$ times the
leading coefficient of the numerical polynomial $\chi_{I, M}$ so that
$$
\chi_{I, M}(n) \sim e_I(M, d) \frac{n^d}{d!} + \text{lower order terms}
$$
The {\it multiplicity of $M$ for the ideal of definition $I$}
is $e_I(M) = e_I(M, \dim(\text{Supp}(M)))$.
\end{definition}

\noindent
We have the following properties of these multiplicities.

\begin{lemma}
\label{lemma-multiplicity-ses}
Let $A$ be a Noetherian local ring. Let $I \subset A$ be an ideal of
definition. Let $0 \to M' \to M \to M'' \to 0$ be a short exact sequence
of finite $A$-modules. Let $d \geq \dim(\text{Supp}(M))$. Then
$$
e_I(M, d) = e_I(M', d) + e_I(M'', d)
$$
\end{lemma}

\begin{proof}
Immediate from the definitions and
Algebra, Lemma \ref{algebra-lemma-hilbert-ses-chi}.
\end{proof}

\begin{lemma}
\label{lemma-multiplicity-as-a-sum}
Let $A$ be a Noetherian local ring. Let $I \subset A$ be an ideal of
definition. Let $M$ be a finite $A$-module. Let $d \geq \dim(\text{Supp}(M))$.
Then
$$
e_I(M, d) =
\sum \text{length}_{A_\mathfrak p}(M_\mathfrak p) e_I(A/\mathfrak p, d)
$$
where the sum is over primes $\mathfrak p \subset A$ with
$\dim(A/\mathfrak p) = 1$.
\end{lemma}

\begin{proof}
Both the left and side and the right hand side are additive in short
exact sequences of modules of dimension $\leq d$, see
Lemma \ref{lemma-multiplicity-ses} and
Algebra, Lemma \ref{algebra-lemma-length-additive}.
Hence by Algebra, Lemma \ref{algebra-lemma-filter-Noetherian-module}
it suffices to prove this when $M = A/\mathfrak q$ for some
prime $\mathfrak q$ of $A$ with $\dim(A/\mathfrak q) \leq d$.
This case is obvious.
\end{proof}

\begin{lemma}
\label{lemma-leading-coefficient}
Let $P$ be a polynomial of degree $r$ with leading coefficient $a$.
Then
$$
r! a = \sum\nolimits_{i = 0, \ldots, r} (-1)^i{r \choose i} P(t - i)
$$
for any $t$.
\end{lemma}

\begin{proof}
Let us write $\Delta$ the operator which to a polynomial $P$ associates
the polynomial $\Delta(P) = P(t) - P(t - 1)$. We claim that
$$
\Delta^r(P) = \sum\nolimits_{i = 0, \ldots, r} (-1)^i {r \choose i} P(t - i)
$$
This is true for $r = 0, 1$ by inspection. Assume it is true for $r$.
Then we compute
\begin{align*}
\Delta^{r + 1}(P)
& =
\sum\nolimits_{i = 0, \ldots, r} (-1)^i {r \choose i} \Delta(P)(t - i) \\
& =
\sum\nolimits_{n = -r, \ldots, 0} (-1)^i {r \choose i}
(P(t - i) - P(t - i - 1))
\end{align*}
Thus the claim follows from the equality
$$
{r + 1 \choose i} = {r \choose i} + {r \choose i - 1}
$$
The lemma follows from the fact that $\Delta(P)$ is of degree $r - 1$
with leading coefficient $ra$ if the degree of $P$ is $r$.
\end{proof}

\noindent
An important fact is that one can compute the multiplicity in terms
of the Koszul complex. Recall that if $R$ is a ring and
$f_1, \ldots, f_r \in R$, then $K_\bullet(f_1, \ldots, f_r)$
denotes the Koszul complex, see
More on Algebra, Section \ref{more-algebra-section-koszul}.

\begin{theorem}
\label{theorem-multiplicity-with-koszul}
\begin{reference}
\cite[Theorem 1 in part B of Chapter IV]{Serre_algebre_locale}
\end{reference}
Let $A$ be a Noetherian local ring. Let $I = (f_1, \ldots, f_r) \subset A$
be an ideal of definition. Let $M$ be a finite $A$-module. Let
$d \geq \dim(\text{Supp}(M))$. Then
$$
e_I(M, r) = \sum
(-1)^i\text{length}_A H_i(K_\bullet(f_1, \ldots, f_r) \otimes_A M)
$$
\end{theorem}

\begin{proof}
Let us change the Koszul complex $K_\bullet(f_1, \ldots, f_r)$ into a cochain
complex $K^\bullet$ by setting $K^n = K_{-n}(f_1, \ldots, f_r)$.
Then $K^\bullet$ is sitting in degrees $-r, \ldots, 0$ and
$H^i(K^\bullet \otimes_A M) = H_{-i}(K_\bullet(f_1, \ldots, f_r) \otimes_A M)$.
The statement of the theorem makes sense as the modules
$H^i(K^\bullet \otimes M)$ are annihilated by $f_1, \ldots, f_r$
(More on Algebra, Lemma \ref{more-algebra-lemma-homotopy-koszul})
hence have finite length.
Define a filtration on the complex $K^\bullet$ by setting
$$
F^p(K^n \otimes_A M) =
I^{\max(0, p + n)}(K^n \otimes_A M),\quad p \in \mathbf{Z}
$$
Since $f_i I^p \subset I^{p + 1}$ this is a filtration by subcomplexes.
Thus we have a filtered complex and we obtain a spectral sequence, see
Homology, Section \ref{homology-section-filtered-complex}.
We have
$$
E_0 = \bigoplus\nolimits_{p, q} E_0^{p, q} =
\bigoplus\nolimits_{p, q} \text{gr}^p(K^{p + q} \otimes_A M) =
\text{Gr}_I(K^\bullet \otimes_A M)
$$
Since $K^n$ is finite free we have
$$
\text{Gr}_I(K^\bullet \otimes_A M) =
\text{Gr}_I(K^\bullet) \otimes_{\text{Gr}_I(A)} \text{Gr}_I(M)
$$
Note that $\text{Gr}_I(K^\bullet)$ is the Koszul
complex over $\text{Gr}_I(A)$ on the elements
$\overline{f}_1, \ldots, \overline{f}_r \in I/I^2$.
A simple calculation (omitted)
shows that the differential $d_0$ on $E_0$
agrees with the differential coming from the Koszul complex.
Since $\text{Gr}_I(M)$ is a finite $\text{Gr}_I(A)$-module
and since $\text{Gr}_I(A)$ is Noetherian (as a quotient
of $A/I[x_1, \ldots, x_r]$ with $x_i \mapsto \overline{f}_i$), the
cohomology module $E_1 = \bigoplus E_1^{p, q}$
is a finite $\text{Gr}_I(A)$-module. However, as above
$E_1$ is annihilated by $\overline{f}_1, \ldots, \overline{f}_r$.
We conclude $E_1$ has finite length.
In particular we find that $\text{Gr}^p_F(K^\bullet \otimes M)$ is
acyclic for $p \gg 0$.

\medskip\noindent
Next, we check that the spectral sequence above converges
using Homology, Lemma \ref{homology-lemma-filtered-complex-ss-converges}.
The required equalities follow easily from the Artin-Rees lemma
in the form stated in Algebra, Lemma \ref{algebra-lemma-map-AR}.
Thus we see that
\begin{align*}
\sum (-1)^i\text{length}_A(H^i(K^\bullet \otimes_A M))
& =
\sum (-1)^{p + q} \text{length}_A(E_\infty^{p, q}) \\
& =
\sum (-1)^{p + q} \text{length}_A(E_1^{p, q})
\end{align*}
because as we've seen above the length of $E_1$ is finite
(of course this uses additivity of lengths). Pick $t$ so
large that $\text{Gr}^p_F(K^\bullet \otimes M)$
is acyclic for $p \geq t$ (see above). Using
additivity again we see that
$$
\sum (-1)^{p + q} \text{length}_A(E_1^{p, q}) =
\sum\nolimits_n \sum\nolimits_{p \leq t}
(-1)^n \text{length}_A(\text{gr}^p(K^n \otimes_A M))
$$
This is equal to
$$
\sum\nolimits_{n = -r, \ldots, 0} (-1)^n{r \choose |n|} \chi_{I, M}(t + n)
$$
by our choice of filtration above and the definition of $\chi_{I, M}$ in
Algebra, Section \ref{algebra-section-Noetherian-local}.
The lemma follows from Lemma \ref{lemma-leading-coefficient}
and the definition of $e_I(M, r)$.
\end{proof}

\begin{remark}[Trivial generalization]
\label{remark-trivial-generalization}
Let $(A, \mathfrak m, \kappa)$ be a Noetherian local ring.
Let $M$ be a finite $A$-module. Let $I \subset A$ be an ideal.
The following are equivalent
\begin{enumerate}
\item $I' = I + \text{Ann}(M)$ is an ideal of definition
(Algebra, Definition \ref{algebra-definition-ideal-definition}),
\item the image $\overline{I}$ of $I$ in $\overline{A} = A/\text{Ann}(M)$
is an ideal of definition,
\item $\text{Supp}(M/IM) \subset \{\mathfrak m\}$,
\item $\dim(\text{Supp}(M/IM)) \leq 0$, and
\item $\text{length}_A(M/IM) < \infty$.
\end{enumerate}
This follows from Algebra, Lemma \ref{algebra-lemma-support-point}
(details omitted). If this is the case we have $M/I^nM = M/(I')^nM$
for all $n$ and $M/I^nM = M/\overline{I}^nM$ for all $n$
if $M$ is viewed as an $\overline{A}$-module.
Thus we can define
$$
\chi_{I, M}(n) = \text{length}_A(M/I^nM) =
\sum\nolimits_{p = 0, \ldots, n - 1} \text{length}_A(I^pM/I^{p + 1}M)
$$
and we get
$$
\chi_{I, M}(n) = \chi_{I', M}(n) = \chi_{\overline{I}, M}(n)
$$
for all $n$ by the equalities above.
All the results of Algebra, Section \ref{algebra-section-Noetherian-local}
and all the results in this section, have analogues in this setting.
In particular we can define multiplicties $e_I(M, d)$ for
$d \geq \dim(\text{Supp}(M))$ and we have
$$
\chi_{I, M}(n) \sim e_I(M, d) \frac{n^d}{d!} + \text{lower order terms}
$$
as in the case where $I$ is an ideal of definition.
\end{remark}



\section{Computing intersection multiplicities}
\label{section-computing-intersection-multiplicities}

\noindent
In this section we discuss some cases where the intersection multiplicities
can be computed by different means. Here is a first example.

\begin{lemma}
\label{lemma-intersection-multiplicity-CM}
Let $X$ be a nonsingular projective variety and $W, V \subset X$ closed
subvarieties which intersect properly. Let $Z$ be an irreducible component
of $V \cap W$ with generic point $\xi$. Assume that $\mathcal{O}_{W, \xi}$
and $\mathcal{O}_{V, \xi}$ are Cohen-Macaulay. Then
$$
e(X, V \cdot W, Z) =
\text{length}_{\mathcal{O}_{X, \xi}}(\mathcal{O}_{V \cap W, \xi})
$$
where $V \cap W$ is the scheme theoretic intersection.
In particular, if both $V$ and $W$ are Cohen-Macaulay, then
$V \cdot W = [V \cap W]_{\dim(V) + \dim(W) - \dim(X)}$.
\end{lemma}

\begin{proof}
Set $A = \mathcal{O}_{X, \xi}$, $B = \mathcal{O}_{V, \xi}$, and
$C = \mathcal{O}_{W, \xi}$. By Auslander-Buchsbaum
(Algebra, Proposition \ref{algebra-proposition-Auslander-Buchsbaum})
we can find a finite free resolution $F_\bullet \to B$ of
length
$$
\text{depth}(A) - \text{depth}(B) =
\dim(A) - \dim(B) = \dim(C)
$$
First equality as $A$ and $B$ are Cohen-Macaulay and the second
as $V$ and $W$ intersect properly. Then $F_\bullet \otimes_A C$ is a
complex of finite free modules representing $B \otimes_A^\mathbf{L} C$
hence has cohomology modules with support in $\{\mathfrak m_A\}$.
By the Acyclicity lemma (Algebra, Lemma \ref{algebra-lemma-acyclic})
which applies as $C$ is Cohen-Macaulay
we conclude that $F_\bullet \otimes_A C$ has nonzero
cohomology only in degree $0$. This finishes the proof.
\end{proof}

\begin{lemma}
\label{lemma-one-ideal-ci}
Let $A$ be a Noetherian local ring. Let $I = (f_1, \dots, f_r)$ be an ideal
generated by a regular sequence. Let $M$ be a finite $A$-module. Assume that
$\dim(\text{Supp}(M/IM)) = 0$. Then
$$
e_I(M, r) = \sum (-1)^i\text{length}_A(\text{Tor}_i^A(A/I, M))
$$
Here $e_I(M, r)$ is as in Remark \ref{remark-trivial-generalization}.
\end{lemma}

\begin{proof}
Since $f_1, \ldots, f_r$ is a regular sequence the Koszul complex
$K_\bullet(f_1, \ldots, f_r)$ is a resolution of $A/I$ over $A$, see
More on Algebra, Lemma
\ref{more-algebra-lemma-noetherian-finite-all-equivalent}.
Thus the right hand side is equal to
$$
\sum (-1)^i\text{length}_A H_i(K_\bullet(f_1, \ldots, f_r) \otimes_A M)
$$
Now the result follows immediately from
Theorem \ref{theorem-multiplicity-with-koszul} if $I$ is an ideal
of definition. In general, we replace $A$ by $\overline{A} = A/\text{Ann}(M)$
and $f_1, \ldots, f_r$ by $\overline{f}_1, \ldots, \overline{f}_r$
which is allowed because
$$
K_\bullet(f_1, \ldots, f_r) \otimes_A M =
K_\bullet(\overline{f}_1, \ldots, \overline{f}_r) \otimes_{\overline{A}} M
$$
Since $e_I(M, r) = e_{\overline{I}}(M, r)$ where
$\overline{I} = (\overline{f}_1, \ldots, \overline{f}_r) \subset \overline{A}$
is an ideal of definition the result follows from
Theorem \ref{theorem-multiplicity-with-koszul} in this case as well.
\end{proof}

\begin{lemma}
\label{lemma-multiplicity-with-lci}
Let $X$ be a nonsingular projective variety. Let $W,V \subset X$ be
closed subvarieties which intersect properly. Let $Z$ be an irreducible
component of $V \cap W$ with generic point $\xi$.
Suppose the ideal of $V$ in $A$ is cut out by
a regular sequence $f_1, \ldots, f_c \in \mathcal{O}_{X, \xi}$.
Then $e(X, V\cdot W, Z)$ is equal to $c!$ times the leading coefficient in
the Hilbert polynomial
$$
t \mapsto \text{length}_{\mathcal{O}_{X, \xi}}
\mathcal{O}_{W, \xi}/(f_1, \ldots, f_c)^t,\quad t \gg 0.
$$
\end{lemma}

\begin{proof}
This follows immediately from the more general
Lemma \ref{lemma-one-ideal-ci}.
\end{proof}

\begin{lemma}
\label{lemma-multiplicity-with-effective-Cartier-divisor}
In Lemma \ref{lemma-multiplicity-with-lci} assume that  $c = 1$, i.e., $V$
is an effective Cartier divisor. Then
$$
e(X, V \cdot W, Z) =
\text{length}_{\mathcal{O}_{X, \xi}}
(\mathcal{O}_{W, \xi}/f_1\mathcal{O}_{W, \xi}).
$$
\end{lemma}

\begin{proof}
In this case the image of $f_1$ in $\mathcal{O}_{W, \xi}$ is nonzero by
properness of intersection, hence a nonzerodivisor divisor. Moreover,
$\mathcal{O}_{W, \xi}$ is a Noetherian local domain of dimension $1$.
Thus
$$
\text{length}_{\mathcal{O}_{X, \xi}}
(\mathcal{O}_{W, \xi}/f_1^t\mathcal{O}_{W, \xi}) =
t \text{length}_{\mathcal{O}_{X, \xi}}
(\mathcal{O}_{W, \xi}/f_1\mathcal{O}_{W, \xi})
$$
for all $t \geq 1$, see Algebra, Lemma \ref{algebra-lemma-ord-additive}.
This proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-multiplicity-lci-CM}
In Lemma \ref{lemma-multiplicity-with-lci} assume that
the local ring $\mathcal{O}_{W, \xi}$ is Cohen-Macaulay. Then we
have
$$
e(X, V \cdot W, Z) =
\text{length}_{\mathcal{O}_{X, \xi}} (\mathcal{O}_{W, \xi}/
f_1\mathcal{O}_{W, \xi} + \ldots + f_c\mathcal{O}_{W, \xi}).
$$
\end{lemma}

\begin{proof}
This follows immediately from Lemma \ref{lemma-intersection-multiplicity-CM}.
Alternatively, we can deduce it from Lemma \ref{lemma-multiplicity-with-lci}.
Namely, by Algebra, Lemma \ref{algebra-lemma-reformulate-CM}
we see that $f_1, \ldots, f_c$ is a regular sequence in
$\mathcal{O}_{W, \xi}$. Then
Algebra, Lemma \ref{algebra-lemma-regular-quasi-regular} shows that
$f_1, \ldots, f_c$ is a quasi-regular sequence.
This easily implies the length of
$\mathcal{O}_{W, \xi}/(f_1, \ldots, f_c)^t$ is
$$
{c + t \choose c}
\text{length}_{\mathcal{O}_{X, \xi}} (\mathcal{O}_{W, \xi}/
f_1\mathcal{O}_{W, \xi} + \ldots + f_c\mathcal{O}_{W, \xi}).
$$
Looking at the leading coefficient we conclude.
\end{proof}


\section{Intersection product using Tor formula}
\label{section-intersection-product}

\noindent
Let $X$ be a nonsingular projective variety. Let
$\alpha = \sum n_i [W_i]$ be an $r$-cycle and
$\beta = \sum_j m_j [V_j]$ be an $s$-cycle on $X$.
Assume that $\alpha$ and $\beta$ intersect properly, see
Definition \ref{definition-proper-intersection}.
In this case we define
$$
\alpha \cdot \beta = \sum\nolimits_{i,j} n_i m_j W_i \cdot V_j.
$$
where $W_i \cdot V_j$ is as defined in Section \ref{section-tor-formula}.

\begin{lemma}
\label{lemma-rational-equivalence-and-intersection}
Let $X$ be a nonsingular projective variety. Any $k$-cycle which is
rationally equivalent to $0$ is of the form
$$
pr_{X,*}( \alpha \cdot X \times a - \alpha \cdot X \times b).
$$
where $\alpha$ is a $(k + 1)$-cycle on $X \times \mathbf{P}^1$
which intersects $X \times a$ and $X \times b$ properly.
\end{lemma}

\begin{proof}
Immediate from the definitions and the calculation of intersection
multiplicity in case of a Cartier divisor given in
Lemma \ref{lemma-multiplicity-with-effective-Cartier-divisor}.
\end{proof}


\section{Exterior product}
\label{section-exterior-product}

\noindent
Let $X$ and $Y$ be nonsingular projective vareities.
Let $V$, resp.\ $W$ be a closed subvariety of $X$, resp.\ $Y$.
The product $V\times W$ is a closed subscheme of $X\times Y$.
It is a subvariety because the ground field is algebraically closed.
For a $k$-cycle $\alpha = \sum n_i [V_i]$ and a $l$-cycle
$\beta = \sum m_j [V_j]$ on $Y$ we define
$\alpha \times \beta = \sum n_i m_j [V_i \times W_j]$.

\medskip\noindent
Consider the subvariety $X \subset X$ with class $[X]$.
Note that $pr_Y^*(\beta) = [X]\times \beta$.
Note that $\alpha \times [Y]$ and $[X]\times \beta$
intersect properly on $X\times Y$. With the definitions
above we have $\alpha \times \beta =
(\alpha \times [Y])\cdot ([X]\times\beta) =
pr_Y^*(\alpha) \cdot pr_X^*(\beta)$.


\section{Reduction to the diagonal}
\label{section-reduction-diagonal}

\noindent
Let $X$ be a nonsingular projective
variety. Let $\Delta \subset X \times X$ denote the diagonal.
We will identify $\Delta$ with $X$.
Let $\alpha$, resp.\ $\beta$ be $r$-cycles, resp.\ $s$-cycles
on $X$. Assume $\alpha$ and $\beta$ intersect properly. In this case
$\alpha \times \beta$ and $[\Delta]$ intersect properly. Note that
the cycle $\Delta \cdot \alpha\times\beta$ is supported on the diagonal
and hence we can think of it as a cycle on $X$. With this convention
we have $\alpha \cdot \beta = \Delta \cdot \alpha\times\beta$.
See \cite[Chapter V]{Serre_algebre_locale}.

\medskip\noindent
Perhaps a less confusing formulation would be that
$pr_{1,*}( \Delta \cdot \alpha\times\beta ) = \alpha\cdot\beta$,
where $pr_1 : X\times X \to X$ is the projection.

\medskip\noindent
Combined with the fact that $\Delta$ is a regular immersion
and Lemma \ref{lemma-one-ideal-ci} this implies that the
intersection multiplicities $e(X, V \cdot W, Z)$ are {\it positive}!
Formulate this precisely and prove it here.

\begin{lemma}
\label{lemma-tor-sheaf}
\begin{reference}
\cite[Chapter V]{Serre_algebre_locale}
\end{reference}
Let $X$ be a nonsingular projective variety. Let $\mathcal{F}$ and
$\mathcal{G}$ be coherent sheaves on $X$ with
$\dim(\text{Supp}(\mathcal{F})) \leq r$,
$\dim(\text{Supp}(\mathcal{G})) \leq s$, and
$\dim(\text{Supp}(\mathcal{F}) \cap \text{Supp}(\mathcal{G}) )
\leq r + s - \dim X$. In this case $[\mathcal{F}]_r$ and $[\mathcal{G}]_s$
intersect properly and
$$
[\mathcal{F}]_r \cdot [\mathcal{G}]_s = \sum (-1)^i
[\text{Tor}_i^{\mathcal{O}_X}(\mathcal{F}, \mathcal{G})]_{r + s - \dim(X)}.
$$
\end{lemma}

\begin{proof}

\end{proof}



\section{Flat pullback and intersection products}
\label{section-flat-pullback-and-intersection-products}

\noindent
Suppose that $f : X \to Y$ is a flat morphism of nonsingular
projective varieties. Suppose that $\alpha$ is a $k$-cycle
on $Y$ and that $\beta$ is a $l$-cycle on $Y$. Assume that
$\alpha$ and $\beta$ intersect properly. Then $f^*\alpha$
and $f^*\beta$ intersect properly and $f^*( \alpha \cdot \beta )
= f^*\alpha \cdot f^*\beta$.

\section{Projection formula for flat maps}
\label{section-projection-formula-flat}

\noindent
Let $f : X \to Y$ be a flat morphism
of relative dimension $r$ of nonsingular projective varieties.
Let $\alpha$ be an $k$-cycle on $X$ and let $\beta$ be a $l$-cycle
on $Y$. Assume that $f_*(\alpha)$ and $\beta$ intersect properly,
and that $\alpha$ and $f^*(\beta)$ intersect properly. The projection
formula says that $f_*(\alpha) \cdot \beta =
f_*( \alpha \cdot f^*\beta)$ in this case.
See \cite[Chapter V, Section 7, formula (10)]{Serre_algebre_locale}
for a more general formula.

\medskip\noindent
We explain how to prove the projection formula in the flat case.
Let $W \subset X$ be a closed subvariety of dimension $k$.
Let $V \subset Y$ be a closed subvariety of dimension $l$,
so $f^{-1}(V)$ has pure dimension $l+r$.
Assume that $W$ and $[f^{-1}(V)]$ intersect properly. Note that
$f(W \cap f^{-1}(V)) = f(W) \cap V$. Hence it follows
that $f(W)$ and $V$ intersect properly as well. Let
$Z \subset f(W) \cap V$ be an irreducible component
of dimension $k+l-\dim Y$. Let $Z_i \subset W\cap f^{-1}(V)$
be the irreducible components of $W\cap f^{-1}(V)$
dominating $Z$.
Let $A$ be the local ring of $X$ at the generic point of $Z$.
Let $A_i$ be the local ring of $Y$ at the generic point of $Z_i$.
Let $B$ be the local ring of $f(W)$ at the generic point of $Z$.
Let $B'$ be the stalk of $f_*(\mathcal{O}_W)$ at the generic point
of $Z$. Then $B \to B'$ is finite, $B'$ is semi-local, and the
localizations $B'_i$ of $B'$ are the local rings of $W$ at the generic
point of the $Z_i$. Thus they are quotients $A_i \to B_i'$.
Let $C$ be the local ring of $V$ at the generic point of $Z$.
The multiplicity of $Z$ in $f_*([W])\cdot V$ is by definition
$$
(I) = [B' : B] \sum (-1)^j \hbox{length}_{A}(Tor^A_j(B,C)).
$$
Here $[B':B]$ is the rank of the $B$-module $B'$.
The multiplicity of $Z$ in $f_*( W \cdot f^*[V])$ is
by definition
$$
(II) = \sum\nolimits_{i,j} (-1)^j
\hbox{length}_{A_i}(Tor^{A_i}_j(B'_i, A_i\otimes_A C))
[\kappa(A_i):\kappa(A)]
$$
Here $\kappa(-)$ indicates the residue field.
The first thing is to note that
$\hbox{length}_A(M) = [\kappa(A_i):\kappa(A)]\hbox{length}_{A_i}(M)$
for a finite length $A_i$-module $M$.
We can compute all the Tor groups by choosing a free resolution
of $C$ as an $A$-module. Doing this it is easy to see that
(I) equals $\sum (-1)^j \hbox{length}_{A}(Tor^A_j(B', C))$.
Finally, note that, by definition, there is an $A$-module map
$B^{\oplus [B':B]} \to B'$ whose kernel and cokernel are
supported in a proper closed subset of $Spec(B)$. From the
additivity properties of the Tor-formula, see
\cite[Chapter V]{Serre_algebre_locale},
it follows that $\sum (-1)^j \hbox{length}_{A}(Tor^A_j(B', C)) =
[B':B] \sum (-1)^j \hbox{length}_{A}(Tor^A_j(B, C))$ as desired.


\section{Moving Lemma}
\label{section-moving-lemma}

\noindent
The moving lemma states that given an $r$-cycle $\alpha$ and a $s$ cycle
$\beta$ there exists $\alpha'$, $\alpha' \sim_{rat} \alpha$ such that
$\alpha$ and $\beta$ intersect properly.
See \cite{Samuel}, \cite{ChevalleyI}, \cite{ChevalleyII}.
The key to this is a lemma in the form stated in
\cite[Example 11.4.1]{F} and proved in \cite{Roberts}.

\begin{lemma}
\label{lemma-moving}
Let $X \subset \mathbf{P}^N$ be a nonsingular closed subvariety.
Let $n = \dim(X)$ and $0 \leq d, d' < n$. Let $Z \subset X$ be a closed
subvariety of dimension $d$ and $T_i \subset X$, $i \in I$ be a finite
collection of closed subvarities of dimension $d'$. Then there exists
a subvariety $C \subset \mathbf{P}^N$ such that $C$ intersects $X$
properly and such that
$$
C \cdot X = Z + \sum\nolimits_{j \in J} m_j Z_j
$$
where $Z_j \subset X$ are irreducible of dimension $d$, distinct from $Z$, and
$$
\dim(Z_j \cap T_i) \leq \dim(Z \cap T_i)
$$
with strict inequality if $Z$ does not intersect $T_i$ properly in $X$.
\end{lemma}

\begin{proof}
See \cite{Roberts}.
\end{proof}



\section{Intersection products and rational equivalence}
\label{section-intersections-and-rational-equivalence}

\noindent
With definitions as above we show that
the intersection product is well defined modulo rational
equivalence. Let $X$ be a nonsingular projective algebraic
variety. Let $\alpha$, resp.\ $\beta$ be a $s$, resp.\ $r$
cycle on $X$. Assume that $\alpha$ and $\beta$ intersect
properly so that $\alpha \cdot \beta$ is defined. Finally,
assume that $\alpha \sim_{rat} 0$. Goal: show that
$\alpha \cdot \beta \sim_{rat} 0$.

\medskip\noindent
There is a formal part of the argument which uses the moving lemma
and there is more geometric part using properties of the Tor formula.

\medskip\noindent
It suffices to prove the result when $\beta = [Z]$
for some $r$-dimensional closed subvariety $Z \subset X$.
The condition $\alpha \sim_{rat} 0$ means there
are finitely many $(r + 1)$-dimensional closed subvarieties
$W_i \subset X \times \mathbf{P}^1$ such that
$$
\alpha = \sum [W_{i, a_i}] - [W_{i, b_i}]
$$
for some pairs of points $a_i, b_i$ of $\mathbf{P}^1$.
Let $W_{i, a_i}^t$ and $W_{i, b_i}^t$ be the irreducible components.
Apply the moving lemma to $Z \subset X$ and the family of
subvarieties $\{W_{i, a_i}^t, W_{i, b_i}^t\}$. Then we see that
$$
[Z] + \sum m_j [Z_j]
$$
is equal to $\tilde Z_0$ for some $(r + 1)$-dimensional closed subvariety
$\tilde Z \subset X \times \mathbf{P}^1$ such that $\tilde Z_\infty$
is a closed subvariety in general position
and moreover, the excess intersection of the
$Z_j$ with the subvarieties $W_{i, a_i}^t$, $W_{i, b_i}^t$ decreases
if positive.
By the case discussed below we find that
$\alpha \cdot \tilde Z_0 \sim_{rat} \alpha \cdot \tilde Z_\infty$
(because each subvariety in the support of $\alpha$ occurs
as one the the $W_{i, a_i}^t$ and $W_{i, b_i}^t$ and moreover
properly intersects $Z$, whence $Z_j$ by our starting assumption).
Hence it suffices to show that
$\alpha \cdot [Z_j] \sim_{rat} 0$ and
$\alpha \cdot Z_\infty \sim_{rat} 0$.
Thus by induction on the excess intersection, we reduce to the
case where there is no excess intersection, i.e., all the
intersections $Z \cap W_{i, a_i}$, $Z \cap W_{i, b_i}$ are
proper. This again is the case treated below.

\medskip\noindent
Special case. Let $W \subset X \times {\bf P}^1$
be a $(s + 1)$-dimensional subvariety dominating ${\bf P}^1$.
Let $W_a$, resp.\ $W_b$ be the fibre of $W \to {\bf P}^1$
over $a$, resp.\ $b$. Let $V$ be a $r$-dimensional
subvariety of $X$ such that $V$ intersects both $W_a$ and
$W_b$ properly. Then $V \cdot [W_a] \sim_{rat} V \cdot [W_b]$.

\medskip\noindent
In order to see this, note first that
$[W_a] = pr_{X,*}( W \cdot X\times a)$ and similar for $[W_b]$.
Thus we reduce to showing
$$
V \cdot pr_{X,*}( W \cdot X\times a) \sim_{rat} V \cdot
pr_{X,*}( W \cdot X\times b).
$$
The projection formula -- which may be applied -- says
$V \cdot pr_{X,*}( W \cdot X\times a) =
pr_{X,*}(V \times {\bf P}^1 \cdot (W \cdot X\times a))$,
and similar for $b$. Thus we reduce to showing
$$
pr_{X,*}(V \times {\bf P}^1 \cdot (W \cdot X\times a))
\sim_{rat}
pr_{X,*}(V \times {\bf P}^1 \cdot (W \cdot X\times b))
$$
Associativity for the intersection multiplicities (see
\cite[Chapter V]{Serre_algebre_locale})
implies that $V \cdot (W \cdot X\times a) =
(V \times {\bf P}^1 \cdot W) \cdot X \times a$
and similar for $b$.  Thus we reduce to showing
$$
pr_{X,*}((V \times {\bf P}^1 \cdot W) \cdot X\times a)
\sim_{rat}
pr_{X,*}((V \times {\bf P}^1 \cdot W) \cdot X\times b)
$$
which is true by definition of rational equivalence.


\section{Chow rings}
\label{section-chow-rings}

\noindent
Using the above, for any nonsingular
projective $X$ we set $A_k(X)$ equal to the group of $k$-cycles
on $X$ modulo rational equivalence. Since it is more convenient
we also use $A^c(X)=A_{\dim X -c}(X)$ to denote the group of
codimension $c$ cycles modulo rational equivalence. The intersection product
defines a product
$$
A^k(X) \times A^l(X) \longrightarrow A^{k+l}(X)
$$
defined as follows: for $a \in A^k(X)$ and $b \in A^l(X)$
we can find a codimension $k$ cycle $\alpha$ representing $\alpha$,
a codimension $l$ cycle $\beta$ representing $b$ such that $\alpha$
and $\beta$ intersect properly.
We define $a\cdot b$ to be the rational equivalence
class of $\alpha \cdot \beta$. End result: A commutative and associative
graded ring $A^*(X)$ with unit $1=[X]$.


\section{Pullback for a general morphism}
\label{section-general-pullback}

\noindent
Let $X$ and $Y$ be nonsingular projective varieties,
and let $f : X \to Y$ be a morphism. We define
$$
f^* : A_k(Y) \to A_{k+\dim X - \dim Y}(X)
$$
by the rule
$$
f^*(\alpha) = pr_{X,*}(\Gamma_f \cdot pr_{Y}^*(\alpha))
$$
where $\Gamma_f \subset X\times Y$ is the graph of $f$.
Note that it is defined only on cycle classes and not
on cylces. This pullback satisfies:
\begin{enumerate}
\item $f^* : A^*(Y) \to A^*(X)$ is a ring map,
\item $(f \circ g)^* = g^* \circ f^*$ for a composable
pair $f,g$,
\item the projection formula holds: $f_*(\alpha) \cdot \beta =
f_*( \alpha \cdot f^*\beta)$, and
\item if $f$ is flat then it agrees with the previous definition.
\end{enumerate}
All of these follow easily from the above. For (1) you have to show that
$pr_{X,*}( \Gamma_f \cdot \alpha \cdot \beta) =
pr_{X,*}(\Gamma_f \cdot \alpha) \cdot
pr_{X,*}(\Gamma_f \cdot \beta)$. It is easy to see that
if $\alpha$ intersects $\Gamma_f$ properly, then
$\Gamma_f \cdot \alpha =
\Gamma_f \cdot pr_X^*(pr_{X,*}(\Gamma_f \cdot \alpha))$ as cycles
because $\Gamma_f$ is a graph. Thus we get
\begin{align*}
pr_{X,*}( \Gamma_f \cdot \alpha \cdot \beta)
& = pr_{X,*}( \Gamma_f \cdot
pr_X^*(pr_{X,*}(\Gamma_f \cdot \alpha)) \cdot \beta) \\
& =
pr_{X,*}( pr_X^*(pr_{X,*}(\Gamma_f \cdot \alpha))
\cdot (\Gamma_f \cdot \beta)) \\
& =
pr_{X,*}(\Gamma_f \cdot \alpha) \cdot pr_{X,*}(\Gamma_f \cdot \beta)
\end{align*}
the last step by the projection formula in the flat case. Properties
(2) and (3) are formal [for (3) use the flat projection formula twice].
Property (4) rests on identifying the intersection product
$\Gamma_f \cdot \alpha$ in the case $f$ is flat.


\section{Pullback of cycles}
\label{section-pullback-cycles}

\noindent
Suppose that $X$ and $Y$ be nonsingular
projective varieties, and let $f : X \to Y$ be a morphism.
Suppose that $Z \subset Y$ is a closed subvariety. Let $f^{-1}(Z)$
be the scheme theoretic inverse image:
$$
\xymatrix{
f^{-1}(Z) \ar[r] \ar[d] & Z \ar[d] \\
X \ar[r] & Y
}
$$
is a fibre product diagram of schemes. In particular $f^{-1}(Z) \subset X$
is a closed subscheme of $X$. In this case we always have
$$
\dim f^{-1}(Z) \geq \dim Z + \dim X - \dim Y.
$$
If equality holds in the formula above, then
$f^*[Z] = [f^{-1}(Z)]_{\dim Z + \dim X - \dim Y}$
provided that the scheme $Z$ is Cohen-Macaulay at the images
of the generic points of $f^{-1}(Z)$. This follows by identifying
$f^{-1}(Z)$ with the scheme theoretic intersection of $\Gamma_f$
and $X \times Z$ and using Lemma \ref{lemma-multiplicity-lci-CM}.






\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
