\input{preamble}

% OK, start here.
%
\begin{document}

\title{Intersection Theory}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents


\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we construct the intersection product on the
Chow groups modulo rational equivalence on a nonsingular projective
variety over a fixed algebraically closed field $\mathbf{C}$.
A great reference for this chapter is
\cite[Chapter V]{Serre_algebre_locale}


\section{Conventions}
\label{section-conventions}

\noindent
We fix an algebraically closed ground field $\mathbf{C}$.
All schemes and varieties are over $\mathbf{C}$ and all
morphisms are over $\mathbf{C}$. A variety $X$ is
{\it nonsingular} if $X$ is a regular scheme (see
Properties, Definition \ref{properties-definition-regular}).
In our case this means that the morphism $X \to \Spec(\mathbf{C})$
is smooth (see
Varieties, Lemma \ref{varieties-lemma-geometrically-regular-smooth}).


\section{Cycles}
\label{section-cycles}

\noindent
Let $X$ be a nonsingular projective variety.
A {\it $k$-cycle} on $X$ is a finite formal sum $\sum n_i [Z_i]$
where each $Z_i$ is a closed subvariety of dimension $k$.
The {\it support} of $\alpha$ is the closed subset
$$
\text{Supp}(\alpha) = \bigcup\nolimits_{n_i \not = 0} Z_i \subset X
$$
of dimension $k$. The group of $k$-cycles is denoted $Z_k(X)$.
See Chow Homology, Section \ref{chow-section-cycles}.


\section{Cycle associated to closed subscheme}
\label{section-cycle-of-closed}

\noindent
Suppose that $X$ is a nonsingular projective variety and that $Z \subset X$
is a closed subscheme with $\dim(Z) \leq k$. Let $Z_i$ be the irreducible
components of $Z$ of dimension $k$ and let $n_i$ be the
{\it multiplicity of $Z_i$ in $Z$} defined as
$$
n_i = \text{length}_{\mathcal{O}_{X, Z_i}} \mathcal{O}_{Z, Z_i}
$$
where $\mathcal{O}_{X, Z_i}$, resp.\ $\mathcal{O}_{Z, Z_i}$ is the
local ring of $X$, resp.\ $Z$ at the generic point of $Z_i$.
We define the $k$-cycle associated to $Z$ to be the $k$-cycle
$$
[Z]_k = \sum n_i [Z_i].
$$
See Chow Homology, Section \ref{chow-section-cycle-of-closed-subscheme}.


\section{Cycle associated to a coherent sheaf}
\label{section-cycle-of-coherent-sheaf}

\noindent
Suppose that $X$ is a nonsingular projective variety and that $\mathcal{F}$
is a coherent $\mathcal{O}_X$-module on $X$ with
$\dim(\text{Supp}(\mathcal{F})) \leq k$.
Let $Z_i$ be the irreducible components of $\text{Supp}(\mathcal{F})$
of dimension $k$ and let $n_i$ be the
{\it multiplicity of $Z_i$ in $\mathcal{F}$} defined as
$$
n_i = \text{length}_{\mathcal{O}_{X, Z_i}} \mathcal{F}_{\xi_i}
$$
where $\mathcal{O}_{X, Z_i}$ is the
local ring of $X$ at the generic point $\xi_i$ of $Z_i$
and $\mathcal{F}_{\xi_i}$ is the stalk of $\mathcal{F}$ at this point.
We define the $k$-cycle associated to $\mathcal{F}$ to be the $k$-cycle
$$
[\mathcal{F}]_k = \sum n_i [Z_i].
$$
See Chow Homology, Section \ref{chow-section-cycle-of-coherent-sheaf}.
Note that, if $\dim(Z) \leq k$, then $[Z]_k = [\mathcal{O}_Z]_k$.


\section{Pushforward}
\label{section-pushforward}

\noindent
Suppose that $f : X \to Y$ is a morphism of nonsingular projective varieties.
Let $Z \subset X$ be a $k$-dimensional
closed subvariety. We define $f_*[Z]$ to be $0$ if $\dim(f(Z))<k$
and $d \cdot [f(Z)]$ if $\dim(f(Z)) = k$ where
$$
d = [\mathbf{C}(Z) : \mathbf{C}(f(Z))] = \deg(Z/f(Z))
$$
is the degree of the dominant morphism $Z \to f(Z)$, see
Morphisms, Definition \ref{morphisms-definition-degree}.
Let $\alpha = \sum n_i [Z_i]$ be a $k$-cycle on $Y$. The
{\it pushforward} of $\alpha$ is the sum $f_* \alpha = \sum n_i f_*[Z_i]$
where each $f_*[Z_i]$ is defined as above. This defines a homomorphism
$$
f_* : Z_k(X) \longrightarrow Z_k(Y)
$$
See Chow Homology, Section \ref{chow-section-proper-pushforward}.

\begin{lemma}
\label{lemma-push-coherent}
\begin{reference}
See \cite[Chapter V]{Serre_algebre_locale}.
\end{reference}
Suppose that $f : X \to Y$ is a morphism of projective nonsingular varieties.
Let $\mathcal{F}$ be a coherent sheaf with
$\dim(\text{Supp}(\mathcal{F})) \leq k$, then
$f_*[\mathcal{F}]_k = [f_*\mathcal{F}]_k$. In particular, if
$Z \subset X$ is a $k$-dimensional closed subvariety, then
$f_*[Z] = [f_*\mathcal{O}_Z]_k$.
\end{lemma}

\begin{proof}
See Chow Homology, Lemma \ref{chow-lemma-cycle-push-sheaf}.
\end{proof}

\begin{lemma}
\label{lemma-compose-pushforward}
Let $f : X \to Y$ and $g : Y \to Z$ be morphisms of nonsingular projective
varieties. Then $g_* \circ f_* = (g \circ f)_*$ as maps $Z_k(X) \to Z_k(Z)$.
\end{lemma}

\begin{proof}
Special case of Chow Homology, Lemma \ref{chow-lemma-compose-pushforward}.
\end{proof}



\section{Flat pullback}
\label{section-flat-pullback}

\noindent
Suppose that $f : X \to Y$ is a flat morphism of nonsingular projective
varieties. Then there exists an integer $r \geq 0$ such that $f$ is of
relative dimension $r$, in other words all fibres have dimension
$r$\footnote{In fact, the converse is true as well: if $f : X \to Y$ is
a dominant morphism of nonsingular projective varieties and all fibres have
dimension $r$, then $f$ is flat. This follows from
Algebra, Lemma \ref{algebra-lemma-CM-over-regular-flat}.}.
Let $Z \subset X$ be a $k$-dimensional closed subvariety. We define
$f^*[Z]$ to be the $k + r$-cycle associated to the scheme theoretic
inverse image: $f^*[Z] = [f^{-1}(Z)]_{k + r}$. Let
$\alpha = \sum n_i [Z_i]$ be a $k$-cycle on $Y$. The {\it pullback} of
$\alpha$ is the sum $f_* \alpha = \sum n_i f^*[Z_i]$ where each $f^*[Z_i]$
is defined as above. This defines a homomorphism
$$
f^* : Z_k(Y) \longrightarrow Z_{k + r}(X)
$$
See Chow Homology, Section \ref{chow-section-flat-pullback}.

\begin{lemma}
\label{lemma-pullback}
Let $f : X \to Y$ be a flat morphism of nonsingular projective varieties
of relative dimension $r$.
Then $f^*[\mathcal{F}]_k = [f^*\mathcal{F}]_{k + r}$
if $\mathcal{F}$ is a coherent sheaf on $Y$ and the dimension of the
support of $\mathcal{F}$ is at most $k$.
\end{lemma}

\begin{proof}
See Chow Homology, Lemma \ref{chow-lemma-pullback-coherent}.
\end{proof}

\begin{lemma}
\label{lemma-compose-flat-pullback}
Let $f : X \to Y$ and $g : Y \to Z$ be flat morphisms of
nonsingular projective varieties. Then $g \circ f$ is flat
and $f^* \circ g^* = (g \circ f)^*$
as maps $Z_k(Z) \to Z_{k + \dim(X) - \dim(Z)}(X)$.
\end{lemma}

\begin{proof}
Special case of Chow Homology, Lemma \ref{chow-lemma-compose-flat-pullback}.
\end{proof}


\section{Rational Equivalence}
\label{section-rational-equivalence}

\noindent
We are going to define rational equivalence in a way which at first
glance may seem different from what you are used to, or from what
is in \cite[Chapter I]{F} or
Chow Homology, Section \ref{chow-section-rational-equivalence}.
However, in Section \ref{section-alternative} we will show that
the two notions agree.

\medskip\noindent
Let $X$ be a nonsingular projective variety. Let $W \subset X \times {\bf P}^1$
be a closed subvariety of dimension $k + 1$. Let $a, b$ be two distinct closed
points of ${\bf P}^1$. Assume that $X \times a$, $X \times b$ and $W$
intersect properly:
$$
\dim (W \cap X \times a) \leq k,\quad
\dim (W \cap X \times b) \leq k.
$$
This is true as soon as $W \to \mathbf{P}^1$ is dominant or if $W$ is
contained in a fibre of the projection over a closed point different from
$a$ or $b$ (this is an uninteresting case which we will discard). In this
situation the scheme theoretic fibre $W_a$ of the morphism
$W \to \mathbf{P}^1$ is equal to the scheme theoretic intersection
$X \times a \cap W$ in $X \times \mathbf{P}^1$. Identifying $X \times a$
and $X \times b$ with $X$ we may think of the fibres $W_a$ and $W_b$
as closed subschemes of $X$ of dimension $\leq k$. A basic example of a
rational equivalence is
$$
[W_a]_k \sim_{rat} [W_b]_k
$$
The cycles $[W_a]_k$ and $[W_b]_k$ are easy to compute in practice
(given $W$) because they are obtained by proper intersection with
a Cartier divisor (we will see this in
Section \ref{section-computing-intersection-multiplicities}).
Since the automorphism group of $\mathbf{P}^1$ is $2$-transitive we may
move the pair of closed points $a, b$ to any pair we like. A traditional
choice is to choose $a = 0$ and $b = \infty$.

\medskip\noindent
More generally, let $\alpha = \sum n_i [W_i]$ be a $(k + 1)$-cycle on
$X \times {\bf P}^1$.  Let $a_i, b_i$ be pairs of distinct closed points of
${\bf P}^1$. Assume that $X \times a_i$, $X \times b_i$ and $W_i$ intersect
properly, in other words, each $W_i, a_i, b_i$ satisfies the condition
discussed above. A {\it cycle rationally equivalent to zero} is any cycle
of the form
$$
\sum n_i([W_{i, a_i}]_k - [W_{i, b_i}]_k).
$$
This is indeed a $k$-cycle. The collection of $k$-cycles rationally
equivalent to zero is an additive subgroup of the group of $k$-cycles.
We say two $k$-cycles are {\it rationally equivalent}, notation
$\alpha \sim_{rat} \alpha'$, if $\alpha - \alpha'$ is a cycle rationally
equivalent to zero.

\medskip\noindent
We define
$$
A_k(X) = Z_k(X)/ \sim_{rat}
$$
to be the {\it Chow group of $k$-cycles on $X$}. We will see in
Lemma \ref{lemma-rational-equivalence}
that this agrees with the Chow group as defined in
Chow Homology, Definition \ref{chow-definition-rational-equivalence}.


\section{Rational equivalence and rational functions}
\label{section-alternative}

\noindent
Let $X$ be a nonsingular projective variety. Let $W \subset X$ be a subvariety
of dimension $k + 1$. Let $f \in \mathbf{C}(W)^*$ be a nonzero rational
function on $W$. For every subvariety $Z \subset W$ of dimension $k$
one can define the order of vanishing $\text{ord}_{W, Z}(f)$ of $f$ at
at $Z$. If $f$ is an element of the local ring $\mathcal{O}_{W, Z}$
of $W$ at $Z$, then one has
$$
\text{ord}_{W, Z}(f) = \text{length}_{\mathcal{O}_{X, z}} \mathcal{O}_{W, Z}
$$
where $\mathcal{O}_{X, Z}$, resp.\ $\mathcal{O}_{W, Z}$ is the
local ring of $X$, resp.\ $W$ at the generic point of $Z$. In general one
extends the definition by multiplicativity. The {\it principal divisor
associated to $f$} is
$$
\text{div}(f) = \text{div}_W(f) = \sum \text{ord}_{W, Z}(f)[Z]
$$
in $Z_k(X)$. See Chow Homology, Section \ref{chow-section-principal-divisors}.

\begin{lemma}
\label{lemma-rational-equivalence}
Let $X$ be a nonsingular projective variety. Let $W \subset X$ be a subvariety
of dimension $k + 1$. Let $f \in \mathbf{C}(W)^*$ be a nonzero rational
function on $W$. Then $\text{div}(f)$ is rationally equivalent to zero.
Conversely, these principal divisors generate the abelian group of
cycles rationally equivalent to zero.
\end{lemma}

\begin{proof}
The first assertion follows from
Chow Homology, Lemma \ref{chow-lemma-rational-function}.

\medskip\noindent
For the second, let $W \subset X \times \mathbf{P}^1$ be a closed
subvariety of dimension $k + 1$ which dominates $\mathbf{P}^1$.
We will show that $[W_0]_k - [W_\infty]_k$ is a principal divisor
which is what we have to prove. Let $W' \subset X$ be the image of
the projection to $X$. Then $W \to W'$ is proper and generically
finite\footnote{If $W \to W'$ is birational, then the result follows
from Chow Homology, Lemma \ref{chow-lemma-rational-function}.
Our task is to show that even if $W \to W'$
has degree $>1$ the basic rational equivalence
$[W_0]_k \sim_{rat} [W_\infty]_k$ comes from a principal divisor
on a subvariety of $X$.}. Let $f$ denote the projection $W \to \mathbf{P}^1$
viewed as an element of $\mathbf{C}(W)^*$. Let
$g = \text{Nm}(f) \in \mathbf{C}(W')^*$ be the norm. By
Chow Homology, Lemma \ref{chow-lemma-proper-pushforward-alteration} we have
$$
\text{div}_{W'}(g) = \text{pr}_{X, *}\text{div}_W(f)
$$
Since $\text{div}_W(f) = [W_0]_k - [W_\infty]_k$ the proof is complete.
\end{proof}


\section{Pushforward and rational equivalence}
\label{section-pushforward-and-rational-equivalence}

\noindent
Suppose that $f : X \to Y$ is a morphism of nonsingular projective varieties.
Let $\alpha \sim_{rat} 0$ be a $k$-cycle on
$X$ rationally equivalent to $0$. Then the {pushforward}
of $\alpha$ is rationally equivalent to zero:
$f_* \alpha \sim_{rat} 0$. See Chapter I of \cite{F} or
Chow Homology, Lemma \ref{chow-lemma-proper-pushforward-rational-equivalence}.

\medskip\noindent
Therefore we obtain a commutative diagram
$$
\xymatrix{
Z_k(X) \ar[r] \ar[d]_{f_*} & A_k(X) \ar[d]^{f_*} \\
Z_k(Y) \ar[r] & A_k(Y)
}
$$
of groups of $k$-cycles.


\section{Flat pullback and rational equivalence}
\label{section-flat-pullback-and-rational-equivalence}

\noindent
Suppose that $f : X \to Y$ is a flat morphism of relative dimension $r$
of nonsingular projective varieties.
Let $\alpha \sim_{rat} 0$ be a $k$-cycle on
$Y$ rationally equivalent to $0$. Then the pullback
of $\alpha$ is rationally equivalent to zero:
$f^* \alpha \sim_{rat} 0$. See Chapter I of \cite{F} or
Chow Homology, Lemma \ref{chow-lemma-flat-pullback-rational-equivalence}.

\medskip\noindent
Therefore we obtain a commutative diagram
$$
\xymatrix{
Z_{k + r}(X) \ar[r] & A_{k + r}(X) \\
Z_k(Y) \ar[r] \ar[u]^{f^*} & A_k(Y) \ar[u]_{f^*}
}
$$
of groups of $k$-cycles.


\section{Proper intersections}
\label{section-intersect-properly}

\noindent
First a few lemmas to get dimension estimates.

\begin{lemma}
\label{lemma-dimension-product-varieties}
Let $X$ and $Y$ be varieties. Then $X \times Y$ is a variety and
$\dim(X \times Y) = \dim(X) + \dim(Y)$.
\end{lemma}

\begin{proof}
The scheme $X \times Y = X \times_{\Spec(\mathbf{C})} Y$ is a variety by
Varieties, Lemma \ref{varieties-lemma-product-varieties}.
Choose closed points $x \in X$ and $y \in Y$.
Then $\dim(X) = \dim_x(X)$ and similarly for $Y$ and $X \times Y$
(see for example
Algebra, Lemma \ref{algebra-lemma-dimension-prime-polynomial-ring}).
The projection morphism $X \times Y \to Y$ is flat. Hence
$\dim_{(x, y)}(X \times Y) = \dim_x(X) + \dim_y(Y)$ by
Morphisms, Lemma \ref{morphisms-lemma-dimension-fibre-at-a-point-additive}.
\end{proof}

\medskip\noindent
Recall that a regular immersion $i : X \to Y$ is a closed immersion whose
corresponding sheaf of ideals is locally generated by a regular sequence, see
Divisors, Section \ref{divisors-section-regular-immersions}.
Moreover, the conormal sheaf $\mathcal{C}_{X/Y}$ is finite locally free of
rank equal to the length of the regular sequence. Let us say $i$ is a
{\it regular immersion of codimension $c$}
if $\mathcal{C}_{X/Y}$ is locally free of rank $c$.

\medskip\noindent
More generally, recall
(More on Morphisms, Section \ref{more-morphisms-section-lci})
that $f : X \to Y$ is a local complete intersection
morphism if we can cover $X$ by opens $U$ such that we can factor
$f|_U$ as
$$
\xymatrix{
U \ar[rr]_i \ar[rd] & & \mathbf{A}^n_Y \ar[ld] \\
& Y
}
$$
where $i$ is a Koszul regular immersion (if $Y$ is locally Noetherian
this is the same as asking $i$ to be a regular immersion, see
Divisors, Lemma \ref{divisors-lemma-regular-immersion-noetherian}).
Let us say that $f$ is a {\it local complete intersection morphism
of relative dimension $r$} if for any factorization as above, the
closed immersion $i$ has conormal sheaf of rank $n - r$ (in other
words if $i$ is a Koszul-regular immersion of codimension $n - r$
which in the Noetherian case just means it is regular immersion of
codimension $n - r$).

\begin{lemma}
\label{lemma-pullback-by-regular-immersion}
Let $f : X \to Y$ be a morphism of varieties.
\begin{enumerate}
\item If $Z \subset Y$ is a subvariety dimension $d$ and $f$ is a regular
immersion of codimension $c$, then every irreducible component
of $f^{-1}(Z)$ has dimension $\geq d - c$.
\item If $Z \subset Y$ is a subvariety of dimension $d$ and
$f$ is a local complete intersection morphism of relative dimension $r$,
then every irreducible component of $f^{-1}(Z)$ has dimension $\geq d + r$.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). We may work locally, hence we may assume that
$Y = \Spec(A)$ and $X = V(f_1, \ldots, f_c)$ where $f_1, \ldots, f_c$
is a regular sequence in $A$. If $Z = \Spec(A/\mathfrak p)$, then
we see that $f^{-1}(Z) = \Spec(A/\mathfrak p + (f_1, \ldots, f_c))$.
If $V$ is an irreducible component of $f^{-1}(Z)$, then we can
choose a closed point $v \in V$ not contained in any other irreducible
component of $f^{-1}(Z)$. Then
$$
\dim(Z) = \dim \mathcal{O}_{Z, v}
\quad\text{and}\quad
\dim(V) = \dim \mathcal{O}_{V, v} = \dim \mathcal{O}_{Z, v}/(f_1, \ldots, f_c)
$$
The first equality for example by
Algebra, Lemma \ref{algebra-lemma-dimension-prime-polynomial-ring}
and the second equality by our choice of closed point.
The result now follows from the fact that dividing by one element
in the maximal ideal decreases the dimension by at most $1$, see
Algebra, Lemma \ref{algebra-lemma-one-equation}.

\medskip\noindent
Proof of (2). Choose a factorization as in the definition of a
local complete intersection and apply (1). Some details omitted.
\end{proof}

\begin{lemma}
\label{lemma-diagonal-regular-immersion}
Let $X$ be a nonsingular projective variety. Then the diagonal
$\Delta : X \to X \times X$ is a regular immersion of codimension $\dim(X)$.
\end{lemma}

\begin{proof}
In fact, any closed immersion between nonsingular projective
varieties is a regular immersion, see Divisors,
Lemma \ref{divisors-lemma-immersion-smooth-into-smooth-regular-immersion}.
\end{proof}

\noindent
The following lemma demonstrates how reduction to the diagonal works.

\begin{lemma}
\label{lemma-intersect-in-smooth}
Let $X$ be a nonsingular projective variety and let $W,V \subset X$
be closed subvarieties with $\dim(W) = s$ and $\dim(V) = r$. Then every
irreducible component $Z$ of $V \cap W$ has dimension $\geq r + s - \dim(X)$.
\end{lemma}

\begin{proof}
Since $V \cap W = \Delta^{-1}(V \times W)$ (scheme theoretically)
we conclude by Lemmas \ref{lemma-diagonal-regular-immersion} and
\ref{lemma-pullback-by-regular-immersion}.
\end{proof}

\noindent
This lemma suggests the following definition.

\begin{definition}
\label{definition-proper-intersection}
Let $X$ be a nonsingular projective variety.
\begin{enumerate}
\item Let $W,V \subset X$ be closed subvarieties with
$\dim(W) = s$ and $\dim(V) = r$. We say that $W$ and $V$
{\it intersect properly} if $\dim(V \cap W) \leq r + s - \dim(X)$.
\item Let $\alpha = \sum n_i [W_i]$ be an $s$-cycle,
and $\beta = \sum_j m_j [V_j]$ be an $r$-cycle on $X$. We say
that $\alpha$ and $\beta$ {\it intersect properly} if
$W_i$ and $V_j$ intersect properly for all $i$ and $j$.
\end{enumerate}
\end{definition}


\section{Intersection multiplicities using Tor formula}
\label{section-tor-formula}

\noindent
A basic fact we will use frequently is that given sheaves of
modules $\mathcal{F}$, $\mathcal{G}$ on a ringed space $(X, \mathcal{O}_X)$
and a point $x \in X$ we have
$$
\text{Tor}_p^{\mathcal{O}_X}(\mathcal{F}, \mathcal{G})_x =
\text{Tor}_p^{\mathcal{O}_{X, x}}(\mathcal{F}_x, \mathcal{G}_x)
$$
as $\mathcal{O}_{X, x}$-modules. This can be seen in several ways
from our construction of derived tensor products in
Cohomology, Section \ref{cohomology-section-flat}, for example it follows from
Cohomology, Lemma \ref{cohomology-lemma-check-K-flat-stalks}.
Moreover, if $X$ is a scheme and $\mathcal{F}$ and $\mathcal{G}$
are quasi-coherent, then the modules
$\text{Tor}_p^{\mathcal{O}_X}(\mathcal{F}, \mathcal{G})$ are
quasi-coherent too, see
Derived Categories of Schemes, Lemma
\ref{perfect-lemma-quasi-coherence-tensor-product}.
More important for our purposes is the following result.

\begin{lemma}
\label{lemma-tensor-coherent}
Let $X$ be a locally Noetherian scheme.
\begin{enumerate}
\item If $\mathcal{F}$ and $\mathcal{G}$ are coherent $\mathcal{O}_X$-modules,
then $\text{Tor}_p^{\mathcal{O}_X}(\mathcal{F}, \mathcal{G})$ is too.
\item If $L$ and $K$ are in $D^-_{\textit{Coh}}(\mathcal{O}_X)$, then
so is $L \otimes_{\mathcal{O}_X}^\mathbf{L} K$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let us explain how to prove (1) in a more elementary way and part (2)
using previously developed general theory.

\medskip\noindent
Proof of (1). Since formation of $\text{Tor}$ commutes with localization
we may assume $X$ is affine. Hence $X = \Spec(A)$ for some Noetherian
ring $A$ and $\mathcal{F}$, $\mathcal{G}$ correspond to finite $A$-modules
$M$ and $N$ (Cohomology of Schemes, Lemma
\ref{coherent-lemma-coherent-Noetherian}).
By Derived Categories of Schemes, Lemma
\ref{perfect-lemma-quasi-coherence-tensor-product} we may
compute the $\text{Tor}$'s by first computing the $\text{Tor}$'s
of $M$ and $N$ over $A$, and then taking the associated $\mathcal{O}_X$-module.
Since the modules $\text{Tor}_p^A(M, N)$ are finite by
Algebra, Lemma \ref{algebra-lemma-tor-noetherian}
we conclude.

\medskip\noindent
By Derived Categories of Schemes, Lemma
\ref{perfect-lemma-identify-pseudo-coherent-noetherian}
the assumption is equivalent to asking $L$ and $K$ to be
(locally) pseudo-coherent. Then $L \otimes_{\mathcal{O}_X}^\mathbf{L} K$
is pseudo-coherent by
Cohomology, Lemma \ref{cohomology-lemma-tensor-pseudo-coherent}.
\end{proof}

\begin{lemma}
\label{lemma-compute-tor-nonsingular}
Let $X$ be a nonsingular projective variety.
Let $\mathcal{F}$, $\mathcal{G}$ be coherent $\mathcal{O}_X$-modules.
The $\mathcal{O}_X$-module
$\text{Tor}_p^{\mathcal{O}_X}(\mathcal{F}, \mathcal{G})$
is coherent, has stalk at $x$ equal to
$\text{Tor}_p^{\mathcal{O}_{X, x}}(\mathcal{F}_x, \mathcal{G}_x)$,
is supported on
$\text{Supp}(\mathcal{F}) \cap \text{Supp}(\mathcal{G})$, and
is nonzero only for $p \in \{0, \ldots, \dim(X)\}$.
\end{lemma}

\begin{proof}
The result on stalks was discussed above and it implies the support
condition. The $\text{Tor}$'s are coherent by
Lemma \ref{lemma-tensor-coherent}. The vanishing of negative
$\text{Tor}$'s is immediate from the construction. The
vanishing of $\text{Tor}_p$ for $p > \dim(X)$ can be seen as follows:
he local rings $\mathcal{O}_{X, x}$ are regular
(as $X$ is nonsingular) of dimension $\leq \dim(X)$
(Algebra, Lemma \ref{algebra-lemma-dimension-prime-polynomial-ring}),
hence $\mathcal{O}_{X, x}$ has finite global dimension $\leq \dim(X)$
(Algebra, Lemma \ref{algebra-lemma-finite-gl-dim-finite-dim-regular})
which implies that $\text{Tor}$-groups of modules vanish beyond the dimension
(More on Algebra, Lemma \ref{more-algebra-lemma-finite-gl-dim-tor-dimension}).
\end{proof}

\noindent
Let $X$ be a nonsingular projective variety and $W, V \subset X$
be closed subvarieties with $\dim(W) = s$ and $\dim(V) = r$.
Assume $V$ and $W$ intersect properly.
In this case Lemma \ref{lemma-intersect-in-smooth} tells us all irreducible
components of $V \cap W$ have dimension equal to $r + s - \dim(X)$.
The sheaves $Tor_j^{\mathcal{O}_X}(\mathcal{O}_W, \mathcal{O}_V)$ are
coherent, supported on $V \cap W$, and zero if $j < 0$ or $j > \dim(X)$
(Lemma \ref{lemma-compute-tor-nonsingular}).
We define the {\it intersection product} as
$$
W \cdot V = \sum\nolimits_i (-1)^i
[\text{Tor}_i^{\mathcal{O}_X}(\mathcal{O}_W, \mathcal{O}_V)]_{r + s - \dim(X)}.
$$
We stress that this makes sense only because of our assumption that
$V$ and $W$ intersect properly. This fact will necessitate a moving
lemma in order to define the intersection product in general.

\medskip\noindent
With this notation, the cycle $V \cdot W$ is a formal linear
combination $\sum e_i Z_i$ of the irreducible components $Z_i$
of the intersection $V \cap W$. The integers $e_i$ are called
the {\it intersection multiplicities}
$$
e_i = e(X, V \cdot W, Z_i) =
\sum\nolimits_i
(-1)^i
\text{length}_{\mathcal{O}_{X, Z_i}}
\text{Tor}_i^{\mathcal{O}_{X, Z_i}}(\mathcal{O}_{W, Z_i}, \mathcal{O}_{V, Z_i})
$$
where $\mathcal{O}_{X, Z_i}$, resp.\ $\mathcal{O}_{W, Z_i}$,
resp.\ $\mathcal{O}_{V, Z_i}$ denotes the local ring of $X$, resp.\ $W$,
resp.\ $V$ at the generic point of $Z_i$.
These alternating sums of lengths of $\text{Tor}$'s satisfy many good
properties, as we wll see later on.


\section{Algebraic multiplicities}
\label{section-multiplicities}

\noindent
Let $(A, \mathfrak m, \kappa)$ be a Noetherian local ring.
Let $M$ be a finite $A$-module and let $I \subset A$ be an ideal
of definition (Algebra, Definition \ref{algebra-definition-ideal-definition}).
Recall that the function
$$
\chi_{I, M}(n) = \text{length}_A(M/I^nM) =
\sum\nolimits_{p = 0, \ldots, n - 1} \text{length}_A(I^pM/I^{p + 1}M)
$$
is a numerical polynomial
(Algebra, Proposition \ref{algebra-proposition-hilbert-function-polynomial}).
The degree of this polynomial is equal to $\dim(\text{Supp}(M))$ by
Algebra, Lemma \ref{algebra-lemma-support-dimension-d}.

\begin{definition}
\label{definition-multiplicity}
In the situation above, if $d \geq \dim(\text{Supp}(M))$, then we set
$e_I(M, d)$ equal to $0$ if $d > \dim(M)$ and equal to $d!$ times the
leading coefficient of the numerical polynomial $\chi_{I, M}$ so that
$$
\chi_{I, M}(n) \sim e_I(M, d) \frac{n^d}{d!} + \text{lower order terms}
$$
The {\it multiplicity of $M$ for the ideal of definition $I$}
is $e_I(M) = e_I(M, \dim(\text{Supp}(M)))$.
\end{definition}

\noindent
We have the following properties of these multiplicities.

\begin{lemma}
\label{lemma-multiplicity-ses}
Let $A$ be a Noetherian local ring. Let $I \subset A$ be an ideal of
definition. Let $0 \to M' \to M \to M'' \to 0$ be a short exact sequence
of finite $A$-modules. Let $d \geq \dim(\text{Supp}(M))$. Then
$$
e_I(M, d) = e_I(M', d) + e_I(M'', d)
$$
\end{lemma}

\begin{proof}
Immediate from the definitions and
Algebra, Lemma \ref{algebra-lemma-hilbert-ses-chi}.
\end{proof}

\begin{lemma}
\label{lemma-multiplicity-as-a-sum}
Let $A$ be a Noetherian local ring. Let $I \subset A$ be an ideal of
definition. Let $M$ be a finite $A$-module. Let $d \geq \dim(\text{Supp}(M))$.
Then
$$
e_I(M, d) =
\sum \text{length}_{A_\mathfrak p}(M_\mathfrak p) e_I(A/\mathfrak p, d)
$$
where the sum is over primes $\mathfrak p \subset A$ with
$\dim(A/\mathfrak p) = 1$.
\end{lemma}

\begin{proof}
Both the left and side and the right hand side are additive in short
exact sequences of modules of dimension $\leq d$, see
Lemma \ref{lemma-multiplicity-ses} and
Algebra, Lemma \ref{algebra-lemma-length-additive}.
Hence by Algebra, Lemma \ref{algebra-lemma-filter-Noetherian-module}
it suffices to prove this when $M = A/\mathfrak q$ for some
prime $\mathfrak q$ of $A$ with $\dim(A/\mathfrak q) \leq d$.
This case is obvious.
\end{proof}

\begin{lemma}
\label{lemma-leading-coefficient}
Let $P$ be a polynomial of degree $r$ with leading coefficient $a$.
Then
$$
r! a = \sum\nolimits_{i = 0, \ldots, r} (-1)^i{r \choose i} P(t - i)
$$
for any $t$.
\end{lemma}

\begin{proof}
Let us write $\Delta$ the operator which to a polynomial $P$ associates
the polynomial $\Delta(P) = P(t) - P(t - 1)$. We claim that
$$
\Delta^r(P) = \sum\nolimits_{i = 0, \ldots, r} (-1)^i {r \choose i} P(t - i)
$$
This is true for $r = 0, 1$ by inspection. Assume it is true for $r$.
Then we compute
\begin{align*}
\Delta^{r + 1}(P)
& =
\sum\nolimits_{i = 0, \ldots, r} (-1)^i {r \choose i} \Delta(P)(t - i) \\
& =
\sum\nolimits_{n = -r, \ldots, 0} (-1)^i {r \choose i}
(P(t - i) - P(t - i - 1))
\end{align*}
Thus the claim follows from the equality
$$
{r + 1 \choose i} = {r \choose i} + {r \choose i - 1}
$$
The lemma follows from the fact that $\Delta(P)$ is of degree $r - 1$
with leading coefficient $ra$ if the degree of $P$ is $r$.
\end{proof}

\noindent
An important fact is that one can compute the multiplicity in terms
of the Koszul complex. Recall that if $R$ is a ring and
$f_1, \ldots, f_r \in R$, then $K_\bullet(f_1, \ldots, f_r)$
denotes the Koszul complex, see
More on Algebra, Section \ref{more-algebra-section-koszul}.

\begin{theorem}
\label{theorem-multiplicity-with-koszul}
\begin{reference}
\cite[Theorem 1 in part B of Chapter IV]{Serre_algebre_locale}
\end{reference}
Let $A$ be a Noetherian local ring. Let $I = (f_1, \ldots, f_r) \subset A$
be an ideal of definition. Let $M$ be a finite $A$-module. Let
$d \geq \dim(\text{Supp}(M))$. Then
$$
e_I(M, r) = \sum
(-1)^i\text{length}_A H_i(K_\bullet(f_1, \ldots, f_r) \otimes_A M)
$$
\end{theorem}

\begin{proof}
Let us change the Koszul complex $K_\bullet(f_1, \ldots, f_r)$ into a cochain
complex $K^\bullet$ by setting $K^n = K_{-n}(f_1, \ldots, f_r)$.
Then $K^\bullet$ is sitting in degrees $-r, \ldots, 0$ and
$H^i(K^\bullet \otimes_A M) = H_{-i}(K_\bullet(f_1, \ldots, f_r) \otimes_A M)$.
The statement of the theorem makes sense as the modules
$H^i(K^\bullet \otimes M)$ are annihilated by $f_1, \ldots, f_r$
(More on Algebra, Lemma \ref{more-algebra-lemma-homotopy-koszul})
hence have finite length.
Define a filtration on the complex $K^\bullet$ by setting
$$
F^p(K^n \otimes_A M) =
I^{\max(0, p + n)}(K^n \otimes_A M),\quad p \in \mathbf{Z}
$$
Since $f_i I^p \subset I^{p + 1}$ this is a filtration by subcomplexes.
Thus we have a filtered complex and we obtain a spectral sequence, see
Homology, Section \ref{homology-section-filtered-complex}.
We have
$$
E_0 = \bigoplus\nolimits_{p, q} E_0^{p, q} =
\bigoplus\nolimits_{p, q} \text{gr}^p(K^{p + q} \otimes_A M) =
\text{Gr}_I(K^\bullet \otimes_A M)
$$
Since $K^n$ is finite free we have
$$
\text{Gr}_I(K^\bullet \otimes_A M) =
\text{Gr}_I(K^\bullet) \otimes_{\text{Gr}_I(A)} \text{Gr}_I(M)
$$
Note that $\text{Gr}_I(K^\bullet)$ is the Koszul
complex over $\text{Gr}_I(A)$ on the elements
$\overline{f}_1, \ldots, \overline{f}_r \in I/I^2$.
A simple calculation (omitted)
shows that the differential $d_0$ on $E_0$
agrees with the differential coming from the Koszul complex.
Since $\text{Gr}_I(M)$ is a finite $\text{Gr}_I(A)$-module
and since $\text{Gr}_I(A)$ is Noetherian (as a quotient
of $A/I[x_1, \ldots, x_r]$ with $x_i \mapsto \overline{f}_i$), the
cohomology module $E_1 = \bigoplus E_1^{p, q}$
is a finite $\text{Gr}_I(A)$-module. However, as above
$E_1$ is annihilated by $\overline{f}_1, \ldots, \overline{f}_r$.
We conclude $E_1$ has finite length.
In particular we find that $\text{Gr}^p_F(K^\bullet \otimes M)$ is
acyclic for $p \gg 0$.

\medskip\noindent
Next, we check that the spectral sequence above converges
using Homology, Lemma \ref{homology-lemma-filtered-complex-ss-converges}.
The required equalities follow easily from the Artin-Rees lemma
in the form stated in Algebra, Lemma \ref{algebra-lemma-map-AR}.
Thus we see that
\begin{align*}
\sum (-1)^i\text{length}_A(H^i(K^\bullet \otimes_A M))
& =
\sum (-1)^{p + q} \text{length}_A(E_\infty^{p, q}) \\
& =
\sum (-1)^{p + q} \text{length}_A(E_1^{p, q})
\end{align*}
because as we've seen above the length of $E_1$ is finite
(of course this uses additivity of lengths). Pick $t$ so
large that $\text{Gr}^p_F(K^\bullet \otimes M)$
is acyclic for $p \geq t$ (see above). Using
additivity again we see that
$$
\sum (-1)^{p + q} \text{length}_A(E_1^{p, q}) =
\sum\nolimits_n \sum\nolimits_{p \leq t}
(-1)^n \text{length}_A(\text{gr}^p(K^n \otimes_A M))
$$
This is equal to
$$
\sum\nolimits_{n = -r, \ldots, 0} (-1)^n{r \choose |n|} \chi_{I, M}(t + n)
$$
by our choice of filtration above and the definition of $\chi_{I, M}$ in
Algebra, Section \ref{algebra-section-Noetherian-local}.
The lemma follows from Lemma \ref{lemma-leading-coefficient}
and the definition of $e_I(M, r)$.
\end{proof}

\begin{remark}[Trivial generalization]
\label{remark-trivial-generalization}
Let $(A, \mathfrak m, \kappa)$ be a Noetherian local ring.
Let $M$ be a finite $A$-module. Let $I \subset A$ be an ideal.
The following are equivalent
\begin{enumerate}
\item $I' = I + \text{Ann}(M)$ is an ideal of definition
(Algebra, Definition \ref{algebra-definition-ideal-definition}),
\item the image $\overline{I}$ of $I$ in $\overline{A} = A/\text{Ann}(M)$
is an ideal of definition,
\item $\text{Supp}(M/IM) \subset \{\mathfrak m\}$,
\item $\dim(\text{Supp}(M/IM)) \leq 0$, and
\item $\text{length}_A(M/IM) < \infty$.
\end{enumerate}
This follows from Algebra, Lemma \ref{algebra-lemma-support-point}
(details omitted). If this is the case we have $M/I^nM = M/(I')^nM$
for all $n$ and $M/I^nM = M/\overline{I}^nM$ for all $n$
if $M$ is viewed as an $\overline{A}$-module.
Thus we can define
$$
\chi_{I, M}(n) = \text{length}_A(M/I^nM) =
\sum\nolimits_{p = 0, \ldots, n - 1} \text{length}_A(I^pM/I^{p + 1}M)
$$
and we get
$$
\chi_{I, M}(n) = \chi_{I', M}(n) = \chi_{\overline{I}, M}(n)
$$
for all $n$ by the equalities above.
All the results of Algebra, Section \ref{algebra-section-Noetherian-local}
and all the results in this section, have analogues in this setting.
In particular we can define multiplicties $e_I(M, d)$ for
$d \geq \dim(\text{Supp}(M))$ and we have
$$
\chi_{I, M}(n) \sim e_I(M, d) \frac{n^d}{d!} + \text{lower order terms}
$$
as in the case where $I$ is an ideal of definition.
\end{remark}



\section{Computing intersection multiplicities}
\label{section-computing-intersection-multiplicities}

\noindent
In this section we discuss some cases where the intersection multiplicities
can be computed by different means. Here is a first example.

\begin{lemma}
\label{lemma-intersection-multiplicity-CM}
Let $X$ be a nonsingular projective variety and $W, V \subset X$ closed
subvarieties which intersect properly. Let $Z$ be an irreducible component
of $V \cap W$ with generic point $\xi$. Assume that $\mathcal{O}_{W, \xi}$
and $\mathcal{O}_{V, \xi}$ are Cohen-Macaulay. Then
$$
e(X, V \cdot W, Z) =
\text{length}_{\mathcal{O}_{X, \xi}}(\mathcal{O}_{V \cap W, \xi})
$$
where $V \cap W$ is the scheme theoretic intersection.
In particular, if both $V$ and $W$ are Cohen-Macaulay, then
$V \cdot W = [V \cap W]_{\dim(V) + \dim(W) - \dim(X)}$.
\end{lemma}

\begin{proof}
Set $A = \mathcal{O}_{X, \xi}$, $B = \mathcal{O}_{V, \xi}$, and
$C = \mathcal{O}_{W, \xi}$. By Auslander-Buchsbaum
(Algebra, Proposition \ref{algebra-proposition-Auslander-Buchsbaum})
we can find a finite free resolution $F_\bullet \to B$ of
length
$$
\text{depth}(A) - \text{depth}(B) =
\dim(A) - \dim(B) = \dim(C)
$$
First equality as $A$ and $B$ are Cohen-Macaulay and the second
as $V$ and $W$ intersect properly. Then $F_\bullet \otimes_A C$ is a
complex of finite free modules representing $B \otimes_A^\mathbf{L} C$
hence has cohomology modules with support in $\{\mathfrak m_A\}$.
By the Acyclicity lemma (Algebra, Lemma \ref{algebra-lemma-acyclic})
which applies as $C$ is Cohen-Macaulay
we conclude that $F_\bullet \otimes_A C$ has nonzero
cohomology only in degree $0$. This finishes the proof.
\end{proof}

\begin{lemma}
\label{lemma-one-ideal-ci}
Let $A$ be a Noetherian local ring. Let $I = (f_1, \dots, f_r)$ be an ideal
generated by a regular sequence. Let $M$ be a finite $A$-module. Assume that
$\dim(\text{Supp}(M/IM)) = 0$. Then
$$
e_I(M, r) = \sum (-1)^i\text{length}_A(\text{Tor}_i^A(A/I, M))
$$
Here $e_I(M, r)$ is as in Remark \ref{remark-trivial-generalization}.
\end{lemma}

\begin{proof}
Since $f_1, \ldots, f_r$ is a regular sequence the Koszul complex
$K_\bullet(f_1, \ldots, f_r)$ is a resolution of $A/I$ over $A$, see
More on Algebra, Lemma
\ref{more-algebra-lemma-noetherian-finite-all-equivalent}.
Thus the right hand side is equal to
$$
\sum (-1)^i\text{length}_A H_i(K_\bullet(f_1, \ldots, f_r) \otimes_A M)
$$
Now the result follows immediately from
Theorem \ref{theorem-multiplicity-with-koszul} if $I$ is an ideal
of definition. In general, we replace $A$ by $\overline{A} = A/\text{Ann}(M)$
and $f_1, \ldots, f_r$ by $\overline{f}_1, \ldots, \overline{f}_r$
which is allowed because
$$
K_\bullet(f_1, \ldots, f_r) \otimes_A M =
K_\bullet(\overline{f}_1, \ldots, \overline{f}_r) \otimes_{\overline{A}} M
$$
Since $e_I(M, r) = e_{\overline{I}}(M, r)$ where
$\overline{I} = (\overline{f}_1, \ldots, \overline{f}_r) \subset \overline{A}$
is an ideal of definition the result follows from
Theorem \ref{theorem-multiplicity-with-koszul} in this case as well.
\end{proof}

\begin{lemma}
\label{lemma-multiplicity-with-lci}
Let $X$ be a nonsingular projective variety. Let $W,V \subset X$ be
closed subvarieties which intersect properly. Let $Z$ be an irreducible
component of $V \cap W$ with generic point $\xi$.
Suppose the ideal of $V$ in $\mathcal{O}_{X, \xi}$ is cut out by
a regular sequence $f_1, \ldots, f_c \in \mathcal{O}_{X, \xi}$.
Then $e(X, V\cdot W, Z)$ is equal to $c!$ times the leading coefficient in
the Hilbert polynomial
$$
t \mapsto \text{length}_{\mathcal{O}_{X, \xi}}
\mathcal{O}_{W, \xi}/(f_1, \ldots, f_c)^t,\quad t \gg 0.
$$
In particular, this coefficient is $> 0$.
\end{lemma}

\begin{proof}
The equality
$$
e(X, V\cdot W, Z) = e_{(f_1, \dots, f_c)}(\mathcal{O}_{W, \xi}, c)
$$
follows from the more general Lemma \ref{lemma-one-ideal-ci}.
To see that $e_{(f_1, \dots, f_c)}(\mathcal{O}_{W, \xi}, c)$ is
$> 0$ or equivalently that $e_{(f_1, \dots, f_c)}(\mathcal{O}_{W, \xi}, c)$
is the leading coefficient of the Hilbert polynomial
it suffices to show that the
dimension of $\mathcal{O}_{W, \xi}$ is $c$, because the degree of the
Hilbert polynomial is equal to the dimension by
Algebra, Proposition \ref{algebra-proposition-dimension}.
Say $\dim(V) = r$, $\dim(W) = s$, and $\dim(X) = n$. Then
$\dim(Z) = r + s - n$ as the intersection is proper. Thus
the transcendence degree of $\kappa(\xi)$ over $\mathbf{C}$ is
$r + s - n$, see Algebra, Lemma
\ref{algebra-lemma-dimension-prime-polynomial-ring}.
We have $r + c = n$ because $V$ is cut out by a regular sequence
in a neighbourhood of $\xi$, see
Divisors, Lemma \ref{divisors-lemma-Noetherian-scheme-regular-ideal}
and then Lemma \ref{lemma-pullback-by-regular-immersion}
applies (for example). Thus
$$
\dim(\mathcal{O}_{W, \xi}) = s - (r + s - n) = s - ((n - c) + s - n) = c
$$
the first equality by Algebra, Lemma
\ref{algebra-lemma-dimension-at-a-point-finite-type-field}.
\end{proof}

\begin{lemma}
\label{lemma-multiplicity-with-effective-Cartier-divisor}
In Lemma \ref{lemma-multiplicity-with-lci} assume that  $c = 1$, i.e., $V$
is an effective Cartier divisor. Then
$$
e(X, V \cdot W, Z) =
\text{length}_{\mathcal{O}_{X, \xi}}
(\mathcal{O}_{W, \xi}/f_1\mathcal{O}_{W, \xi}).
$$
\end{lemma}

\begin{proof}
In this case the image of $f_1$ in $\mathcal{O}_{W, \xi}$ is nonzero by
properness of intersection, hence a nonzerodivisor divisor. Moreover,
$\mathcal{O}_{W, \xi}$ is a Noetherian local domain of dimension $1$.
Thus
$$
\text{length}_{\mathcal{O}_{X, \xi}}
(\mathcal{O}_{W, \xi}/f_1^t\mathcal{O}_{W, \xi}) =
t \text{length}_{\mathcal{O}_{X, \xi}}
(\mathcal{O}_{W, \xi}/f_1\mathcal{O}_{W, \xi})
$$
for all $t \geq 1$, see Algebra, Lemma \ref{algebra-lemma-ord-additive}.
This proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-multiplicity-lci-CM}
In Lemma \ref{lemma-multiplicity-with-lci} assume that
the local ring $\mathcal{O}_{W, \xi}$ is Cohen-Macaulay. Then we
have
$$
e(X, V \cdot W, Z) =
\text{length}_{\mathcal{O}_{X, \xi}} (\mathcal{O}_{W, \xi}/
f_1\mathcal{O}_{W, \xi} + \ldots + f_c\mathcal{O}_{W, \xi}).
$$
\end{lemma}

\begin{proof}
This follows immediately from Lemma \ref{lemma-intersection-multiplicity-CM}.
Alternatively, we can deduce it from Lemma \ref{lemma-multiplicity-with-lci}.
Namely, by Algebra, Lemma \ref{algebra-lemma-reformulate-CM}
we see that $f_1, \ldots, f_c$ is a regular sequence in
$\mathcal{O}_{W, \xi}$. Then
Algebra, Lemma \ref{algebra-lemma-regular-quasi-regular} shows that
$f_1, \ldots, f_c$ is a quasi-regular sequence.
This easily implies the length of
$\mathcal{O}_{W, \xi}/(f_1, \ldots, f_c)^t$ is
$$
{c + t \choose c}
\text{length}_{\mathcal{O}_{X, \xi}} (\mathcal{O}_{W, \xi}/
f_1\mathcal{O}_{W, \xi} + \ldots + f_c\mathcal{O}_{W, \xi}).
$$
Looking at the leading coefficient we conclude.
\end{proof}


\section{Intersection product using Tor formula}
\label{section-intersection-product}

\noindent
Let $X$ be a nonsingular projective variety. Let
$\alpha = \sum n_i [W_i]$ be an $r$-cycle and
$\beta = \sum_j m_j [V_j]$ be an $s$-cycle on $X$.
Assume that $\alpha$ and $\beta$ intersect properly, see
Definition \ref{definition-proper-intersection}.
In this case we define
$$
\alpha \cdot \beta = \sum\nolimits_{i,j} n_i m_j W_i \cdot V_j.
$$
where $W_i \cdot V_j$ is as defined in Section \ref{section-tor-formula}.

\begin{lemma}
\label{lemma-rational-equivalence-and-intersection}
Let $X$ be a nonsingular projective variety. Any $k$-cycle which is
rationally equivalent to $0$ is of the form
$$
pr_{X,*}( \alpha \cdot X \times a - \alpha \cdot X \times b).
$$
where $\alpha$ is a $(k + 1)$-cycle on $X \times \mathbf{P}^1$
which intersects $X \times a$ and $X \times b$ properly.
\end{lemma}

\begin{proof}
Immediate from the definitions and the calculation of intersection
multiplicity in case of a Cartier divisor given in
Lemma \ref{lemma-multiplicity-with-effective-Cartier-divisor}.
\end{proof}


\section{Exterior product}
\label{section-exterior-product}

\noindent
Let $X$ and $Y$ be nonsingular projective vareities.
Let $V$, resp.\ $W$ be a closed subvariety of $X$, resp.\ $Y$.
The product $V\times W$ is a closed subvariety of $X\times Y$
(Lemma \ref{lemma-dimension-product-varieties}).
For a $k$-cycle $\alpha = \sum n_i [V_i]$ and a $l$-cycle
$\beta = \sum m_j [V_j]$ on $Y$ we define the
{\it exterior product} of $\alpha$ and $\beta$ to be the cycle
$\alpha \times \beta = \sum n_i m_j [V_i \times W_j]$.
Exterior product defines a $\mathbf{Z}$-linear map
$$
Z_r(X) \otimes_\mathbf{Z} Z_s(Y) \longrightarrow Z_{r + s}(X \times Y)
$$
We will show below that exterior product factors through rational
equivalence.

\begin{lemma}
\label{lemma-exterior-product}
Let $X$ and $Y$ be nonsingular projective vareities.
Let $\alpha \in Z_r(X)$ and $\beta \in Z_s(Y)$.
Then
\begin{enumerate}
\item $\text{pr}_Y^*(\beta) = [X] \times \beta$ and
$\text{pr}_X^*(\alpha) = \alpha \times [Y]$,
\item $\alpha \times [Y]$ and $[X]\times \beta$
intersect properly on $X\times Y$, and
\item we have
$\alpha \times \beta =
(\alpha \times [Y])\cdot ([X]\times\beta) =
pr_Y^*(\alpha) \cdot pr_X^*(\beta)$
in $Z_{r + s}(X \times Y)$.
\end{enumerate}
\end{lemma}

\begin{proof}
By linearity we may assume $\alpha = [V]$ and $\beta = [W]$.
Then (1) says that $\text{pr}_Y^{-1}(W) = X \times W$ and
$\text{pr}_X^{-1}(V) = V \times Y$. This is clear.
Part (2) holds because $X \times W \cap V \times Y = V \times W$ and
$\dim(V \times W) = r + s$ by Lemma \ref{lemma-dimension-product-varieties}.

\medskip\noindent
Proof of (3).
Let $\xi$ be the generic point of $V \times W$.
Since the projections $X \times W \to W$ is smooth as a base change of
$X \to \Spec(\mathbf{C})$, we see that $X \times W$ is nonsingular
at every point lying over the generic point of $W$, in particular at $\xi$.
Similarly for $V \times Y$. Hence $\mathcal{O}_{X \times W, \xi}$
and $\mathcal{O}_{V \times Y, \xi}$ are Cohen-Macaulay local rings
and Lemma \ref{lemma-intersection-multiplicity-CM} applies.
Since $V \times Y \cap X \times W = V \times W$ scheme theoretically
the proof s complete.
\end{proof}

\begin{lemma}
\label{lemma-exterior-product-rational-equivalence}
Let $X$ and $Y$ be nonsingular projective vareities.
Let $\alpha \in Z_r(X)$ and $\beta \in Z_s(Y)$.
If $\alpha \sim_{rat} 0$ or $\beta \sim_{rat} 0$, then
$\alpha \times \beta \sim_{rat} 0$.
\end{lemma}

\begin{proof}
By linearity and symmetry in $X$ and $Y$, it suffices to prove this when
$\alpha = [V]$ for some subvariety $V \subset X$ of dimension $s$ and
$\beta = [W_a]_s - [W_b]_s$ for some closed subvariety
$W \subset Y \times \mathbf{P}^1$ of dimension $s + 1$ which
intersects $Y \times a$ and $Y \times b$ properly. In this case
the lemma follows if we can prove
$$
[(V \times W)_a]_{r + s} = [V] \times [W_a]_s
$$
and similarly with $a$ replaced by $b$. Namely, then we see that
$\alpha \times \beta = [(V \times W)_a]_{r + s} - [(V \times W)_b]_{r + s}$
as desired. To see the displayed equality we note the equality
$$
V \times W_a = (V \times W)_a
$$
of schemes. The projection $V \times W_a \to W_a$ induces a bijection
of irreducible components (see for example
Varieties, Lemma \ref{varieties-lemma-bijection-irreducible-components}).
Let $W' \subset W_a$ be an irreducible component with generic point $\zeta$.
Then $V \times W'$ is the corresponding irreducible compenent of
$V \times W_a$ (see Lemma \ref{lemma-dimension-product-varieties}).
Let $\xi$ be the generic point of $V \times W'$. We have to show that
$$
\text{length}_{\mathcal{O}_{Y, \zeta}}(\mathcal{O}_{W_a, \zeta}) =
\text{length}_{\mathcal{O}_{X \times Y, \xi}}(
\mathcal{O}_{V \times W_a, \xi})
$$
In this formula we may replace
$\mathcal{O}_{Y, \zeta}$ by $\mathcal{O}_{W_a, \zeta}$ and
we may replace
$\mathcal{O}_{X \times Y, \zeta}$ by $\mathcal{O}_{V \times W_a, \zeta}$
(see Algebra, Lemma \ref{algebra-lemma-length-independent}).
As $\mathcal{O}_{W_a, \zeta} \to \mathcal{O}_{V \times W_a, \xi}$ is flat,
by Algebra, Lemma \ref{algebra-lemma-pullback-module} it suffices
to show that
$$
\text{length}_{\mathcal{O}_{V \times W_a, \xi}}(
\mathcal{O}_{V \times W_a, \xi}/
\mathfrak m_\zeta\mathcal{O}_{V \times W_a, \xi}) = 1
$$
This is true because the quotient on the right is the local ring
$\mathcal{O}_{V \times W', \xi}$ of a variety at a generic point
hence equal to $\kappa(\xi)$.
\end{proof}

\noindent
We conclude that exterior product defines a commutative diagram
$$
\xymatrix{
Z_r(X) \otimes_\mathbf{Z} Z_s(Y) \ar[r] \ar[d] &
Z_{r + s}(X \times Y) \ar[d] \\
A_r(X) \otimes_\mathbf{Z} A_s(Y) \ar[r] &
A_{r + s}(X \times Y)
}
$$



\section{Reduction to the diagonal}
\label{section-reduction-diagonal}

\noindent
Let $X$ be a nonsingular projective variety. We will use $\Delta$
to denote either the diagonal morphism $\Delta : X \to X \times X$
or the image $\Delta \subset X \times X$.
Reduction to the diagonal is the statement that
intersection products on $X$ can be reduced to intersection products
of exterior products with the diagonal on $X \times X$.

\begin{lemma}
\label{lemma-tor-and-diagonal}
Let $X$ be a nonsingular projective variety.
\begin{enumerate}
\item If $\mathcal{F}$ and $\mathcal{G}$ are coherent $\mathcal{O}_X$-modules,
then there are canonical isomorphisms
$$
\text{Tor}_i^{\mathcal{O}_{X \times X}}(\mathcal{O}_\Delta,
\text{pr}_1^*\mathcal{F} \otimes_{\mathcal{O}_{X \times X}}
\text{pr}_2^*\mathcal{G})
=
\Delta_*\text{Tor}_i^{\mathcal{O}_X}(\mathcal{F}, \mathcal{G})
$$
\item If $K$ and $M$ are in $D_\QCoh(\mathcal{O}_X)$, then
there is a canonical isomorphism
$$
L\Delta^* \left(
L\text{pr}_1^*K \otimes_{\mathcal{O}_{X \times X}}^\mathbf{L} L\text{pr}_2^*M
\right)
= K \otimes_{\mathcal{O}_X}^\mathbf{L} M
$$
in $D_\QCoh(\mathcal{O}_X)$ and a canonical isomorphism
$$
\mathcal{O}_\Delta \otimes_{\mathcal{O}_{X \times X}}^\mathbf{L}
L\text{pr}_1^*K \otimes_{\mathcal{O}_{X \times X}}^\mathbf{L} L\text{pr}_2^*M
= \Delta_*(K \otimes_{\mathcal{O}_X}^\mathbf{L} M)
$$
in $D_\QCoh(X \times X)$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let us explain how to prove (1) in a more elementary way and part (2) using
more general theory. As (2) implies (1) the reader can skip the proof
of (1).

\medskip\noindent
Proof of (1). Choose an affine open $\Spec(A) \subset X$.
Then $A$ is a Noetherian $\mathbf{C}$-algebra and
$\mathcal{F}$, $\mathcal{G}$ correspond to finite $A$-modules
$M$ and $N$ (Cohomology of Schemes, Lemma
\ref{coherent-lemma-coherent-Noetherian}).
By Derived Categories of Schemes, Lemma
\ref{perfect-lemma-quasi-coherence-tensor-product} we may
compute $\text{Tor}_i$ over $\mathcal{O}_X$
by first computing the $\text{Tor}$'s
of $M$ and $N$ over $A$, and then taking the associated $\mathcal{O}_X$-module.
For the $\text{Tor}_i$ over $\mathcal{O}_{X \times X}$ we compute
the tor of $A$ and $M \otimes_\mathbf{C} N$ over $A \otimes_\mathbf{C} A$
and then take the associated $\mathcal{O}_{X \times X}$-module.
Hence on this afffine patch we have to prove that
$$
\text{Tor}_i^{A \otimes_\mathbf{C} A}(A, M \otimes_\mathbf{C} N) =
\text{Tor}_i^A(M, N)
$$
To see this choose resolutions $F_\bullet \to M$ and $G_\bullet \to M$
by finite free $A$-modules
(Algebra, Lemma \ref{algebra-lemma-resolution-by-finite-free}).
Note that $\text{Tot}(F_\bullet \otimes_\mathbf{C} G_\bullet)$
is a resolution of $M \otimes_\mathbf{C} N$ as it computes
Tor groups over $\mathbf{C}$! Of course the terms of
$F_\bullet \otimes_\mathbf{C} G_\bullet$ are finite free
$A \otimes_\mathbf{C} A$-modules. Hence the left hand side
of the displayed equation is the module
$$
H_i(A \otimes_{A \otimes_\mathbf{C} A}
\text{Tot}(F_\bullet \otimes_\mathbf{C} G_\bullet))
$$
and the right hand side is the module
$$
H_i(\text{Tot}(F_\bullet \otimes_A G_\bullet))
$$
Since $A \otimes_{A \otimes_\mathbf{C} A} (F_p \otimes_\mathbf{C} G_q)
= F_p \otimes_A G_q$ we see that these modules are equal.
This defines an isomorphism over the affine open $\Spec(A) \times \Spec(A)$
(which is good enough for the application to equality of intersection numbers).
We omit the proof that these isomorphisms glue.

\medskip\noindent
Proof of (2). The second statement follows from the first by the
projection formula as stated in
Derived Categories of Schemes, Lemma \ref{perfect-lemma-cohomology-base-change}.
To see the first, represent $K$ and $M$ by K-flat complexes
$\mathcal{K}^\bullet$ and $\mathcal{M}^\bullet$.
Since pullback and tensor product preserve K-flat complexes
(Cohomology, Lemmas \ref{cohomology-lemma-tensor-product-K-flat} and
\ref{cohomology-lemma-pullback-K-flat})
we see that it suffices to show
$$
\Delta^*\text{Tot}(
\text{pr}_1^*\mathcal{K}^\bullet
\otimes_{\mathcal{O}_{X \times X}} \text{pr}_2^*\mathcal{M}^\bullet)
=
\text{Tot}(
\mathcal{K}^\bullet \otimes_{\mathcal{O}_X} \mathcal{M}^\bullet)
$$
Thus it suffices to see that there are canonical isomorphisms
$$
\Delta^*(\text{pr}_1^*\mathcal{K}
\otimes_{\mathcal{O}_{X \times X}} \text{pr}_2^*\mathcal{M})
\longrightarrow
\mathcal{K} \otimes_{\mathcal{O}_X} \mathcal{M}
$$
whenever $\mathcal{K}$ and $\mathcal{M}$ are $\mathcal{O}_X$-modules
(not necessarily quasi-coherent or flat).
We omit the details.
\end{proof}

\begin{lemma}
\label{lemma-reduction-diagonal}
Let $X$ be a nonsingular projective variety. Let $\alpha$, resp.\ $\beta$
be an $r$-cycle, resp.\ $s$-cycle on $X$. Assume $\alpha$ and $\beta$
intersect properly. Then
\begin{enumerate}
\item $\alpha \times \beta$ and $[\Delta]$ intersect properly
\item we have $\Delta_*(\alpha \cdot \beta) = [\Delta] \cdot \alpha\times\beta$
as cycles on $X \times X$,
\item $\text{pr}_{1, *}([\Delta] \cdot \alpha\times\beta) = \alpha\cdot\beta$,
where $pr_1 : X\times X \to X$ is the projection.
\end{enumerate}
\end{lemma}

\begin{proof}
By linearity it suffices to prove this when $\alpha = [V]$ and $\beta = [W]$
for some closed subvarieties $V \subset X$ and $W \subset Y$ which intersect
properly. Recall that $V \times W$ is a closed subvariety of dimension $r + s$.
Observe that scheme theoretically we have
$V \cap W = \Delta^{-1}(V \times W)$ as well as
$\Delta(V \cap W) = \Delta \cap V \times W$.
This proves (1). Part (2) implies (3) because
$\text{pr}_{1, *} \circ \Delta_* = \text{id}$ by
Lemma \ref{lemma-compose-pushforward}.

\medskip\noindent
Proof of (2). Let $Z \subset V \cap W$ be an irreducible component
with generic point $\xi$. We have to show that the coefficient of
$Z$ in $\alpha \cdot \beta$ is the same as the coefficient of
$\Delta(Z)$ in $[\Delta] \cdot \alpha \times \beta$. The first is given
by the integer
$$
\sum (-1)^i
\text{length}_{\mathcal{O}_{X, \xi}}
\text{Tor}_i^{\mathcal{O}_X}(\mathcal{O}_V, \mathcal{O}_W)_\xi
$$
and the second by the integer
$$
\sum (-1)^i
\text{length}_{\mathcal{O}_{X \times Y, \Delta(\xi)}}
\text{Tor}_i^{\mathcal{O}_{X \times Y}}(
\mathcal{O}_\Delta, \mathcal{O}_{V \times W})_{\Delta(\xi)}
$$
However, by Lemma \ref{lemma-tor-and-diagonal} we have
$$
\text{Tor}_i^{\mathcal{O}_X}(\mathcal{O}_V, \mathcal{O}_W)_\xi \cong
\text{Tor}_i^{\mathcal{O}_{X \times Y}}(
\mathcal{O}_\Delta, \mathcal{O}_{V \times W})_{\Delta(\xi)}
$$
as $\mathcal{O}_{X \times X, \Delta(\xi)}$-modules. Thus equality
of lengths (by Algebra, Lemma \ref{algebra-lemma-length-independent}
to be precise).
\end{proof}

\begin{proposition}
\label{proposition-positivity}
\begin{reference}
This is one of the main results of \cite{Serre_algebre_locale}.
\end{reference}
Let $X$ be a nonsingular projective variety. Let $V \subset X$ and
$W \subset Y$ be closed subvarieties which intersect properly.
Let $Z \subset V \cap W$ be an irreducible component.
Then $e(X, V \cdot W, Z) > 0$.
\end{proposition}

\begin{proof}
By Lemma \ref{lemma-reduction-diagonal} we have
$$
e(X, V \cdot W, Z) = e(X \times X, \Delta \cdot V \times W, \Delta(Z))
$$
Since $\Delta : X \to X \times X$ is a regular immersion
(see Lemma \ref{lemma-diagonal-regular-immersion}), we see that
$e(X \times X, \Delta \cdot V \times W, \Delta(Z))$ is a positive
integer by Lemma \ref{lemma-multiplicity-with-lci}.
\end{proof}

\begin{lemma}
\label{lemma-tor-sheaf}
\begin{reference}
\cite[Chapter V]{Serre_algebre_locale}
\end{reference}
Let $X$ be a nonsingular projective variety. Let $\mathcal{F}$ and
$\mathcal{G}$ be coherent sheaves on $X$ with
$\dim(\text{Supp}(\mathcal{F})) \leq r$,
$\dim(\text{Supp}(\mathcal{G})) \leq s$, and
$\dim(\text{Supp}(\mathcal{F}) \cap \text{Supp}(\mathcal{G}) )
\leq r + s - \dim X$. In this case $[\mathcal{F}]_r$ and $[\mathcal{G}]_s$
intersect properly and
$$
[\mathcal{F}]_r \cdot [\mathcal{G}]_s = \sum (-1)^i
[\text{Tor}_i^{\mathcal{O}_X}(\mathcal{F}, \mathcal{G})]_{r + s - \dim(X)}.
$$
\end{lemma}

\begin{proof}
The statement that $[\mathcal{F}]_r$ and $[\mathcal{G}]_s$ intersect properly
is immediate. Let $Z$ be an irreducible component of
$\text{Supp}(\mathcal{F}) \cap \text{Supp}(\mathcal{G})$ of dimension
$r + s - \dim(X)$. Let $\xi \in Z$ be the generic point.
Write $A = \mathcal{O}_{X, \xi}$ and
$B = \mathcal{O}_{X \times X, \Delta(\xi)}$. We have a commutative diagram
$$
\xymatrix{
A \ar[rd]_{p_1} \ar[rrd] \\
& B \ar[r] & A \\
A \ar[ru]^{p_2} \ar[rru]
}
$$
where the outer maps are identity, the map $B \to A$ corresponds to the
diagonal morphism and the two maps $A \to B$ to the projection morphisms.
In fact, $B = \Sigma^{-1}(A \otimes_\mathbf{C} A)$ for some multiplicative
subset $\Sigma \subset A \otimes_\mathbf{C} A$. Namely, $B$ is the
localization of $A \otimes_\mathbf{C} A$ at the maximal ideal corresponding
to $A \otimes_\mathbf{C} A \to A \to \kappa(\xi)$.
Let $M = \mathcal{F}_\xi$ and $N = \mathcal{G}_\xi$.
These are finite $A$-modules. Then
$$
\left(\text{pr}_1^*\mathcal{F}
\otimes_{\mathcal{O}_{X \times X}} \mathcal{G}\right)_{\Delta(\xi)} =
M \otimes_{A, p_1} B \otimes_{p_2, A} N =
\Sigma^{-1}(M \otimes_\mathbf{C} N)
$$
Hence by Lemma \ref{lemma-tor-and-diagonal}
the coefficient of $Z$ in the right hand side is equal to
$$
\sum (-1)^i
\text{length}_B \text{Tor}_i^B(A, \Sigma^{-1}(M \otimes_\mathbf{C} N))
$$
We may write
$$
A = B/(f_1, \ldots, f_n)
$$
where $n = \dim(X)$ and $f_1, \ldots, f_n \in B$ is a regular sequence, see
Lemma \ref{lemma-diagonal-regular-immersion}. Since $Z$ is an irreducible
component of $\text{Supp}(\mathcal{F}) \cap \text{Supp}(\mathcal{G})$
we see that
$$
\dim\left(
\text{Supp}\left(
\Sigma^{-1}(M \otimes_\mathbf{C} N)/
(f_1, \ldots, f_r)\Sigma^{-1}(M \otimes_\mathbf{C} N)
\right)\right)
= 0.
$$
Choose filtrations
$$
0 = M_0 \subset M_1 \subset \ldots \subset M_m = M,
\quad\text{resp.}\quad
0 = N_0 \subset N_1 \subset \ldots \subset N_{m'} = N
$$
such that each quotient $M_j/M_{j - 1}$, resp.\ $N_j/N_{j - 1}$
is isomorphic to $A/\mathfrak p_j$, resp.\ $A/\mathfrak q_j$
for some prime ideal $\mathfrak p_j$, resp.\ $\mathfrak q_j$, see
Algebra, Lemma \ref{algebra-lemma-filter-Noetherian-module}.
Each $\mathfrak p_j$, resp.\ $\mathfrak q_j$ corresponds to a
closed subvariety $V_j \subset X$, resp.\ $W_j \subset Y$
containing $Z$. Moreover, the number of times a given
$Z \subset V \subset X$, resp.\ $Z \subset W \subset Y$
of dimension $r$, resp.\ $s$ occurs is the coefficient of
$[V]$, resp.\ $[W]$ in $[\mathcal{F}]_r$, resp.\ $[\mathcal{G}]_s$, see
Algebra, Lemma \ref{algebra-lemma-filter-minimal-primes-in-support}.
The functor
$$
\text{Mod}_A \times \text{Mod}_A \longrightarrow \text{Mod}_B,\quad
(M, N) \longmapsto F(M, N) = \Sigma^{-1}(M \otimes_\mathbf{C} N)
$$
is exact in each variable.
For any subquotients $M'$ of $M$ and $N'$ of $N$ the module
$F(M', N')$ is a subquotient of $F(M, N)$, hence
$$
\dim(\text{Supp}(F(M', N')/(f_1, \ldots, f_r)F(M', N'))) = 0.
$$
Using the long exact sequences of $\text{Tor}$'s and additivity of lengths
we see that the coefficient of $Z$ in the right hand side is
$$
\sum\nolimits_{i, j, j'}
(-1)^i
\text{length}_B \text{Tor}_i^B(A, F(A/\mathfrak p_j, A/\mathfrak q_{j'}))
$$
By our remarks above we see that it suffices to show: If $M = A/\mathfrak p$
and $N = A/\mathfrak q$ where $\mathfrak p$ corresponds to the closed
subvariety $Z \subset V \subset \text{Supp}(\mathcal{F})$ and $\mathfrak q$
to the closed subvariety $Z \subset W \subset \text{Supp}(\mathcal{G})$, then
$$
\sum (-1)^i
\text{length}_B
\text{Tor}_i^B(A,
\Sigma^{-1}(A/\mathfrak p \otimes_\mathbf{C} A/\mathfrak q))
=
\left\{
\begin{matrix}
0 & \text{if } \dim(V) < r \\
0 & \text{if } \dim(W) < s \\
e(X, V \cdot W, Z) & \text{else}
\end{matrix}
\right.
$$
Note that
$\Sigma^{-1}(A/\mathfrak p \otimes_\mathbf{C} A/\mathfrak q) =
\mathcal{O}_{V \times W, \Delta(\xi)}$.
If $\dim(V) < r$ or $\dim(W) < s$ then $\dim(V \times W) < r + s$
which implies $\dim(\mathcal{O}_{V \times W, \Delta(\xi)}) < n$.
Hence vanishing by Lemma \ref{lemma-one-ideal-ci} because
the Hilbert function of $\mathcal{O}_{V \times W, \Delta(\xi)}$
has degree $< n$. If $\dim(V) = r$ and $\dim(W) = s$
then the alternating sum of lengths tors is the coefficient of
$[\Delta(Z)]$ in $[\Delta] \cdot [V \times W]$ which is
equal to $e(X, V \cdot W, Z)$ by Lemma \ref{lemma-reduction-diagonal}.
\end{proof}

\begin{remark}
\label{remark-Serre-conjectures}
Let $(A, \mathfrak m, \kappa)$ be a regular local ring.
Let $M$ and $N$ be nonzero finite $A$-modules such that $M \otimes_A N$
is supported in $\{\mathfrak m\}$. Then
$$
\chi(M, N) = \sum (-1)^i \text{length}_A \text{Tor}_i^A(M, N)
$$
is finite. Let $r = \dim(\text{Supp}(M))$ and $s = \dim(\text{Supp}(N))$.
In \cite{Serre_algebre_locale} it is shown that $r + s \leq \dim(A)$
and the following conjectures are made:
\begin{enumerate}
\item if $r + s < \dim(A)$, then $\chi(M, N) = 0$, and
\item if $r + s = \dim(A)$, then $\chi(M, N) > 0$.
\end{enumerate}
The arguments that prove Lemma \ref{lemma-tor-sheaf} and
Proposition \ref{proposition-positivity} can be leveraged
(as is done in Serre's text) to show that (1) and (2) are
true if $A$ contains a field. Currently, conjecture (1) is known
in general and it is known that $\chi(M, N) \geq 0$ in general (Gabber).
Positivity is, as far as we know, still an open problem.
\end{remark}


\section{Flat pullback and intersection products}
\label{section-flat-pullback-and-intersection-products}

\noindent
Short discussion of the interaction between intersections and
flat pullback.

\begin{lemma}
\label{lemma-flat-pull-back-and-intersections-sheaves}
Let $f : X \to Y$ be a flat morphism of nonsingular projective varieties
of relative dimension $e$. Let $\mathcal{F}$ and $\mathcal{G}$ be coherent
sheaves on $Y$ with $\dim(\text{Supp}(\mathcal{F})) \leq r$,
$\dim(\text{Supp}(\mathcal{G})) \leq s$, and
$\dim(\text{Supp}(\mathcal{F}) \cap \text{Supp}(\mathcal{G}) )
\leq r + s - \dim(Y)$. In this case the cycles
$[f^*\mathcal{F}]_{r + e}$ and $[f^*\mathcal{G}]_{s + e}$
intersect properly and
$$
f^*([\mathcal{F}]_r \cdot [\mathcal{G}]_s) =
[f^*\mathcal{F}]_{r + e} \cdot [f^*\mathcal{G}]_{s + e}
$$
\end{lemma}

\begin{proof}
The statement that $[f^*\mathcal{F}]_{r + e}$ and $[f^*\mathcal{G}]_{s + e}$
intersect properly is immediate from the assumption that $f$ has
relative dimension $e$. By
Lemmas \ref{lemma-tor-sheaf} and \ref{lemma-pullback}
it suffices to show that
$$
f^*\text{Tor}_i^{\mathcal{O}_Y}(\mathcal{F}, \mathcal{G}) =
\text{Tor}_i^{\mathcal{O}_X}(f^*\mathcal{F}, f^*\mathcal{G})
$$
as $\mathcal{O}_X$-modules. This follows from
Cohomology, Lemma \ref{cohomology-lemma-pullback-tensor-product}
and the fact that $f^*$ is exact, so $Lf^*\mathcal{F} = f^*\mathcal{F}$
and similarly for $\mathcal{G}$.
\end{proof}

\begin{lemma}
\label{lemma-flat-pullback-and-intersections}
Let $f : X \to Y$ be a flat morphism of nonsingular projective varieties.
Let $\alpha$ be a $r$-cycle on $Y$ and $\beta$ an $s$-cycle on $Y$.
Assume that $\alpha$ and $\beta$ intersect properly. Then $f^*\alpha$
and $f^*\beta$ intersect properly and
$f^*( \alpha \cdot \beta ) = f^*\alpha \cdot f^*\beta$.
\end{lemma}

\begin{proof}
By linearity we may assume that $\alpha = [V]$ and $\beta = [W]$
for some closed subvarieties $V, W \subset Y$ of dimension $r, s$.
Say $f$ has relative dimension $e$. Then the lemma is a special case of
Lemma \ref{lemma-flat-pull-back-and-intersections-sheaves}
because $[V] = [\mathcal{O}_V]_r$, $[W] = [\mathcal{O}_W]_r$,
$f^*[V] = [f^{-1}(V)]_{r + e} = [f^*\mathcal{O}_V]_{r + e}$, and
$f^*[W] = [f^{-1}(W)]_{s + e} = [f^*\mathcal{O}_W]_{s + e}$.
\end{proof}


\section{Projection formula for flat maps}
\label{section-projection-formula-flat}

\noindent
Short discussion of the projection formula for flat morphisms.

\begin{lemma}
\label{lemma-projection-formula-flat}
\begin{reference}
See \cite[Chapter V, Section 7, formula (10)]{Serre_algebre_locale}
for a more general formula.
\end{reference}
Let $f : X \to Y$ be a flat morphism of nonsingular projective varieties
of relative dimension $e$. Let $\alpha$ be an $r$-cycle on $X$ and let
$\beta$ be a $s$-cycle on $Y$. Assume that $\alpha$ and $f^*(\beta)$ intersect
properly. Then $f_*(\alpha)$ and $\beta$ intersect properly and
$$
f_*(\alpha) \cdot \beta = f_*( \alpha \cdot f^*\beta)
$$
\end{lemma}

\begin{proof}
By linearity we reduce to the case where $\alpha = [V]$ and
$\beta = [W]$ for some closed subvariety $V \subset X$ and
$W \subset Y$ of dimension $r$ and $s$. Then $f^{-1}(W)$ has
pure dimension $s + e$. We assume the cycles
$[V]$ and $f^*[W]$ intersect properly. We will use without
further mention the fact that $V \cap f^{-1}(W) \to f(V) \cap W$
is surjective.

\medskip\noindent
Let $a$ be the dimension of the generic fibre of $V \to f(V)$.
If $a > 0$, then $f_*[V] = 0$. In particular $f_*\alpha$ and $\beta$
intersect properly. To finish this case we have to show that
$f_*([V] \cdot f^*[W]) = 0$. However, since every fibre of
$V \to f(V)$ has dimension $\geq a$ (see
Morphisms, Lemma \ref{morphisms-lemma-openness-bounded-dimension-fibres})
we conclude that every irreducible component $Z$ of $V \cap f^{-1}(W)$
has fibres of dimension $\geq a$ over $f(Z)$. This certainly
implies what we want.

\medskip\noindent
Assume that $V \to f(V)$ is generically finite. Let $Z \subset f(V) \cap W$
be an irreducible component. Let $Z_i \subset V \cap f^{-1}(W)$,
$i = 1, \ldots, t$ be the irreducible components of $V \cap f^{-1}(W)$
dominating $Z$. By assumption each $Z_i$ has dimension
$r + s + e - \dim(X) = r + s - \dim(Y)$. Hence
$\dim(Z) \leq r + s - \dim(Y)$. Thus we see that $f(V)$ and $W$
intersect properly, $\dim(Z) = r + s - \dim(Y)$, and each
$Z_i \to Z$ is generically finite. In particular, it follows that
$V \to f(V)$ has finite fibre over the generic point $\xi$ of $Z$.
Thus $V \to Y$ is finite in an open neighbourhood of $\xi$, see
Cohomology of Schemes, Lemma
\ref{coherent-lemma-proper-finite-fibre-finite-in-neighbourhood}.
Using a very general projection formula\footnote{This can be avoided
by working in an affine neighbourhood of $\xi$ as above, choosing
an affine open of $X$ containing the generic points of the $Z_i$, and
translating the question into algebra. Doing this will produce a
relatively elementary proof of (\ref{equation-stalks}).}
for derived tensor products, we get
$$
Rf_*(\mathcal{O}_V \otimes_{\mathcal{O}_X}^\mathbf{L} Lf^*\mathcal{O}_W) =
Rf_*\mathcal{O}_V \otimes_{\mathcal{O}_Y}^\mathbf{L} \mathcal{O}_W
$$
see Derived Categories of Schemes, Lemma
\ref{perfect-lemma-cohomology-base-change}.
Since $f$ is flat, we see that $Lf^*\mathcal{O}_W = f^*\mathcal{O}_W$.
Since $f|_V$ is finite in an open neighbourhood of $\xi$ we have
$$
(Rf_*\mathcal{F})_\xi = (f_*\mathcal{F})_\xi
$$
for any coherent sheaf on $X$ whose support is contained in $V$
(see Cohomology of Schemes, Lemma
\ref{coherent-lemma-higher-direct-images-zero-finite-fibre}). Thus
we conclude that
\begin{equation}
\label{equation-stalks}
\left(
f_*\text{Tor}_i^{\mathcal{O}_X}(\mathcal{O}_V, f^*\mathcal{O}_W)
\right)_\xi =
\left(\text{Tor}_i^{\mathcal{O}_Y}(f_*\mathcal{O}_V, \mathcal{O}_W)\right)_\xi
\end{equation}
for all $i$. Since $f^*[W] = [f^*\mathcal{O}_W]_{s + e}$ by
Lemma \ref{lemma-pullback} we have
$$
[V] \cdot f^*[W] =
\sum (-1)^i
[\text{Tor}_i^{\mathcal{O}_X}(\mathcal{O}_V,
f^*\mathcal{O}_W)]_{r + s - \dim(Y)}
$$
by Lemma \ref{lemma-tor-sheaf}. Applying Lemma \ref{lemma-push-coherent}
we find
$$
f_*([V] \cdot f^*[W]) =
\sum (-1)^i
[f_*\text{Tor}_i^{\mathcal{O}_X}(\mathcal{O}_V,
f^*\mathcal{O}_W)]_{r + s - \dim(Y)}
$$
Since $f_*[V] = [f_*\mathcal{O}_V]_r$ by
Lemma \ref{lemma-push-coherent} we have
$$
[f_*V] \cdot [W] =
\sum (-1)^i
[\text{Tor}_i^{\mathcal{O}_X}(f_*\mathcal{O}_V,
\mathcal{O}_W)]_{r + s - \dim(Y)}
$$
again by Lemma \ref{lemma-tor-sheaf}.
Comparing the formula for $f_*([V] \cdot f^*[W])$ with
the formula for $f_*[V] \cdot [W]$ and looking at the
the coefficient of $Z$ by taking lengths of stalks at $\xi$, we see that
(\ref{equation-stalks}) finishes the proof.
\end{proof}


\section{Moving Lemma}
\label{section-moving-lemma}

\noindent
The moving lemma states that given an $r$-cycle $\alpha$ and a $s$ cycle
$\beta$ there exists $\alpha'$, $\alpha' \sim_{rat} \alpha$ such that
$\alpha$ and $\beta$ intersect properly.
See \cite{Samuel}, \cite{ChevalleyI}, \cite{ChevalleyII}.
The key to this is a lemma in the form stated in
\cite[Example 11.4.1]{F} and proved in \cite{Roberts}.

\begin{lemma}
\label{lemma-moving}
Let $X \subset \mathbf{P}^N$ be a nonsingular closed subvariety.
Let $n = \dim(X)$ and $0 \leq d, d' < n$. Let $Z \subset X$ be a closed
subvariety of dimension $d$ and $T_i \subset X$, $i \in I$ be a finite
collection of closed subvarities of dimension $d'$. Then there exists
a subvariety $C \subset \mathbf{P}^N$ such that $C$ intersects $X$
properly and such that
$$
C \cdot X = Z + \sum\nolimits_{j \in J} m_j Z_j
$$
where $Z_j \subset X$ are irreducible of dimension $d$, distinct from $Z$, and
$$
\dim(Z_j \cap T_i) \leq \dim(Z \cap T_i)
$$
with strict inequality if $Z$ does not intersect $T_i$ properly in $X$.
\end{lemma}

\begin{proof}
See \cite{Roberts}.
\end{proof}



\section{Intersection products and rational equivalence}
\label{section-intersections-and-rational-equivalence}

\noindent
With definitions as above we show that
the intersection product is well defined modulo rational
equivalence. Let $X$ be a nonsingular projective algebraic
variety. Let $\alpha$, resp.\ $\beta$ be a $s$, resp.\ $r$
cycle on $X$. Assume that $\alpha$ and $\beta$ intersect
properly so that $\alpha \cdot \beta$ is defined. Finally,
assume that $\alpha \sim_{rat} 0$. Goal: show that
$\alpha \cdot \beta \sim_{rat} 0$.

\medskip\noindent
There is a formal part of the argument which uses the moving lemma
and there is more geometric part using properties of the Tor formula.

\medskip\noindent
It suffices to prove the result when $\beta = [Z]$
for some $r$-dimensional closed subvariety $Z \subset X$.
The condition $\alpha \sim_{rat} 0$ means there
are finitely many $(r + 1)$-dimensional closed subvarieties
$W_i \subset X \times \mathbf{P}^1$ such that
$$
\alpha = \sum [W_{i, a_i}] - [W_{i, b_i}]
$$
for some pairs of points $a_i, b_i$ of $\mathbf{P}^1$.
Let $W_{i, a_i}^t$ and $W_{i, b_i}^t$ be the irreducible components.
Apply the moving lemma to $Z \subset X$ and the family of
subvarieties $\{W_{i, a_i}^t, W_{i, b_i}^t\}$. Then we see that
$$
[Z] + \sum m_j [Z_j]
$$
is equal to $\tilde Z_0$ for some $(r + 1)$-dimensional closed subvariety
$\tilde Z \subset X \times \mathbf{P}^1$ such that $\tilde Z_\infty$
is a closed subvariety in general position
and moreover, the excess intersection of the
$Z_j$ with the subvarieties $W_{i, a_i}^t$, $W_{i, b_i}^t$ decreases
if positive.
By the case discussed below we find that
$\alpha \cdot \tilde Z_0 \sim_{rat} \alpha \cdot \tilde Z_\infty$
(because each subvariety in the support of $\alpha$ occurs
as one the the $W_{i, a_i}^t$ and $W_{i, b_i}^t$ and moreover
properly intersects $Z$, whence $Z_j$ by our starting assumption).
Hence it suffices to show that
$\alpha \cdot [Z_j] \sim_{rat} 0$ and
$\alpha \cdot Z_\infty \sim_{rat} 0$.
Thus by induction on the excess intersection, we reduce to the
case where there is no excess intersection, i.e., all the
intersections $Z \cap W_{i, a_i}$, $Z \cap W_{i, b_i}$ are
proper. This again is the case treated below.

\medskip\noindent
Special case. Let $W \subset X \times {\bf P}^1$
be a $(s + 1)$-dimensional subvariety dominating ${\bf P}^1$.
Let $W_a$, resp.\ $W_b$ be the fibre of $W \to {\bf P}^1$
over $a$, resp.\ $b$. Let $V$ be a $r$-dimensional
subvariety of $X$ such that $V$ intersects both $W_a$ and
$W_b$ properly. Then $V \cdot [W_a] \sim_{rat} V \cdot [W_b]$.

\medskip\noindent
In order to see this, note first that
$[W_a] = pr_{X,*}( W \cdot X\times a)$ and similar for $[W_b]$.
Thus we reduce to showing
$$
V \cdot pr_{X,*}( W \cdot X\times a) \sim_{rat} V \cdot
pr_{X,*}( W \cdot X\times b).
$$
The projection formula -- which may be applied -- says
$V \cdot pr_{X,*}( W \cdot X\times a) =
pr_{X,*}(V \times {\bf P}^1 \cdot (W \cdot X\times a))$,
and similar for $b$. Thus we reduce to showing
$$
pr_{X,*}(V \times {\bf P}^1 \cdot (W \cdot X\times a))
\sim_{rat}
pr_{X,*}(V \times {\bf P}^1 \cdot (W \cdot X\times b))
$$
Associativity for the intersection multiplicities (see
\cite[Chapter V]{Serre_algebre_locale})
implies that $V \cdot (W \cdot X\times a) =
(V \times {\bf P}^1 \cdot W) \cdot X \times a$
and similar for $b$.  Thus we reduce to showing
$$
pr_{X,*}((V \times {\bf P}^1 \cdot W) \cdot X\times a)
\sim_{rat}
pr_{X,*}((V \times {\bf P}^1 \cdot W) \cdot X\times b)
$$
which is true by definition of rational equivalence.


\section{Chow rings}
\label{section-chow-rings}

\noindent
Using the above, for any nonsingular
projective $X$ we set $A_k(X)$ equal to the group of $k$-cycles
on $X$ modulo rational equivalence. Since it is more convenient
we also use $A^c(X)=A_{\dim X -c}(X)$ to denote the group of
codimension $c$ cycles modulo rational equivalence. The intersection product
defines a product
$$
A^k(X) \times A^l(X) \longrightarrow A^{k+l}(X)
$$
defined as follows: for $a \in A^k(X)$ and $b \in A^l(X)$
we can find a codimension $k$ cycle $\alpha$ representing $\alpha$,
a codimension $l$ cycle $\beta$ representing $b$ such that $\alpha$
and $\beta$ intersect properly.
We define $a\cdot b$ to be the rational equivalence
class of $\alpha \cdot \beta$. End result: A commutative and associative
graded ring $A^*(X)$ with unit $1=[X]$.


\section{Pullback for a general morphism}
\label{section-general-pullback}

\noindent
Let $X$ and $Y$ be nonsingular projective varieties,
and let $f : X \to Y$ be a morphism. We define
$$
f^* : A_k(Y) \to A_{k+\dim X - \dim Y}(X)
$$
by the rule
$$
f^*(\alpha) = pr_{X,*}(\Gamma_f \cdot pr_{Y}^*(\alpha))
$$
where $\Gamma_f \subset X\times Y$ is the graph of $f$.
Note that it is defined only on cycle classes and not
on cylces. This pullback satisfies:
\begin{enumerate}
\item $f^* : A^*(Y) \to A^*(X)$ is a ring map,
\item $(f \circ g)^* = g^* \circ f^*$ for a composable
pair $f,g$,
\item the projection formula holds: $f_*(\alpha) \cdot \beta =
f_*( \alpha \cdot f^*\beta)$, and
\item if $f$ is flat then it agrees with the previous definition.
\end{enumerate}
All of these follow easily from the above. For (1) you have to show that
$pr_{X,*}( \Gamma_f \cdot \alpha \cdot \beta) =
pr_{X,*}(\Gamma_f \cdot \alpha) \cdot
pr_{X,*}(\Gamma_f \cdot \beta)$. It is easy to see that
if $\alpha$ intersects $\Gamma_f$ properly, then
$\Gamma_f \cdot \alpha =
\Gamma_f \cdot pr_X^*(pr_{X,*}(\Gamma_f \cdot \alpha))$ as cycles
because $\Gamma_f$ is a graph. Thus we get
\begin{align*}
pr_{X,*}( \Gamma_f \cdot \alpha \cdot \beta)
& = pr_{X,*}( \Gamma_f \cdot
pr_X^*(pr_{X,*}(\Gamma_f \cdot \alpha)) \cdot \beta) \\
& =
pr_{X,*}( pr_X^*(pr_{X,*}(\Gamma_f \cdot \alpha))
\cdot (\Gamma_f \cdot \beta)) \\
& =
pr_{X,*}(\Gamma_f \cdot \alpha) \cdot pr_{X,*}(\Gamma_f \cdot \beta)
\end{align*}
the last step by the projection formula in the flat case. Properties
(2) and (3) are formal [for (3) use the flat projection formula twice].
Property (4) rests on identifying the intersection product
$\Gamma_f \cdot \alpha$ in the case $f$ is flat.


\section{Pullback of cycles}
\label{section-pullback-cycles}

\noindent
Suppose that $X$ and $Y$ be nonsingular
projective varieties, and let $f : X \to Y$ be a morphism.
Suppose that $Z \subset Y$ is a closed subvariety. Let $f^{-1}(Z)$
be the scheme theoretic inverse image:
$$
\xymatrix{
f^{-1}(Z) \ar[r] \ar[d] & Z \ar[d] \\
X \ar[r] & Y
}
$$
is a fibre product diagram of schemes. In particular $f^{-1}(Z) \subset X$
is a closed subscheme of $X$. In this case we always have
$$
\dim f^{-1}(Z) \geq \dim Z + \dim X - \dim Y.
$$
If equality holds in the formula above, then
$f^*[Z] = [f^{-1}(Z)]_{\dim Z + \dim X - \dim Y}$
provided that the scheme $Z$ is Cohen-Macaulay at the images
of the generic points of $f^{-1}(Z)$. This follows by identifying
$f^{-1}(Z)$ with the scheme theoretic intersection of $\Gamma_f$
and $X \times Z$ and using Lemma \ref{lemma-multiplicity-lci-CM}.






\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
