\input{preamble}

% OK, start here.
%
\begin{document}

\title{Deformation Theory}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
The goal of this chapter is to give a (relatively) gentle introduction to
deformation theory of modules, morphisms, etc. A not so gentle reference is
the book \cite{cotangent}.






\section{Thickenings of ringed spaces}
\label{section-thickenings-spaces}

\noindent
In the following few sections we will use the following notions:
\begin{enumerate}
\item A sheaf of ideals $\mathcal{I} \subset \mathcal{O}_{X'}$ on
a ringed space $(X', \mathcal{O}_{X'})$ is {\it locally nilpotent}
if any local section of $\mathcal{I}$ is locally nilpotent.
Compare with Algebra, Item \ref{algebra-item-ideal-locally-nilpotent}.
\item A {\it thickening} of ringed spaces is a morphism
$i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$ of ringed spaces
such that
\begin{enumerate}
\item $i$ induces a homeomorphism $X \to X'$,
\item the map $i^\sharp : \mathcal{O}_{X'} \to i_*\mathcal{O}_X$
is surjective, and
\item the kernel of $i^\sharp$ is a locally nilpotent sheaf of ideals.
\end{enumerate}
\item A {\it first order thickening} of ringed spaces is a thickening
$i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$ of ringed spaces
such that $\text{Ker}(i^\sharp)$ has square zero.
\item It is clear how to define {\it morphisms of thickenings},
{\it morphisms of thickenings over a base ringed space}, etc.
\end{enumerate}
If $i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$ is a thickening
of ringed spaces then we identify the underlying topological spaces
and think of $\mathcal{O}_X$, $\mathcal{O}_{X'}$, and
$\mathcal{I} = \text{Ker}(i^\sharp)$ as sheaves on $X = X'$. We obtain
a short exact sequence
$$
0 \to \mathcal{I} \to \mathcal{O}_{X'} \to \mathcal{O}_X \to 0
$$
of $\mathcal{O}_{X'}$-modules. By
Modules, Lemma \ref{modules-lemma-i-star-equivalence}
the category of $\mathcal{O}_X$-modules is equivalent to the category
of $\mathcal{O}_{X'}$-modules annihilated by $\mathcal{I}$. In particular,
if $i$ is a first order thickening, then
$\mathcal{I}$ is a $\mathcal{O}_X$-module.

\begin{situation}
\label{situation-morphism-thickenings}
A morphism of thickenings $(f, f')$ is given by a commutative diagram
\begin{equation}
\label{equation-morphism-thickenings}
\vcenter{
\xymatrix{
(X, \mathcal{O}_X) \ar[r]_i \ar[d]_f & (X', \mathcal{O}_{X'}) \ar[d]^{f'} \\
(S, \mathcal{O}_S) \ar[r]^t & (S', \mathcal{O}_{S'})
}
}
\end{equation}
of ringed spaces whose horizontal arrows are thickenings. In this
situation we set
$\mathcal{I} = \text{Ker}(i^\sharp) \subset \mathcal{O}_{X'}$ and
$\mathcal{J} = \text{Ker}(t^\sharp) \subset \mathcal{O}_{S'}$.
As $f = f'$ on underlying topological spaces we will identify
the (topological) pullback functors $f^{-1}$ and $(f')^{-1}$.
Observe that $(f')^\sharp : f^{-1}\mathcal{O}_{S'} \to \mathcal{O}_{X'}$
induces in particular a map $f^{-1}\mathcal{J} \to \mathcal{I}$
and therefore a map of $\mathcal{O}_{X'}$-modules
$$
(f')^*\mathcal{J} \longrightarrow \mathcal{I}
$$
If $i$ and $t$ are first order thickenings, then
$(f')^*\mathcal{J} = f^*\mathcal{J}$ and the map above becomes a
map $f^*\mathcal{J} \to \mathcal{I}$.
\end{situation}

\begin{definition}
\label{definition-strict-morphism-thickenings}
In Situation \ref{situation-morphism-thickenings} we say that $(f, f')$ is a
{\it strict morphism of thickenings}
if the map $(f')^*\mathcal{J} \longrightarrow \mathcal{I}$ is surjective.
\end{definition}

\noindent
The following lemma in particular shows that a morphism
$(f, f') : (X \subset X') \to (S \subset S')$ of
thickenings of schemes is strict if and only if $X = S \times_{S'} X'$.

\begin{lemma}
\label{lemma-strict-morphism-thickenings}
In Situation \ref{situation-morphism-thickenings} the morphism $(f, f')$
is a strict morphism of thickenings if and only if
(\ref{equation-morphism-thickenings}) is cartesian in the category
of ringed spaces.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}




\section{Modules on first order thickenings of ringed spaces}
\label{section-modules-thickenings}

\noindent
In this section we discuss some preliminaries to the deformation theory
of modules. Let $i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$
be a first order thickening of ringed spaces. We will freely use the notation
introduced in Section \ref{section-thickenings-spaces}, in particular we will
identify the underlying topological spaces.
In this section we consider short exact sequences
\begin{equation}
\label{equation-extension}
0 \to \mathcal{K} \to \mathcal{F}' \to \mathcal{F} \to 0
\end{equation}
of $\mathcal{O}_{X'}$-modules, where $\mathcal{F}$, $\mathcal{K}$ are
$\mathcal{O}_X$-modules and $\mathcal{F}'$ is an $\mathcal{O}_{X'}$-module.
In this situation we have a canonical $\mathcal{O}_X$-module map
$$
c_{\mathcal{F}'} :
\mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F}
\longrightarrow
\mathcal{K}
$$
where $\mathcal{I} = \text{Ker}(i^\sharp)$.
Namely, given local sections $f$ of $\mathcal{I}$ and $s$
of $\mathcal{F}$ we set $c_{\mathcal{F}'}(f \otimes s) = fs'$
where $s'$ is a local section of $\mathcal{F}'$ lifting $s$.

\begin{lemma}
\label{lemma-inf-map}
Let $i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$
be a first order thickening of ringed spaces. Assume given
extensions
$$
0 \to \mathcal{K} \to \mathcal{F}' \to \mathcal{F} \to 0
\quad\text{and}\quad
0 \to \mathcal{L} \to \mathcal{G}' \to \mathcal{G} \to 0
$$
as in (\ref{equation-extension})
and maps $\varphi : \mathcal{F} \to \mathcal{G}$ and
$\psi : \mathcal{K} \to \mathcal{L}$.
\begin{enumerate}
\item If there exists an $\mathcal{O}_{X'}$-module
map $\varphi' : \mathcal{F}' \to \mathcal{G}'$ compatible with $\varphi$
and $\psi$, then the diagram
$$
\xymatrix{
\mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F}
\ar[r]_-{c_{\mathcal{F}'}} \ar[d]_{1 \otimes \varphi} &
\mathcal{K} \ar[d]^\psi \\
\mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{G}
\ar[r]^-{c_{\mathcal{G}'}} &
\mathcal{L}
}
$$
is commutative.
\item The set of $\mathcal{O}_{X'}$-module
maps $\varphi' : \mathcal{F}' \to \mathcal{G}'$ compatible with $\varphi$
and $\psi$ is, if nonempty, a principal homogenous space under
$\Hom_{\mathcal{O}_X}(\mathcal{F}, \mathcal{L})$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) is immediate from the description of the maps.
For (2), if $\varphi'$ and $\varphi''$ are two maps
$\mathcal{F}' \to \mathcal{G}'$ compatible with $\varphi$
and $\psi$, then $\varphi' - \varphi''$ factors as
$$
\mathcal{F}' \to \mathcal{F} \to \mathcal{L} \to \mathcal{G}'
$$
The map in the middle comes from a unique element of
$\Hom_{\mathcal{O}_X}(\mathcal{F}, \mathcal{L})$ by
Modules, Lemma \ref{modules-lemma-i-star-equivalence}.
Conversely, given an element $\alpha$ of this group we can add the
composition (as displayed above with $\alpha$ in the middle)
to $\varphi'$. Some details omitted.
\end{proof}

\begin{lemma}
\label{lemma-inf-obs-map}
Let $i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$
be a first order thickening of ringed spaces. Assume given
extensions
$$
0 \to \mathcal{K} \to \mathcal{F}' \to \mathcal{F} \to 0
\quad\text{and}\quad
0 \to \mathcal{L} \to \mathcal{G}' \to \mathcal{G} \to 0
$$
as in (\ref{equation-extension})
and maps $\varphi : \mathcal{F} \to \mathcal{G}$ and
$\psi : \mathcal{K} \to \mathcal{L}$. Assume the diagram
$$
\xymatrix{
\mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F}
\ar[r]_-{c_{\mathcal{F}'}} \ar[d]_{1 \otimes \varphi} &
\mathcal{K} \ar[d]^\psi \\
\mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{G}
\ar[r]^-{c_{\mathcal{G}'}} &
\mathcal{L}
}
$$
is commutative. Then there exists an element
$$
o(\varphi, \psi) \in
\text{Ext}^1_{\mathcal{O}_X}(\mathcal{F}, \mathcal{L})
$$
whose vanishing is a necessary and sufficient condition for the existence
of a map $\varphi' : \mathcal{F}' \to \mathcal{G}'$ compatible with
$\varphi$ and $\psi$.
\end{lemma}

\begin{proof}
We can construct explicitly an extension
$$
0 \to \mathcal{L} \to \mathcal{H} \to \mathcal{F} \to 0
$$
by taking $\mathcal{H}$ to be the cohomology of the complex
$$
\mathcal{K}
\xrightarrow{1, - \psi}
\mathcal{F}' \oplus \mathcal{G}' \xrightarrow{\varphi, 1}
\mathcal{G}
$$
in the middle (with obvious notation). A calculation with local sections
using the assumption that the diagram of the lemma commutes
shows that $\mathcal{H}$ is annihilated by $\mathcal{I}$. Hence
$\mathcal{H}$ defines a class in
$$
\text{Ext}^1_{\mathcal{O}_X}(\mathcal{F}, \mathcal{L})
\subset
\text{Ext}^1_{\mathcal{O}_{X'}}(\mathcal{F}, \mathcal{L})
$$
Finally, the class of $\mathcal{H}$ is the difference of the pushout
of the extension $\mathcal{F}'$ via $\psi$ and the pullback
of the extension $\mathcal{G}'$ via $\varphi$ (calculations omitted).
Thus the vanishing of the class of $\mathcal{H}$ is equivalent to the
existence of a commutative diagram
$$
\xymatrix{
0 \ar[r] &
\mathcal{K} \ar[r] \ar[d]_{\psi} &
\mathcal{F}' \ar[r] \ar[d]_{\varphi'} &
\mathcal{F} \ar[r] \ar[d]_\varphi & 0\\
0 \ar[r] &
\mathcal{L} \ar[r] &
\mathcal{G}' \ar[r] &
\mathcal{G} \ar[r] & 0
}
$$
as desired.
\end{proof}

\begin{lemma}
\label{lemma-inf-ext}
Let $i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$ be a first order
thickening of ringed spaces.
Assume given $\mathcal{O}_X$-modules $\mathcal{F}$, $\mathcal{K}$
and an $\mathcal{O}_X$-linear map
$c : \mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F} \to \mathcal{K}$.
If there exists a sequence (\ref{equation-extension}) with
$c_{\mathcal{F}'} = c$ then the set of isomorphism classes of these
extensions is principal homogeneous under
$\text{Ext}^1_{\mathcal{O}_X}(\mathcal{F}, \mathcal{K})$.
\end{lemma}

\begin{proof}
Assume given extensions
$$
0 \to \mathcal{K} \to \mathcal{F}'_1 \to \mathcal{F} \to 0
\quad\text{and}\quad
0 \to \mathcal{K} \to \mathcal{F}'_2 \to \mathcal{F} \to 0
$$
with $c_{\mathcal{F}'_1} = c_{\mathcal{F}'_2} = c$. Then the difference
(in the extension group, see
Homology, Section \ref{homology-section-extensions})
is an extension
$$
0 \to \mathcal{K} \to \mathcal{E} \to \mathcal{F} \to 0
$$
where $\mathcal{E}$ is annihilated by $\mathcal{I}$ (local computation
omitted). Hence the sequence is an extension of $\mathcal{O}_X$-modules,
see Modules, Lemma \ref{modules-lemma-i-star-equivalence}.
Conversely, given such an extension $\mathcal{E}$ we can add the extension
$\mathcal{E}$ to the $\mathcal{O}_{X'}$-extension $\mathcal{F}'$ without
affecting the map $c_{\mathcal{F}'}$. Some details omitted.
\end{proof}

\begin{lemma}
\label{lemma-inf-obs-ext}
Let $i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$
be a first order thickening of ringed spaces. Assume given
$\mathcal{O}_X$-modules $\mathcal{F}$, $\mathcal{K}$
and an $\mathcal{O}_X$-linear map
$c : \mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F} \to \mathcal{K}$.
Then there exists an element
$$
o(\mathcal{F}, \mathcal{K}, c) \in
\text{Ext}^2_{\mathcal{O}_X}(\mathcal{F}, \mathcal{K})
$$
whose vanishing is a necessary and sufficient condition for the existence
of a sequence (\ref{equation-extension}) with $c_{\mathcal{F}'} = c$.
\end{lemma}

\begin{proof}
We first show that if $\mathcal{K}$ is an injective $\mathcal{O}_X$-module,
then there does exist a sequence (\ref{equation-extension}) with
$c_{\mathcal{F}'} = c$. To do this, choose a flat
$\mathcal{O}_{X'}$-module $\mathcal{H}'$ and a surjection
$\mathcal{H}' \to \mathcal{F}$
(Modules, Lemma \ref{modules-lemma-module-quotient-flat}).
Let $\mathcal{J} \subset \mathcal{H}'$ be the kernel. Since $\mathcal{H}'$
is flat we have
$$
\mathcal{I} \otimes_{\mathcal{O}_{X'}} \mathcal{H}' =
\mathcal{I}\mathcal{H}'
\subset \mathcal{J} \subset \mathcal{H}'
$$
Observe that the map
$$
\mathcal{I}\mathcal{H}' =
\mathcal{I} \otimes_{\mathcal{O}_{X'}} \mathcal{H}'
\longrightarrow
\mathcal{I} \otimes_{\mathcal{O}_{X'}} \mathcal{F} =
\mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F}
$$
annihilates $\mathcal{I}\mathcal{J}$. Namely, if $f$ is a local section
of $\mathcal{I}$ and $s$ is a local section of $\mathcal{H}$, then
$fs$ is mapped to $f \otimes \overline{s}$ where $\overline{s}$ is
the image of $s$ in $\mathcal{F}$. Thus we obtain
$$
\xymatrix{
\mathcal{I}\mathcal{H}'/\mathcal{I}\mathcal{J}
\ar@{^{(}->}[r] \ar[d] &
\mathcal{J}/\mathcal{I}\mathcal{J} \ar@{..>}[d]_\gamma \\
\mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F} \ar[r]^-c &
\mathcal{K}
}
$$
a diagram of $\mathcal{O}_X$-modules. If $\mathcal{K}$ is injective
as an $\mathcal{O}_X$-module, then we obtain the dotted arrow.
Denote $\gamma' : \mathcal{J} \to \mathcal{K}$ the composition
of $\gamma$ with $\mathcal{J} \to \mathcal{J}/\mathcal{I}\mathcal{J}$.
A local calculation shows the pushout
$$
\xymatrix{
0 \ar[r] &
\mathcal{J} \ar[r] \ar[d]_{\gamma'} &
\mathcal{H}' \ar[r] \ar[d] &
\mathcal{F} \ar[r] \ar@{=}[d] &
0 \\
0 \ar[r] &
\mathcal{K} \ar[r] &
\mathcal{F}' \ar[r] &
\mathcal{F} \ar[r] &
0
}
$$
is a solution to the problem posed by the lemma.

\medskip\noindent
General case. Choose an embedding $\mathcal{K} \subset \mathcal{K}'$
with $\mathcal{K}'$ an injective $\mathcal{O}_X$-module. Let $\mathcal{Q}$
be the quotient, so that we have an exact sequence
$$
0 \to \mathcal{K} \to \mathcal{K}' \to \mathcal{Q} \to 0
$$
Denote
$c' : \mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F} \to \mathcal{K}'$
be the composition. By the paragraph above there exists a sequence
$$
0 \to \mathcal{K}' \to \mathcal{E}' \to \mathcal{F} \to 0
$$
as in (\ref{equation-extension}) with $c_{\mathcal{E}'} = c'$.
Note that $c'$ composed with the map $\mathcal{K}' \to \mathcal{Q}$
is zero, hence the pushout of $\mathcal{E}'$ by
$\mathcal{K}' \to \mathcal{Q}$ is an extension
$$
0 \to \mathcal{Q} \to \mathcal{D}' \to \mathcal{F} \to 0
$$
as in (\ref{equation-extension}) with $c_{\mathcal{D}'} = 0$.
This means exactly that $\mathcal{D}'$ is annihilated by
$\mathcal{I}$, in other words, the $\mathcal{D}'$ is an extension
of $\mathcal{O}_X$-modules, i.e., defines an element
$$
o(\mathcal{F}, \mathcal{K}, c) \in
\text{Ext}^1_{\mathcal{O}_X}(\mathcal{F}, \mathcal{Q}) =
\text{Ext}^2_{\mathcal{O}_X}(\mathcal{F}, \mathcal{K})
$$
(the equality holds by the long exact cohomology sequence associated
to the exact sequence above and the vanishing of higher ext groups
into the injective module $\mathcal{K}'$). If
$o(\mathcal{F}, \mathcal{K}, c) = 0$, then we can choose a splitting
$s : \mathcal{F} \to \mathcal{D}'$ and we can set
$$
\mathcal{F}' = \text{Ker}(\mathcal{E}' \to \mathcal{D}'/s(\mathcal{F}))
$$
so that we obtain the following diagram
$$
\xymatrix{
0 \ar[r] &
\mathcal{K} \ar[r] \ar[d] &
\mathcal{F}' \ar[r] \ar[d] &
\mathcal{F} \ar[r] \ar@{=}[d] &
0 \\
0 \ar[r] &
\mathcal{K}' \ar[r] &
\mathcal{E}' \ar[r] &
\mathcal{F} \ar[r] & 0
}
$$
with exact rows which shows that $c_{\mathcal{F}'} = c$. Conversely, if
$\mathcal{F}'$ exists, then the pushout of $\mathcal{F}'$ by the map
$\mathcal{K} \to \mathcal{K}'$ is isomorphic to $\mathcal{E}'$ by
Lemma \ref{lemma-inf-ext} and the vanishing of higher ext groups
into the injective module $\mathcal{K}'$. This gives a diagram
as above, which implies that $\mathcal{D}'$ is split as an extension, i.e.,
the class $o(\mathcal{F}, \mathcal{K}, c)$ is zero.
\end{proof}

\begin{remark}
\label{remark-trivial-thickening}
Let $(X, \mathcal{O}_X)$ be a ringed space. A first order thickening
$i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$ is said
to be {\it trivial} if there exists a morphism of ringed spaces
$\pi : (X', \mathcal{O}_{X'}) \to (X, \mathcal{O}_X)$ which is a
left inverse to $i$. The choice of such a morphism
$\pi$ is called a {\it trivialization} of the first order thickening.
Given $\pi$ we obtain a splitting
\begin{equation}
\label{equation-splitting}
\mathcal{O}_{X'} = \mathcal{O}_X \oplus \mathcal{I}
\end{equation}
as sheaves of algebras on $X$ by using $\pi^\sharp$ to split the surjection
$\mathcal{O}_{X'} \to \mathcal{O}_X$. Conversely, such a splitting determines
a morphism $\pi$. The category of trivialized first order thickenings of
$(X, \mathcal{O}_X)$ is equivalent to the category of 
$\mathcal{O}_X$-modules.
\end{remark}

\begin{remark}
\label{remark-trivial-extension}
Let $i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$
be a trivial first order thickening of ringed spaces
and let $\pi : (X', \mathcal{O}_{X'}) \to (X, \mathcal{O}_X)$
be a trivialization. Then given any triple
$(\mathcal{F}, \mathcal{K}, c)$ consisting of a pair of
$\mathcal{O}_X$-modules and a map
$c : \mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F} \to \mathcal{K}$
we may set
$$
\mathcal{F}'_{c, triv} = \mathcal{F} \oplus \mathcal{K}
$$
and use the splitting (\ref{equation-splitting}) associated to $\pi$
and the map $c$ to define the $\mathcal{O}_{X'}$-module structure
and obtain an extension (\ref{equation-extension}). We will call
$\mathcal{F}'_{c, triv}$ the {\it trivial extension} of $\mathcal{F}$
by $\mathcal{K}$ corresponding
to $c$ and the trivialization $\pi$. Given any extension
$\mathcal{F}'$ as in (\ref{equation-extension}) we can use
$\pi^\sharp : \mathcal{O}_X \to \mathcal{O}_{X'}$ to think of $\mathcal{F}'$
as an $\mathcal{O}_X$-module extension, hence a class $\xi_{\mathcal{F}'}$
in $\text{Ext}^1_{\mathcal{O}_X}(\mathcal{F}, \mathcal{K})$.
Lemma \ref{lemma-inf-ext} assures that
$\mathcal{F}' \mapsto \xi_{\mathcal{F}'}$
induces a bijection
$$
\left\{
\begin{matrix}
\text{isomorphism classes of extensions}\\
\mathcal{F}'\text{ as in (\ref{equation-extension}) with }c = c_{\mathcal{F}'}
\end{matrix}
\right\}
\longrightarrow
\text{Ext}^1_{\mathcal{O}_X}(\mathcal{F}, \mathcal{K})
$$
Moreover, the trivial extension $\mathcal{F}'_{c, triv}$ maps to the zero class.
\end{remark}

\begin{remark}
\label{remark-extension-functorial}
Let $(X, \mathcal{O}_X)$ be a ringed space. Let
$(X, \mathcal{O}_X) \to (X'_i, \mathcal{O}_{X'_i})$, $i = 1, 2$
be first order thickenings with ideal sheaves $\mathcal{I}_i$.
Let $h : (X'_1, \mathcal{O}_{X'_1}) \to (X'_2, \mathcal{O}_{X'_2})$
be a morphism of first order thickenings of $(X, \mathcal{O}_X)$.
Picture
$$
\xymatrix{
& (X, \mathcal{O}_X) \ar[ld] \ar[rd] & \\
(X'_1, \mathcal{O}_{X'_1}) \ar[rr]^h & & 
(X'_2, \mathcal{O}_{X'_2})
}
$$
Observe that $h^\sharp : \mathcal{O}_{X'_2} \to \mathcal{O}_{X'_1}$
in particular induces an $\mathcal{O}_X$-module map
$\mathcal{I}_2 \to \mathcal{I}_1$.
Let $\mathcal{F}$ be an
$\mathcal{O}_X$-module. Let $(\mathcal{K}_i, c_i)$, $i = 1, 2$ be a pair
consisting of an $\mathcal{O}_X$-module $\mathcal{K}_i$ and a map
$c_i : \mathcal{I}_i \otimes_{\mathcal{O}_X} \mathcal{F} \to
\mathcal{K}_i$. Assume furthermore given a map
of $\mathcal{O}_X$-modules $\mathcal{K}_2 \to \mathcal{K}_1$
such that
$$
\xymatrix{
\mathcal{I}_2 \otimes_{\mathcal{O}_X} \mathcal{F}
\ar[r]_-{c_2} \ar[d] &
\mathcal{K}_2 \ar[d] \\
\mathcal{I}_1 \otimes_{\mathcal{O}_X} \mathcal{F}
\ar[r]^-{c_1} &
\mathcal{K}_1
}
$$
is commutative. Then there is a canonical functoriality
$$
\left\{
\begin{matrix}
\mathcal{F}'_2\text{ as in (\ref{equation-extension}) with }\\
c_2 = c_{\mathcal{F}'_2}\text{ and }\mathcal{K} = \mathcal{K}_2
\end{matrix}
\right\}
\longrightarrow
\left\{
\begin{matrix}
\mathcal{F}'_1\text{ as in (\ref{equation-extension}) with }\\
c_1 = c_{\mathcal{F}'_1}\text{ and }\mathcal{K} = \mathcal{K}_1
\end{matrix}
\right\}
$$
Namely, thinking of all sheaves $\mathcal{O}_X$, $\mathcal{O}_{X'_i}$,
$\mathcal{F}$, $\mathcal{K}_i$, etc as sheaves on $X$, we set
given $\mathcal{F}'_2$ the sheaf $\mathcal{F}'_1$ equal to the
pushout, i.e., fitting into the following diagram of extensions
$$
\xymatrix{
0 \ar[r] &
\mathcal{K}_2 \ar[r] \ar[d] &
\mathcal{F}'_2 \ar[r] \ar[d] &
\mathcal{F} \ar@{=}[d] \ar[r] & 0 \\
0 \ar[r] &
\mathcal{K}_1 \ar[r] &
\mathcal{F}'_1 \ar[r] &
\mathcal{F} \ar[r] & 0
}
$$
We omit the construction of the $\mathcal{O}_{X'_1}$-module structure
on the pushout (this uses the commutativity of the diagram
involving $c_1$ and $c_2$).
\end{remark}

\begin{remark}
\label{remark-trivial-extension-functorial}
Let $(X, \mathcal{O}_X)$, $(X, \mathcal{O}_X) \to (X'_i, \mathcal{O}_{X'_i})$,
$\mathcal{I}_i$, and
$h : (X'_1, \mathcal{O}_{X'_1}) \to (X'_2, \mathcal{O}_{X'_2})$
be as in Remark \ref{remark-extension-functorial}. Assume that we are
given given trivializations $\pi_i : X'_i \to X$ such that
$\pi_1 = h \circ \pi_2$. In other words, assume $h$ is a morphism
of trivialized first order thickening of $(X, \mathcal{O}_X)$. Let
$(\mathcal{K}_i, c_i)$, $i = 1, 2$ be a pair consisting of an
$\mathcal{O}_X$-module $\mathcal{K}_i$ and a map
$c_i : \mathcal{I}_i \otimes_{\mathcal{O}_X} \mathcal{F} \to
\mathcal{K}_i$. Assume furthermore given a map
of $\mathcal{O}_X$-modules $\mathcal{K}_2 \to \mathcal{K}_1$
such that
$$
\xymatrix{
\mathcal{I}_2 \otimes_{\mathcal{O}_X} \mathcal{F}
\ar[r]_-{c_2} \ar[d] &
\mathcal{K}_2 \ar[d] \\
\mathcal{I}_1 \otimes_{\mathcal{O}_X} \mathcal{F}
\ar[r]^-{c_1} &
\mathcal{K}_1
}
$$
is commutative. In this situation the construction of
Remark \ref{remark-trivial-extension} induces
a commutative diagram
$$
\xymatrix{
\{\mathcal{F}'_2\text{ as in (\ref{equation-extension}) with }
c_2 = c_{\mathcal{F}'_2}\text{ and }\mathcal{K} = \mathcal{K}_2\}
\ar[d] \ar[rr] & &
\text{Ext}^1_{\mathcal{O}_X}(\mathcal{F}, \mathcal{K}_2) \ar[d] \\
\{\mathcal{F}'_1\text{ as in (\ref{equation-extension}) with }
c_1 = c_{\mathcal{F}'_1}\text{ and }\mathcal{K} = \mathcal{K}_1\}
\ar[rr] & &
\text{Ext}^1_{\mathcal{O}_X}(\mathcal{F}, \mathcal{K}_1)
}
$$
where the vertical map on the right is given by functoriality of $\text{Ext}$
and the map $\mathcal{K}_2 \to \mathcal{K}_1$ and the vertical map on the left
is the one from Remark \ref{remark-extension-functorial}.
\end{remark}

\begin{remark}
\label{remark-short-exact-sequence-thickenings}
Let $(X, \mathcal{O}_X)$ be a ringed space. We define a sequence of morphisms
of first order thickenings
$$
(X'_1, \mathcal{O}_{X'_1}) \to
(X'_2, \mathcal{O}_{X'_2}) \to
(X'_3, \mathcal{O}_{X'_3})
$$
of $(X, \mathcal{O}_X)$ to be a {\it complex}
if the corresponding maps between
the ideal sheaves $\mathcal{I}_i$
give a complex of $\mathcal{O}_X$-modules
$\mathcal{I}_3 \to \mathcal{I}_2 \to \mathcal{I}_1$
(i.e., the composition is zero). In this case the composition
$(X'_1, \mathcal{O}_{X'_1}) \to (X_3', \mathcal{O}_{X'_3})$ factors through
$(X, \mathcal{O}_X) \to (X'_3, \mathcal{O}_{X'_3})$, i.e.,
the first order thickening $(X'_1, \mathcal{O}_{X'_1})$ of
$(X, \mathcal{O}_X)$ is trivial and comes with
a canonical trivialization
$\pi : (X'_1, \mathcal{O}_{X'_1}) \to (X, \mathcal{O}_X)$.

\medskip\noindent
We say a sequence of morphisms of first order thickenings
$$
(X'_1, \mathcal{O}_{X'_1}) \to
(X'_2, \mathcal{O}_{X'_2}) \to
(X'_3, \mathcal{O}_{X'_3})
$$
of $(X, \mathcal{O}_X)$ is {\it a short exact sequence} if the
corresponding maps between ideal sheaves is a short exact sequence
$$
0 \to \mathcal{I}_3 \to \mathcal{I}_2 \to \mathcal{I}_1 \to 0
$$
of $\mathcal{O}_X$-modules.
\end{remark}

\begin{remark}
\label{remark-complex-thickenings-and-ses-modules}
Let $(X, \mathcal{O}_X)$ be a ringed space. Let $\mathcal{F}$ be an
$\mathcal{O}_X$-module. Let
$$
(X'_1, \mathcal{O}_{X'_1}) \to
(X'_2, \mathcal{O}_{X'_2}) \to
(X'_3, \mathcal{O}_{X'_3})
$$
be a complex first order thickenings of $(X, \mathcal{O}_X)$, see
Remark \ref{remark-short-exact-sequence-thickenings}.
Let $(\mathcal{K}_i, c_i)$, $i = 1, 2, 3$ be pairs consisting of
an $\mathcal{O}_X$-module $\mathcal{K}_i$ and a map
$c_i : \mathcal{I}_i \otimes_{\mathcal{O}_X} \mathcal{F} \to
\mathcal{K}_i$. Assume given a short exact sequence
of $\mathcal{O}_X$-modules
$$
0 \to \mathcal{K}_3 \to \mathcal{K}_2 \to \mathcal{K}_1 \to 0
$$
such that
$$
\vcenter{
\xymatrix{
\mathcal{I}_2 \otimes_{\mathcal{O}_X} \mathcal{F}
\ar[r]_-{c_2} \ar[d] &
\mathcal{K}_2 \ar[d] \\
\mathcal{I}_1 \otimes_{\mathcal{O}_X} \mathcal{F}
\ar[r]^-{c_1} &
\mathcal{K}_1
}
}
\quad\text{and}\quad
\vcenter{
\xymatrix{
\mathcal{I}_3 \otimes_{\mathcal{O}_X} \mathcal{F}
\ar[r]_-{c_3} \ar[d] &
\mathcal{K}_3 \ar[d] \\
\mathcal{I}_2 \otimes_{\mathcal{O}_X} \mathcal{F}
\ar[r]^-{c_2} &
\mathcal{K}_2
}
}
$$
are commutative. Finally, assume given an extension
$$
0 \to \mathcal{K}_2 \to \mathcal{F}'_2 \to \mathcal{F} \to 0
$$
as in (\ref{equation-extension}) with $\mathcal{K} = \mathcal{K}_2$
of $\mathcal{O}_{X'_2}$-modules with $c_{\mathcal{F}'_2} = c_2$.
In this situation we can apply the functoriality of
Remark \ref{remark-extension-functorial} to obtain an extension
$\mathcal{F}'_1$ on $X'_1$ (we'll describe $\mathcal{F}'_1$
in this special case below). By
Remark \ref{remark-trivial-extension}
using the canonical splitting
$\pi : (X'_1, \mathcal{O}_{X'_1}) \to (X, \mathcal{O}_X)$ of
Remark \ref{remark-short-exact-sequence-thickenings}
we obtain
$\xi_{\mathcal{F}'_1} \in
\text{Ext}^1_{\mathcal{O}_X}(\mathcal{F}, \mathcal{K}_1)$.
Finally, we have the obstruction
$$
o(\mathcal{F}, \mathcal{K}_3, c_3) \in
\text{Ext}^2_{\mathcal{O}_X}(\mathcal{F}, \mathcal{K}_3)
$$
see Lemma \ref{lemma-inf-obs-ext}.
In this situation we {\bf claim} that the canonical map
$$
\partial :
\text{Ext}^1_{\mathcal{O}_X}(\mathcal{F}, \mathcal{K}_1)
\longrightarrow
\text{Ext}^2_{\mathcal{O}_X}(\mathcal{F}, \mathcal{K}_3)
$$
coming from the short exact sequence
$0 \to \mathcal{K}_3 \to \mathcal{K}_2 \to \mathcal{K}_1 \to 0$
sends $\xi_{\mathcal{F}'_1}$
to the obstruction class $o(\mathcal{F}, \mathcal{K}_3, c_3)$.

\medskip\noindent
To prove this claim choose an embedding $j : \mathcal{K}_3 \to \mathcal{K}$
where $\mathcal{K}$ is an injective $\mathcal{O}_X$-module.
We can lift $j$ to a map $j' : \mathcal{K}_2 \to \mathcal{K}$.
Set $\mathcal{E}'_2 = j'_*\mathcal{F}'_2$ equal to the pushout
of $\mathcal{F}'_2$ by $j'$ so that $c_{\mathcal{E}'_2} = j' \circ c_2$.
Picture:
$$
\xymatrix{
0 \ar[r] &
\mathcal{K}_2 \ar[r] \ar[d]_{j'} &
\mathcal{F}'_2 \ar[r] \ar[d] &
\mathcal{F} \ar[r] \ar[d] & 0 \\
0 \ar[r] &
\mathcal{K} \ar[r] &
\mathcal{E}'_2 \ar[r] &
\mathcal{F} \ar[r] & 0
}
$$
Set $\mathcal{E}'_3 = \mathcal{E}'_2$ but viewed as an
$\mathcal{O}_{X'_3}$-module via $\mathcal{O}_{X'_3} \to \mathcal{O}_{X'_2}$.
Then $c_{\mathcal{E}'_3} = j \circ c_3$.
The proof of Lemma \ref{lemma-inf-obs-ext} constructs
$o(\mathcal{F}, \mathcal{K}_3, c_3)$
as the boundary of the class of the extension of $\mathcal{O}_X$-modules
$$
0 \to
\mathcal{K}/\mathcal{K}_3 \to
\mathcal{E}'_3/\mathcal{K}_3 \to
\mathcal{F} \to 0
$$
On the other hand, note that $\mathcal{F}'_1 = \mathcal{F}'_2/\mathcal{K}_3$
hence the class $\xi_{\mathcal{F}'_1}$ is the class
of the extension
$$
0 \to \mathcal{K}_2/\mathcal{K}_3 \to \mathcal{F}'_2/\mathcal{K}_3
\to \mathcal{F} \to 0
$$
seen as a sequence of $\mathcal{O}_X$-modules using $\pi^\sharp$
where $\pi : (X'_1, \mathcal{O}_{X'_1}) \to (X, \mathcal{O}_X)$
is the canonical splitting.
Thus finally, the claim follows from the fact that we have
a commutative diagram
$$
\xymatrix{
0 \ar[r] &
\mathcal{K}_2/\mathcal{K}_3 \ar[r] \ar[d] &
\mathcal{F}'_2/\mathcal{K}_3 \ar[r] \ar[d] &
\mathcal{F} \ar[r] \ar[d] & 0 \\
0 \ar[r] &
\mathcal{K}/\mathcal{K}_3 \ar[r] &
\mathcal{E}'_3/\mathcal{K}_3 \ar[r] &
\mathcal{F} \ar[r] & 0
}
$$
which is $\mathcal{O}_X$-linear (with the $\mathcal{O}_X$-module
structures given above).
\end{remark}








\section{Infinitesimal deformations of modules on ringed spaces}
\label{section-deformation-modules}

\noindent
Let $i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$ be a first
order thickening of ringed spaces. We freely use the notation introduced in
Section \ref{section-thickenings-spaces}.
Let $\mathcal{F}'$ be an $\mathcal{O}_{X'}$-module
and set $\mathcal{F} = i^*\mathcal{F}'$.
In this situation we have a short exact sequence
$$
0 \to \mathcal{I}\mathcal{F}' \to \mathcal{F}' \to \mathcal{F} \to 0
$$
of $\mathcal{O}_{X'}$-modules. Since $\mathcal{I}^2 = 0$ the
$\mathcal{O}_{X'}$-module structure on $\mathcal{I}\mathcal{F}'$
comes from a unique $\mathcal{O}_X$-module structure.
Thus the sequence above is an extension as in (\ref{equation-extension}).
As a special case, if $\mathcal{F}' = \mathcal{O}_{X'}$ we have
$i^*\mathcal{O}_{X'} = \mathcal{O}_X$ and
$\mathcal{I}\mathcal{O}_{X'} = \mathcal{I}$ and we recover the
sequence of structure sheaves
$$
0 \to \mathcal{I} \to \mathcal{O}_{X'} \to \mathcal{O}_X \to 0
$$

\begin{lemma}
\label{lemma-inf-map-special}
Let $i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$
be a first order thickening of ringed spaces.
Let $\mathcal{F}'$, $\mathcal{G}'$ be $\mathcal{O}_{X'}$-modules.
Set $\mathcal{F} = i^*\mathcal{F}'$ and $\mathcal{G} = i^*\mathcal{G}'$.
Let $\varphi : \mathcal{F} \to \mathcal{G}$ be an $\mathcal{O}_X$-linear map.
The set of lifts of $\varphi$ to an $\mathcal{O}_{X'}$-linear map
$\varphi' : \mathcal{F}' \to \mathcal{G}'$ is, if nonempty, a principal
homogenous space under
$\Hom_{\mathcal{O}_X}(\mathcal{F}, \mathcal{I}\mathcal{G}')$.
\end{lemma}

\begin{proof}
This is a special case of Lemma \ref{lemma-inf-map} but we also
give a direct proof. We have short exact sequences of modules
$$
0 \to \mathcal{I} \to \mathcal{O}_{X'} \to \mathcal{O}_X \to 0
\quad\text{and}\quad
0 \to \mathcal{I}\mathcal{G}' \to \mathcal{G}' \to \mathcal{G} \to 0
$$
and similarly for $\mathcal{F}'$.
Since $\mathcal{I}$ has square zero the $\mathcal{O}_{X'}$-module
structure on $\mathcal{I}$ and $\mathcal{I}\mathcal{G}'$ comes from
a unique $\mathcal{O}_X$-module structure. It follows that
$$
\Hom_{\mathcal{O}_{X'}}(\mathcal{F}', \mathcal{I}\mathcal{G}') =
\Hom_{\mathcal{O}_X}(\mathcal{F}, \mathcal{I}\mathcal{G}')
\quad\text{and}\quad
\Hom_{\mathcal{O}_{X'}}(\mathcal{F}', \mathcal{G}) =
\Hom_{\mathcal{O}_X}(\mathcal{F}, \mathcal{G})
$$
The lemma now follows from the exact sequence
$$
0 \to \Hom_{\mathcal{O}_{X'}}(\mathcal{F}', \mathcal{I}\mathcal{G}') \to
\Hom_{\mathcal{O}_{X'}}(\mathcal{F}', \mathcal{G}') \to
\Hom_{\mathcal{O}_{X'}}(\mathcal{F}', \mathcal{G})
$$
see Homology, Lemma \ref{homology-lemma-check-exactness}.
\end{proof}

\begin{lemma}
\label{lemma-deform-module}
Let $(f, f')$ be a morphism of first order thickenings of ringed spaces
as in Situation \ref{situation-morphism-thickenings}.
Let $\mathcal{F}'$ be an $\mathcal{O}_{X'}$-module
and set $\mathcal{F} = i^*\mathcal{F}'$.
Assume that $\mathcal{F}$ is flat over $S$
and that $(f, f')$ is a strict morphism of thickenings
(Definition \ref{definition-strict-morphism-thickenings}).
Then the following are equivalent
\begin{enumerate}
\item $\mathcal{F}'$ is flat over $S'$, and
\item the canonical map
$f^*\mathcal{J} \otimes_{\mathcal{O}_X} \mathcal{F} \to
\mathcal{I}\mathcal{F}'$
is an isomorphism.
\end{enumerate}
Moreover, in this case the maps
$$
f^*\mathcal{J} \otimes_{\mathcal{O}_X} \mathcal{F} \to
\mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F} \to
\mathcal{I}\mathcal{F}'
$$
are isomorphisms.
\end{lemma}

\begin{proof}
The map $f^*\mathcal{J} \to \mathcal{I}$ is surjective
as $(f, f')$ is a strict morphism of thickenings.
Hence the final statement is a consequence of (2).

\medskip\noindent
Proof of the equivalence of (1) and (2). We may check these conditions
at stalks. Let $x \in X \subset X'$
be a point with image $s = f(x) \in S \subset S'$.
Set $A' = \mathcal{O}_{S', s}$, $B' = \mathcal{O}_{X', x}$,
$A = \mathcal{O}_{S, s}$, and $B = \mathcal{O}_{X, x}$.
Then $A = A'/J$ and $B = B'/I$ for some square zero ideals.
Since $(f, f')$ is a strict morphism of thickenings we have $I = JB'$.
Let $M' = \mathcal{F}'_x$ and $M = \mathcal{F}_x$.
Then $M'$ is a $B'$-module and $M$ is a $B$-module.
Since $\mathcal{F} = i^*\mathcal{F}'$ we see that the kernel of the
surjection $M' \to M$ is $IM' = JM'$. Thus we have a short exact
sequence
$$
0 \to JM' \to M' \to M \to 0
$$
Using
Sheaves, Lemma \ref{sheaves-lemma-stalk-pullback-modules}
and
Modules, Lemma \ref{modules-lemma-stalk-tensor-product}
to identify stalks of pullbacks and tensor products we see
that the stalk at $x$ of the canonical map of the lemma is the map
$$
(J \otimes_A B) \otimes_B M = J \otimes_A M = J \otimes_{A'} M'
\longrightarrow JM'
$$
The assumption that $\mathcal{F}$ is flat over $S$ signifies that
$M$ is a flat $A$-module.

\medskip\noindent
Assume (1). Flatness implies $\text{Tor}_1^{A'}(M', A) = 0$ by
Algebra, Lemma \ref{algebra-lemma-characterize-flat}.
This means $J \otimes_{A'} M' \to M'$ is injective by
Algebra, Remark \ref{algebra-remark-Tor-ring-mod-ideal}.
Hence $J \otimes_A M \to JM'$ is an isomorphism.

\medskip\noindent
Assume (2). Then $J \otimes_{A'} M' \to M'$ is injective. Hence
$\text{Tor}_1^{A'}(M', A) = 0$ by
Algebra, Remark \ref{algebra-remark-Tor-ring-mod-ideal}.
Hence $M'$ is flat over $A'$ by
Algebra, Lemma \ref{algebra-lemma-what-does-it-mean}.
\end{proof}

\begin{lemma}
\label{lemma-inf-map-rel}
Let $(f, f')$ be a morphism of first order thickenings as in
Situation \ref{situation-morphism-thickenings}.
Let $\mathcal{F}'$, $\mathcal{G}'$ be $\mathcal{O}_{X'}$-modules and set
$\mathcal{F} = i^*\mathcal{F}'$ and $\mathcal{G} = i^*\mathcal{G}'$.
Let $\varphi : \mathcal{F} \to \mathcal{G}$ be an $\mathcal{O}_X$-linear map.
Assume that $\mathcal{G}'$ is flat over $S'$ and that
$(f, f')$ is a strict morphism of thickenings.
The set of lifts of $\varphi$ to an $\mathcal{O}_{X'}$-linear map
$\varphi' : \mathcal{F}' \to \mathcal{G}'$ is, if nonempty, a principal
homogenous space under
$$
\Hom_{\mathcal{O}_X}(\mathcal{F},
\mathcal{G} \otimes_{\mathcal{O}_X} f^*\mathcal{J})
$$
\end{lemma}

\begin{proof}
Combine Lemmas \ref{lemma-inf-map-special} and \ref{lemma-deform-module}.
\end{proof}

\begin{lemma}
\label{lemma-inf-obs-map-special}
Let $i : (X, \mathcal{O}_X) \to (X', \mathcal{O}_{X'})$
be a first order thickening of ringed spaces.
Let $\mathcal{F}'$, $\mathcal{G}'$ be $\mathcal{O}_{X'}$-modules and set
$\mathcal{F} = i^*\mathcal{F}'$ and $\mathcal{G} = i^*\mathcal{G}'$.
Let $\varphi : \mathcal{F} \to \mathcal{G}$ be an $\mathcal{O}_X$-linear map.
There exists an element
$$
o(\varphi) \in
\text{Ext}^1_{\mathcal{O}_X}(Li^*\mathcal{F}',
\mathcal{I}\mathcal{G}')
$$
whose vanishing is a necessary and sufficient condition for the
existence of a lift of $\varphi$ to an $\mathcal{O}_{X'}$-linear map
$\varphi' : \mathcal{F}' \to \mathcal{G}'$.
\end{lemma}

\begin{proof}
It is clear from the proof of Lemma \ref{lemma-inf-map-special} that the
vanishing of the boundary of $\varphi$ via the map
$$
\Hom_{\mathcal{O}_X}(\mathcal{F}, \mathcal{G}) =
\Hom_{\mathcal{O}_{X'}}(\mathcal{F}', \mathcal{G}) \longrightarrow
\text{Ext}^1_{\mathcal{O}_{X'}}(\mathcal{F}', \mathcal{I}\mathcal{G}')
$$
is a necessary and sufficient condition for the existence of a lift. We
conclude as
$$
\text{Ext}^1_{\mathcal{O}_{X'}}(\mathcal{F}', \mathcal{I}\mathcal{G}') =
\text{Ext}^1_{\mathcal{O}_X}(Li^*\mathcal{F}', \mathcal{I}\mathcal{G}')
$$
the adjointness of $i_* = Ri_*$ and $Li^*$ on the derived category
(Cohomology, Lemma \ref{cohomology-lemma-adjoint}).
\end{proof}

\begin{lemma}
\label{lemma-inf-obs-map-rel}
Let $(f, f')$ be a morphism of first
order thickenings as in Situation \ref{situation-morphism-thickenings}.
Let $\mathcal{F}'$, $\mathcal{G}'$ be $\mathcal{O}_{X'}$-modules and set
$\mathcal{F} = i^*\mathcal{F}'$ and $\mathcal{G} = i^*\mathcal{G}'$.
Let $\varphi : \mathcal{F} \to \mathcal{G}$ be an $\mathcal{O}_X$-linear map.
Assume that $\mathcal{F}'$ and $\mathcal{G}'$ are flat over $S'$ and
that $(f, f')$ is a strict morphism of thickenings. There exists an element
$$
o(\varphi) \in  \text{Ext}^1_{\mathcal{O}_X}(\mathcal{F},
\mathcal{G} \otimes_{\mathcal{O}_X} f^*\mathcal{J})
$$
whose vanishing is a necessary and sufficient condition for the
existence of a lift of $\varphi$ to an $\mathcal{O}_{X'}$-linear map
$\varphi' : \mathcal{F}' \to \mathcal{G}'$.
\end{lemma}

\begin{proof}[First proof]
This follows from Lemma \ref{lemma-inf-obs-map-special}
as we claim that under the assumptions of the lemma we have
$$
\text{Ext}^1_{\mathcal{O}_X}(Li^*\mathcal{F}',
\mathcal{I}\mathcal{G}') =
\text{Ext}^1_{\mathcal{O}_X}(\mathcal{F},
\mathcal{G} \otimes_{\mathcal{O}_X} f^*\mathcal{J})
$$
Namely, we have
$\mathcal{I}\mathcal{G}' =
\mathcal{G} \otimes_{\mathcal{O}_X} f^*\mathcal{J}$
by Lemma \ref{lemma-deform-module}.
On the other hand, observe that
$$
H^{-1}(Li^*\mathcal{F}') =
\text{Tor}_1^{\mathcal{O}_{X'}}(\mathcal{F}', \mathcal{O}_X)
$$
(local computation omitted). Using the short exact sequence
$$
0 \to \mathcal{I} \to \mathcal{O}_{X'} \to \mathcal{O}_X \to 0
$$
we see that this $\text{Tor}_1$ is computed by the kernel of the map
$\mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F} \to \mathcal{I}\mathcal{F}'$
which is zero by the final assertion of Lemma \ref{lemma-deform-module}.
Thus $\tau_{\geq -1}Li^*\mathcal{F}' = \mathcal{F}$.
On the other hand, we have
$$
\text{Ext}^1_{\mathcal{O}_X}(Li^*\mathcal{F}',
\mathcal{I}\mathcal{G}') =
\text{Ext}^1_{\mathcal{O}_X}(\tau_{\geq -1}Li^*\mathcal{F}',
\mathcal{I}\mathcal{G}')
$$
by the dual of
Derived Categories, Lemma \ref{derived-lemma-negative-vanishing}.
\end{proof}

\begin{proof}[Second proof]
We can apply Lemma \ref{lemma-inf-obs-map} as follows. Note that
$\mathcal{K} = \mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F}$ and
$\mathcal{L} = \mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{G}$
by Lemma \ref{lemma-deform-module}, that
$c_{\mathcal{F}'} = 1 \otimes 1$ and $c_{\mathcal{G}'} = 1 \otimes 1$
and taking $\psi = 1 \otimes \varphi$ the diagram of the lemma
commutes. Thus $o(\varphi) = o(\varphi, 1 \otimes \varphi)$
works.
\end{proof}

\begin{lemma}
\label{lemma-inf-ext-rel}
Let $(f, f')$ be a morphism of first order thickenings as in
Situation \ref{situation-morphism-thickenings}.
Let $\mathcal{F}$ be an $\mathcal{O}_X$-module.
Assume $(f, f')$ is a strict morphism of thickenings and
$\mathcal{F}$ flat over $S$. If there exists a pair
$(\mathcal{F}', \alpha)$ consisting of an
$\mathcal{O}_{X'}$-module $\mathcal{F}'$ flat over $S'$ and an isomorphism
$\alpha : i^*\mathcal{F}' \to \mathcal{F}$, then the set of
isomorphism classes of such pairs is principal homogeneous
under
$\text{Ext}^1_{\mathcal{O}_X}(
\mathcal{F}, \mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F})$.
\end{lemma}

\begin{proof}
If we assume there exists one such module, then the canonical map
$$
f^*\mathcal{J} \otimes_{\mathcal{O}_X} \mathcal{F} \to
\mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F}
$$
is an isomorphism by Lemma \ref{lemma-deform-module}. Apply
Lemma \ref{lemma-inf-ext} with $\mathcal{K} = 
\mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F}$
and $c = 1$. By Lemma \ref{lemma-deform-module} the corresponding extensions
$\mathcal{F}'$ are all flat over $S'$.
\end{proof}

\begin{lemma}
\label{lemma-inf-obs-ext-rel}
Let $(f, f')$ be a morphism of first order thickenings as in
Situation \ref{situation-morphism-thickenings}.
Let $\mathcal{F}$ be an $\mathcal{O}_X$-module. Assume
$(f, f')$ is a strict morphism of thickenings
and $\mathcal{F}$ flat over $S$. There exists an
$\mathcal{O}_{X'}$-module $\mathcal{F}'$ flat over $S'$ with
$i^*\mathcal{F}' \cong \mathcal{F}$, if and only if
\begin{enumerate}
\item the canonical map $
f^*\mathcal{J} \otimes_{\mathcal{O}_X} \mathcal{F} \to
\mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F}$
is an isomorphism, and
\item the class
$o(\mathcal{F}, \mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F}, 1)
\in \text{Ext}^2_{\mathcal{O}_X}(
\mathcal{F}, \mathcal{I} \otimes_{\mathcal{O}_X} \mathcal{F})$
of Lemma \ref{lemma-inf-obs-ext} is zero.
\end{enumerate}
\end{lemma}

\begin{proof}
This folllows immediately from the characterization of
$\mathcal{O}_{X'}$-modules flat over $S'$ of 
Lemma \ref{lemma-deform-module} and
Lemma \ref{lemma-inf-obs-ext}.
\end{proof}






\section{Thickenings of ringed topoi}
\label{section-thickenings-ringed-topoi}

\noindent
This section is the analogue of Section \ref{section-thickenings-spaces}
for ringed topoi.
In the following few sections we will use the following notions:
\begin{enumerate}
\item A sheaf of ideals $\mathcal{I} \subset \mathcal{O}'$ on
a ringed topos $(\Sh(\mathcal{D}), \mathcal{O}')$ is {\it locally nilpotent}
if any local section of $\mathcal{I}$ is locally nilpotent.
\item A {\it thickening} of ringed topoi is a morphism
$i : (\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}), \mathcal{O}')$
of ringed topoi such that
\begin{enumerate}
\item $i_*$ is an equivalence $\Sh(\mathcal{C}) \to \Sh(\mathcal{D})$,
\item the map $i^\sharp : \mathcal{O}' \to i_*\mathcal{O}$
is surjective, and
\item the kernel of $i^\sharp$ is a locally nilpotent sheaf of ideals.
\end{enumerate}
\item A {\it first order thickening} of ringed topoi is a thickening
$i : (\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}), \mathcal{O}')$
of ringed topoi such that $\text{Ker}(i^\sharp)$ has square zero.
\item It is clear how to define
{\it morphisms of thickenings of ringed topoi},
{\it morphisms of thickenings of ringed topoi over a base ringed topos}, etc.
\end{enumerate}
If
$i : (\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}), \mathcal{O}')$
is a thickening of ringed topoi then we identify the underlying topoi
and think of $\mathcal{O}$, $\mathcal{O}'$, and
$\mathcal{I} = \text{Ker}(i^\sharp)$ as sheaves on $\mathcal{C}$.
We obtain a short exact sequence
$$
0 \to \mathcal{I} \to \mathcal{O}' \to \mathcal{O} \to 0
$$
of $\mathcal{O}'$-modules. By
Modules on Sites, Lemma \ref{sites-modules-lemma-i-star-equivalence}
the category of $\mathcal{O}$-modules is equivalent to the category
of $\mathcal{O}'$-modules annihilated by $\mathcal{I}$. In particular,
if $i$ is a first order thickening, then
$\mathcal{I}$ is a $\mathcal{O}$-module.

\begin{situation}
\label{situation-morphism-thickenings-ringed-topoi}
A morphism of thickenings of ringed topoi $(f, f')$
is given by a commutative diagram
\begin{equation}
\label{equation-morphism-thickenings-ringed-topoi}
\vcenter{
\xymatrix{
(\Sh(\mathcal{C}), \mathcal{O}) \ar[r]_i \ar[d]_f &
(\Sh(\mathcal{D}), \mathcal{O}') \ar[d]^{f'} \\
(\Sh(\mathcal{B}), \mathcal{O}_\mathcal{B}) \ar[r]^t &
(\Sh(\mathcal{B}'), \mathcal{O}_{\mathcal{B}'})
}
}
\end{equation}
of ringed topoi whose horizontal arrows are thickenings. In this
situation we set
$\mathcal{I} = \text{Ker}(i^\sharp) \subset \mathcal{O}'$ and
$\mathcal{J} = \text{Ker}(t^\sharp) \subset \mathcal{O}_{\mathcal{B}'}$.
As $f = f'$ on underlying topoi we will identify
the pullback functors $f^{-1}$ and $(f')^{-1}$.
Observe that
$(f')^\sharp : f^{-1}\mathcal{O}_{\mathcal{B}'} \to \mathcal{O}'$
induces in particular a map $f^{-1}\mathcal{J} \to \mathcal{I}$
and therefore a map of $\mathcal{O}'$-modules
$$
(f')^*\mathcal{J} \longrightarrow \mathcal{I}
$$
If $i$ and $t$ are first order thickenings, then
$(f')^*\mathcal{J} = f^*\mathcal{J}$ and the map above becomes a
map $f^*\mathcal{J} \to \mathcal{I}$.
\end{situation}

\begin{definition}
\label{definition-strict-morphism-thickenings-ringed-topoi}
In Situation \ref{situation-morphism-thickenings-ringed-topoi}
we say that $(f, f')$ is a {\it strict morphism of thickenings}
if the map $(f')^*\mathcal{J} \longrightarrow \mathcal{I}$ is surjective.
\end{definition}








\section{Modules on first order thickenings of ringed topoi}
\label{section-modules-thickenings-ringed-topoi}

\noindent
In this section we discuss some preliminaries to the deformation theory
of modules. Let
$i : (\Sh(\mathcal{C}, \mathcal{O}) \to (\Sh(\mathcal{D}), \mathcal{O}')$
be a first order thickening of ringed topoi. We will freely use the notation
introduced in Section \ref{section-thickenings-ringed-topoi},
in particular we will identify the underlying topological topoi.
In this section we consider short exact sequences
\begin{equation}
\label{equation-extension-ringed-topoi}
0 \to \mathcal{K} \to \mathcal{F}' \to \mathcal{F} \to 0
\end{equation}
of $\mathcal{O}'$-modules, where $\mathcal{F}$, $\mathcal{K}$ are
$\mathcal{O}$-modules and $\mathcal{F}'$ is an $\mathcal{O}'$-module.
In this situation we have a canonical $\mathcal{O}$-module map
$$
c_{\mathcal{F}'} :
\mathcal{I} \otimes_\mathcal{O} \mathcal{F}
\longrightarrow
\mathcal{K}
$$
where $\mathcal{I} = \text{Ker}(i^\sharp)$.
Namely, given local sections $f$ of $\mathcal{I}$ and $s$
of $\mathcal{F}$ we set $c_{\mathcal{F}'}(f \otimes s) = fs'$
where $s'$ is a local section of $\mathcal{F}'$ lifting $s$.

\begin{lemma}
\label{lemma-inf-map-ringed-topoi}
Let $i : (\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}), \mathcal{O}')$
be a first order thickening of ringed topoi. Assume given
extensions
$$
0 \to \mathcal{K} \to \mathcal{F}' \to \mathcal{F} \to 0
\quad\text{and}\quad
0 \to \mathcal{L} \to \mathcal{G}' \to \mathcal{G} \to 0
$$
as in (\ref{equation-extension-ringed-topoi})
and maps $\varphi : \mathcal{F} \to \mathcal{G}$ and
$\psi : \mathcal{K} \to \mathcal{L}$.
\begin{enumerate}
\item If there exists an $\mathcal{O}'$-module
map $\varphi' : \mathcal{F}' \to \mathcal{G}'$ compatible with $\varphi$
and $\psi$, then the diagram
$$
\xymatrix{
\mathcal{I} \otimes_\mathcal{O} \mathcal{F}
\ar[r]_-{c_{\mathcal{F}'}} \ar[d]_{1 \otimes \varphi} &
\mathcal{K} \ar[d]^\psi \\
\mathcal{I} \otimes_\mathcal{O} \mathcal{G}
\ar[r]^-{c_{\mathcal{G}'}} &
\mathcal{L}
}
$$
is commutative.
\item The set of $\mathcal{O}'$-module
maps $\varphi' : \mathcal{F}' \to \mathcal{G}'$ compatible with $\varphi$
and $\psi$ is, if nonempty, a principal homogenous space under
$\Hom_\mathcal{O}(\mathcal{F}, \mathcal{L})$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) is immediate from the description of the maps.
For (2), if $\varphi'$ and $\varphi''$ are two maps
$\mathcal{F}' \to \mathcal{G}'$ compatible with $\varphi$
and $\psi$, then $\varphi' - \varphi''$ factors as
$$
\mathcal{F}' \to \mathcal{F} \to \mathcal{L} \to \mathcal{G}'
$$
The map in the middle comes from a unique element of
$\Hom_\mathcal{O}(\mathcal{F}, \mathcal{L})$ by
Modules on Sites, Lemma \ref{sites-modules-lemma-i-star-equivalence}.
Conversely, given an element $\alpha$ of this group we can add the
composition (as displayed above with $\alpha$ in the middle)
to $\varphi'$. Some details omitted.
\end{proof}

\begin{lemma}
\label{lemma-inf-obs-map-ringed-topoi}
Let $i : (\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}), \mathcal{O}')$
be a first order thickening of ringed topoi. Assume given extensions
$$
0 \to \mathcal{K} \to \mathcal{F}' \to \mathcal{F} \to 0
\quad\text{and}\quad
0 \to \mathcal{L} \to \mathcal{G}' \to \mathcal{G} \to 0
$$
as in (\ref{equation-extension-ringed-topoi})
and maps $\varphi : \mathcal{F} \to \mathcal{G}$ and
$\psi : \mathcal{K} \to \mathcal{L}$. Assume the diagram
$$
\xymatrix{
\mathcal{I} \otimes_\mathcal{O} \mathcal{F}
\ar[r]_-{c_{\mathcal{F}'}} \ar[d]_{1 \otimes \varphi} &
\mathcal{K} \ar[d]^\psi \\
\mathcal{I} \otimes_\mathcal{O} \mathcal{G}
\ar[r]^-{c_{\mathcal{G}'}} &
\mathcal{L}
}
$$
is commutative. Then there exists an element
$$
o(\varphi, \psi) \in
\text{Ext}^1_\mathcal{O}(\mathcal{F}, \mathcal{L})
$$
whose vanishing is a necessary and sufficient condition for the existence
of a map $\varphi' : \mathcal{F}' \to \mathcal{G}'$ compatible with
$\varphi$ and $\psi$.
\end{lemma}

\begin{proof}
We can construct explicitly an extension
$$
0 \to \mathcal{L} \to \mathcal{H} \to \mathcal{F} \to 0
$$
by taking $\mathcal{H}$ to be the cohomology of the complex
$$
\mathcal{K}
\xrightarrow{1, - \psi}
\mathcal{F}' \oplus \mathcal{G}' \xrightarrow{\varphi, 1}
\mathcal{G}
$$
in the middle (with obvious notation). A calculation with local sections
using the assumption that the diagram of the lemma commutes
shows that $\mathcal{H}$ is annihilated by $\mathcal{I}$. Hence
$\mathcal{H}$ defines a class in
$$
\text{Ext}^1_\mathcal{O}(\mathcal{F}, \mathcal{L})
\subset
\text{Ext}^1_{\mathcal{O}'}(\mathcal{F}, \mathcal{L})
$$
Finally, the class of $\mathcal{H}$ is the difference of the pushout
of the extension $\mathcal{F}'$ via $\psi$ and the pullback
of the extension $\mathcal{G}'$ via $\varphi$ (calculations omitted).
Thus the vanishing of the class of $\mathcal{H}$ is equivalent to the
existence of a commutative diagram
$$
\xymatrix{
0 \ar[r] &
\mathcal{K} \ar[r] \ar[d]_{\psi} &
\mathcal{F}' \ar[r] \ar[d]_{\varphi'} &
\mathcal{F} \ar[r] \ar[d]_\varphi & 0\\
0 \ar[r] &
\mathcal{L} \ar[r] &
\mathcal{G}' \ar[r] &
\mathcal{G} \ar[r] & 0
}
$$
as desired.
\end{proof}

\begin{lemma}
\label{lemma-inf-ext-ringed-topoi}
Let $i : (\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}), \mathcal{O}')$
be a first order thickening of ringed topoi. Assume given
$\mathcal{O}$-modules $\mathcal{F}$, $\mathcal{K}$
and an $\mathcal{O}$-linear map
$c : \mathcal{I} \otimes_\mathcal{O} \mathcal{F} \to \mathcal{K}$.
If there exists a sequence (\ref{equation-extension-ringed-topoi}) with
$c_{\mathcal{F}'} = c$ then the set of isomorphism classes of these
extensions is principal homogeneous under
$\text{Ext}^1_\mathcal{O}(\mathcal{F}, \mathcal{K})$.
\end{lemma}

\begin{proof}
Assume given extensions
$$
0 \to \mathcal{K} \to \mathcal{F}'_1 \to \mathcal{F} \to 0
\quad\text{and}\quad
0 \to \mathcal{K} \to \mathcal{F}'_2 \to \mathcal{F} \to 0
$$
with $c_{\mathcal{F}'_1} = c_{\mathcal{F}'_2} = c$. Then the difference
(in the extension group, see
Homology, Section \ref{homology-section-extensions})
is an extension
$$
0 \to \mathcal{K} \to \mathcal{E} \to \mathcal{F} \to 0
$$
where $\mathcal{E}$ is annihilated by $\mathcal{I}$ (local computation
omitted). Hence the sequence is an extension of $\mathcal{O}$-modules,
see Modules on Sites, Lemma \ref{sites-modules-lemma-i-star-equivalence}.
Conversely, given such an extension $\mathcal{E}$ we can add the extension
$\mathcal{E}$ to the $\mathcal{O}'$-extension $\mathcal{F}'$ without
affecting the map $c_{\mathcal{F}'}$. Some details omitted.
\end{proof}

\begin{lemma}
\label{lemma-inf-obs-ext-ringed-topoi}
Let $i : (\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}), \mathcal{O}')$
be a first order thickening of ringed topoi. Assume given
$\mathcal{O}$-modules $\mathcal{F}$, $\mathcal{K}$
and an $\mathcal{O}$-linear map
$c : \mathcal{I} \otimes_\mathcal{O} \mathcal{F} \to \mathcal{K}$.
Then there exists an element
$$
o(\mathcal{F}, \mathcal{K}, c) \in
\text{Ext}^2_\mathcal{O}(\mathcal{F}, \mathcal{K})
$$
whose vanishing is a necessary and sufficient condition for the existence
of a sequence (\ref{equation-extension-ringed-topoi})
with $c_{\mathcal{F}'} = c$.
\end{lemma}

\begin{proof}
We first show that if $\mathcal{K}$ is an injective $\mathcal{O}$-module,
then there does exist a sequence (\ref{equation-extension-ringed-topoi}) with
$c_{\mathcal{F}'} = c$. To do this, choose a flat
$\mathcal{O}'$-module $\mathcal{H}'$ and a surjection
$\mathcal{H}' \to \mathcal{F}$
(Modules on Sites, Lemma \ref{sites-modules-lemma-module-quotient-flat}).
Let $\mathcal{J} \subset \mathcal{H}'$ be the kernel. Since $\mathcal{H}'$
is flat we have
$$
\mathcal{I} \otimes_{\mathcal{O}'} \mathcal{H}' =
\mathcal{I}\mathcal{H}'
\subset \mathcal{J} \subset \mathcal{H}'
$$
Observe that the map
$$
\mathcal{I}\mathcal{H}' =
\mathcal{I} \otimes_{\mathcal{O}'} \mathcal{H}'
\longrightarrow
\mathcal{I} \otimes_{\mathcal{O}'} \mathcal{F} =
\mathcal{I} \otimes_\mathcal{O} \mathcal{F}
$$
annihilates $\mathcal{I}\mathcal{J}$. Namely, if $f$ is a local section
of $\mathcal{I}$ and $s$ is a local section of $\mathcal{H}$, then
$fs$ is mapped to $f \otimes \overline{s}$ where $\overline{s}$ is
the image of $s$ in $\mathcal{F}$. Thus we obtain
$$
\xymatrix{
\mathcal{I}\mathcal{H}'/\mathcal{I}\mathcal{J}
\ar@{^{(}->}[r] \ar[d] &
\mathcal{J}/\mathcal{I}\mathcal{J} \ar@{..>}[d]_\gamma \\
\mathcal{I} \otimes_\mathcal{O} \mathcal{F} \ar[r]^-c &
\mathcal{K}
}
$$
a diagram of $\mathcal{O}$-modules. If $\mathcal{K}$ is injective
as an $\mathcal{O}$-module, then we obtain the dotted arrow.
Denote $\gamma' : \mathcal{J} \to \mathcal{K}$ the composition
of $\gamma$ with $\mathcal{J} \to \mathcal{J}/\mathcal{I}\mathcal{J}$.
A local calculation shows the pushout
$$
\xymatrix{
0 \ar[r] &
\mathcal{J} \ar[r] \ar[d]_{\gamma'} &
\mathcal{H}' \ar[r] \ar[d] &
\mathcal{F} \ar[r] \ar@{=}[d] &
0 \\
0 \ar[r] &
\mathcal{K} \ar[r] &
\mathcal{F}' \ar[r] &
\mathcal{F} \ar[r] &
0
}
$$
is a solution to the problem posed by the lemma.

\medskip\noindent
General case. Choose an embedding $\mathcal{K} \subset \mathcal{K}'$
with $\mathcal{K}'$ an injective $\mathcal{O}$-module. Let $\mathcal{Q}$
be the quotient, so that we have an exact sequence
$$
0 \to \mathcal{K} \to \mathcal{K}' \to \mathcal{Q} \to 0
$$
Denote
$c' : \mathcal{I} \otimes_\mathcal{O} \mathcal{F} \to \mathcal{K}'$
be the composition. By the paragraph above there exists a sequence
$$
0 \to \mathcal{K}' \to \mathcal{E}' \to \mathcal{F} \to 0
$$
as in (\ref{equation-extension-ringed-topoi}) with $c_{\mathcal{E}'} = c'$.
Note that $c'$ composed with the map $\mathcal{K}' \to \mathcal{Q}$
is zero, hence the pushout of $\mathcal{E}'$ by
$\mathcal{K}' \to \mathcal{Q}$ is an extension
$$
0 \to \mathcal{Q} \to \mathcal{D}' \to \mathcal{F} \to 0
$$
as in (\ref{equation-extension-ringed-topoi}) with $c_{\mathcal{D}'} = 0$.
This means exactly that $\mathcal{D}'$ is annihilated by
$\mathcal{I}$, in other words, the $\mathcal{D}'$ is an extension
of $\mathcal{O}$-modules, i.e., defines an element
$$
o(\mathcal{F}, \mathcal{K}, c) \in
\text{Ext}^1_\mathcal{O}(\mathcal{F}, \mathcal{Q}) =
\text{Ext}^2_\mathcal{O}(\mathcal{F}, \mathcal{K})
$$
(the equality holds by the long exact cohomology sequence associated
to the exact sequence above and the vanishing of higher ext groups
into the injective module $\mathcal{K}'$). If
$o(\mathcal{F}, \mathcal{K}, c) = 0$, then we can choose a splitting
$s : \mathcal{F} \to \mathcal{D}'$ and we can set
$$
\mathcal{F}' = \text{Ker}(\mathcal{E}' \to \mathcal{D}'/s(\mathcal{F}))
$$
so that we obtain the following diagram
$$
\xymatrix{
0 \ar[r] &
\mathcal{K} \ar[r] \ar[d] &
\mathcal{F}' \ar[r] \ar[d] &
\mathcal{F} \ar[r] \ar@{=}[d] &
0 \\
0 \ar[r] &
\mathcal{K}' \ar[r] &
\mathcal{E}' \ar[r] &
\mathcal{F} \ar[r] & 0
}
$$
with exact rows which shows that $c_{\mathcal{F}'} = c$. Conversely, if
$\mathcal{F}'$ exists, then the pushout of $\mathcal{F}'$ by the map
$\mathcal{K} \to \mathcal{K}'$ is isomorphic to $\mathcal{E}'$ by
Lemma \ref{lemma-inf-ext-ringed-topoi} and the vanishing of higher ext groups
into the injective module $\mathcal{K}'$. This gives a diagram
as above, which implies that $\mathcal{D}'$ is split as an extension, i.e.,
the class $o(\mathcal{F}, \mathcal{K}, c)$ is zero.
\end{proof}

\begin{remark}
\label{remark-trivial-thickening-ringed-topoi}
Let $(\Sh(\mathcal{C}), \mathcal{O})$ be a ringed topos. A first order
thickening $i : (\Sh(\mathcal{C}), \mathcal{O}) \to
(\Sh(\mathcal{D}), \mathcal{O}')$ is said
to be {\it trivial} if there exists a morphism of ringed topoi
$\pi : (\Sh(\mathcal{D}), \mathcal{O}') \to (\Sh(\mathcal{C}), \mathcal{O})$
which is a left inverse to $i$. The choice of such a morphism
$\pi$ is called a {\it trivialization} of the first order thickening.
Given $\pi$ we obtain a splitting
\begin{equation}
\label{equation-splitting-ringed-topoi}
\mathcal{O}' = \mathcal{O} \oplus \mathcal{I}
\end{equation}
as sheaves of algebras on $\mathcal{C}$ by using $\pi^\sharp$
to split the surjection $\mathcal{O}' \to \mathcal{O}$.
Conversely, such a splitting determines
a morphism $\pi$. The category of trivialized first order thickenings of
$(\Sh(\mathcal{C}), \mathcal{O})$ is equivalent to the category of 
$\mathcal{O}$-modules.
\end{remark}

\begin{remark}
\label{remark-trivial-extension-ringed-topoi}
Let $i : (\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}), \mathcal{O}')$
be a trivial first order thickening of ringed topoi
and let $\pi : (\Sh(\mathcal{D}), \mathcal{O}') \to
(\Sh(\mathcal{C}), \mathcal{O})$ be a trivialization. Then given any triple
$(\mathcal{F}, \mathcal{K}, c)$ consisting of a pair of
$\mathcal{O}$-modules and a map
$c : \mathcal{I} \otimes_\mathcal{O} \mathcal{F} \to \mathcal{K}$
we may set
$$
\mathcal{F}'_{c, triv} = \mathcal{F} \oplus \mathcal{K}
$$
and use the splitting (\ref{equation-splitting-ringed-topoi})
associated to $\pi$ and the map $c$ to define the $\mathcal{O}'$-module
structure and obtain an extension (\ref{equation-extension-ringed-topoi}).
We will call $\mathcal{F}'_{c, triv}$ the {\it trivial extension} of
$\mathcal{F}$ by $\mathcal{K}$ corresponding
to $c$ and the trivialization $\pi$. Given any extension
$\mathcal{F}'$ as in (\ref{equation-extension-ringed-topoi}) we can use
$\pi^\sharp : \mathcal{O} \to \mathcal{O}'$ to think of $\mathcal{F}'$
as an $\mathcal{O}$-module extension, hence a class $\xi_{\mathcal{F}'}$
in $\text{Ext}^1_\mathcal{O}(\mathcal{F}, \mathcal{K})$.
Lemma \ref{lemma-inf-ext-ringed-topoi} assures that
$\mathcal{F}' \mapsto \xi_{\mathcal{F}'}$
induces a bijection
$$
\left\{
\begin{matrix}
\text{isomorphism classes of extensions}\\
\mathcal{F}'\text{ as in (\ref{equation-extension-ringed-topoi}) with }
c = c_{\mathcal{F}'}
\end{matrix}
\right\}
\longrightarrow
\text{Ext}^1_\mathcal{O}(\mathcal{F}, \mathcal{K})
$$
Moreover, the trivial extension $\mathcal{F}'_{c, triv}$ maps to the zero class.
\end{remark}

\begin{remark}
\label{remark-extension-functorial-ringed-topoi}
Let $(\Sh(\mathcal{C}), \mathcal{O})$ be a ringed topos. Let
$(\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}_i), \mathcal{O}'_i)$,
$i = 1, 2$ be first order thickenings with ideal sheaves $\mathcal{I}_i$.
Let $h : (\Sh(\mathcal{D}_1), \mathcal{O}'_1) \to
(\Sh(\mathcal{D}_2), \mathcal{O}'_2)$
be a morphism of first order thickenings of $(\Sh(\mathcal{C}), \mathcal{O})$.
Picture
$$
\xymatrix{
& (\Sh(\mathcal{C}), \mathcal{O}) \ar[ld] \ar[rd] & \\
(\Sh(\mathcal{D}_1), \mathcal{O}'_1) \ar[rr]^h & & 
(\Sh(\mathcal{D}_2), \mathcal{O}'_2)
}
$$
Observe that $h^\sharp : \mathcal{O}'_2 \to \mathcal{O}'_1$
in particular induces an $\mathcal{O}$-module map
$\mathcal{I}_2 \to \mathcal{I}_1$.
Let $\mathcal{F}$ be an $\mathcal{O}$-module.
Let $(\mathcal{K}_i, c_i)$, $i = 1, 2$ be a pair
consisting of an $\mathcal{O}$-module $\mathcal{K}_i$ and a map
$c_i : \mathcal{I}_i \otimes_\mathcal{O} \mathcal{F} \to
\mathcal{K}_i$. Assume furthermore given a map
of $\mathcal{O}$-modules $\mathcal{K}_2 \to \mathcal{K}_1$
such that
$$
\xymatrix{
\mathcal{I}_2 \otimes_\mathcal{O} \mathcal{F}
\ar[r]_-{c_2} \ar[d] &
\mathcal{K}_2 \ar[d] \\
\mathcal{I}_1 \otimes_\mathcal{O} \mathcal{F}
\ar[r]^-{c_1} &
\mathcal{K}_1
}
$$
is commutative. Then there is a canonical functoriality
$$
\left\{
\begin{matrix}
\mathcal{F}'_2\text{ as in (\ref{equation-extension-ringed-topoi}) with }\\
c_2 = c_{\mathcal{F}'_2}\text{ and }\mathcal{K} = \mathcal{K}_2
\end{matrix}
\right\}
\longrightarrow
\left\{
\begin{matrix}
\mathcal{F}'_1\text{ as in (\ref{equation-extension-ringed-topoi}) with }\\
c_1 = c_{\mathcal{F}'_1}\text{ and }\mathcal{K} = \mathcal{K}_1
\end{matrix}
\right\}
$$
Namely, thinking of all sheaves $\mathcal{O}$, $\mathcal{O}'_i$,
$\mathcal{F}$, $\mathcal{K}_i$, etc as sheaves on $\mathcal{C}$, we set
given $\mathcal{F}'_2$ the sheaf $\mathcal{F}'_1$ equal to the
pushout, i.e., fitting into the following diagram of extensions
$$
\xymatrix{
0 \ar[r] &
\mathcal{K}_2 \ar[r] \ar[d] &
\mathcal{F}'_2 \ar[r] \ar[d] &
\mathcal{F} \ar@{=}[d] \ar[r] & 0 \\
0 \ar[r] &
\mathcal{K}_1 \ar[r] &
\mathcal{F}'_1 \ar[r] &
\mathcal{F} \ar[r] & 0
}
$$
We omit the construction of the $\mathcal{O}'_1$-module structure
on the pushout (this uses the commutativity of the diagram
involving $c_1$ and $c_2$).
\end{remark}

\begin{remark}
\label{remark-trivial-extension-functorial-ringed-topoi}
Let $(\Sh(\mathcal{C}), \mathcal{O})$,
$(\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}_i), \mathcal{O}'_i)$,
$\mathcal{I}_i$, and $h : (\Sh(\mathcal{D}_1), \mathcal{O}'_1) \to
(\Sh(\mathcal{D}_2), \mathcal{O}'_2)$ be as in
Remark \ref{remark-extension-functorial-ringed-topoi}.
Assume that we are given given trivializations
$\pi_i : (\Sh(\mathcal{D}_i), \mathcal{O}'_i) \to
(\Sh(\mathcal{C}), \mathcal{O})$ such that
$\pi_1 = h \circ \pi_2$. In other words, assume $h$ is a morphism
of trivialized first order thickenings of $(\Sh(\mathcal{C}), \mathcal{O})$.
Let $(\mathcal{K}_i, c_i)$, $i = 1, 2$ be a pair consisting of an
$\mathcal{O}$-module $\mathcal{K}_i$ and a map
$c_i : \mathcal{I}_i \otimes_\mathcal{O} \mathcal{F} \to
\mathcal{K}_i$. Assume furthermore given a map
of $\mathcal{O}$-modules $\mathcal{K}_2 \to \mathcal{K}_1$
such that
$$
\xymatrix{
\mathcal{I}_2 \otimes_\mathcal{O} \mathcal{F}
\ar[r]_-{c_2} \ar[d] &
\mathcal{K}_2 \ar[d] \\
\mathcal{I}_1 \otimes_\mathcal{O} \mathcal{F}
\ar[r]^-{c_1} &
\mathcal{K}_1
}
$$
is commutative. In this situation the construction of
Remark \ref{remark-trivial-extension-ringed-topoi} induces
a commutative diagram
$$
\xymatrix{
\{\mathcal{F}'_2\text{ as in (\ref{equation-extension-ringed-topoi}) with }
c_2 = c_{\mathcal{F}'_2}\text{ and }\mathcal{K} = \mathcal{K}_2\}
\ar[d] \ar[rr] & &
\text{Ext}^1_\mathcal{O}(\mathcal{F}, \mathcal{K}_2) \ar[d] \\
\{\mathcal{F}'_1\text{ as in (\ref{equation-extension-ringed-topoi}) with }
c_1 = c_{\mathcal{F}'_1}\text{ and }\mathcal{K} = \mathcal{K}_1\}
\ar[rr] & &
\text{Ext}^1_\mathcal{O}(\mathcal{F}, \mathcal{K}_1)
}
$$
where the vertical map on the right is given by functoriality of $\text{Ext}$
and the map $\mathcal{K}_2 \to \mathcal{K}_1$ and the vertical map on the left
is the one from Remark \ref{remark-extension-functorial-ringed-topoi}.
\end{remark}

\begin{remark}
\label{remark-short-exact-sequence-thickenings-ringed-topoi}
Let $(\Sh(\mathcal{C}), \mathcal{O})$ be a ringed topos.
We define a sequence of morphisms of first order thickenings
$$
(\Sh(\mathcal{D}_1), \mathcal{O}'_1) \to
(\Sh(\mathcal{D}_2), \mathcal{O}'_2) \to
(\Sh(\mathcal{D}_3), \mathcal{O}'_3)
$$
of $(\Sh(\mathcal{C}), \mathcal{O})$ to be a {\it complex}
if the corresponding maps between
the ideal sheaves $\mathcal{I}_i$
give a complex of $\mathcal{O}$-modules
$\mathcal{I}_3 \to \mathcal{I}_2 \to \mathcal{I}_1$
(i.e., the composition is zero). In this case the composition
$(\Sh(\mathcal{D}_1), \mathcal{O}'_1) \to
(\Sh(\mathcal{D}_3), \mathcal{O}'_3)$ factors through
$(\Sh(\mathcal{C}), \mathcal{O}) \to
(\Sh(\mathcal{D}_3), \mathcal{O}'_3)$, i.e.,
the first order thickening
$(\Sh(\mathcal{D}_1), \mathcal{O}'_1)$ of
$(\Sh(\mathcal{C}), \mathcal{O})$ is trivial and comes with
a canonical trivialization
$\pi : (\Sh(\mathcal{D}_1), \mathcal{O}'_1) \to
(\Sh(\mathcal{C}), \mathcal{O})$.

\medskip\noindent
We say a sequence of morphisms of first order thickenings
$$
(\Sh(\mathcal{D}_1), \mathcal{O}'_1) \to
(\Sh(\mathcal{D}_2), \mathcal{O}'_2) \to
(\Sh(\mathcal{D}_3), \mathcal{O}'_3)
$$
of $(\Sh(\mathcal{C}), \mathcal{O})$ is {\it a short exact sequence} if the
corresponding maps between ideal sheaves is a short exact sequence
$$
0 \to \mathcal{I}_3 \to \mathcal{I}_2 \to \mathcal{I}_1 \to 0
$$
of $\mathcal{O}$-modules.
\end{remark}

\begin{remark}
\label{remark-complex-thickenings-and-ses-modules-ringed-topoi}
Let $(\Sh(\mathcal{C}), \mathcal{O})$ be a ringed topos.
Let $\mathcal{F}$ be an $\mathcal{O}$-module. Let
$$
(\Sh(\mathcal{D}_1), \mathcal{O}'_1) \to
(\Sh(\mathcal{D}_2), \mathcal{O}'_2) \to
(\Sh(\mathcal{D}_3), \mathcal{O}'_3)
$$
be a complex first order thickenings of $(\Sh(\mathcal{C}), \mathcal{O})$, see
Remark \ref{remark-short-exact-sequence-thickenings-ringed-topoi}.
Let $(\mathcal{K}_i, c_i)$, $i = 1, 2, 3$ be pairs consisting of
an $\mathcal{O}$-module $\mathcal{K}_i$ and a map
$c_i : \mathcal{I}_i \otimes_\mathcal{O} \mathcal{F} \to
\mathcal{K}_i$. Assume given a short exact sequence
of $\mathcal{O}$-modules
$$
0 \to \mathcal{K}_3 \to \mathcal{K}_2 \to \mathcal{K}_1 \to 0
$$
such that
$$
\vcenter{
\xymatrix{
\mathcal{I}_2 \otimes_\mathcal{O} \mathcal{F}
\ar[r]_-{c_2} \ar[d] &
\mathcal{K}_2 \ar[d] \\
\mathcal{I}_1 \otimes_\mathcal{O} \mathcal{F}
\ar[r]^-{c_1} &
\mathcal{K}_1
}
}
\quad\text{and}\quad
\vcenter{
\xymatrix{
\mathcal{I}_3 \otimes_\mathcal{O} \mathcal{F}
\ar[r]_-{c_3} \ar[d] &
\mathcal{K}_3 \ar[d] \\
\mathcal{I}_2 \otimes_\mathcal{O} \mathcal{F}
\ar[r]^-{c_2} &
\mathcal{K}_2
}
}
$$
are commutative. Finally, assume given an extension
$$
0 \to \mathcal{K}_2 \to \mathcal{F}'_2 \to \mathcal{F} \to 0
$$
as in (\ref{equation-extension-ringed-topoi})
with $\mathcal{K} = \mathcal{K}_2$
of $\mathcal{O}'_2$-modules with $c_{\mathcal{F}'_2} = c_2$.
In this situation we can apply the functoriality of
Remark \ref{remark-extension-functorial-ringed-topoi}
to obtain an extension $\mathcal{F}'_1$ of $\mathcal{O}'_1$-modules
(we'll describe $\mathcal{F}'_1$ in this special case below). By
Remark \ref{remark-trivial-extension-ringed-topoi}
using the canonical splitting
$\pi : (\Sh(\mathcal{D}_1), \mathcal{O}'_1) \to
(\Sh(\mathcal{C}), \mathcal{O})$ of
Remark \ref{remark-short-exact-sequence-thickenings-ringed-topoi}
we obtain
$\xi_{\mathcal{F}'_1} \in
\text{Ext}^1_\mathcal{O}(\mathcal{F}, \mathcal{K}_1)$.
Finally, we have the obstruction
$$
o(\mathcal{F}, \mathcal{K}_3, c_3) \in
\text{Ext}^2_\mathcal{O}(\mathcal{F}, \mathcal{K}_3)
$$
see Lemma \ref{lemma-inf-obs-ext-ringed-topoi}.
In this situation we {\bf claim} that the canonical map
$$
\partial :
\text{Ext}^1_\mathcal{O}(\mathcal{F}, \mathcal{K}_1)
\longrightarrow
\text{Ext}^2_\mathcal{O}(\mathcal{F}, \mathcal{K}_3)
$$
coming from the short exact sequence
$0 \to \mathcal{K}_3 \to \mathcal{K}_2 \to \mathcal{K}_1 \to 0$
sends $\xi_{\mathcal{F}'_1}$
to the obstruction class $o(\mathcal{F}, \mathcal{K}_3, c_3)$.

\medskip\noindent
To prove this claim choose an embedding $j : \mathcal{K}_3 \to \mathcal{K}$
where $\mathcal{K}$ is an injective $\mathcal{O}$-module.
We can lift $j$ to a map $j' : \mathcal{K}_2 \to \mathcal{K}$.
Set $\mathcal{E}'_2 = j'_*\mathcal{F}'_2$ equal to the pushout
of $\mathcal{F}'_2$ by $j'$ so that $c_{\mathcal{E}'_2} = j' \circ c_2$.
Picture:
$$
\xymatrix{
0 \ar[r] &
\mathcal{K}_2 \ar[r] \ar[d]_{j'} &
\mathcal{F}'_2 \ar[r] \ar[d] &
\mathcal{F} \ar[r] \ar[d] & 0 \\
0 \ar[r] &
\mathcal{K} \ar[r] &
\mathcal{E}'_2 \ar[r] &
\mathcal{F} \ar[r] & 0
}
$$
Set $\mathcal{E}'_3 = \mathcal{E}'_2$ but viewed as an
$\mathcal{O}'_3$-module via $\mathcal{O}'_3 \to \mathcal{O}'_2$.
Then $c_{\mathcal{E}'_3} = j \circ c_3$.
The proof of Lemma \ref{lemma-inf-obs-ext-ringed-topoi} constructs
$o(\mathcal{F}, \mathcal{K}_3, c_3)$
as the boundary of the class of the extension of $\mathcal{O}$-modules
$$
0 \to
\mathcal{K}/\mathcal{K}_3 \to
\mathcal{E}'_3/\mathcal{K}_3 \to
\mathcal{F} \to 0
$$
On the other hand, note that $\mathcal{F}'_1 = \mathcal{F}'_2/\mathcal{K}_3$
hence the class $\xi_{\mathcal{F}'_1}$ is the class
of the extension
$$
0 \to \mathcal{K}_2/\mathcal{K}_3 \to \mathcal{F}'_2/\mathcal{K}_3
\to \mathcal{F} \to 0
$$
seen as a sequence of $\mathcal{O}$-modules using $\pi^\sharp$
where $\pi : (\Sh(\mathcal{D}_1), \mathcal{O}'_1) \to
(\Sh(\mathcal{C}), \mathcal{O})$ is the canonical splitting.
Thus finally, the claim follows from the fact that we have
a commutative diagram
$$
\xymatrix{
0 \ar[r] &
\mathcal{K}_2/\mathcal{K}_3 \ar[r] \ar[d] &
\mathcal{F}'_2/\mathcal{K}_3 \ar[r] \ar[d] &
\mathcal{F} \ar[r] \ar[d] & 0 \\
0 \ar[r] &
\mathcal{K}/\mathcal{K}_3 \ar[r] &
\mathcal{E}'_3/\mathcal{K}_3 \ar[r] &
\mathcal{F} \ar[r] & 0
}
$$
which is $\mathcal{O}$-linear (with the $\mathcal{O}$-module
structures given above).
\end{remark}







\section{Infinitesimal deformations of modules on ringed topi}
\label{section-deformation-modules-ringed-topoi}

\noindent
Let $i : (\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}), \mathcal{O}')$
be a first order thickening of ringed topoi. We freely use the notation
introduced in Section \ref{section-thickenings-ringed-topoi}.
Let $\mathcal{F}'$ be an $\mathcal{O}'$-module
and set $\mathcal{F} = i^*\mathcal{F}'$.
In this situation we have a short exact sequence
$$
0 \to \mathcal{I}\mathcal{F}' \to \mathcal{F}' \to \mathcal{F} \to 0
$$
of $\mathcal{O}'$-modules. Since $\mathcal{I}^2 = 0$ the
$\mathcal{O}'$-module structure on $\mathcal{I}\mathcal{F}'$
comes from a unique $\mathcal{O}$-module structure.
Thus the sequence above is an extension as in
(\ref{equation-extension-ringed-topoi}).
As a special case, if $\mathcal{F}' = \mathcal{O}'$ we have
$i^*\mathcal{O}' = \mathcal{O}$ and
$\mathcal{I}\mathcal{O}' = \mathcal{I}$ and we recover the
sequence of structure sheaves
$$
0 \to \mathcal{I} \to \mathcal{O}' \to \mathcal{O} \to 0
$$

\begin{lemma}
\label{lemma-inf-map-special-ringed-topoi}
Let $i : (\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}), \mathcal{O}')$
be a first order thickening of ringed topoi.
Let $\mathcal{F}'$, $\mathcal{G}'$ be $\mathcal{O}'$-modules.
Set $\mathcal{F} = i^*\mathcal{F}'$ and $\mathcal{G} = i^*\mathcal{G}'$.
Let $\varphi : \mathcal{F} \to \mathcal{G}$ be an $\mathcal{O}$-linear map.
The set of lifts of $\varphi$ to an $\mathcal{O}'$-linear map
$\varphi' : \mathcal{F}' \to \mathcal{G}'$ is, if nonempty, a principal
homogenous space under
$\Hom_\mathcal{O}(\mathcal{F}, \mathcal{I}\mathcal{G}')$.
\end{lemma}

\begin{proof}
This is a special case of Lemma \ref{lemma-inf-map-ringed-topoi} but we also
give a direct proof. We have short exact sequences of modules
$$
0 \to \mathcal{I} \to \mathcal{O}' \to \mathcal{O} \to 0
\quad\text{and}\quad
0 \to \mathcal{I}\mathcal{G}' \to \mathcal{G}' \to \mathcal{G} \to 0
$$
and similarly for $\mathcal{F}'$.
Since $\mathcal{I}$ has square zero the $\mathcal{O}'$-module
structure on $\mathcal{I}$ and $\mathcal{I}\mathcal{G}'$ comes from
a unique $\mathcal{O}$-module structure. It follows that
$$
\Hom_{\mathcal{O}'}(\mathcal{F}', \mathcal{I}\mathcal{G}') =
\Hom_\mathcal{O}(\mathcal{F}, \mathcal{I}\mathcal{G}')
\quad\text{and}\quad
\Hom_{\mathcal{O}'}(\mathcal{F}', \mathcal{G}) =
\Hom_\mathcal{O}(\mathcal{F}, \mathcal{G})
$$
The lemma now follows from the exact sequence
$$
0 \to \Hom_{\mathcal{O}'}(\mathcal{F}', \mathcal{I}\mathcal{G}') \to
\Hom_{\mathcal{O}'}(\mathcal{F}', \mathcal{G}') \to
\Hom_{\mathcal{O}'}(\mathcal{F}', \mathcal{G})
$$
see Homology, Lemma \ref{homology-lemma-check-exactness}.
\end{proof}

\begin{lemma}
\label{lemma-deform-module-ringed-topoi}
Let $(f, f')$ be a morphism of first order thickenings of ringed topoi
as in Situation \ref{situation-morphism-thickenings-ringed-topoi}.
Let $\mathcal{F}'$ be an $\mathcal{O}'$-module
and set $\mathcal{F} = i^*\mathcal{F}'$.
Assume that $\mathcal{F}$ is flat over $\mathcal{O}_\mathcal{B}$
and that $(f, f')$ is a strict morphism of thickenings
(Definition \ref{definition-strict-morphism-thickenings-ringed-topoi}).
Then the following are equivalent
\begin{enumerate}
\item $\mathcal{F}'$ is flat over $\mathcal{O}_{\mathcal{B}'}$, and
\item the canonical map
$f^*\mathcal{J} \otimes_\mathcal{O} \mathcal{F} \to
\mathcal{I}\mathcal{F}'$
is an isomorphism.
\end{enumerate}
Moreover, in this case the maps
$$
f^*\mathcal{J} \otimes_\mathcal{O} \mathcal{F} \to
\mathcal{I} \otimes_\mathcal{O} \mathcal{F} \to
\mathcal{I}\mathcal{F}'
$$
are isomorphisms.
\end{lemma}

\begin{proof}
The map $f^*\mathcal{J} \to \mathcal{I}$ is surjective
as $(f, f')$ is a strict morphism of thickenings.
Hence the final statement is a consequence of (2).

\medskip\noindent
Proof of the equivalence of (1) and (2). By definition flatness over
$\mathcal{O}_\mathcal{B}$ means flatness over $f^{-1}\mathcal{O}_\mathcal{B}$.
Similarly for flatness over $f^{-1}\mathcal{O}_{\mathcal{B}'}$.
Note that the strictness of $(f, f')$ and the assumption that
$\mathcal{F} = i^*\mathcal{F}'$ imply that
$$
\mathcal{F} = \mathcal{F}'/(f^{-1}\mathcal{J})\mathcal{F}'
$$
as sheaves on $\mathcal{C}$. Moreover, observe that
$f^*\mathcal{J} \otimes_\mathcal{O} \mathcal{F} =
f^{-1}\mathcal{J} \otimes_{f^{-1}\mathcal{O}_\mathcal{B}} \mathcal{F}$.
Hence the equivalence of (1) and (2) follows from
Modules on Sites, Lemma \ref{sites-modules-lemma-flat-over-thickening}.
\end{proof}

\begin{lemma}
\label{lemma-inf-map-rel-ringed-topoi}
Let $(f, f')$ be a morphism of first order thickenings as in
Situation \ref{situation-morphism-thickenings-ringed-topoi}.
Let $\mathcal{F}'$, $\mathcal{G}'$ be $\mathcal{O}'$-modules and set
$\mathcal{F} = i^*\mathcal{F}'$ and $\mathcal{G} = i^*\mathcal{G}'$.
Let $\varphi : \mathcal{F} \to \mathcal{G}$ be an $\mathcal{O}$-linear map.
Assume that $\mathcal{G}'$ is flat over $\mathcal{O}_{\mathcal{B}'}$ and that
$(f, f')$ is a strict morphism of thickenings.
The set of lifts of $\varphi$ to an $\mathcal{O}'$-linear map
$\varphi' : \mathcal{F}' \to \mathcal{G}'$ is, if nonempty, a principal
homogenous space under
$$
\Hom_\mathcal{O}(\mathcal{F},
\mathcal{G} \otimes_\mathcal{O} f^*\mathcal{J})
$$
\end{lemma}

\begin{proof}
Combine Lemmas \ref{lemma-inf-map-special-ringed-topoi} and
\ref{lemma-deform-module-ringed-topoi}.
\end{proof}

\begin{lemma}
\label{lemma-inf-obs-map-special-ringed-topoi}
Let $i : (\Sh(\mathcal{C}), \mathcal{O}) \to (\Sh(\mathcal{D}), \mathcal{O}')$
be a first order thickening of ringed topoi.
Let $\mathcal{F}'$, $\mathcal{G}'$ be $\mathcal{O}'$-modules and set
$\mathcal{F} = i^*\mathcal{F}'$ and $\mathcal{G} = i^*\mathcal{G}'$.
Let $\varphi : \mathcal{F} \to \mathcal{G}$ be an $\mathcal{O}$-linear map.
There exists an element
$$
o(\varphi) \in
\text{Ext}^1_\mathcal{O}(Li^*\mathcal{F}', \mathcal{I}\mathcal{G}')
$$
whose vanishing is a necessary and sufficient condition for the
existence of a lift of $\varphi$ to an $\mathcal{O}'$-linear map
$\varphi' : \mathcal{F}' \to \mathcal{G}'$.
\end{lemma}

\begin{proof}
It is clear from the proof of Lemma \ref{lemma-inf-map-special-ringed-topoi}
that the vanishing of the boundary of $\varphi$ via the map
$$
\Hom_\mathcal{O}(\mathcal{F}, \mathcal{G}) =
\Hom_{\mathcal{O}'}(\mathcal{F}', \mathcal{G}) \longrightarrow
\text{Ext}^1_{\mathcal{O}'}(\mathcal{F}', \mathcal{I}\mathcal{G}')
$$
is a necessary and sufficient condition for the existence of a lift. We
conclude as
$$
\text{Ext}^1_{\mathcal{O}'}(\mathcal{F}', \mathcal{I}\mathcal{G}') =
\text{Ext}^1_\mathcal{O}(Li^*\mathcal{F}', \mathcal{I}\mathcal{G}')
$$
the adjointness of $i_* = Ri_*$ and $Li^*$ on the derived category
(Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-adjoint}).
\end{proof}

\begin{lemma}
\label{lemma-inf-obs-map-rel-ringed-topoi}
Let $(f, f')$ be a morphism of first order thickenings as in
Situation \ref{situation-morphism-thickenings-ringed-topoi}.
Let $\mathcal{F}'$, $\mathcal{G}'$ be $\mathcal{O}'$-modules and set
$\mathcal{F} = i^*\mathcal{F}'$ and $\mathcal{G} = i^*\mathcal{G}'$.
Let $\varphi : \mathcal{F} \to \mathcal{G}$ be an $\mathcal{O}$-linear map.
Assume that $\mathcal{F}'$ and $\mathcal{G}'$ are flat over
$\mathcal{O}_{\mathcal{B}'}$ and
that $(f, f')$ is a strict morphism of thickenings. There exists an element
$$
o(\varphi) \in
\text{Ext}^1_\mathcal{O}(\mathcal{F},
\mathcal{G} \otimes_\mathcal{O} f^*\mathcal{J})
$$
whose vanishing is a necessary and sufficient condition for the
existence of a lift of $\varphi$ to an $\mathcal{O}'$-linear map
$\varphi' : \mathcal{F}' \to \mathcal{G}'$.
\end{lemma}

\begin{proof}[First proof]
This follows from Lemma \ref{lemma-inf-obs-map-special-ringed-topoi}
as we claim that under the assumptions of the lemma we have
$$
\text{Ext}^1_\mathcal{O}(Li^*\mathcal{F}', \mathcal{I}\mathcal{G}') =
\text{Ext}^1_\mathcal{O}(\mathcal{F},
\mathcal{G} \otimes_\mathcal{O} f^*\mathcal{J})
$$
Namely, we have
$\mathcal{I}\mathcal{G}' =
\mathcal{G} \otimes_\mathcal{O} f^*\mathcal{J}$
by Lemma \ref{lemma-deform-module-ringed-topoi}.
On the other hand, observe that
$$
H^{-1}(Li^*\mathcal{F}') =
\text{Tor}_1^{\mathcal{O}'}(\mathcal{F}', \mathcal{O})
$$
(local computation omitted). Using the short exact sequence
$$
0 \to \mathcal{I} \to \mathcal{O}' \to \mathcal{O} \to 0
$$
we see that this $\text{Tor}_1$ is computed by the kernel of the map
$\mathcal{I} \otimes_\mathcal{O} \mathcal{F} \to \mathcal{I}\mathcal{F}'$
which is zero by the final assertion of
Lemma \ref{lemma-deform-module-ringed-topoi}.
Thus $\tau_{\geq -1}Li^*\mathcal{F}' = \mathcal{F}$.
On the other hand, we have
$$
\text{Ext}^1_\mathcal{O}(Li^*\mathcal{F}',
\mathcal{I}\mathcal{G}') =
\text{Ext}^1_\mathcal{O}(\tau_{\geq -1}Li^*\mathcal{F}',
\mathcal{I}\mathcal{G}')
$$
by the dual of
Derived Categories, Lemma \ref{derived-lemma-negative-vanishing}.
\end{proof}

\begin{proof}[Second proof]
We can apply Lemma \ref{lemma-inf-obs-map-ringed-topoi} as follows. Note that
$\mathcal{K} = \mathcal{I} \otimes_\mathcal{O} \mathcal{F}$ and
$\mathcal{L} = \mathcal{I} \otimes_\mathcal{O} \mathcal{G}$
by Lemma \ref{lemma-deform-module-ringed-topoi}, that
$c_{\mathcal{F}'} = 1 \otimes 1$ and $c_{\mathcal{G}'} = 1 \otimes 1$
and taking $\psi = 1 \otimes \varphi$ the diagram of the lemma
commutes. Thus $o(\varphi) = o(\varphi, 1 \otimes \varphi)$
works.
\end{proof}

\begin{lemma}
\label{lemma-inf-ext-rel-ringed-topoi}
Let $(f, f')$ be a morphism of first order thickenings as in
Situation \ref{situation-morphism-thickenings-ringed-topoi}.
Let $\mathcal{F}$ be an $\mathcal{O}$-module.
Assume $(f, f')$ is a strict morphism of thickenings and
$\mathcal{F}$ flat over $\mathcal{O}_\mathcal{B}$. If there exists a pair
$(\mathcal{F}', \alpha)$ consisting of an
$\mathcal{O}'$-module $\mathcal{F}'$ flat over $\mathcal{O}_{\mathcal{B}'}$
and an isomorphism
$\alpha : i^*\mathcal{F}' \to \mathcal{F}$, then the set of
isomorphism classes of such pairs is principal homogeneous
under
$\text{Ext}^1_\mathcal{O}(
\mathcal{F}, \mathcal{I} \otimes_\mathcal{O} \mathcal{F})$.
\end{lemma}

\begin{proof}
If we assume there exists one such module, then the canonical map
$$
f^*\mathcal{J} \otimes_\mathcal{O} \mathcal{F} \to
\mathcal{I} \otimes_\mathcal{O} \mathcal{F}
$$
is an isomorphism by Lemma \ref{lemma-deform-module-ringed-topoi}. Apply
Lemma \ref{lemma-inf-ext-ringed-topoi} with $\mathcal{K} = 
\mathcal{I} \otimes_\mathcal{O} \mathcal{F}$
and $c = 1$. By Lemma \ref{lemma-deform-module-ringed-topoi}
the corresponding extensions
$\mathcal{F}'$ are all flat over $\mathcal{O}_{\mathcal{B}'}$.
\end{proof}

\begin{lemma}
\label{lemma-inf-obs-ext-rel-ringed-topoi}
Let $(f, f')$ be a morphism of first order thickenings as in
Situation \ref{situation-morphism-thickenings-ringed-topoi}.
Let $\mathcal{F}$ be an $\mathcal{O}$-module. Assume
$(f, f')$ is a strict morphism of thickenings
and $\mathcal{F}$ flat over $\mathcal{O}_\mathcal{B}$. There exists an
$\mathcal{O}'$-module $\mathcal{F}'$ flat over $\mathcal{O}_{\mathcal{B}'}$
with $i^*\mathcal{F}' \cong \mathcal{F}$, if and only if
\begin{enumerate}
\item the canonical map
$f^*\mathcal{J} \otimes_\mathcal{O} \mathcal{F} \to
\mathcal{I} \otimes_\mathcal{O} \mathcal{F}$
is an isomorphism, and
\item the class
$o(\mathcal{F}, \mathcal{I} \otimes_\mathcal{O} \mathcal{F}, 1)
\in \text{Ext}^2_\mathcal{O}(
\mathcal{F}, \mathcal{I} \otimes_\mathcal{O} \mathcal{F})$
of Lemma \ref{lemma-inf-obs-ext-ringed-topoi} is zero.
\end{enumerate}
\end{lemma}

\begin{proof}
This folllows immediately from the characterization of
$\mathcal{O}'$-modules flat over $\mathcal{O}_{\mathcal{B}'}$ of 
Lemma \ref{lemma-deform-module-ringed-topoi} and
Lemma \ref{lemma-inf-obs-ext-ringed-topoi}.
\end{proof}







\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
