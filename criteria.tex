\input{preamble}

% OK, start here.
%
\begin{document}

\title{Criteria for Representability}

\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents




\section{Introduction}
\label{section-introduction}

\noindent
The purpose of this chapter is to find criteria guaranteeing that a
a stack in groupoids over the category of schemes with the fppf topology
is an algebraic stack. Historically, this often involved proving that
certain functors were representable, see Grothendieck's lectures
\cite{Gr-I},
\cite{Gr-II},
\cite{Gr-III},
\cite{Gr-IV},
\cite{Gr-V}, and
\cite{Gr-VI}.
This explains the title of this chapter. Another important source
of this material comes from the work of Artin, see
\cite{ArtinI},
\cite{ArtinII},
\cite{Artin-Theorem-Representability},
\cite{Artin-Construction-Techniques},
\cite{Artin-Algebraic-Spaces},
\cite{Artin-Algebraic-Approximation},
\cite{Artin-Implicit-Function}, and
\cite{ArtinVersal}.



\section{Conventions}
\label{section-conventions}

\noindent
The conventions we use in this chapter are the same as those in the
chapter on algebraic stacks, see
Algebraic Stacks, Section \ref{algebraic-section-conventions}.




\section{What we already know}
\label{section-done-so-far}

\noindent
The analogue of this chapter for algebraic spaces is the chapter entitled
``Bootstrap'', see
Bootstrap, Section \ref{bootstrap-section-introduction}.
That chapter already contains some representability results.
Moreover, some of the preliminary material treated there we already
have worked out in the chapter on algebraic stacks.
Here is a list:
\begin{enumerate}
\item We discuss morphisms of presheaves representable by algebraic spaces in
Bootstrap, Section
\ref{bootstrap-section-morphism-representable-by-spaces}.
In
Algebraic Stacks, Section
\ref{algebraic-section-morphisms-representable-by-algebraic-spaces}
we discuss the notion of a $1$-morphism of categories fibred in groupoids
being representable by algebraic spaces.
\item We discuss properties of morphisms of presheaves representable by
algebraic spaces in
Bootstrap, Section
\ref{bootstrap-section-representable-by-spaces-properties}.
In
Algebraic Stacks, Section
\ref{algebraic-section-representable-properties}
we discuss the notion of a $1$-morphism of categories fibred in groupoids
being representable by algebraic spaces.
\item We proved that if $F$ is a sheaf whose diagonal is representable
by algebraic spaces and which has an \'etale covering by an algebraic
space, then $F$ is an algebraic space, see
Bootstrap, Theorem \ref{bootstrap-theorem-bootstrap}.
(This is a weak version of the result in the next item on the list.)
\item
\label{item-bootstrap-final}
We proved that if $F$ is a sheaf and if there exists an algebraic
space $U$ and a morphism $U \to F$ which is representable by algebraic
spaces, surjective, flat, and locally of finite presentation, then
$F$ is an algebraic space, see
Bootstrap, Theorem \ref{bootstrap-theorem-final-bootstrap}.
\item We have also proved the ``smooth'' analogue of
(\ref{item-bootstrap-final}) for algebraic
stacks: If $\mathcal{X}$ is a stack in groupoids over
$(\textit{Sch}/S)_{fppf}$ and if there exists a stack in groupoids
$\mathcal{U}$ over $(\textit{Sch}/S)_{fppf}$ which is representably
by an algebraic space and a $1$-morphism $u : \mathcal{U} \to \mathcal{X}$
which is representable by algebraic spaces, surjective, and smooth
then $\mathcal{X}$ is an algebraic stack, see
Algebraic Stacks, Lemma
\ref{algebraic-lemma-smooth-surjective-morphism-implies-algebraic}.
\end{enumerate}
Our first task now is to prove the analogue of
(\ref{item-bootstrap-final}) for algebraic
stacks in general.



\section{Morphisms of stacks in groupoids}
\label{section-1-morphisms}

\noindent
This section is preliminary and should be skipped on a first reading.

\begin{lemma}
\label{lemma-etale-permanence}
Let $\mathcal{X} \to \mathcal{Y} \to \mathcal{Z}$
be $1$-morphisms of categories fibred in groupoids over
$(\textit{Sch}/S)_{fppf}$.
If $\mathcal{X} \to \mathcal{Z}$ and $\mathcal{Y} \to \mathcal{Z}$ are
representable by algebraic spaces and \'etale so is
$\mathcal{X} \to \mathcal{Y}$.
\end{lemma}

\begin{proof}
Let $\mathcal{U}$ be a representable category fibred in groupoids over $S$.
Let $f : \mathcal{U} \to \mathcal{Y}$ be a $1$-morphism. We have to show that
$\mathcal{X} \times_{\mathcal{Y}} \mathcal{U}$ is representable by an
algebraic space and \'etale over $\mathcal{U}$.
Consider the composition $h : \mathcal{U} \to \mathcal{Z}$. Then
$$
\mathcal{X} \times_{\mathcal{Z}} \mathcal{U}
\longrightarrow
\mathcal{Y} \times_{\mathcal{Z}} \mathcal{U}
$$
is a $1$-morphism between categories fibres in groupoids which are both
representable by algebraic spaces and both \'etale over $\mathcal{U}$.
Hence by
Properties of Spaces, Lemma \ref{spaces-properties-lemma-etale-permanence}
this is represented by an \'etale morphism of algebraic spaces.
Finally, we obtain the result we want as the morphism $f$ induces
a morphism $\mathcal{U} \to \mathcal{Y} \times_{\mathcal{Z}} \mathcal{U}$
and we have
$$
\mathcal{X} \times_{\mathcal{Y}} \mathcal{U} =
(\mathcal{X} \times_{\mathcal{Z}} \mathcal{U})
\times_{(\mathcal{Y} \times_{\mathcal{Z}} \mathcal{U})}
\mathcal{U}.
$$
\end{proof}

\begin{lemma}
\label{lemma-stack-in-setoids-descent}
Let $\mathcal{X}, \mathcal{Y}, \mathcal{Z}$ be stacks in groupoids
over $(\textit{Sch}/S)_{fppf}$. Suppose that $\mathcal{X} \to \mathcal{Y}$
and $\mathcal{Z} \to \mathcal{Y}$ are $1$-morphisms.
If
\begin{enumerate}
\item $\mathcal{Y}$, $\mathcal{Z}$ are representable by algebraic spaces
$Y$, $Z$ over $S$,
\item the associated morphism of algebraic spaces $Y \to Z$ is surjective,
flat and locally of finite presentation, and
\item $\mathcal{Y} \times_{\mathcal{Z}} \mathcal{X}$ is a stack in
setoids,
\end{enumerate}
then $\mathcal{X}$ is a stack in setoids.
\end{lemma}

\begin{proof}
This is a special case of
Stacks, Lemma \ref{stacks-lemma-stack-in-setoids-descent}.
\end{proof}






\section{Finite Hilbert stacks}
\label{section-finite-hilbert-stacks}

\noindent
In this section we prove some results concerning the finite
Hilbert stacks $\mathcal{H}_d(\mathcal{X}/\mathcal{Y})$
introduced in
Examples of Stacks, Section \ref{examples-stacks-section-hilbert-d-stack}.

\begin{lemma}
\label{lemma-map-hilbert}
Consider a $2$-commutative diagram
$$
\xymatrix{
\mathcal{X}' \ar[r]_G \ar[d]_{F'} & \mathcal{X} \ar[d]^F \\
\mathcal{Y}' \ar[r]^H & \mathcal{Y}
}
$$
of stacks in groupoids over $(\textit{Sch}/S)_{fppf}$ with a given
$2$-isomorphism $\gamma : H \circ F' \to F \circ G$. In this situation we
obtain a canonical $1$-morphism
$\mathcal{H}_d(\mathcal{X}'/\mathcal{Y}') \to
\mathcal{H}_d(\mathcal{X}/\mathcal{Y})$.
This morphism is compatible with the forgetful $1$-morphisms of
Examples of Stacks,
Equation (\ref{examples-stacks-equation-diagram-hilbert-d-stack}).
\end{lemma}

\begin{proof}
We map the object $(U, Z, y', x', \alpha')$ to the object
$(U, Z, H(y'), G(x'), \gamma \star \text{id}_H \star \alpha')$
where $\star$ denotes horizontal composition of $2$-morphisms, see
Categories, Definition \ref{categories-definition-horizontal-composition}.
To a morphism
$(f, g, b, a) :
(U_1, Z_1, y_1', x_1', \alpha_1') \to (U_2, Z_2, y_2', x_2', \alpha_2')$
we assign
$(f, g, H(b), G(a))$.
We omit the verification that this defines a functor between categories over
$(\textit{Sch}/S)_{fppf}$.
\end{proof}

\begin{lemma}
\label{lemma-cartesian-map-hilbert}
In the situation of
Lemma \ref{lemma-map-hilbert}
assume that the given square is $2$-cartesian. Then the diagram
$$
\xymatrix{
\mathcal{H}_d(\mathcal{X}'/\mathcal{Y}') \ar[r] \ar[d] &
\mathcal{H}_d(\mathcal{X}/\mathcal{Y}) \ar[d] \\
\mathcal{Y}' \ar[r] &
\mathcal{Y}
}
$$
is $2$-cartesian.
\end{lemma}

\begin{proof}
We get a $2$-commutative diagram by
Lemma \ref{lemma-map-hilbert}
and hence we get a $1$-morphism (i.e., a functor)
$$
\mathcal{H}_d(\mathcal{X}'/\mathcal{Y}')
\longrightarrow
\mathcal{Y}' \times_{\mathcal{Y}} \mathcal{H}_d(\mathcal{X}/\mathcal{Y})
$$
We indicate why this functor is essentially surjective. Namely, an object
of the category on the right hand side is given by a scheme $U$ over $S$,
an object $y'$ of $\mathcal{Y}'_U$, an object $(U, Z, y, x, \alpha)$
of $\mathcal{H}_d(\mathcal{X}/\mathcal{Y})$ over $U$ and an isomorphism
$H(y') \to y$ in $\mathcal{Y}_U$. The assumption means exactly that
there exists an object $x'$ of $\mathcal{X}'_Z$ such that there exist
isomorphisms $G(x') \cong x$ and $\alpha' : y'|_Z \to F'(x')$ compatible
with $\alpha$. Then we see that $(U, Z, y', x', \alpha')$ is an
object of $\mathcal{H}_d(\mathcal{X}'/\mathcal{Y}')$ over $U$.
Details omitted.
\end{proof}

\begin{lemma}
\label{lemma-surjection-space-of-sections}
Let $Z \to U$ be a morphism of schemes that is finite locally free
of degree $d$. Let $W$ be an algebraic space and let $W \to Z$ be a
surjective \'etale morphism. Then there exists a surjective
\'etale morphism $U' \to U$ and a section
$$
\sigma : Z_{U'} \to W_{U'}
$$
of the morphism $W_{U'} \to Z_{U'}$.
\end{lemma}

\begin{proof}
We may choose a separated scheme $W'$ and a surjective \'etale morphism
$W' \to W$. Hence after replacing $W$ by $W'$ we may assume that $W$
is a separated scheme. Let $u \in U$ be a point. Clearly it suffices
to find an \'etale neighbourhood $(U', u')$ of $(U, u)$ such that
a section $\sigma$ exists over $U'$. Let $z_1, \ldots, z_r$
be the points of $Z$ lying above $u$. For each $i$ choose a point
$w_i \in W$ which maps to $z_i$. We may pick an \'etale neighbourhood
$(U', u') \to (U, u)$ such that the conclusions of
More on Morphisms, Lemma
\ref{more-morphisms-lemma-etale-splits-off-quasi-finite-part-technical-variant}
hold for both $Z \to U$ and the points $z_1, \ldots, z_r$
and $W \to U$ and the points $w_1, \ldots, w_r$. Hence, after
replacing $(U, u)$ by $(U', u')$ and relabeling, we may assume that
all the field extensions $\kappa(u) \subset \kappa(z_i)$ and
$\kappa(u) \subset \kappa(w_i)$ are purely inseparable, and moreover
that there exist disjoint sum decompositions
$$
Z = V_1 \amalg \ldots \amalg V_r \amalg Rest, \quad
W = W_1 \amalg \ldots \amalg W_r \amalg Rest
$$
with $z_i \in V_i$, $w_i \in W_i$ and $V_i \to U$, $W_i \to U$ finite.
After shrinking $U$ we may assume that $Z = V_1 \amalg \ldots \amalg V_r$.
After replacing $W_i$ by $W_i \cap f^{-1}(V_i)$ we may assume that
$f : W \to Z$ maps $W_i$ into $V_i$. Then $f_i = f|_{W_i} : W_i \to V_i$
is a morphism of schemes finite over $U$, hence finite. It is also \'etale,
$f_i^{-1}(\{z_i\}) = w_i$, and induces an isomorphism of residue
fields $\kappa(z_i) = \kappa(w_i)$ (because both are purely inseparable
over $\kappa(u)$ and the extension is separable as $f$ is \'etale).
Hence by
\'Etale Morphisms of Schemes, Lemma \ref{etale-lemma-finite-etale-one-point}
we see that $f_i$ is an isomorphism in a neighbourhood $V_i'$ of
$z_i$. Since $Z \to U$ is closed, after shrinking $U$, we may assume
that $W_i \to V_i$ is an isomorphism. This proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-space-of-sections}
Let $Z \to U$ be a morphism of schemes that is finite locally free
of degree $d$. Let $W$ be an algebraic space and let
$W \to Z$ be an \'etale morphism.
Then the functor
$$
F : (\textit{Sch}/U)_{fppf}^{opp} \longrightarrow \textit{Sets},
$$
defined by the rule
$$
U' \longmapsto
F(U') =
\{\sigma : Z_{U'} \to W_{U'}\text{ section of }W_{U'} \to Z_{U'}\}
$$
is an algebraic space and the morphism $F \to U$ is \'etale.
\end{lemma}

\begin{proof}
Assume first that $W \to Z$ is also separated.
Let $U'$ be a scheme over $U$ and let $\sigma \in F(U')$. By
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-section-immersion}
the morphism $\sigma$ is a closed immersion.
Moreover, $\sigma$ is \'etale by
Properties of Spaces, Lemma \ref{spaces-properties-lemma-etale-permanence}.
Hence $\sigma$ is also an open immersion, see
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-etale-universally-injective-open}.
In other words, $Z_\sigma = \sigma(Z_{U'}) \subset W_{U'}$ is
an open subspace such that the morphism $Z_\sigma \to Z_{U'}$
is an isomorphism. In particular, the morphism $Z_\sigma \to U'$
is finite. Hence we obtain a transformation of functors
$$
F \longrightarrow (W/U)_{fin},\quad
\sigma \longmapsto (U' \to U, Z_\sigma)
$$
where $(W/U)_{fin}$ is the finite part of the morphism $W \to U$
introduced in
More on Groupoid Spaces, Section \ref{spaces-more-groupoids-section-finite}.
It is clear that this transformation of functors is injective (since we can
recover $\sigma$ from $Z_\sigma$ as the inverse of the isomorphism
$Z_\sigma \to Z_{U'}$). By
More on Groupoids in Space, Proposition
\ref{spaces-more-groupoids-proposition-finite-algebraic-space}
we know that $(W/U)_{fin}$ is an algebraic space \'etale over $U$.
Hence to finish the proof in this case it suffices to show that
$F \to (W/U)_{fin}$ is representable and an open immersion.
To see this suppose that we are given a morphism of schemes $U' \to U$
and an open subspace $Z' \subset W_{U'}$ such that $Z' \to U'$
is finite. Then it suffices to show that there exists an
open subscheme $U'' \subset U'$ such that a morphism
$T \to U'$ factors through $U''$ if and only if $Z' \times_{U'} T$
maps isomorphically to $Z \times_{U'} T$. This follows from
Quot and Hilbert Spaces, Lemma \ref{quot-lemma-where-isomorphism}.
Hence we have proved the lemma in case $W \to Z$ is separated
as well as \'etale.

\medskip\noindent
In the general case we choose a separated scheme $W'$ and a surjective
\'etale morphism $W' \to W$. Note that the morphisms $W' \to W$ and
$W \to Z$ are separated as their source is separated. Denote $F'$ the
functor associated to $W' \to Z \to U$ as in the lemma. In the first
paragraph of the proof we showed that $F'$ is representable by an
algebraic space \'etale over $U$. By
Lemma \ref{lemma-surjection-space-of-sections}
the map of functors $F' \to F$ is surjective for the \'etale topology
on $\textit{Sch}/U$. Moreover, if $U'$ and $\sigma : Z_{U'} \to W_{U'}$
define a point $\xi \in F(U')$, then the fibre product
$$
F'' = F' \times_{F, \xi} U'
$$
is the functor on $\textit{Sch}/U'$ associated to the morphisms
$$
W'_{U'} \times_{W_{U'}, \sigma} Z_{U'} \to Z_{U'} \to U'.
$$
Since the first morphism is separated as a base change of a separated
morphism, we see that $F''$ is an algebraic space \'etale over $U'$
by the result of the first paragraph. It follows that $F' \to F$ is a
surjective \'etale transformation of functors, which is representable
by algebraic spaces. Hence $F$ is an algebraic space by
Bootstrap, Theorem \ref{bootstrap-theorem-final-bootstrap}.
Since $F' \to F$ is an \'etale surjective morphism of algebraic spaces
it follows that $F \to U$ is \'etale because $F' \to U$ is \'etale.
\end{proof}

\begin{lemma}
\label{lemma-etale-map-hilbert}
In the situation of
Lemma \ref{lemma-map-hilbert}.
Assume that $G$, $H$ are representable by algebraic spaces and \'etale.
Then $\mathcal{H}_d(\mathcal{X}'/\mathcal{Y}') \to
\mathcal{H}_d(\mathcal{X}/\mathcal{Y})$ is representable by
algebraic spaces and \'etale.
If, in addition, $H$ is surjective and the induced functor
$\mathcal{X}' \to \mathcal{Y}' \times_{\mathcal{Y}} \mathcal{X}$
(which is representable by algebraic spaces and \'etale by
Lemma \ref{lemma-etale-permanence})
is surjective, then $\mathcal{H}_d(\mathcal{X}'/\mathcal{Y}') \to
\mathcal{H}_d(\mathcal{X}/\mathcal{Y})$ is also surjective.
\end{lemma}

\begin{proof}
Set $\mathcal{X}'' = \mathcal{Y}' \times_{\mathcal{Y}} \mathcal{X}$
so that we obtain a $2$-commutative diagram
$$
\xymatrix{
\mathcal{X}' \ar[r] \ar[d] &
\mathcal{X}'' \ar[r] \ar[d] &
\mathcal{X} \ar[d] \\
\mathcal{Y}' \ar[r] &
\mathcal{Y}' \ar[r] &
\mathcal{Y}
}
$$
It follows from
Lemma \ref{lemma-cartesian-map-hilbert}
that $\mathcal{H}_d(\mathcal{X}''/\mathcal{Y}')$ is the base change
of $\mathcal{H}_d(\mathcal{X}/\mathcal{Y})$ by $\mathcal{Y}' \to \mathcal{Y}$.
In particular we see that
$\mathcal{H}_d(\mathcal{X}''/\mathcal{Y}') \to
\mathcal{H}_d(\mathcal{X}/\mathcal{Y})$ is
representable by algebraic spaces and \'etale, see
Algebraic Stacks, Lemma
\ref{algebraic-lemma-base-change-representable-transformations-property}.
Moreover, it is also surjective if $H$ is.
By
Lemma \ref{lemma-etale-permanence}
the $1$-morphism $\mathcal{X}' \to \mathcal{X}''$ is representable by
algebraic spaces and \'etale. Hence if we can show that
the result holds for the left square in the diagram, then we're done.
In this way we reduce to the case where $\mathcal{Y}' = \mathcal{Y}$.

\medskip\noindent
Assume $\mathcal{Y}' = \mathcal{Y}$.
Let $U$ be a scheme and let $\xi = (U, Z, y, x, \alpha)$ be an object of
$\mathcal{H}_d(\mathcal{X}/\mathcal{Y})$ over $U$.
We have to prove that the $2$-fibre product
\begin{equation}
\label{equation-to-show}
(\textit{Sch}/U)_{fppf}
\times_{\xi, \mathcal{H}_d(\mathcal{X}/\mathcal{Y})}
\mathcal{H}_d(\mathcal{X}'/\mathcal{Y})
\end{equation}
is representably by an algebraic space \'etale over $U$.
By assumption the $2$-fibre product
$$
(\textit{Sch}/Z)_{fppf} \times_{x, \mathcal{X}} \mathcal{X}'
$$
is representable by an algebraic space $W$ such that the projection
$W \to Z$ is \'etale. Then (\ref{equation-to-show})
is representable by the algebraic space $F$ parametrizing sections of
$W \to Z$ over $U$ introduced in
Lemma \ref{lemma-space-of-sections}.
Since $F \to U$ is \'etale we conclude that
$\mathcal{H}_d(\mathcal{X}'/\mathcal{Y}') \to
\mathcal{H}_d(\mathcal{X}/\mathcal{Y})$ is representable by
algebraic spaces and \'etale.
Finally, if $\mathcal{X}' \to \mathcal{X}$ is surjective also,
then $W \to Z$ is surjective, and hence $F \to U$ is surjective by
Lemma \ref{lemma-surjection-space-of-sections}.
Thus in this case
$\mathcal{H}_d(\mathcal{X}'/\mathcal{Y}') \to
\mathcal{H}_d(\mathcal{X}/\mathcal{Y})$ is also surjective.
\end{proof}

















\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
