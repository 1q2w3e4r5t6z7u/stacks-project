\input{preamble}

% OK, start here.
%
\begin{document}

\title{Constructions of schemes}

%\begin{abstract}
%\end{abstract}

\maketitle

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we introduce ways of constructing schemes out of others.
A basic reference is \cite{EGA}.








\section{Relative spectrum}
\label{section-spec}



\noindent
Let $S$ be a scheme.
Let $\mathcal{A}$ be a quasi-coherent sheaf of $\mathcal{O}_S$-algebras.
This means that $\mathcal{A}$ is a sheaf of $\mathcal{O}_S$-algebras
which is quasi-coherent as an $\mathcal{O}_S$-module.

\medskip\noindent
For any $f : T \to S$ the pullback
$f^*\mathcal{A}$ is a quasi-coherent sheaf of $\mathcal{O}_T$-algebras.
We are going to consider pairs $(f : T \to S, \varphi)$ where
$f$ is a morphism of schemes and $\varphi : f^*\mathcal{A} \to \mathcal{O}_T$
is a morphism of $\mathcal{O}_T$-algebras. Note that this is the
same as giving a $f^{-1}\mathcal{O}_S$-algebra homomorphism
$\varphi : f^{-1}\mathcal{A} \to \mathcal{O}_T$, see
Sheaves, Lemma \ref{sheaves-lemma-adjointness-tensor-restrict}.
This is also the same as giving a $\mathcal{O}_S$-algebra map
$\varphi : \mathcal{A} \to f_*\mathcal{O}_T$, see
Sheaves, Lemma \ref{sheaves-lemma-adjoint-push-pull-modules}.
We will use all three ways of thinking about $\varphi$,
without further mention.

\medskip\noindent
Given such a
pair $(f : T \to S, \varphi)$ and a morphism $a : T' \to T$ we get
a second pair $(f' = f \circ a, \varphi' = a^*\varphi)$ which we
call the pull back of $(f, \varphi)$. One way to describe
$\varphi' = a^*\varphi$ is as the composition
$\mathcal{A} \to f_*\mathcal{O}_T \to f'_*\mathcal{O}_{T'}$
where the second map is $f_*a^\sharp$ with
$a^\sharp : \mathcal{O}_T \to a_*\mathcal{O}_{T'}$.
In this way we have defined a contravariant functor
\begin{eqnarray}
\label{equation-spec}
F : \textit{Sch} & \longrightarrow & \textit{Sets} \\
T & \longmapsto & F(T) = \{\text{pairs }(f, \varphi) \text{ as above}\}
\nonumber
\end{eqnarray}

\begin{lemma}
\label{lemma-spec-base-change}
Let $S$ be a scheme. Let $\mathcal{A}$ be a quasi-coherent
sheaf of $\mathcal{O}_S$-algebras. Let $F$ be the functor
associated to $(S, \mathcal{A})$ above.
Let $g : S' \to S$ be a morphism of schemes.
Set $\mathcal{A}' = g^*\mathcal{A}$. Let $F'$ be the
functor associated to $(S', \mathcal{A}')$ above.
Then there is a canonical isomorphism
$$
F' \cong h_{S'} \times_{h_S} F
$$
of functors.
\end{lemma}

\begin{proof}
A pair $(f' : T \to S', \varphi' : (f')^*\mathcal{A}' \to \mathcal{O}_T)$
is the same as a pair $(f, \varphi : f^*\mathcal{A} \to \mathcal{O}_T)$
together with a factorization of $f$ as $f = g \circ f'$. Namely with
this notation we have
$(f')^* \mathcal{A}' = (f')^*g^*\mathcal{A} = f^*\mathcal{A}$.
Hence the lemma.
\end{proof}

\begin{lemma}
\label{lemma-spec-affine}
Let $S$ be a scheme. Let $\mathcal{A}$ be a quasi-coherent
sheaf of $\mathcal{O}_S$-algebras. Let $F$ be the functor
associated to $(S, \mathcal{A})$ above.
If $S$ is affine, then $F$ is representable by the
affine scheme $\text{Spec}(\Gamma(S, \mathcal{A}))$.
\end{lemma}

\begin{proof}
Write $S = \text{Spec}(R)$ and $A = \Gamma(S, \mathcal{A})$.
Then $A$ is an $R$-algebra and $\mathcal{A} = \widetilde A$.
The ring map $R \to A$ gives rise to a canonical map
$$
f_{univ} : \text{Spec}(A)
\longrightarrow
S = \text{Spec}(R).
$$
We have
$f_{univ}^*\mathcal{A} =  \widetilde{A \otimes_R A}$
by Schemes, Lemma \ref{schemes-lemma-widetilde-pullback}.
Hence there is a canonical map
$$
\varphi_{univ} :
f_{univ}^*\mathcal{A} = \widetilde{A \otimes_R A}
\longrightarrow
\widetilde A = \mathcal{O}_{\text{Spec}(A)}
$$
coming from the $A$-module map $A \otimes_R A \to A$,
$a \otimes a' \mapsto aa'$. We claim that the pair
$(f_{univ}, \varphi_{univ})$ represents $F$ in this case.
In other words we claim that for any scheme $T$ the map
$$
\text{Mor}(T, \text{Spec}(A)) \longrightarrow
\{\text{pairs } (f, \varphi)\},\ \ 
a \longmapsto (a^*f_{univ}, a^*\varphi)
$$
is bijective.

\medskip\noindent
Let us construct the inverse map.
For any pair $(f : T \to S, \varphi)$ we get the induced
ring map
$$
\xymatrix{
A = \Gamma(S, \mathcal{A}) \ar[r]^{f^*} &
\Gamma(T, f^*\mathcal{A}) \ar[r]^{\varphi} &
\Gamma(T, \mathcal{O}_T)
}
$$
This induces a morphism of schemes $T \to \text{Spec}(A)$
by Schemes, Lemma \ref{schemes-lemma-morphism-into-affine}.

\medskip\noindent
The verification that this map is inverse to the map
displayed above is omitted.
\end{proof}

\begin{lemma}
\label{lemma-spec}
The functor $F$ is representable by a scheme.
\end{lemma}

\begin{proof}
We are going to use Schemes, Lemma \ref{schemes-lemma-glue-functors}.

\medskip\noindent
First we check that $F$ satisfies the sheaf property for the
Zariski topology. Namely, suppose that $T$ is a scheme,
that $T = \bigcup_{i \in I} U_i$ is an open covering,
and that $(f_i, \varphi_i) \in F(U_i)$ such that
$(f_i, \varphi_i)|_{U_i \cap U_j} = (f_j, \varphi_j)|_{U_i \cap U_j}$.
This implies that the morphisms $f_i : U_i \to S$
glue to a morphism of schemes $f : T \to S$ such that
$f|_{I_i} = f_i$, see Schemes, Section \ref{schemes-section-glueing-schemes}.
Thus $f_i^*\mathcal{A} = f^*\mathcal{A}|_{U_i}$ and by assumption the
morphisms $\varphi_i$ agree on $U_i \cap U_j$. Hence by Sheaves,
Section \ref{sheaves-section-glueing-sheaves} these glue to a
morphism of $\mathcal{O}_T$-algebras $f^*\mathcal{A} \to \mathcal{O}_T$.
This proves that $F$ satisfies the sheaf condition with respect to
the Zariski topology.

\medskip\noindent
Let $S = \bigcup_{i \in I} U_i$ be an affine open covering.
Let $F_i \subset F$ be the subfunctor consisting of
those pairs $(f : T \to S, \varphi)$ such that
$f(T) \subset U_i$.

\medskip\noindent
We have to show each $F_i$ is representable.
This is the case because $F_i$ is identified with
the functor associated to $U_i$ equipped with
the quasi-coherent $\mathcal{O}_{U_i}$-algebra $\mathcal{A}|_{U_i})$.
Thus the result follows from Lemma \ref{lemma-spec-affine}.

\medskip\noindent
Next we show that $F_i \subset F$ is representable by open immersions.
Let $(f : T \to S, \varphi) \in F(T)$. Consider $V_i = f^{-1}(U_i)$.
It follows from the definition of $F_i$ that given $a : T' \to T$
we gave $a^*(f, \varphi) \in F_i(T')$ if and only if $a(T') \subset V_i$.
This is what we were required to show.

\medskip\noindent
Finally, we have to show that the collection $(F_i)_{i \in I}$
covers $F$. Let $(f : T \to S, \varphi) \in F(T)$.
Consider $V_i = f^{-1}(U_i)$. Since $S = \bigcup_{i \in I} U_i$
is an open covering of $S$ we see that $T = \bigcup_{i \in I} V_i$
is an open covering of $T$. Moreover $(f, \varphi)|_{V_i} \in F_i(V_i)$.
This finishes the proof of the lemma.
\end{proof}

\begin{definition}
\label{definition-spec}
Let $S$ be a scheme. Let $\mathcal{A}$ be a quasi-coherent
sheaf of $\mathcal{O}_S$-algebras. We denote
$\underline{\text{Spec}}_S(\mathcal{A})$ a scheme
representing the functor $F$ introduced in Equation
\ref{equation-spec} above. This is called the {\it relative
spectrum of $\mathcal{A}$ over $S$}. The universal family
is a pair $f_{univ} : \underline{\text{Spec}}_S(\mathcal{A}) \to S$\ and a morphism of $\mathcal{O}_S$-algebras
$$
\mathcal{A}
\longrightarrow
f_{univ, *}\mathcal{O}_{\underline{\text{Spec}}_S(\mathcal{A})}
$$
\end{definition}

\noindent
The following lemma says among other things that forming the
relative spectrum commutes with base change.

\begin{lemma}
\label{lemma-spec-properties}
Let $S$ be a scheme. Let $\mathcal{A}$ be a quasi-coherent
sheaf of $\mathcal{O}_S$-algebras. Let
$f_{univ} : \underline{\text{Spec}}_S(\mathcal{A}) \to S$
be the relative spectrum of $\mathcal{A}$ over $S$.
\begin{enumerate}
\item For every affine open $U \subset S$ the inverse image
$f^{-1}(U)$ is affine.
\item For every morphism $g : S' \to S$ we have
$S' \times_S \underline{\text{Spec}}_S(\mathcal{A}) =
\underline{\text{Spec}}_{S'}(g^*\mathcal{A})$.
\item
The universal
map
$$
\mathcal{A}
\longrightarrow
f_{univ, *}\mathcal{O}_{\underline{\text{Spec}}_S(\mathcal{A})}
$$
is an isomorphism of $\mathcal{O}_S$-algebras.
\end{enumerate}
\end{lemma}

\begin{proof}
We first note that (2) follows immediately from
Lemma \ref{lemma-spec-base-change}. Then (1) follows because
$f^{-1}(U) = U \times_S \underline{\text{Spec}}_S(\mathcal{A}) =
\underline{\text{Spec}}_U(\mathcal{A}|_U)$ combined with
Lemma \ref{lemma-spec-affine}. Finally, (3) follows because
it is local on $S$ and it is clear in case $S$ is affine
by Lemma \ref{lemma-spec-affine} again.
\end{proof}






\section{Vector bundles}
\label{section-vector-bundle}

\noindent
Let $S$ be a scheme.
Let $\mathcal{E}$ be a quasi-coherent sheaf of $\mathcal{O}_S$-modules.
By Modules, Lemma \ref{modules-lemma-whole-tensor-algebra-permanence}
the symmetric algebra $\text{Sym}(\mathcal{E})$ of
$\mathcal{E}$ over $\mathcal{O}_S$
is a quasi-coherent sheaf of $\mathcal{O}_S$-algebras.
Hence it makes sense to apply the construction of the
previous section to it.

\begin{definition}
\label{definition-vector-bundle}
Let $S$ be a scheme.
Let $\mathcal{E}$ be a quasi-coherent sheaf of $\mathcal{O}_S$-modules.
We denote
$$
\mathbf{V}(\mathcal{E}) = \underline{\text{Spec}}_S(\text{Sym}(\mathcal{E}))
$$
and we call it the {\it vector bundle associated to the
quasi-coherent sheaf of $\mathcal{O}_S$-modules $\mathcal{E}$}.
\end{definition}







\section{Proj of a graded ring}
\label{section-proj}

\noindent
Let $S$ be a graded ring. Consider the topological space $\text{Proj}(S)$
associated to $S$, see Algebra, Section \ref{algebra-section-proj}.
We will endow this space with a sheaf of rings $\mathcal{O}_{\text{Proj}(S)}$
such that the resulting pair $(\text{Proj}(R), \mathcal{O}_{\text{Proj}(R)})$
will be a scheme.

\medskip\noindent
Recall that $\text{Proj}(S)$ has a basis of open sets $D_{+}(f)$,
$f \in S_d$, $d \geq 1$ which we call {\it standard opens}, see Algebra,
Section \ref{algebra-section-proj}. This terminology will always
imply that $f$ is homogeneous of positive degree even if we forget to
mention it. In addition, the intersection of two standard opens is another:
$D_{+}(f) \cap D_{+}(g) = D_{+}(fg)$, for $f, g \in S$ homogeneous of positive
degree.

\begin{lemma}
\label{lemma-standard-open}
Let $S$ be a graded ring. Let $f \in S$ homogeneous of positive degree.
\begin{enumerate}
\item If $g\in S$ homogeneous of positive degree
and $D_{+}(g) \subset D_{+}(f)$, then
\begin{enumerate}
\item $f$ is invertible in $S_g$, and
$f^{\deg(g)}/g^{\deg(f)}$ is invertible in $S_{(g)}$,
\item $g^e = af$ for some $e \geq 1$ and $a \in S$ homogeneous,
\item there are compatible canonical ring maps
$S_f \to S_g$ and $S_{(f)} \to S_{(g)}$,
\item the map $S_{(f)} \to S_{(g)}$ induces an isomorphism
$$
(S_{(f)})_{g^{\deg(f)}/f^{\deg(g)}} \cong S_{(g)},
$$
\item these maps induce a commutative diagram of
topological spaces
$$
\xymatrix{
D_{+}(g) \ar[d] &
\{\mathbf{Z}\text{-graded primes of }S_g\} \ar[l] \ar[r] \ar[d] &
\text{Spec}(S_{(g)}) \ar[d] \\
D_{+}(f) &
\{\mathbf{Z}\text{-graded primes of }S_f\} \ar[l] \ar[r] &
\text{Spec}(S_{(f)})
}
$$
where the horizontal maps are homeomorphisms and the vertical maps
are open immersions,
\item there are a compatible canonical $S_f$ and $S_{(f)}$-module
maps $M_f \to M_g$ and $M_{(f)} \to M_{(g)}$ for any graded $S$-module $M$,
and
\item the map $M_{(f)} \to M_{(g)}$ induces an isomorphism
$$
(M_{(f)})_{g^{\deg(f)}/f^{\deg(g)}} \cong M_{(g)}.
$$
\end{enumerate}
\item Any open covering of $D_{+}(f)$ can be refined to a finite
open covering of the form $D_{+}(f) = \bigcup_{i = 1}^n D_{+}(g_i)$.
\item If $g_1, \ldots, g_n \in S$ are homogeneous of positive degree,
then $D_{+}(f) \subset \bigcup D_{+}(g_i)$
if and only if
$g_1^{\deg(f)}/f^{\deg(g_1)}, \ldots, g_n^{\deg(f)}/f^{\deg(g_n)}$
generate the unit ideal in $S_{(f)}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Recall that $D_{+}(g) = \text{Spec}(S_{(g)})$, see
Algebra, Lemma \ref{algebra-lemma-topology-proj}.
Thus (a) holds because $f^{\deg(g)}/g^{\deg(f)}$
is an element of $S_{(g)}$ which is not
contained in any prime ideal, and hence invertible,
see Algebra, Lemma \ref{algebra-lemma-Zariski-topology}.
Write the inverse of $f$ in $S_g$ as $a/g^d$.
We may replace $a$ by its homogeneous part of degree $d\deg(g) - \deg(f)$.
This means $g^d - af$ is annihilated by a power of $g$, whence 
$g^e = af$ for some $a \in S$ homogeneous of degree $e\deg(g) - \deg(f)$.
This proves (b).
For (c), the map $S_f \to S_g$ exists by (a) from the universal property
of localization, or we can define it by mapping $b/f^n$
to $a^nb/g^{ne}$. This clearly induces a map of the subrings
$S_{(f)} \to S_{(g)}$ of degree zero elements as well.
We can similarly define $M_f \to M_g$ and $M_{(f)} \to M_{(g)}$ by mapping
$x/f^n$ to $a^nx/g^{ne}$. The statements writing $S_{(g)}$ resp.\ 
$M_{(g)}$ as principal localizations of $S_{(f)}$ resp.\ $M_{(f)}$
are clear from the formulas above. The maps in the commutative diagram
of topological spaces correspond to the ring maps given above. The
horizontal arrows are homeomorphisms by
Algebra, Lemma \ref{algebra-lemma-topology-proj}.
The vertical arrows are open immersions since the left
one is the inclusion of an open subset.

\medskip\noindent
The open $D_{+}(f)$ is quasi-compact because it is homeomorphic
to $\text{Spec}(S_{(f)})$, see  Algebra, Lemma \ref{algebra-lemma-qc-open}.
Hence the second statement follows directly
from the fact that the standard opens form
a basis for the topology.

\medskip\noindent
The third statement follows directly from
Algebra, Lemma \ref{algebra-lemma-Zariski-topology}.
\end{proof}

\noindent
In Sheaves, Section \ref{sheaves-section-bases} we defined
the notion of a sheaf on a basis, and we showed that it is
essentially equivalent to the notion of a sheaf on the space,
see Sheaves, Lemmas \ref{sheaves-lemma-extend-off-basis} and
\ref{sheaves-lemma-extend-off-basis-structures}. Moreover,
we showed in
Sheaves, Lemma \ref{sheaves-lemma-cofinal-systems-coverings-standard-case}
that it is sufficient to check the sheaf
condition on a cofinal system of open coverings for each
standard open. By the lemma above it suffices to check
on the finite coverings by standard opens.

\begin{definition}
\label{definition-standard-covering}
Let $S$ be a graded ring.
Suppose that $D_{+}(f) \subset \text{Proj}(S)$ is a standard
open. A {\it standard open covering} of $D_{+}(f)$
is a covering $D_{+}(f) = \bigcup_{i=1}^n D_{+}(g_i)$,
where $g_1,\ldots, g_n \in S$ are homogeneous of positive degree.
\end{definition}

\noindent
Let $S$ be a graded ring. Let $M$ be a graded $S$-module. We will define
a presheaf $\widetilde M$ on the basis of standard opens.
Suppose that $U \subset \text{Proj}(S)$ is a standard open.
If $f, g \in S$ are homogeneous of positive degree
such that $D_{+}(f) = D_{+}(g)$, then
by Lemma \ref{lemma-standard-open} above there are canonical
maps $M_{(f)} \to M_{(g)}$ and $M_{(g)} \to M_{(f)}$ which are
mutually inverse. Hence we may choose any $f$ such that $U = D_{+}(f)$
and define
$$
\widetilde M(U) = M_{(f)}.
$$
Note that if $D_{+}(g) \subset D_{+}(f)$, then by
Lemma \ref{lemma-standard-open} above we have
a canonical map
$$
\widetilde M(D_{+}(f)) = M_{(f)} \longrightarrow
M_{(g)} = \widetilde M(D_{+}(g)).
$$
Clearly, this defines a presheaf of abelian groups on the basis
of standard opens. If $M = S$, then $\widetilde S$ is a presheaf
of rings on the basis of standard opens.

\medskip\noindent
Let us compute the stalk of $\widetilde M$ at a point
$x \in \text{Proj}(S)$.
Suppose that $x$ corresponds to the homogeneous prime
ideal $\mathfrak p \subset S$.
By definition of the stalk we see that
$$
\widetilde M_x
=
\text{colim}_{f\in S_d, d > 0, f\not\in \mathfrak p}\ M_{(f)}
$$
Here the set $\{f\in S_d, d > 0, f\not\in \mathfrak p\}$ is partially
ordered by the rule $f \geq f' \Leftrightarrow D_{+}(f) \subset D_{+}(f')$.
If $f_1, f_2 \in S \setminus \mathfrak p$ are homogeneous of positive
degree, then we have
$f_1f_2 \geq f_1$ in this ordering. In
Algebra, Section \ref{algebra-section-proj}
we defined $M_{(\mathfrak p)}$ as the ring whose elements are fractions
$x/f$ with $x, f$ homogeneous, $\deg(x) = \deg(f)$, $f \not \in \mathfrak p$.
Since $\mathfrak p \in \text{Proj}(S)$ there exists at least
one $f_0 \in S$ homogeneous of positive degree with $f_0 \not\in \mathfrak p$.
Hence $x/f = f_0x/ff_0$ and we see that we may always assume
the denominator of an element in $M_{(\mathfrak p)}$ has positive degree.
From these remarks it follows easily that
$$
\widetilde M_x = M_{(\mathfrak p)}.
$$

\medskip\noindent
Next, we check the sheaf condition for the standard open coverings.
If $D_{+}(f) = \bigcup_{i=1}^n D_{+}(g_i)$, then the sheaf condition
for this covering is equivalent with the exactness of the
sequence
$$
0 \to M_{(f)} \to \bigoplus M_{(g_i)} \to \bigoplus M_{(g_ig_j)}.
$$
Note that $D_{+}(g_i) = D_{+}(fg_i)$, and hence we can rewrite this
sequence as the sequence
$$
0 \to M_{(f)} \to \bigoplus M_{(fg_i)} \to \bigoplus M_{(fg_ig_j)}.
$$
By Lemma \ref{lemma-standard-open} we see that
$g_1^{\deg(f)}/f^{\deg(g_1)}, \ldots, g_n^{\deg(f)}/f^{\deg(g_n)}$
generate the unit ideal in $S_{(f)}$, and that the modules
$M_{(fg_i)}$, $M_{(fg_ig_j)}$ are the principal localizations
of the $S_{(f)}$-module $M_{(f)}$ at these elements and their products.
Thus we may apply Algebra, Lemma \ref{algebra-lemma-cover-module}
to the module $M_{(f)}$ over $S_{(f)}$ and the elements
$g_1^{\deg(f)}/f^{\deg(g_1)}, \ldots, g_n^{\deg(f)}/f^{\deg(g_n)}$.
We conclude that the sequence is exact. By the remarks
made above, we see that $\widetilde M$ is a sheaf
on the basis of standard opens.

\medskip\noindent
Thus we conclude from the material in
Sheaves, Section \ref{sheaves-section-bases}
that there exists a
unique sheaf of rings $\mathcal{O}_{\text{Proj}(S)}$
which agrees with $\widetilde S$ on the standard opens.
Note that by our computation of stalks above and
Algebra, Lemma \ref{algebra-lemma-proj-prime} the
stalks of this sheaf of rings are all local rings.

\medskip\noindent
Similarly, for any graded $S$-module $M$ there exists
a unique sheaf of $\mathcal{O}_{\text{Proj}(S)}$-modules
$\mathcal{F}$ which agrees with $\widetilde M$ on the
standard opens, see
Sheaves, Lemma \ref{sheaves-lemma-extend-off-basis-module}.

\begin{definition}
\label{definition-structure-sheaf}
Let $S$ be a ring.
\begin{enumerate}
\item The {\it structure sheaf $\mathcal{O}_{\text{Proj}(S)}$ of the
homogeneous spectrum of $S$} is the unique sheaf of rings
$\mathcal{O}_{\text{Proj}(S)}$
which agrees with $\widetilde S$ on the basis of standard opens.
\item The locally ringed space
$(\text{Spec}(S), \mathcal{O}_{\text{Proj}(S)})$ is called
the {\it homogeneous spectrum} of $S$ and denoted $\text{Proj}(S)$.
\item The sheaf of $\mathcal{O}_{\text{Proj}(S)}$-modules
extending $\widetilde M$ to all opens of $\text{Proj}(S)$
is called the sheaf of $\mathcal{O}_{\text{Proj}(S)}$-modules
associated to $M$. This sheaf is denoted $\widetilde M$ as
well.
\end{enumerate}
\end{definition}

\noindent
We summarize the results obtained so far.

\begin{lemma}
\label{lemma-proj-sheaves}
Let $S$ be a graded ring. Let $M$ be a graded $S$-module.
Let $\widetilde M$ be the sheaf of $\mathcal{O}_{\text{Proj}(S)}$-modules
associated to $M$.
\begin{enumerate}
\item For every $f \in S$ homogeneous of positive degree we have
$\Gamma(D_{+}(f), \mathcal{O}_{\text{Proj}(S)}) = S_{(f)}$.
\item For every $f\in S$ homogeneous of positive degree
we have $\Gamma(D_{+}(f), \widetilde M) = M_{(f)}$
as an $S_{(f)}$-module.
\item Whenever $D_{+}(g) \subset D_{+}(f)$ the restriction mappings
on $\mathcal{O}_{\text{Proj}(S)}$ and $\widetilde M$
are the maps
$S_{(f)} \to S_{(g)}$ and $M_{(f)} \to M_{(g)}$ from Lemma
\ref{lemma-standard-open}.
\item Let $\mathfrak p$ be a homogeneous prime of $S$ not containing
$S_{+}$, and let $x \in \text{Proj}(S)$
be the corresponding point. We have
$\mathcal{O}_{\text{Proj}(S), x} = S_{(\mathfrak p)}$.
\item Let $\mathfrak p$ be a homogeneous prime of $S$ not containing
$S_{+}$, and let $x \in \text{Proj}(S)$
be the corresponding point. We have $\mathcal{F}_x = M_{(\mathfrak p)}$
as an $S_{(\mathfrak p)}$-module.
\item There is a canonical ring map
$
S_0 \longrightarrow \Gamma(\text{Proj}(S), \widetilde S)
$
and a canonical $S_0$-module map
$
M_0 \longrightarrow \Gamma(\text{Proj}(S), \widetilde M)
$
compatible with the descriptions of sections over standard opens
above and stalks above.
\end{enumerate}
Moreover, all these identifications are functorial in the $S$
module $M$. In particular, the functor $M \mapsto \widetilde M$
is an exact functor from the category of $S$-modules
to the category of $\mathcal{O}_{\text{Proj}(S)}$-modules.
\end{lemma}

\begin{proof}
Assertions (1) - (5) are clear from the discussion above.
We see (6) since there are canonical maps $M_0 \to M_{(f)}$,
$x \mapsto x/1$ compatible with the restriction maps
described in (3). The exactness of the functor $M \mapsto \widetilde M$
follows from the fact that the functor $M \mapsto M_{(\mathfrak p)}$
is exact (see Algebra, Lemma \ref{algebra-lemma-proj-prime})
and the fact that exactness of short exact sequences
may be checked on stalks, see
Modules, Lemma \ref{modules-lemma-abelian}.
\end{proof}

\begin{remark}
\label{remark-global-sections-not-isomorphism}
The map from $M_0$ to the global sections of $\widetilde M$
is generally far from being an isomorphism. A trivial
example is to take $S = k[x, y, z]$ with $1 = \deg(x) = \deg(y) = \deg(z)$
(or any number of variables) and to take $M = S/(x^{100}, y^{100}, z^{100})$.
It is easy to see that $\widetilde M = 0$, but $M_0 = k$.
\end{remark}

\begin{lemma}
\label{lemma-standard-open-proj}
Let $S$ be a graded ring. Let $f \in S$ be homogeneous of positive degree.
Suppose that $D(g) \subset \text{Spec}(S_{(f)})$ is a standard open.
Then there exists a $h \in S$ homogeneous of positive degree such that
$D(g)$ corresponds to $D_{+}(h) \subset D_{+}(f)$ via the homeomorphism
of Algebra, Lemma \ref{algebra-lemma-topology-proj}. In fact we can
take $h$ such that $g = h/f^n$ for some $n$.
\end{lemma}

\begin{proof}
Write $g = h/f^n$ for some $h$ homogeneous of positive degree
and some $n \geq 1$. If $D_{+}(h)$ is not contained in
$D_{+}(f)$ then we replace $h$ by $hf$ and $n$ by $n + 1$.
Then $h$ has the required shape and $D_{+}(h) \subset D_{+}(f)$
corresponds to $D(g) \subset \text{Spec}(S_{(f)})$.
\end{proof}

\begin{lemma}
\label{lemma-proj-scheme}
Let $S$ be a graded ring.
The locally ringed space $\text{Proj}(S)$ is a scheme.
The standard opens $D_{+}(f)$ are affine opens.
For any graded $S$-module $M$ the sheaf
$\widetilde M$ is a quasi-coherent sheaf of
$\mathcal{O}_{\text{Proj}(S)}$-modules.
\end{lemma}

\begin{proof}
Consider a standard open $D_{+}(f) \subset \text{Proj}(S)$.
We have $\Gamma(D_{+}(f), \mathcal{O}_{\text{Proj}(S)}) = S_{(f)}$
by Lemma \ref{lemma-proj-sheaves} above, and
we have a homeomorphism $\varphi : D_{+}(f) \to \text{Spec}(S_{(f)})$.
For any standard open $D(g) \subset \text{Spec}(S_{(f)})$ we may
pick a $h \in S_{+}$ as in Lemma \ref{lemma-standard-open-proj}.
Then $\varphi^{-1}(D(g)) = D_{+}(h)$, and by
Lemmas \ref{lemma-proj-sheaves} and \ref{lemma-standard-open} we see
$$
\Gamma(D_{+}(h), \mathcal{O}_{\text{Proj}(S)})
=
S_{(h)}
=
(S_{(f)})_{h^{\deg(f)}/f^{\deg(h)}}
=
(S_{(f)})_g
=
\Gamma(D(g), \mathcal{O}_{\text{Spec}(S_{(f)})}).
$$
Thus the restriction of $\mathcal{O}_{\text{Proj}(S)}$ to
$D_{+}(f)$ corresponds via the homeomorphism $\varphi$
exactly to the sheaf $\mathcal{O}_{\text{Spec}(S_{(f)})}$
as defined in Schemes, Section \ref{schemes-section-affine-schemes}.
We conclude that $D_{+}(f)$ is an affine scheme isomorphic to
$\text{Spec}(S_{(f)})$ via $\varphi$ and
hence that $\text{Proj}(S)$ is a scheme.

\medskip\noindent
In exactly the same way we show that $\widetilde M$ is a
quasi-coherent sheaf of $\mathcal{O}_{\text{Proj}(S)}$-modules.
Namely, the argument above will show that
$$
\widetilde M|_{D_{+}(f)} \cong \varphi^*\left(\widetilde{M_{(f)}}\right)
$$
which shows that $\widetilde M$ is quasi-coherent.
\end{proof}

\begin{lemma}
\label{lemma-widetilde-tensor}
Let $S$ be a graded ring.
Let $(X, \mathcal{O}_X) = (\text{Proj}(S), \mathcal{O}_{\text{Proj}(S)})$
be the scheme of Lemma \ref{lemma-proj-scheme}.
Let $f \in S_{+}$ be homogeneous. Let $x \in X$ be a point
corresponding to the homogeneous prime $\mathfrak p \subset S$.
Let $M$, $N$ be graded $S$-modules.
There is a canonical map of $\mathcal{O}_{\text{Proj}(S)}$-modules
$$
\widetilde M \otimes_{\mathcal{O}_X} \widetilde N
\longrightarrow
\widetilde{M \otimes_R N}
$$
which induces the canonical map
$
M_{(f)} \otimes_{S_{(f)}} N_{(f)}
\to
(M \otimes_S N)_{(f)}
$
on sections over $D_{+}(f)$ and the canonical map
$
M_{(\mathfrak p)} \otimes_{S_{(\mathfrak p)}} N_{(\mathfrak p)}
\to
(M \otimes_S N)_{(\mathfrak p)}
$
on stalks at $x$.
\end{lemma}

\begin{proof}
To construct a morphism as displayed is the same as constructing
a $\mathcal{O}_X$-bilinear map
$$
\widetilde M \times \widetilde N
\longrightarrow
\widetilde{M \otimes_R N}
$$
see Modules, Section \ref{modules-section-tensor-product}.
It suffices to define this on sections over the opens $D_{+}(f)$
compatible with restriction mappings. On $D_{+}(f)$ we use the
$S_{(f)}$-bilinear map
$M_{(f)} \times N_{(f)} \to (M \otimes_S N)_{(f)}$,
$(x/f^n, y/f^m) \mapsto (x \otimes y)/f^{n + m}$. Details omitted.
\end{proof}

\begin{remark}
\label{remark-not-isomorphism}
In general the map constructed in Lemma \ref{lemma-widetilde-tensor}
above is not an isomorphism. Here is an example. Let $k$
be a field. Let $S = k[x, y, z]$ with $k$ in degree $0$ and
$\deg(x) = 1$, $\deg(y) = 2$, $\deg(z) = 3$.
Let $\mathfrak p = (x, y) \in \text{Proj}(S)$.
Let $M = S(1)$ and $N = S(2)$, see
Algebra, Section \ref{algebra-section-graded}
for notation. Then $M \otimes_S N = S(3)$.
Note that
\begin{eqnarray*}
S_z
& = &
k[x, y, z, 1/z] \\
S_{(z)}
& = &
k[x^3/z, xy/z, y^3/z^2]
\cong
k[u, v, w]/(uw - v^3) \\
M_{(z)} & = & S_{(z)} \cdot x + S_{(z)} \cdot y^2/z \subset S_z \\
N_{(z)} & = & S_{(z)} \cdot y + S_{(z)} \cdot x^2/z \subset S_z \\
S(3)_{(z)} & = & S_{(z)} \cdot z \subset S_z
\end{eqnarray*}
Consider the maximal ideal $\mathfrak m = (u, v, w) \subset S_{(z)}$.
It is not hard to see that both $M_{(z)}/\mathfrak mM_{(z)}$
and $N_{(z)}/\mathfrak mN_{(z)}$ have dimension $2$ over
$\kappa(\mathfrak m)$. But
$S(3)_{(z)}/\mathfrak mS(3)_{(z)}$ has dimension $1$.
Thus the map $M_{(z)}\otimes N_{(z)} \to S(3)_{(z)}$ is not
an isomorphism.
\end{remark}

\begin{lemma}
\label{lemma-proj-separated}
Let $S$ be a graded ring.
The scheme $\text{Proj}(S)$ is separated.
\end{lemma}

\begin{proof}
We have to show that the canonical morphism
$\text{Proj}(S) \to \text{Spec}(\mathbf{Z})$
is separated.
We will use Schemes, Lemma \ref{schemes-lemma-characterize-separated}.
Thus it suffices to show given any pair of standard opens
$D_{+}(f)$ and $D_{+}(g)$ that $D_{+}(f) \cap D_{+}(g) = D_{+}(fg)$
is affine (clear) and that the ring map
$$
S_{(f)} \otimes_{\mathbf{Z}} S_{(g)} \longrightarrow S_{(fg)}
$$
is surjective. Any element $s$ in $S_{(fg)}$ is of
the form $s = h/(f^ng^m)$ with $h \in S$ homogeneous of degree
$n\deg(f) + m\deg(g)$. We may multiply $h$ by a suitable
monomial $f^ig^j$ and assume that $n = n' \deg(g)$, and
$m = m' \deg(f)$. Then we can rewrite $s$ as
$s = h/f^{(n' + m')\deg(g)} \cdot f^{m'\deg(g)}/g^{m'\deg(f)}$.
So $s$ is indeed in the image of the displayed arrow.
\end{proof}

\begin{lemma}
\label{lemma-proj-quasi-compact}
Let $S$ be a graded ring.
The scheme $\text{Proj}(S)$ is quasi-compact if and only
if there exist finitely many homogeneous elements
$f_1, \ldots, f_n \in S_{+}$ such that
$S_{+} \subset \sqrt{(f_1, \ldots, f_n)}$.
\end{lemma}

\begin{proof}
Given such a collection of elements the standard affine opens
$D_{+}(f_i)$ cover $\text{Proj}(S)$ by
Algebra, Lemma \ref{algebra-lemma-topology-proj}.
Conversely, if $\text{Proj}(S)$ is quasi-compact, then we
may cover it by finitely many standard opens 
$D_{+}(f_i)$, $i = 1, \ldots, n$ and we see that
$S_{+} \subset \sqrt{(f_1, \ldots, f_n)}$ by the
lemma referenced above.
\end{proof}




\section{Invertible sheaves on Proj}
\label{section-invertible-on-proj}

\noindent
Recall from Algebra, Section \ref{algebra-section-graded}
the construction of the twisted module $M(n)$ associated
to a graded module over a graded ring.

\begin{definition}
\label{definition-twist}
Let $S$ be a graded ring. Let $X = \text{Proj}(S)$.
We define $\mathcal{O}_X(n) = \widetilde{S(n)}$.
This is called the {\it $n$th twist of the structure sheaf of
$\text{Proj}(S)$}.
\end{definition}

\noindent
Since $S(n) \otimes_S S(m) = S(n + m)$ we see that there
are canonical maps
\begin{equation}
\label{equation-multiply}
\mathcal{O}_X(n) \otimes_{\mathcal{O}_X} \mathcal{O}_X(m)
\longrightarrow
\mathcal{O}_X(n + m).
\end{equation}
These maps are not isomorphisms in general, see the example in
Remark \ref{remark-not-isomorphism}. The same example shows
that $\mathcal{O}_X(n)$ is {\it not} an invertible sheaf on $X$ in
general. Slightly more generally, given any graded module
$M$ we get maps
\begin{equation}
\label{equation-multiply-more-generally}
\mathcal{O}_X(n) \otimes_{\mathcal{O}_X} \widetilde M
\longrightarrow
\widetilde{M(n)}
\end{equation}

\begin{lemma}
\label{lemma-when-invertible}
Let $S$ be a graded ring.
Let $f \in S$ be homogeneous of degree $d > 0$.
Let $n \in \mathbf{Z}$.
Assume $d | n$.
The sheaves $\mathcal{O}_X(n)|_{D_{+}(f)}$ are invertible,
and in fact trivial
(see Modules, Definition \ref{modules-definition-invertible}).
With the same conditions on $n$
the maps from Equations (\ref{equation-multiply}) and
(\ref{equation-multiply-more-generally}) are isomorphisms
when restricted to the open subscheme $D_{+}(f)$.
\end{lemma}

\begin{proof}
The basic reason for this is that the maps
$S \to S(n)$, and $M \to M(n)$, given by
$x \mapsto f^{n/d}x$ become isomorphisms
after inverting $f$. The first shows that
$S_{(f)} \cong S(n)_{(f)}$ which gives an isomorphism
$\mathcal{O}_{D_{+}(f)} \cong \mathcal{O}_X(n)|_{D_{+}(f)}$.
The second shows that the map
$S(n)_{(f)} \otimes_{S_{(f)}} M_{(f)} \to M(n)_{(f)}$
is an isomorphism.
\end{proof}

\noindent
The following lemma states the properties that we will later use to
characterize schemes with an ample invertible sheaf.
Recall from Modules, Lemma \ref{modules-lemma-s-open}
that given an invertible sheaf $\mathcal{L}$ on a locally ringed
space $X$, and given a global section $s$ of $\mathcal{L}$
the set $X_s = \{x \in X \mid s \not \in \mathfrak m_x\mathcal{L}_x\}$
is open.

\begin{lemma}
\label{lemma-ample-on-proj}
Let $S$ be a graded ring.
Assume that $X = \text{Proj}(S)$ is quasi-compact.
There exists an integer $d$ such that
\begin{enumerate}
\item the sheaf $\mathcal{O}_X(dn)$ is invertible for all $n \in \mathbf{Z}$,
\item all the maps
$\mathcal{O}_X(nd) \otimes_{\mathcal{O}_X} \mathcal{O}_X(md)
\longrightarrow
\mathcal{O}_X((n + m)d)$
of Equation (\ref{equation-multiply}) are isomorphisms,
\item the map
$\psi_n : S_{nd} = S(nd)_0 \to \Gamma(X, \mathcal{O}_X(nd))$
from Lemma \ref{lemma-proj-sheaves} maps $f \in S_{nd}$ to a global section
$s = \psi_n(f)$ such that $D_{+}(f) = X_s$, and
\item a basis for the topology of $X$ is given
by the sets $X_s$, where $s \in \Gamma(X, \mathcal{O}_X(nd))$,
$n \geq 1$.
\end{enumerate}
\end{lemma}

\begin{proof}
Since $X$ is quasi-compact there exist finitely many homogeneous
$f_i \in S_{+}$, $i = 1, \ldots, n$ such that the standard opens
$D_{+}(f_i)$ cover $X$. Let $d_i = \deg(f_i)$ and set
$d = d_1 \ldots d_n$.
By Lemma \ref{lemma-when-invertible} the first two assertions hold.
The restriction $\mathcal{O}_X(nd)|_{D_{+}(f_i)}$ is trivialized
using $\psi_n(f_i^{nd/d_i})$, see proof of Lemma \ref{lemma-when-invertible}.
Hence $s|_{D_{+}(f_i)} = \psi_n(f)|_{D_{+}(f_i)}$
corresponds to the element $f/f_i^{nd/d_i}$. Thus it is clear that
$X_s \cap D_{+}(f_i) = D_{+}(f) \cap D_{+}(f_i)$ for all $i$. This
proves (3). A basis for the topology is given by the sets
$D_{+}(f) = D_{+}(f^d)$, and hence (4) follows from (3).
\end{proof}











\input{chapters}

\bibliography{my}
\bibliographystyle{alpha}

\end{document}
