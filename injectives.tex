\input{preamble}

% OK, start here.
%
\begin{document}

\title{Injectives}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
We will use the existence of sufficiently many injectives to
do cohomology of abelian sheaves on a site. So we briefly
explain why there are enough injectives. At the end we explain
the more general story.

\section{Abelian groups}
\label{section-abelian-groups}

\noindent
In this section we show the category of abelian groups has enough
injectives. Recall that an abelian group $M$ is {\it divisible}
if and only if for every $x \in M$ and every $n \in \mathbf{N}$
there exists a $y \in M$ such that $n y = x$.

\begin{lemma}
\label{lemma-injective-abelian}
An abelian group $J$ is an injective object in
the category of abelian groups if and only if $J$
is divisible.
\end{lemma}

\begin{proof}
Suppose that $J$ is not divisible. Then there exists
an $x \in J$ and $n \in \mathbf{N}$ such that there
is no $y \in J$ with $n y = x$. Then the morphism
$\mathbf{Z} \to J$, $m \mapsto mx$ does not extend
to $\frac{1}{n}\mathbf{Z} \supset \mathbf{Z}$. Hence
$J$ is not injective.

\medskip\noindent
Let $A \subset B$ be abelian groups.
Assume that $J$ is a divisible abelian group.
Let $\varphi : A \to J$ be a morphism.
Consider the set of homomorphisms $\varphi' : A' \to J$
with $A \subset A' \subset B$ and $\varphi'|_A = \varphi$.
Define $(A', \varphi') \geq (A'', \varphi'')$ if
and only if $A' \supset A''$ and $\varphi'|_{A''} = \varphi''$.
If $(A_i, \varphi_i)_{i \in I}$ is a totally
ordered collection of such pairs, then we obtain a map
$\bigcup_{i \in I} A_i \to J$ defined by $a \in A_i$
maps to $\varphi_i(a)$. Thus Zorn's lemma applies.
To conclude we have to show that if the pair
$(A', \varphi')$ is maximal then $A' = B$.
In other words, it suffices to show, given
any subgroup $A \subset B$, $A \not = B$ and
any $\varphi : A \to J$, then we can find
$\varphi' : A' \to J$ with $A \subset A' \subset B$
such that (a) the inclusion $A \subset A'$ is strict, and
(b) the morphism $\varphi'$ extends $\varphi$.

\medskip\noindent
To prove this, pick $x \in B$, $x \not \in A$.
If there exists no $n\in \mathbf{N}$ such that
$nx \in A$, then $A \oplus \mathbf{Z} \cong A + \mathbf{Z}x$.
Hence we can extend $\varphi$ to $A' = A + \mathbf{Z}x$
by using $\varphi$ on $A$ and mapping $x$ to zero for example.
If there does exist an $n \in \mathbf{N}$ such that
$nx \in A$, then let $n$ be the minimal such integer.
Let $z \in J$ be an element such that $nz = \varphi(nx)$.
Define a morphism $\tilde\varphi : A \oplus \mathbf{Z} \to J$ by
$(a, m) \mapsto \varphi(a) + mz$. By our choice of
$z$ the kernel of $\tilde \varphi$ contains the kernel
of the map $A \oplus \mathbf{Z} \to B$,
$(a, m) \mapsto a + mx$. Hence $\tilde \varphi$ factors
through the image $A' = A + \mathbf{Z}x$, and this extends the morphism
$\varphi$.
\end{proof}

\noindent
We can use this lemma to show that every abelian
group can be embbeded in a injective abelian
group. But this is a special case of the result of
the following section.

\section{Modules}
\label{section-injectives-modules}

\noindent
As an example theorem let us try to prove that there are enough injective
modules over a ring $R$. We start with the fact that $\mathbf{Q}/\mathbf{Z}$
is an injective abelian group. This follows from
Lemma \ref{lemma-injective-abelian} above.

\begin{definition}
\label{definition-simple-functors}
Let $R$ be a ring.
\begin{enumerate}
\item For any $R$-module $M$ over $R$ we denote
$M^\vee = \text{Hom}(M, \mathbf{Q}/\mathbf{Z})$
with its natural $R$-module structure. We think
of {\it $M \mapsto M^\vee$} as a contravariant functor
from the category of $R$-modules to itself.
\item For any $R$-module $M$ we denote
$$
F(M) = \bigoplus\nolimits_{m \in M} R[m]
$$
the {\it free module} with basis given by the elements $[m]$ with
$m \in M$. We let $F(M)\to M$, $\sum f_i [m_i] \mapsto \sum f_i m_i$
be the natural surjection of $R$-modules.
We think of $M \mapsto (F(M) \to M)$ as a functor from
the category of $R$-modules to the category of
arrows in $R$-modules.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-vee-exact}
Let $R$ be a ring.
The functor $M \mapsto M^\vee$ is exact.
\end{lemma}

\begin{proof}
This because $\mathbf{Q}/\mathbf{Z}$
is an injective abelian group.
\end{proof}

\noindent
There is a canonical map $ev : M \to (M^\vee)^\vee$
given by evaluation: given $x \in M$ we let
$ev(x) \in (M^\vee)^\vee = \text{Hom}(M^\vee, \mathbf{Q}/\mathbf{Z})$
be the map $\varphi \mapsto \varphi(x)$.

\begin{lemma}
\label{lemma-ev-injective}
For any $R$-module $M$ the evaluation map
$ev : M \to (M^\vee)^\vee$ is injective.
\end{lemma}

\begin{proof}
You can check this using that $\mathbf{Q}/\mathbf{Z}$ is an injective
abelian group. Namely, if $x \in M$ is not zero, then let
$M' \subset M$ be the cyclic group it generates. There exists
a nonzero map $M' \to \mathbf{Q}/\mathbf{Z}$ which necessarily does
not annihilate $x$. This extends to
a map $\varphi : M \to \mathbf{Q}/\mathbf{Z}$
And then $ev(x)(\varphi) = \varphi(x) \not = 0$.
\end{proof}

\noindent
The canonical surjection $F(M) \to M$ of $R$-modules turns into a
a canonical injection, see above, of $R$-modules
$$
(M^\vee)^\vee \longrightarrow (F(M^\vee))^\vee.
$$
Set $J(M) = (F(M^\vee))^\vee$. The composition of $ev$ with this
the displayed map gives $M \to J(M)$ functorially in $M$.

\begin{lemma}
\label{lemma-JM-injective}
Let $R$ be a ring. For every $R$-module $M$ the
$R$-module $J(M)$ is injective.
\end{lemma}

\begin{proof}
Note that $J(M) \cong \prod_{m\in M} R^\vee$ as an $R$-module.
As the product of injective modules is injective, it suffices to
show that $R^\vee$ is injective. For this we use that
$$
\text{Hom}_R(N, R^\vee) =
\text{Hom}_R(N, \text{Hom}_{\mathbf{Z}}(R, \mathbf{Q}/\mathbf{Z})) =
N^\vee
$$
and the
fact that $(-)^\vee$ is an exact functor by Lemma
\ref{lemma-vee-exact}.
\end{proof}

\begin{lemma}
\label{lemma-injectives-modules}
Let $R$ be a ring.
The construction above defines a covariant functor
$M \mapsto (M \to J(M))$ from the category of
$R$-modules to the category of arrows of $R$-modules
such that for every module $M$ the output
$M \to J(M)$ is an injective map of $M$ into
an injective $R$-module $J(M)$.
\end{lemma}

\begin{proof}
Follows from the above.
\end{proof}

\noindent
In particular, for any map of $R$-modules $M \to N$
there is an associated morphism $J(M) \to J(N)$
making the following diagram commute:
$$
\xymatrix{
M \ar[d] \ar[r] & N \ar[d] \\
J(M) \ar[r] & J(N) }
$$
This the kind of construction we would like to have in general.
In Homology, Section \ref{homology-section-injectives}
we introduced terminology to express this. Namely,
we say this means that the category of $R$-modules
has functorial injective embeddings.

\section{Projective resolutions}
\label{section-projective-resolution}

\noindent
Totally unimportant. Skip this section.

\medskip\noindent
For any set $S$ we let $F(S)$ denote the free $R$-module on $S$.
Then any left $R$-module has the following two step resolution
$$
F(M\times M) \oplus F(R\times M) \to F(M) \to M \to 0.
$$
The first map is given by the rule
$$
[m_1, m_2] \oplus [r, m] \mapsto [m_1 + m_2] - [m_1] - [m_2] + [rm] - r[m].
$$

\section{Modules over noncommutative rings}
\label{section-modules-noncommutative}

\noindent
In the stacks project a ring is always commutative with $1$.
The material of
Section \ref{section-injectives-modules}
continues to work when $R$ is only a noncommutative ring, except that
if $M$ is a right $R$-module, then $M^\wedge$ is a left $R$-module and
vice-versa. The conclusion is that the category of right $R$-modules
and the category of left $R$-modules have functorial injective
embeddings.

\medskip\noindent
Precise statements and proofs omitted.



\section{Baer's argument for modules}
\label{section-baer}

\noindent
There is another, more set-theoretic approach to showing that any $R$-module
$M$ can be imbedded in an injective module. This approach constructs
the injective module by a transfinite colimit of push-outs. While this
method is somewhat abstract and more complicated than the one of 
Section \ref{section-injectives-modules},
it is also more general. Apparently this method originates with Baer,
and was revisited by Cartan and Eilenberg in
\cite{Cartan-Eilenberg} and by Grothendieck in \cite{Tohoku}.
There Grothendieck uses it to show that
many other abelian categories have enough injectives. We will get back to
the general case later (insert future reference here).

\medskip\noindent
We begin with a few set theoretic remarks.
Let $\{B_{\beta}\}_{\beta \in \alpha}$ be an inductive system of
objects in some category $\mathcal{C}$, indexed by
an ordinal $\alpha$. Assume that $\text{colim}_{\beta \in \alpha}\ B_\beta$
exists in $\mathcal{C}$. If $A$ is an object of $\mathcal{C}$, then there is a
natural map
\begin{equation}
\label{equation-compare}
\text{colim}_{\beta \in \alpha}\ \text{Mor}_{\mathcal{C}}(A, B_\beta)
\longrightarrow
\text{Mor}_{\mathcal{C}}(A, \text{colim}_{\beta \in \alpha}\ B_\beta).
\end{equation}
because if one is given a map $A \to B_\beta$ for some $\beta$, one
naturally gets a map from $A$  into the colimit by composing with
$B_\beta \to \text{colim}_{\beta \in \alpha}\ B_\alpha$.
Note that the left colimit is one of sets! In general, (\ref{equation-compare})
is neither injective or surjective.

\begin{example}
\label{example-not-surjective}
Consider the category of sets. Let $A = \mathbf{N}$ and
$B_n = \{1, \dots, n\}$ be the inductive system indexed by the natural numbers
where $B_n \to B_m$ for $n \leq m$ is the obvious map. Then
$\text{colim}\ B_n = \mathbf{N}$, so there is a map
$A \to \varinjlim B_n$, which does not factor as $A \to B_m$
for any $m$. Consequently,
$\text{colim}\ \text{Mor}(A, B_n) \to \text{Mor}(A, \text{colim}\ B_n)$
is not surjective.
\end{example}

\begin{example}
\label{example-not-injective}
Next we give an example where the map fails to be injective. Let $B_n =
\mathbb{N}/\{1,  2, \dots, n\}$, that is, the quotient set of
$\mathbb{N}$ with the first $n$ elements collapsed to one element.
There are natural maps $B_n \to B_m$ for $n \leq m$, so the
$\{B_n\}$ form a system of sets over $\mathbf{N}$. It is easy to see that
$\text{colim}\ B_n = \{*\}$: it is the one-point set.
So it follows that $\text{Mor}(A, \text{colim}\ B_n)$ is a one-element set
for every set $A$.
However, $\text{colim}\ \text{Mor}(A , B_n)$ is {\bf not} a one-element set. 
Consider the family of maps $A \to B_n$ which are just the natural projections
$\mathbb{N} \to \mathbb{N}/\{1, 2, \dots, n\}$ and the family of
maps $A \to B_n$ which map the whole of $A$ to the class of $1$.
These two families of maps are distinct at each step and thus are distinct in
$\text{colim}\ \text{Mor}(A, B_n)$, but they induce the same map
$A \to \text{colim}\ B_n$.
\end{example} 

\noindent
Nonetheless, if we map out of a finite set then
(\ref{equation-compare}) is an isomorphism always.

\begin{lemma}
\label{lemma-out-of-finite}
Suppose that, in (\ref{equation-compare}), $\mathcal{C}$ is the category
of sets and $A$ is a {\it finite set}, then the map is a bijection.
\end{lemma}

\begin{proof} 
Let $f : A \to \text{colim}\ B_\beta$.
The range of $f$ is finite, containing say
elements $c_1, \dots, c_r \in \text{colim}\ B_\beta$.
These all come from some elements in $B_\beta$ for $\beta \in \alpha$
large by definition of the colimit. Thus we can define
$\widetilde{f} : A \to B_\beta$ lifting $f$ at a finite stage.
This proves that (\ref{equation-compare}) is surjective.
Next, suppose two maps $f : A \to B_\gamma, f' : A \to B_{\gamma'}$
define the same map $A \to \text{colim}\ B_\beta$.
Then each of the finitely many elements of $A$ gets sent to the same point in
the colimit. By definition of the colimit for sets, there is
$\beta \geq \gamma, \gamma'$ such that the finitely many elements of
$A$ get sent to the same points in $B_\beta$ under $f$ and $f'$.
This proves that (\ref{equation-compare}) is injective.
\end{proof} 

\noindent
The most interesting case of the lemma is when $\alpha = \omega$, i.e.,
when the system $\{B_\beta\}$ is a system $\{B_n\}_{n \in \mathbf{N}}$
over the natural numbers as in
Examples \ref{example-not-surjective} and
\ref{example-not-injective}.
The essential idea is that $A$ is ``small'' relative to the long chain of
compositions $B_1 \to B_2 \to \dots$, so that it has to factor through a
finite step. A more general version of this lemma can be found in
Sets, Lemma \ref{sets-lemma-map-from-set-lifts}.
Next, we generalize this to the category of modules.

\begin{definition}
\label{definition-small}
Let $\mathcal{C}$ be a category, let $I \subset \text{Arrow}(\mathcal{C})$,
and let $\alpha$ be an ordinal. An object $A$ of $\mathcal{C}$ is said to
be {\it $\alpha$-small with respect to $I$} if whenever $\{B_\beta\}$ is
a system over $\alpha$ with transition maps in $I$, then
the map (\ref{equation-compare}) is an isomorphism. 
\end{definition} 

\noindent
In the rest of this section we shall restrict ourselves
to the category of $R$-modules for a fixed commutative ring $R$.
We shall also take $I$ to be the collection of injective maps, i.e., the
{\it monomorphisms} in the category of modules over $R$. In this case, for
any system $\{B_\beta\}$ as in the definition each of the maps
$$
B_\beta \to \text{colim}_{\beta \in \alpha}\ B_\beta
$$
is an injection. It follows that the map (\ref{equation-compare}) is an
{\it injection}. We can in fact interpret the $B_\beta$'s as submodules
of the module $B = \text{colim}_{\beta \in \alpha} B_\beta$, and then we
have $B = \bigcup_{\beta \in \alpha} B_\beta$. This is not an abuse of
notation if we identify $B_\alpha$ with the image in the colimit.
We now want to show that modules are always small for ``large'' ordinals
$\alpha$.

\begin{proposition}
\label{proposition-modules-are-small}
Let $R$ be a ring. Let $M$ be an $R$-module.
Let $\kappa$ the cardinality of the set of submodules of $M$.
If $\alpha$ is an ordinal whose cofinality is bigger than $\kappa$,
then $M$ is $\alpha$-small with respect to injections.
\end{proposition} 

\begin{proof} 
The proof is straightforward, but let us first think about a special case.
If $M$ is finite, then the claim is that for any inductive system
$\{B_\beta\}$ with injections between them, parametrized by a
limit ordinal, any map $M \to \text{colim}\ B_\beta$ factors through one of
the $B_\beta$. And this we proved in
Lemma \ref{lemma-out-of-finite}.

\medskip\noindent
Now we start the proof in the general case.
We need only show that the map (\ref{equation-compare}) is a surjection.
Let $f: A \to \text{colim}\ B_\beta$ be a map.
Consider the subobjects $\{f^{-1}(B_\beta)\}$ of $A$, where $B_\beta$
is considered as a subobject of the colimit $B = \bigcup_\beta B_\beta$.
If one of these, say $f^{-1}(B_\beta)$, fills $A$,
then the map factors through $B_\beta$.

\medskip\noindent
So suppose to the contrary that all of the $f^{-1}(B_\beta)$ were proper
subobjects of $A$. However, we know that
$$
\bigcup f^{-1}(B_\beta) = f^{-1}\left(\bigcup B_\beta\right) = A.
$$
Now there are at most $\kappa$ different subobjects of $A$ that occur among
the $f^{-1}(B_\alpha)$, by hypothesis. 
Thus we can find a subset $S \subset \alpha$ of cardinality at most
$\kappa$ such that as $\beta'$ ranges over $S$, the
$f^{-1}(B_{\beta'})$ range over \emph{all} the $f^{-1}(B_\alpha)$.

\medskip\noindent
However, $S$ has an upper bound $\widetilde{\alpha} < \alpha$ as
$\alpha$ has cofinality bigger than $\kappa$. In particular, all the
$f^{-1}(B_{\beta'})$, $\beta' \in S$ are contained in
$f^{-1}(B_{\widetilde{\alpha}})$.
It follows that $f^{-1}(B_{\widetilde{\alpha}}) = A$. 
In particular, the map $f$ factors through $B_{\widetilde{\alpha}}$.
\end{proof} 

\noindent
From this lemma we will be able to deduce the existence of lots of injectives.
Let us recall the criterion of Baer.

\begin{lemma}
\label{lemma-criterion-baer}
Let $R$ be a ring. An $R$-module $Q$ is injective if and only if in every
commutative diagram
$$
\xymatrix{
\mathfrak{a} \ar[d] \ar[r] &  Q \\
R \ar@{-->}[ru]
}
$$
for $\mathfrak{a} \subset R$ an ideal, the dotted arrow exists.
\end{lemma}

\begin{proof}
Assume $Q$ satisfies the assumption of the lemma.
Let $M \subset N$ be $R$-modules, and let $\varphi : M \to Q$ be an
$R$-module map. Arguing as in the proof of
Lemma \ref{lemma-injective-abelian}
we see that it suffices to prove that if $M \not = N$, then we
can find an $R$-module $M'$, $M \subset M' \subset N$
such that (a) the inclusion $M \subset M'$ is strict,
and (b) $\varphi$ can be extended to $M'$.
To find $M'$, let $x \in N$, $x \not \in M$. Let $\psi : R \to N$,
$r \mapsto rx$. Set $\mathfrak{a} = \psi^{-1}(M)$. By assumption the
morphism
$$
\mathfrak a \xrightarrow{\psi} M \xrightarrow{\varphi} Q
$$
can be extended to a morphism $\varphi' : R \to Q$.
Note that $\varphi'$ annihilates the kernel of $\psi$ (as this is true
for $\varphi$). Thus $\varphi'$ gives rise to a morphism
$\varphi'' : \text{Im}(\psi) \to Q$ which agrees with $\varphi$
on the intersection $M \cap \text{Im}(\psi)$ by construction.
Thus $\varphi$ and $\varphi''$ glue to give an extension
of $\varphi$ to the strictly bigger module
$M' = \mathcal{F} + \text{Im}(\psi)$.
\end{proof}

\noindent
If $M$ is an $R$-module, then in general we may have a semi-complete
diagram as in
Lemma \ref{lemma-criterion-baer}.
In it, we can form the \emph{push-out}
$$
\xymatrix{
\mathfrak{a} \ar[d]  \ar[r] &  Q \ar[d] \\
R \ar[r] &  R \oplus_{\mathfrak{a}} Q.
}
$$
Here the vertical map is injective, and the diagram commutes. The point is
that we can extend $\mathfrak{a} \to Q$ to $R$ \emph{if} we extend $Q$ to the
larger module $R \oplus_{\mathfrak{a}} Q$.

\medskip\noindent
The key point of Baer's argument is to repeat this procedure
transfinitely many times. To do this we first define, given an $R$-module
$M$ the following (huge) pushout
\begin{equation}
\label{equation-huge-diagram}
\vcenter{
\xymatrix{
\bigoplus_{\mathfrak a}
\bigoplus_{\varphi \in \text{Hom}_R(\mathfrak a, M)}
\mathfrak{a} \ar[r] \ar[d] & M \ar[d] \\
\bigoplus_{\mathfrak a}
\bigoplus_{\varphi \in \text{Hom}_R(\mathfrak a, M)}
R \ar[r] &  \mathbf{M}(M).
}
}
\end{equation}
Here the top horizontal arrow maps the element $a \in \mathfrak a$
in the summand corresponding to $\varphi$ to the element $\varphi(a) \in M$.
The left vertical arrow maps $a \in \mathfrak a$ in the summand corresponding
to $\varphi$ simply to the element $a \in R$ in the summand corresponding
to $\varphi$. The fundamental properties of this construction are
formulated in the following lemma.

\begin{lemma}
\label{lemma-construction}
Let $R$ be a ring.
\begin{enumerate}
\item The construction $M \mapsto (M \to \mathbf{M}(M))$
is functorial in $M$.
\item The map $M \to \mathbf{M}(M)$ is injective.
\item For any ideal $\mathfrak{a}$ and any $R$-module map
$\varphi : \mathfrak a \to M$ there is an $R$-module map
$\varphi' : R \to \mathbf{M}(M)$ such that
$$
\xymatrix{
\mathfrak{a} \ar[d] \ar[r]_\varphi &  M \ar[d] \\
R \ar[r]^{\varphi'} & \mathbf{M}(M)
}
$$
commutes.
\end{enumerate}
\end{lemma}

\begin{proof}
Parts (2) and (3) are immediate from the construction.
To see (1), let $\chi : M \to N$ be an $R$-module map. We claim there exists
a canonical commutative diagram
$$
\xymatrix{
\bigoplus_{\mathfrak a}
\bigoplus_{\varphi \in \text{Hom}_R(\mathfrak a, M)}
\mathfrak{a} \ar[r] \ar[d] \ar[rrd] & M \ar[rrd]^\chi \\
\bigoplus_{\mathfrak a}
\bigoplus_{\varphi \in \text{Hom}_R(\mathfrak a, M)}
R \ar[rrd] & & 
\bigoplus_{\mathfrak a}
\bigoplus_{\psi \in \text{Hom}_R(\mathfrak a, N)}
\mathfrak{a} \ar[r] \ar[d] & N \\
& & \bigoplus_{\mathfrak a}
\bigoplus_{\psi \in \text{Hom}_R(\mathfrak a, N)}
R
}
$$
which induces the desired map $\mathbf{M}(M) \to \mathbf{M}(N)$.
The middle east-south-east arrow maps the summand $\mathfrak a$
corresponding to $\varphi$ via $\text{id}_{\mathfrak a}$ to the
summand $\mathfrak a$ corresponding to $\psi = \chi \circ \varphi$.
Similarly for the lower east-south-east arrow. Details omitted.
\end{proof}

\noindent
The idea will now be to apply the functor $\mathbf{M}$ a transfinite number
of times. We define for each ordinal $\alpha$ a functor $\mathbf{M}_\alpha$
on the category of $R$-modules, together with a natural injection $N \to
\mathbf{M}_\alpha(N)$. We do this by transfinite induction. 
First, $\mathbf{M}_1 = \mathbf{M}$ is the functor defined above.
Now, suppose given an ordinal $\alpha$, and suppose $\mathbf{M}_{\alpha'}$
is defined for $\alpha' < \alpha$. If $\alpha$ has an immediate predecessor
$\widetilde{\alpha}$, we let
$$
\mathbf{M}_\alpha = \mathbf{M} \circ \mathbf{M}_{\widetilde{\alpha}}.
$$
If not, i.e., if $\alpha$ is a limit ordinal, we let
$$
\mathbf{M}_{\alpha}(N) =
\text{colim}_{\alpha' < \alpha}\ \mathbf{M}_{\alpha'}(N).
$$
It is clear (e.g., inductively) that the $\mathbf{M}_{\alpha}(N)$
form an inductive system over ordinals, so this is reasonable. 

\begin{theorem}
\label{theorem-baer-grothendieck}
Let $\kappa$ be the cardinality of the set of ideals in $R$, and
let $\alpha$ be an ordinal whose cofinality is greater than
$\kappa$. Then $\mathbf{M}_\alpha(N)$ is an injective $R$-module,
and $N \to \mathbf{M}_\alpha(N)$ is a functorial injective embedding.
\end{theorem}

\begin{proof} 
By Baer's criterion
Lemma \ref{lemma-criterion-baer},
it suffices to show that if $\mathfrak{a} \subset R$ is an ideal, then
any map $f : \mathfrak{a} \to \mathbf{M}_\alpha(N)$ extends to
$R \to \mathbf{M}_\alpha(N)$. However, we know since $\alpha$ is a limit
ordinal that
$$
\mathbf{M}_{\alpha}(N) =
\text{colim}_{\beta < \alpha}\ \mathbf{M}_{\beta}(N),
$$
so by
Proposition \ref{proposition-modules-are-small},
we find that
$$
\text{Hom}_R(\mathfrak{a}, \mathbf{M}_{\alpha}(N)) =
\text{colim}_{\beta < \alpha}\ \text{Hom}_R(\mathfrak a, \mathbf{M}_{\beta}(N)).
$$
This means in particular that there is some $\beta' < \alpha$
such that $f$ factors through the submodule $\mathbf{M}_{\beta'}(N)$, as
$$
f : \mathfrak{a} \to \mathbf{M}_{\beta'}(N) \to
\mathbf{M}_{\alpha}(N).
$$
However, by the fundamental property of the functor $\mathbf{M}$,
see Lemma \ref{lemma-construction} part (3),
we know that the map $\mathfrak{a} \to \mathbf{M}_{\beta'}(N)$
can be extended to 
$$
R \to \mathbf{M}( \mathbf{M}_{\beta'}(N)) =
\mathbf{M}_{\beta' + 1}(N),
$$
and the last object imbeds in $\mathbf{M}_{\alpha}(N)$ (as
$\beta' + 1 < \alpha$ since $\alpha$ is a limit ordinal).
In particular, $f$ can be extended to $\mathbf{M}_{\alpha}(N)$.
\end{proof} 




\section{G-modules}
\label{section-G-modules}

\begin{lemma}
\label{lemma-G-modules}
Let $G$ be a topological group.
The category $\textit{Mod}_G$ of discrete $G$-modules, see
\'Etale Cohomology, Definition
\ref{etale-cohomology-definition-G-module-continuous}
has functorial injective hulls.
\end{lemma}

\begin{proof}
By
Section \ref{section-modules-noncommutative}
the category $\textit{Mod}_{\mathbf{Z}[G]}$ has functorial
injective embeddings.
Consider the forgetful functor
$v : \textit{Mod}_G \to \textit{Mod}_{\mathbf{Z}[G]}$.
This functor is fully faithful, transforms injective maps into
injective maps and has a right adjoint, namely
$$
u : M \mapsto u(M) = \{x \in M \mid \text{stabilizer of }x\text{ is open}\}
$$
Since it is true that $v(M) = 0 \Rightarrow M = 0$ we conclude by
Homology, Lemma \ref{homology-lemma-adjoint-functorial-injectives}.
\end{proof}



\section{Abelian sheaves on a space}
\label{section-abelian-sheaves-space}


\begin{lemma}
\label{lemma-abelian-sheaves-space}
Let $X$ be a topological space.
The category of abelian sheaves on $X$ has enough injectives.
In fact it has functorial injective embeddings.
\end{lemma}

\begin{proof}
For an abelian group $A$ we denote $j : A \to J(A)$ the functorial
injective embedding constructed in Section \ref{section-injectives-modules}.
Let $\mathcal{F}$ be an abelian sheaf on $X$.
By Sheaves, Example \ref{sheaves-example-sheaf-product-pointwise}
the assignment
$$
\mathcal{I} : U \mapsto
\mathcal{I}(U) = \prod\nolimits_{x\in U} J(\mathcal{F}_x)
$$
is an abelian sheaf. There is a canonical map $\mathcal{F} \to \mathcal{I}$
given by mapping $s \in \mathcal{F}(U)$ to $\prod_{x \in U} j(s_x)$
where $s_x \in \mathcal{F}_x$ denotes the germ of $s$ at $x$.
This map is injective, see
Sheaves, Lemma \ref{sheaves-lemma-sheaf-subset-stalks}
for example.

\medskip\noindent
It remains to prove the following: Given a rule
$x \mapsto I_x$ which assigns to each point $x \in X$ an injective
abelian group the sheaf $\mathcal{I} : U \mapsto \prod_{x \in U} I_x$
is injective. Note that
$$
\mathcal{I} = \prod\nolimits_{x \in X} i_{x, *}I_x
$$
is the product of the skyscraper sheaves $i_{x, *}I_x$ (see
Sheaves, Section \ref{sheaves-section-skyscraper-sheaves} for notation.)
We have
$$
\text{Mor}_{\textit{Ab}}(\mathcal{F}_x, I_x)
=
\text{Mor}_{\textit{Ab}(X)}(\mathcal{F}, i_{x, *}I_x).
$$
see Sheaves, Lemma \ref{sheaves-lemma-stalk-skyscraper-adjoint}. Hence it is
clear that each $i_{x, *}I_x$ is injective. Hence the injectivity of
$\mathcal{I}$ follows from
Homology, Lemma \ref{homology-lemma-product-injectives}.
\end{proof}









\section{Sheaves of modules on a ringed space}
\label{section-sheaves-modules-space}


\begin{lemma}
\label{lemma-sheaves-modules-space}
Let $(X, \mathcal{O}_X)$ be a ringed space, see
Sheaves, Section \ref{sheaves-section-ringed-spaces}.
The category of sheaves of $\mathcal{O}_X$-modules on $X$
has enough injectives. In fact it has functorial injective embeddings.
\end{lemma}

\begin{proof}
For any ring $R$ and any $R$-module $M$ we denote
$j : M \to J_R(M)$ the functorial
injective embedding constructed in Section \ref{section-injectives-modules}.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules on $X$.
By Sheaves, Examples \ref{sheaves-example-sheaf-product-pointwise}
and \ref{sheaves-example-sheaf-product-pointwise-algebraic-structure}
the assignment
$$
\mathcal{I} : U \mapsto
\mathcal{I}(U) = \prod\nolimits_{x\in U} J_{\mathcal{O}_{X, x}}(\mathcal{F}_x)
$$
is an abelian sheaf.
There is a canonical map $\mathcal{F} \to \mathcal{I}$
given by mapping $s \in \mathcal{F}(U)$ to $\prod_{x \in U} j(s_x)$
where $s_x \in \mathcal{F}_x$ denotes the germ of $s$ at $x$.
This map is injective, see
Sheaves, Lemma \ref{sheaves-lemma-sheaf-subset-stalks}
for example.

\medskip\noindent
It remains to prove the following: Given a rule
$x \mapsto I_x$ which assigns to each point $x \in X$ an injective
$\mathcal{O}_{X, x}$-module
the sheaf $\mathcal{I} : U \mapsto \prod_{x \in U} I_x$
is injective. Note that
$$
\mathcal{I} = \prod\nolimits_{x \in X} i_{x, *}I_x
$$
is the product of the skyscraper sheaves $i_{x, *}I_x$ (see
Sheaves, Section \ref{sheaves-section-skyscraper-sheaves} for notation.)
We have
$$
\text{Mor}_{\mathcal{O}_{X, x}}(\mathcal{F}_x, I_x)
=
\text{Mor}_{\text{Mod}(\mathcal{O}_X)}(\mathcal{F}, i_{x, *}I_x).
$$
see Sheaves, Lemma \ref{sheaves-lemma-stalk-skyscraper-adjoint}. Hence it is
clear that each $i_{x, *}I_x$ is an injective $\mathcal{O}_X$-module
(see Homology, Lemma \ref{homology-lemma-adjoint-preserve-injectives} or argue
directly). Hence the injectivity of $\mathcal{I}$ follows from
Homology, Lemma \ref{homology-lemma-product-injectives}.
\end{proof}













\section{Abelian presheaves on a category}
\label{section-injectives-presheaves}

\noindent
Let $\mathcal{C}$ be a category. Recall that this means that
$\text{Ob}(\mathcal{C})$ is a set. On the one hand, consider abelian
presheaves on $\mathcal{C}$, see
Sites, Section \ref{sites-section-presheaves}.
On the other hand, consider families of abelian groups
indexed by elements of $\text{Ob}(\mathcal{C})$; in other
words presheaves on the discrete category with underlying set
of objects $\text{Ob}(\mathcal{C})$. Let us denote this
discrete category simply $\text{Ob}(\mathcal{C})$.
There is a natural functor
$$
i : \text{Ob}(\mathcal{C}) \longrightarrow \mathcal{C}
$$
and hence there is a natural restriction or forgetful functor
$$
v = i^p :
\textit{PAb}(\mathcal{C})
\longrightarrow
\textit{PAb}(\text{Ob}(\mathcal{C}))
$$
compare Sites, Section \ref{sites-section-functoriality-PSh}.
We will denote presheaves
on $\mathcal{C}$ by $B$ and presheaves on
$\text{Ob}(\mathcal{C})$ by $A$.

\medskip\noindent
There are also two functors, namely $i_p$ and ${}_pi$
which assign an abelian presheaf on $\mathcal{C}$
to an abelian presheaf on $\text{Ob}(\mathcal{C})$, see
Sites, Sections \ref{sites-section-functoriality-PSh} and
\ref{sites-section-more-functoriality-PSh}.
Here we will use $u = {}_pi$ which is defined (in the case at hand)
as follows:
$$
uA(U) = \prod\nolimits_{U' \to U} A(U').
$$
So an element is a family $(a_\phi)_\phi$ with $\phi$
ranging through all morphisms in $\mathcal{C}$ with target $U$.
The restriction map on $uA$ corresponding to $g : V \to U$
maps our element $(a_\phi)_\phi$ to the element
$(a_{g \circ \psi})_\psi$.

\medskip\noindent
There is a canonical surjective map $vuA \to A$ and a canonical
injective map $B \to uvB$. We leave it to the reader to show that
$$
\text{Mor}_{\textit{PAb}(\text{Ob}(\mathcal{C}))}(B, uA)
=
\text{Mor}_{\textit{PAb}(\mathcal{C})}(vB, A).
$$
in this simple case; the general case is in
Sites, Section \ref{sites-section-functoriality-PSh}.
Thus the pair $(u, v)$ is an example of a pair of adjoint
functors, see
Categories, Section \ref{categories-section-adjoint}.

\medskip\noindent
At this point we can list the following facts
about the situation above.
\begin{enumerate}
\item The functors $u$ and $v$ are exact. This follows from
the explicit description of these functors given above.
\item In particular the functor $v$ transforms injective maps
into injective maps.
\item The category $\textit{PAb}(\text{Ob}(\mathcal{C}))$
has enough injectives.
\item In fact there is a functorial injective embedding
$A \mapsto \big(A \to J(A)\big)$ as in
Homology, Definition \ref{homology-definition-functorial-injective-embedding}.
Namely, we can take $J(A)$ to be the
presheaf $U\mapsto J(A(U))$, where
$J(-)$ is the functor constructed in
Section \ref{section-injectives-modules} for the ring $\mathbf{Z}$.
\end{enumerate}
Putting all of this together gives us the following procedure
for embedding objects $B$ of $\text{PAb}(\mathcal{C}))$ into
an injective object: $B \to uJ(vB)$. See
Homology, Lemma \ref{homology-lemma-adjoint-functorial-injectives}.

\begin{proposition}
\label{proposition-presheaves-injectives}
For abelian presheaves on a category there is a functorial injective
embedding.
\end{proposition}

\begin{proof}
See discussion above.
\end{proof}












\section{Abelian Sheaves on a site}
\label{section-injectives-sheaves}

\noindent
Let $\mathcal{C}$ be a site. In this section we prove that there are
enough injectives for abelian sheaves on $\mathcal{C}$.

\medskip\noindent
Denote
$i : \textit{Ab}(\mathcal{C}) \longrightarrow \textit{PAb}(\mathcal{C})$
the forgetful functor from abelian sheaves to abelian presheaves.
Let
${}^\# : \textit{PAb}(\mathcal{C}) \longrightarrow \textit{Ab}(\mathcal{C})$
denote the sheafification functor. Recall that ${}^\#$ is a left adjoint
to $i$, that ${}^\#$ is exact, and that $i\mathcal{F}^\# = \mathcal{F}$
for any abelian sheaf $\mathcal{F}$. Finally, let
$\mathcal{G} \to J(\mathcal{G})$ denote the canonical
embedding into an injective presheaf we found in
Section \ref{section-injectives-presheaves}.

\medskip\noindent
For any sheaf $\mathcal{F}$ in $\text{Ab}(\mathcal{C})$ and
any ordinal $\beta$ we define a sheaf
$J_\beta(\mathcal{F})$ by transfinite induction.
We set $J_0(\mathcal{F}) = \mathcal{F}$.
We define $J_1(\mathcal{F}) = J(i\mathcal{F})^\#$.
Sheafification of the canonical map $i\mathcal{F} \to J(i\mathcal{F})$
gives a functorial map
$$
\mathcal{F} \longrightarrow J_1(\mathcal{F})
$$
which is injective as $\#$ is exact. We set
$J_{\alpha + 1}(\mathcal{F}) = J_1(J_\alpha(\mathcal{F}))$.
So that there are canonical injective maps
$J_\alpha(\mathcal{F}) \to J_{\alpha + 1}(\mathcal{F})$.
For a limit ordinal $\beta$, we define
$$
J_\beta(\mathcal{F}) = \text{colim}_{\alpha < \beta}\ J_\alpha(\mathcal{F}).
$$
Note that this is a directed colimit. Hence for any ordinals $\alpha < \beta$
we have an injective map $J_\alpha(\mathcal{F}) \to J_\beta(\mathcal{F})$.

\begin{lemma}
\label{lemma-map-into-next-one}
With notation as above.
Suppose that $\mathcal{G}_1 \to \mathcal{G}_2$ is an injective
map of abelian sheaves on $\mathcal{C}$. Let $\alpha$ be an ordinal
and let $\mathcal{G}_1 \to J_\alpha(\mathcal{F})$ be a morphism
of sheaves. There exists a morphism $\mathcal{G}_2 \to
J_{\alpha + 1}(\mathcal{F})$ such that the following diagram commutes
$$
\xymatrix{
\mathcal{G}_1 \ar[d] \ar[r] & \mathcal{G}_2 \ar[d] \\
J_{\alpha}(\mathcal{F}) \ar[r] & J_{\alpha + 1}(\mathcal{F}) }
$$
\end{lemma}

\begin{proof}
This is because the map $i\mathcal{G}_1 \to i\mathcal{G}_2$ is injective
and hence $i\mathcal{G}_1 \to iJ_\alpha(\mathcal{F})$ extends to
$i\mathcal{G}_2 \to J(iJ_\alpha(\mathcal{F}))$ which gives the
desired map after applying the sheafification functor.
\end{proof}

\noindent
This lemma says that somehow the system $\{J_{\alpha}(\mathcal{F})\}$
is an injective embedding of $\mathcal{F}$. Of course
we cannot take the limit over all $\alpha$ because they form a class
and not a set. However, the idea is now that you don't have to check
injectivity on all injections $\mathcal{G}_1 \to \mathcal{G}_2$, plus
the following lemma.

\begin{lemma}
\label{lemma-map-into-smaller}
Suppose that $\mathcal{G}_i$, $i\in I$ is set of abelian sheaves
on $\mathcal{C}$. There exists an ordinal $\beta$ such that
for any sheaf $\mathcal{F}$, any $i\in I$, and any map
$\varphi : \mathcal{G}_i \to J_\beta(\mathcal{F})$ there exists an
$\alpha < \beta$ such that $ \varphi $ factors through
$J_\alpha(\mathcal{F})$.
\end{lemma}

\begin{proof}
This reduces to the case of a single sheaf $\mathcal{G}$
by taking the direct sum of all the $\mathcal{G}_i$.

\medskip\noindent
Consider the sets
$$
S = \coprod\nolimits_{U \in \text{Ob}(\mathcal{C})} \mathcal{G}(U).
$$
and
$$
T_\beta
=
\coprod\nolimits_{U \in \text{Ob}(\mathcal{C})} J_\beta(\mathcal{F})(U)
$$
Then $T_\beta = \text{colim}_{\alpha < \beta}\ T_\alpha$
with injective transition maps.
A morphism $\mathcal{G} \to J_\beta(\mathcal{F})$ factors
through $J_\alpha(\mathcal{F})$ if and only if
the associated map $S \to T_\beta$ factors through $T_\alpha$.
By
Sets, Lemma \ref{sets-lemma-map-from-set-lifts}
the cofinality of $\beta$ is bigger than the cardinality
of $S$, then the result of the lemma is true. Hence the lemma
follows from the fact that there are ordinals with arbitrarily
large cofinality, see
Sets, Proposition \ref{sets-proposition-exist-ordinals-large-cofinality}.
\end{proof}

\noindent
Recall that for an object $X$ of $\mathcal{C}$ we denote $\mathbf{Z}_X$
the presheaf of abelian groups $\Gamma(U, \mathbf{Z}_X) =
\oplus_{U \to X} \mathbf{Z}$, see
Modules on Sites, Section \ref{sites-modules-section-free-abelian-presheaf}.
The sheaf associated to this presheaf
is denoted $\mathbf{Z}_X^\#$, see
Modules on Sites, Section \ref{sites-modules-section-free-abelian-sheaf}.
It can be characterized by
the property
\begin{equation}
\label{equation-free-sheaf-on}
\text{Mor}_{\textit{Ab}(\mathcal{C})}(\mathbf{Z}_X^\#, \mathcal{G})
=
\mathcal{G}(X)
\end{equation}
where the element $\varphi$ of the left hand side is mapped
to $\varphi(1 \cdot \text{id}_X)$ in the right hand side. We can use these
sheaves to characterize injective abelian sheaves.

\begin{lemma}
\label{lemma-characterize-injectives}
Suppose $\mathcal{J}$ is a sheaf of abelian groups with the following
property: For all $X\in \text{Ob}(\mathcal{C})$, for any abelian subsheaf
$\mathcal{S} \subset \mathbf{Z}_X^\#$ and any morphism
$\varphi : \mathcal{S} \to \mathcal{J}$, there exists a morphism
$\mathbf{Z}_X^\# \to \mathcal{J}$ extending $\varphi$.
Then $\mathcal{J}$ is an injective sheaf of abelian groups.
\end{lemma}

\begin{proof}
Let $\mathcal{F} \to \mathcal{G}$ be an injective map
of abelian sheaves. Suppose $\varphi : \mathcal{F} \to \mathcal{J}$
is a morphism. Arguing as in the proof of
Lemma \ref{lemma-injective-abelian} we see that it suffices
to prove that if $\mathcal{F} \not = \mathcal{G}$, then we
can find an abelian sheaf $\mathcal{F}'$,
$\mathcal{F} \subset \mathcal{F}' \subset \mathcal{G}$
such that (a) the inclusion $\mathcal{F} \subset \mathcal{F}'$ is strict,
and (b) $\varphi$ can be extended to $\mathcal{F}'$.
To find $\mathcal{F}'$, let $X$ be an object of $\mathcal{C}$ such
that the inclusion $\mathcal{F}(X) \subset \mathcal{G}(X)$
is strict. Pick $s \in \mathcal{G}(X)$, $s \not \in \mathcal{F}(X)$.
Let $\psi : \mathbf{Z}_X^\# \to \mathcal{G}$ be the morphism corresponding
to the section $s$ via (\ref{equation-free-sheaf-on}). Set
$\mathcal{S} = \psi^{-1}(\mathcal{F})$. By assumption the morphism
$$
\mathcal{S} \xrightarrow{\psi} \mathcal{F} \xrightarrow{\varphi} \mathcal{J}
$$
can be extended to a morphism $\varphi' : \mathbf{Z}_X^\# \to \mathcal{J}$.
Note that $\varphi'$ annihilates the kernel of $\psi$ (as this is true
for $\varphi$). Thus $\varphi'$ gives rise to a morphism
$\varphi'' : \text{Im}(\psi) \to \mathcal{J}$
which agrees with $\varphi$ on the intersection
$\mathcal{F} \cap \text{Im}(\psi)$ by construction.
Thus $\varphi$ and $\varphi''$ glue to give an extension
of $\varphi$ to the strictly bigger subsheaf
$\mathcal{F}' = \mathcal{F} + \text{Im}(\psi)$.
\end{proof}

\begin{theorem}
\label{theorem-sheaves-injectives}
The category of sheaves of abelian groups on a
site has enough injectives. In fact there exists
a functorial injective embedding, see
Homology, Definition \ref{homology-definition-functorial-injective-embedding}.
\end{theorem}

\begin{proof}
Let $\mathcal{G}_i$, $i \in I$ be a set of abelian
sheaves such that every subsheaf of every $\mathbf{Z}_X^\#$
occurs as one of the $\mathcal{G}_i$. Apply
Lemma \ref{lemma-map-into-smaller} to this collection to
get an ordinal $\beta$. We claim that for any sheaf of abelian
groups $\mathcal{F}$ the map $\mathcal{F} \to J_\beta(\mathcal{F})$
is an injection of $\mathcal{F}$ into an injective.
Note that by construction the assigment
$\mathcal{F} \mapsto \big(\mathcal{F} \to J_\beta(\mathcal{F})\big)$
is indeed functorial.

\medskip\noindent
The proof of the claim comes from the fact that by
Lemma \ref{lemma-characterize-injectives} it suffices to extend any
morphism $\gamma : \mathcal{G} \to J_\beta(\mathcal{F})$
from a subsheaf $\mathcal{G}$ of some $\mathbf{Z}_X^\#$ to all of
$\mathbf{Z}_X^\#$. Then by Lemma \ref{lemma-map-into-smaller} the
map $\gamma$ lifts into $J_\alpha(\mathcal{F})$ for some
$\alpha < \beta$. Finally, we apply Lemma \ref{lemma-map-into-next-one}
to get the desired extension of $\gamma$ to a morphism
into $J_{\alpha + 1}(\mathcal{F}) \to J_\beta(\mathcal{F})$.
\end{proof}






\section{Modules on a ringed site}
\label{section-sheaves-modules}

\noindent
Let $\mathcal{C}$ be a site.
Let $\mathcal{O}$ be a sheaf of rings on $\mathcal{C}$.
By analogy with Section \ref{section-injectives-modules}
let us try to prove that there are enough injective
$\mathcal{O}$-modules. First of all, we pick an injective
embedding
$$
\bigoplus\nolimits_{U, \mathcal{I}}
j_{U!}(\mathcal{O}|_U)/\mathcal{I}
\longrightarrow
\mathcal{J}
$$
where $\mathcal{J}$ is an injective abelian sheaf (which
exists by the previous section). Here the direct sum is
over all objects $U$ of $\mathcal{C}$ and over all
ideal sheaves $\mathcal{I} \subset j_{U!}(\mathcal{O})$
of the extension by zero of the restriction of $\mathcal{O}$ to $U$.
Insert here: future reference to the functor of restriction and
extension by $0$ for $j_U : \mathcal{C}/U \to \mathcal{C}$.

\medskip\noindent
For any sheaf of $\mathcal{O}$-modules $\mathcal{F}$ denote
$$
\mathcal{F}^\vee
=
\textit{Hom}(\mathcal{F}, \mathcal{J})
$$
with its natural $\mathcal{O}$-module structure.
Insert here future reference to internal hom.
We will also need
a canonical flat resolution of a sheaf of $\mathcal{O}$-modules.
This we can do as follows: For any $\mathcal{O}$-module
$\mathcal{F}$ we denote
$$
F(\mathcal{F})
=
\bigoplus\nolimits_{U \in \text{Ob}(\mathcal{C}), s \in \mathcal{F}(U)}
j_{U!}(\mathcal{O}|_U).
$$
This is a flat sheaf of $\mathcal{O}$-modules which comes equipped
with a canonical surjection $F(\mathcal{F}) \to \mathcal{F}$.
Moreover the construction $\mathcal{F} \mapsto F(\mathcal{F})$
is functorial in $\mathcal{F}$.

\begin{lemma}
\label{lemma-vee-exact-sheaves}
The functor $\mathcal{F} \mapsto \mathcal{F}^\vee$ is exact.
\end{lemma}

\begin{proof}
This because $\mathcal{J}$ is an injective abelian sheaf.
\end{proof}

\noindent
There is a canonical map $ev : \mathcal{F} \to (\mathcal{F}^\vee)^\vee$
given by evaluation: given $x \in \mathcal{F}(U)$ we let
$ev(x) \in (\mathcal{F}^\vee)^\vee =
\textit{Hom}(\mathcal{F}^\vee, \mathcal{J})$
be the map $\varphi \mapsto \varphi(x)$.

\begin{lemma}
\label{lemma-ev-injective-sheaves}
For any $\mathcal{O}$-module $\mathcal{F}$ the evaluation map
$ev : \mathcal{F} \to (\mathcal{F}^\vee)^\vee$ is injective.
\end{lemma}

\begin{proof}
You can check this using the definition of $\mathcal{J}$.
Namely, if $s \in \mathcal{F}(U)$ is not zero, then let
$j_{U!}(\mathcal{O}|_U) \to \mathcal{F}$ be the map of
$\mathcal{O}$-modules it generates. Then let $\mathcal{I}$
be the kernel of this map. There exists
a nonzero map $\mathcal{F} \supset j_{U!}(\mathcal{O}|_U)/\mathcal{I}
\to \mathcal{J}$ which does not annihilate $s$. This extends to a map
$\varphi : \mathcal{F} \to \mathcal{J}$
And then $ev(s)(\varphi) = \varphi(s) \not = 0$.
\end{proof}

\noindent
The canonical surjection
$F(\mathcal{F}) \to \mathcal{F}$ of $\mathcal{O}$-modules turns into a
a canonical injection, see above, of $\mathcal{O}$-modules
$$
(\mathcal{F}^\vee)^\vee \longrightarrow (F(\mathcal{F}^\vee))^\vee.
$$
Set $J(\mathcal{F}) = (F(\mathcal{F}^\vee))^\vee$.
The composition of $ev$ with this
the displayed map gives
$\mathcal{F} \to J(\mathcal{F})$ functorially in $\mathcal{F}$.

\begin{lemma}
\label{lemma-JM-injective-sheaves}
Let $\mathcal{O}$ be a sheaf of rings.
For every $\mathcal{O}$-module $\mathcal{F}$ the
$\mathcal{O}$-module $J(\mathcal{F})$ is injective.
\end{lemma}

\begin{proof}
We have to show that the functor
$\text{Hom}_\mathcal{O}(\mathcal{G}, J(\mathcal{F}))$
is exact. Note that
\begin{eqnarray*}
\text{Hom}_\mathcal{O}(\mathcal{G}, J(\mathcal{F}))
& = &
\text{Hom}_\mathcal{O}(\mathcal{G}, (F(\mathcal{F}^\vee))^\vee) \\
& = &
\text{Hom}_\mathcal{O}
(\mathcal{G}, \textit{Hom}(F(\mathcal{F}^\vee), \mathcal{J})) \\
& = &
\text{Hom}(\mathcal{G} \otimes_{\mathcal{O}} F(\mathcal{F}^\vee), \mathcal{J})
\end{eqnarray*}
Thus what we want follows from the fact that $F(\mathcal{F}^\vee)$
is flat and $\mathcal{J}$ is injective.
\end{proof}

\begin{theorem}
\label{theorem-sheaves-modules-injectives}
Let $\mathcal{C}$ be a site.
Let $\mathcal{O}$ be a sheaf of rings on $\mathcal{C}$.
The category of sheaves of $\mathcal{O}$-modules on a
site has enough injectives. In fact there exists
a functorial injective embedding, see
Homology, Definition \ref{homology-definition-functorial-injective-embedding}.
\end{theorem}

\begin{proof}
From the discussion in this section.
\end{proof}

\begin{proposition}
\label{proposition-presheaves-modules}
Let $\mathcal{C}$ be a category.
Let $\mathcal{O}$ be a presheaf of rings on $\mathcal{C}$.
The category $\textit{PMod}(\mathcal{O})$ of presheaves of
$\mathcal{O}$-modules has functorial injective embeddings.
\end{proposition}

\begin{proof}
We could prove this along the lines of the discussion in
Section \ref{section-injectives-presheaves}. But instead we argue using the
theorem above. Endow $\mathcal{C}$ with the structure of a site by letting the
set of coverings of an object $U$ consist of all singletons $\{f : V \to U\}$
where $f$ is an isomorphism. We omit the verification that this defines a site.
A sheaf for this topology is the same as a presheaf (proof omitted). Hence the
theorem applies.
\end{proof}








\section{Embedding abelian categories}
\label{section-embedding}

\noindent
In this section we show that an abelian category embeds in the
category of abelian sheaves on a site having enough points.
The site will be the one described in the following lemma.

\begin{lemma}
\label{lemma-site-abelian-category}
Let $\mathcal{A}$ be an abelian category.
Let
$$
\text{Cov} = \{\{f : V \to U\} \mid f\text{ is surjective}\}.
$$
Then $(\mathcal{A}, \text{Cov})$ is a site, see
Sites, Definition \ref{sites-definition-site}.
\end{lemma}

\begin{proof}
Note that $\text{Ob}(\mathcal{A})$ is a set by our conventions
about categories. An isomorphism is a surjective morphism.
The composition of surjective morphisms is surjective.
And the base change of a surjective morphism in $\mathcal{A}$
is surjective, see
Homology, Lemma \ref{homology-lemma-epimorphism-universal-abelian-category}.
\end{proof}

\noindent
Let $\mathcal{A}$ be a pre-additive category. In this case the
Yoneda embedding $\mathcal{A} \to \textit{PSh}(\mathcal{A})$, $X \mapsto h_X$
factors through a functor $\mathcal{A} \to \textit{PAb}(\mathcal{A})$.

\begin{lemma}
\label{lemma-embedding}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{C} = (\mathcal{A}, \text{Cov})$ be the
site defined in
Lemma \ref{lemma-site-abelian-category}.
Then $X \mapsto h_X$ defines a fully faithful, exact functor
$$
\mathcal{A} \longrightarrow \textit{Ab}(\mathcal{C}).
$$
Moreover, the site $\mathcal{C}$ has enough points.
\end{lemma}

\begin{proof}
Suppose that $f : V \to U$ is a surjective morphism of $\mathcal{A}$.
Let $K = \text{Ker}(f)$. Recall that
$V \times_U V = \text{Ker}((f, -f) : V \oplus V \to U)$, see
Homology, Example \ref{homology-example-fibre-product-pushouts}.
In particular there exists an injection $K \oplus K \to V \times_U V$.
Let $p, q : V \times_U V \to V$ be the two projection morphisms.
Note that $p - q : V \times_U V \to V$ is a morphism such that
$f \circ (p  - q) = 0$. Hence $p - q$ factors through $K \to V$.
Let us denote this morphism by $c : V \times_K V \to K$.
And since the composition $K \oplus K \to V \times_U V \to K$
is surjective, we conclude that $c$ is surjective. It follows that
$$
V \times_K V \xrightarrow{p - q} V \to U \to 0
$$
is an exact sequence of $\mathcal{A}$.
Hence for an object $X$ of $\mathcal{A}$ the sequence
$$
0 \to
\text{Hom}_{\mathcal{A}}(U, X) \to
\text{Hom}_{\mathcal{A}}(V, X) \to
\text{Hom}_{\mathcal{A}}(V \times_U V, X)
$$
is an exact sequence of abelian groups, see
Homology, Lemma \ref{homology-lemma-check-exactness}.
This means that $h_X$ satisfies the sheaf condition
on $\mathcal{C}$.

\medskip\noindent
The functor is fully faithful by
Categories, Lemma \ref{categories-lemma-yoneda}.
The functor is a left exact functor between abelian categories by
Homology, Lemma \ref{homology-lemma-check-exactness}.
To show that it is right exact, let $X \to Y$ be a surjective morphism
of $\mathcal{A}$. Let $U$ be an object of $\mathcal{A}$, and let
$s \in h_Y(U) = \text{Mor}_{\mathcal{A}}(U, Y)$ be a section of $h_Y$
over $U$. By
Homology, Lemma \ref{homology-lemma-epimorphism-universal-abelian-category}
the projection $U \times_Y X \to U$ is surjective.
Hence $\{V = U \times_Y X \to U\}$ is a covering of $U$ such that
$s|_V$ lifts to a section of $h_X$. This proves that
$h_X \to h_Y$ is a surjection of abelian sheaves, see
Sites, Lemma \ref{sites-lemma-mono-epi-sheaves}.

\medskip\noindent
The site $\mathcal{C}$ has enough points by
Sites, Proposition \ref{sites-proposition-criterion-points}.
\end{proof}

\begin{remark}
\label{remark-embedding}
The Freyd-Mitchell embedding theorem says there exists a fully faithful
exact functor from any abelian category $\mathcal{A}$
to the category of modules over a ring.
Lemma \ref{lemma-embedding}
is not quite as strong. But the result is suitable for the
stacks project as we have to understand sheaves of abelian groups on
sites in detail anyway. Moreover, ``diagram chasing'' works in the category
of abelian sheaves on $\mathcal{C}$, for example by working with sections over
objects, or by working on the level of stalks using that $\mathcal{C}$ has
enough points. To see how to deduce the Freyd-Mitchell embedding theorem from
Lemma \ref{lemma-embedding}
see
Remark \ref{remark-embedding-freyd}.
\end{remark}

\begin{remark}
\label{remark-embedding-big}
If $\mathcal{A}$ is a ``big'' abelian category, i.e., if $\mathcal{A}$
has a class of objects, then
Lemma \ref{lemma-embedding}
does not work. In this case, given any set of objects
$E \subset \text{Ob}(\mathcal{A})$ there exists an abelian full subcategory
$\mathcal{A}' \subset \mathcal{A}$ such that
$\text{Ob}(\mathcal{A}')$ is a set and $E \subset \text{Ob}(\mathcal{A}')$.
Then one can apply
Lemma \ref{lemma-embedding}
to $\mathcal{A}'$. One can use this to prove that results depending on
a diagram chase hold in $\mathcal{A}$.
\end{remark}

\begin{remark}
\label{remark-embedding-freyd}
Let $\mathcal{C}$ be a site.
Note that $\textit{Ab}(\mathcal{C})$ has enough injectives, see
Theorem \ref{theorem-sheaves-injectives}.
(In the case that $\mathcal{C}$ has enough points this is straightforward
because  $p_*I$ is an injective sheaf if $I$ is an injective
$\mathbf{Z}$-module and $p$ is a point.)
Also, $\textit{Ab}(\mathcal{C})$ has a cogenerator (details omitted).
Hence
Lemma \ref{lemma-embedding}
proves that we have a fully faithful, exact embedding
$\mathcal{A} \to \mathcal{B}$ where $\mathcal{B}$ has a
cogenerator and enough injectives.
We can apply this to $\mathcal{A}^{opp}$ and we get a
fully faithful exact functor
$i : \mathcal{A} \to \mathcal{D} = \mathcal{B}^{opp}$
where $\mathcal{D}$ has enough projectives and a generator. Hence
$\mathcal{D}$ has a projective generator $P$.
Set $R = \text{Mor}_{\mathcal{D}}(P, P)$. Then
$$
\mathcal{A} \longrightarrow \textit{Mod}_R,\quad
X \longmapsto \text{Hom}_{\mathcal{D}}(P, X).
$$
One can check this is a fully faithful, exact functor.
In other words, one retrieves the
Freyd-Mitchell theorem mentioned in
Remark \ref{remark-embedding}
above.
\end{remark}

\begin{remark}
\label{remark-embed-exact-category}
The arguments proving
Lemmas \ref{lemma-site-abelian-category} and
\ref{lemma-embedding}
work also for {\it exact categories}, see
\cite[Appendix A]{Buhler} and
\cite[1.1.4]{BBD}.
We quickly review this here and we add more details if we ever
need it in the stacks project.

\medskip\noindent
Let $\mathcal{A}$ be an additive category.
A {\it kernel-cokernel} pair is a pair $(i, p)$
of morphisms of $\mathcal{A}$ with
$i : A \to B$, $p : B \to C$ such that $i$ is the kernel of 
$p$ and $p$ is the cokernel of $i$.
Given a set $\mathcal{E}$ of kernel-cokernel pairs we say
$i : A \to B$ is an {\it admissible monomorphism}
if $(i, p) \in \mathcal{E}$ for some morphism $p$.
Similarly we say a morphism $p : B \to C$ is an {\it admissible epimorphism}
if $(i, p) \in \mathcal{E}$ for some morphism $i$.
The pair $(\mathcal{A}, \mathcal{E})$ is said to be an
{\it exact category} if the following axioms hold
\begin{enumerate}
\item $\mathcal{E}$ is closed under isomorphisms of kernel-cokernel
pairs,
\item for any object $A$ the pairs $1_A$ is both an admissible epimorphism
and an admissible monomorphism,
\item admissible monomorphisms are stable under composition,
\item admissible epimorphisms are stable under composition,
\item the push-out of an admissible monomorphism $i : A \to B$ via
any morphism $A \to A'$ exist and the induced morphism $i' : A' \to B'$
is an admissible monomorphism, and
\item the base change of an admissible epimorphism $p : B \to C$ via
any morphism $C' \to C$ exist and the induced morphism $p' : B' \to C'$
is an admissible epimorphism.
\end{enumerate}
Given such a structure let $\mathcal{C} = (\mathcal{A}, \text{Cov})$
where coverings (i.e., elements of $\text{Cov}$) are given by
admissible epimorphisms. The axioms listed above
immediately imply that this is a site. Consider the functor
$$
F : \mathcal{A} \longrightarrow \textit{Ab}(\mathcal{C}), \quad
X \longmapsto h_X
$$
exactly as in
Lemma \ref{lemma-embedding}.
It turns out that this functor is fully faithful, exact, and reflects
exactness. Moreover, any extension of objects in the essential image
of $F$ is in the essential image of $F$.
\end{remark}






\section{Grothendieck categories and injectives}
\label{section-grothendieck-categories}

\noindent
Here we can talk in general about generators, limits and
all that good stuff. This will possibly be needed later on
anyway.

\medskip\noindent
Grothendieck proved the existence of injectives in great generality
in the paper \cite{Tohoku}.


\input{chapters}


\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
