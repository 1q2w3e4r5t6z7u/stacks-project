\input{preamble}

% OK, start here.
%
\begin{document}

\title{Cohomology of Algebraic Spaces}

\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents




\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we write about cohomology of algebraic spaces.
This mean in particular cohomology of quasi-coherent sheaves, i.e.,
we prove analogues of the results in the chapter entitled
``Coherent Cohomology''. Some of the results in this chapter can
be found in \cite{knutson}.





\section{Conventions}
\label{section-conventions}

\noindent
The standing assumption is that all schemes are contained in
a big fppf site $\Sch_{fppf}$. And all rings $A$ considered
have the property that $\Spec(A)$ is (isomorphic) to an
object of this big site.

\medskip\noindent
Let $S$ be a scheme and let $X$ be an algebraic space over $S$.
In this chapter and the following we will write $X \times_S X$
for the product of $X$ with itself (in the category of algebraic
spaces over $S$), instead of $X \times X$.




\section{Derived category of quasi-coherent modules}
\label{section-derived-quasi-coherent}

\noindent
Let $S$ be a scheme. In
Descent, Lemma \ref{descent-lemma-derived-quasi-coherent-small-etale-site}
we proved that the category $D_{QCoh}(\mathcal{O}_S)$ can be defined
in terms of complexes of $\mathcal{O}_S$-modules on the scheme $S$
or by complexes of $\mathcal{O}$-modules on the small \'etale site
of $S$. Hence the following definition is compatible with the definition
in the case of schemes.

\begin{definition}
\label{definition-derived-quasi-coherent}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
The {\it derived category of $\mathcal{O}_X$-modules with
quasi-coherent cohomology sheaves} is denoted
$D_{QCoh}(\mathcal{O}_X)$.
\end{definition}

\noindent
This makes sense by
Properties of Spaces, Lemma
\ref{spaces-properties-lemma-properties-quasi-coherent}
and
Derived Categories, Section \ref{derived-section-triangulated-sub}.








\section{Higher direct images}
\label{section-higher-direct-image}

\noindent
Let $S$ be a scheme. Let $f : X \to Y$ be a quasi-compact and quasi-separated
morphism of representable algebraic spaces $X$ and $Y$ over $S$. Let
$\mathcal{F}$ be a quasi-coherent module on $X$. By
Descent, Lemma \ref{descent-lemma-higher-direct-images-small-etale}
the sheaf $R^if_*\mathcal{F}$ agrees with the
usual higher direct image (computed for the Zariski topologies)
if we think of $X$ and $Y$ as schemes.

\medskip\noindent
More generally, suppose $f : X \to Y$ is a representable, quasi-compact, and
quasi-separated morphism of algebraic spaces over $S$. Let $V$ be a scheme
and let $V \to Y$ be an \'etale surjective morphism. Let $U = V \times_Y X$
and let $f' : U \to V$ be the base change of $f$. Then for any
quasi-coherent $\mathcal{O}_X$-module $\mathcal{F}$ we have
\begin{equation}
\label{equation-representable-higher-direct-image}
R^if'_*(\mathcal{F}|_U) = (R^if_*\mathcal{F})|_V,
\end{equation}
see
Properties of Spaces,
Lemma \ref{spaces-properties-lemma-pushforward-etale-base-change-modules}.
And because $f' : U \to V$ is a quasi-compact and quasi-separated
morphism of schemes, by the remark of the preceding paragraph we may
compute $R^if'_*(\mathcal{F}|_U)$ by thinking of $\mathcal{F}|_U$ as a
quasi-coherent sheaf on the scheme $U$, and $f'$ as a morphism of schemes.
We will frequently use this without further mention.

\medskip\noindent
Next, we prove that higher direct images of quasi-coherent sheaves are
quasi-coherent for any quasi-compact and quasi-separated morphism of
algebraic spaces. In the proof we use a trick; a ``better'' proof would
use a relative Cech complex, as discussed in
Sheaves on Stacks, Sections \ref{stacks-sheaves-section-cech} and
\ref{stacks-sheaves-section-sheaf-cech-complex} ff.

\begin{lemma}
\label{lemma-higher-direct-image}
Let $S$ be a scheme. Let $f : X \to Y$ be a morphism of algebraic spaces
over $S$. If $f$ is quasi-compact and quasi-separated, then $R^if_*$
transforms quasi-coherent $\mathcal{O}_X$-modules into
quasi-coherent $\mathcal{O}_Y$-modules and induces a functor
$Rf_* : D_{QCoh}^+(\mathcal{O}_X) \to D_{QCoh}^+(\mathcal{O}_Y)$.
\end{lemma}

\begin{proof}
Let $V \to Y$ be an \'etale morphism where $V$ is an affine scheme. Set
$U = V \times_Y X$ and denote $f' : U \to V$ the induced morphism.
Let $\mathcal{I}^\bullet$ be a bounded above complex of injective
$\mathcal{O}_X$-modules. By
Properties of Spaces, Lemma
\ref{spaces-properties-lemma-pushforward-etale-base-change-modules}
we have
$$
f'_*(\mathcal{I}^\bullet|_U) = (f_*\mathcal{I}^\bullet)|_V.
$$
The complex $\mathcal{I}^\bullet|_U$ is a bounded below complex
of injective $\mathcal{O}_U$-modules, see
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-cohomology-of-open}.
Since the property of being a quasi-coherent module is local in the
\'etale topology on $Y$ (see
Properties of Spaces, Lemma
\ref{spaces-properties-lemma-characterize-quasi-coherent})
we may replace $Y$ by $V$, i.e., we may assume $Y$ is an affine scheme.

\medskip\noindent
Assume $Y$ is affine. Since $f$ is quasi-compact we see that $X$
is quasi-compact. Thus we may choose an affine scheme $U$ and a surjective
\'etale morphism $g : U \to X$, see
Properties of Spaces,
Lemma \ref{spaces-properties-lemma-quasi-compact-affine-cover}.
Note that the morphism $g : U \to X$ is representable, separated
and quasi-compact because $X$ is quasi-separated. Hence the lemma
holds for $g$ (either by the discussion above the lemma or by
applying the reduction in the first paragraph of this proof).
It also holds for $f \circ g : U \to Y$ (as this is a morphism
of affine schemes). Moreover, for an injective $\mathcal{O}_U$-module
$\mathcal{I}$ the module $g_*\mathcal{I}$ is injective (see
Homology, Lemma \ref{homology-lemma-adjoint-preserve-injectives})
whence $Rf_* \circ Rg_* = R(g \circ f)_*$, see
Derived Categories, Lemma \ref{derived-lemma-compose-derived-functors}.

\medskip\noindent
In the situation described in the previous paragraph we will show by
induction on $n$ that $IH_n$: for any quasi-coherent sheaf $\mathcal{F}$
on $X$ the sheaves $R^if\mathcal{F}$
are quasi-coherent for $i \leq n$.
The case $n = 0$ follows from
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-pushforward}.
Assume $IH_n$. In the rest of the proof we show that $IH_{n + 1}$ holds.

\medskip\noindent
The hypothesis $IH_n$ implies, via the spectral sequence of
Derived Categories, Lemma \ref{derived-lemma-two-ss-complex-functor},
that $R^if_*\mathcal{G}^\bullet$ is quasi-coherent for $i \leq n$ if
$\mathcal{G}^\bullet$ is a complex of $\mathcal{O}_X$-modules with
$H^j(\mathcal{G}^\bullet) = 0$ for $j < 0$ and $H^j(\mathcal{G}^\bullet)$
is quasi-coherent for all $j$. Suppose $\mathcal{H}$ is
a quasi-coherent $\mathcal{O}_U$-module. Consider the distinguished triangle
$$
g_*\mathcal{H} \to Rg_*\mathcal{H} \to
\tau_{\geq 1}Rg_*\mathcal{H} \to g_*\mathcal{H}[1].
$$
Note that $Rg_*\mathcal{H}$ and
$Rf_*Rg_*\mathcal{H} = R(f \circ g)_*\mathcal{H}$
have quasi-coherent cohomology sheaves (see above). Combined with
the remark above we conclude that $IH_n$ implies that
$R^if_*g_*\mathcal{H}$ is quasi-coherent for $i \leq n + 1$.

\medskip\noindent
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module. Consider
the exact sequence
$$
0 \to \mathcal{F} \to g_*g^*\mathcal{F} \to \mathcal{G} \to 0
$$
where $\mathcal{G}$ is the cokernel of the first map.
Applying the long exact cohomology sequence we obtain
$$
R^nf_*g_*g^*\mathcal{F} \to
R^nf_*\mathcal{G} \to
R^{n + 1}f_*\mathcal{F} \to
R^{n + 1}f_*g_*g^*\mathcal{F} \to
R^{n + 1}f_*\mathcal{G}
$$
By the above we see that $R^{n + 1}f_*g_*g^*\mathcal{F}$
is quasi-coherent. Thus $R^{n + 1}f_*\mathcal{F}$ has a $2$-step filtration
where the first step is quasi-coherent and the second a subsheaf of
a quasi-coherent sheaf. Applying this to $R^{n + 1}f_*\mathcal{G}$
we find an exact sequence $0 \to \mathcal{A} \to R^{n + 1}f_*\mathcal{G}
\to \mathcal{B}$ wit $\mathcal{A}$, $\mathcal{B}$ quasi-coherent
$\mathcal{O}_Y$-modules. Then the kernel $\mathcal{K}$ of
$R^{n + 1}f_*g_*g^*\mathcal{F} \to R^{n + 1}f_*\mathcal{G}
\to \mathcal{B}$ is quasi-coherent, whereupon we obtain a map
$\mathcal{K} \to \mathcal{A}$ whose kernel $\mathcal{K}'$ is
quasi-coherent too. Hence $R^{n + 1}f_*\mathcal{F}$ sits in an exact
sequence
$$
R^nf_*g_*g^*\mathcal{F} \to
R^nf_*\mathcal{G} \to
R^{n + 1}f_*\mathcal{F} \to \mathcal{K}' \to 0
$$
and we win.
\end{proof}




\section{Colimits and cohomology}
\label{section-colimits}

\noindent
The following lemma in particular applies to diagrams of quasi-coherent
sheaves.

\begin{lemma}
\label{lemma-colimits}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
If $X$ is quasi-compact and quasi-separated, then
$$
\colim_i H^p(X, \mathcal{F}_i)
\longrightarrow
H^p(X, \colim_i \mathcal{F}_i)
$$
for every filtered diagram of abelian sheaves on $X_{\acute{e}tale}$.
\end{lemma}

\begin{proof}
This follows from
Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-colim-works-over-collection}.
Namely, let $\mathcal{B} \subset \Ob(X_{spaces, \acute{e}tale})$
be the set of quasi-compact and quasi-separated spaces \'etale over $X$.
Note that if $U \in \mathcal{B}$ then, because $U$ is quasi-compact,
the collection of finite coverings $\{U_i \to U\}$ with $U_i \in \mathcal{B}$
is cofinal in the set of coverings of $U$ in $X_{\acute{e}tale}$. By
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-quasi-compact-quasi-separated-permanence}
the set $\mathcal{B}$ satisfies all the assumptions of
Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-colim-works-over-collection}.
Since $X \in \mathcal{B}$ we win.
\end{proof}

\begin{lemma}
\label{lemma-colimit-cohomology}
Let $S$ be a scheme. Let $f : X \to Y$ be a quasi-compact and quasi-separated
morphism of algebraic spaces over $S$. Let $\mathcal{F} = \colim \mathcal{F}_i$
be a filtered colimit of abelian sheaves on $X_{\acute{e}tale}$.
Then for any $p \geq 0$ we have
$$
R^pf_*\mathcal{F} = \colim R^pf_*\mathcal{F}_i.
$$
\end{lemma}

\begin{proof}
Recall that $R^pf_*\mathcal{F}$ is the sheaf on $Y_{spaces, \acute{e}tale}$
associated to $V \mapsto H^p(V \times_Y X, \mathcal{F})$, see
Cohomology of Sites, Lemma \ref{sites-cohomology-lemma-higher-direct-images}
and Properties of Spaces, Lemma
\ref{spaces-properties-lemma-functoriality-etale-site}.
Recall that the colimit is the sheaf associated to the presheaf colimit.
Hence we can apply Lemma \ref{lemma-colimits}
to $H^p(V \times_Y X, -)$ where $V$ is affine to conclude (because
when $V$ is affine, then $V \times_Y X$ is quasi-compact and quasi-separated).
Strictly speaking this also uses Properties of Spaces,
Lemma \ref{spaces-properties-lemma-alternative} to see that there exist
enough affine objects.
\end{proof}

\noindent
The following lemma tells us that finitely presented modules behave
as expected in quasi-compact and quasi-separated algebraic spaces.

\begin{lemma}
\label{lemma-finite-presentation-quasi-compact-colimit}
Let $S$ be a scheme. Let $X$ be a quasi-compact and quasi-separated
algebraic space over $S$. Let $I$ be a partially ordered set and
let $(\mathcal{F}_i, \varphi_{ii'})$ be a system over $I$
of quasi-coherent $\mathcal{O}_X$-modules. Let $\mathcal{G}$ be an
$\mathcal{O}_X$-module of finite presentation. Then we have
$$
\colim_i \Hom_X(\mathcal{G}, \mathcal{F}_i)
=
\Hom_X(\mathcal{G}, \colim_i \mathcal{F}_i).
$$
\end{lemma}

\begin{proof}
Choose an affine scheme $U$ and a surjective \'etale morphism
$U \to X$. Set $R = U \times_X U$. Note that $R$ is a quasi-compact
(as $X$ is quasi-separated and $U$ quasi-compact) and separated (as
$U$ is separated) scheme. Hence we have
$$
\colim_i \Hom_U(\mathcal{G}|_U, \mathcal{F}_i|_U)
=
\Hom_U(\mathcal{G}|_U, \colim_i \mathcal{F}_i|_U).
$$
by Modules, Lemma \ref{modules-lemma-finite-presentation-quasi-compact-colimit}
(and the material on restriction to
schemes \'etale over $X$, see
Properties of Spaces, Sections \ref{spaces-properties-section-quasi-coherent}
and \ref{spaces-properties-section-properties-modules}). Similarly for $R$.
Since $\textit{QCoh}(X) = \textit{QCoh}(U, R, s, t, c)$ (see
Properties of Spaces, Proposition
\ref{spaces-properties-proposition-quasi-coherent})
the result follows formally.
\end{proof}




\section{The alternating {\v C}ech complex}
\label{section-alternating-cech}

\noindent
Let $S$ be a scheme. Let $f : U \to X$ be an \'etale morphism of algebraic
spaces over $S$. The functor
$$
j : U_{spaces, \acute{e}tale} \longrightarrow X_{spaces, \acute{e}tale},\quad
V/U \longmapsto V/X
$$
induces an equivalence of $U_{spaces, \acute{e}tale}$ with the localization
$X_{spaces, \acute{e}tale}/U$, see
Properties of Spaces, Section \ref{spaces-properties-section-localize}.
Hence there exist functors
$$
f_! : \textit{Ab}(U_{\acute{e}tale}) \longrightarrow
\textit{Ab}(X_{\acute{e}tale}),\quad
f_! : \textit{Mod}(\mathcal{O}_U) \longrightarrow \textit{Mod}(\mathcal{O}_X),
$$
which are left adjoint to
$$
f^{-1} : \textit{Ab}(X_{\acute{e}tale}) \longrightarrow
\textit{Ab}(U_{\acute{e}tale}),\quad
f^* : \textit{Mod}(\mathcal{O}_X) \longrightarrow \textit{Mod}(\mathcal{O}_U)
$$
see
Modules on Sites, Section \ref{sites-modules-section-localize}.
Warning: This functor, a priori, has
nothing to do with cohomology with compact supports!
We dubbed this functor ``extension by zero'' in the reference above.
Note that the two versions of $f_!$ agree as $f^* = f^{-1}$ for
sheaves of $\mathcal{O}_X$-modules.

\medskip\noindent
As we are going to use this construction below let us recall some of its
properties. Given an abelian sheaf $\mathcal{G}$ on $U_{\acute{e}tale}$
the sheaf $f_!$ is the sheafification of the presheaf
$$
V/X \longmapsto
f_!\mathcal{G}(V) =
\bigoplus\nolimits_{\varphi \in \Mor_X(V, U)}
\mathcal{G}(V \xrightarrow{\varphi} U),
$$
see
Modules on Sites, Lemma \ref{sites-modules-lemma-extension-by-zero}.
Moreover, if $\mathcal{G}$ is an $\mathcal{O}_U$-module, then $f_!\mathcal{G}$
is the sheafification of the exact same presheaf of abelian groups which
is endowed with an $\mathcal{O}_X$-module structure in an obvious way
(see loc.\ cit.). Let $\overline{x} : \Spec(k) \to X$
be a geometric point. Then there is a canonical identification
$$
(f_!\mathcal{G})_{\overline{x}} =
\bigoplus\nolimits_{\overline{u}} \mathcal{G}_{\overline{u}}
$$
where the sum is over all $\overline{u} : \Spec(k) \to U$ such that
$f \circ \overline{u} = \overline{x}$, see
Modules on Sites, Lemma \ref{sites-modules-lemma-stalk-j-shriek}.
In the following we are going to study the sheaf $f_!\underline{\mathbf{Z}}$.
Here $\underline{\mathbf{Z}}$ denotes the constant sheaf on
$X_{\acute{e}tale}$ or $U_{\acute{e}tale}$.

\begin{lemma}
\label{lemma-product-is-tensor-product}
Let $S$ be a scheme. Let $f_i : U_i \to X$ be \'etale morphisms
of algebraic spaces over $S$. Then there are isomorphisms
$$
f_{1, !}\underline{\mathbf{Z}} \otimes_{\mathbf{Z}}
f_{2, !}\underline{\mathbf{Z}}
\longrightarrow
f_{12, !}\underline{\mathbf{Z}}
$$
where $f_{12} : U_1 \times_X U_2 \to X$ is the structure morphism
and
$$
(f_1 \amalg f_2)_! \underline{\mathbf{Z}}
\longrightarrow
f_{1, !}\underline{\mathbf{Z}} \oplus
f_{2, !}\underline{\mathbf{Z}}
$$
\end{lemma}

\begin{proof}
Once we have defined the map it will be an isomorphism by our description
of stalks above. To define the map it suffices to work on the level of
presheaves. Thus we have to define a map
$$
\left(\bigoplus\nolimits_{\varphi_1 \in \Mor_X(V, U_1)} \mathbf{Z}\right)
\otimes_{\mathbf{Z}}
\left(\bigoplus\nolimits_{\varphi_2 \in \Mor_X(V, U_2)} \mathbf{Z}\right)
\longrightarrow
\bigoplus\nolimits_{\varphi \in \Mor_X(V, U_1 \times_X U_2)}
\mathbf{Z}
$$
We map the element $1_{\varphi_1} \otimes 1_{\varphi_2}$ to the element
$1_{\varphi_1 \times \varphi_2}$ with obvious notation. We omit the proof
of the second equality.
\end{proof}

\noindent
Another important feature is the trace map
$$
\text{Tr}_f : f_!\underline{\mathbf{Z}} \longrightarrow \underline{\mathbf{Z}}.
$$
The trace map is adjoint to the
map $\mathbf{Z} \to f^{-1}\underline{\mathbf{Z}}$ (which is an isomorphism).
If $\overline{x}$ is above, then $\text{Tr}_f$ on stalks at $\overline{x}$
is the map
$$
(\text{Tr}_f)_{\overline{x}} :
(f_!\underline{\mathbf{Z}})_{\overline{x}} =
\bigoplus\nolimits_{\overline{u}} \mathbf{Z}
\longrightarrow
\mathbf{Z} = \underline{\mathbf{Z}}_{\overline{x}}
$$
which sums the given integers. This is true because it is adjoint to the map
$1 : \mathbf{Z} \to f^{-1}\underline{\mathbf{Z}}$. In particular, if
$f$ is surjective as well as \'etale then $\text{Tr}_f$ is surjective.

\medskip\noindent
Assume that $f : U \to X$ is a surjective \'etale
morphism of algebraic spaces. Consider the {\it Koszul complex}
associated to the trace map we discussed above
$$
\ldots \to \wedge^3f_!\underline{\mathbf{Z}} \to
\wedge^2f_!\underline{\mathbf{Z}} \to f_!\underline{\mathbf{Z}} \to
\underline{\mathbf{Z}} \to 0
$$
Here the exterior powers are over the sheaf of rings $\underline{\mathbf{Z}}$.
The maps are defined by the rule
$$
e_1 \wedge \ldots \wedge e_n \longmapsto
\sum\nolimits_{i = 1, \ldots, n} (-1)^{i + 1}
\text{Tr}_f(e_i)
e_1 \wedge \ldots \wedge \widehat{e_i} \wedge \ldots \wedge e_n
$$
where $e_1, \ldots, e_n$ are local sections of $f_!\underline{\mathbf{Z}}$.
Let $\overline{x}$ be a geometric point of $X$ and set
$M_{\overline{x}} = (f_!\underline{\mathbf{Z}})_{\overline{x}} =
\bigoplus_{\overline{u}} \mathbf{Z}$. Then the stalk of the complex above at
$\overline{x}$ is the complex
$$
\ldots \to \wedge^3 M_{\overline{x}} \to \wedge^2 M_{\overline{x}}
\to M_{\overline{x}} \to \mathbf{Z} \to 0
$$
which is exact because $M_{\overline{x}} \to \mathbf{Z}$ is surjective, see
More on Algebra, Lemma \ref{more-algebra-lemma-homotopy-koszul-abstract}.
Hence if we let $K^\bullet = K^\bullet(f)$ be the complex with
$K^i = \wedge^{i + 1}f_!\underline{\mathbf{Z}}$, then we obtain a
quasi-isomorphism
\begin{equation}
\label{equation-quasi-isomorphism}
K^\bullet \longrightarrow \underline{\mathbf{Z}}[0]
\end{equation}
We use the complex $K^\bullet$ to define what we call
the alternating {\v C}ech complex associated to $f : U \to X$.

\begin{definition}
\label{definition-alternating-cech-complex}
Let $S$ be a scheme. Let $f : U \to X$ be a surjective \'etale morphism
of algebraic spaces over $S$. Let $\mathcal{F}$ be an object of
$\textit{Ab}(X_{\acute{e}tale})$. The
{\it alternating {\v C}ech complex}\footnote{This may be nonstandard notation}
$\check{\mathcal{C}}^\bullet_{alt}(f, \mathcal{F})$
associated to $\mathcal{F}$ and $f$ is the complex
$$
\Hom(K^0, \mathcal{F}) \to \Hom(K^1, \mathcal{F}) \to
\Hom(K^2, \mathcal{F}) \to \ldots
$$
with Hom groups computed in $\textit{Ab}(X_{\acute{e}tale})$.
\end{definition}

\noindent
The reader may verify that if $U = \coprod U_i$ and $f|_{U_i} : U_i \to X$
is the open immersion of a subspace, then
$\check{\mathcal{C}}_{alt}^\bullet(f, \mathcal{F})$ agrees with the complex
introduced in
Cohomology, Section \ref{cohomology-section-alternating-cech}
for the Zariski covering $X = \bigcup U_i$ and the restriction
of $\mathcal{F}$ to the Zariski site of $X$. What is more important
however, is to relate the cohomology of the alternating
{\v C}ech complex to the cohomology.

\begin{lemma}
\label{lemma-alternating-cech-to-cohomology}
Let $S$ be a scheme. Let $f : U \to X$ be a surjective \'etale morphism
of algebraic spaces over $S$. Let $\mathcal{F}$ be an object of
$\textit{Ab}(X_{\acute{e}tale})$. There exists a canonical map
$$
\check{\mathcal{C}}^\bullet_{alt}(f, \mathcal{F})
\longrightarrow
R\Gamma(X, \mathcal{F})
$$
in $D(\textit{Ab})$. Moreover, there is a spectral sequence with $E_1$-page
$$
E_1^{p, q} =
\text{Ext}_{\textit{Ab}(X_{\acute{e}tale})}^q(K^p, \mathcal{F})
$$
converging to $H^{p + q}(X, \mathcal{F})$ where
$K^p = \wedge^{p + 1}f_!\underline{\mathbf{Z}}$.
\end{lemma}

\begin{proof}
Recall that we have the quasi-isomorphism
$K^\bullet \to \underline{\mathbf{Z}}[0]$, see
(\ref{equation-quasi-isomorphism}).
Choose an injective resolution $\mathcal{F} \to \mathcal{I}^\bullet$
in $\textit{Ab}(X_{\acute{e}tale})$. Consider the double complex
$A^{\bullet, \bullet}$ with terms
$$
A^{p, q} = \Hom(K^p, \mathcal{I}^q)
$$
where the differential $d_1^{p, q} : A^{p, q} \to A^{p + 1, q}$
is the one coming from the differential $K^{p + 1} \to K^p$
and the differential $d_2^{p, q} : A^{p, q} \to A^{p, q + 1}$ is the
one coming from the differential
$\mathcal{I}^q \to \mathcal{I}^{q + 1}$.
Denote $sA^\bullet$ the total complex associated to
the double complex $A^{\bullet, \bullet}$.
We will use the two spectral
sequences $({}'E_r, {}'d_r)$ and $({}''E_r, {}''d_r)$
associated to this double complex, see
Homology, Section \ref{homology-section-double-complex}.

\medskip\noindent
Because $K^\bullet$ is a resolution of $\underline{\mathbf{Z}}$
we see that the complexes
$$
A^{\bullet, q} :
\Hom(K^0, \mathcal{I}^q) \to
\Hom(K^1, \mathcal{I}^q) \to
\Hom(K^2, \mathcal{I}^q) \to \ldots
$$
are acyclic in positive degrees and have $H^0$ equal to
$\Gamma(X, \mathcal{I}^q)$. Hence by
Homology, Lemma \ref{homology-lemma-double-complex-gives-resolution}
and its proof the spectral sequence $({}''E_r, {}''d_r)$ degenerates,
and the natural map
$$
\mathcal{I}^\bullet(X) \longrightarrow sA^\bullet
$$
is a quasi-isomorphism of complexes of abelian groups. In particular
we conclude that $H^n(sA^\bullet) = H^n(X, \mathcal{F})$.

\medskip\noindent
The map $\check{\mathcal{C}}^\bullet_{alt}(f, \mathcal{F}) \to
R\Gamma(X, \mathcal{F})$ of the lemma is the composition of
$\check{\mathcal{C}}^\bullet_{alt}(f, \mathcal{F}) \to SA^\bullet$
with the inverse of the displayed quasi-isomorphism.

\medskip\noindent
Finally, consider the spectral sequence $({}'E_r, {}'d_r)$.
We have
$$
E_1^{p, q} = q\text{th cohomology of }
\Hom(K^p, \mathcal{I}^0) \to
\Hom(K^p, \mathcal{I}^1) \to
\Hom(K^p, \mathcal{I}^2) \to \ldots
$$
This proves the lemma.
\end{proof}

\noindent
It follows from the lemma that it is important to understand the
ext groups $\text{Ext}_{\textit{Ab}(X_{\acute{e}tale})}(K^p, \mathcal{F})$,
i.e., the right derived functors of
$\mathcal{F} \mapsto \Hom(K^p, \mathcal{F})$.

\begin{lemma}
\label{lemma-compute}
Let $S$ be a scheme. Let $f : U \to X$ be a surjective, \'etale, and separated
morphism of algebraic spaces over $S$. For $p \geq 0$ set
$$
W_p = U \times_X \ldots \times_X U \setminus \text{all diagonals}
$$
where the fibre product has $p + 1$ factors.
There is a free action of $S_{p + 1}$ on $W_p$ over $X$ and
$$
\Hom(K^p, \mathcal{F}) = S_{p + 1}\text{-anti-invariant elements of }
\mathcal{F}(W_p)
$$
functorially in $\mathcal{F}$ where
$K^p = \wedge^{p + 1}f_!\underline{\mathbf{Z}}$.
\end{lemma}

\begin{proof}
Because $U \to X$ is separated the diagonal $U \to U \times_X U$ is a
closed immersion. Since $U \to X$ is \'etale the diagonal
$U \to U \times_X U$ is an open immersion, see
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-etale-unramified} and
\ref{spaces-morphisms-lemma-diagonal-unramified-morphism}.
Hence $W_p$ is an open and closed subspace of
$U^{p + 1} = U \times_X \ldots \times_X U$. The action of $S_{p + 1}$
on $W_p$ is free as we've thrown out the fixed points of the action.
By
Lemma \ref{lemma-product-is-tensor-product}
we see that
$$
(f_!\underline{\mathbf{Z}})^{\otimes p + 1} =
f^{p + 1}_!\underline{\mathbf{Z}} = (W_p \to X)_!\underline{\mathbf{Z}}
\oplus Rest
$$
where $f^{p + 1} : U^{p + 1} \to X$ is the structure morphism.
Looking at stalks over a geometric point $\overline{x}$ of $X$
we see that
$$
\left(
\bigoplus\nolimits_{\overline{u} \mapsto \overline{x}} \mathbf{Z}
\right)^{\otimes p + 1}
\longrightarrow
(W_p \to X)_!\underline{\mathbf{Z}}_{\overline{x}}
$$
is the quotient whose kernel is generated by all tensors
$1_{\overline{u}_0} \otimes \ldots \otimes 1_{\overline{u}_p}$
where $\overline{u}_i = \overline{u}_j$ for some $i \not = j$.
Thus the quotient map
$$
(f_!\underline{\mathbf{Z}})^{\otimes p + 1}
\longrightarrow
\wedge^{p + 1}f_!\underline{\mathbf{Z}}
$$
factors through $(W_p \to X)_!\underline{\mathbf{Z}}$, i.e., we get
$$
(f_!\underline{\mathbf{Z}})^{\otimes p + 1}
\longrightarrow
(W_p \to X)_!\underline{\mathbf{Z}}
\longrightarrow
\wedge^{p + 1}f_!\underline{\mathbf{Z}}
$$
This already proves that $\Hom(K^p, \mathcal{F})$ is (functorially) a
subgroup of
$$
\Hom((W_p \to X)_!\underline{\mathbf{Z}}, \mathcal{F}) = \mathcal{F}(W_p)
$$
To identify it with the $S_{p + 1}$-anti-invariants we have to prove that
the surjection $(W_p \to X)_!\underline{\mathbf{Z}}
\to \wedge^{p + 1}f_!\underline{\mathbf{Z}}$ is the maximal
$S_{p + 1}$-anti-invariant quotient. In other words, we have to show that
$\wedge^{p + 1}f_!\underline{\mathbf{Z}}$ is the quotient of
$(W_p \to X)_!\underline{\mathbf{Z}}$ by the subsheaf generated by
the local sections $s - \text{sign}(\sigma)\sigma(s)$ where $s$ is
a local section of $(W_p \to X)_!\underline{\mathbf{Z}}$.
This can be checked on the stacks, where it is clear.
\end{proof}

\begin{lemma}
\label{lemma-twist}
Let $S$ be a scheme. Let $W$ be an algebraic space over $S$.
Let $G$ be a finite group acting freely on $W$.
Let $U = W/G$, see
Properties of Spaces, Lemma \ref{spaces-properties-lemma-quotient}.
Let $\chi : G \to \{+1, -1\}$ be a character.
Then there exists a rank 1 locally free sheaf of $\mathbf{Z}$-modules
$\underline{\mathbf{Z}}(\chi)$ on $U_{\acute{e}tale}$ such that for every
abelian sheaf $\mathcal{F}$ on $U_{\acute{e}tale}$ we have
$$
H^0(W, \mathcal{F}|_W)^\chi =
H^0(U, \mathcal{F} \otimes_{\mathbf{Z}} \underline{\mathbf{Z}}(\chi))
$$
\end{lemma}

\begin{proof}
The quotient morphism $q : W \to U$ is a $G$-torsor, i.e., there exists
a surjective \'etale morphism $U' \to U$ such that
$W \times_U U' = \coprod_{g \in G} U'$ as spaces with $G$-action over $U'$.
(Namely, $U' = W$ works.) Hence $q_*\underline{\mathbf{Z}}$ is a finite
locally free $\mathbf{Z}$-module with an action of $G$. For any
geometric point $\overline{u}$ of $U$, then we get $G$-equivariant
isomorphisms
$$
(q_*\underline{\mathbf{Z}})_{\overline{u}}
= \bigoplus\nolimits_{\overline{w} \mapsto \overline{u}} \mathbf{Z}
= \bigoplus\nolimits_{g \in G} \mathbf{Z} = \mathbf{Z}[G]
$$
where the second $=$ uses a geometric point
$\overline{w}_0$ lying over $\overline{u}$ and
maps the summand corresponding to $g \in G$ to the summand
corresponding to $g(\overline{w}_0)$. We have
$$
H^0(W, \mathcal{F}|_W) =
H^0(U, \mathcal{F} \otimes_\mathbf{Z} q_*\underline{\mathbf{Z}})
$$
because
$q_*\mathcal{F}|_W = \mathcal{F} \otimes_\mathbf{Z} q_*\underline{\mathbf{Z}}$
as one can check by restricting to $U'$. Let
$$
\underline{\mathbf{Z}}(\chi) =
(q_*\underline{\mathbf{Z}})^\chi \subset
q_*\underline{\mathbf{Z}}
$$
be the subsheaf of sections that transform according to $\chi$. For
any geometric point $\overline{u}$ of $U$ we have
$$
\underline{\mathbf{Z}}(\chi)_{\overline{u}} =
\mathbf{Z} \cdot \sum\nolimits_g \chi(g) g
\subset
\mathbf{Z}[G] = (q_*\underline{\mathbf{Z}})_{\overline{u}}
$$
It follows that $\underline{\mathbf{Z}}(\chi)$ is locally free of
rank 1 (more precisely, this should be checked after restricting to $U'$).
Note that for any $\mathbf{Z}$-module $M$ the $\chi$-semi-invariants
of $M[G]$ are the elements of the form $m \cdot \sum\nolimits_g \chi(g) g$.
Thus we see that for any abelian sheaf $\mathcal{F}$ on $U$ we have
$$
\left(\mathcal{F} \otimes_\mathbf{Z} q_*\underline{\mathbf{Z}}\right)^\chi
=
\mathcal{F} \otimes_\mathbf{Z} \underline{\mathbf{Z}}(\chi)
$$
because we have equality at all stalks. The result of the lemma follows by
taking global sections.
\end{proof}

\noindent
Now we can put everything together and obtain the following
pleasing result.

\begin{lemma}
\label{lemma-alternating-spectral-sequence}
Let $S$ be a scheme. Let $f : U \to X$ be a surjective, \'etale, and
separated morphism of algebraic spaces over $S$. For $p \geq 0$ set
$$
W_p = U \times_X \ldots \times_X U \setminus \text{all diagonals}
$$
(with $p + 1$ factors) as in Lemma \ref{lemma-compute}.
Let $\chi_p : S_{p + 1} \to \{+1, -1\}$ be the sign character.
Let $U_p = W_p/S_{p + 1}$ and $\underline{\mathbf{Z}}(\chi_p)$ be as in
Lemma \ref{lemma-twist}.
Then the spectral sequence of
Lemma \ref{lemma-alternating-cech-to-cohomology}
has $E_1$-page
$$
E_1^{p, q} =
H^q(U_p, \mathcal{F}|_{U_p} \otimes_\mathbf{Z} \underline{\mathbf{Z}}(\chi_p))
$$
and converges to $H^{p + q}(X, \mathcal{F})$.
\end{lemma}

\begin{proof}
Note that since the action of $S_{p + 1}$ on $W_p$ is over $X$ we do
obtain a morphism $U_p \to X$. Since $W_p \to X$ is \'etale and since
$W_p \to U_p$ is surjective \'etale, it follows
that also $U_p \to X$ is \'etale, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-etale-local}.
Therefore an injective object of
$\textit{Ab}(X_{\acute{e}tale})$ restricts to an injective object of
$\textit{Ab}(U_{p, \acute{e}tale})$, see
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-cohomology-of-open}.
Moreover, the functor
$\mathcal{G} \mapsto
\mathcal{G} \otimes_\mathbf{Z} \underline{\mathbf{Z}}(\chi_p))$
is an auto-equivalence of $\textit{Ab}(U_p)$, whence transforms injective
objects into injective objects and is exact (because
$\underline{\mathbf{Z}}(\chi_p)$ is an invertible
$\underline{\mathbf{Z}}$-module). Thus given an injective resolution
$\mathcal{F} \to \mathcal{I}^\bullet$ in $\textit{Ab}(X_{\acute{e}tale})$
the complex
$$
\Gamma(U_p,
\mathcal{I}^0|_{U_p} \otimes_\mathbf{Z} \underline{\mathbf{Z}}(\chi_p))
\to
\Gamma(U_p,
\mathcal{I}^1|_{U_p} \otimes_\mathbf{Z} \underline{\mathbf{Z}}(\chi_p))
\to
\Gamma(U_p,
\mathcal{I}^2|_{U_p} \otimes_\mathbf{Z} \underline{\mathbf{Z}}(\chi_p))
\to \ldots
$$
computes
$H^*(U_p,
\mathcal{F}|_{U_p} \otimes_\mathbf{Z} \underline{\mathbf{Z}}(\chi_p))$.
On the other hand, by
Lemma \ref{lemma-twist}
it is equal to the complex of $S_{p + 1}$-anti-invariants in
$$
\Gamma(W_p, \mathcal{I}^0) \to
\Gamma(W_p, \mathcal{I}^1) \to
\Gamma(W_p, \mathcal{I}^2) \to \ldots
$$
which by
Lemma \ref{lemma-compute}
is equal to the complex
$$
\Hom(K^p, \mathcal{I}^0) \to
\Hom(K^p, \mathcal{I}^1) \to
\Hom(K^p, \mathcal{I}^2) \to \ldots
$$
which computes
$\text{Ext}^*_{\textit{Ab}(X_{\acute{e}tale})}(K^p, \mathcal{F})$.
Putting everything together we win.
\end{proof}





\section{Higher vanishing for quasi-coherent sheaves}
\label{section-higher-vanishing}

\noindent
In this section we show that given a quasi-compact and
quasi-separated algebraic space $X$ there exists an integer
$n = n(X)$ such that the cohomology of any quasi-coherent
sheaf on $X$ vanishes beyond degree $n$.

\begin{lemma}
\label{lemma-quasi-coherent-twist}
With $S$, $W$, $G$, $U$, $\chi$ as in
Lemma \ref{lemma-twist}.
If $\mathcal{F}$ is a quasi-coherent $\mathcal{O}_U$-module,
then so is $\mathcal{F} \otimes_{\mathbf{Z}} \underline{\mathbf{Z}}(\chi)$.
\end{lemma}

\begin{proof}
The $\mathcal{O}_U$-module structure is clear. To check that
$\mathcal{F} \otimes_{\mathbf{Z}} \underline{\mathbf{Z}}(\chi)$
is quasi-coherent it suffices to check \'etale locally.
Hence the lemma follows as $\underline{\mathbf{Z}}(\chi)$
is finite locally free as a $\underline{\mathbf{Z}}$-module.
\end{proof}

\noindent
The following proposition is interesting even if $X$ is a scheme.
It is the natural generalization of
Cohomology of Schemes, Lemma \ref{coherent-lemma-vanishing-nr-affines}.
Before we state it, observe that given an \'etale morphism
$f : U \to X$ from an affine scheme towards a quasi-separated algebraic
space $X$ the fibres of $f$ are universally bounded, in particular
there exists an integer $d$ such that the fibres of $|U| \to |X|$
all have size at most $d$; this is the implication
$(\eta) \Rightarrow (\delta)$ of
Decent Spaces, Lemma \ref{decent-spaces-lemma-bounded-fibres}.

\begin{proposition}
\label{proposition-vanishing}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Assume $X$ is quasi-compact and separated.
Let $U$ be an affine scheme, and let
$f : U \to X$ be a surjective \'etale morphism.
Let $d$ be an upper bound for the size of the fibres of
$|U| \to |X|$. Then for any quasi-coherent $\mathcal{O}_X$-module $\mathcal{F}$
we have $H^q(X, \mathcal{F}) = 0$ for $q \geq d$.
\end{proposition}

\begin{proof}
We will use the spectral sequence of
Lemma \ref{lemma-alternating-spectral-sequence}.
The lemma applies since $f$ is separated as $U$ is separated, see
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-compose-after-separated}.
Since $X$ is separated the scheme $U \times_X \ldots \times_X U$ is a closed
subscheme of
$U \times_{\Spec(\mathbf{Z})} \ldots \times_{\Spec(\mathbf{Z})} U$
hence is affine. Thus $W_p$ is affine. Hence $U_p = W_p/S_{p + 1}$ is an
affine scheme by
Groupoids, Proposition \ref{groupoids-proposition-finite-flat-equivalence}.
The discussion in
Section \ref{section-higher-direct-image}
shows that cohomology of quasi-coherent sheaves on $W_p$ (as an algebraic
space) agrees with the cohomology of the corresponding quasi-coherent
sheaf on the underlying affine scheme, hence vanishes in positive degrees by
Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherent-affine-cohomology-zero}.
By
Lemma \ref{lemma-quasi-coherent-twist}
the sheaves
$\mathcal{F}|_{U_p} \otimes_\mathbf{Z} \underline{\mathbf{Z}}(\chi_p)$
are quasi-coherent. Hence
$H^q(W_p,
\mathcal{F}|_{U_p} \otimes_\mathbf{Z} \underline{\mathbf{Z}}(\chi_p))$
is zero when $q > 0$. By our definition of the integer $d$ we see that
$W_p = \emptyset$ for $p \geq d$. Hence also
$H^0(W_p,
\mathcal{F}|_{U_p} \otimes_\mathbf{Z} \underline{\mathbf{Z}}(\chi_p))$
is zero when $p \geq d$.
This proves the proposition.
\end{proof}

\noindent
In the following lemma we esthablish that a quasi-compact and
quasi-separated algebraic space has finite cohomological dimension
for quasi-coherent modules. We are explicit about the bound only because
we will use it later to prove a similar result for higher direct
images.

\begin{lemma}
\label{lemma-vanishing-quasi-separated}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Assume $X$ is quasi-compact and quasi-separated.
Then we can choose
\begin{enumerate}
\item an affine scheme $U$,
\item a surjective \'etale morphism $f : U \to X$,
\item an integer $d$ bounding the degrees of the fibres of $U \to X$,
\item for every $p = 0, 1, \ldots, d$ a surjective \'etale morphism
$V_p \to U_p$ from an affine scheme $V_p$ where $U_p$ is as in
Lemma \ref{lemma-alternating-spectral-sequence}, and
\item an integer $d_p$ bounding the degree of the fibres of $V_p \to U_p$.
\end{enumerate}
Moreover, whenever we have (1) -- (5), then for any quasi-coherent
$\mathcal{O}_X$-module $\mathcal{F}$ we have $H^q(X, \mathcal{F}) = 0$ for
$q \geq \max(d_p + p)$.
\end{lemma}

\begin{proof}
Since $X$ is quasi-compact we can find a surjective \'etale morphism
$U \to X$ with $U$ affine, see
Properties of Spaces, Lemma
\ref{spaces-properties-lemma-quasi-compact-affine-cover}.
By
Decent Spaces, Lemma \ref{decent-spaces-lemma-bounded-fibres}
the fibres of $f$ are universally bounded, hence we can find $d$.
We have $U_p = W_p/S_{p + 1}$ and $W_p \subset U \times_X \ldots \times_X U$
is open and closed. Since $X$ is quasi-separated the schemes
$W_p$ are quasi-compact, hence $U_p$ is quasi-compact.
Since $U$ is separated, the schemes $W_p$ are separated, hence
$U_p$ is separated by (the absolute version of)
Spaces, Lemma \ref{spaces-lemma-quotient-finite-separated}.
By
Properties of Spaces, Lemma
\ref{spaces-properties-lemma-quasi-compact-affine-cover}
we can find the morphisms $V_p \to W_p$.
By
Decent Spaces, Lemma \ref{decent-spaces-lemma-bounded-fibres}
we can find the integers $d_p$.

\medskip\noindent
At this point the proof uses the spectral sequence
$$
E_1^{p, q} =
H^q(U_p, \mathcal{F}|_{U_p} \otimes_\mathbf{Z} \underline{\mathbf{Z}}(\chi_p))
\Rightarrow
H^{p + q}(X, \mathcal{F})
$$
see
Lemma \ref{lemma-alternating-spectral-sequence}.
By definition of the integer $d$ we see that $U_p = 0$ for $p \geq d$.
By Proposition \ref{proposition-vanishing}
and
Lemma \ref{lemma-quasi-coherent-twist}
we see that
$H^q(U_p,
\mathcal{F}|_{U_p} \otimes_\mathbf{Z} \underline{\mathbf{Z}}(\chi_p))$
is zero for $q \geq d_p$ for $p = 0, \ldots, d$.
Whence the lemma.
\end{proof}









\section{Vanishing for higher direct images}
\label{section-vanishing-higher-direct-images}

\noindent
We apply the results of
Section \ref{section-higher-vanishing}
to obtain vanishing of higher direct images of quasi-coherent sheaves
for quasi-compact and quasi-separated morphisms. This is useful because
it allows one to argue by descending induction on the cohomological degree
in certain situations.

\begin{lemma}
\label{lemma-vanishing-higher-direct-images}
Let $S$ be a scheme. Let $f : X \to Y$ be a
morphism of algebraic spaces over $S$.
Assume that
\begin{enumerate}
\item $f$ is quasi-compact and quasi-separated, and
\item $Y$ is quasi-compact.
\end{enumerate}
Then there exists an integer $n(X \to Y)$ such that
for any algebraic space $Y'$, any morphism $Y' \to Y$
and any quasi-coherent sheaf $\mathcal{F}'$ on $X' = Y' \times_Y X$
the higher direct images $R^if'_*\mathcal{F}'$ are zero for
$i \geq n(X \to Y)$.
\end{lemma}

\begin{proof}
Let $V \to Y$ be a surjective \'etale morphism where $V$ is an affine
scheme, see
Properties of Spaces, Lemma
\ref{spaces-properties-lemma-quasi-compact-affine-cover}.
Suppose we prove the result for the base change $f_V : V \times_Y X \to V$.
Then the result holds for $f$ with $n(X \to Y) = n(X_V \to V)$.
Namely, if $Y' \to Y$ and $\mathcal{F}'$ are as in the lemma, then
$R^if'_*\mathcal{F}'|_{V \times_Y Y'}$ is equal to
$R^if'_{V, *}\mathcal{F}'|_{X'_V}$ where
$f'_V : X'_V = V \times_Y Y' \times_Y X \to V \times_Y Y' = Y'_V$, see
Properties of Spaces,
Lemma \ref{spaces-properties-lemma-pushforward-etale-base-change-modules}.
Thus we may assume that $Y$ is an affine scheme.

\medskip\noindent
Moreover, to prove the vanishing for all $Y' \to Y$ and
$\mathcal{F}'$ it suffices to do so when $Y'$ is an affine scheme.
In this case, $R^if'_*\mathcal{F}'$ is quasi-coherent by
Lemma \ref{lemma-higher-direct-image}.
Hence it suffices to prove that $H^i(X', \mathcal{F}') = 0$, because
$H^i(X', \mathcal{F}') = H^0(Y', R^if'_*\mathcal{F}')$ by
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-apply-Leray}
and the vanishing of higher cohomology of quasi-coherent sheaves
on affine algebraic spaces
(Proposition \ref{proposition-vanishing}).

\medskip\noindent
Choose $U \to X$, $d$, $V_p \to U_p$ and $d_p$ as in
Lemma \ref{lemma-vanishing-quasi-separated}.
For any affine scheme $Y'$ and morphism $Y' \to Y$ denote
$X' = Y' \times_Y X$, $U' = Y' \times_Y U$, $V'_p = Y' \times_Y V_p$.
Then $U' \to X'$, $d' = d$, $V'_p \to U'_p$ and $d'_p = d$
is a collection of choices as in
Lemma \ref{lemma-vanishing-quasi-separated}
for the algebraic space $X'$ (details omitted).
Hence we see that $H^i(X', \mathcal{F}') = 0$ for $i \geq \max(p + d_p)$
and we win.
\end{proof}

\begin{lemma}
\label{lemma-affine-vanishing-higher-direct-images}
Let $S$ be a scheme. Let $f : X \to Y$ be an affine
morphism of algebraic spaces over $S$. Then
$R^if_*\mathcal{F} = 0$ for $i > 0$ and any quasi-coherent
$\mathcal{O}_X$-module $\mathcal{F}$.
\end{lemma}

\begin{proof}
Recall that an affine morphism of algebraic spaces is representable.
Hence this follows from (\ref{equation-representable-higher-direct-image}) and
Cohomology of Schemes, Lemma \ref{coherent-lemma-relative-affine-vanishing}.
\end{proof}








\section{Cohomology and base change, I}
\label{section-cohomology-and-base-change}

\noindent
Let $S$ be a scheme.
Let $f : X \to Y$ be a morphism of algebraic spaces over $S$.
Let $\mathcal{F}$ be a quasi-coherent sheaf on $X$.
Suppose further that $g : Y' \to Y$ is a morphism of algebraic spaces over
$S$. Denote $X' = X_{Y'} = Y' \times_Y X$ the base change of $X$ and denote
$f' : X' \to Y'$ the base change of $f$.
Also write $g' : X' \to X$ the projection,
and set $\mathcal{F}' = (g')^*\mathcal{F}$.
Here is a diagram representing the situation:
\begin{equation}
\label{equation-base-change-diagram}
\vcenter{
\xymatrix{
\mathcal{F}' = (g')^*\mathcal{F} &
X' \ar[r]_{g'} \ar[d]_{f'} &
X \ar[d]^f &
\mathcal{F} \\
Rf'_*\mathcal{F}' &
Y' \ar[r]^g &
Y &
Rf_*\mathcal{F}
}
}
\end{equation}
Here is the basic result for a flat base change.

\begin{lemma}
\label{lemma-flat-base-change-cohomology}
In the situation above, assume that $g$ is flat and that $f$
is quasi-compact and quasi-separated.
Then the base change map for any $i \geq 0$ we have
$$
R^pf'_*\mathcal{F}' = g^*R^pf_*\mathcal{F}
$$
with notation as in (\ref{equation-base-change-diagram}).
\end{lemma}

\begin{proof}
The morphism $g'$ is flat by
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-base-change-flat}.
Note that flatness of $g$ and $g'$ is equivalent to flatness
of the morphisms of small \'etale ringed sites, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-flat-morphism-sites}.
Hence we can apply
Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-base-change-map-flat-case}
to obtain a base change map
$$
g^*R^pf_*\mathcal{F} \longrightarrow R^pf'_*\mathcal{F}'
$$
To prove this map is an isomorphism we can work locally in the \'etale
topology on $Y'$. Thus we may assume that $Y$ and $Y'$ are affine
schemes. Say $Y = \text{Spec}(A)$ and $Y' = \text{Spec}(B)$.
In this case we are really trying to show that the map
$$
H^p(X, \mathcal{F}) \otimes_A B \longrightarrow H^p(X_B, \mathcal{F}_B)
$$
is an isomorphism where $X_B = \text{Spec}(B) \times_{\text{Spec}(A)} X$ and
$\mathcal{F}_B$ is the pullback of $\mathcal{F}$ to $X_B$.

\medskip\noindent
Fix $A \to B$ a flat ring map and let $X$ be a quasi-compact and
quasi-separated algebraic space over $A$. Note that $g' : X_B \to X$
is affine as a base change of $\Spec(B) \to \Spec(A)$. Hence
the higher direct images $R^i(g')_*\mathcal{F}_B$ are zero by
Lemma \ref{lemma-affine-vanishing-higher-direct-images}.
Thus $H^p(X_B, \mathcal{F}_B) = H^p(X, g'_*\mathcal{F}_B)$, see
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-apply-Leray}.
Moreover, we have
$$
g'_*\mathcal{F}_B = \mathcal{F} \otimes_{\underline{A}} \underline{B}
$$
where $\underline{A}$, $\underline{B}$ denotes the constant sheaf of
rings with value $A$, $B$. Namely, it is clear that there is a map
from right to left. For any affine scheme $U$ \'etale over $X$ we have
\begin{align*}
g'_*\mathcal{F}_B(U) & = \mathcal{F}_B(\Spec(B) \times_{\Spec(A)} U) \\
& =
\Gamma(\Spec(B) \times_{\Spec(A)} U,
(\Spec(B) \times_{\Spec(A)} U \to U)^*\mathcal{F}|_U) \\
& =
B \otimes_A \mathcal{F}(U)
\end{align*}
hence the map is an isomorphism. Write $B = \colim M_i$ as a filtered
colimit of finite free $A$-modules $M_i$ using Lazard's theorem, see
Algebra, Theorem \ref{algebra-theorem-lazard}.
We deduce that
\begin{align*}
H^p(X, g'_*\mathcal{F}_B) &
= H^p(X, \mathcal{F} \otimes_{\underline{A}} \underline{B}) \\
& = H^p(X, \colim_i \mathcal{F} \otimes_{\underline{A}} \underline{M_i}) \\
& = \colim_i H^p(X, \mathcal{F} \otimes_{\underline{A}} \underline{M_i}) \\
& = \colim_i H^p(X, \mathcal{F}) \otimes_A M_i \\
& = H^p(X, \mathcal{F}) \otimes_A \colim_i M_i \\
& = H^p(X, \mathcal{F}) \otimes_A B
\end{align*}
The first equality because
$g'_*\mathcal{F}_B = \mathcal{F} \otimes_{\underline{A}} \underline{B}$
as seen above.
The second because $\otimes$ commutes with colimits.
The third equality because cohomology on $X$ commutes with
colimits (see
Lemma \ref{lemma-colimits}).
The fourth equality because $M_i$ is finite free (i.e., because cohomology
commutes with finite direct sums).
The fith because $\otimes$ commutes with colimits.
The sixth by choice of our system.
\end{proof}




\section{Coherent modules on locally Noetherian algebraic spaces}
\label{section-coherent}

\noindent
This section is the analogue of
Cohomology of Schemes, Section \ref{coherent-section-coherent-sheaves}.
In Modules on Sites, Definition \ref{sites-modules-definition-site-local}
we have defined coherent modules on any ringed topos. We use this notion
to define coherent modules on locally Noetherian algebraic spaces.
Although it is possible to work with coherent modules more generally
we resist the urge to do so.

\begin{definition}
\label{definition-coherent}
Let $S$ be a scheme. Let $X$ be a locally Noetherian algebraic space over $S$.
A quasi-coherent module $\mathcal{F}$ on $X$ is called {\it coherent}
if $\mathcal{F}$ is a coherent $\mathcal{O}_X$-module on the site
$X_{\acute{e}tale}$ in the sense of
Modules on Sites, Definition \ref{sites-modules-definition-site-local}.
\end{definition}

\noindent
Of course this definition is a bit hard to work with. We usually use
the characterization given in the lemma below.

\begin{lemma}
\label{lemma-coherent-Noetherian}
Let $S$ be a scheme.
Let $X$ be a locally Noetherian algebraic space over $S$.
Let $\mathcal{F}$ be an $\mathcal{O}_X$-module.
The following are equivalent
\begin{enumerate}
\item $\mathcal{F}$ is coherent,
\item $\mathcal{F}$ is a quasi-coherent, finite type $\mathcal{O}_X$-module,
\item $\mathcal{F}$ is a finitely presented $\mathcal{O}_X$-module,
\item for any \'etale morphism $\varphi : U \to X$ where $U$ is a scheme
the pullback $\varphi^*\mathcal{F}$ is a coherent module on $U$, and
\item there exists a surjective \'etale morphism $\varphi : U \to X$
where $U$ is a scheme such that the pullback $\varphi^*\mathcal{F}$ is
a coherent module on $U$.
\end{enumerate}
In particular $\mathcal{O}_X$ is coherent, any invertible
$\mathcal{O}_X$-module is coherent, and more generally any
finite locally free $\mathcal{O}_X$-module is coherent.
\end{lemma}

\begin{proof}
To be sure, if $X$ is a locally Noetherian algebraic space and
$U \to X$ is an \'etale morphism, then $U$ is locally Noetherian, see
Properties of Spaces, Section \ref{spaces-properties-section-types-properties}.
The lemma then follows from the points (1) -- (5) made in
Properties of Spaces, Section \ref{spaces-properties-section-properties-modules}
and the corresponding result for coherent modules on locally
Noetherian schemes, see
Cohomology of Schemes, Lemma \ref{coherent-lemma-coherent-Noetherian}.
\end{proof}

\begin{lemma}
\label{lemma-coherent-abelian-Noetherian}
Let $S$ be a scheme. Let $X$ be a locally Noetherian algebraic space over $S$.
The category of coherent $\mathcal{O}_X$-modules is abelian. More precisely,
the kernel and cokernel of a map of coherent $\mathcal{O}_X$-modules are
coherent. Any extension of coherent sheaves is coherent.
\end{lemma}

\begin{proof}
Choose a scheme $U$ and a surjective \'etale morphism $f : U \to X$.
Pullback $f^*$ is an exact functor as it equals a restriction functor, see
Properties of Spaces, Equation
(\ref{spaces-properties-equation-restrict-modules}).
By
Lemma \ref{lemma-coherent-Noetherian} we can check whether an
$\mathcal{O}_X$-module $\mathcal{F}$ is
coherent by checking whether $f^*\mathcal{F}$ is coherent. Hence the
lemma follows from the case of schemes which is
Cohomology of Schemes, Lemma \ref{coherent-lemma-coherent-abelian-Noetherian}.
\end{proof}

\noindent
Coherent modules form a Serre subcategory of the
category of quasi-coherent $\mathcal{O}_X$-modules. This does not hold
for modules on a general ringed topos.

\begin{lemma}
\label{lemma-coherent-Noetherian-quasi-coherent-sub-quotient}
Let $S$ be a scheme.
Let $X$ be a locally Noetherian algebraic space over $S$.
Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module.
Any quasi-coherent submodule of $\mathcal{F}$ is coherent.
Any quasi-coherent quotient module of $\mathcal{F}$ is coherent.
\end{lemma}

\begin{proof}
Choose a scheme $U$ and a surjective \'etale morphism $f : U \to X$.
Pullback $f^*$ is an exact functor as it equals a restriction functor, see
Properties of Spaces, Equation
(\ref{spaces-properties-equation-restrict-modules}).
By
Lemma \ref{lemma-coherent-Noetherian} we can check whether an
$\mathcal{O}_X$-module $\mathcal{G}$ is
coherent by checking whether $f^*\mathcal{H}$ is coherent. Hence the
lemma follows from the case of schemes which is
Cohomology of Schemes, Lemma
\ref{coherent-lemma-coherent-Noetherian-quasi-coherent-sub-quotient}.
\end{proof}





\section{Limits of coherent modules}
\label{section-limits}

\noindent
A colimit of coherent modules (on a locally Noetherian
algebraic space) is typically not coherent. But it is quasi-coherent
as any colimit of quasi-coherent modules on an algebraic space is
quasi-coherent, see Properties of Spaces, Lemma
\ref{spaces-properties-lemma-properties-quasi-coherent}.
Conversely, if the algebraic space is Noetherian, then every quasi-coherent
module is a filtered colimit of coherent modules.

\begin{lemma}
\label{lemma-directed-colimit-coherent}
Let $S$ be a scheme. Let $X$ be a Noetherian algebraic space over $S$.
Every quasi-coherent $\mathcal{O}_X$-module is the filtered colimit
of its coherent submodules.
\end{lemma}

\begin{proof}
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
If $\mathcal{G}, \mathcal{H} \subset \mathcal{F}$ are coherent
$\mathcal{O}_X$-submodules then the image of
$\mathcal{G} \oplus \mathcal{H} \to \mathcal{F}$ is another
coherent $\mathcal{O}_X$-submodule which contains both of them
(see Lemmas \ref{lemma-coherent-abelian-Noetherian} and
\ref{lemma-coherent-Noetherian-quasi-coherent-sub-quotient}).
In this way we see that the system is directed.
Hence it now suffices to show that $\mathcal{F}$ can be written as
a filtered colimit of coherent modules, as then we can take the
images of these modules in $\mathcal{F}$ to conclude there are
enough of them.

\medskip\noindent
Let $U$ be an affine scheme and $U \to X$ a surjective \'etale morphism.
Set $R = U \times_X U$ so that $X = U/R$ as usual. By
Properties of Spaces, Proposition
\ref{spaces-properties-proposition-quasi-coherent}
we see that $\text{Qcoh}(X) = \text{QCoh}(U, R, s, t, c)$. Hence
we reduce to showing the corresponding thing for
$\text{QCoh}(U, R, s, t, c)$. Thus the result follows from
the more general Groupoids, Lemma \ref{groupoids-lemma-colimit-coherent}.
\end{proof}




\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
