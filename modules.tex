\input{preamble}

% OK, start here.
%
\begin{document}

\title{Sheaves of modules}

%\begin{abstract}
%\end{abstract}

\maketitle

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this document we work out basic notions of sheaves of modules.
This in particular includes the case of abelian sheaves, since
these may be viewed as sheaves of $\underline{\mathbf{Z}}$-modules.
We work out what happens for sheaves of modules on ringed topoi
as well, allthough we will simply duplicate the discussion,
and have sections detailing the constructions in the topological
case and in the case of sites.
Basic references are \cite{FAC}, \cite{EGA} and \cite{SGA4}.





\section{Pathology}
\label{section-pathology}

\noindent
A ringed space is a pair consisting of a topological space $X$
and a sheaf of rings $\mathcal{O}$. We allow $\mathcal{O} = 0$
in the definition. In this case the category of modules has a
single object (namely $0$). It is still an abelian category etc,
but it is a little degenerate. Similarly the sheaf $\mathcal{O}$
may be zero over open subsets of $X$, etc.

\medskip\noindent
This doesn't happen when considering locally ringed spaces (as we
will do later).








\section{The abelian category of sheaves of modules}
\label{section-kernels}

\noindent
Let $(X, \mathcal{O}_X)$ be a ringed space, see
Sheaves, Definition \ref{sheaves-definition-ringed-space}.
Let $\mathcal{F}$, $\mathcal{G}$ be sheaves of $\mathcal{O}_X$-modules, see
Sheaves, Definition \ref{sheaves-definition-sheaf-modules}.
Let $\varphi, \psi : \mathcal{F} \to \mathcal{G}$
be morphisms of sheaves of $\mathcal{O}_X$-modules.
We define $\varphi + \psi : \mathcal{F} \to \mathcal{G}$
to be the map which on each open $U \subset X$ is the
sum of the maps induced by $\varphi$, $\psi$. This is
clearly again a map of sheaves of $\mathcal{O}_X$-modules.
It is also clear that composition of maps of
$\mathcal{O}_X$-modules is bilinear with respect to this
addition. Thus $\textit{Mod}(\mathcal{O}_X)$ is a pre-additive
category, see Homology, Definition \ref{homology-definition-preadditive}.

\medskip\noindent
We will denote $0$ the sheaf of $\mathcal{O}_X$-modules
which has constant value $\{0\}$ for all open $U \subset X$.
Clearly this is both a final and an initial object of
$\textit{Mod}(\mathcal{O}_X)$. Given a morphism
of $\mathcal{O}_X$-modules $\varphi : \mathcal{F} \to \mathcal{G}$
the following are equivalent:
(a) $\varphi$ is zero, (b) $\varphi$ factors through $0$,
(c) $\varphi$ is zero on sections over each open $U$, and
(d) $\varphi_x = 0$ for all $x \in X$. See 
Sheaves, Lemma \ref{sheaves-lemma-points-exactness}.

\medskip\noindent
Moreover, given a pair
$\mathcal{F}$, $\mathcal{G}$ of sheaves of $\mathcal{O}_X$-modules
we may define the direct sum as
$$
\mathcal{F} \oplus \mathcal{G} = \mathcal{F} \times \mathcal{G}
$$
with obvious maps $(i, j, p, q)$ as in Homology, Definition
\ref{homology-definition-direct-sum}. Thus $\textit{Mod}(\mathcal{O}_X)$
is an additive category, see
Homology, Definition \ref{homology-definition-additive-category}.

\medskip\noindent
Let $\varphi : \mathcal{F} \to \mathcal{G}$ be a morphism
of $\mathcal{O}_X$-modules. We may define $\text{Ker}(\varphi)$
to be the subsheaf of $\mathcal{F}$ with sections
$$
\text{Ker}(\varphi)(U) =
\{ s \in \mathcal{F}(U) \mid \varphi(s) = 0 \text{ in } \mathcal{G}(U)\}
$$
for all open $U \subset X$. It is easy to see that this is indeed
a kernel in the category of $\mathcal{O}_X$-modules. In other words,
a morphism $\alpha : \mathcal{H} \to \mathcal{F}$ factors
through $\text{Ker}(\varphi)$ if and only if $\varphi \circ \alpha = 0$.
Moreover, on the level of stalks we have
$\text{Ker}(\varphi)_x = \text{Ker}(\varphi_x)$.

\medskip\noindent
On the other hand, we define
$\text{Coker}(\varphi)$ as the sheaf of $\mathcal{O}_X$-modules
associated to the presheaf of $\mathcal{O}_X$-modules defined
by the rule
$$
U
\longmapsto
\text{Coker}(\mathcal{G}(U)\to \mathcal{F}(U)) =
\mathcal{F}(U)/\varphi(\mathcal{G}(U)).
$$
Since taking stalks commutes with taking sheafification, see
Sheaves, Lemma \ref{sheaves-lemma-stalk-sheafification} we
see that $\text{Coker}(\varphi)_x = \text{Coker}(\varphi_x)$.
Thus the map $\mathcal{G} \to \text{Coker}(\varphi)$ is surjective
(as a map of sheaves of sets),
see Sheaves, Section \ref{sheaves-section-exactness-points}.
To show that this is a cokernel, note that if
$\beta : \mathcal{G} \to \mathcal{H}$ is a morphism of $\mathcal{O}_X$-modules
such that $\beta \circ \varphi$ is zero, then you get for every
open $U \subset X$ a map induced by $\beta$ from 
$\mathcal{G}(U)/\varphi(\mathcal{F}(U))$ into $\mathcal{H}(U)$.
By the universal property of sheafification (see
Sheaves, Lemma \ref{sheaves-lemma-sheafification-presheaf-modules})
we obtain a canonical map $\text{Coker}(\varphi) \to \mathcal{H}$
such that the original $\beta$ is equal to 
the composition
$\mathcal{G} \to \text{Coker}(\varphi) \to \mathcal{H}$.
The morphism $\text{Coker}(\varphi) \to \mathcal{H}$ is unique
because of the surjectivity mentioned above.

\begin{lemma}
\label{lemma-abelian}
Let $(X, \mathcal{O}_X)$ be a ringed space. The category
$\textit{Mod}(\mathcal{O})$ is an abelian category. Moreover
a complex 
$$
\mathcal{F} \to \mathcal{G} \to \mathcal{H}
$$
is exact at $\mathcal{G}$ if and only if for all $x \in X$ the
complex
$$
\mathcal{F}_x \to \mathcal{G}_x \to \mathcal{H}_x
$$
is exact at $\mathcal{G}_x$.
\end{lemma}

\begin{proof}
By Homology, Definition \ref{homology-definition-abelian-category}
we have to show that image and coimage agree. By Sheaves,
Lemma \ref{sheaves-lemma-points-exactness} it is enough to show
that image and coimage have the same stalk at every $x \in X$.
By the constructions of kernels and cokernels above these stalks
are the coimage and image in the categories of $\mathcal{O}_{X,x}$-modules.
Thus we get the result from the fact that the category of modules
over a ring is abelian.
\end{proof}

\noindent
Actually the category $\textit{Mod}(\mathcal{O}_X)$ has many more properties.
Here are two constructions we can do.
\begin{enumerate}
\item Given any set $I$ and for each $i \in I$ a $\mathcal{O}_X$-module
we can form the product
$$
\prod\nolimits_{i \in I} \mathcal{F}_i
$$
which is the sheaf that associates to each open $U$ the
product of the modules $\mathcal{F}_i(U)$. This is also the
categorical product, as in
Categories, Definition \ref{categories-definition-product}.
\item Given any set $I$ and for each $i \in I$ a $\mathcal{O}_X$-module
we can form the direct sum
$$
\bigoplus\nolimits_{i \in I} \mathcal{F}_i
$$
which is the {\it sheafification} of the presheaf
that associates to each open $U$ the
direct sum of the modules $\mathcal{F}_i(U)$.
This is also the categorical coproduct, as in
Categories, Definition \ref{categories-definition-coproduct}.
To see this you use the universal property of sheafification.
\end{enumerate}
Since any abelian category has equalizers and coequalizers
we conclude that all limits and colimits exist in
$\textit{Mod}(\mathcal{O}_X)$, see
Categories, Lemmas
\ref{categories-lemma-limits-products-equalizers} and
\ref{categories-lemma-colimits-coproducts-coequalizers}.

\begin{lemma}
\label{lemma-limits-colimits}
Let $(X, \mathcal{O}_X)$ be a ringed space.
All limits and colimits exist in $\textit{Mod}(\mathcal{O}_X)$.
Limits are the same as the corresponding limits of presheaves of
$\mathcal{O}_X$-modules (i.e., commute with taking
sections over opens). Finite colimits are the same as the correponding
finite colimits of pre-sheaves of $\mathcal{O}_X$-modules.
A general colimit is the sheafification of the corresponding colimit in
the category of presheaves.
\end{lemma}

\begin{proof}
Omitted. But see discussion above.
\end{proof}

\begin{lemma}
\label{lemma-section-direct-sum-quasi-compact}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $I$ be a set. For $i \in I$, let $\mathcal{F}_i$
be a sheaf of $\mathcal{O}_X$-modules.
For $U \subset X$ quasi-compact open the map
$$
\bigoplus\nolimits_{i \in I} \mathcal{F}_i(U)
\longrightarrow
\left(\bigoplus\nolimits_{i \in I} \mathcal{F}_i\right)(U)
$$
is bijective.
\end{lemma}

\begin{proof}
If $s$ is an element of the right hand side, then
there exists an open covering $U = \bigcup_{j \in J} U_j$
such that $s|_{U_j}$ is a finite sum
$\sum_{i \in I_j} s_{ji}$ with $s_{ji} \in \mathcal{F}_i(U_j)$.
Because $U$ is quasi-compact we may assume that the
covering is finite, i.e., that $J$ is finite.
Then $I' = \bigcup_{j \in J} I_j$ is a finite subset of
$I$. Clearly, $s$ is a section of the subsheaf
$\bigoplus_{i \in I'} \mathcal{F}_i$. The result follows
from the fact that for a finite direct sum sheafification
is not needed, see Lemma \ref{lemma-limits-colimits} above.
\end{proof}

\noindent
The existence of limits and colimits
allows us to consider exactness properties of
functors defined on the category of $\mathcal{O}$-modules
in terms of limits and colimits, as in
Categories, Section \ref{categories-section-exact-functor}.
See Homology, Lemma \ref{homology-lemma-exact-functor} for a
description of exactness
properties in terms of short exact sequences.

\begin{lemma}
\label{lemma-exactness-pushforward-pullback}
Let $f : (X, \mathcal{O}_X) \to (Y, \mathcal{O}_Y)$
be a morphism of ringed spaces.
\begin{enumerate}
\item The functor $f_*$ is left exact. In fact it commutes with
all limits.
\item The functor $f^*$ is right exact. In fact it commutes
with all colimits.
\end{enumerate}
\end{lemma}

\begin{proof}
This is true because $(f^*, f_*)$ is an adjoint pair
of functors, see
Sheaves, Lemma \ref{sheaves-lemma-adjoint-pullback-pushforward-modules}.
See Categories, Section \ref{categories-section-adjoint}.
\end{proof}

\begin{lemma}
\label{lemma-j-shriek-exact}
Let $j : U \to X$ be an open immersion of topological spaces.
The functor $j_! : \textit{Ab}(U) \to \textit{Ab}(X)$
is exact.
\end{lemma}

\begin{proof}
This is clear from the description of stalks 
given in Sheaves, Lemma \ref{sheaves-lemma-j-shriek-abelian}.
\end{proof}



\section{Sections of sheaves of $\mathcal{O}$-modules}
\label{section-sections}

\noindent
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
Let $s \in \Gamma(X, \mathcal{F}) = \mathcal{F}(X)$ be a
global section. There is a unique {\it map of $\mathcal{O}_X$-modules
$$
\mathcal{O}_X \longrightarrow \mathcal{F},\ f \longmapsto fs
$$
associated to $s$}. The notation above signifies that a local
section $f$ of $\mathcal{O}_X$, i.e., a section $f$ over some open $U$,
is mapped to the multiplication of $f$ with the restriction of $s$ to
$U$. Conversely, any map $\varphi : \mathcal{O}_X \to \mathcal{F}$
gives rise to a section $s = \varphi(1)$ such that $\varphi$ is
the morphism associated to $s$.

\begin{definition}
\label{definition-globally-generated}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
We say that {\it $\mathcal{F}$ is generated by global
sections} if there exist a set $I$, and
global sections $s_i \in \Gamma(X, \mathcal{F})$, $i \in I$
such that the map
$$
\bigoplus\nolimits_{i \in I}
\mathcal{O}_X \longrightarrow \mathcal{F}
$$
which is the map associated to $s_i$ on the summand corresponding to $i$,
is surjective. In this case we say that the sections $s_i$
{\it generate} $\mathcal{F}$.
\end{definition}

\noindent
We often use the abuse of notation introduced in
Sheaves, Section \ref{sheaves-section-stalks} where, given a local
section $s$ of $\mathcal{F}$ defined in an open neighbourhood
of a point $x \in X$, we denote $s_x$, or even $s$ the image of $s$
in the stalk $\mathcal{F}_x$.

\begin{lemma}
\label{lemma-globally-generated}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
Let $I$ be a set. Let
$s_i \in \Gamma(X, \mathcal{F})$, $i \in I$.
be global sections. The sections $s_i$ generate
$\mathcal{F}$ if and only if for all $x\in X$ the
elements $s_{i, x} \in \mathcal{F}_x$ generate
the $\mathcal{O}_{X, x}$-module $\mathcal{F}_x$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-generated-by-local-sections}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
Let $I$ be a set. Let $s_i$, $i \in I$ be a collection
of local sections of $\mathcal{F}$, i.e., $s_i \in \mathcal{F}(U_i)$
for some opens $U_i \subset X$. There exists a unique smallest
subsheaf of $\mathcal{O}_X$-modules $\mathcal{G}$ such
that each $s_i$ corresponds to a local section of
$\mathcal{G}$.
\end{lemma}

\begin{proof}
Consider the sub-presheaf of $\mathcal{O}_X$-modules
defined by the rule
$$
U
\longmapsto
\{
\text{sums } \sum\nolimits_{i \in J} f_i (s_i|_U)
\text{ where } J \text{ is finite, }
U \subset U_i \text{ for } i\in J, \text{ and }
f_i \in \mathcal{O}_X(U)
\}
$$
Let $\mathcal{G}$ be the sheafification of this sub-presheaf.
This is a subsheaf of $\mathcal{F}$ by 
Sheaves, Lemma \ref{sheaves-lemma-characterize-epi-mono}.
Since all the finite sums clearly have to be in $\mathcal{G}$
this is the smallest subsheaf as desired.
\end{proof}

\begin{definition}
\label{definition-generated-by-local-sections}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
Given a set $I$, and
local sections $s_i$, $i \in I$ of $\mathcal{F}$
we say that the subsheaf $\mathcal{G}$ of
Lemma \ref{lemma-generated-by-local-sections}
above is the {\it subsheaf generated by the $s_i$}.
\end{definition}

\begin{lemma}
\label{lemma-generated-by-local-sections-stalk}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
Given a set $I$, and
local sections $s_i$, $i \in I$ of $\mathcal{F}$.
Let $\mathcal{G}$ be the subsheaf generated by the
$s_i$ and let $x\in X$.
Then $\mathcal{G}_x$ is the $\mathcal{O}_{X,x}$-submodule of
$\mathcal{F}_x$ generated by the elements $s_{i, x}$
for those $i$ such that $s_i$ is defined at $x$.
\end{lemma}

\begin{proof}
This is clear from the construction of $\mathcal{G}$
in the proof of Lemma \ref{lemma-generated-by-local-sections}.
\end{proof}










\section{Supports of modules and sections}
\label{section-support}

\begin{definition}
\label{definition-support}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
\begin{enumerate}
\item The {\it support of $\mathcal{F}$} is the set of 
points $x \in X$ such that $\mathcal{F}_x \not = 0$.
\item Let $s \in \Gamma(X, \mathcal{F})$ be a global section.
The {\it support of $s$} is the set of points $x \in X$
such that the image $s_x \in \mathcal{F}_x$ of $s$ is
not zero.
\end{enumerate}
\end{definition}

\noindent
Of course the support of a local section is then defined also
since a local section is a global section of the restriction of
$\mathcal{F}$.

\begin{lemma}
\label{lemma-support-section-closed}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
Let $U \subset X$ open.
\begin{enumerate}
\item The support of $s \in \mathcal{F}(U)$ is closed in $U$.
\item The support of $fs$ is contained in the intersections
of the supports of $f \in \mathcal{O}_X(U)$ and $s \in \mathcal{F}(U)$
\item The support of $s + s'$ is contained in the union of
the supports of $s, s' \in \mathcal{F}(U)$.
\item The support of $\mathcal{F}$ is the union of the supports
of all local sections of $\mathcal{F}$.
\item If $\varphi : \mathcal{F} \to \mathcal{G}$ is a morphism of
$\mathcal{O}_X$-modules, then the support of $\varphi(s)$ is
contained in the support of $s \in \mathcal{F}(U)$.
\end{enumerate}
\end{lemma}

\begin{proof}
This is true because if $s_x = 0$, then $s$ is zero
in an open neighbourhood of $x$ by definition of stalks.
Similarly for $f$. Details omitted.
\end{proof}

\noindent
In general the support of a sheaf of modules is not closed.
Namely, the sheaf could be an abelian sheaf on $\mathbf{R}$
(with the usual archimedean topology)
which is the direct sum of infinitely many nonzero skyscraper
sheaves each supported at a single point $p_i$ of $\mathbf{R}$.
Then the support would be the set of points $p_i$
which may not be closed.

\medskip\noindent
Another example is to consider the open immersion
$j : U = (0 ,\infty) \to \mathbf{R} = X$, and the abelian sheaf
$j_!\underline{\mathbf{Z}}_U$. By Sheaves, Section
\ref{sheaves-section-open-immersions} the support of
this sheaf is exactly $U$.

\begin{lemma}
\label{lemma-support-sheaf-rings-closed}
Let $X$ be a topological space.
The support of a sheaf of rings is closed.
\end{lemma}

\begin{proof}
This is true because (according to our conventions)
a ring is $0$ if and only if
$1 = 0$, and hence the support of a sheaf of rings
is the support of the unit section.
\end{proof}






\section{Closed immersions and abelian sheaves}
\label{section-closed-immersions}

\noindent
Recall that we think of an abelian sheaf on a topological space $X$ as a 
sheaf of $\underline{\mathbf{Z}}_X$-modules. Thus we may apply any results,
definitions for sheaves of modules to abelian sheaves.

\begin{lemma}
\label{lemma-i-star-exact}
Let $X$ be a topological space. Let $Z \subset X$ be a closed subset.
Denote $i : Z \to X$ the inclusion map. The functor
$$
i_* : \textit{Ab}(Z) \longrightarrow \textit{Ab}(X)
$$
is exact, fully faithful, with essential image exactly those
abelian sheaves whose support is contained in $Z$.
\end{lemma}

\begin{proof}
Exactness follows from the description of
stalks in Sheaves, Lemma \ref{sheaves-lemma-stalks-closed-pushforward}
and Lemma \ref{lemma-abelian}. The rest was shown in
Sheaves, Lemma \ref{sheaves-lemma-equivalence-categories-open-abelian}.
\end{proof}

\noindent
Let $\mathcal{F}$ be a sheaf on $X$. There is a canonical subsheaf
of $\mathcal{F}$ which consists of exactly those sections whose
support is contained in $Z$. Here is the exact statement.

\begin{lemma}
\label{lemma-sections-support-in-closed}
Let $X$ be a topological space. Let $Z \subset X$ be a closed subset.
Let $\mathcal{F}$ be a sheaf on $X$. For $U \subset X$ open set
$$
\Gamma(U, \mathcal{H}_Z(\mathcal{F})) =
\{s \in \mathcal{F}(U) \mid
\text{ the support of }s\text{ is contained in }Z \cap U\}
$$
Then $\mathcal{H}_Z(\mathcal{F})$ is an abelian subsheaf of
$\mathcal{F}$. It is the largest abelian subsheaf of
$\mathcal{F}$ whose support is contained in $Z$. The construction
$\mathcal{F} \mapsto \mathcal{H}_Z(\mathcal{F})$ is functorial
in the abelian sheaf $\mathcal{F}$.
\end{lemma}

\begin{proof}
This follows from Lemma \ref{lemma-support-section-closed}.
\end{proof}

\noindent
This seems like a good opportunity to show that the functor
$i_*$ has a right adjoint on abelian sheaves.

\begin{lemma}
\label{lemma-i-star-right-adjoint}
Denote\footnote{This is likely nonstandard notation.}
$i^! : \textit{Ab}(X) \to \textit{Ab}(Z)$ the functor
$\mathcal{F} \mapsto i^{-1}\mathcal{H}_Z(\mathcal{F})$.
Then $i^!$ is a right adjoint to $i_*$, in a formula
$$
\text{Mor}_{\textit{Ab}(X)}(i_*\mathcal{G}, \mathcal{F})
=
\text{Mor}_{\textit{Ab}(Z)}(\mathcal{G}, i^!\mathcal{F}).
$$
In particular $i_*$ commutes with arbitrary colimits.
\end{lemma}

\begin{proof}
Note that $i_*i^!\mathcal{F} = \mathcal{H}_Z(\mathcal{F})$.
Since $i_*$ is fully faithful we are reduced to showing that
$$
\text{Mor}_{\textit{Ab}(X)}(i_*\mathcal{G}, \mathcal{F})
=
\text{Mor}_{\textit{Ab}(X)}(\mathcal{G}, \mathcal{H}_Z(\mathcal{F})).
$$
This follows since the support of the image via any homomorphism
of a section of $i_*\mathcal{G}$ is supported on $Z$, see
Lemma \ref{lemma-support-section-closed}.
\end{proof}

\begin{remark}
\label{remark-i-star-right-adjoint}
In Sheaves, Remark \ref{sheaves-remark-i-star-not-exact}
we showed that $i_*$ as a functor
on the categories of sheaves of sets
does not have a right adjoint simply because
it is not exact. However, it is very close to being
true, in fact, the functor $i_*$ is exact on sheaves
of pointed sets, sections with support in $Z$ can
be defined for sheaves of pointed sets, and $i^!$
makes sense and is a right adjoint to $i_*$.
\end{remark}











\section{Modules locally generated by sections}
\label{section-locally-generated}

\noindent
Let $(X, \mathcal{O}_X)$ be a ringed space.
In this and the following section we will often restrict
sheaves to open subspaces $U \subset X$, see
Sheaves, Section \ref{sheaves-section-open-immersions}.
In particular, we will often denote the open subspace
by $(U, \mathcal{O}_U)$ instead of the more correct
notation $(U, \mathcal{O}_X|_U)$, see 
Sheaves, Definition \ref{sheaves-definition-restriction}.

\medskip\noindent
Consider the open immersion
$j : U = (0 ,\infty) \to \mathbf{R} = X$, and the abelian sheaf
$j_!\underline{\mathbf{Z}}_U$. By Sheaves, Section
\ref{sheaves-section-open-immersions} the stalk of
$j_!\underline{\mathbf{Z}}_U$ at $x = 0$ is $0$. In fact the
sections of this sheaf over any open interval containing $0$
are $0$. Thus there is no open neighbourhood of the point
$0$ over which the sheaf can be generated by sections.

\begin{definition}
\label{definition-locally-generated}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
We say that $\mathcal{F}$ is {\it locally generated by sections}
if for every $x \in X$ there exists an open
neighbourhood $U$ such that $\mathcal{F}|_U$
is globally generated as a sheaf of $\mathcal{O}_U$-modules.
\end{definition}

\noindent
In other words there exists a set $I$ and for
each $i$ a section $s_i \in \mathcal{F}(U)$ such
that the associated map
$$
\bigoplus\nolimits_{i \in I} \mathcal{O}_U 
\longrightarrow
\mathcal{F}|_U
$$
is surjective.

\begin{lemma}
\label{lemma-pullback-locally-generated}
Let $f : (X, \mathcal{O}_X) \to (Y, \mathcal{O}_Y)$
be a morphism of ringed spaces.
The pullback $f^*\mathcal{G}$ is locally generated by sectons
if $\mathcal{G}$ is locally generated by sections.
\end{lemma}

\begin{proof}
Given an open subspace $V$ of $X$ we may
consider the commutative diagram of ringed spaces
$$
\xymatrix{
(f^{-1}V, \mathcal{O}_{f^{-1}V}) \ar[r]_{j'} \ar[d]_{f'} &
(X, \mathcal{O}_X) \ar[d]^f \\
(V, \mathcal{O}_V) \ar[r]^j &
(Y, \mathcal{O}_Y)
}
$$
We know that $f^*\mathcal{G}|_{f^{-1}V} \cong (f')^*(\mathcal{G}|_V)$,
see Sheaves, Lemma \ref{sheaves-lemma-push-pull-composition-modules}.
Thus we may assume that $\mathcal{G}$ is globally generated.

\medskip\noindent
We have seen that $f^*$ commutes with all colimits,
and is right exact, see Lemma \ref{lemma-exactness-pushforward-pullback}.
Thus if we have a surjection
$$
\bigoplus\nolimits_{i \in I}
\mathcal{O}_Y
\to
\mathcal{G}
\to
0
$$
then upon applying $f^*$ we obtain the surjection
$$
\bigoplus\nolimits_{i \in I}
\mathcal{O}_X
\to
f^*\mathcal{G}
\to
0.
$$
This implies the lemma.
\end{proof}












\section{Modules of finite type}
\label{section-finite-type}

\begin{definition}
\label{definition-finite-type}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
We say that $\mathcal{F}$ is {\it of finite type}
if for every $x \in X$ there exists an open 
neighbourhood $U$ such that $\mathcal{F}|_U$
is generated by finitely many sections.
\end{definition}

\begin{lemma}
\label{lemma-support-finite-type-closed}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
If $\mathcal{F}$ is of finite type the support of $\mathcal{F}$ is closed.
\end{lemma}

\begin{proof}
We may replace $X$ by one of the opens $U$ which are garanteed
to exist by Definition \ref{definition-finite-type}. Thus
we may assume that $\mathcal{F}$ is generated by finitely
many global sections $s_i$. In this case the support of
$\mathcal{F}$ is the union of the supports of the $s_i$.
We win by Lemma \ref{lemma-support-section-closed}.
\end{proof}

\begin{lemma}
\label{lemma-pullback-finite-type}
Let $f : (X, \mathcal{O}_X) \to (Y, \mathcal{O}_Y)$
be a morphism of ringed spaces.
The pullback $f^*\mathcal{G}$ of a finite type
$\mathcal{O}_Y$-module is a finite type $\mathcal{O}_X$-module.
\end{lemma}

\begin{proof}
Arguing as in the proof of Lemma \ref{lemma-pullback-locally-generated}
we may assume $\mathcal{G}$ is globally generated by finitely
many sections.
We have seen that $f^*$ commutes with all colimits,
and is right exact, see Lemma \ref{lemma-exactness-pushforward-pullback}.
Thus if we have a surjection
$$
\bigoplus\nolimits_{i = 1, \ldots, n}
\mathcal{O}_Y
\to
\mathcal{G}
\to
0
$$
then upon applying $f^*$ we obtain the surjection
$$
\bigoplus\nolimits_{i = 1, \ldots, n}
\mathcal{O}_X
\to
f^*\mathcal{G}
\to
0.
$$
This implies the lemma.
\end{proof}

\begin{lemma}
\label{lemma-extension-finite-type}
Let $X$ be a ringed space.
The image of a morphism of $\mathcal{O}_X$-modules of finite
type is of finite type.
Let 
$0 \to \mathcal{F}_1 \to \mathcal{F}_2 \to \mathcal{F}_3 \to 0$
be a short exact sequence of $\mathcal{O}_X$-modules.
If $\mathcal{F}_1$ and $\mathcal{F}_2$ are of finite type,
so is $\mathcal{F}_2$.
\end{lemma}

\begin{proof}
The statement on images is trivial.
The statement on short exact sequences comes from the
fact that sections of $\mathcal{F}_3$ locally lift to sections
of $\mathcal{F}_2$ and the corresponding result in
the category of modules over a ring (applied to the stalks
for example).
\end{proof}













\section{Quasi-coherent modules}
\label{section-quasi-coherent}

\noindent
In this section we introduce an abstract notion of
quasi-coherent $\mathcal{O}_X$-module. This notion is very
usefull in algebraic geometry, since quasi-coherent modules
on a scheme have a good description on any affine open.
However, we warn the reader that
in the general setting of (locally) ringed spaces
this notion is not well behaved at all. The cagegory of 
quasi-coherent sheaves is not abelian in general, infinite
direct sums of quasi-coherent sheaves aren't quasi-coherent, etc, etc.

\begin{definition}
\label{definition-quasi-coherent}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
We say that $\mathcal{F}$ is {\it a quasi-coherent
sheaf of $\mathcal{O}_X$-modules} if for every
point $x \in X$ there exists an open neighbourhood
$x\in U \subset X$ such that $\mathcal{F}|_U$
is isomorphic to the cokernel of a map
$$
\bigoplus\nolimits_{j \in J}
\mathcal{O}_U
\longrightarrow
\bigoplus\nolimits_{i \in I}
\mathcal{O}_U
$$
The category of quasi-coherent $\mathcal{O}_X$-modules
is denoted $\text{QCoh}(\mathcal{O}_X)$.
\end{definition}

\noindent
The definition means that $X$ is covered by open sets $U$
such that $\mathcal{F}|_U$ has a {\it presentation}
of the form
$$
\bigoplus\nolimits_{j \in J}
\mathcal{O}_U
\longrightarrow
\bigoplus\nolimits_{i \in I}
\mathcal{O}_U
\to
\mathcal{F}|_U
\to
0.
$$
Here presentation signifies that the displayed
sequence is exact. In other words
\begin{enumerate}
\item for every point $x$ of $X$ there exists
an open neighbourhood such that $\mathcal{F}|_U$
is generated by global sections, and
\item for a suitable choice of these sections
the kernel of the associated surjection is also
generated by global sections.
\end{enumerate}

\begin{lemma}
\label{lemma-direct-sum-quasi-coherent}
Let $(X, \mathcal{O}_X)$ be a ringed space.
The direct sum of two quasi-coherent $\mathcal{O}_X$-modules is
a quasi-coherent $\mathcal{O}_X$-module
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{remark}
Warning: It is not true in general that an infinite
direct sum of quasi-coherent $\mathcal{O}_X$-modules
is quasi-coherent. For more esoteric behaviour of quasi-coherent
modules see Example \ref{example-quasi-coherent}.
\end{remark}

\begin{lemma}
\label{lemma-pullback-quasi-coherent}
Let $f : (X, \mathcal{O}_X) \to (Y, \mathcal{O}_Y)$
be a morphism of ringed spaces.
The pullback $f^*\mathcal{G}$ of a quasi-coherent
$\mathcal{O}_Y$-module is quasi-coherent.
\end{lemma}

\begin{proof}
Arguing as in the proof of Lemma \ref{lemma-pullback-locally-generated}
we may assume $\mathcal{G}$ has a global presentation by
direct sums of copies of $\mathcal{O}_Y$.
We have seen that $f^*$ commutes with all colimits,
and is right exact, see Lemma \ref{lemma-exactness-pushforward-pullback}.
Thus if we have an exact sequence
$$
\bigoplus\nolimits_{j \in J}
\mathcal{O}_Y
\longrightarrow
\bigoplus\nolimits_{i \in I}
\mathcal{O}_Y
\to
\mathcal{G}
\to
0
$$
then upon applying $f^*$ we obtain the exact sequence
$$
\bigoplus\nolimits_{j \in J}
\mathcal{O}_X
\longrightarrow
\bigoplus\nolimits_{i \in I}
\mathcal{O}_X
\to
f^*\mathcal{G}
\to
0.
$$
This implies the lemma.
\end{proof}

\noindent
This gives plenty of examples of quasi-coherent sheaves.

\begin{lemma}
\label{lemma-construct-quasi-coherent-sheaves}
Let $(X, \mathcal{O}_X)$ be ringed space.
Let $\alpha : R \to \Gamma(X, \mathcal{O}_X)$ be a ring homomorphism from
a ring $R$ into the ring of global sections on $X$.
Let $M$ be an $R$-module.
The following three constructions give canonically isomorphic
sheaves of $\mathcal{O}_X$-modules:
\begin{enumerate}
\item Let $\pi : (X, \mathcal{O}_X) \longrightarrow (\{*\}, R)$
be the morphism of ringed spaces with $\pi : X \to \{*\}$
the unique map and with $\pi$-map $\pi^\sharp$ the given map
$\alpha : R \to \Gamma(X, \mathcal{O}_X)$. Set $\mathcal{F}_1 = \pi^*M$.
\item Choose a presentation
$\bigoplus_{j \in J} R \to \bigoplus_{i \in I} R \to M \to 0$.
Set
$$
\mathcal{F}_2 = \text{Coker}\left(
\bigoplus\nolimits_{j \in J} \mathcal{O}_X
\to
\bigoplus\nolimits_{i \in I} \mathcal{O}_X
\right).
$$
Here the map on the component $\mathcal{O}_X$ corresponding to $j \in J$
given by the section $\sum_i \alpha(r_{ij})$ where the $r_{ij}$
are the matrix coefficients of the map in the presentation of $M$.
\item Set $\mathcal{F}_3$ equal to the sheaf associated to the presheaf
$U \mapsto \mathcal{O}_X(U) \otimes_R M$, where the map
$R \to \mathcal{O}_X(U)$ is the composition of $\alpha$ and
the restriction map $\mathcal{O}_X(X) \to \mathcal{O}_X(U)$.
\end{enumerate}
This construction has the following properties:
\begin{enumerate}
\item The resulting sheaf of $\mathcal{O}_X$-modules
$\mathcal{F}_M = \mathcal{F}_1 = \mathcal{F}_2 = \mathcal{F}_3$
is quasi-coherent.
\item The construction gives a functor from
the category of $R$-modules to the category of quasi-coherent
sheaves on $X$ which commutes with arbitrary colimits.
\item For any $x \in X$ we have
$\mathcal{F}_{M, x} = \mathcal{O}_{X,x} \otimes_R M$
functorial in $M$.
\item Given any $\mathcal{O}_X$-module
$\mathcal{G}$ we have
$$
\text{Mor}_{\mathcal{O}_X}(\mathcal{F}_M, \mathcal{G})
=
\text{Hom}_R(M, \Gamma(X, \mathcal{G}))
$$
where the $R$-module structure on $\Gamma(X, \mathcal{G})$
comes from the $\Gamma(X, \mathcal{O}_X)$-module structure via
$\alpha$.
\end{enumerate}
\end{lemma}

\begin{proof}
The isomorphism between $\mathcal{F}_1$ and $\mathcal{F}_2$
comes from the fact that $\pi^*$ is defined as the sheafification
of the presheaf in (3), see Sheaves, Section
\ref{sheaves-section-ringed-spaces-functoriality-modules}.
The isomorphism between the constructions in (2) and (1) comes
from the fact that the functor $\pi^*$ is right exact, so
$\pi^*(\bigoplus_{j \in J} R) \to \pi^*(\bigoplus_{i \in I} R) \to
\pi^*M \to 0$ is exact, $\pi^*$ commutes with arbitrary
direct sums, see Lemma \ref{lemma-exactness-pushforward-pullback},
and finally the fact that $\pi^*(R) = \mathcal{O}_X$.

\medskip\noindent
Assertion (1) is clear from construction (2).
Assertion (2) is clear since $\pi^*$ has these properties.
Assertion (3) follows from the description of stalks of
pullback sheaves, see
Sheaves, Lemma \ref{sheaves-lemma-stalk-pullback-modules}.
Assertion (4) follows from adjointness of $\pi_*$ and
$\pi^*$.
\end{proof}

\begin{definition}
\label{definition-sheaf-associated}
In the situation of Lemma \ref{lemma-construct-quasi-coherent-sheaves}
we say $\mathcal{F}_M$ is the {\it sheaf associated to the module $M$
and the ring map $\alpha$}. If $R = \Gamma(X, \mathcal{O}_X)$
and $\alpha = \text{id}_R$ we simply say $\mathcal{F}_M$ is the
{\it sheaf associated to the module $M$}.
\end{definition}


\begin{lemma}
\label{lemma-restrict-quasi-coherent}
Let $(X, \mathcal{O}_X)$ be ringed space.
Set $R = \Gamma(X, \mathcal{O}_X)$.
Let $M$ be an $R$-module.
Let $\mathcal{F}_M$ be the quasi-coherent sheaf of
$\mathcal{O}_X$-modules associated to $M$.
If $g : (Y, \mathcal{O}_Y) \to (X, \mathcal{O}_X)$
is a morphism of ringed spaces, then
$g^*\mathcal{F}_M$ is the sheaf associated
to the $\Gamma(Y, \mathcal{O}_Y)$-module
$\Gamma(Y, \mathcal{O}_Y) \otimes_R M$.
\end{lemma}

\begin{proof}
The assertion follows from the first description
of $\mathcal{F}_M$ in Lemma \ref{lemma-construct-quasi-coherent-sheaves}
as $\pi^*M$, and the following commutative diagram
of ringed spaces
$$
\xymatrix{
(X, \mathcal{O}_X) \ar[r]_-\pi \ar[d]_g &
(\{*\}, \Gamma(X, \mathcal{O}_X)) \ar[d]^{g^\sharp} \\
(Y, \mathcal{O}_Y) \ar[r]^-\pi &
(\{*\}, \Gamma(Y, \mathcal{O}_Y))
}
$$
(Also use Sheaves, Lemma \ref{sheaves-lemma-push-pull-composition-modules}.)
\end{proof}

\begin{lemma}
\label{lemma-quasi-coherent-module}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $x \in X$ be a point.
Assume that $x$ has a fundamental system of quasi-compact neighbourhoods.
Consider any quasi-coherent $\mathcal{O}_X$-module $\mathcal{F}$.
Then there exists an open neighbourhood $U$ of $x$
such that $\mathcal{F}|_U$ is isomorphic to the
sheaf of modules $\mathcal{F}_M$ on $(U, \mathcal{O}_U)$
associated to some $\Gamma(U, \mathcal{O}_U)$-module $M$.
\end{lemma}

\begin{proof}
First we may replace $X$ by an open neighbourhood of $x$
and assume that $\mathcal{F}$ is isomorphic to the
cokernel of a map
$$
\Psi :
\bigoplus\nolimits_{j \in J}
\mathcal{O}_X
\longrightarrow
\bigoplus\nolimits_{i \in I}
\mathcal{O}_X.
$$
The problem is that this map may not be given by
a ``matrix'', because the module of global sections of a direct sum 
is in general different from the direct sum of the modules
of global sections.

\medskip\noindent
Let $x \in E \subset X$ be a quasi-compact
neighbourhood of $x$ (note: $E$ may not be open).
Let $x \in U \subset E$ be an open neighbourhood of
$x$ contained in $E$.
Next, we proceed as in the proof of
Lemma \ref{lemma-section-direct-sum-quasi-compact}.
For each $j \in J$ denote
$s_j \in \Gamma(X, \bigoplus\nolimits_{i \in I} \mathcal{O}_X)$
the image of the section $1$ in the summand $\mathcal{O}_X$
corresponding to $j$. There exists a finite collection of opens
$U_{jk}$, $k \in K_j$ such that $E \subset \bigcup_{k \in K_j} U_{jk}$
and such that each restriction $s_j|_{U_{jk}}$
is a finite sum $\sum_{i \in I_{jk}} f_{jki}$
with $I_{jk} \subset I$, and $f_{jki}$ in the summand
$\mathcal{O}_X$ corresponding to $i \in I$. Set
$I_j = \bigcup_{k \in k_J} I_{jk}$. This is a finite set.
Since $U \subset E \subset \bigcup_{k \in K_j} U_{jk}$
the section $s_j|_U$ is a section of the finite direct sum
$\bigoplus_{i \in I_j} \mathcal{O}_X$.
By Lemma \ref{lemma-limits-colimits}
we see that actually $s_j|_U$ is a sum
$\sum_{i \in I_j} f_{ij}$ and
$f_{ij} \in \mathcal{O}_X(U) = \Gamma(U, \mathcal{O}_U)$.

\medskip\noindent
At this point we can define a module $M$ as the cokernel of the map
$$
\bigoplus\nolimits_{j \in J}
\Gamma(U, \mathcal{O}_U)
\longrightarrow
\bigoplus\nolimits_{i \in I}
\Gamma(U, \mathcal{O}_U)
$$
with matrix given by the $(f_{ij})$. By construction (2) of
Lemma \ref{lemma-construct-quasi-coherent-sheaves} we see that
$\mathcal{F}_M$ has the same presentation as $\mathcal{F}|_U$
and therefore $\mathcal{F}_M \cong \mathcal{F}|_U$.
\end{proof}

\begin{example}
\label{example-quasi-coherent}
Let $X$ be countably many copies $L_1, L_2, L_3, \ldots$
of the real line all glued together at $0$; a fundamental
system of neighbourhoods of $0$ being the collection
$\{U_n\}_{n \in \mathbf{N}}$, with $U_n \cap L_i = (-1/n, 1/n)$.
Let $\mathcal{O}_X$ be the sheaf of continuous real valued functions.
Let $f : \mathbf{R} \to \mathbf{R}$ be a continuous function
which is identically zero on $(-1, 1)$ and identically $1$
on $(-\infty, -2) \cup (2, \infty)$. Denote $f_n$ the continuous
function on $X$ which is equal to $x \mapsto f(nx)$ on each
$L_j = \mathbf{R}$. Let $1_{L_j}$ be the characteristic function
of $L_j$. We consider the map
$$
\bigoplus\nolimits_{j \in \mathbf{N}}
\mathcal{O}_X
\longrightarrow
\bigoplus\nolimits_{j, i \in \mathbf{N}}
\mathcal{O}_X,\ 
e_j \longmapsto \sum_{j \in \mathbf{N}} f_i 1_{L_j} e_{ij}
$$
with obvious notation. This makes
sense because this sum is locally finite.
Clearly, there is no neighbourhood of $0 \in X$ such
that this map is given by a ``matrix'' as in the proof
of Lemma \ref{lemma-quasi-coherent-module} above.

\medskip\noindent
Note that $\bigoplus\nolimits_{j \in \mathbf{N}} \mathcal{O}_X$
is the sheaf associated to the free module with basis $e_j$
and similarly for the other direct sum. Thus we see that a
morphism of sheaves associated to modules in general even
locally on $X$ does not come from a morphism of modules.
Similarly there should be an example of a ringed space $X$
and a quasi-coherent $\mathcal{O}_X$-module $\mathcal{F}$
such that $\mathcal{F}$ is not locally of the form $\mathcal{F}_M$.
(Please email if you find one.)
Moreover, there should be examples of locally compact spaces
$X$ and maps $\mathcal{F}_M \to \mathcal{F}_N$ which also do
not locally come from maps of modules (the proof of Lemma
\ref{lemma-quasi-coherent-module} shows this cannot happen
if $N$ is free).
\end{example}












\section{Modules of finite presentation}
\label{section-finite-presentation}


\begin{definition}
\label{definition-finite-presentation}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
We say that $\mathcal{F}$ is {\it of finite presentation}
if for every point $x \in X$ there exists an open neighbourhood
$x\in U \subset X$, and  $n, m \in \mathbf{N}$ such that $\mathcal{F}|_U$
is isomorphic to the cokernel of a map
$$
\bigoplus\nolimits_{j = 1, \ldots, m}
\mathcal{O}_U
\longrightarrow
\bigoplus\nolimits_{i = 1, \ldots, n}
\mathcal{O}_U
$$
\end{definition}

\noindent
This means that $X$ is covered by open sets $U$
such that $\mathcal{F}|_U$ has a {\it presentation}
of the form
$$
\bigoplus\nolimits_{j = 1, \ldots, m}
\mathcal{O}_U
\longrightarrow
\bigoplus\nolimits_{i = 1, \ldots, n}
\mathcal{O}_U
\to
\mathcal{F}|_U
\to
0.
$$
Here presentation signifies that the displayed
sequence is exact. In other words
\begin{enumerate}
\item for every point $x$ of $X$ there exists
an open neighbourhood such that $\mathcal{F}|_U$
is generated by finitely many global sections, and
\item for a suitable choice of these sections
the kernel of the associated surjection is also
generated by finitely many global sections.
\end{enumerate}

\begin{lemma}
\label{lemma-finite-presentation-quasi-coherent}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Any $\mathcal{O}_X$-module of finite presentation
is quasi-coherent.
\end{lemma}

\begin{proof}
Immediate from defintions.
\end{proof}

\begin{lemma}
\label{lemma-pullback-finite-presentation}
Let $f : (X, \mathcal{O}_X) \to (Y, \mathcal{O}_Y)$
be a morphism of ringed spaces.
The pullback $f^*\mathcal{G}$ of a module of finite presentation
is of finite presentation.
\end{lemma}

\begin{proof}
Exactly the same as the proof of Lemma \ref{lemma-pullback-quasi-coherent}
but with finite index sets.
\end{proof}

\begin{lemma}
\label{lemma-quasi-coherent-limit-finite-presentation}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Set $R = \Gamma(X, \mathcal{O}_X)$.
Let $M$ be an $R$-module.
The $\mathcal{O}_X$-module $\mathcal{F}_M$ associated to $M$
is a direct colimit of finitely presented $\mathcal{O}_X$-modules.
\end{lemma}

\begin{proof}
This follows immediately from
Lemma \ref{lemma-construct-quasi-coherent-sheaves} 
and the fact that any module is a directed colimit
of finitely presented modules, see
Algebra, Lemma \ref{algebra-lemma-module-colimit-fp}.
\end{proof}









\section{Coherent modules}
\label{section-coherent}

\noindent
The category of coherent sheaves on a rniged space $X$
is a more reasonable object
than the category of quasi-coherent sheaves, in the sense
that it is at least an abelian subcategory of $\text{Mod}(\mathcal{O}_X)$
no matter what $X$ is. On the other hand, the pull back of a
coherent module is ``almost never'' coherent in the general setting
of ringed spaces.

\begin{definition}
\label{definition-coherent}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
We say that $\mathcal{F}$ is {\it a coherent $\mathcal{O}_X$-module}
if the following two conditions hold:
\begin{enumerate}
\item $\mathcal{F}$ is of finite type, and
\item for every open $U \subset X$ and every finite
collection $s_i \in \mathcal{F}(U)$, $i = 1, \ldots, n$
the kernel of the associated map
$\bigoplus_{i = 1, \ldots, n} \mathcal{O}_U \to \mathcal{F}$
is of finite type.
\end{enumerate}
The category of coherent $\mathcal{O}_X$-modules is denoted
$\text{Coh}(\mathcal{O}_X)$.
\end{definition}

\begin{lemma}
\label{lemma-coherent-finite-presentation}
Let $(X, \mathcal{O}_X)$ be a ringed space.
Any coherent $\mathcal{O}_X$-module is of finite presentation
and hence quasi-coherent.
\end{lemma}

\begin{proof}
Let $\mathcal{F}$ be a coherent sheaf on $X$.
Pick a point $x \in X$.
By (1) of the definition of coherent, we may find an open neighbourhood $U$
and sections $s_i$, $i = 1, \ldots, n$ of $\mathcal{F}$ over $U$
such that $\Psi : \bigoplus_{i = 1, \ldots, n} \mathcal{O}_U \to \mathcal{F}$
is surjective. By (2) of the definition of coherent, we may find
an open neighbourhood $V$, $x \in V \subset U$ and sections
$t_1, \ldots, t_m$ of $\bigoplus_{i = 1, \ldots, n} \mathcal{O}_V$
which generate the kernel of $\Psi|_V$. Then over $V$ we get the
presentation
$$
\bigoplus\nolimits_{j = 1, \ldots, m}
\mathcal{O}_V
\longrightarrow
\bigoplus\nolimits_{i = 1, \ldots, n}
\mathcal{O}_V
\to
\mathcal{F}|_V
\to
0
$$
as desired.
\end{proof}

\begin{example}
\label{example-coherent-not-Noetherian}
Suppose that $X$ is a point. In this case the definition
above gives a notion for modules over rings.
What does the definition of coherent mean?
It is closely related to the notion of Noetherian,
but it is not the same: Namely, the ring 
$R = \mathbf{C}[x_1, x_2, x_3, \ldots]$ is coherent
as a module over itself but not Noetherian as a module
over itself.
\end{example}

\begin{lemma}
\label{lemma-coherent-abelian}
Let $(X, \mathcal{O}_X)$ be a ringed space.
\begin{enumerate}
\item Any finite type subsheaf of a coherent sheaf is coherent.
\item Let $\varphi : \mathcal{F} \to \mathcal{G}$
be a morphism from a finite type sheaf $\mathcal{F}$
to a coherent sheaf $\mathcal{G}$. Then $\text{Ker}(\varphi)$ is finite type.
\item Let $\varphi : \mathcal{F} \to \mathcal{G}$ be a morphism
of coherent $\mathcal{O}_X$-modules. Then
$\text{Ker}(\varphi)$ and
$\text{Coker}(\varphi)$ are coherent.
\item The category of coherent sheaves on $X$ is abelian.
\item Given a short exact sequence of $\mathcal{O}_X$-modules
$0 \to \mathcal{F}_1 \to \mathcal{F}_2 \to \mathcal{F}_3 \to 0$
if two out of three are coherent so is the third.
\end{enumerate}
\end{lemma}

\begin{proof}
Condition (2) of Definition \ref{definition-coherent}
holds for any subsheaf of a coherent sheaf. Thus we get the
first statement.

\medskip\noindent
Assume the hypotheses of (2).
Let us show that $\text{Ker}(\varphi)$ is of finite type. Pick $x \in X$
Choose an open neighbourhood $U$ of $x$ in $X$ such
that $\mathcal{F}|_U$ is generated by $s_1, \ldots, s_n$.
By Definition \ref{definition-coherent} the kernel $\mathcal{K}$
of the induced map
$\bigoplus_{i = 1}^n \mathcal{O}_U \to \mathcal{G}$,
$e_i \mapsto \varphi(s_i)$ is of finite type.
Hence $\text{Ker}(\varphi)$ which is the image of the
composition
$\mathcal{K} \to \bigoplus_{i = 1}^n \mathcal{O}_U \to \mathcal{F}$
is of finite type.

\medskip\noindent
Assume the hypotheses of (3).
By (2) the kernel of $\varphi$ is of finite type and
hence by (1) it is coherent.

\medskip\noindent
With the same hypotheses
let us show that $\text{Coker}(\varphi)$ is coherent.
Since $\mathcal{G}$ is of finite type so is $\text{Coker}(\varphi)$.
Let $U \subset X$ be open and let
$\overline{s}_i \in \text{Coker}(\varphi)(U)$,
$i = 1, \ldots, n$ be sections. We have to show that
the kernel of the associated morphism
$\overline{\Psi} : \bigoplus_{i = 1}^n \mathcal{O}_U \to \text{Coker}(\varphi)$
has finite type.
There exists an open covering
of $U$ such that on each open all the sections $\overline{s}_i$
lift to sections $s_i$ of $\mathcal{G}$. Hence we may assume
this is the case over $U$. Thus $\overline{\Psi}$ lifts to
$\Psi : \bigoplus_{i = 1}^n \mathcal{O}_U \to \mathcal{G}$
Consider the following diagram
$$
\xymatrix{
0 \ar[r] &
\text{Ker}(\Psi) \ar[r] \ar[d] &
\bigoplus_{i = 1}^n \mathcal{O}_U \ar[r] \ar@{=}[d] &
\mathcal{G} \ar[r] \ar[d] &
0 \\
0 \ar[r] &
\text{Ker}(\overline{\Psi}) \ar[r] &
\bigoplus_{i = 1}^n \mathcal{O}_U \ar[r] &
\text{Coker}(\varphi) \ar[r] &
0
}
$$
By the snake lemma we get a short exact sequence
$0 \to \text{Ker}(\Psi) \to \text{Ker}(\overline{\Psi})
\to \text{Im}(\varphi) \to 0$. Hence by
Lemma \ref{lemma-extension-finite-type} we
see that $\text{Ker}(\overline{\Psi})$ has finite type.

\medskip\noindent
Statement (4) follows from (3).

\medskip\noindent
Let $0 \to \mathcal{F}_1 \to \mathcal{F}_2 \to \mathcal{F}_3 \to 0$
be a short exact sequence of $\mathcal{O}_X$-modules. It suffices
to prove that if $\mathcal{F}_1$ and $\mathcal{F}_3$ are coherent
so is $\mathcal{F}_2$. By Lemma \ref{lemma-extension-finite-type} we
see that $\mathcal{F}_2$ has finite type. Let
$s_1, \ldots, s_n$ be finitely many local
sections of $\mathcal{F}_2$ defined over a common open $U$ of $X$.
We have to show that the module of relations $\mathcal{K}$
between them is of finite type.
Consider the following commutative diagram
$$
\xymatrix{
0 \ar[r] &
0 \ar[r] \ar[d] &
\bigoplus_{i = 1}^{n} \mathcal{O}_U \ar[r] \ar[d] &
\bigoplus_{i = 1}^{n} \mathcal{O}_U \ar[r] \ar[d] &
0 \\
0 \ar[r] &
\mathcal{F}_1 \ar[r] &
\mathcal{F}_2 \ar[r] &
\mathcal{F}_3 \ar[r] &
0
}
$$
with obvious notation. By the snake lemma
we get a short exact sequence
$0 \mathcal{K} \to \mathcal{K}_3 \to \mathcal{F}_1$
where $\mathcal{K}_3$ is the module of relations among
the images of the sections $s_i$ in $\mathcal{F}_3$.
Since $\mathcal{F}_3$ is coherent we see that
$\mathcal{K}_3$ is finite type. Since $\mathcal{F}_1$
is coherent we see that the image $\mathcal{I}$
of $\mathcal{K}_3 \to \mathcal{F}_1$
is coherent. Hence $\mathcal{K}$
is the kernel of the map $\mathcal{K}_3 \to \mathcal{I}$
between a finite type sheaf and a coherent sheaves and hence
finite type by (2).
\end{proof}

















\section{Closed immersions of ringed spaces}
\label{section-closed-immersion}

\noindent
When do we declare a morphism of ringed spaces
$i : (Z, \mathcal{O}_Z) \to (X, \mathcal{O}_X)$
to be a closed immersion? It depends on what types of
sheaves of modules you want to consider.
For example, we saw in Section \ref{section-closed-immersions}
that if $i : Z \to X$ is the inclusion of a closed subspace
and $\mathcal{O}_Z = \underline{\mathbf{Z}}_Z$,
$\mathcal{O}_X = \underline{\mathbf{Z}}_X$ then we
obtain a good notion in the setting of abelian sheaves.

\medskip\noindent
On the other hand, if we want $i_*$ and $i^*$ to provide
an equivalence between (certain) categories of quasi-coherent
sheaves, then this doesn't work. Namely, typically the sheaf
$i_*\underline{\mathbf{Z}}_Z$ isn't a quasi-coherent
$\underline{\mathbf{Z}}_X$-module. This already happens
in case $X = \mathbf{R}$ and $Z$ is a point.

\medskip\noindent
A minimal condition is that $i_*\mathcal{O}_Z$ is a
quasi-coherent sheaf of $\mathcal{O}_X$-modules.
On the other hand, it seems reasonable to assume that
every local section of $i_*\mathcal{O}_Z$ comes (locally)
from a local section of $\mathcal{O}_X$, in other words
to assume that $\mathcal{O}_X \to i_*\mathcal{O}_Z$ is
surjective. In this case the kernel $\mathcal{I}$ is a
{\it sheaf of ideals of $\mathcal{O}_X$}, i.e., a submodule of $\mathcal{O}_X$.
And an easy way to garantee that $i_*\mathcal{O}_Z$ is a
quasi-coherent $\mathcal{O}_X$-module is to assume that
$\mathcal{I}$ is locally generated by sections. This leads to the following
(nonstandard) definition.

\begin{definition}
\label{definition-closed-immersion}
A {\it closed immersion of ringed spaces}\footnote{This is
likely nonstandard notation; we chose it because it works well
for schemes.} is a morphism
$i : (Z, \mathcal{O}_Z) \to (X, \mathcal{O}_X)$
with the following properties:
\begin{enumerate}
\item The map $i$ is a closed immersion of topological spaces.
\item The associated map $\mathcal{O}_X \to i_*\mathcal{O}_Z$
is surjective. Denote the kernel by $\mathcal{I}$.
\item The $\mathcal{O}_X$-module $\mathcal{I}$ is locally
generated by sections.
\end{enumerate}
\end{definition}

\noindent
Actually, this definition still does not garantee that
$i_*$ of a quasi-coherent $\mathcal{O}_Z$-module is a
quasi-coherent $\mathcal{O}_X$-module. The problem is that
it is not clear how to convert a local presentation of
a quasi-coherent $\mathcal{O}_Z$-module into a local
presentation for the pushforward. However, the following
is trivial.

\begin{lemma}
\label{lemma-i-star-quasi-coherent}
Let $i : (Z, \mathcal{O}_Z) \to (X, \mathcal{O}_X)$
be a closed immersion of locally ringed spaces.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_Z$-module.
Then $i_*\mathcal{F}$ is locally on $X$ the cokernel of
a map of quasi-coherent $\mathcal{O}_X$-modules.
\end{lemma}

\begin{proof}
This is true because $i_*\mathcal{O}_Z$ is quasi-coherent
by definition. And locally on $Z$ the sheaf $\mathcal{F}$
is a cokernel of a map between direct sums of copies
of $\mathcal{O}_Z$. Moreover, any direct sum of copies of the
{\it the same} quasi-coherent sheaf is quasi-coherent.
And finally, $i_*$ commutes with arbitrary colimits,
see Lemma \ref{lemma-i-star-right-adjoint}. Details left to the reader.
\end{proof}



















\section{Ringed topoi}
\label{section-ringed-topoi}

\begin{definition}
\label{definition-ringed-topos}
A {\it ringed topos} is a pair $(\textit{Sh}(\mathcal{C}), \mathcal{O})$
where $\mathcal{C}$ is a site and $\mathcal{O}$ is a sheaf of rings
on $\mathcal{C}$.
\end{definition}



\input{chapters}

\bibliography{my}
\bibliographystyle{alpha}

\end{document}
