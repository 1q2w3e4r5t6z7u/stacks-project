\input{preamble}

% OK, start here.
%
\begin{document}

\title{Sheaves on Algebraic Stacks}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
There is a myriad of ways to think about sheaves on algebraic stacks.
In this chapter we discuss one approach, which is particularly well
adapted to our foundations for algebraic stacks. Whenever we introduce
a type of sheaves we will indicate the precise relationship with
similar notions in the literature.
The goal of this chapter is to state those results
that are either obviously true or straightforward to prove
and leave more intricate constructions till later.

\medskip\noindent
In fact, it turns out that to develop a fully fledged theory of
constructible \'etale sheaves and/or an adequate discussion of
derived categories of complexes $\mathcal{O}$-modules whose
cohomology sheaves are quasi-coherent takes a significant amount of work, see
\cite{olsson_sheaves}. We will return to these issues later
(insert future reference here).

\medskip\noindent
In the literature and in research papers on sheaves on algebraic stacks
the lisse-\'etale site of an algebraic stack often plays a prominent role.
However, it is a problematic beast, because it turns out that a morphism of
algebraic stacks does not induce a morphism of lisse-\'etale topoi. We have
therefore made the design decision to avoid any mention of the lisse-\'etale
site as long as possible. Arguments that traditionally use the lisse-\'etale
site will be replaced by an argument using a {\v C}ech covering
in the site $\mathcal{X}_{smooth}$ defined below.


\section{Conventions}
\label{section-conventions}

\noindent
The conventions we use in this chapter are the same as those in the
chapter on algebraic stacks, see
Algebraic Stacks, Section \ref{algebraic-section-conventions}.
For convenience we repeat them here.

\medskip\noindent
We work in a suitable big fppf site $\textit{Sch}_{fppf}$ as in
Topologies, Definition \ref{topologies-definition-big-fppf-site}.
So, if not explicitly stated otherwise all schemes will be objects
of $\textit{Sch}_{fppf}$. We record what changes if you change the big
fppf site elsewhere (insert future reference here).

\medskip\noindent
We will always work relative to a base $S$ contained in $\textit{Sch}_{fppf}$.
And we will then work with the big fppf site $(\textit{Sch}/S)_{fppf}$, see
Topologies, Definition \ref{topologies-definition-big-small-fppf}.
The absolute case can be recovered by taking
$S = \text{Spec}(\mathbf{Z})$.





\section{Presheaves}
\label{section-presheaves}

\noindent
In this section we define presheaves on categories fibred in groupoids
over $(\textit{Sch}/S)_{fppf}$, but most of the discussion works
for categories over any base category. This section also serves to
introduce the notation we will use later on.

\begin{definition}
\label{definition-presheaves}
Let $p : \mathcal{X} \to (\textit{Sch}/S)_{fppf}$ be a category fibred in
groupoids.
\begin{enumerate}
\item A {\it presheaf on $\mathcal{X}$} is a presheaf on the
underlying category of $\mathcal{X}$.
\item A {\it morphism of presheaves on $\mathcal{X}$} is a morphism of
presheaves on the underlying category of $\mathcal{X}$.
\end{enumerate}
We denote $\textit{PSh}(\mathcal{X})$ the category of presheaves on
$\mathcal{X}$.
\end{definition}

\noindent
This defines presheaves of sets. Of course we can also talk about
presheaves of pointed sets, abelian groups, groups, monoids, rings,
modules over a fixed ring, and lie algebras over a fixed field, etc.
The category of {\it abelian presheaves}, i.e., presheaves of abelian
groups, is denoted $\textit{PAb}(\mathcal{X})$.

\medskip\noindent
Let $f : \mathcal{X} \to \mathcal{Y}$ be a $1$-morphism of categories
fibred in groupoids over $(\textit{Sch}/S)_{fppf}$. Recall that this
means just that $f$ is a functor over $(\textit{Sch}/S)_{fppf}$.
The material in
Sites, Section \ref{sites-section-more-functoriality-PSh}
provides us with a pair of adjoint functors\footnote{These functors
will be denoted $f^{-1}$ and $f_*$ after
Lemma \ref{lemma-functoriality-sheaves}
has been proved.}
\begin{equation}
\label{equation-pushforward-pullback}
f^p : \textit{PSh}(\mathcal{Y}) \longrightarrow \textit{PSh}(\mathcal{X})
\quad\text{and}\quad
{}_pf : \textit{PSh}(\mathcal{X}) \longrightarrow \textit{PSh}(\mathcal{Y}).
\end{equation}
The adjointness is
$$
\text{Mor}_{\textit{PSh}(\mathcal{X})}(f^p\mathcal{G}, \mathcal{F})
=
\text{Mor}_{\textit{PSh}(\mathcal{Y})}(\mathcal{G}, {}_pf\mathcal{F})
$$
where $\mathcal{F} \in \text{Ob}(\textit{PSh}(\mathcal{X}))$ and
$\mathcal{G} \in \text{Ob}(\textit{PSh}(\mathcal{Y}))$. We call
$f^p\mathcal{G}$ the {\it pullback} of $\mathcal{G}$. It follows
from the definitions that
$$
f^p\mathcal{G}(x) = \mathcal{G}(f(x))
$$
for any $x \in \text{Ob}(\mathcal{X})$. The presheaf ${}_pf\mathcal{F}$
is called the {\it pushforward} of $\mathcal{F}$. It is described
by the formula
$$
({}_pf\mathcal{F})(y) = \lim\nolimits_{f(x) \to y} \mathcal{F}(x).
$$
The rest of this section should be skipped.

\begin{lemma}
\label{lemma-1-morphisms-presheaves}
Let $f \mathcal{X} \to \mathcal{Y}$ and $g : \mathcal{Y} \to \mathcal{Z}$
be $1$-morphisms of categories fibred in groupoids over
$(\textit{Sch}/S)_{fppf}$. Then $(g \circ f)^p = f^p \circ g^p$ and
there is a canonical isomorphism
${}_p(g \circ f) \to {}_pg \circ {}_pf$
compatible with with adjointness of $(f^p, {}_pf)$, $(g^p, {}_pg)$, and
$((g \circ f)^p, {}_p(g \circ f))$.
\end{lemma}

\begin{proof}
Let $\mathcal{H}$ be a presheaf on $\mathcal{Z}$. Then
$(g \circ f)^p\mathcal{H} = f^p (g^p\mathcal{H})$ is given
by the equalities
$$
(g \circ f)^p\mathcal{H}(x) = \mathcal{H}((g \circ f)(x))
= \mathcal{H}(g(f(x))) = f^p (g^p\mathcal{H})(x).
$$
We omit the verification that this is compatible with restriction maps.

\medskip\noindent
Next, we define the transformation ${}_p(g \circ f) \to {}_pg \circ {}_pf$.
Let $\mathcal{F}$ be a presheaf on $\mathcal{X}$.
If $z$ is an object of $\mathcal{Z}$ then we get a
category $\mathcal{J}$ of quadruples
$(x, f(x) \to y, y, g(y) \to z)$ and a category $\mathcal{I}$
of pairs $(x, g(f(x)) \to z)$. There is a canonical functor
$\mathcal{J} \to \mathcal{I}$ sending the object
$(x, \alpha : f(x) \to y, y, \beta : g(y) \to z)$ to
$(x, \beta \circ f(\alpha) : g(f(x)) \to z)$. This gives the arrow in
\begin{align*}
({}_p(g \circ f)\mathcal{F})(z) & =
\lim\nolimits_{g(f(x)) \to z} \mathcal{F}(x) \\
& = \lim\nolimits_\mathcal{I} \mathcal{F} \\
& \longrightarrow \lim\nolimits_\mathcal{J} \mathcal{F} \\
& = \lim\nolimits_{g(y) \to z}
\Big(\lim\nolimits_{f(x) \to y} \mathcal{F}(x)\Big) \\
& =
({}_pg \circ {}_pf\mathcal{F})(x)
\end{align*}
by
Categories, Lemma \ref{categories-lemma-functorial-limit}.
We omit the verification that this is compatible with restriction maps.
An alternative to this direct construction is to define
${}_p(g \circ f) \cong {}_pg \circ {}_pf$
as the unique map compatible with the adjointness properties. This also
has the advantage that one does not need to prove the compatibility.

\medskip\noindent
Compatibility with adjointness of $(f^p, {}_pf)$, $(g^p, {}_pg)$, and
$((g \circ f)^p, {}_p(g \circ f))$ means that given presheaves
$\mathcal{H}$ and $\mathcal{F}$ as above we have a commutative diagram
$$
\xymatrix{
\text{Mor}_{\textit{PSh}(\mathcal{X})}(f^pg^p\mathcal{H}, \mathcal{F})
\ar@{=}[r] \ar@{=}[d] &
\text{Mor}_{\textit{PSh}(\mathcal{Y})}(g^p\mathcal{H}, {}_pf\mathcal{F})
\ar@{=}[r] &
\text{Mor}_{\textit{PSh}(\mathcal{Y})}(\mathcal{H}, {}_pg{}_pf\mathcal{F})
\\
\text{Mor}_{\textit{PSh}(\mathcal{X})}((g \circ f)^p\mathcal{G}, \mathcal{F})
\ar@{=}[rr] & &
\text{Mor}_{\textit{PSh}(\mathcal{Y})}(\mathcal{G}, {}_p(g \circ f)\mathcal{F})
\ar[u]
}
$$
Proof omitted.
\end{proof}

\begin{lemma}
\label{lemma-2-morphisms-presheaves}
Let $f, g : \mathcal{X} \to \mathcal{Y}$ be $1$-morphisms of categories
fibred in groupoids over $(\textit{Sch}/S)_{fppf}$. Let $t : f \to g$
be a $2$-morphism of categories fibred in groupoids over
$(\textit{Sch}/S)_{fppf}$. Assigned to $t$ there are canonical
isomorphisms of functors
$$
t^p : g^p \longrightarrow f^p
\quad\text{and}\quad
{}_pt : {}_pf \longrightarrow {}_pg
$$
which compatible with adjointness of $(f^p, {}_pf)$ and
$(g^p, {}_pg)$ and with
vertical and horizontal composition of $2$-morphisms.
\end{lemma}

\begin{proof}
Let $\mathcal{G}$ be a presheaf on $\mathcal{Y}$. Then
$t^p : g^p\mathcal{G} \to f^p\mathcal{G}$ is given by the family
of maps
$$
g^p\mathcal{G}(x) = \mathcal{G}(g(x))
\xrightarrow{\mathcal{G}(t_x)}
\mathcal{G}(f(x)) = f^p\mathcal{G}(x)
$$
parametrized by $x \in \text{Ob}(\mathcal{X})$. This makes sense as
$t_x : f(x) \to g(x)$ and $\mathcal{G}$ is a contravariant functor.
We omit the verification that this is compatible with restriction
mappings.

\medskip\noindent
To define the transformation ${}_pt$ for $y \in \text{Ob}(\mathcal{Y})$
define ${}_y^f\mathcal{I}$, resp.\ ${}_y^g\mathcal{I}$ to be the category
of pairs $(x, \psi : f(x) \to y)$, resp.\ $(x, \psi : g(x) \to y)$, see
Sites, Section \ref{sites-section-more-functoriality-PSh}.
Note that $t$ defines a functor
${}_yt : {}_y^g\mathcal{I} \to {}_y^f\mathcal{I}$
given by the rule
$$
(x, g(x) \to y) \longmapsto (x, f(x) \xrightarrow{t_x} g(x) \to y).
$$
Note that for $\mathcal{F}$ a presheaf on $\mathcal{X}$ the composition
of ${}_yt$ with $\mathcal{F} : {}_y^f\mathcal{I}^{opp} \to \textit{Sets}$,
$(x, f(x) \to y) \mapsto \mathcal{F}(x)$ is equal to
$\mathcal{F} : {}_y^g\mathcal{I}^{opp} \to \textit{Sets}$. Hence by
Categories, Lemma \ref{categories-lemma-functorial-limit}
we get for every $y \in \text{Ob}(\mathcal{Y})$ a canonical map
$$
({}_pf\mathcal{F})(y) = \lim\nolimits_{{}_y^f\mathcal{I}} \mathcal{F}
\longrightarrow
\lim\nolimits_{{}_y^g\mathcal{I}} \mathcal{F} = ({}_pg\mathcal{F})(y)
$$
We omit the verification that this is compatible with restriction
mappings. An alternative to this direct construction is to define
${}_pt$ as the unique map compatible with the adjointness properties
of the pairs $(f^p, {}_pf)$ and $(g^p, {}_pg)$ (see below). This also
has the advantage that one does not need to prove the compatibility.

\medskip\noindent
Compatibility with adjointness of $(f^p, {}_pf)$ and $(g^p, {}_pg)$ means
that given presheaves $\mathcal{G}$ and $\mathcal{F}$ as above we have
a commutative diagram
$$
\xymatrix{
\text{Mor}_{\textit{PSh}(\mathcal{X})}(f^p\mathcal{G}, \mathcal{F})
\ar@{=}[r] \ar[d]_{- \circ t^p} &
\text{Mor}_{\textit{PSh}(\mathcal{Y})}(\mathcal{G}, {}_pf\mathcal{F})
\ar[d]^{{}_pt \circ -} \\
\text{Mor}_{\textit{PSh}(\mathcal{X})}(g^p\mathcal{G}, \mathcal{F})
\ar@{=}[r] &
\text{Mor}_{\textit{PSh}(\mathcal{Y})}(\mathcal{G}, {}_pg\mathcal{F})
}
$$
Proof omitted. Hint: Work through the proof of
Sites, Lemma \ref{sites-lemma-adjoints-pu}
and observe the compatibility from the explicit description of the
horizontal and vertical maps in the diagram.

\medskip\noindent
We omit the verification that this is compatible with vertical and horizontal
compositions. Hint: The proof of this for $t^p$ is straightforward and
one can conclude that this holds for the ${}_pt$ maps using compatibility
with adjointness.
\end{proof}







\section{Sheaves}
\label{section-sheaves}

\noindent
We first make an observation that is important and trivial
(especially for those readers who do not worry about set theoretical
issues).

\medskip\noindent
Consider a big fppf site $\textit{Sch}_{fppf}$ as in
Topologies, Definition \ref{topologies-definition-big-fppf-site}
and denote its underlying category $\textit{Sch}_\alpha$.
Besides being the underlying category of a fppf site,
the category $\textit{Sch}_\alpha$ can also can serve as the underlying
category for a big Zariski site, a big \'etale site, a big smooth site,
and a big syntomic site, see
Topologies, Remark \ref{topologies-remark-choice-sites}.
We denote these sites $\textit{Sch}_{Zar}$, $\textit{Sch}_{\acute{e}tale}$,
$\textit{Sch}_{smooth}$, and $\textit{Sch}_{syntomic}$.
In this situation, since we have defined
the big Zariski site $(\textit{Sch}/S)_{Zar}$ of $S$,
the big \'etale site $(\textit{Sch}/S)_{\acute{e}tale}$ of $S$,
the big smooth site $(\textit{Sch}/S)_{smooth}$ of $S$,
the big syntomic site $(\textit{Sch}/S)_{syntomic}$ of $S$, and
the big fppf site $(\textit{Sch}/S)_{fppf}$ of $S$
as the localizations (see
Sites, Section \ref{sites-section-localize})
$\textit{Sch}_{Zar}/S$, $\textit{Sch}_{\acute{e}tale}/S$,
$\textit{Sch}_{smooth}/S$, $\textit{Sch}_{syntomic}/S$, and
$\textit{Sch}_{fppf}/S$
of these (absolute) big sites we see that all of these have the
{\bf same underlying category}, namely $\textit{Sch}_\alpha/S$.

\medskip\noindent
It follows that if we have a category
$p : \mathcal{X} \to (\textit{Sch}/S)_{fppf}$ fibred in groupoids, then
$\mathcal{X}$ inherits a Zariski, \'etale, smooth, syntomic, and
fppf topology, see
Stacks, Definition \ref{stacks-definition-topology-inherited}.

\begin{definition}
\label{definition-inherited-topologies}
Let $\mathcal{X}$ be a category fibred in groupoids over
$(\textit{Sch}/S)_{fppf}$.
\begin{enumerate}
\item The {\it associated Zariski site}, denoted $\mathcal{X}_{Zar}$,
is the structure of site on $\mathcal{X}$ inherited from
$(\textit{Sch}/S)_{Zar}$.
\item The {\it associated \'etale site}, denoted $\mathcal{X}_{\acute{e}tale}$,
is the structure of site on $\mathcal{X}$ inherited from
$(\textit{Sch}/S)_{\acute{e}tale}$.
\item The {\it associated smooth site}, denoted $\mathcal{X}_{smooth}$,
is the structure of site on $\mathcal{X}$ inherited from
$(\textit{Sch}/S)_{smooth}$.
\item The {\it associated syntomic site}, denoted $\mathcal{X}_{syntomic}$,
is the structure of site on $\mathcal{X}$ inherited from
$(\textit{Sch}/S)_{syntomic}$.
\item The {\it associated fppf site}, denoted $\mathcal{X}_{fppf}$,
is the structure of site on $\mathcal{X}$ inherited from
$(\textit{Sch}/S)_{fppf}$.
\end{enumerate}
\end{definition}

\noindent
This definition makes sense by the discussion above. If $\mathcal{X}$
is an algebraic stack, the literature calls $\mathcal{X}_{fppf}$ (or a
site equivalent to it) the {\it big fppf site} of $\mathcal{X}$ and similarly
for the other ones. We may occasionally use this terminology to
distinguish this construction from others.

\begin{remark}
\label{remark-ambiguity}
We only use this notation when the symbol $\mathcal{X}$ refers to a
category fibred in groupoids, and not a scheme, an algebraic space, etc.
In this way we will avoid confusion with the small \'etale site of a
scheme, or algebraic space which is denoted $X_{\acute{e}tale}$ (in which
case we use a roman capital instead of a calligraphic one).
\end{remark}

\noindent
Now that we have these topologies defined we can say what it means
to have a sheaf on $\mathcal{X}$, i.e., define the corresponding topoi.

\begin{definition}
\label{definition-sheaves}
Let $\mathcal{X}$ be a category fibred in groupoids over
$(\textit{Sch}/S)_{fppf}$. Let $\mathcal{F}$ be a presheaf on $\mathcal{X}$.
\begin{enumerate}
\item We say $\mathcal{F}$ is a {\it Zariski sheaf}, or a
{\it sheaf for the Zariski topology} if $\mathcal{F}$
is a sheaf on the associated Zariski site $\mathcal{X}_{Zar}$.
\item We say $\mathcal{F}$ is an {\it \'etale sheaf}, or a
{\it sheaf for the \'etale topology} if $\mathcal{F}$
is a sheaf on the associated \'etale site $\mathcal{X}_{\acute{e}tale}$.
\item We say $\mathcal{F}$ is a {\it smooth sheaf}, or a
{\it sheaf for the smooth topology} if $\mathcal{F}$
is a sheaf on the associated smooth site $\mathcal{X}_{smooth}$.
\item We say $\mathcal{F}$ is a {\it syntomic sheaf}, or a
{\it sheaf for the syntomic topology} if $\mathcal{F}$
is a sheaf on the associated syntomic site $\mathcal{X}_{syntomic}$.
\item We say $\mathcal{F}$ is an {\it fppf sheaf}, or a {\it sheaf},
or a {\it sheaf for the fppf topology} if $\mathcal{F}$
is a sheaf on the associated fppf site $\mathcal{X}_{fppf}$.
\end{enumerate}
A morphism of sheaves is just a morphism of presheaves. We denote
these categories of sheaves
$\textit{Sh}(\mathcal{X}_{Zar})$,
$\textit{Sh}(\mathcal{X}_{\acute{e}tale})$,
$\textit{Sh}(\mathcal{X}_{smooth})$,
$\textit{Sh}(\mathcal{X}_{syntomic})$, and
$\textit{Sh}(\mathcal{X}_{fppf})$.
\end{definition}

\noindent
Of course we can also talk about sheaves of pointed sets, abelian groups,
groups, monoids, rings, modules over a fixed ring, and lie algebras over
a fixed field, etc. The category of {\it abelian sheaves}, i.e., sheaves
of abelian groups, is denoted $\textit{Ab}(\mathcal{X}_{fppf})$
and similarly for the other topologies. If $\mathcal{X}$ is an algebraic
stack, then $\textit{Sh}(\mathcal{X}_{fppf})$ is equivalent (modulo
set theoretical problems) to what in the literature would be termed
the {\it category of sheaves on the big fppf site of $\mathcal{X}$}. Similar
for other topologies. We may occasionally use this terminology to
distinguish this construction from others.

\medskip\noindent
Since the topologies are listed in increasing order of strength we have
the following strictly full inclusions
$$
\textit{Sh}(\mathcal{X}_{fppf}) \subset
\textit{Sh}(\mathcal{X}_{syntomic}) \subset
\textit{Sh}(\mathcal{X}_{smooth}) \subset
\textit{Sh}(\mathcal{X}_{\acute{e}tale}) \subset
\textit{Sh}(\mathcal{X}_{Zar}) \subset \textit{PSh}(\mathcal{X})
$$
We sometimes write
$\textit{Sh}(\mathcal{X}_{fppf}) = \textit{Sh}(\mathcal{X})$
and
$\textit{Ab}(\mathcal{X}_{fppf}) = \textit{Ab}(\mathcal{X})$
in accordance with our terminology that a sheaf on $\mathcal{X}$
is an fppf sheaf on $\mathcal{X}$.

\medskip\noindent
With this setup functoriality of these topoi is straightforward, and
moreover, is compatible with the inclusion functors above.

\begin{lemma}
\label{lemma-functoriality-sheaves}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a $1$-morphism of categories
fibred in groupoids over $(\textit{Sch}/S)_{fppf}$. Let
$\tau \in \{Zar, \acute{e}tale, smooth, syntomic, fppf\}$.
The functors ${}_pf$ and $f^p$ of (\ref{equation-pushforward-pullback})
transform $\tau$ sheaves into $\tau$ sheaves and define a morphism
of topoi
$f : \textit{Sh}(\mathcal{X}_\tau) \to \textit{Sh}(\mathcal{Y}_\tau)$.
\end{lemma}

\begin{proof}
This follows immediately from
Stacks, Lemma \ref{stacks-lemma-topology-inherited-functorial}.
\end{proof}

\noindent
In other words, pushforward and pullback of presheaves as defined in
Section \ref{section-presheaves}
also produces {\it pushforward} and {\it pullback} of $\tau$-sheaves.
Having said all of the above we see that we can write $f^p = f^{-1}$
and ${}_pf = f_*$ without any possibility of confusion.

\begin{definition}
\label{definition-morphism}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of categories
fibred in groupoids over $(\textit{Sch}/S)_{fppf}$. We denote
$$
f = (f^{-1}, f_*) :
\textit{Sh}(\mathcal{X}_{fppf})
\longrightarrow
\textit{Sh}(\mathcal{Y}_{fppf})
$$
the {\it associated morphism of fppf topoi} constructed above.
Similarly for the associated Zariski, \'etale, smooth, and syntomic topoi.
\end{definition}

\noindent
As discussed in
Sites, Section \ref{sites-section-sheaves-algebraic-structures}
the same formula (on the underlying sheaf of sets) defines
pushforward and pullback for sheaves (for one of our topologies)
of pointed sets, abelian groups, groups, monoids, rings, modules
over a fixed ring, and lie algebras over a fixed field, etc.




\section{The structure sheaf}
\label{section-structure-sheaf}

\noindent
Let $\tau \in \{Zar, \acute{e}tale, smooth, syntomic, fppf\}$.
Let $p : \mathcal{X} \to (\textit{Sch}/S)_{fppf}$ be a category
fibred in groupoids. The 2-category of categories fibred in groupoids over
$(\textit{Sch}/S)_{fppf}$ has a final object, namely,
$\text{id} : (\textit{Sch}/S)_{fppf} \to (\textit{Sch}/S)_{fppf}$
and $p$ is a $1$-morphism from $\mathcal{X}$ to this final object.
Hence any presheaf $\mathcal{G}$ on $(\textit{Sch}/S)_{fppf}$ gives a
presheaf $p^{-1}\mathcal{G}$ on $\mathcal{X}$ defined by the rule
$p^{-1}\mathcal{G}(x) = \mathcal{G}(p(x))$. Moreover, the discussion in
Section \ref{section-sheaves}
shows that $p^{-1}\mathcal{G}$ is a $\tau$ sheaf whenever
$\mathcal{G}$ is a $\tau$-sheaf.

\medskip\noindent
Recall that the site $(\textit{Sch}/S)_{fppf}$ is a ringed site
with structure sheaf $\mathcal{O}$ defined by the rule
$$
(\textit{Sch}/S)^{opp} \longrightarrow \textit{Rings},
\quad
U/S \longmapsto \Gamma(U, \mathcal{O}_U)
$$
see
Descent, Definition \ref{descent-definition-structure-sheaf}.

\begin{definition}
\label{definition-structure-sheaf}
Let $p : \mathcal{X} \to (\textit{Sch}/S)_{fppf}$ be a category
fibred in groupoids. The
{\it structure sheaf of $\mathcal{X}$} is the sheaf of rings
$\mathcal{O}_\mathcal{X} = p^{-1}\mathcal{O}$.
\end{definition}

\noindent
Needless to say $\mathcal{O}_\mathcal{X}$ is also a Zariski, \'etale,
smooth, and syntomic sheaf, and hence each of the sites
$\mathcal{X}_{Zar}$, $\mathcal{X}_{\acute{e}tale}$, $\mathcal{X}_{smooth}$,
$\mathcal{X}_{syntomic}$, and $\mathcal{X}_{fppf}$ is a ringed site.
This construction is functorial as well.

\begin{lemma}
\label{lemma-functoriality-structure-sheaf}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a $1$-morphism of categories
fibred in groupoids over $(\textit{Sch}/S)_{fppf}$. Let
$\tau \in \{Zar, \acute{e}tale, smooth, syntomic, fppf\}$.
There is a canonical identification
$f^{-1}\mathcal{O}_\mathcal{X} = \mathcal{O}_\mathcal{Y}$
which turns
$f : \textit{Sh}(\mathcal{X}_\tau) \to \textit{Sh}(\mathcal{Y}_\tau)$
into a morphism of ringed topoi.
\end{lemma}

\begin{proof}
Denote $p : \mathcal{X} \to (\textit{Sch}/S)_{fppf}$ and
$q : \mathcal{Y} \to (\textit{Sch}/S)_{fppf}$ the structural functors.
Then $q = p \circ f$, hence $q^{-1} = f^{-1} \circ p^{-1}$ by
Lemma \ref{lemma-1-morphisms-presheaves}.
The result follows.
\end{proof}

\begin{remark}
\label{remark-flat}
In the situation of
Lemma \ref{lemma-functoriality-structure-sheaf}
the morphism of ringed topoi
$f : \textit{Sh}(\mathcal{X}_\tau) \to \textit{Sh}(\mathcal{Y}_\tau)$
is flat as is clear from the equality
$f^{-1}\mathcal{O}_\mathcal{X} = \mathcal{O}_\mathcal{Y}$.
This is a bit counter intuitive, for example because a closed
immersion of algebraic stacks is typically not flat.
However, exactly the same thing happens when taking a closed
immersion $i : X \to Y$ of schemes: in this case the associated
morphism of big $\tau$-sites
$i : (\textit{Sch}/X)_\tau \to (\textit{Sch}/Y)_\tau$
also is flat.
\end{remark}










\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
