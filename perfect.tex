\input{preamble}

% OK, start here.
%
\begin{document}

\title{Derived Categories of Schemes}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we discuss derived categories of modules on schemes.
Most of the material discussed here can be found in
\cite{TT}, \cite{Bokstedt-Neeman}, \cite{BvdB}, and \cite{LN}.
Of course there are many other references.


\section{Conventions}
\label{section-conventions}

\noindent
If $\mathcal{A}$ is an abelian category and $M$ is an object
of $\mathcal{A}$ then we also denote $M$ the object of $K(\mathcal{A})$
and/or $D(\mathcal{A})$ corresponding to the complex which has
$M$ in degree $0$ and is zero in all other degrees.

\medskip\noindent
If we have a ring $A$, then $K(A)$ denotes the homotopy category
of complexes of $A$-modules and $D(A)$ the associated derived category.
Similarly, if we have a ringed space $(X, \mathcal{O}_X)$ the symbol
$K(\mathcal{O}_X)$ denotes the homotopy category of complexes of
$\mathcal{O}_X$-modules and $D(\mathcal{O}_X)$ the associated derived
category.



\section{Koszul complexes}
\label{section-koszul}

\noindent
Let $A$ be a ring and let $f_1, \ldots, f_r$ be a sequence of elements
of $A$. We have defined the Koszul complex
$K_\bullet(f_1, \ldots, f_r)$ in
More on Algebra, Definition \ref{more-algebra-definition-koszul-complex}.
It is a chain complex sitting in degrees $r, \ldots, 0$.
We define a chain complex $C_\bullet(f_1, \ldots, f_r)$
such that we have a distinguished triangle
$$
C_\bullet(f_1, \ldots, f_r) \to
A \to
K_\bullet(f_1, \ldots, f_r) \to
C_\bullet(f_1, \ldots, f_r)[-1]
$$
in $K(A)$ (the shift is $-1$ as we are doing chain complexes).
In other words, we set
$$
C_i(f_1, \ldots, f_r) =
\left\{
\begin{matrix}
K_{i + 1}(f_1, \ldots, f_r) & \text{if } i \geq 0 \\
0 & \text{else}
\end{matrix}
\right.
$$
and we use the negative of the differential on $K_\bullet(f_1, \ldots, f_r)$.
The maps in the distinguished triangle are the obvious ones. Note that
$C_0(f_1, \ldots, f_r) = A^{\oplus r} \to A$ is given by
multiplication by $f_i$ on the $i$th factor.
Hence $C_\bullet(f_1, \ldots, f_r) \to A$ factors as
$$
C_\bullet(f_1, \ldots, f_r) \to I \to A
$$
where $I = (f_1, \ldots, f_r)$. In fact, there is a short exact sequence
$$
0 \to H_1(K_\bullet(f_1, \ldots, f_s)) \to
H_0(C_\bullet(f_1, \ldots, f_s)) \to I \to 0
$$
and for every $i > 0$ we have
$H_i(K_\bullet(f_1, \ldots, f_r) = H_{i + 1}(C_\bullet(f_1, \ldots, f_r))$.
Observe that given a second sequence $g_1, \ldots, g_r$ of elements of $A$
there are canonical maps
$$
C_\bullet(f_1g_1, \ldots, f_rg_r) \to C_\bullet(f_1, \ldots, f_r)
\quad\text{and}\quad
K_\bullet(f_1g_1, \ldots, f_rg_r) \to K_\bullet(f_1, \ldots, f_r)
$$
compatible with the maps described above. The first of these maps is
given by multiplcation by $g_i$ on the $i$th summand of
$C_0(f_1g_1, \ldots, f_rg_r) = A^{\oplus r}$. In particular, given
$f_1, \ldots, f_r$ we obtain an inverse system of complexes
\begin{equation}
\label{equation-system}
C_\bullet(f_1, \ldots, f_r) \leftarrow
C_\bullet(f_1^2, \ldots, f_r^2) \leftarrow
C_\bullet(f_1^3, \ldots, f_r^3) \leftarrow \ldots
\end{equation}
which will play an important role in that which is to follow.
To easily formulate the following lemmas we fix some notation.

\begin{situation}
\label{situation-complex}
Here $A$ is a ring and $f_1, \ldots, f_r$ is a sequence of elements of $A$.
We set $X = \Spec(A)$ and $U = D(f_1) \cup \ldots \cup D(f_r) \subset X$.
We denote $\mathcal{U} : U = \bigcup_{i = 1, \ldots, r} D(f_i)$ the
given open covering of $U$.
\end{situation}

\noindent
Our first lemma is that the complexes above can be used to compute
the cohomology of quasi-coherent sheaves on $U$. Suppose given a chain
complex $C_\bullet$ of $A$-modules and an $A$-module $M$. Then we
define $\Hom_A(C_\bullet, M)$ to be the cochain complex with $n$th
term $\Hom_A(C_n, M)$ and differentials given as the contragredients
of the differentials on $C_\bullet$.

\begin{lemma}
\label{lemma-alternating-cech-complex}
In Situation \ref{situation-complex}. Let $M$ be an $A$-module and
denote $\mathcal{F}$ the associated $\mathcal{O}_X$-module. Then
there is a canonical isomorphism of complexes
$$
\colim_e \Hom_A(C_\bullet(f_1^e, \ldots, f_r^e), M)
\longrightarrow
\check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F})
$$
functorial in $M$.
\end{lemma}

\begin{proof}
Recall that the alternating {\v C}ech complex is the subcomplex
of the usual {\v C}ech complex given by alternating cochains, see
Cohomology, Section \ref{cohomology-section-alternating-cech}.
As usual we view a $p$-cochain in
$\check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F})$
as an alternating function $s$ on $\{1, \ldots, r\}^{p + 1}$
whose value $s_{i_0\ldots i_p}$ at $(i_0, \ldots, i_p)$ lies in
$M_{f_{i_0}\ldots f_{i_p}} = \mathcal{F}(U_{i_0\ldots i_p})$.
On the other hand, a $p$-cochain $t$ in
$\Hom_A(C_\bullet(f_1^e, \ldots, f_r^e), M)$
is given by a map $t : \wedge^{p + 1}(A^{\oplus r}) \to M$.
Write $[i] \in A^{\oplus r}$ for the $i$th basis element and
write
$$
[i_0, \ldots, i_p] = [i_0] \wedge \ldots \wedge [i_p]
\in \wedge^{p + 1}(A^{\oplus r})
$$
Then we send $t$ as above to $s$ with
$$
s_{i_0\ldots i_p} = \frac{t([i_0, \ldots, i_p])}{f_{i_0}^e\ldots f_{i_p}^e}
$$
It is clear that $s$ so defined is an alternating cochain.
The construction of this map is compatible with the transition maps
of the system as the transition map
$$
C_\bullet(f_1^e, \ldots, f_r^e) \leftarrow
C_\bullet(f_1^{e + 1}, \ldots, f_r^{e + 1}),
$$
of the (\ref{equation-system}) sends $[i_0, \ldots, i_p]$
to $f_{i_0}\ldots f_{i_p}[i_0, \ldots, i_p]$.
It is clear from the description of the localizations
$M_{f_{i_0}\ldots f_{i_p}}$ in
Algebra, Lemma \ref{algebra-lemma-localization-colimit}
that these maps define an isomorphism of cochain modules in degree $p$
in the limit. To finish the proof we have to show that the map
is compatible with differentials. To see this recall that
\begin{align*}
d(s)_{i_0\ldots i_{p + 1}}
& =
\sum\nolimits_{j = 0}^{p + 1} (-1)^j
s_{i_0\ldots \hat i_j \ldots i_p} \\
& = 
\sum\nolimits_{j = 0}^{p + 1} (-1)^j
\frac{t([i_0, \ldots, \hat i_j, \ldots i_{p + 1}])}
{f_{i_0}^e\ldots \hat f_{i_j}^e \ldots f_{i_{p + 1}}^e}
\end{align*}
On the other hand, we have
\begin{align*}
\frac{d(t)([i_0, \ldots, i_{p + 1}])}{f_{i_0}^e\ldots f_{i_{p + 1}}^e}
& =
\frac{t(d[i_0, \ldots, i_{p + 1}])}{f_{i_0}^e\ldots f_{i_{p + 1}}^e} \\
& =
\frac{\sum_j (-1)^j f_{i_j}^e t([i_0, \ldots, \hat i_j, \ldots i_{p + 1}])}
{f_{i_0}^e \ldots f_{i_{p + 1}}^e}
\end{align*}
The two formulas agree by inspection.
\end{proof}

\medskip\noindent
Suppose given a chain complex $C_\bullet$ of $A$-modules and a
cochain complex of $A$-modules $M^\bullet$. We obtain a double complex
$H^{\bullet, \bullet} = \Hom_A(C_\bullet, M^\bullet)$ where
$H^{p, q} = \Hom_A(C_p, M^q)$. The first differential comes from
the differential on $\Hom_A(C_\bullet, M^q)$ and the second
from the differential on $M^\bullet$. Associated to this double
complex is the total complex with degree $n$ term given by
$$
\bigoplus\nolimits_{p + q = n} \Hom_A(C_p, M^q)
$$
and differential as in
Homology, Definition \ref{homology-definition-associated-simple-complex}.
Below our chain complexes will have finitely many terms.
The conventions for taking the total complex associated to a
{\v C}ech complex of a complex are as in
Cohomology, Section \ref{cohomology-section-cech-cohomology-of-complexes}.

\begin{lemma}
\label{lemma-alternating-cech-complex-complex}
In Situation \ref{situation-complex}. Let $M^\bullet$ be a cochain
complex of $A$-modules and
denote $\mathcal{F}^\bullet$ the associated complex of
$\mathcal{O}_X$-modules. Then
there is a canonical isomorphism of complexes
$$
\colim_e \text{Tot}(\Hom_A(C_\bullet(f_1^e, \ldots, f_r^e), M^\bullet))
\longrightarrow
\text{Tot}(\check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F}^\bullet))
$$
functorial in $M^\bullet$.
\end{lemma}

\begin{proof}
Immediate from Lemma \ref{lemma-alternating-cech-complex}.
\end{proof}











\section{Derived category of quasi-coherent modules}
\label{section-derived-quasi-coherent}

\noindent
In this section we briefly discuss the relationship between quasi-coherent
modules and all modules on a scheme $S$. (This should be elaborated
on and generalized.) A reference is
\cite[Appendix B]{TT}. By the discussion in
Schemes, Section \ref{schemes-section-quasi-coherent}
the embedding
$\textit{QCoh}(\mathcal{O}_S) \subset \textit{Mod}(\mathcal{O}_S)$
exhibits $\textit{QCoh}(\mathcal{O}_S)$ as a weak Serre subcategory of
the category of $\mathcal{O}_S$-modules. Denote
$D_{\textit{QCoh}}(\mathcal{O}_S) \subset D(\mathcal{O}_S)$ the
subcategory of complexes whose cohomology sheaves are quasi-coherent, see
Derived Categories, Section \ref{derived-section-triangulated-sub}.
Thus we obtain a canonical
functor
\begin{equation}
\label{equation-compare}
D(\textit{QCoh}(\mathcal{O}_S))
\longrightarrow
D_{\textit{QCoh}}(\mathcal{O}_S)
\end{equation}
see
Derived Categories, Equation (\ref{derived-equation-compare}).

\begin{lemma}
\label{lemma-affine-compare-bounded}
If $S = \Spec(A)$ is an affine scheme, then
(\ref{equation-compare}) is an equivalence.
\end{lemma}

\begin{proof}
The key to this lemma is to prove that the functor $R\Gamma(S, -)$ gives a
quasi-inverse. For complexes bounded below this is straightforward
using the vanishing of cohomology of
Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherent-affine-cohomology-zero}.
To prove it also for unbounded complexes we have to be a little bit
careful: namely, even if you accept that the unbounded derived functor
$R\Gamma(S, -)$ exists, then it isn't obvious how to compute it!

\medskip\noindent
Let $\mathcal{F}^\bullet$ be an object of $D_{\textit{QCoh}}(\mathcal{O}_S))$
and denote $\mathcal{H}^i = H^i(\mathcal{F}^\bullet)$ its $i$th cohomology
sheaf. Let $\mathcal{B}$ be the set of affine open subsets of $S$. Then
$H^p(U, \mathcal{H}^i) = 0$ for all $p > 0$, all $i \in \mathbf{Z}$,
and all $U \in \mathcal{B}$, see
Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherent-affine-cohomology-zero}.
According to
Cohomology, Section \ref{cohomology-section-K-injective}
this implies there exists a quasi-isomorphism
$\mathcal{F}^\bullet \to \mathcal{I}^\bullet$ where
$\mathcal{I}^\bullet$ is a K-injective complex,
$\mathcal{I}^\bullet = \lim \mathcal{I}_n^\bullet$,
each $\mathcal{I}_n^\bullet$ is a bounded below complex of injectives,
the maps in the system
$\ldots \to \mathcal{I}_2^\bullet \to \mathcal{I}_1^\bullet$
are termwise split surjections, and
each $\mathcal{I}_n^\bullet$ is quasi-isomorphic to
$\tau_{\geq -n}\mathcal{F}^\bullet$.
In particular, we conclude that $R\Gamma(S, -)$ is defined at
each object of $D_{\textit{QCoh}}(\mathcal{O}_S))$, see
Derived Categories, Lemma \ref{derived-lemma-K-injective-defined},
with values
$R\Gamma(S, \mathcal{F}^\bullet) = \Gamma(S, \mathcal{I}^\bullet)$.
This defines an exact functor of triangulated categories
\begin{equation}
\label{equation-back}
R\Gamma(S, -) : D_{\textit{QCoh}}(\mathcal{O}_S) \longrightarrow D(A),
\end{equation}
see
Derived Categories, Proposition \ref{derived-proposition-derived-functor}.
In the proof of
Cohomology, Lemma \ref{cohomology-lemma-K-injective}
we have seen that $H^m(\Gamma(S, \mathcal{I}^\bullet))$ is
the limit of the cohomology groups $H^m(\Gamma(S, \mathcal{I}_n^\bullet))$.
For $n > -m$ these groups are equal to $\Gamma(S, \mathcal{H}^m)$
by the vanishing of higer cohomology and the spectral sequence of
Derived Categories, Lemma \ref{derived-lemma-two-ss-complex-functor}.
Combined with the (assumed) equality
$$
\mathcal{H}^m = \widetilde{\Gamma(S, \mathcal{H}^m)}
$$
we conclude the canonical map of complexes
$$
\widetilde{\Gamma(S, \mathcal{I}^\bullet)} \longrightarrow \mathcal{I}^\bullet
$$
(see
Schemes, Lemma \ref{schemes-lemma-compare-constructions})
is a quasi-isomorphism. We claim the composition
$$
D(A) \cong D(\textit{QCoh}(\mathcal{O}_S))
\longrightarrow
D_{\textit{QCoh}}(\mathcal{O}_S)
\longrightarrow
D(A)
$$
is isomorphic to the identity functor. Namely, given a complex of $A$-modules
$M^\bullet$, let $\mathcal{F}^\bullet = \widetilde{M^\bullet}$, choose
$\mathcal{F}^\bullet \to \mathcal{I}^\bullet$ as above, and finally
take $\Gamma(S, \mathcal{I}^\bullet)$. The arguments above show that
$M^\bullet = \Gamma(S, \mathcal{F}^\bullet) \to \Gamma(S, \mathcal{I}^\bullet)$
is a quasi-isomorphism. This is functorial in $M^\bullet$, hence
we conclude that the composition of functors is isomorphic to
the identity functor on $D(A)$. On the other hand, we have seen above that
the composition
$$
D_{\textit{QCoh}}(\mathcal{O}_S)
\longrightarrow
D(A) \cong D(\textit{QCoh}(\mathcal{O}_S))
\longrightarrow
D_{\textit{QCoh}}(\mathcal{O}_S)
$$
is isomorphic to the identity functor, via the quasi-isomorphisms
$\widetilde{\Gamma(S, \mathcal{I}^\bullet)} \to \mathcal{I}^\bullet$
above. This finishes the proof.
\end{proof}

\noindent
Actually it is true that the comparison map
$D(\textit{QCoh}(\mathcal{O}_S)) \to D_{\textit{QCoh}}(\mathcal{O}_S)$
is an equivalence for any quasi-compact and (semi-)separated scheme
(insert future reference here).













\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}

