\input{preamble}

% OK, start here.
%
\begin{document}

\title{Derived Categories of Schemes}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we discuss derived categories of modules on schemes.
Most of the material discussed here can be found in
\cite{TT}, \cite{Bokstedt-Neeman}, \cite{BvdB}, and \cite{LN}.
Of course there are many other references.


\section{Conventions}
\label{section-conventions}

\noindent
If $\mathcal{A}$ is an abelian category and $M$ is an object
of $\mathcal{A}$ then we also denote $M$ the object of $K(\mathcal{A})$
and/or $D(\mathcal{A})$ corresponding to the complex which has
$M$ in degree $0$ and is zero in all other degrees.

\medskip\noindent
If we have a ring $A$, then $K(A)$ denotes the homotopy category
of complexes of $A$-modules and $D(A)$ the associated derived category.
Similarly, if we have a ringed space $(X, \mathcal{O}_X)$ the symbol
$K(\mathcal{O}_X)$ denotes the homotopy category of complexes of
$\mathcal{O}_X$-modules and $D(\mathcal{O}_X)$ the associated derived
category.










\section{Derived category of quasi-coherent modules}
\label{section-derived-quasi-coherent}

\noindent
In this section we discuss the relationship between quasi-coherent
modules and all modules on a scheme $X$. A reference is
\cite[Appendix B]{TT}. By the discussion in
Schemes, Section \ref{schemes-section-quasi-coherent}
the embedding
$\textit{QCoh}(\mathcal{O}_X) \subset \textit{Mod}(\mathcal{O}_X)$
exhibits $\textit{QCoh}(\mathcal{O}_X)$ as a weak Serre subcategory of
the category of $\mathcal{O}_X$-modules. Denote
$$
D_{\textit{QCoh}}(\mathcal{O}_X) \subset D(\mathcal{O}_X)
$$
the subcategory of complexes whose cohomology sheaves are quasi-coherent, see
Derived Categories, Section \ref{derived-section-triangulated-sub}.
Thus we obtain a canonical functor
\begin{equation}
\label{equation-compare}
D(\textit{QCoh}(\mathcal{O}_X))
\longrightarrow
D_{\textit{QCoh}}(\mathcal{O}_X)
\end{equation}
see Derived Categories, Equation (\ref{derived-equation-compare}).
The following lemma will help us to ``compute'' a right derived functor
on an object of $D_{\textit{QCoh}}(\mathcal{O}_X)$.

\begin{lemma}
\label{lemma-nice-K-injective}
Let $X$ be a scheme. Let $E$ be an object of
$D_{\textit{QCoh}}(\mathcal{O}_X)$. Then there exists an inverse
system $\mathcal{I}_n^\bullet$ of complexes of $\mathcal{O}_X$-modules
such that
\begin{enumerate}
\item $\mathcal{I} = \lim_n \mathcal{I}_n^\bullet$ represents $E$,
\item $\mathcal{I}_n^\bullet$ is a bounded below complex of injectives,
\item $\tau_{\geq -n}E \to \mathcal{I}_n^\bullet$ is an isomorphism
in $D(\mathcal{O}_X)$,
\item the transition maps
$\mathcal{I}_{n + 1}^\bullet \to \mathcal{I}_n^\bullet$
are termwise split surjections, and
\item $\mathcal{I}^\bullet$ is a K-injective complex of
$\mathcal{O}_X$-modules.
\end{enumerate}
\end{lemma}

\begin{proof}
Denote $\mathcal{H}^i = H^i(E)$ the $i$th cohomology sheaf of $E$.
Let $\mathcal{B}$ be the set of affine open subsets of $X$. Then
$H^p(U, \mathcal{H}^i) = 0$ for all $p > 0$, all $i \in \mathbf{Z}$,
and all $U \in \mathcal{B}$, see
Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherent-affine-cohomology-zero}.
Thus the lemma follows from an application of
Cohomology, Lemma \ref{cohomology-lemma-K-injective}.
\end{proof}

\begin{lemma}
\label{lemma-application-nice-K-injective}
Let $X$ be a scheme. Let $F : \textit{Mod}(\mathcal{O}_X) \to \textit{Ab}$
be a functor and $N \geq 0$ an integer. Assume that
\begin{enumerate}
\item $F$ is left exact,
\item $F$ commutes with countable direct products,
\item $R^pF(\mathcal{F}) = 0$ for all $p \geq N$ and $\mathcal{F}$
quasi-coherent.
\end{enumerate}
Then for $E \in D_{\textit{QCoh}}(\mathcal{O}_X)$ the maps
$R^pF(E) \to R^pF(\tau_{\geq p - N + 1}E)$ are isomorphisms.
\end{lemma}

\begin{proof}
Let $E$ be an object of $D_{\textit{QCoh}}(\mathcal{O}_X)$.
By shifting the complex we see it suffices to prove the assertion
for $p = 0$. Choose $\mathcal{I}^\bullet = \lim \mathcal{I}_n^\bullet$
as in Lemma \ref{lemma-nice-K-injective}.
As $\mathcal{I}^\bullet$ is K-injective $RF(E)$ is represented by
$F(\mathcal{I}^\bullet)$. As $F$ commutes with countable direct
products, and since the maps $\mathcal{I}_n^m \to \mathcal{I}_{n - 1}^m$
are split surjections, we get
$F(\mathcal{I}^\bullet) = \lim F(\mathcal{I}_n^\bullet)$.
The comohomology of
$$
F(\mathcal{I}_n^{-2}) \to
F(\mathcal{I}_n^{-1}) \to
F(\mathcal{I}_n^0) \to
F(\mathcal{I}_n^1)
$$
in degree $0$, resp.\ $-1$ is equal to $R^0F(\tau_{\geq -n}E)$,
resp.\ $R^{-1}F(\tau_{\geq -n}E)$ because $\mathcal{I}_n^\bullet$
is a bounded below complex of injectives representing $\tau_{\geq -n}E$.
We have a distinguished triangle
$$
H^{-n}(E)[n] \to \tau_{\geq -n}E \to \tau_{\geq - n + 1}E \to H^{-n}(E)[n + 1]
$$
in $D(\mathcal{O}_X)$. Since $H^{-n}(E)$ is quasi-coherent we have
$$
R^pF(H^{-n}(E)[n]) = R^{p + n}F(H^{-n}(E)) = 0
$$
for $p + n \geq N$ and
$$
R^pF(H^{-n}(E)[n + 1]) = R^{p + n + 1}F(H^{-n}(E)) = 0
$$
for $p + n + 1 \geq N$. We conclude that
$$
R^pF(\tau_{\geq -n}E) \to R^pF(\tau_{\geq - n + 1}E)
$$
is an isomorphism for all $n \gg p$ and an isomorphism for
$n \geq N$ for $p = 0$. Thus
Homology, Lemma \ref{homology-lemma-apply-Mittag-Leffler-again}
applies and we conclude that $R^0F(E) = \lim R^0F(\tau_{\geq - n}E)$.
By the above the system $R^0F(\tau_{\geq - n}E)$ is constant starting
with $n = N - 1$ as desired.
\end{proof}

\noindent
The following lemma is the analogue of
Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherence-higher-direct-images}.

\begin{lemma}
\label{lemma-quasi-coherence-direct-image}
Let $f : X \to S$ be a morphism of schemes.
Assume that $f$ is quasi-separated and quasi-compact.
\begin{enumerate}
\item The functor $Rf_*$ sends $D_{\textit{QCoh}}(\mathcal{O}_X)$
into $D_{\textit{QCoh}}(\mathcal{O}_S)$.
\item If $S$ is quasi-compact, there exists an integer $N = N(X, S, f)$
such that for an object $E$ of $D_{\textit{QCoh}}(\mathcal{O}_X)$
with $H^m(E) = 0$ for $m > 0$ we have
$H^m(Rf_*E) = 0$ for $m > N$.
\item In fact, if $S$ is quasi-compact we can find $N = N(X, S, f)$
such that for every morphism of schemes $S' \to S$
the same conclusion holds for the functor $R(f')_*$
where $f' : X' \to S'$ is the base change of $f$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $E$ be an object of $D_{\textit{QCoh}}(\mathcal{O}_X)$.
To prove (1) we have to show that $Rf_*E$ has quasi-coherent
cohomology sheaves. This question is local on $S$, hence we may
assume $S$ is quasi-compact. Pick $N = N(X, S, f)$ as in
Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherence-higher-direct-images}.
Thus $R^pf_*\mathcal{F} = 0$ for all quasi-coherent $\mathcal{O}_X$-modules
$\mathcal{F}$ and all $p \geq N$. In particular, for any affine
open $U \subset S$ we have $H^p(f^{-1}(U), \mathcal{F}) = 0$
for $p \geq N$, see
Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherence-higher-direct-images-application}.

\medskip\noindent
Let $E$ be an object of $D_{\textit{QCoh}}(\mathcal{O}_X)$.
Choose $\mathcal{I}^\bullet = \lim \mathcal{I}_n^\bullet$
as in Lemma \ref{lemma-nice-K-injective}.
As $\mathcal{I}^\bullet$ is K-injective $Rf_*E$ is represented by
$f_*\mathcal{I}^\bullet = \lim f_*\mathcal{I}_n^\bullet$.
Let $U \subset S$ be any affine open. The cohomology
$H^m(f_*\mathcal{I}_n^\bullet(U))$ of
$$
f_*\mathcal{I}_n^{m - 1}(U) \to
f_*\mathcal{I}_n^m(U) \to
f_*\mathcal{I}_n^{m + 1}(U)
$$
is equal to $H^m(f^{-1}(U), \tau_{\geq -n}E)$ because $\mathcal{I}_n^\bullet$
is a bounded below complex of injectives representing $\tau_{\geq -n}E$.
We have a distinguished triangle
$$
H^{-n}(E)[n] \to \tau_{\geq -n}E \to \tau_{\geq - n + 1}E \to H^{-n}(E)[n + 1]
$$
in $D(\mathcal{O}_X)$. Since $H^{-n}(E)$ is quasi-coherent we have
$H^m(f^{-1}(U), H^{-n}(E)[n]) = 0$ for $n + m \geq N$ by
our choice of $N$. Similarly, $H^m(f^{-1}(U), H^{-n}(E)[n + 1]) = 0$
for $n + m + 1 \geq N$. We conclude that
$$
H^m(f_*\mathcal{I}_n^\bullet(U)) \to H^m(f_*\mathcal{I}_{n - 1}^\bullet(U))
$$
is an isomorphism for all $n \geq N - m$. Thus
Cohomology, Lemma \ref{cohomology-lemma-inverse-limit-complexes}
applies to show that the $m$th cohomology sheaf of
$\lim f_*\mathcal{I}_n^\bullet$ agrees with the $m$th cohomology
sheaf of $f_*\mathcal{I}_n^\bullet$ for $n \geq N - m$. Since these
cohomology sheaves are quasi-coherent by
Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherence-higher-direct-images}
we get (1).

\medskip\noindent
Finally, we show that (2) and (3) hold with our choice of $N$.
Namely, the stabilization proven above gives that $H^m(Rf_*E)$ is equal
to $H^m(Rf_*(\tau_{\geq -n}E))$ for all $n$ large enough which means we
can work with objects in $D^b(\mathcal{O}_X)$ in order to prove (2) and (3).
In this case we can for example use the spectral sequence
$$
R^pf_*H^q(E) \Rightarrow R^{p + q}f_*E
$$
(Derived Categories, Lemma \ref{derived-lemma-two-ss-complex-functor})
and the vanishing of $R^pf_*H^q(E)$ for $p \geq N$ to conclude.
Some details omitted.
\end{proof}

\begin{lemma}
\label{lemma-affine-compare-bounded}
If $X$ is an affine scheme, then (\ref{equation-compare}) is an equivalence.
\end{lemma}

\begin{proof}
Say $X = \Spec(A)$. The functor $R\Gamma(X, -)$ gives a functor
$D(\mathcal{O}_X) \to D(A)$ and hence by restriction a functor
\begin{equation}
\label{equation-back}
R\Gamma(X, -) : D_{\textit{QCoh}}(\mathcal{O}_X) \longrightarrow D(A).
\end{equation}
We will show this functor is quasi-inverse to (\ref{equation-compare})
via the equivalence between quasi-coherent modules on $X$ and
the category of $A$-modules.

\medskip\noindent
Elucidation. Denote $(Y, \mathcal{O}_Y)$ the one point space with sheaf
of rings given by $A$. Denote
$\pi : (X, \mathcal{O}_X) \to (Y, \mathcal{O}_Y)$
the obvious morphism of ringed spaces.
Then $R\Gamma(X, -)$ can be identified with $R\pi_*$ and the functor
(\ref{equation-compare}) via the equivalence
$\textit{Mod}(\mathcal{O}_Y) = \textit{Mod}(A) = \textit{QCoh}(\mathcal{O}_X)$
can be identified with $L\pi^* = \pi^* = \widetilde{}$ (see
Modules, Lemma \ref{modules-lemma-construct-quasi-coherent-sheaves} and
Schemes, Lemmas \ref{schemes-lemma-compare-constructions} and
\ref{schemes-lemma-equivalence-quasi-coherent}). Thus the functors
$$
\xymatrix{
D(A) \ar@<1ex>[r] & D_{\textit{QCoh}}(\mathcal{O}_X) \ar@<1ex>[l]
}
$$
are adjoint (by Cohomology, Lemma \ref{cohomology-lemma-adjoint}). In
particular we obtain canonical adjunction mappings
$$
a : \widetilde{R\Gamma(X, E)} \longrightarrow E
$$
for $E$ in $D(\mathcal{O}_X)$ and
$$
b : M^\bullet \longrightarrow R\Gamma(X, \widetilde{M^\bullet})
$$
for $M^\bullet$ a complex of $A$-modules.

\medskip\noindent
Let $E$ be an object of $D_{\textit{QCoh}}(\mathcal{O}_X)$. We may apply
Lemma \ref{lemma-application-nice-K-injective}
to the functor $F(-) = \Gamma(X, -)$
with $N = 1$ by Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherent-affine-cohomology-zero}.
Hence
$$
R^0\Gamma(X, E) = R^0\Gamma(X, \tau_{\geq 0}E) = \Gamma(X, H^0(E))
$$
(the last equality by definition of the canonical truncation).
Using this we will show that the adjunction mappings $a$ and $b$
induce isomorphisms $H^0(a)$ and $H^0(b)$. Thus $a$ and $b$
are quasi-isomorphisms (as the statement is invariant under shifts)
and the lemma is proved.

\medskip\noindent
In both cases we use that $\widetilde{\ }$ is an exact functor
(Schemes, Lemma \ref{schemes-lemma-spec-sheaves}). Namely, this
implies that
$$
H^0\left(\widetilde{R\Gamma(X, E)}\right) = \widetilde{R^0\Gamma(X, E)}
= \widetilde{\Gamma(X, H^0(E))}
$$
which is equal to $H^0(E)$ because $H^0(E)$ is quasi-coherent. Thus
$H^0(a)$ is an isomorphism. For the other direction we have
$$
H^0(R\Gamma(X, \widetilde{M^\bullet})) =
R^0\Gamma(X, \widetilde{M^\bullet}) =
\Gamma(X, H^0(\widetilde{M^\bullet})) =
\Gamma(X, \widetilde{H^0(M^\bullet)}) = H^0(M^\bullet)
$$
which proves that $H^0(b)$ is an isomorphism.
\end{proof}


\section{The coherator}
\label{section-coherator}

\noindent
Let $X$ be a scheme. The {\it coherator} is a functor
$$
Q_X :
\textit{Mod}(\mathcal{O}_X)
\longrightarrow
\textit{QCoh}(\mathcal{O}_X)
$$
which is right adjoint to the inclusion functor
$\textit{QCoh}(\mathcal{O}_X) \to \textit{Mod}(\mathcal{O}_X)$.
It exists for any scheme $X$ and moreover the adjunction mapping
$Q_X(\mathcal{F}) \to \mathcal{F}$ is an isomorphism for every
quasi-coherent module $\mathcal{F}$, see
Properties, Proposition \ref{properties-proposition-coherator}.
Since $Q$ is left exact (as a right adjoint) we can consider its
right derived extension
$$
RQ_X :
D(\mathcal{O}_X)
\longrightarrow
D(\textit{QCoh}(\mathcal{O}_X)).
$$
As this functor is constructed by applying $Q_X$ to a K-injective replacement
we see that $RQ_X$ is a right adjoint to the canonical functor
$D(\textit{QCoh}(\mathcal{O}_X)) \to D(\mathcal{O}_X)$.

\begin{lemma}
\label{lemma-affine-pushforward}
Let $f : X \to Y$ be an affine morphism of schemes.
Then $f_*$ defines a derived functor
$f_* : D(\textit{QCoh}(\mathcal{O}_X)) \to D(\textit{QCoh}(\mathcal{O}_Y))$.
This functor has the property that
$$
\xymatrix{
D(\textit{QCoh}(\mathcal{O}_X)) \ar[d]_{f_*} \ar[r] &
D_{\textit{QCoh}}(\mathcal{O}_X) \ar[d]^{Rf_*} \\
D(\textit{QCoh}(\mathcal{O}_Y)) \ar[r] &
D_{\textit{QCoh}}(\mathcal{O}_Y)
}
$$
commutes.
\end{lemma}

\begin{proof}
The functor
$f_* : \textit{QCoh}(\mathcal{O}_X) \to \textit{QCoh}(\mathcal{O}_Y)$
is exact, see
Cohomology of Schemes, Lemma \ref{coherent-lemma-relative-affine-vanishing}.
Hence $f_*$ defines a derived functor
$f_* : D(\textit{QCoh}(\mathcal{O}_X)) \to D(\textit{QCoh}(\mathcal{O}_Y))$
by simply applying $f_*$ to any representative complex, see
Derived Categories, Lemma \ref{derived-lemma-right-derived-exact-functor}.
For any complex of $\mathcal{O}_X$-modules
$\mathcal{F}^\bullet$ there is a canonical map
$f_*\mathcal{F}^\bullet \to Rf_*\mathcal{F}^\bullet$.
To finish the proof we show this is a quasi-isomorphism when
$\mathcal{F}^\bullet$ is a complex with each $\mathcal{F}^n$
quasi-coherent. As the statement is invariant under shifts it
suffices to show that
$H^0(f_*(\mathcal{F}^\bullet)) \to R^0f_*\mathcal{F}^\bullet$
is an isomorphism. The statement is local on $Y$ hence we
may assume $Y$ affine. By
Lemma \ref{lemma-quasi-coherence-direct-image}
we have $R^0f_*\mathcal{F}^\bullet = R^0f_*\tau_{\geq -n}\mathcal{F}^\bullet$
for all sufficiently large $n$. Thus we may assume $\mathcal{F}^\bullet$
bounded below. As each $\mathcal{F}^n$ is $f_*$-acyclic by
Cohomology of Schemes, Lemma \ref{coherent-lemma-relative-affine-vanishing}
we see that
$f_*\mathcal{F}^\bullet \to Rf_*\mathcal{F}^\bullet$
is a quasi-isomorphism by
Leray's acyclicity lemma (Derived Categories, Lemma
\ref{derived-lemma-leray-acyclicity}).
\end{proof}

\begin{lemma}
\label{lemma-affine-flat-coherator}
Let $f : X \to Y$ be an affine flat morphism of schemes.
Then $RQ_Y \circ Rf_* = f_* \circ RQ_X$ where $f_*$ is as
in Lemma \ref{lemma-affine-pushforward}.
\end{lemma}

\begin{proof}
Since $f$ is flat, then functor $f^*$ is exact hence defines
$f^* : D(\mathcal{O}_Y) \to D(\mathcal{O}_X)$ and also
$f^* : D(\textit{QCoh}(\mathcal{O}_Y)) \to D(\textit{QCoh}(\mathcal{O}_X))$.
The functor $f^* = Lf^* : D(\mathcal{O}_Y) \to D(\mathcal{O}_X)$
is left adjoint to
$Rf_* : D(\mathcal{O}_X) \to D(\mathcal{O}_Y)$,
see Cohomology, Lemma \ref{cohomology-lemma-adjoint}.
On the other hand, the functor
$f^* : D(\textit{QCoh}(\mathcal{O}_Y)) \to D(\textit{QCoh}(\mathcal{O}_X))$
is left adjoint to
$f_* : D(\textit{QCoh}(\mathcal{O}_X)) \to D(\textit{QCoh}(\mathcal{O}_Y))$
just because these are constructed from an adjoint pair of exact functors.
Now let $A$ be an object of $D(\textit{QCoh}(\mathcal{O}_Y))$ and
$E$ an object of $D(\mathcal{O}_X)$. Then
\begin{align*}
\Hom_{D(\textit{QCoh}(\mathcal{O}_Y))}(A, RQ_Y(Rf_*E))
& =
\Hom_{D(\mathcal{O}_Y)}(A, Rf_*E) \\
& =
\Hom_{D(\mathcal{O}_X)}(f^*A, E) \\
& =
\Hom_{D(\textit{QCoh}(\mathcal{O}_X))}(f^*A, RQ_X(E)) \\
& =
\Hom_{D(\textit{QCoh}(\mathcal{O}_Y))}(A, f_*RQ_X(E))
\end{align*}
This implies what we want.
\end{proof}

\begin{lemma}
\label{lemma-affine-coherator}
Let $X = \Spec(A)$ be an affine scheme. Then
$RQ_X : D(\mathcal{O}_X) \to D(\textit{QCoh}(\mathcal{O}_X))$
is the functor which sends $E$ to the complex of quasi-coherent modules
associated to the object $R\Gamma(X, E)$ of $D(A)$. When
restricted to $D_{\textit{QCoh}}(\mathcal{O}_X)$ the functor
$RQ_X$ defines a quasi-inverse to (\ref{equation-compare}).
\end{lemma}

\begin{proof}
The functor $Q_X$ is the functor
$$
\mathcal{F} \mapsto \widetilde{\Gamma(X, \mathcal{F})}
$$
by Schemes, Lemma \ref{schemes-lemma-compare-constructions}.
This immediately implies the first assertion. The second assertion
follows from (the proof of)
Lemma \ref{lemma-affine-compare-bounded}.
\end{proof}

\begin{definition}
\label{definition-supported-on}
Let $X$ be a scheme. Let $E \in D(\mathcal{O}_X)$.
Let $T \subset X$ be a closed subset.
We say $E$ is {\it supported on $T$} if the
cohomology sheaves $H^i(E)$ are supported on $T$.
\end{definition}

\begin{lemma}
\label{lemma-quasi-compact-affine-diagonal}
Let $X$ be a quasi-compact scheme with affine diagonal.
Then the functor (\ref{equation-compare})
$$
D(\textit{QCoh}(\mathcal{O}_X))
\longrightarrow
D_{\textit{QCoh}}(\mathcal{O}_X)
$$
is an equivalence with quasi-inverse given by $RQ_X$.
\end{lemma}

\begin{proof}
Let $E$ be an object of $D_{\textit{QCoh}}(\mathcal{O}_X)$ and
let $A$ be an object of $D(\textit{QCoh}(\mathcal{O}_X))$.
We have to show that the adjunction maps
$$
RQ_X(A) \to A
\quad\text{and}\quad
E \to RQ_X(E)
$$
are isomorphisms. We will prove this by induction on $n$:
the smallest integer $n \geq 0$ such that $E$ and $A$ are supported
on a closed subset of $X$ which
is contained in the union of $n$ affine opens of $X$. If $n = 0$
then $E$ and $A$ are zero; this is the base case of the induction.

\medskip\noindent
Suppose that $E$ and $A$ are supported on a closed subset $T$ of
$U_1 \cup \ldots \cup U_n$ with $U_i \subset X$ affine open.
Set $U = U_n$. The inclusion morphism
$j : U \to X$ is flat and affine
(Morphisms, Lemma \ref{morphisms-lemma-affine-permanence}).
Consider the distinguished triangles
$$
A \to j_*(A|_U) \to A' \to A[1]
\quad\text{and}\quad
E \to Rj_*(E|_U) \to E' \to E[1]
$$
where $j_*$ is as in Lemma \ref{lemma-affine-pushforward}.
Note that $A \to j_*(A|_U)$ and $E \to Rj_*(E|_U)$ are quasi-isomorphisms
over $U = U_n$. Hence $A'$ and $E'$ are supported on the closed
subset $T \setminus U_1$ contained in $U_1 \cup \ldots \cup U_{n - 1}$.
By induction hypothesis the statement is true for $A'$ and $E'$. By
Derived Categories, Lemma \ref{derived-lemma-third-isomorphism-triangle}
it suffices to prove the maps
$$
RQ_X(j_*(A|_U)) \to j_*(A|_U)
\quad\text{and}\quad
Rj_*(E|_U) \to RQ_X(Rj_*E|_U)
$$
are isomorphisms. By Lemma \ref{lemma-affine-flat-coherator} we have
$RQ_X(j_*(A|_U)) = j_*RQ_U(A|_U)$ and
$RQ_X(Rj_*E|_U) = j_*RQ_U(E|_U)$. Finally, the maps
$$
RQ_U(A|_U) \to A|_U
\quad\text{and}\quad
E|_U \to RQ_U(E|_U)
$$
are isomorphisms by Lemma \ref{lemma-affine-coherator}. The result follows.
\end{proof}



\section{Koszul complexes}
\label{section-koszul}

\noindent
Let $A$ be a ring and let $f_1, \ldots, f_r$ be a sequence of elements
of $A$. We have defined the Koszul complex
$K_\bullet(f_1, \ldots, f_r)$ in
More on Algebra, Definition \ref{more-algebra-definition-koszul-complex}.
It is a chain complex sitting in degrees $r, \ldots, 0$.
We turn this into a cochain complex $K^\bullet(f_1, \ldots, f_r)$
by setting $K^{-n}(f_1, \ldots, f_r) = K_n(f_1, \ldots, f_r)$
and using the same differentials. In the rest of this section all
the complexes will be cochain complexes.

\medskip\noindent
We define a complex $C^\bullet(f_1, \ldots, f_r)$
such that we have a distinguished triangle
$$
C^\bullet(f_1, \ldots, f_r) \to
A \to
K^\bullet(f_1, \ldots, f_r) \to
C^\bullet(f_1, \ldots, f_r)[1]
$$
in $K(A)$.
In other words, we set
$$
C^i(f_1, \ldots, f_r) =
\left\{
\begin{matrix}
K^{i - 1}(f_1, \ldots, f_r) & \text{if } i \leq 0 \\
0 & \text{else}
\end{matrix}
\right.
$$
and we use the negative of the differential on $K^\bullet(f_1, \ldots, f_r)$.
The maps in the distinguished triangle are the obvious ones. Note that
$C^0(f_1, \ldots, f_r) = A^{\oplus r} \to A$ is given by
multiplication by $f_i$ on the $i$th factor.
Hence $C^\bullet(f_1, \ldots, f_r) \to A$ factors as
$$
C^\bullet(f_1, \ldots, f_r) \to I \to A
$$
where $I = (f_1, \ldots, f_r)$. In fact, there is a short exact sequence
$$
0 \to H^{-1}(K^\bullet(f_1, \ldots, f_s)) \to
H^0(C^\bullet(f_1, \ldots, f_s)) \to I \to 0
$$
and for every $i < 0$ we have
$H^i(C^\bullet(f_1, \ldots, f_r)) = H^{i - 1}(K^\bullet(f_1, \ldots, f_r)$.
Observe that given a second sequence $g_1, \ldots, g_r$ of elements of $A$
there are canonical maps
$$
C^\bullet(f_1g_1, \ldots, f_rg_r) \to C^\bullet(f_1, \ldots, f_r)
\quad\text{and}\quad
K^\bullet(f_1g_1, \ldots, f_rg_r) \to K^\bullet(f_1, \ldots, f_r)
$$
compatible with the maps described above. The first of these maps is
given by multiplcation by $g_i$ on the $i$th summand of
$C^0(f_1g_1, \ldots, f_rg_r) = A^{\oplus r}$. In particular, given
$f_1, \ldots, f_r$ we obtain an inverse system of complexes
\begin{equation}
\label{equation-system}
C^\bullet(f_1, \ldots, f_r) \leftarrow
C^\bullet(f_1^2, \ldots, f_r^2) \leftarrow
C^\bullet(f_1^3, \ldots, f_r^3) \leftarrow \ldots
\end{equation}
which will play an important role in that which is to follow.
To easily formulate the following lemmas we fix some notation.

\begin{situation}
\label{situation-complex}
Here $A$ is a ring and $f_1, \ldots, f_r$ is a sequence of elements of $A$.
We set $X = \Spec(A)$ and $U = D(f_1) \cup \ldots \cup D(f_r) \subset X$.
We denote $\mathcal{U} : U = \bigcup_{i = 1, \ldots, r} D(f_i)$ the
given open covering of $U$.
\end{situation}

\noindent
Our first lemma is that the complexes above can be used to compute
the cohomology of quasi-coherent sheaves on $U$. Suppose given a
complex $C^\bullet$ of $A$-modules and an $A$-module $M$. Then we
define $\Hom_A(C^\bullet, M)$ to be the complex with $n$th
term $\Hom_A(C^{-n}, M)$ and differentials given as the contragredients
of the differentials on $C^\bullet$.

\begin{lemma}
\label{lemma-alternating-cech-complex}
In Situation \ref{situation-complex}. Let $M$ be an $A$-module and
denote $\mathcal{F}$ the associated $\mathcal{O}_X$-module. Then
there is a canonical isomorphism of complexes
$$
\colim_e \Hom_A(C^\bullet(f_1^e, \ldots, f_r^e), M)
\longrightarrow
\check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F})
$$
functorial in $M$.
\end{lemma}

\begin{proof}
Recall that the alternating {\v C}ech complex is the subcomplex
of the usual {\v C}ech complex given by alternating cochains, see
Cohomology, Section \ref{cohomology-section-alternating-cech}.
As usual we view a $p$-cochain in
$\check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F})$
as an alternating function $s$ on $\{1, \ldots, r\}^{p + 1}$
whose value $s_{i_0\ldots i_p}$ at $(i_0, \ldots, i_p)$ lies in
$M_{f_{i_0}\ldots f_{i_p}} = \mathcal{F}(U_{i_0\ldots i_p})$.
On the other hand, a $p$-cochain $t$ in
$\Hom_A(C^\bullet(f_1^e, \ldots, f_r^e), M)$
is given by a map $t : \wedge^{p + 1}(A^{\oplus r}) \to M$.
Write $[i] \in A^{\oplus r}$ for the $i$th basis element and
write
$$
[i_0, \ldots, i_p] = [i_0] \wedge \ldots \wedge [i_p]
\in \wedge^{p + 1}(A^{\oplus r})
$$
Then we send $t$ as above to $s$ with
$$
s_{i_0\ldots i_p} = \frac{t([i_0, \ldots, i_p])}{f_{i_0}^e\ldots f_{i_p}^e}
$$
It is clear that $s$ so defined is an alternating cochain.
The construction of this map is compatible with the transition maps
of the system as the transition map
$$
C^\bullet(f_1^e, \ldots, f_r^e) \leftarrow
C^\bullet(f_1^{e + 1}, \ldots, f_r^{e + 1}),
$$
of the (\ref{equation-system}) sends $[i_0, \ldots, i_p]$
to $f_{i_0}\ldots f_{i_p}[i_0, \ldots, i_p]$.
It is clear from the description of the localizations
$M_{f_{i_0}\ldots f_{i_p}}$ in
Algebra, Lemma \ref{algebra-lemma-localization-colimit}
that these maps define an isomorphism of cochain modules in degree $p$
in the limit. To finish the proof we have to show that the map
is compatible with differentials. To see this recall that
\begin{align*}
d(s)_{i_0\ldots i_{p + 1}}
& =
\sum\nolimits_{j = 0}^{p + 1} (-1)^j
s_{i_0\ldots \hat i_j \ldots i_p} \\
& = 
\sum\nolimits_{j = 0}^{p + 1} (-1)^j
\frac{t([i_0, \ldots, \hat i_j, \ldots i_{p + 1}])}
{f_{i_0}^e\ldots \hat f_{i_j}^e \ldots f_{i_{p + 1}}^e}
\end{align*}
On the other hand, we have
\begin{align*}
\frac{d(t)([i_0, \ldots, i_{p + 1}])}{f_{i_0}^e\ldots f_{i_{p + 1}}^e}
& =
\frac{t(d[i_0, \ldots, i_{p + 1}])}{f_{i_0}^e\ldots f_{i_{p + 1}}^e} \\
& =
\frac{\sum_j (-1)^j f_{i_j}^e t([i_0, \ldots, \hat i_j, \ldots i_{p + 1}])}
{f_{i_0}^e \ldots f_{i_{p + 1}}^e}
\end{align*}
The two formulas agree by inspection.
\end{proof}

\medskip\noindent
Suppose given a complex $C^\bullet$ of $A$-modules and a
complex of $A$-modules $M^\bullet$. We obtain a double complex
$H^{\bullet, \bullet} = \Hom_A(C^\bullet, M^\bullet)$ where
$H^{p, q} = \Hom_A(C^p, M^q)$. The first differential comes from
the differential on $\Hom_A(C^\bullet, M^q)$ and the second
from the differential on $M^\bullet$. Associated to this double
complex is the total complex with degree $n$ term given by
$$
\bigoplus\nolimits_{p + q = n} \Hom_A(C^p, M^q)
$$
and differential as in
Homology, Definition \ref{homology-definition-associated-simple-complex}.
Often our complexes $C^\bullet$ will have finitely many terms, so the
direct sum displayed above is finite.
The conventions for taking the total complex associated to a
{\v C}ech complex of a complex are as in
Cohomology, Section \ref{cohomology-section-cech-cohomology-of-complexes}.

\begin{lemma}
\label{lemma-alternating-cech-complex-complex}
In Situation \ref{situation-complex}. Let $M^\bullet$ be a
complex of $A$-modules and
denote $\mathcal{F}^\bullet$ the associated complex of
$\mathcal{O}_X$-modules. Then
there is a canonical isomorphism of complexes
$$
\colim_e \text{Tot}(\Hom_A(C^\bullet(f_1^e, \ldots, f_r^e), M^\bullet))
\longrightarrow
\text{Tot}(\check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F}^\bullet))
$$
functorial in $M^\bullet$.
\end{lemma}

\begin{proof}
Immediate from Lemma \ref{lemma-alternating-cech-complex}
and our conventions for taking associated total complexes.
\end{proof}

\begin{lemma}
\label{lemma-alternating-cech-complex-complex-computes-cohomology}
In Situation \ref{situation-complex}. Let $\mathcal{F}^\bullet$
be a complex of quasi-coherent $\mathcal{O}_X$-modules. Then
there is a canonical isomorphism
$$
\text{Tot}(\check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F}^\bullet))
\longrightarrow
R\Gamma(U, \mathcal{F}^\bullet)
$$
in $D(A)$ functorial in $\mathcal{F}^\bullet$.
\end{lemma}

\begin{proof}
Let $\mathcal{B}$ be the set of affine opens of $U$. Since the higher
cohomology groups of a quasi-coherent module on an affine scheme are zero
(Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherent-affine-cohomology-zero})
this is a special case of
Cohomology, Lemma \ref{cohomology-lemma-alternating-cech-complex-complex-ss}.
\end{proof}





\section{Derived category of quasi-coherent modules on the small \'etale site}
\label{section-derived-quasi-coherent-etale}

\noindent
Let $X$ be a scheme.
In this section we show that $D_{QCoh}(\mathcal{O}_X)$ can be defined in terms
of the small \'etale site of $X$. Namely, denote $\mathcal{O}_{\acute{e}tale}$
the structure sheaf on $X_{\acute{e}tale}$. Recall that
$\textit{QCoh}(\mathcal{O}_X)$ is also a Serre subcategory of
$\textit{Mod}(\mathcal{O}_{\acute{e}tale})$, see
Descent, Lemma \ref{descent-lemma-equivalence-quasi-coherent-limits}.
Hence we can let $D_{QCoh}(\mathcal{O}_{\acute{e}tale})$ be the trangulated
subcategory of $D(\mathcal{O}_{\acute{e}tale})$ whose objects are the
complexes with quasi-coherent cohomology sheaves, see
Derived Categories, Section \ref{derived-section-triangulated-sub}.

\begin{lemma}
\label{lemma-derived-quasi-coherent-small-etale-site}
Let $X$ be a scheme. There is a canonical equivalence
$D_{QCoh}(\mathcal{O}_X) = D_{QCoh}(\mathcal{O}_{\acute{e}tale})$.
\end{lemma}

\begin{proof}
Consider the morphism of ringed sites
$\epsilon : X_{\acute{e}tale} \to X_{Zar}$, see
Descent, Remark \ref{descent-remark-change-topologies-ringed}.
This is the morphism $\text{id}_{small, \acute{e}tale, Zar}$ of
Descent, Lemma \ref{descent-lemma-compare-sites}.
Since every etale morphism $U \to X$ is flat
(Morphisms, Lemma \ref{morphisms-lemma-etale-flat})
the description of $\epsilon^* = \text{id}_{small, \acute{e}tale, Zar}^*$ in
Descent, Lemma \ref{descent-lemma-compare-sites}
shows that $\epsilon^*$ is an exact functor. Hence it induces
$\epsilon^* : D(\mathcal{O}_X) \to D(\mathcal{O}_{\acute{e}tale})$.
By the material in
Descent, Section \ref{descent-section-quasi-coherent-sheaves}
given a quasi-coherent sheaf $\mathcal{F}$ on $X$ the sheaf
$\mathcal{F}^a = \epsilon^*\mathcal{F}$ is the corresonding quasi-coherent
module on $X_{\acute{e}tale}$. Thus $\epsilon^*$ induces
$$
\epsilon^* : D_{QCoh}(\mathcal{O}_X) \to D_{QCoh}(\mathcal{O}_{\acute{e}tale})
$$
We claim the functor $R\epsilon_* : D(\mathcal{O}_{\acute{e}tale}) \to
D(\mathcal{O}_X)$ induces a quasi-inverse.

\medskip\noindent
Let $E$ be an object of $D_{\textit{QCoh}}(\mathcal{O}_{\acute{e}tale})$
and denote $\mathcal{H}^i = H^i(E)$ its $i$th cohomology
sheaf. Let $\mathcal{B}$ be the set of affine objects of $S_{\acute{e}tale}$.
Then $H^p(U, \mathcal{H}^i) = 0$ for all $p > 0$, all $i \in \mathbf{Z}$,
and all $U \in \mathcal{B}$, see
Descent, Proposition \ref{descent-proposition-same-cohomology-quasi-coherent}
and
Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherent-affine-cohomology-zero}.
According to
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-K-injective}
this implies $E$ is represebted by a K-injective complex
$\mathcal{I}^\bullet$ and
$\mathcal{I}^\bullet = \lim \mathcal{I}_n^\bullet$ where
each $\mathcal{I}_n^\bullet$ is a bounded below complex of injectives,
the maps in the system
$\ldots \to \mathcal{I}_2^\bullet \to \mathcal{I}_1^\bullet$
are termwise split surjections, and each $\mathcal{I}_n^\bullet$ is
quasi-isomorphic to $\tau_{\geq -n}E$.
In particular,
$$
R\epsilon_*E = \epsilon_*\mathcal{I}^\bullet =
\lim \epsilon_*\mathcal{I}_n^\bullet
$$
Let $V$ be an affine object of $X_{\acute{e}tale}$. In the proof of
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-K-injective}
we have seen that $H^m(\mathcal{I}^\bullet(V))$ is
the limit of the cohomology groups $H^m(\mathcal{I}_n^\bullet(V))$.
For $n > -m$ these groups are equal to $\mathcal{H}^m(V)$
by the vanishing of higer cohomology and the spectral sequence of
Derived Categories, Lemma \ref{derived-lemma-two-ss-complex-functor}.
If we apply this to all $V = U \subset X$ affine open, then we conclude that
the $m$th cohomology sheaf of $\epsilon_*\mathcal{I}^\bullet$ is
$\epsilon_*\mathcal{H}^m$. This implies that
$R\epsilon_*\mathcal{F}^\bullet = \epsilon_*\mathcal{I}^\bullet$
is an object of $D_{QCoh}(\mathcal{O}_X)$ and we get our functor
$$
R\epsilon_* :
D_{QCoh}(\mathcal{O}_{\acute{e}tale})
\longrightarrow
D_{QCoh}(\mathcal{O}_X)
$$
in the other direction. Since also for arbitrary $V$ we have
$\mathcal{H}^m(V) = (\epsilon^*\epsilon_*\mathcal{H}^m)(V)$
as $\mathcal{H}^m$ is quasi-coherent, we conclude the canonical map of
complexes
$$
\epsilon^*\epsilon_*\mathcal{I}^\bullet \longrightarrow \mathcal{I}^\bullet
$$
is a quasi-isomorphism. This implies that the composition
$$
D_{QCoh}(\mathcal{O}_{\acute{e}tale})
\longrightarrow
D_{QCoh}(\mathcal{O}_X)
\longrightarrow
D_{QCoh}(\mathcal{O}_{\acute{e}tale})
$$
is isomorphic to the identity functor. Finally, we claim that
$$
D_{QCoh}(\mathcal{O}_X)
\longrightarrow
D_{QCoh}(\mathcal{O}_{\acute{e}tale})
\longrightarrow
D_{QCoh}(\mathcal{O}_X)
$$
is isomorphic to the identity as well. Namely, for $\mathcal{G}^\bullet$
an object of $D_{QCoh}(\mathcal{O}_X)$ we choose a map
$\epsilon^*\mathcal{G}^\bullet \to \mathcal{I}^\bullet$
into a K-injective complex as above and consider the map
$$
\mathcal{G}^\bullet \to \epsilon_*\epsilon^*\mathcal{G}^\bullet \to
\epsilon_*\mathcal{I}^\bullet
$$
This is a quasi-isomorphism as we've just seen above that the cohomology
sheaves of $\epsilon_*\epsilon^*\mathcal{I}^\bullet$ are exactly the
quasi-coherent cohomology sheaves of the complex $\mathcal{G}^\bullet$
we started out with.
\end{proof}














\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}

