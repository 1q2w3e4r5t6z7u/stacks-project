\input{preamble}

% OK, start here.
%
\begin{document}

\title{Divisors}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we study some very basic questions related
to defining divisors, etc. A basic reference is \cite{EGA}.








\section{Effective Cartier divisors}
\label{section-effective-Cartier-divisors}

\noindent
For some reason it seem convenient to define the notion of an effective
Cartier divisor before anything else.

\begin{definition}
\label{definition-effective-Cartier-divisor}
Let $S$ be a scheme.
An {\it effective Cartier divisor} on $S$ is a closed subscheme
$D \subset S$ such that the ideal sheaf $\mathcal{I}_D \subset \mathcal{O}_X$
is an invertible $\mathcal{O}_X$-module.
\end{definition}

\noindent
This notion defines closed subschemes which are of pure codimension $1$
in the strongest possible sense. Namely they are locally cut out by
a single element which is not a zero divisor. In particular they
are nowhere dense.

\begin{lemma}
\label{lemma-characterize-effective-Cartier-divisor}
Let $S$ be a scheme.
Let $D \subset S$ be a closed subscheme.
The following are equivalent:
\begin{enumerate}
\item The subscheme $D$ is an effective Cartier divisor on $S$.
\item For every $x \in D$ there exists an affine open neighbourhood
$\text{Spec}(A) = U \subset X$ of $x$ such that
$U \cap D = \text{Spec}(A/(f))$ with $f \in A$ not a zero divisor.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (1).  For every $x \in D$ there exists an affine open neighbourhood
$\text{Spec}(A) = U \subset X$ of $x$ such that
$\mathcal{I}_D|_U \cong \mathcal{O}_U$. In other words, there exists
a section $f \in \Gamma(U, \mathcal{I}_D)$ which freely generates the
restriction $\mathcal{I}_D|_U$. Hence $f \in A$, and the multiplication
map $f : A \to A$ is injective. Also, since $\mathcal{I}_D$ is
quasi-coherent we see that $D \cap U = \text{Spec}(A/(f))$.

\medskip\noindent
Assume (2). Let $x \in D$. By assumption there exists an affine open
neighbourhood $\text{Spec}(A) = U \subset X$ of $x$ such that
$U \cap D = \text{Spec}(A/(f))$ with $f \in A$ not a zero divisor.
Then $\mathcal{I}_D|_U \cong \mathcal{O}_U$ since it is equal to
$\widetilde{(f)} \cong \widetilde{A} \cong \mathcal{O}_U$.
Of course $\mathcal{I}_D$ restricted to the open subscheme
$S \setminus D$ is isomorphic to $\mathcal{O}_{X \setminus D}$.
Hence $\mathcal{I}_D$ is an invertible $\mathcal{O}_S$-module.
\end{proof}

\begin{definition}
\label{definition-sum-effective-Cartier-divisors}
Let $S$ be a scheme. Given effective Cartier divisors
$D_1$, $D_2$ on $S$ we set $D = D_1 + D_2$ equal to the
closed subscheme of $S$ corresponding to the quasi-coherent
sheaf of ideals
$\mathcal{I}_{D_1}\mathcal{I}_{D_2} \subset \mathcal{O}_S$.
We call this the {\it sum of the effective Cartier divisors
$D_1$ and $D_2$}.
\end{definition}

\begin{lemma}
\label{lemma-sum-effective-Cartier-divisors}
The sum of two effective Cartier divisors is an effective
Cartier divisor.
\end{lemma}

\begin{proof}
Omitted. Locally $f_1, f_2 \in A$ are nonzero divisors, then also
$f_1f_2 \in A$ is a nonzero divisor.
\end{proof}

\noindent
Recall that we have defined the inverse image of a closed subscheme
under any morphism of schemes in
Schemes, Definition \ref{schemes-definition-inverse-image-closed-subscheme}.

\begin{definition}
\label{definition-pullback-effective-Cartier-divisor}
Let $f : S' \to S$ be a morphism of schemes. Let $D \subset S$
be an effective Cartier divisor. We say the {\it pullback of
$D$ by $f$ is defined} if the closed subscheme $f^{-1}(D) \subset S'$
is an effective Cartier divisor. In this case we denote it either
$f^*D$ or $f^{-1}(D)$ and we call it the
{\it pullback of the effective Cartier divisor}.
\end{definition}

\noindent
The condition that $f^{-1}(D)$ is an effective Cartier divisor
is often satisfied in practice. Here is an example lemma.

\begin{lemma}
\label{lemma-pullback-effective-Cartier-defined}
Let $f : X \to Y$ be a morphism of schemes.
Let $D \subset Y$ be an effective Cartier divisor.
The pullback of $D$ by $f$ is defined in each of the following cases:
\begin{enumerate}
\item $X$, $Y$ integral and $f$ dominant,
\item $X$ reduced, and for any generic point $\xi$ of any
irreducible component we have $f(\xi) \not \in D$,
\item $f$ is flat, and
\item add more here as needed.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-pullback-effective-Cartier-divisors-additive}
Let $f : S' \to S$ be a morphism of schemes.
Let $D_1$, $D_2$ be effective Cartier divisors on $S$.
If the pullbacks of $D_1$ and $D_2$ are defined then the
pullback of $D = D_1 + D_2$ is defined and
$f^*D = f^*D_1 + f^*D_2$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-invertible-sheaf-effective-Cartier-divisor}
Let $S$ be a scheme and let $D$ be an effective Cartier divisor.
The {\it invertible sheaf $\mathcal{O}_S(D)$ associated to $D$}
is given by
$$
\mathcal{O}_S(D) :=
\textit{Hom}_{\mathcal{O}_S}(\mathcal{I}_D, \mathcal{O}_S) =
\mathcal{I}_D^{\otimes -1}.
$$
The canonical section, usually denoted $1$ or $1_D$, is the
global section of $\mathcal{O}_S(D)$ corresponding to
the inclusion mapping $\mathcal{I}_D \to \mathcal{O}_S$.
\end{definition}

\begin{definition}
\label{definition-regular-section}
Let $(X, \mathcal{O}_X)$ be a locally ringed space.
Let $\mathcal{L}$ be an invertible sheaf on $X$.
A global section $s \in \Gamma(X, \mathcal{L})$ is called a
{\it regular section} if the map $\mathcal{O}_X \to \mathcal{L}$,
$f \mapsto fs$ is injective.
\end{definition}

\begin{lemma}
\label{lemma-regular-section-structure-sheaf}
Let $X$ be a locally ringed space. Let $f \in \Gamma(X, \mathcal{O}_X)$.
The following are equivalent:
\begin{enumerate}
\item $f$ is a regular section, and
\item for any $x \in X$ the image $f \in \mathcal{O}_{X, x}$
is not a zero divisor.
\end{enumerate}
If $X$ is a scheme these are also equivalent to
\begin{enumerate}
\item[(3)] for any affine open $\text{Spec}(A) = U \subset X$
the image $f \in A$ is not a zero divisor, and
\item[(4)] there exists an affine open covering
$X = \bigcup \text{Spec}(A_i)$ such that
the image of $f$ in $A_i$ is not a zero divisor for all $i$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-characterize-OD}
Let $S$ be a scheme.
\begin{enumerate}
\item If $D \subset S$ is an effective Cartier divisor, then
the canonical section $1_D$ of $\mathcal{O}_S(D)$ is regular.
\item Conversely, if $s$ is a regular section of the invertible
sheaf $\mathcal{L}$, then there exists a unique effective
Cartier divisor $D \subset S$ and a unique isomorphism
$\mathcal{O}_S(D) \to \mathcal{L}$ which maps $1_D$ to $s$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}








\section{Meromorphic functions and sections}
\label{section-meromorphic-functions}

\noindent
Let $(X, \mathcal{O}_X)$ be a locally ringed space.
For any open $U \subset X$ we have defined the set
$\mathcal{S}(U) \subset \mathcal{O}_X(U)$
of regular sections of $\mathcal{O}_X$ over $U$, see
Definition \ref{definition-regular-section}. The restriction
of a regular section to a smaller open is regular. Hence
$\mathcal{S} : U \mapsto \mathcal{S}(U)$ is a subsheaf (of sets)
of $\mathcal{O}_X$. Moreover, $\mathcal{S}(U)$
is a multiplicative subset of the ring $\mathcal{O}_X(U)$ for
each $U$. Hence we may consider
the presheaf of rings
$$
U \longmapsto \mathcal{S}(U)^{-1} \mathcal{O}_X(U),
$$
see Modules, Lemma \ref{modules-lemma-simple-invert}.

\begin{definition}
\label{definition-sheaf-meromorphic-functions}
Let $(X, \mathcal{O}_X)$ be a locally ringed space.
The {\it sheaf of meromorphic functions on $X$} is
the sheaf {\it $\mathcal{K}_X$} associated to the presheaf
displayed above. A {\it meromorphic function} on $X$
is a global section of $\mathcal{K}_X$.
\end{definition}

\noindent
Since each element of each $\mathcal{S}(U)$ is a nonzero divisor on
$\mathcal{O}_X(U)$ we see that the natural map of sheaves
of rings $\mathcal{O}_X \to \mathcal{K}_X$ is injective.

\begin{example}
\label{example-no-change}
Let $A = \mathbf{C}[x, \{y_\alpha\}_{\alpha \in \mathbf{C}}]/
((x - \alpha)y_\alpha, y_\alpha y_\beta)$. Any element of $A$
can be written uniquely as
$f(x) + \sum \lambda_\alpha y_\alpha$ with $f(x) \in \mathbf{C}[x]$
and $\lambda_\alpha \in \mathbf{C}$.
Let $X = \text{Spec}(A)$.
In this case $\mathcal{O}_X = \mathcal{K}_X$, since on
any affine open $D(f)$ the ring $A_f$ any nonzero divisor is
a unit (proof omitted).
\end{example}

\noindent
Let $(X, \mathcal{O}_X)$ be a locally ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
Consider the presheaf $U \mapsto \mathcal{S}(U)^{-1}\mathcal{F}(U)$.
Its sheafification is the sheaf
$\mathcal{K}_X(\mathcal{F}) =
\mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{K}_X$, see
Modules, Lemma \ref{modules-lemma-simple-invert-module}.

\begin{definition}
\label{definition-meromorphic-section}
Let $X$ be a locally ringed space.
\begin{enumerate}
\item Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
A {\it meromorphic section of $\mathcal{F}$}
is a global section of $\mathcal{F} \otimes_{\mathcal{O}_X} \mathcal{K}_X$.
\item Let $\mathcal{L}$ be an invertible $\mathcal{O}_X$-module.
A meromorphic section $s$ of $\mathcal{L}$ is said to be {\it regular}
if the induced map
$\mathcal{K}_X \to \mathcal{L}\otimes_{\mathcal{O}_X}\mathcal{K}_X$
is injective. (In other words, this means that $s$ is a regular
section of the $\mathcal{K}_X$-module
$\mathcal{L}\otimes_{\mathcal{O}_X}\mathcal{K}_X$. See
Definiton \ref{definition-regular-section}.)
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-meromorphic-functions-integral-scheme}
Let $X$ be an integral scheme.
In this case the sheaf of meromorphic functions is
isomorphic to the constant sheaf with value the
function field (see
Morphisms, Definition \ref{morphisms-definition-function-field})
of $X$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

























\input{chapters}

\bibliography{my}
\bibliographystyle{alpha}

\end{document}
