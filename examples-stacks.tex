\input{preamble}

% OK, start here.
%
\begin{document}

\title{Examples of Stacks}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
This is a discussion of examples of stacks in algebraic geometry.
Some of them are algebraic stacks, some are not.
We will discuss which are algebraic stacks in a later chapter.
This means that in this chapter we mainly worry about the descent
conditions. See \cite{Vis2} for example.




\section{Notation}
\label{section-notation}

\noindent
In this chapter we fix a suitable big fppf site $\textit{Sch}_{fppf}$
as in Topologies, Definition \ref{topologies-definition-big-fppf-site}.
So, if not explicitly stated otherwise all schemes will be objects
of $\textit{Sch}_{fppf}$.
We will always work relative to a base $S$ contained in $\textit{Sch}_{fppf}$.
And we will then work with the big fppf site $(\textit{Sch}/S)_{fppf}$,
see Topologies, Definition \ref{topologies-definition-big-small-fppf}.
The absolute case can be recovered by taking
$S = \text{Spec}(\mathbf{Z})$.
 



\section{Examples of stacks}
\label{section-examples-stacks}

\noindent
We first give some important examples of stacks over
$(\textit{Sch}/S)_{fppf}$.





\section{Quasi-coherent sheaves}
\label{section-stack-of-quasi-coherent-sheaves}

\noindent
We define a category $\textit{QCoh}$ as follows:
\begin{enumerate}
\item An object of $\textit{QCoh}$ is a pair $(X, \mathcal{F})$,
where $X/S$ is an object of $(\textit{Sch}/S)_{fppf}$, and $\mathcal{F}$
is a quasi-coherent $\mathcal{O}_X$-module, and
\item a morphism $(f, \varphi) : (Y, \mathcal{G}) \to (X, \mathcal{F})$
is a pair consisting of a morphism $f : Y \to X$ of schemes over $S$
and an $f$-map (see
Sheaves, Section \ref{sheaves-section-ringed-spaces-functoriality-modules})
$\varphi : \mathcal{F} \to \mathcal{G}$.
\item The composition of morphisms
$$
(Z, \mathcal{H}) \xrightarrow{(g, \psi)}
(Y, \mathcal{G}) \xrightarrow{(f, \phi)} (X, \mathcal{F})
$$
is $(f \circ g, \psi \circ \phi)$ where $\psi \circ \phi$ is
the composition of $f$-maps.
\end{enumerate}
Thus $\textit{QCoh}$ is a category and
$$
p : \textit{QCoh} \to (\textit{Sch}/S)_{fppf},
\quad
(X, \mathcal{F}) \mapsto X
$$
is a functor. Note that the fibre category of $\textit{QCoh}$ over
a scheme $X$ is just the category $\textit{QCoh}(X)$
of quasi-coherent $\mathcal{O}_X$-modules.
We remark for later use that given
$(X, \mathcal{F}), (Y, \mathcal{G}) \in \text{Ob}(\textit{QCoh})$
we have
\begin{equation}
\label{equation-morphisms-qcoh}
\text{Mor}_{\textit{QCoh}}((Y, \mathcal{G}), (X, \mathcal{F}))
=
\coprod\nolimits_{f \in \text{Mor}_S(Y, X)}
\text{Mor}_{\textit{QCoh}(Y)}(f^*\mathcal{F}, \mathcal{G})
\end{equation}
See the discussion on $f$-maps of modules in
Sheaves, Section \ref{sheaves-section-ringed-spaces-functoriality-modules}.

\medskip\noindent
The category $\textit{QCoh}$ is not a stack over $(\textit{Sch}/S)_{fppf}$
because its collection of objects is a proper class. On the other hand
we will see that it does satisfy all the axioms of a stack. We will
get around the set theoretical issue in
Section \ref{section-stack-of-finitely-generated-quasi-coherent-sheaves}.

\begin{lemma}
\label{lemma-quasi-coherent-strongly-cartesian}
A morphism $(f, \varphi) : (Y, \mathcal{G}) \to (X, \mathcal{F})$
of $\textit{QCoh}$ is strongly cartesian if and only if the
map $\varphi$ induces an isomorphism $f^*\mathcal{F} \to \mathcal{G}$.
\end{lemma}

\begin{proof}
Let $(X, \mathcal{F}) \in \text{Ob}(\textit{QCoh})$.
Let $f : Y \to X$ be a morphism of $(\textit{Sch}/S)_{fppf}$.
Note that there is a canonical $f$-map $c : \mathcal{F} \to f^*\mathcal{F}$
and hence we get a morphism
$(f, c) : (Y, f^*\mathcal{F}) \to (X, \mathcal{F})$.
We claim that $(f, c)$ is strongly cartesian.
Namely, for any object $(Z, \mathcal{H})$ of $\textit{QCoh}$ we have
\begin{align*}
\text{Mor}_{\textit{QCoh}}((Z, \mathcal{H}), (Y, f^*\mathcal{F}))
& =
\coprod\nolimits_{g \in \text{Mor}_S(Z, Y)}
\text{Mor}_{\textit{QCoh}(Z)}(g^*f^*\mathcal{F}, \mathcal{H}) \\
& =
\coprod\nolimits_{g \in \text{Mor}_S(Z, Y)}
\text{Mor}_{\textit{QCoh}(Z)}((f \circ g)^*\mathcal{F}, \mathcal{H}) \\
& =
\text{Mor}_{\textit{QCoh}}((Z, \mathcal{H}), (X, \mathcal{F}))
\times_{\text{Mor}_S(Z, X)} \text{Mor}_S(Z, Y)
\end{align*}
where we have used Equation (\ref{equation-morphisms-qcoh}) twice.
This proves that the condition of
Categories, Definition \ref{categories-definition-cartesian-over-C}
holds for $(f, c)$, and hence our claim is true. Now by
Categories, Lemma \ref{categories-lemma-composition-cartesian}
we see that isomorphisms are strongly cartesian and
compositions of strongly cartesian morphisms are strongly cartesian
which proves the ``if'' part of the lemma. For the converse, note
that given $(X, \mathcal{F})$ and $f : Y \to X$, if there exists a
strongly cartesian morphism lifting $f$ with target $(X, \mathcal{F})$
then it has to be isomorphic to $(f, c)$ (see discussion following
Categories, Definition \ref{categories-definition-cartesian-over-C}).
Hence the "only if" part of the lemma holds.
\end{proof}

\begin{lemma}
\label{lemma-stack-of-quasi-coherent-sheaves}
The functor $p : \textit{QCoh} \to (\textit{Sch}/S)_{fppf}$
satisfies conditions (1), (2) and (3) of
Stacks, Definition \ref{stacks-definition-stack}.
\end{lemma}

\begin{proof}
It is clear from
Lemma \ref{lemma-quasi-coherent-strongly-cartesian}
that $\textit{QCoh}$ is a fibred category over $(\textit{Sch}/S)_{fppf}$.
Given covering $\mathcal{U} = \{X_i \to X\}_{i \in I}$ of
$(\textit{Sch}/S)_{fppf}$ the functor
$$
\textit{QCoh}(T) \longrightarrow DD(\mathcal{U})
$$
is fully faithful and essentially surjective, see
Descent, Proposition \ref{descent-proposition-fpqc-descent-quasi-coherent}.
Hence
Stacks, Lemma \ref{stacks-lemma-stack-equivalences}
applies to show that $\textit{QCoh}$ satisfies all the
axioms of a stack.
\end{proof}





\section{The stack of finitely generated quasi-coherent sheaves}
\label{section-stack-of-finitely-generated-quasi-coherent-sheaves}

\noindent
It turns out that we can get a stack of quasi-coherent sheaves
if we only consider finite type quasi-coherent modules.
Let us denote
$$
p_{fg} : \textit{QCoh}_{fg} \to (\textit{Sch}/S)_{fppf}
$$
the full subcategory of $\textit{QCoh}$ over $(\textit{Sch}/S)_{fppf}$ 
consisting of pairs $(T, \mathcal{F})$ such that $\mathcal{F}$
is a quasi-coherent $\mathcal{O}_T$-module of finite type.

\begin{lemma}
\label{lemma-stack-of-finite-type-quasi-coherent-sheaves}
The functor $p_{fg} : \textit{QCoh}_{fg} \to (\textit{Sch}/S)_{fppf}$
satisfies conditions (1), (2) and (3) of
Stacks, Definition \ref{stacks-definition-stack}.
\end{lemma}

\begin{proof}
We will verify assumptions (1), (2), (3) of
Stacks, Lemma \ref{stacks-lemma-substack}
to prove this. By
Lemma \ref{lemma-quasi-coherent-strongly-cartesian}
a morphism $(Y, \mathcal{G}) \to (X, \mathcal{F})$ is
strongly cartesian if and only if it induces an isomorphism
$f^*\mathcal{F} \to \mathcal{G}$. By
Modules, Lemma \ref{modules-lemma-pullback-finite-type}
the pullback of a finite type $\mathcal{O}_X$-module is of finite
type. Hence assumption (1) of
Stacks, Lemma \ref{stacks-lemma-substack}
holds. Assumption (2) holds trivially.
Finally, to prove assumption (3) we have to show:
If $\mathcal{F}$ is a quasi-coherent $\mathcal{O}_X$-module
and $\{f_i : X_i \to X\}$ is an fppf covering such that each
$f_i^*\mathcal{F}$ is of finite type, then $\mathcal{F}$ is of
finite type. Considering the restriction of $\mathcal{F}$ to
an affine open of $X$ this reduces to the following algebra statement:
Suppose that $R \to S$ is a finitely presented, faithfully flat ring map
and $M$ an $R$-module. If $M \otimes_R S$ is a finitely generated
$S$-module, then $M$ is a finitely generated $R$-module.
A stronger form of the algebra fact can be found in
Algebra, Lemma \ref{algebra-lemma-descend-properties-modules}.
\end{proof}

\begin{lemma}
\label{lemma-finite-type}
Let $(X, \mathcal{O}_X)$ be a ringed space.
\begin{enumerate}
\item The category of finite type $\mathcal{O}_X$-modules has a
set of isomorphism classes.
\item The category of finite type quasi-coherent
$\mathcal{O}_X$-modules has a set of isomorphism classes.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (2) follows from part (1) as the category in (2) is a full subcategory
of the category in (1). Consider any open covering
$\mathcal{U} : X = \bigcup_{i \in I} U_i$. Denote $j_i : U_i \to X$
the inclusion maps. Consider any map $r : I \to \mathbf{N}$.
If $\mathcal{F}$ is an $\mathcal{O}_X$-module whose restriction to
$U_i$ is generated by at most $r(i)$ sections from $\mathcal{F}(U_i)$,
then $\mathcal{F}$ is a quotient of the sheaf
$$
\mathcal{H}_{\mathcal{U}, r} =
\bigoplus\nolimits_{i \in I} j_{i, !}\mathcal{O}_{U_i}^{\oplus r(i)}
$$
By definition, if $\mathcal{F}$ is of finite type, then there exists
some open covering with $\mathcal{U}$ whose index set is $I = X$
such that this condition is true. Hence it suffices to show that
there is a set of possible choices for $\mathcal{U}$ (obvious),
a set of possible choices for $r : I \to \mathbf{N}$ (obvious), and
a set of possible quotient modules of $\mathcal{H}_{\mathcal{U}, r}$
for each $\mathcal{U}$ and $r$. In other words, it suffices to show
that given an $\mathcal{O}_X$-module $\mathcal{H}$ there is at most
a set of isomorphism classes of quotients.
This last assertion becomes obvious
by thinking of the kernels of a quotient map
$\mathcal{H} \to \mathcal{F}$
as being parametrized by a subset of the power set of
$\prod_{U \subset X\text{ open}} \mathcal{H}(U)$.
\end{proof}

\begin{lemma}
\label{lemma-stack-fg-quasi-coherent}
There exists a subcategory
$\textit{QCoh}_{fg, small} \subset \textit{QCoh}_{fg}$
with the following properties:
\begin{enumerate}
\item the inclusion functor
$\textit{QCoh}_{fg, small} \to \textit{QCoh}_{fg}$ is
fully faithful and essentially surjective, and
\item the functor
$p_{fg, small} : \textit{QCoh}_{fg, small} \to (\textit{Sch}/S)_{fppf}$
turns $\textit{QCoh}_{fg, small}$ into a stack over $(\textit{Sch}/S)_{fppf}$.
\end{enumerate}
\end{lemma}

\begin{proof}
We have seen in
Lemmas \ref{lemma-stack-of-finite-type-quasi-coherent-sheaves} and
\ref{lemma-finite-type}
that $p_{fg} : \textit{QCoh}_{fg} \to (\textit{Sch}/S)_{fppf}$
satisfies (1), (2) and (3) of
Stacks, Definition \ref{stacks-definition-stack}
as well as the additional condition (4) of
Stacks, Remark \ref{stacks-remark-stack-make-small}.
Hence we obtain $\textit{QCoh}_{fg, small}$ from the discussion
in that remark.
\end{proof}

\noindent
We will often perform the replacement
$$
\textit{QCoh}_{fg} \leadsto \textit{QCoh}_{fg, small}
$$
without further remarking on it, and by abuse of notation we will
simply denote $\textit{QCoh}_{fg}$ this replacement.

\begin{remark}
\label{remark-higher-rank}
Note that the whole discussion in this section works
if we want to consider those
quasi-coherent sheaves which are locally generated by at most $\kappa$
sections, for some infinite cardinal $\kappa$, e.g., $\kappa = \aleph_0$.
\end{remark}




\section{Algebraic spaces}
\label{section-stack-of-spaces}

\noindent
We define a category $\textit{Spaces}$ as follows:
\begin{enumerate}
\item An object of $\textit{Spaces}$ is a morphism $X \to U$
of algebraic spaces over $S$, where $U$ is representable by an object of
$(\textit{Sch}/S)_{fppf}$, and
\item a morphism $(f, g) : (X \to U) \to (Y \to V)$
is a commutative diagram
$$
\xymatrix{
X \ar[d] \ar[r]_f & Y \ar[d] \\
U \ar[r]^g & V
}
$$
of morphisms of algebraic spaces over $S$.
\end{enumerate}
Thus $\textit{Spaces}$ is a category and
$$
p : \textit{Spaces} \to (\textit{Sch}/S)_{fppf},
\quad
(X \to U) \mapsto U
$$
is a functor. Note that the fibre category of $\textit{Spaces}$ over
a scheme $U$ is just the category $\textit{Spaces}/U$ of
algebraic spaces over $U$ (see
Topologies on Spaces, Section \ref{spaces-topologies-section-procedure}).
Hence we sometimes think of an object of $\textit{Spaces}$ as a
pair $X/U$ consisting of a scheme $U$ and an algebraic space $X$ over $U$.
We remark for later use that given
$(X/U), (Y/V) \in \text{Ob}(\textit{Spaces})$
we have
\begin{equation}
\label{equation-morphisms-spaces}
\text{Mor}_{\textit{Spaces}}(X/U, Y/V)
=
\coprod\nolimits_{g \in \text{Mor}_S(U, V)}
\text{Mor}_{\textit{Spaces}/U}(X, U \times_{g, V} Y)
\end{equation}
The category $\textit{Spaces}$ is almost, but not quite a stack
over $(\textit{Sch}/S)_{fppf}$. The problem is a set theoretical
issue as we will explain below.

\begin{lemma}
\label{lemma-spaces-strongly-cartesian}
A morphism $(f, g) : X/U \to Y/V$
of $\textit{Spaces}$ is strongly cartesian if and only if the
map $f$ induces an isomorphism $X \to U \times_{g, V} Y$.
\end{lemma}

\begin{proof}
Let $Y/V \in \text{Ob}(\textit{Spaces})$.
Let $g : U \to V$ be a morphism of $(\textit{Sch}/S)_{fppf}$.
Note that the projection $p : U \times_{g, V} Y \to Y$
gives rise a morphism
$(p, g) : U \times_{g, V} Y/U \to Y/V$ of $\textit{Spaces}$.
We claim that $(p, g)$ is strongly cartesian.
Namely, for any object $Z/W$ of $\textit{Spaces}$ we have
\begin{align*}
\text{Mor}_{\textit{Spaces}}(Z/W, U \times_{g, V} Y/U)
& =
\coprod\nolimits_{h \in \text{Mor}_S(W, U)}
\text{Mor}_{\textit{Spaces}/W}(Z, W \times_{h, U} U \times_{g, V} Y) \\
& =
\coprod\nolimits_{h \in \text{Mor}_S(W, U)}
\text{Mor}_{\textit{Spaces}/W}(Z, W \times_{g \circ h, V} Y) \\
& =
\text{Mor}_{\textit{Spaces}}(Z/W, Y/V)
\times_{\text{Mor}_S(W, V)} \text{Mor}_S(W, U)
\end{align*}
where we have used Equation (\ref{equation-morphisms-spaces}) twice.
This proves that the condition of
Categories, Definition \ref{categories-definition-cartesian-over-C}
holds for $(p, g)$, and hence our claim is true. Now by
Categories, Lemma \ref{categories-lemma-composition-cartesian}
we see that isomorphisms are strongly cartesian and
compositions of strongly cartesian morphisms are strongly cartesian
which proves the ``if'' part of the lemma. For the converse, note
that given $Y/V$ and $g : U \to V$, if there exists a
strongly cartesian morphism lifting $g$ with target $Y/V$
then it has to be isomorphic to $(p, g)$ (see discussion following
Categories, Definition \ref{categories-definition-cartesian-over-C}).
Hence the "only if" part of the lemma holds.
\end{proof}

\begin{lemma}
\label{lemma-pre-stack-of-spaces}
The functor $p : \textit{Spaces} \to (\textit{Sch}/S)_{fppf}$
satisfies conditions (1) and (2) of
Stacks, Definition \ref{stacks-definition-stack}.
\end{lemma}

\begin{proof}
It is follows from
Lemma \ref{lemma-spaces-strongly-cartesian}
that $\textit{Spaces}$ is a fibred category over $(\textit{Sch}/S)_{fppf}$
which proves (1).
Suppose that $\{U_i \to U\}_{i \in I}$ is a covering of
$(\textit{Sch}/S)_{fppf}$. Suppose that $X, Y$ are algebraic spaces over
$U$. Finally, suppose that $\varphi_i : X_{U_i} \to Y_{U_i}$ are morphisms
of $\textit{Spaces}/U_i$ such that $\varphi_i$ and $\varphi_j$ restrict
to the same morphisms $X_{U_i \times_U U_j} \to Y_{U_i \times_U U_j}$
of algebraic spaces over $U_i \times_U U_j$. 
To prove (2) we have to show that there exists a unique morphism
$\varphi  : X \to Y$ over $U$ whose base change to $U_i$ is
equal to $\varphi_i$. As a morphism from $X$ to $Y$ is the same thing
as a map of sheaves this follows directly from
Sites, Lemma \ref{sites-lemma-glue-maps}.
\end{proof}

\begin{remark}
\label{remark-stack-spaces}
Ignoring set theoretical difficulties\footnote{The difficulty is not
that $\textit{Spaces}$ is a proper class, since by our definition of
an algebraic space over $S$ there is only a set worth of isomorphism
classes of algebraic spaces over $S$. It is rather that arbitrary disjoint
unions of algebraic spaces may end up being too large, hence lie outside
of our chosen ``partial universe'' of sets.}
$\textit{Spaces}$ also satisfies
descent for objects and hence is a stack. Namely, we have to show that
given
\begin{enumerate}
\item an fppf covering $\{U_i \to U\}_{i \in I}$,
\item for each $i \in I$ an algebraic space $X_i/U_i$, and
\item for each $i, j \in I$ an isomorphism
$\varphi_{ij} : X_i \times_U U_j \to U_i \times_U X_j$ of algebraic spaces
over $U_i \times_U U_j$ satisfying the cocycle condition over
$U_i \times_U U_j \times_U U_k$,
\end{enumerate}
there exists an algebraic space $X/U$ and isomorphisms
$X_{U_i} \cong X_i$ over $U_i$ recovering the isomorphisms $\varphi_{ij}$.
First, note that by
Sites, Lemma \ref{sites-lemma-glue-sheaves}
there exists a sheaf $X$ on $(\textit{Sch}/U)_{fppf}$ recovering
the $X_i$ and the $\varphi_{ij}$. Then by
Bootstrap, Lemma \ref{bootstrap-lemma-locally-algebraic-space}
we see that $X$ is an algebraic space (if we ignore the set theoretic
condition of that lemma).
We will use this argument in the next section to show that
if we consider only algebraic spaces of finite type, then we obtain
a stack.
\end{remark}






\section{The stack of finite type algebraic spaces}
\label{section-stack-of-finite-type-spaces}


\noindent
It turns out that we can get a stack of spaces
if we only consider spaces of finite type.
Let us denote
$$
p_{ft} : \textit{Spaces}_{ft} \to (\textit{Sch}/S)_{fppf}
$$
the full subcategory of $\textit{Spaces}$ over $(\textit{Sch}/S)_{fppf}$ 
consisting of pairs $X/U$ such that $X \to U$
is a morphism of finite type.

\begin{lemma}
\label{lemma-stack-of-finite-type-spaces}
The functor
$p_{ft} : \textit{Spaces}_{ft} \to (\textit{Sch}/S)_{fppf}$
satisfies the conditions (1), (2) and (3) of
Stacks, Definition \ref{stacks-definition-stack}.
\end{lemma}

\begin{proof}
We are going to write this out in ridiculous detail (which may make
it hard to see what is going on).

\medskip\noindent
We have seen in
Lemma \ref{lemma-spaces-strongly-cartesian}
that a morphism $(f, g) : X/U \to Y/V$ of $\textit{Spaces}$ is
strongly cartesian if the induced morphism $f : X \to U \times_V Y$
is an isomorphism. Note that if $Y \to V$ is of finite type
then also $U \times_V Y \to U$ is of finite type, see
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-base-change-finite-type}.
So if $(f, g) : X/U \to Y/V$ of $\textit{Spaces}$ is
strongly cartesian in $\textit{Spaces}$ and $Y/V$ is an object
of $\textit{Spaces}_{ft}$ then automatically also $X/U$ is an
object of $\textit{Spaces}_{ft}$, and of course $(f, g)$ is
also strongly cartesian in $\textit{Spaces}_{ft}$. In this way
we conclude that $\textit{Spaces}_{ft}$ is a fibred category over
$(\textit{Sch}/S)_{fppf}$. This proves (1).

\medskip\noindent
The argument above also shows that the inclusion
functor $\textit{Spaces}_{ft} \to \textit{Spaces}$ transforms
strongly cartesian morphisms into strongly cartesian morphisms.
In other words $\textit{Spaces}_{ft} \to \textit{Spaces}$ is
a $1$-morphism of fibred categories over $(\textit{Sch}/S)_{fppf}$.

\medskip\noindent
Let $U \in \text{Ob}((\textit{Sch}/S)_{fppf})$.
Let $X, Y$ be algebraic spaces of finite type over $U$. By
Stacks, Lemma \ref{stacks-lemma-presheaf-mor-map-fibred-categories}
we obtain a map of presheaves
$$
\mathit{Mor}_{\textit{Spaces}_{ft}}(X, Y)
\longrightarrow
\mathit{Mor}_{\textit{Spaces}}(X, Y)
$$
which is an isomorphism as $\textit{Spaces}_{ft}$ is a full subcategory of
$\textit{Spaces}$. Hence the left hand side is a sheaf, because in
Lemma \ref{lemma-pre-stack-of-spaces}
we showed the right hand side is a sheaf. This proves (2).

\medskip\noindent
To prove condition (3) of
Stacks, Definition \ref{stacks-definition-stack}
we have to show the following: Given
\begin{enumerate}
\item a covering $\{U_i \to U\}_{i \in I}$ of $(\textit{Sch}/S)_{fppf}$,
\item for each $i \in I$ an algebraic space $X_i$ of finite type over $U_i$,
and
\item for each $i, j \in I$ an isomorphism
$\varphi_{ij} : X_i \times_U U_j \to U_i \times_U X_j$ of algebraic spaces
over $U_i \times_U U_j$ satisfying the cocycle condition over
$U_i \times_U U_j \times_U U_k$,
\end{enumerate}
there exists an algebraic space $X$ of finite type over $U$ and isomorphisms
$X_{U_i} \cong X_i$ over $U_i$ recovering the isomorphisms $\varphi_{ij}$. By
Sites, Lemma \ref{sites-lemma-glue-sheaves}
there exists a sheaf $X$ on $(\textit{Sch}/U)_{fppf}$ recovering
the $X_i$ and the $\varphi_{ij}$. Then by
Bootstrap, Lemma \ref{bootstrap-lemma-locally-algebraic-space-finite-type}
we see that $X$ is an algebraic space. By
Descent on Spaces, Lemma
\ref{spaces-descent-lemma-descending-property-locally-finite-presentation}
we see that $X \to U$ is of finite type which concludes the proof.
\end{proof}

\begin{lemma}
\label{lemma-stack-ft-spaces}
There exists a subcategory
$\textit{Spaces}_{ft, small} \subset \textit{Spaces}_{ft}$
with the following properties:
\begin{enumerate}
\item the inclusion functor
$\textit{Spaces}_{ft, small} \to \textit{Spaces}_{ft}$ is
fully faithful and essentially surjective, and
\item the functor
$p_{ft, small} : \textit{Spaces}_{ft, small} \to (\textit{Sch}/S)_{fppf}$
turns $\textit{Spaces}_{ft, small}$ into a stack over
$(\textit{Sch}/S)_{fppf}$.
\end{enumerate}
\end{lemma}

\begin{proof}
We have seen in
Lemmas \ref{lemma-stack-of-finite-type-spaces}
that $p_{fg} : \textit{QCoh}_{fg} \to (\textit{Sch}/S)_{fppf}$
satisfies (1), (2) and (3) of
Stacks, Definition \ref{stacks-definition-stack}.
The additional condition (4) of
Stacks, Remark \ref{stacks-remark-stack-make-small}
holds because every algebraic space $X$ over $S$ is of the
form $U/R$ for $U, R \in \text{Ob}((\textit{Sch}/S)_{fppf})$, see
Spaces, Lemma \ref{spaces-lemma-space-presentation}.
Thus there is only a set worth of isomorphism classes of objects.
Hence we obtain $\textit{Spaces}_{ft, small}$ from the discussion
in that remark.
\end{proof}

\noindent
We will often perform the replacement
$$
\textit{Spaces}_{ft} \leadsto \textit{Spaces}_{ft, small}
$$
without further remarking on it, and by abuse of notation we will
simply denote $\textit{Spaces}_{ft}$ this replacement.

\begin{remark}
\label{remark-higher-cardinality-spaces}
Note that the whole discussion in this section works
if we want to consider those algebraic spaces $X/U$ which are
locally of finite type such that the inverse image in $X$ of an affine open
of $U$ can be covered by countably many affines.
If needed we can also introduce the notion of a morphism of
$\kappa$-type (meaning some bound on the number of generators of
ring extensions and some bound on the cardinality of the affines over
a given affine in the base) where $\kappa$ is a cardinal, and then
we can produce a stack
$$
\textit{Spaces}_\kappa \longrightarrow (\textit{Sch}/S)_{fppf}
$$
in exactly the same manner as above (provided we make sure that
$\textit{Sch}$ is large enough depending on $\kappa$).
\end{remark}





\section{Examples of stacks in groupoids}
\label{section-examples-stacks-in-groupoids}

\noindent
The examples above are examples of stacks which are not stacks in
groupoids. In the rest of this chapter we give
algebraic geometric examples of stacks in groupoids.



\section{The stack associated to a sheaf}
\label{section-stack-associated-to-sheaf}

\noindent
Let $F : (\textit{Sch}/S)_{fppf}^{opp} \to \textit{Sets}$ be a presheaf.
We obtain a category fibred in sets
$$
p_F : \mathcal{S}_F \to (\textit{Sch}/S)_{fppf},
$$
see
Categories, Example \ref{categories-example-presheaf}.
This is a stack in sets if and only if $F$ is a sheaf, see
Stacks, Lemma \ref{stacks-lemma-stack-in-setoids-characterize}.



\section{The stack in groupoids of finitely generated quasi-coherent sheaves}
\label{section-stack-in-groupoids-of-quasi-coherent-sheaves}

\noindent
Let $p : \textit{QCoh}_{fg} \to (\textit{Sch}/S)_{fppf}$ be the stack
introduced in
Section \ref{section-stack-of-finitely-generated-quasi-coherent-sheaves}
(using the abuse of notation introduced there).
We can turn this into a stack in groupoids
$p' : \textit{QCoh}_{fg}' \to (\textit{Sch}/S)_{fppf}$ by
the procedure of
Categories, Lemma \ref{categories-lemma-fibred-gives-fibred-groupoids},
see
Stacks, Lemma \ref{stacks-lemma-stack-gives-stack-groupoids}.
In this particular case this simply means $\textit{QCoh}_{fg}'$ has
the same objects as $\textit{QCoh}_{fg}$ but the morphsms are
morphisms $(f, \varphi) : (T, \mathcal{F}) \to (T', \mathcal{F}')$
such that $\varphi$ induces an isomorphism $f^*\mathcal{F}' \to \mathcal{F}$.


\section{The stack in groupoids of finite type algebraic spaces}
\label{section-stack-in-groupoids-of-finite-type-spaces}

\noindent
Let $p : \textit{Spaces}_{ft} \to (\textit{Sch}/S)_{fppf}$ be the stack
introduced in
Section \ref{section-stack-of-finite-type-spaces}
(using the abuse of notation introduced there).
We can turn this into a stack in groupoids
$p' : \textit{Spaces}_{ft}' \to (\textit{Sch}/S)_{fppf}$ by
the procedure of
Categories, Lemma \ref{categories-lemma-fibred-gives-fibred-groupoids},
see
Stacks, Lemma \ref{stacks-lemma-stack-gives-stack-groupoids}.
In this particular case this simply means $\textit{Spaces}_{ft}'$
has the same objects as $\textit{Spaces}_{ft}$, i.e., finite type morphisms
$X \to U$ where $X$ is an algebraic space over $S$ and $U$ is a scheme
over $S$. But the morphsms $(f, g) : X/U \to Y/V$ are now
commutative diagrams
$$
\xymatrix{
X \ar[d] \ar[r]_f & Y \ar[d] \\
U \ar[r]^g & V
}
$$
which are cartesian.



\section{Quotient stacks}
\label{section-quotient-stacks}

\noindent
Let $(U, R, s, t, c)$ be a groupoid in algebraic spaces over $S$.
In this case the quotient stack
$$
[U/R] \longrightarrow (\textit{Sch}/S)_{fppf}
$$
is a stack in groupoids by construction, see
Groupoids in Spaces,
Definition \ref{spaces-groupoids-definition-quotient-stack}.
It is even the case that the $\mathit{Isom}$-sheaves are
representable by algebraic spaces, see
Bootstrap, Lemma \ref{bootstrap-lemma-quotient-stack-isom}.
These quotient stacks are of fundamental importance to the theory of
algebraic stacks.

\medskip\noindent
A special case of the construction above is the quotient stack
$$
[X/G] \longrightarrow (\textit{Sch}/S)_{fppf}
$$
associated to a datum $(B, G/B, m, X/B, a)$. Here
\begin{enumerate}
\item $B$ is an algebraic space over $S$,
\item $(G, m)$ is a group algebraic space over $B$,
\item $X$ is an algebraic space over $B$, and
\item $a : G \times_B X \to X$ is an action of $G$ on $X$ over $B$.
\end{enumerate}
Namely, by
Groupoids in Spaces,
Definition \ref{spaces-groupoids-definition-quotient-stack}
the stack in groupoids $[X/G]$ is the
quotient stack $[X/G \times_B X]$ given above. It behooves us to
spell out in more detail what an object of the category $[X/G]$ looks
like. We will do this below (insert future reference here).



\section{Classifying torsors}
\label{section-torsors}

\noindent
We want to carefully explain a number of variants of what it could
mean to study the stack of torsors for a group algebraic space $G$
or a sheaf of groups $\mathcal{G}$.



\subsection{Torsors for a sheaf of groups}
\label{subsection-torsors-sheaf}

\noindent
Let $\mathcal{G}$ be a sheaf of groups on $(\textit{Sch}/S)_{fppf}$.
For $U \in \text{Ob}((\textit{Sch}/S)_{fppf})$ we denote
$\mathcal{G}|_U$ the restriction of $\mathcal{G}$ to $(\textit{Sch}/U)_{fppf}$.
We define a category $\mathcal{G}\textit{-Torsors}$ as follows:
\begin{enumerate}
\item An object of $\mathcal{G}\textit{-Torsors}$ is a pair
$(U, \mathcal{F})$ where $U$ is an object of $(\textit{Sch}/S)_{fppf}$
and $\mathcal{F}$ is a $\mathcal{G}|_U$-torsor, see
Cohomology on Sites, Definition \ref{sites-cohomology-definition-torsor}.
\item A morphism $(U, \mathcal{F}) \to (V, \mathcal{H})$ is given
by a pair $(f, \alpha)$, where $f : U \to V$ is a morphism of schemes
over $S$, and $\alpha : f^{-1}\mathcal{H} \to \mathcal{F}$ is an
isomorphism of $\mathcal{G}|_U$-torsors.
\end{enumerate}
Thus $\mathcal{G}\textit{-Torsors}$ is a category and
$$
p : \mathcal{G}\textit{-Torsors} \longrightarrow (\textit{Sch}/S)_{fppf},
\quad
(U, \mathcal{F}) \longmapsto U
$$
is a functor. Note that the fibre category of $\mathcal{G}\textit{-Torsors}$
over $U$ is the category of $\mathcal{G}|_U$-torsors which is a groupoid.

\begin{lemma}
\label{lemma-torsors-sheaf-stack-in-groupoids}
Up to a replacement as in
Stacks, Remark \ref{stacks-remark-stack-make-small}
the functor
$$
p : \mathcal{G}\textit{-Torsors} \longrightarrow (\textit{Sch}/S)_{fppf}
$$
defines a stack in groupoids over $(\textit{Sch}/S)_{fppf}$.
\end{lemma}

\begin{proof}
The most difficult part of the proof is to show that
we have descent for objects.
Let $\{U_i \to U\}_{i \in I}$ be a covering of $(\textit{Sch}/S)_{fppf}$.
Suppose that for each $i$ we are given a $\mathcal{G}|_{U_i}$-torsor
$\mathcal{F}_i$, and for each $i, j \in I$ an isomorphism
$\varphi_{ij} :
\mathcal{F}_i|_{U_i \times_U U_j} \to \mathcal{F}_j|_{U_i \times_U U_j}$
of $\mathcal{G}|_{U_i \times_U U_j}$-torsors
satisfying a suitable cocycle condition on $U_i \times_U U_j \times_U U_k$.
Then by
Sites, Section \ref{sites-section-glueing-sheaves}
we obtain a sheaf $\mathcal{F}$ on $(\textit{Sch}/U)_{fppf}$
whose restriction to each $U_i$ recovers $\mathcal{F}_i$ as well
as recovering the descent data. By the equivalence of categories in
Sites, Lemma \ref{sites-lemma-mapping-property-glue}
the action maps $\mathcal{G}|_{U_i} \times \mathcal{F}_i \to \mathcal{F}_i$
glue to give a map $a : \mathcal{G}|_U \times \mathcal{F} \to \mathcal{F}$.
Now we have to show that $a$ is an action and that $\mathcal{F}$ becomes
a $\mathcal{G}|_U$-torsor. Both properties may be checked locally, and
hence follow from the corresponding properties of the actions
$\mathcal{G}|_{U_i} \times \mathcal{F}_i \to \mathcal{F}_i$.
This proves that descent for objects holds in
$\mathcal{G}\textit{-Torsors}$.
Some details omitted.
\end{proof}



\subsection{Variant on torsors for a sheaf}
\label{subsection-variant-torsor-sheaf}

\noindent
The construction of
Subsection \ref{subsection-torsors-sheaf}
can be generalized slightly.
Namely, let $\mathcal{G} \to \mathcal{B}$ be a map of sheaves
on $(\textit{Sch}/S)_{fppf}$ and let
$$
m :
\mathcal{G} \times_{\mathcal{B}} \mathcal{G} 
\longrightarrow
\mathcal{G}
$$
be a group law on $\mathcal{G}/\mathcal{B}$. In other words, the pair
$(\mathcal{G}, m)$ is a group object of the topos
$\textit{Sh}((\textit{Sch}/S)_{fppf})/\mathcal{B}$. See
Sites, Section \ref{sites-section-localize-topoi}
for information regarding localizations of topoi.
In this setting we can define a category
$\mathcal{G}/\mathcal{B}\textit{-Torsors}$ as follows
(where we use the Yoneda embedding to think of schemes as sheaves):
\begin{enumerate}
\item An object of $\mathcal{G}/\mathcal{B}\textit{-Torsors}$ is a triple
$(U, a, \mathcal{F})$ where
\begin{enumerate}
\item $U$ is an object of $(\textit{Sch}/S)_{fppf}$,
\item $a : U \to \mathcal{B}$ is a section of $\mathcal{B}$ over $U$, and
\item $\mathcal{F}$ is a $U \times_{a, \mathcal{B}}\mathcal{G}$-torsor
over $U$.
\end{enumerate}
\item A morphism $(U, a, \mathcal{F}) \to (V, b, \mathcal{H})$ is given
by a pair $(f, \alpha)$, where $f : U \to V$ is a morphism of schemes
over $S$ such that $a = b \circ f$, and
$\alpha : f^{-1}\mathcal{H} \to \mathcal{F}$ is an
isomorphism of $U \times_{a, \mathcal{B}} \mathcal{G}$-torsors.
\end{enumerate}
Thus $\mathcal{G}/\mathcal{B}\textit{-Torsors}$ is a category and
$$
p :
\mathcal{G}/\mathcal{B}\textit{-Torsors}
\longrightarrow
(\textit{Sch}/S)_{fppf},
\quad
(U, a, \mathcal{F}) \longmapsto U
$$
is a functor. Note that the fibre category of
$\mathcal{G}/\mathcal{B}\textit{-Torsors}$
over $U$ is the disjoint union over $a : U \to \mathcal{B}$
of the categories of $U \times_{a, \mathcal{B}} \mathcal{G}$-torsors,
hence is a groupoid.

\begin{lemma}
\label{lemma-variant-torsors-sheaf-stack-in-groupoids}
Up to a replacement as in
Stacks, Remark \ref{stacks-remark-stack-make-small}
the functor
$$
p :
\mathcal{G}/\mathcal{B}\textit{-Torsors}
\longrightarrow
(\textit{Sch}/S)_{fppf}
$$
defines a stack in groupoids over $(\textit{Sch}/S)_{fppf}$.
\end{lemma}

\begin{proof}
This proof is a repeat of the proof of
Lemma \ref{lemma-torsors-sheaf-stack-in-groupoids}.
The reader is encouraged to read that proof first since
the notation is less cumbersome.
The most difficult part of the proof is to show that
we have descent for objects. Let $\{U_i \to U\}_{i \in I}$
be a covering of $(\textit{Sch}/S)_{fppf}$.
Suppose that for each $i$ we are given a pair $(a_i, \mathcal{F}_i)$
consisting of a morphism $a_i : U_i \to \mathcal{B}$ and a
$U_i \times_{a_i, \mathcal{B}} \mathcal{G}$-torsor
$\mathcal{F}_i$, and for each $i, j \in I$
we have $a_i|_{U_i \times_U U_j} = a_j|_{U_i \times_U U_j}$ and
we are given an isomorphism
$\varphi_{ij} :
\mathcal{F}_i|_{U_i \times_U U_j} \to \mathcal{F}_j|_{U_i \times_U U_j}$
of $(U_i \times_U U_j) \times_{\mathcal{B}} \mathcal{G}$-torsors
satisfying a suitable cocycle condition on $U_i \times_U U_j \times_U U_k$.
Then by
Sites, Section \ref{sites-section-glueing-sheaves}
we obtain a sheaf $\mathcal{F}$ on $(\textit{Sch}/U)_{fppf}$
whose restriction to each $U_i$ recovers $\mathcal{F}_i$ as well
as recovering the descent data. By the sheaf axiom for $\mathcal{B}$
the morphisms $a_i$ come from a unique morphism $a : U \to \mathcal{B}$.
By the equivalence of categories in
Sites, Lemma \ref{sites-lemma-mapping-property-glue}
the action maps
$(U_i \times_{a_i, \mathcal{B}} \mathcal{G}) \times_{U_i} \mathcal{F}_i
\to \mathcal{F}_i$
glue to give a map
$(U \times_{a, \mathcal{B}} \mathcal{G}) \times \mathcal{F} \to \mathcal{F}$.
Now we have to show that this is an action and that $\mathcal{F}$ becomes
a $U \times_{a, \mathcal{B}} \mathcal{G}$-torsor.
Both properties may be checked locally, and
hence follow from the corresponding properties of the actions
on the $\mathcal{F}_i$.
This proves that descent for objects holds in
$\mathcal{G}/\mathcal{B}\textit{-Torsors}$.
Some details omitted.
\end{proof}



\subsection{Principal homogeneous spaces}
\label{subsection-principal-homogeneous-spaces}

\noindent
Let $B$ be an algebraic space over $S$.
Let $G$ be a group algebraic space over $B$.
We define a category $G\textit{-Principal}$ as follows:
\begin{enumerate}
\item An object of $G\textit{-Principal}$ is a triple
$(U, a, X)$ where $U$ is an object of $(\textit{Sch}/S)_{fppf}$
and $a : U \to B$ is a morphism over $S$, and
$X$ is a principal homogeneous $G_U$-space over $U$, see
Groupoids in Spaces,
Definition \ref{spaces-groupoids-definition-principal-homogeneous-space}.
\item A morphism $(U, a, X) \to (V, b, Y)$ is given
by a pair $(f, g)$, where $f : U \to V$ is a morphism of schemes
over $B$, and $g : X \to U \times_{f, V} Y$ is an
isomorphism of principal homogeneous $G_U$-spaces.
\end{enumerate}
Thus $G\textit{-Principal}$ is a category and
$$
p : G\textit{-Principal} \longrightarrow (\textit{Sch}/S)_{fppf},
\quad
(U, a, X) \longmapsto U
$$
is a functor. Note that the fibre category of $G\textit{-Principal}$
over $U$ is the disjoint union over $a : U \to B$
of the categories of principal homogeneous $U \times_{a, B} G$-spaces,
hence is a groupoid.

\medskip\noindent
In the special case $S = B$ the objects are simply pairs
$(U, X)$ where $U$ is a scheme over $S$, and $X$ is a principal homogeneous
$G_U$-space over $U$. Moreover, morphisms are simply cartesian
diagrams
$$
\xymatrix{
X \ar[d] \ar[r]_g & Y \ar[d] \\
U \ar[r]^f & V
}
$$
where $g$ is $G$-equivariant.

\begin{remark}
\label{remark-principal-stack-in-groupoids}
We conjecture that up to a replacement as in
Stacks, Remark \ref{stacks-remark-stack-make-small}
the functor
$$
p : G\textit{-Principal} \longrightarrow (\textit{Sch}/S)_{fppf}
$$
defines a stack in groupoids over $(\textit{Sch}/S)_{fppf}$. This would
follow if one could show that given
\begin{enumerate}
\item a covering $\{U_i \to U\}_{i \in I}$ of $(\textit{Sch}/S)_{fppf}$,
\item an group algebraic space $H$ over $U$,
\item for every $i$ a principal homogeneous $H_{U_i}$-space $X_i$
over $U_i$, and
\item $H$-equivariant isomorphisms
$\varphi_{ij} : X_{i, U_i \times_U U_j} \to X_{j, U_i \times_U U_j}$
satisfying the cocycle condition,
\end{enumerate}
there exists a principal homogeneous $H$-space $X$ over $U$
which recovers $(X_i, \varphi_{ij})$. The technique of the proof of
Bootstrap, Lemma \ref{bootstrap-lemma-descent-torsor}
reduces this to a set theoretical question, so the reader who ignores
set theoretical questions will ``know'' that the result is true. In
\url{http://math.columbia.edu/~dejong/wordpress/?p=591}
there is a suggestion as to how to approach this problem.
\end{remark}



\subsection{Variant on principal homogeneous spaces}
\label{subsection-variant-principal-homogeneous-spaces}

\noindent
Let $S$ be a scheme. Let $B = S$.
Let $G$ be a group scheme over $B = S$.
In this setting we can define a full subcategory
$G\textit{-Principal-Schemes} \subset G\textit{-Principal}$
whose objects are pairs $(U, X)$ where $U$ is an object of
$(\textit{Sch}/S)_{fppf}$ and $X \to U$ is a principal homogeneous
$G$-space over $U$ which is representable, i.e., a scheme.

\medskip\noindent
It is in general not the case that $G\textit{-Principal-Schemes}$ is
a stack in groupoids over $(\textit{Sch}/S)_{fppf}$. The reason is
that in general there really do exist principal homogeneous spaces
which are not schemes, hence descent for objects will not be satisfied
in general.



\subsection{Torsors in fppf topology}
\label{subsection-fppf-torsors}

\noindent
Let $B$ be an algebraic space over $S$.
Let $G$ be a group algebraic space over $B$.
We define a category $G\textit{-Torsors}$ as follows:
\begin{enumerate}
\item An object of $G\textit{-Torsors}$ is a triple
$(U, a, X)$ where $U$ is an object of $(\textit{Sch}/S)_{fppf}$
and $a : U \to B$ is a morphism, and
$X$ is an fppf $G_U$-torsor over $U$, see
Groupoids in Spaces,
Definition \ref{spaces-groupoids-definition-principal-homogeneous-space}.
\item A morphism $(U, a, X) \to (V, b, Y)$ is given
by a pair $(f, g)$, where $f : U \to V$ is a morphism of schemes
over $B$, and $g : X \to U \times_{f, V} Y$ is an
isomorphism of $G_U$-torsors.
\end{enumerate}
Thus $G\textit{-Torsors}$ is a category and
$$
p : G\textit{-Torsors} \longrightarrow (\textit{Sch}/S)_{fppf},
\quad
(U, a, X) \longmapsto U
$$
is a functor. Note that the fibre category of $G\textit{-Torsors}$
over $U$ is the disjoint union over $a : U \to B$
of the categories of $U \times_{a, B} G$-torsors,
hence is a groupoid.

\medskip\noindent
In the special case $S = B$ the objects are simply pairs
$(U, X)$ where $U$ is a scheme over $S$, and $X$ is an fppf
$G_U$-torsor over $U$. Moreover, morphisms are simply cartesian
diagrams
$$
\xymatrix{
X \ar[d] \ar[r]_g & Y \ar[d] \\
U \ar[r]^f & V
}
$$
where $g$ is $G$-equivariant.

\begin{lemma}
\label{lemma-torsors-stack-in-groupoids}
Up to a replacement as in
Stacks, Remark \ref{stacks-remark-stack-make-small}
the functor
$$
p : G\textit{-Torsors} \longrightarrow (\textit{Sch}/S)_{fppf}
$$
defines a stack in groupoids over $(\textit{Sch}/S)_{fppf}$.
\end{lemma}

\begin{proof}
The most difficult part of the proof is to show that we have descent for
objects, which is
Bootstrap, Lemma \ref{bootstrap-lemma-descent-torsor}.
Some details omitted.
\end{proof}

\begin{lemma}
\label{lemma-compare-torsors}
Let $B$ be an algebraic space over $S$. Let $G$ be a group algebraic
space over $B$. Denote $\mathcal{G}$, resp.\ $\mathcal{B}$ the algebraic
space $G$, resp.\ $B$ seen as a sheaf on $(\textit{Sch}/S)_{fppf}$.
The functor
$$
G\textit{-Torsors} \longrightarrow \mathcal{G}/\mathcal{B}\textit{-Torsors}
$$
which associates to a triple $(U, a, X)$ the triple
$(U, a, \mathcal{X})$ where $\mathcal{X}$ is $X$ viewed as a sheaf
is an equivalence of stacks in groupoids over $(\textit{Sch}/S)_{fppf}$.
\end{lemma}

\begin{proof}
We will use the result of
Stacks, Lemma \ref{stacks-lemma-characterize-essentially-surjective-when-ff}
to prove this. The functor is fully faithful since the category of
algebraic spaces over $S$ is a full subcategory of the category of
sheaves on $(\textit{Sch}/S)_{fppf}$.
Moreover, all objects (on both sides) are locally trivial torsors
so condition (2) of the lemma referenced above holds.
Hence the functor is an equivalence.
\end{proof}



\subsection{Variant on torsors in fppf topology}
\label{subsection-variant-fppf-torsors}

\noindent
Let $S$ be a scheme. Let $B = S$.
Let $G$ be a group scheme over $B = S$.
In this setting we can define a full subcategory
$G\textit{-Torsors-Schemes} \subset G\textit{-Torsors}$
whose objects are pairs $(U, X)$ where $U$ is an object of
$(\textit{Sch}/S)_{fppf}$ and $X \to U$ is an fppf
$G$-torsor over $U$ which is representable, i.e., a scheme.

\medskip\noindent
It is in general not the case that $G\textit{-Torsors-Schemes}$ is
a stack in groupoids over $(\textit{Sch}/S)_{fppf}$. The reason is
that in general there really do exist fppf $G$-torsors
which are not schemes, hence descent for objects will not be satisfied
in general.






\section{Quotients by group spaces}
\label{section-group-quotient-stacks}

\noindent
At this point we have introduced enough notation that we can work out
in more detail what the stacks $[X/G]$ of
Section \ref{section-quotient-stacks}
look like.

\begin{situation}
\label{situation-quotient-stack}
Here
\begin{enumerate}
\item $S$ is a scheme contained in $\textit{Sch}_{fppf}$,
\item $B$ is an algebraic space over $S$,
\item $(G, m)$ is a group algebraic space over $B$,
\item $X$ is an algebraic space over $B$, and
\item $a : G \times_B X \to X$ is an action of $G$ on $X$ over $B$.
\end{enumerate}
\end{situation}

\noindent
In this situation we construct a category $[[X/G]]$\footnote{The notation
$[[X/G]]$ with double brackets serves to distinguish this category from
the stack $[X/G]$ introduced earlier. Once we have shown that the two
are canonically equivalent we will use the notation $[X/G]$ to indicate
either.} as follows:
\begin{enumerate}
\item An object of $[[X/G]]$ consists of a quadruple
$(U, a, P, \varphi : P \to X)$ where
\begin{enumerate}
\item $U$ is an object of $(\textit{Sch}/S)_{fppf}$,
\item $a : U \to B$ is a morphism over $S$,
\item $P$ is an fppf $G_U$-torsor over $U$ where $G_U = U \times_{a, B} G$, and
\item $\varphi : P \to X$ is a $G$-equivariant morphism fitting
into the commutative diagram
$$
\xymatrix{
P \ar[d] \ar[r]_{\varphi} & X \ar[d] \\
U \ar[r]^a & B
}
$$
\end{enumerate}
\item A morphism of $[[X/G]]$ is a pair
$(f, g) : (U, a, P, \varphi) \to (U', a', P', \varphi')$
where $f : U \to U'$ is a morphism of schemes over $S$
and $g : P \to P'$ is a $G$-equivariant morphism over $f$
which induces an isomorphism $P \cong U \times_{f, U'} P'$, and has
the property that $\varphi = \varphi' \circ g$.
\end{enumerate}
In other words such a morphism fits into the following huge commutative
diagram


\begin{example}
\label{example-X-mod-G-groupscheme}
Let $S$ be a scheme.
Let $G \to S$ be a group scheme over $S$.
Assume that $G \to S$ is affine.
Let $X \to S$ be a scheme over $S$.
Let $a : G \times_S X \to X$
be an action of $G$ on $X$ over $S$.
The {\it quotient stack} $[X/G]$ is defined as follows.
\begin{enumerate}
\item An object of $[X/G]$ consists of a triple
$(T \to S, P \to T, \varphi : P \to X)$ where
\begin{enumerate}
\item $T \to S$ is a scheme over $S$,
\item $P \to T$ is a $G_T$-torsor in fppf topology
over $T$, and
\item $\varphi : P \to X$ is a $G$-equivariant morphism of schemes.
\end{enumerate}
\item A morphism
$(h, f) : (T/S, P/T, \varphi) \to (T'/S, P'/T', \varphi')$
is given by a morphism of schemes $f : T \to T'$ and a $G$-equivariant
morphism $h : P \to P'$ over $f$ which induces an isomorphism
$P \cong T \times_{T'} P'$, and such that $\varphi = \varphi' \circ h$.
\item the functor $[X/G] \to (\textit{Sch}/S)_{fppf}$ is the forgetful
functor $(T/S, P/T, \varphi) \mapsto T/S$.
\end{enumerate}
It is not so hard to verify that this is a fibred category. (Omitted.)
This is a stack in groupoids for the fppf topology. We omit the proof.
The hardest part is to show descent for objects. To do this one shows that
a torsor for an affine group scheme is affine over its base (insert future
reference here), and we have descent for affine schemes over schemes (see
Descent, Lemma \ref{descent-lemma-affine}).
\end{example}

\noindent
The following example is almost, but not quite the same.
The difference is that in the example above $G$ is an affine group scheme
over $S$, and in the example below $G$ is an abstract group.
The key to the examples is that in both cases all
$\underline{G}$-torsors on $(\textit{Sch}/S)_{fppf}$ are representable.

\begin{example}
\label{example-X-mod-G-group}
Let $S$ be a scheme.
Let $G$ be a group.
Let $X \to S$ be a scheme over $S$.
Let $a : G \times X \to X$ be an action of $G$ on $X$ over $S$.
The stack $[X/G]$ is defined as follows.
\begin{enumerate}
\item An object of $[X/G]$ consists of a triple
$(T \to S, P \to T, \varphi : P \to X)$ where
\begin{enumerate}
\item $T \to S$ is a scheme over $S$,
\item $P \to T$ is a $G_T$-torsor over $T$ in the fppf topology, and
\item $\varphi : P \to X$ is a $G$-equivariant morphism of schemes.
\end{enumerate}
\item A morphism
$(h, f) : (T/S, P/T, \varphi) \to (T'/S, P'/T', \varphi')$
is given by a morphism of schemes $f : T \to T'$ and a $G$-equivariant
morphism $h : P \to P'$ over $f$ which induces an isomorphism
$P \cong T \times_{T'} P'$, and such that $\varphi = \varphi' \circ h$.
\item the functor $[X/G] \to (\textit{Sch}/S)_{fppf}$ is the forgetful
functor $(T/S, P/T, \varphi) \mapsto T/S$.
\end{enumerate}
It is not so hard to verify that this is a fibred category. (Omitted.)
This is a stack in groupoids for the fppf topology. We omit the proof.
The hardest part is to show descent for objects.
To do this, note that a torsor for an abstract group
is a separated and etale scheme over its base, and by
More on Morphisms, Lemma
\ref{more-morphisms-lemma-separated-locally-quasi-finite-morphisms-fppf-descend}
we have descent for separated and locally quasi-finite schemes over schemes.
\end{example}



\section{Picard stacks}
\label{section-picard-stack}

\noindent
Let $f : X \to S$ be a morphism of schemes.
The {\it Picard stack} $\textit{Pic}_{X/S}$ is defined as follows
\begin{enumerate}
\item An object is a pair $(T/S, \mathcal{L})$, where $T/S$ is a
scheme over $S$ and $\mathcal{L}$ is in invertible sheaf on
the base change $X_T$,
\item a morphism $(f, \alpha) : (T/S, \mathcal{L}) \to (T'/S, \mathcal{L}')$
is given by a morphism of schemes $f : T \to T'$ over $S$ and an
isomorphism $\alpha : f^*\mathcal{L}' \to \mathcal{L}$, and
\item the structure functor $\textit{Pic}_{X/S} \to (\textit{Sch}/S)_{fppf}$
is given by the forgetful functor $(T/S, \mathcal{L}) \mapsto T/S$.
\end{enumerate}
It is not hard to verify that this is a fibred category (omitted).
In fact it is a stack in groupoids for the fppf topology.
As usual, the hardest part is to show descent for objects.
But, if $\{T_i \to T\}$ is an fppf covering for $T$, then the
pullbacks $\{X_{T_i} \to X_T\}$ form an fppf covering as well.
Hence given invertible sheaves $\mathcal{L}_i$ on the schemes
$X_{T_i}$ and isomorphisms between their pullbacks over the schemes
$$
X_{T_i \times_T T_j} = X_{T_i} \times_{X_T} X_{T_i}
$$
satisfying a suitable cocycle condition we can descend the
$\mathcal{L}_i$ to an invertible sheaf $\mathcal{L}$ over $X_T$ using
Descent, Proposition \ref{descent-proposition-fpqc-descent-quasi-coherent}. 
Details omitted.


\section{Examples of inertia stacks}
\label{section-examples-inertia}

\noindent
Here are some examples of inertia stacks.

\begin{example}
\label{example-inertia-stack-of-X-mod-G}
Let $S$ be a scheme. Let $G$ be a commutative group.
Let $X \to S$ be a scheme over $S$.
Let $a : G \times X \to X$ be an action of $G$ on $X$.
For $g \in G$ we denote $g : X \to X$ the corresponding automorphism.
In this case the inertia stack of $[X/G]$
(see Example \ref{example-X-mod-G-group})
is given by
$$	
I_{[X/G]} = \coprod\nolimits_{g\in G} [X^g/G],
$$	
where, given an element $g$ of $G$, the symbol $X^g$ denotes the
scheme $X^g = \{x \in X \mid g(x) = x\}$. In a formula
$X^g$ is really the fibre
product
$$
X^g =  X \times_{(1, 1), X \times_S X, (g, 1)} X.
$$ 
Indeed, for any $S$-scheme $T$, a
$T$-point on the inertia stack of $[X/G]$ consists of a
triple $(P/T, \phi, \alpha)$ consisting of a $G$-torsor
$P\to T$ together with a $G$-equivariant isomorphism
$\phi : P \to X$, together
with an automorphism $\alpha$ of $P\to T$ over $T$ such that
$\phi \circ \alpha = \phi$.
Since $G$ is a sheaf of \emph{commutative} groups,
$\alpha$ is, locally in the fppf topology over $T$,
given by multiplication by some element $g$ of $G$.
The condition that $\phi \circ \alpha = \phi$ means that $\phi$
factors through the inclusion of $X^g$
in $X$, i.e., $\phi$ is obtained by composing that inclusion with a
morphism $P \to X^\gamma$.
The above discussion allows us to define a morphism of fibred categories
$I_{[X/G]} \to \coprod_{g\in G} [X^g/G]$ given on $T$-points by the discussion
above. We omit showing that this is an equivalence.
\end{example}

\begin{example}
\label{example-inertia-stack-of-picard}
Let $X\to S$ be a morphism of schemes.
Assume that for any $T \to S$ the base change $f_T : X_T \to T$
has the property that the map $\mathcal{O}_T \to f_{T, *}\mathcal{O}_{X_T}$
is an isomorphism. (This implies that $f$ is
{\it cohomologically flat in dimension $0$} (insert future reference here)
but is stronger.) Consider the Picard stack $\textit{Pic}_{X/S}$, see
Section \ref{section-picard-stack}.
The points of its inertia stack over an
$S$-scheme $T$ consist of pairs $(\mathcal{L}, \alpha)$
where $\mathcal{L}$ is a line bundle
on $X_T$ and $\alpha$ is an automorphism of that line bundle.
I.e., we can think of $\alpha$ as an element of
$H^0(X_T, \mathcal{O}_{X_T})^\times = H^0(T, \mathcal{O}_T^*)$
by our condition. Note that $H^0(T,\mathcal{O}_T^*) = \mathbf{G}_{m,S}(T)$,
see Groupoids, Example \ref{groupoids-example-multiplicative-group}.
Hence the inertia stack of $\textit{Pic}_{X/S}$ is
$$
I_{\textit{Pic}_{X/S}} = \mathbf{G}_{m,S} \times_S \textit{Pic}_{X/S}.
$$
as a stack over $(\textit{Sch}/S)_{fppf}$.
\end{example}

















\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
