\input{preamble}

% OK, start here.
%
\begin{document}

\title{Exercises}


\maketitle

\tableofcontents


\section{Sheaves}
\label{section-sheaves}

\begin{exercise}
Carefully prove that a map of sheaves of {\bf sets}
is an epimorphisms (in the category of sheaves of sets) if and only if the
induced maps on all the stalks are surjective.
\end{exercise}


\begin{exercise}
Let $f : X \to Y$ be a map of topological spaces.
Prove pushforward $f_\ast$ and pullback $f^{-1}$ for sheaves of {\bf sets}
form an adjoint pair of functors.
\end{exercise}

\begin{exercise}
Let $j : U \to X$ be an open immersion. Show
that $j^{-1}$ has a left adjoint $j_{!}$ on the category of sheaves
of sets. Characterize the stalks of $j_{!}({\mathcal G})$. (Hint: $j_{!}$
is called extension by zero when you do this for abelian sheaves... )
\end{exercise}

\begin{exercise}
Let ${\mathcal F}$ be an abelian sheaf on $X$. Show
that ${\mathcal F}$ is the quotient of a (possibly very large) direct sum
of sheaves all of whose terms are of the form
$$
j_{!}(\underline{{\mathbf Z}}_U)
$$
where $U \subset X$ is open and $\underline{{\mathbf Z}}_U$ denotes the
constant sheaf with value ${\mathbf Z}$ on $U$.
\end{exercise}

\begin{remark}
In the category of abelian sheaves the direct sum of
a family of sheaves $\{{\mathcal F}_i\}_{i\in I}$ is the sheaf associated to
the presheaf $U \mapsto \oplus {\mathcal F}_i(U)$. Consequently the stalk of
the direct sum at a point $x$ is the direct sum of the stalks of the 
${\mathcal F}_i$ at $x$.
\end{remark}

\section{Schemes}
\label{section-schemes}

\noindent
Let ${\mathcal C}$ be the category of locally ringed spaces.
An affine scheme is an object in ${\mathcal C}$ isomorphic in ${\mathcal C}$ to
a pair of the form $(\text{Spec} A, {\mathcal O}_A)$. A scheme is an
object $(X, {\mathcal O}_X)$ of ${\mathcal C}$ such that every point $x\in X$ 
has an open neighbourhood $U \subset X$ such that the pair
$(U, {\mathcal O}_X|_U)$ is an affine scheme.

\begin{exercise}
Suppose that $X$ is a scheme whose underlying 
topological space has 2 points. Show that $X$ is an affine scheme.
\end{exercise}

\begin{remark}
When $(X, {\mathcal O}_X)$ is a ringed space and $U \subset X$
is an open subset then $(U, {\mathcal O}_X|_U)$ is a ringed space. Notation:
${\mathcal O}_U = {\mathcal O}_X|_U$. There is a canonical morphisms
of ringed spaces
$$
	j : (U, {\mathcal O}_U) \longrightarrow (X, {\mathcal O}_X).
$$
If $(X, {\mathcal O}_X)$ is a locally ringed space, so is
$(U, {\mathcal O}_U)$ and
$j$ is a morphism of locally ringed spaces. If $(X, {\mathcal O}_X)$
is a scheme
so is $(U, {\mathcal O}_U)$ and $j$ is a morphism of schemes. We say
that
$(U, {\mathcal O}_U)$ is an {\it open subscheme} of $(X, {\mathcal O}_X)$
and that
$j$ is an {\it open immersion}. More generally, any morphism
$j' : (V, {\mathcal O}_V) \to (X, {\mathcal O}_X)$ that is {\it isomorphic}
to a
morphism $j : (U, {\mathcal O}_U) \to (X, {\mathcal O}_X)$ as above is
called an
open immersion.
\end{remark}

\begin{exercise}
Give an example of an affine scheme $(X, {\mathcal O}_X)$
and an open $U \subset X$ such that $(U, {\mathcal O}_X|U)$ is not an affine
scheme.
\end{exercise}

\begin{exercise}
Given an example of a pair of affine schemes
$(X, {\mathcal O}_X)$, $(Y, {\mathcal O}_Y)$,
an open subscheme $(U, {\mathcal O}_X|_U)$
of $X$ and a morphism of schemes
$(U, {\mathcal O}_X|_U) \to (Y, {\mathcal O}_Y)$
that does not extend to a morphism of schemes
$(X, {\mathcal O}_X) \to (Y, {\mathcal O}_Y)$.
\end{exercise}

\begin{exercise}
Give an example of a scheme $X$, a field $K$, and a
morphism of ringed spaces $\text{Spec} K \to X$ which is NOT a morphism of schemes.
\end{exercise}

\begin{exercise}
Do all the exercises in Hartshorne, Chapter II,
Sections 1 and 2...\ \ Just kidding!
\end{exercise}


\begin{exercise}
Give an example of a morphism of {\it integral}
schemes $f : X \to Y$ such that the induced maps ${\mathcal O}_{Y,f(x)}
\to {\mathcal O}_{X,x}$ are surjective for all $x\in X$, but $f$
is not a closed immersion.
\end{exercise}

\begin{exercise}
Give examples of graded rings $S$ such that
\begin{enumerate}
\item $\text{Proj}(S)$ is affine and nonempty, and
\item $\text{Proj}(S)$ is integral, nonempty but not isomorphic
to ${\mathbf P}^n_A$ for any $n\geq 0$, any ring $A$.
\end{enumerate}
\end{exercise}

\begin{exercise}
Give an example of a nonconstant morphism
of schemes ${\mathbf P}^1_{\mathbf C} \to {\mathbf P}^5_{\mathbf C}$ over
$\text{Spec}({\mathbf C})$.
\end{exercise}

\begin{exercise}
Give an example of an isomorphism of schemes
$$
{\mathbf P}^1_{\mathbf C} \to
\text{Proj}({\mathbf C}[X_0,X_1,X_2]/(X_0^2+X_1^2+X_2^2))
$$
\end{exercise}

\begin{exercise}
Give an example of a morphism of schemes
$f : X \to {\mathbf A}^1_{\mathbf C}=\text{Spec}({\mathbf C}[T])$ such that the
(scheme theoretic) fibre of $f$ over $t \in {\mathbf A}^1_{\mathbf C}$ is (a)
isomorphic to ${\mathbf P}^1_{\mathbf C}$ when $t$ is a closed point not equal
to $0$, and (b) not isomorphic to ${\mathbf P}^1_{\mathbf C}$ when $t=0$. 
\end{exercise}

\begin{remark}
This can be done in many, many ways. Here are some additional restraints
you can impose: Can you do it with fibre at $t=0$ projective? Can you do it
with special fibre irreducible and projective? Can you do it with special
fibre integral and projective? Can you do it with fibre at $t=0$ smooth and
projective? What about similar questions when you replace
${\mathbf P}^1_{\mathbf C}$ with another variety over ${\mathbf C}$?
\end{remark}

\begin{exercise} (Pretty hard. You can leave some of the verifications
out if you like.) Give an example of a fibre product
$X\times_S Y$ such that $X$ and $Y$ are affine but $X\times_S Y$ is not.
\end{exercise}

\begin{remark}
It turns out this cannot happen with $S$ separated.
Do you know why?
\end{remark}

\begin{exercise}
Give an example of a scheme
$V$ which is integral 1-dimensional scheme of finite type
over ${\mathbf Q}$ such that $\text{Spec}{\mathbf C} \times_{\text{Spec}{\mathbf Q}} V$
is not integral.
\end{exercise}

\begin{exercise}
Give an example of a scheme
$V$ which is integral 1-dimensional scheme of finite type
over a field $k$ such that $\text{Spec} k' \times_{\text{Spec}{k}} V$
is not reduced for some finite field extension $k \subset k'$.
\end{exercise}

\begin{remark}
If your scheme is affine then dimension is the
same as the Krull dimension of the underlying ring. So you can
use last semesters results to compute dimension.
\end{remark}

\begin{exercise}
Give an example of a surjective morphism
$X \to {\mathbf P}^n_{\mathbf C}$ with $X$ affine.
\end{exercise}

\begin{exercise}
(For the number theorists.) Give an example 
of a closed subscheme
$$
Z \subset \text{Spec} {\mathbf Z}[x, \frac{1 }{ x(x-1)(2x-1)}]
$$
such that the morphism $Z \to \text{Spec} {\mathbf Z}$ is finite and surjective.
\end{exercise}

\begin{remark}
If you do not like number theory, you can try the 
variant where you look at
$$
\text{Spec} {\mathbf F}_p[t, x, \frac{1 }{ x(x-t)(tx-1)}]  \longrightarrow
\text{Spec} {\mathbf F}_p[t]
$$
and you try to find a closed subscheme of the top scheme
which maps finite surjectively to the bottom one. (There is a
theoretical reason for having a finite ground field here; allthough
it may not be necessary in this particular case.)
\end{remark}

\section{Invertible sheaves}
\label{section-invertible-sheaves}

\noindent
An invertible ${\mathcal O}_X$-module on a locally
ringed space $(X,{\mathcal O}_X)$
is a sheaf of ${\mathcal O}_X$-modules ${\mathcal L}$ such that every point
has an open neighbourhood $U \subset X$ such that ${\mathcal L}|_U$
is isomorphic to ${\mathcal O}_U$ as ${\mathcal O}_U$-module.
We say that ${\mathcal L}$ is trivial if it is isomorphic to 
${\mathcal O}_X$ as a ${\mathcal O}_X$-module.

\begin{exercise}
General facts.
\begin{enumerate}
\item Show that an invertible ${\mathcal O}_X$-module on 
a scheme $X$ is quasi-coherent.
\item Suppose $X\to Y$ is a morphism of ringed spaces,
and ${\mathcal L}$ an invertible ${\mathcal O}_Y$-module.
Show that $f^\ast {\mathcal L}$ is an invertible ${\mathcal O}_X$ module.
\end{enumerate}
\end{exercise}

\begin{exercise}
Algebra.
\begin{enumerate}
\item Show that an invertible ${\mathcal O}_X$-module on 
an affine scheme $\text{Spec} A$ corresponds to an $A$-module $M$ which is
(i) finite, (ii) projective, (iii) locally free of rank 1,
and hence (iv) flat, and (v) finitely presented. (Feel free to
quote things from last semesters course; or from algebra books.)
\item Suppose that $A$ is a domain and that $M$ is
a module as in (a). Show that $M$ is isomorphic as an $A$-module
to an ideal $I \subset A$ such that $IA_{\mathfrak p}$ is principal for
every prime ${\mathfrak p}$.
\end{enumerate}
\end{exercise}

\begin{exercise}
Simple examples.
\begin{enumerate}
\item Let $k$ be a field. Let $A = k[x]$.
Show that $X=\text{Spec} A$ has only trivial invertible ${\mathcal O}_X$-modules.
\item Let $A$ be the ring
$$
A = \{ f\in k[x] \mid f(0)=f(1) \}.
$$
Show that $X = \text{Spec} A$ has a nontrivial invertible ${\mathcal O}_X$-module,
unless $k={\mathbf F}_2$. (Hint: Think about $\text{Spec} A$ as identifying
$0$ and $1$ in ${\mathbf A}^1_k=\text{Spec} k[x]$.)
\item Same question for the ring $A = k[x^2,x^3] \subset
k[x]$ (except now $k = {\mathbf F}_2$ works as well).
\end{enumerate}
\end{exercise}

\begin{exercise}
Higher dimensions.
\begin{enumerate}
\item Prove that every invertible sheaf on two dimensional
affine space is trivial. More precisely, let 
${\mathbf A}^2_k = \text{Spec} k[x,y]$ where $k$ is a field.
Show that every invertible sheaf on ${\mathbf A}^2_k$ is trivial.
(Hint: One way to do this is to consider the corresponding
module $M$, to look at $M \otimes_{k[x,y]} k(x)[y]$, and
then use 3(a) to find a generator for this; then you still have to think.
Another way to is to use 2(b) and use what we know about ideals of the
polynomial ring: primes of height one are generated by an irreducible
polynomial; then you still have to think.)
\item Prove that every invertible sheaf on any open
subscheme of two dimensional affine space is trivial. More precisely, let 
$U \subset {\mathbf A}^2_k$ be an open subscheme where $k$ is a field.
Show that every invertible sheaf on $U$ is trivial. Hint: Show that every
invertible sheaf on $U$ extends to one on ${\mathbf A}^2_k$. Not easy;
but you can find it in Hartshorne.
\item Find an example of a nontrivial
invertible sheaf on a punctured cone over a field. More
precisely, let $k$ be a field and let $C = \text{Spec} k[x,y,z]/(xy-z^2)$.
Let $U = C \setminus \{ (x,y,z) \}$. Find a nontrivial
invertible sheaf on $U$. Hint: It may be easier to compute the
group of isomorphism classes of invertible sheaves on $U$ than to
just find one. Note that $U$ is covered by the opens 
$\text{Spec} k[x,y,z,1/x]/(xy-z^2) $ and $\text{Spec} k[x,y,z,1/y]/(xy-z^2)$
which are ``easy'' to deal with.
\end{enumerate}
\end{exercise}

\section{{\v C}ech Cohomology}
\label{section-cech-cohomology}

\begin{exercise}
{\v C}ech cohomology. Here $k$ is a field.
\begin{enumerate}
\item Let $X$ be a scheme with an open covering
${\mathcal U} : X = U_1 \cup U_2$, with $U_1 = \text{Spec} k[x]$, $U_2= \text{Spec} k[y]$
with $U_1 \cap U_2 = \text{Spec} k[z,1/z]$ and with open immersions
$U_1 \cap U_2 \to U_1$ resp.\ $U_1 \cap U_2 \to U_2$ determined
by $x \mapsto z$ resp.\ $y \mapsto z$ (and I really mean this).
(We've seen in the lectures that such an $X$ exists; it is the affine
line zith zero doubled.) Compute ${\mathaccent 20 H}^1({\mathcal U}, {\mathcal O})$;
eg.\ give a basis for it as a $k$-vectorspace.
\item For each element in
${\mathaccent 20 H}^1({\mathcal U}, {\mathcal O})$
construct an exact sequence of sheaves of ${\mathcal O}_X$-modules
$$
0 \to {\mathcal O}_X \to E \to {\mathcal O}_X \to 0
$$ 
such that the boundary $\delta(1) \in {\mathaccent 20 H}^1({\mathcal U}, {\mathcal O})$
equals the given element. (Part of the problem is to make sense of this.
See also below.
It is also OK to show abstractly such a thing has to exist.)
\end{enumerate}
\end{exercise}

\begin{definition}
(Definition of delta.) Suppose that 
$$
0 \to {\mathcal F}_1 \to {\mathcal F}_2 \to {\mathcal F}_3 \to 0
$$
is a short exact sequence of abelian sheaves on any topological space $X$.
The boundary map
$\delta : H^0(X, {\mathcal F}_3) \to {\mathaccent 20 H}^1(X, {\mathcal F}_1)$
is defined as follows. Take an element $\tau \in H^0(X, {\mathcal F}_3)$.
Choose an open covering ${\mathcal U} : X = \bigcup_{i\in I} U_i$ such
that for each $i$ there exists a section $\tilde \tau_i \in {\mathcal F}_2$
lifting the restriction of $\tau$ to $U_i$. Then consider the assignment
$$
(i_0, i_1) \longmapsto
\tilde \tau_{i_0}|_{U_{i_0i_1}} - \tilde \tau_{i_1}|_{U_{i_0i_1}}.
$$
This is clearly a 1-coboundary in the {\v C}ech complex
${\mathaccent 20 C}^\ast({\mathcal U}, {\mathcal F}_2)$. But we observe that
(thinking of ${\mathcal F}_1$ as a subsheaf of ${\mathcal F}_2$) the RHS
always is a section of ${\mathcal F}_1$ over $U_{i_0i_1}$. Hence we
see that the assignment defines a 1-cochain in the complex
${\mathaccent 20 C}^\ast({\mathcal U}, {\mathcal F}_2)$. The cohomology class of
this 1-cochain is by definition $\delta(\tau)$.
\end{definition}

\begin{exercise}
Algebra. (Silly and should be easy.)
\begin{enumerate}
\item Give an example of a ring $A$ and a nonsplit
short exact sequence of $A$-modules
$$
0 \to M_1 \to M_2 \to M_3 \to 0.
$$
\item Give an example of a nonsplit sequence of $A$-modules
as above and a faithfully flat $A \to B$ such that 
$$
0 \to M_1\otimes_AB \to M_2\otimes_AB \to M_3\otimes_AB \to 0.
$$
is split as a sequence of $B$-modules.
\end{enumerate}
\end{exercise}

\begin{exercise}
Maps of $\text{Proj}$. Let $R$ and $S$ be graded rings. So
$R = \oplus_{d \geq 0} R_d$ and $R_a \cdot R_b \subset R_{a+b}$.
Suppose we have a ring map
$$
\varphi : R \to S
$$
such that there exists an integer $e \geq 1$ such that
$\varphi( R_d ) \subset S_{de}$.
\begin{enumerate}
\item For which elements $\mathfrak p \in \text{Proj}(S)$ is
there a well-defined corresponding point in $\text{Proj}(R)$? In other words,
find a suitable open $U \subset \text{Proj}(S)$ such that $\varphi$ defines
a continuous map $\text{Proj}(\varphi) : U \to \text{Proj}(R)$.
\item Give an example where $U \not = \text{Proj}(S)$.
\item Give an example where $U = \text{Proj}(S)$.
\item (Do not write this down.) Convince yourself that 
the continuous map $U \to \text{Proj}(R)$ comes canonically with
a map on sheaves so that $\text{Proj}(\varphi)$ is a morphism of schemes:
$$
\text{Proj}(S) \supset U \longrightarrow \text{Proj}(R)
$$
\end{enumerate}
\end{exercise}

\noindent
{\bf Notation.} Let $R$ be a graded ring as above and
let $n \geq 0$ be an integer. Let $X = \text{Proj}(R)$. Then there is a unique
quasi-coherent ${\mathcal O}_X$-module ${\mathcal O}_X(n)$ on $X$ such that
for every homogeneous element $f \in R$ of positive degree we have
${\mathcal O}_X |_{D_{+}(f)}$ is the quasi-coherent sheaf associated to the
$R_{(f)} = (R_f)_0$-module $(R_f)_n$ ($=$elements homogenous of degree
$n$ in $R_f = R[1/f]$). See Hartshorne, page 116+. Note that there are
natural maps
$$
{\mathcal O}_X(n_1) \otimes_{{\mathcal O}_X} {\mathcal O}_X(n_2)
\longrightarrow
{\mathcal O}_X(n_1+n_2)
$$

\begin{exercise}
Pathologies in $\text{Proj}$. 
Give examples of $R$ as above such that
\begin{enumerate}
\item ${\mathcal O}_X(1)$ is not an invertible ${\mathcal O}_X$-module.
\item ${\mathcal O}_X(1)$ is invertible, but the
natural map ${\mathcal O}_X(1) \otimes_{{\mathcal O}_X} {\mathcal O}_X(1) \to
{\mathcal O}_X(2)$ is NOT an isomorphism.
\end{enumerate}
\end{exercise}

\section{Divisors}
\label{section-divisors}

\noindent
We collect all relevant definitions here in one spot for convenience.

\begin{definition}
Throughout, let $X$ be a Noetherian, integral and separated scheme.
\begin{enumerate}
\item A Weil divisor is a formal linear combination
$\Sigma n_i[Z_i]$ of prime divisors $Z_i$ with integer coefficients.
\item A prime divisor is a closed subscheme $Z \subset X$,
which is integral with generic point $\xi \in Z$ such that
${\mathcal O}_{X,\xi}$ has dimension $1$. We will use the notation 
${\mathcal O}_{X,Z} = {\mathcal O}_{X,\xi}$
when $\xi \in Z \subset X$ is as above. Note that ${\mathcal O}_{X,Z} \subset
K(X)$ is a subring of the function field of $X$.
\item The Weil divisor associated to a rational function
$f \in K(X)^\ast$ is the sum $\Sigma v_Z(f)[Z]$. Here $v_Z(f)$ is
defined as follows
\begin{enumerate}
\item If $f \in {\mathcal O}_{X,Z}^\ast$ then $v_Z(f)=0$.
\item If $f \in {\mathcal O}_{X,Z}$ then 
$$
v_Z(f)=\text{length}_{{\mathcal O}_{X,Z}}({\mathcal O}_{X,Z}/(f)).
$$
\item If $f = {a \over b}$ with $a,b \in {\mathcal O}_{X,Z}$
then 
$$
v_Z(f)=\text{length}_{{\mathcal O}_{X,Z}}({\mathcal O}_{X,Z}/(a)) -
\text{length}_{{\mathcal O}_{X,Z}}({\mathcal O}_{X,Z}/(b)).
$$
\end{enumerate}
\item An effective Cartier divisor on {\it any} scheme $S$
is a closed subscheme $D \subset S$ such that every point $d\in D$
has an affine open neighbourhood $\text{Spec} A = U \subset S$ in $S$
so that $D \cap U = \text{Spec} A/(f)$ with $f \in A$ a nonzero divisor.
\item The Weil divisor $[D]$ associated to an effective
Cartier divisor $D \subset X$ of our Noetherian integral separated
scheme $X$ is defined as the sum $\Sigma v_Z(D)[Z]$ where
$v_Z(D)$ is defined as follows
\begin{enumerate}
\item If the generic point $\xi$ of $Z$ is not in $D$
then $v_Z(D)=0$.
\item If the generic point $\xi$ of $Z$ is in $D$
then 
$$
v_Z(D)=\text{length}_{{\mathcal O}_{X,Z}}({\mathcal O}_{X,Z}/(f))
$$
where $f \in {\mathcal O}_{X,Z}={\mathcal O}_{X,\xi}$ is the nonzero divisor
which defines $D$ in an affine neighbourhood of $\xi$ (as in definition
{\bf (d)} above).
\end{enumerate}
\item Let $S$ be {\it any} scheme. The sheaf of total quotient
rings ${\mathcal K}_S$ is the sheaf of ${\mathcal O}_S$-algebras which is
the sheafification of the pre-sheaf ${\mathcal K}'$ defined as follows.
For $U \subset S$ open we set ${\mathcal K}'(U) = S_U^{-1}{\mathcal O}_S(U)$
where $S_U \subset {\mathcal O}_S(U)$ is the multiplicative subset
consisting of sections $f \in {\mathcal O}_S(U)$ such that the germ
of $f$ in ${\mathcal O}_{S,u}$ is a nonzero divisor for every $u\in U$.
In particular the elements of $S_U$ are all nonzero divisors.
Thus ${\mathcal O}_S$ is a subsheaf of ${\mathcal K}_S$, and we get a
short exact sequence
$$
0 \to {\mathcal O}_S^\ast \to {\mathcal K}_S^\ast \to
{\mathcal K}_S^\ast/{\mathcal O}_S^\ast \to 0.
$$
\item A Cartier divisor on {\it any} scheme $S$ is a global
section of the quotient sheaf ${\mathcal K}_S^\ast/{\mathcal O}_S^\ast$.
\item The Weil divisor associated to a Cartier divisor
$\tau \in \Gamma(X, {\mathcal K}_X^\ast/{\mathcal O}_X^\ast)$ over our 
Noetherian integral separated scheme
$X$ is the sum $\Sigma v_Z(\tau)[Z]$ where $v_Z(\tau)$ is defined
as by the following recipe
\begin{enumerate}
\item If the germ of $\tau$ at the generic point $\xi$
of $Z$ is zero -- in other words the image of $\tau$ in the stalk
$({\mathcal K}^\ast/{\mathcal O}^\ast)_\xi$ is ``zero'' -- then $v_Z(\tau)=0$.
\item Find an affine open neighbourhood $\text{Spec} A = U \subset X$
so that $\tau|_U$ is the image of a section $f \in {\mathcal K}(U)$
and moreover $f = a/b$ with $a,b \in A$. Then we set
$$
v_Z(f)=\text{length}_{{\mathcal O}_{X,Z}}({\mathcal O}_{X,Z}/(a)) -
\text{length}_{{\mathcal O}_{X,Z}}({\mathcal O}_{X,Z}/(b)).
$$
\end{enumerate}
\end{enumerate}
\end{definition}

\begin{remarks}
Here are some trivial remarks.
\begin{enumerate}
\item On a Noetherian integral separated scheme $X$ the 
sheaf ${\mathcal K}_X$ is constant with value the function field $K(X)$.
\item To make sense out of the definitions above one needs
to show that
$$
\text{length}_{\mathcal O}({\mathcal O}/(ab)) =
\text{length}_{\mathcal O}({\mathcal O}/(a)) +
\text{length}_{\mathcal O}({\mathcal O}/(b))
$$
for any pair $(a,b)$ of nonzero elements of a Noetherian 1-dimensional
local domain ${\mathcal O}$. This will be done in the lectures.
\end{enumerate}
\end{remarks}

\begin{exercise}
Describe how to assign a Cartier divisor
to an effective Cartier divisor.
\end{exercise}

\medskip\noindent
The following questions have some logical dependencies; if you point them
out then you won't have to do all of them.

\begin{exercise}
Give an example of a Weil divisor
(on a Noetherian integral separated scheme) which is not
the Weil divisor associated to a rational function.
\end{exercise}

\begin{exercise}
Give an example of a Weil divisor
(on a Noetherian integral separated scheme) which is not
the Weil divisor associated to any effective Cartier divisor.
\end{exercise}

\begin{exercise}
Give an example of a Weil divisor
(on a Noetherian integral separated scheme) which is not
the Weil divisor associated to any Cartier divisor.
\end{exercise}

\begin{exercise}
Give an example of a Weil divisor $D$
(on a Noetherian integral separated scheme) which is not
the Weil divisor associated to any Cartier divisor but
such that $nD$ is the Weil divisor associate to a Cartier
divisor for some $n>1$.
\end{exercise}

\begin{exercise}
Give an example of a Weil divisor $D$
(on a Noetherian integral separated scheme) which is not
the Weil divisor associated to any Cartier divisor and
such that $nD$ is NOT the Weil divisor associate to a Cartier
divisor for any $n>1$.
\end{exercise}

\begin{exercise}
Give an example of a Cartier divisor
which is not the difference of (the Cartier divisors associated
to) two effective Cartier divisors.
\end{exercise}

\section{Differentials}
\label{section-differentials}

\noindent
{\bf Definitions and results.} K\"ahler differentials.
\begin{enumerate}
\item Let $R \to A$ be a ring map. The module of K\"ahler
differentials of $A$ over $R$ is 
$$
\Omega^1_{A/R} = \bigoplus\nolimits_{a\in A} A \cdot {\rm d}a \Big/
\big\langle {\rm d}(a_1a_2)-a_1{\rm d}a_2-a_2{\rm d}a_1, {\rm d}r\big\rangle.
$$
The canonical universal $R$-derivation ${\rm d} : A \to \Omega^1_{A/R}$ 
maps $a\mapsto {\rm d}a$.
\item Consider the short exact sequence
$$
0 \to I \to A\otimes_R A \to A \to 0
$$
which defines the ideal $I$. There is a canonical derivation
${\rm d} : A \to I/I^2$ which maps $a$ to the class of
$a\otimes 1 - 1 \otimes a$. This is another presentation of
the module of derivations of $A$ over $R$, in other words
$$
(I/I^2, {\rm d}) \cong (\Omega^1_{A/R}, {\rm d}).
$$
\item For multiplicative subsets $S_R \subset R$ and
$S_A \subset A$ such that $S_R$ maps into $S_A$ we have
$$
\Omega^1_{S_A^{-1}A / S_R^{-1}R} =
S_A^{-1}\Omega^1_{A/R}.
$$
\item If $A$ is a finitely presented $R$-algebra then
$\Omega^1_{A/R}$ is a finitely presented $A$-module. Hence in
this case the {\it fitting} ideals of $\Omega^1_{A/R}$ are defined.
(See exercise set 6 of last semester.)
\item Let $f : X \to S$ be a morphism of schemes. There is
a quasi-coherent sheaf of ${\mathcal O}_X$-modules $\Omega^1_{X/S}$
and a ${\mathcal O}_S$-linear derivation 
$$
{\rm d} : {\mathcal O}_X \longrightarrow \Omega^1_{X/S}
$$
such that for any affine opens $\text{Spec} A \subset X$, $\text{Spec} R \subset S$
with $f(\text{Spec} A) \subset \text{Spec} R$ we have
$$
\Gamma(\text{Spec} A, \Omega^1_{X/S}) = \Omega^1_{A/R}
$$
compatibly with ${\rm d}$.
\end{enumerate}

\begin{exercise}
Let $k[\epsilon]$ be the ring of dual numbers
over the field $k$, i.e., $\epsilon^2=0$.
\begin{enumerate}
\item Consider the ring map
$$
R = k[\epsilon] \to A = k[x,\epsilon]/(\epsilon x)
$$
Show that the fitting ideals of $\Omega^1_{A/R}$ are (starting with the
zeroth fitting ideal)
$$
(\epsilon), A, A,\ldots
$$
\item Consider the map $R=k[t] \to 
A=k[x,y,t]/(x(y-t)(y-1),x(x-t))$. Show that the fitting ideals of
of $\Omega^1_{A/R}$ in $A$ are (assume characteristic $k$ is zero
for simplicity)
$$
x(2x-t)(2y-t-1)A,\ (x,y,t)\cap (x,y-1,t),\ A,\ A,\ldots
$$
So the $0$-the fitting ideal is cut out by a single element of $A$,
the $1$st fitting ideal defines two closed points of $\text{Spec} A$, and
the others are all trivial.
\item Consider the map $R=k[t] \to A=k[x,y,t]/(xy-t^n)$.
Compute the fitting ideals of $\Omega^1_{A/R}$.
\end{enumerate}
\end{exercise}

\begin{remark}
The $k$th fitting ideal of $\Omega^1_{X/S}$ is commonly used
to define the singular scheme of the morphism $X \to S$ when $X$ has relative
dimension $k$ over $S$. But as part (a) shows, you have to be careful doing
this when your family does not have ``constant'' fibre dimension, e.g., when 
it is not flat. As part (b) shows, flatness doesn't garantee it works either
(and yes this is a flat family). In ``good cases'' -- such as in (c) -- for
families of curves you expect the $0$-th fitting ideal to be zero and
the $1$st fitting ideal to define (scheme-theoretically) the singular locus.
\end{remark}

\begin{exercise}
Suppose that $R$ is a ring and 
$$
A = k[x_1,\ldots,x_n]/(f_1,\ldots,f_n).
$$
Note that we are assuming that $A$ is presented by the same
number of equations as variables. Thus the matrix of partial
derivatives
$$
( \partial f_i / \partial x_j )
$$
is $n\times n$, i.e., a square matrix. Assume that
its determinant is invertible as an element in $A$. Note that
this is exactly the condition that says that $\Omega^1_{A/R} = (0)$
in this case of $n$-generators and $n$ relations.
Let $\pi : B' \to B$ be a surjection of $R$-algebras 
whose kernel $J$ has square zero (as an ideal in $B'$).
Let $\varphi : A \to B$ be a homomorphism of $R$-algebras. 
Show there exists a unique homomorphism of $R$-algebras
$\varphi' : A \to B'$ such that $\varphi = \pi \circ \varphi'$.
\end{exercise}

\begin{exercise}
Find a generalization
of the result of the previous exercise to the case where $A=R[x,y]/(f)$.
\end{exercise}

\section{Schemes, Final Exam}
\label{section-final-exam}

\begin{exercise}
Definitions. Provide definitions of the following concepts.
\begin{enumerate}
\item $X$ is a {\it scheme} 
\item the morphism of schemes $f : X \to Y$ is {\it finite}
\item the morphisms of schemes $f : X \to Y$ is {\it of finite type}
\item the scheme $X$ is {\it Noetherian}
\item the ${\mathcal O}_X$-module ${\mathcal L}$ on
the scheme $X$ is {\it invertible}
\item the {\it genus} of a nonsingular
projective curve over an algebraically closed field
\end{enumerate}
\end{exercise}

\begin{exercise}
Let $X = \text{Spec} {\mathbf Z}[x,y]$, and let ${\mathcal F}$ be a quasi-coherent
${\mathcal O}_X$-module. Suppose that ${\mathcal F}$ is zero when restricted to the
standard affine open $D(x)$.
\begin{enumerate}
\item Show that every global section $s$ of ${\mathcal F}$ is killed by some
power of $x$, i.e., $x^ns=0$ for some $n\in {\mathbf N}$.
\item Do you think the same is true if we do not assume that ${\mathcal F}$
is quasi-coherent?
\end{enumerate}
\end{exercise}

\begin{exercise}
Suppose that $X \to \text{Spec}(R)$ is a proper morphism and that
$R$ is a discrete valuation ring with residue field $k$. Suppose that
$X \times_{\text{Spec} R} \text{Spec} k$ is the empty scheme. Show that
$X$ is the empty scheme.
\end{exercise}

\begin{exercise}
Consider the
projective\footnote{The projective embedding is
$((X_0,X_1),(Y_0,Y_1))\mapsto (X_0Y_0,X_0Y_1,X_1Y_0,X_1Y_1)$
in other words $(x,y)\mapsto (1,y,x,xy)$.} variety
$$
{\mathbf P}^1 \times {\mathbf P}^1 = {\mathbf P}^1_{{\mathbf C}} \times_{\text{Spec} {\mathbf C}} {\mathbf P}^1_{\mathbf C}
$$
over the field of complex numbers ${\mathbf C}$. It is covered by four affine pieces,
corresponding to pairs of standard affine pieces of ${\mathbf P}^1_{\mathbf C}$. For example,
suppose we use homogenous coordinates $X_0, X_1$ on the first factor and
$Y_0, Y_1$ on the second. Set $x=X_1/X_0$, and $y=Y_1/Y_0$. Then the 4 affine
open pieces are the spectra of the  rings
$$ 
{\mathbf C}[x,y],\ 
{\mathbf C}[x^{-1},y],\ 
{\mathbf C}[x,y^{-1}],\ 
{\mathbf C}[x^{-1},y^{-1}].
$$
Let $X \subset {\mathbf P}^1 \times {\mathbf P}^1$ be the closed subscheme which is the
closure of the closed subset of the first affine piece given by the equation
$$
y^3(x^4+1) = x^4 -1.
$$
\begin{enumerate}
\item Show that $X$ is contained in the union of the first and
the last of the 4 affine open pieces.
\item Show that $X$ is a nonsingular projective curve.
\item Consider the morphism $pr_2 : X \to {\mathbf P}^1$ (projection onto
the first factor). On the first affine piece it is the map $(x,y) \mapsto x$.
Briefly explain why it has degree $3$.
\item Compute the ramification points and ramification indices 
for the map $pr_2 : X \to {\mathbf P}^1$.
\item Compute the genus of $X$.
\end{enumerate}
\end{exercise}

\begin{exercise}
Let $X \to \text{Spec} {\mathbf Z}$ be a morphism of finite type. Suppose that
there is an infinite number of primes $p$ such that
$X\times_{\text{Spec} {\mathbf Z}} \text{Spec} {\mathbf F}_p$ is not empty. 
\begin{enumerate}
\item Show that $X \times_{\text{Spec} {\mathbf Z}}\text{Spec} \mathbf{Q}$ is not empty.
\item Do you think the same is true if we replace the condition
``finite type'' by the condition ``locally of finite type''?
\end{enumerate}
\end{exercise}


\input{chapters}

\bibliography{my}
\bibliographystyle{alpha}

\end{document}
