\input{preamble}

% OK, start here.
%
\begin{document}

\title{Pro-\'etale Cohomology}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
The material in this chapter and more can be found in the preprint \cite{BS}.

\medskip\noindent
The goal of this chapter is to introduce the pro-\'etale topology and
show how it simplifies the introduction of $\ell$-adic cohomology in
algebraic geometry.





\section{Some topology}
\label{section-topology}

\noindent
Some preliminaries. We have defined {\it spectral spaces} and
{\it spectral maps} of spectral spaces in
Topology, Section \ref{topology-section-spectral}.
The spectrum of a ring is a spectral space, see
Algebra, Lemma \ref{algebra-lemma-spec-spectral}.

\begin{lemma}
\label{lemma-spectral-split}
Let $X$ be a spectral space. Let $X_0 \subset X$ be the set of closed points.
The following are equivalent
\begin{enumerate}
\item Every open covering of $X$ can be refined by a finite
disjoint union decomposition $X = \coprod U_i$ with $U_i$
open and closed in $X$.
\item The composition $X_0 \to X \to \pi_0(X)$ is bijective.
\end{enumerate}
Moreover, if $X_0$ is closed in $X$ and every point of $X$ specializes
to a unique point of $X_0$, then these conditions are satisfied.
\end{lemma}

\begin{proof}
We will use without further mention that
$X_0$ is quasi-compact
(Topology, Lemma \ref{topology-lemma-closed-points-quasi-compact})
and $\pi_0(X)$ is profinite
(Topology, Lemma \ref{topology-lemma-spectral-pi0}).
Picture
$$
\xymatrix{
X_0 \ar[rd]_f \ar[r] & X \ar[d]^\pi \\
& \pi_0(X)
}
$$
If (2) holds, the continuous bijective map $f : X_0 \to \pi_0(X)$ is
a homeomorphism by
Topology, Lemma \ref{topology-lemma-bijective-map}.
Given an open covering $X = \bigcup U_i$, we get an open covering
$\pi_0(X) = \bigcup f(X_0 \cap U_i)$. By
Topology, Lemma \ref{topology-lemma-profinite-refine-open-covering}
we can find a finite open covering of the form $\pi_0(X) = \coprod V_j$
which refines this covering.
Since $X_0 \to \pi_0(X)$ is bijective each connected component of
$X$ has a unique closed point, whence is equal to the set of points
specializing to this closed point. Hence $\pi^{-1}(V_j)$ is the
set of points specializing to the points of $f^{-1}(V_j)$.
Now, if $f^{-1}(V_j) \subset X_0 \cap U_i \subset U_i$, then
it follows that $\pi^{-1}(V_j) \subset U_i$ (because the open set
$U_i$ is closed under generalizations). In this way we see
that the open covering $X = \coprod \pi^{-1}(V_j)$ refines
the covering we started out with. In this way we see that
(2) implies (1).

\medskip\noindent
Assume (1). Let $x, y \in X$ be closed points. Then we have the open covering
$X = (X \setminus \{x\}) \cup (X \setminus \{y\})$.
It follows from (1) that there exists a disjoint union decomposition
$X = U \amalg V$ with $U$ and $V$ open (and closed) and $x \in U$ and
$y \in V$. In particular we see that every connected component of $X$
has at most one closed point. By
Topology, Lemma \ref{topology-lemma-quasi-compact-closed-point}
every connected component (being closed) also does have a closed point.
Thus $X_0 \to \pi_0(X)$ is bijective. In this way we see that (1) implies (2).

\medskip\noindent
Assume $X_0$ is closed in $X$ and every point specializes to a unique
point of $X_0$. Then $X_0$ is a spectral space
(Topology, Lemma \ref{topology-lemma-spectral-sub})
consisting of closed points, hence profinite
(Topology, Lemma \ref{topology-lemma-characterize-profinite-spectral}).
Let $x, y \in X_0$ be distinct. By
Topology, Lemma \ref{topology-lemma-profinite-refine-open-covering}
we can find a disjoint union decomposition
$X_0 = U_0 \amalg V_0$ with $U_0$ and $V_0$ open and closed.
Let $\{U_i\}$ be the set of quasi-compact open subsets of $X$
such that $U_0 = X_0 \cap U_i$. Similarly, let $\{V_j\}$ be the
set of quasi-compact open subsets of $X$ such that
and $V_0 = X_0 \cap V_j$. If $U_i \cap V_j$ is nonempty for all $i, j$,
then there exists a point $\xi$ contained in all of them
(use the $U_i \cap V_j$ is constructible, hence closed in the
constructible topology, and use
Topology, Lemmas \ref{topology-lemma-constructible-hausdorff-quasi-compact} and
\ref{topology-lemma-intersection-closed-in-quasi-compact}).
However, since $X$ is sober and $V_0$ is closed in $X$,
the intersection $\bigcap U_i$ is the set of points specializing to $U_0$.
Similarly, $\bigcap V_j$ is the set of points specializing to $V_0$.
Since $U_0 \cap V_0$ is empty this is a contradiction.
Thus we find disjoint quasi-compact opens $U, V \subset X$
such that $U_0 = X_0 \cap U$ and $V_0 = X_0 \cap V$.
Observe that $X = U \cup V = U \amalg V$ as
$X_0 \subset U \cup V$ (use
Topology, Lemma \ref{topology-lemma-quasi-compact-closed-point}).
This proves that $x, y$ are not in the same connected component of $X$.
In other words, $X_0 \to \pi_0(X)$ is injective. The map is also
surjective by
Topology, Lemma \ref{topology-lemma-quasi-compact-closed-point}
and the fact that connected components are closed.
In this way we see that the final condition implies (1).
\end{proof}

\begin{example}
\label{example-not-w-local}
Let $T$ be a profinite space. Let $t \in T$ be a point and assume
that $T \setminus \{t\}$ is not quasi-compact.
Let $X = T \times \{0, 1\}$. Consider the topology on $X$
with a subbase given by the sets
$U \times \{0, 1\}$ for $U \subset T$ open, $X \setminus \{(t, 0)\}$,
and $U \times \{1\}$ for $U \subset T$ open with $t \not \in U$.
The set of closed points of $X$ is $X_0 = T \times \{0\}$ and
$(t, 1)$ is in the closure of $X_0$.
Moreover, $X_0 \to \pi_0(X)$ is a bijection.
This example shows that conditions (1) and (2) of
Lemma \ref{lemma-spectral-split} do no imply the set of closed points
is closed.
\end{example}

\noindent
It turns out it is more convenient to work with spectral
spaces which have the slightly stronger property mentioned in
the final statement of Lemma \ref{lemma-spectral-split}.
We give this property a name.

\begin{definition}
\label{definition-w-local}
A spectral space $X$ is {\it w-local} if the set of closed points $X_0$
is closed and every point of $X$ specializes to a unique closed point.
A continuous map $f : X \to Y$ of w-local spaces is {\it w-local}
if it is spectral and maps any closed point of $X$ to a closed point of $Y$.
\end{definition}

\noindent
We have seen in the proof of Lemma \ref{lemma-spectral-split}
that in this case $X_0 \to \pi_0(X)$ is a homeomorphism and that
$X_0 \cong \pi_0(X)$ is a profinite space. Moreover, a connected
component of $X$ is exactly the set of points specializing to
a given $x \in X_0$.

\begin{lemma}
\label{lemma-silly}
Let $X$ be a spectral space. Let
$$
\xymatrix{
Y \ar[r] \ar[d] & T \ar[d] \\
X \ar[r] & \pi_0(X)
}
$$
be a cartesian diagram in the category of topological spaces
with $T$ profinite. Then $Y$ is spectral and $T = \pi_0(Y)$.
If moreover $X$ is w-local, then $Y$ is w-local, $Y \to X$ is w-local,
and the set of closed points of $Y$ is the inverse image of the
set of closed points of $X$.
\end{lemma}

\begin{proof}
Note that $Y$ is a closed subspace of $X \times T$ as $\pi_0(X)$
is a profinite space hence Hausdorff
(use Topology, Lemmas \ref{topology-lemma-spectral-pi0} and
\ref{topology-lemma-fibre-product-closed}).
Since $X \times T$ is spectral
(Topology, Lemma \ref{topology-lemma-product-spectral-spaces})
it follows that $Y$ is spectral
(Topology, Lemma \ref{topology-lemma-spectral-sub}).
Let $Y \to \pi_0(Y) \to T$ be the canonical factorization
(Topology, Lemma \ref{topology-lemma-space-connected-components}).
It is clear that $\pi_0(Y) \to T$ is surjective.
The fibres of $Y \to T$ are homeomorphic to the fibres of
$X \to \pi_0(X)$. Hence these fibres are connected. It follows
that $\pi_0(Y) \to T$ is injective. We conclude that $\pi_0(Y) \to T$
is a homeomorphism by
Topology, Lemma \ref{topology-lemma-bijective-map}.

\medskip\noindent
Next, assume that $X$ is w-local and let $X_0 \subset X$ be the
set of closed points. The inverse image $Y_0 \subset Y$ of $X_0$ in
$Y$ maps bijectively onto $T$ as $X_0 \to \pi_0(X)$ is a bijection
by Lemma \ref{lemma-spectral-split}. Moreover, $Y_0$ is quasi-compact
as a closed subset of the spectral space $Y$. Hence
$Y_0 \to \pi_0(Y) = T$ is a homeomorphism by
Topology, Lemma \ref{topology-lemma-bijective-map}.
It follows that all points of $Y_0$ are closed in $Y$.
Conversely, if $y \in Y$ is a closed point, then
it is closed in the fibre of $Y \to \pi_0(Y) = T$
and hence its image $x$ in $X$ is closed in the (homeomorphic) fibre of
$X \to \pi_0(X)$. This implies $x \in X_0$ and hence $y \in Y_0$.
Thus $Y_0$ is the collection of closed points of $Y$
and for each $y \in Y_0$ the set of generalizations of $y$ is
the fibre of $Y \to \pi_0(Y)$. The lemma follows.
\end{proof}




\section{Local isomorphisms}
\label{section-local-isomorphism}

\noindent
We start with a defintion.

\begin{definition}
\label{definition-local-isomorphism}
Let $\varphi : A \to B$ be a ring map.
\begin{enumerate}
\item We say $A \to B$ is a {\it local isomorphism} if for every prime
$\mathfrak q \subset B$ there exists a $g \in B$, $g \not \in \mathfrak q$
such that $A \to B_g$ induces an open immersion $\Spec(B_g) \to \Spec(A)$.
\item We say $A \to B$ {\it identifies local rings} if for every prime
$\mathfrak q \subset B$ the canonical map
$A_{\varphi^{-1}(\mathfrak q)} \to B_\mathfrak q$ is an isomorphism.
\end{enumerate}
\end{definition}

\noindent
We list some elementary properties.

\begin{lemma}
\label{lemma-base-change-local-isomorphism}
Let $A \to B$ and $A \to A'$ be ring maps. Let $B' = B \otimes_A A'$
be the base change of $B$.
\begin{enumerate}
\item If $A \to B$ is a local isomorphism, then $A' \to B'$ is a
local isomorphism.
\item If $A \to B$ identifies local rings, then $A' \to B'$
identifies local rings.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-composition-local-isomorphism}
Let $A \to B$ and $B \to C$ be ring maps.
\begin{enumerate}
\item If $A \to B$ and $B \to C$ are local isomorphisms, then $A \to C$
is a local isomorphism.
\item If $A \to B$ and $B \to C$ identify local rings, then $A \to C$
identifies local rings.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-local-isomorphism-permanence}
Let $A$ be a ring. Let $B \to C$ be an $A$-algebra homomorphism.
\begin{enumerate}
\item If $A \to B$ and $A \to C$ are local isomorphisms, then $B \to C$
is a local isomorphism.
\item If $A \to B$ and $A \to C$ identify local rings, then $B \to C$
identifies local rings.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-local-isomorphism-implies}
Let $A \to B$ be a local isomorphism. Then
\begin{enumerate}
\item $A \to B$ is \'etale,
\item $A \to B$ identifies local rings,
\item $A \to B$ is quasi-finite.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-structure-local-isomorphism}
Let $A \to B$ be a local isomorphism. Then there exist $n \geq 0$,
$g_1, \ldots, g_n \in B$, $f_1, \ldots, f_n \in A$ such that
$(g_1, \ldots, g_n) = B$ and $A_{f_i} \cong B_{g_i}$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-fully-faithful-spaces-over-X}
Let $p : (Y, \mathcal{O}_Y) \to (X, \mathcal{O}_X)$ and
$q : (Z, \mathcal{O}_Z) \to (X, \mathcal{O}_X)$
be morphisms of locally ringed spaces.
If $\mathcal{O}_Y = p^{-1}\mathcal{O}_X$, then
$$
\Mor_{\text{LRS}/(X, \mathcal{O}_X)}((Z, \mathcal{O}_Z), (Y, \mathcal{O}_Y))
\longrightarrow
\Mor_{\textit{Top}/X}(Z, Y),\quad
(f, f^\sharp) \longmapsto f
$$
is bijective. Here $\text{LRS}/(X, \mathcal{O}_X)$ is the category of
locally ringed spaces over $X$ and $\textit{Top}/X$ is the category
of topological space over $X$.
\end{lemma}

\begin{proof}
This is immediate from the definitions.
\end{proof}

\begin{lemma}
\label{lemma-local-isomorphism-fully-faithful}
Let $A$ be a ring. Set $X = \Spec(A)$. The functor
$$
B \longmapsto \Spec(B)
$$
from the category of $A$-algebras $B$ such that $A \to B$ identifies
local rings to the category of
topological spaces over $X$ is fully faithful.
\end{lemma}

\begin{proof}
This follows from Lemma \ref{lemma-fully-faithful-spaces-over-X}
and the fact that if $A \to B$ identifies local rings, then the pullback
of the structure sheaf of $\Spec(A)$ via $p : \Spec(B) \to \Spec(A)$
is equal to the structure sheaf of $\Spec(B)$.
\end{proof}




\section{Ind-Zariski algebra}
\label{section-ind-zariski}

\noindent
We start with a defintion.

\begin{definition}
\label{definition-ind-zariski}
A ring map $A \to B$ is said to be {\it ind-Zariski} if $B$ can be written
as a filtered colimit $B = \colim B_i$ with each $A \to B_i$ a local
isomorphism.
\end{definition}

\noindent
An example of an Ind-Zariski map is a localization $A \to S^{-1}A$, see
Algebra, Lemma \ref{algebra-lemma-localization-colimit}.
The category of ind-Zariski algebras is closed under several natural
operations.

\begin{lemma}
\label{lemma-base-change-ind-zariski}
Let $A \to B$ and $A \to A'$ be ring maps. Let $B' = B \otimes_A A'$
be the base change of $B$.
If $A \to B$ is ind-Zariski, then $A' \to B'$ is ind-Zariski.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-composition-ind-zariski}
Let $A \to B$ and $B \to C$ be ring maps. If $A \to B$ and $B \to C$
are ind-Zariski, then $A \to C$ is ind-Zariski.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-ind-zariski-permanence}
Let $A$ be a ring. Let $B \to C$ be an $A$-algebra homomorphism.
If $A \to B$ and $A \to C$ are ind-Zariski, then $B \to C$
is ind-Zariski.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-ind-ind-zariski}
A filtered colimit of ind-Zariski $A$-algebras is ind-Zariski over $A$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-ind-zariski-implies}
Let $A \to B$ be ind-Zariski. Then $A \to B$ identifies local rings,
\end{lemma}

\begin{proof}
Omitted.
\end{proof}







\section{Constructing w-local affine schemes}
\label{section-construction}

\noindent
An affine scheme $X$ is called {\it w-local} if its underlying
topological space is w-local (Definition \ref{definition-w-local}).
It turns out given any ring $A$ there is a canonical faithully
flat ind-Zariski ring map $A \to A_w$ such that $\Spec(A_w)$ is
w-local. The key to constructing $A_w$ is the following simple lemma.

\begin{lemma}
\label{lemma-localization}
Let $A$ be a ring. Set $X = \Spec(A)$. Let $Z \subset X$ be a locally closed
subscheme which of the form $D(f) \cap V(I)$ for some $f \in A$ and
ideal $I \subset A$. Then
\begin{enumerate}
\item there exists a multiplicative subset $S \subset A$ such that
$\Spec(S^{-1}A)$ maps by a homeomorphism to the set of points of $X$
specializing to $Z$,
\item the $A$-algebra $A_Z^\sim = S^{-1}A$ depends only on
the underlying locally closed subset $Z \subset X$,
\item $Z$ is a closed subscheme of $\Spec(A_Z^\sim)$,
\end{enumerate}
If $A \to A'$ is a ring map and $Z' \subset X' = \Spec(A')$ is a
locally closed subscheme of the same form which maps into $Z$,
then there is a unique $A$-algebra map
$A_Z^\sim \to (A')_{Z'}^\sim$.
\end{lemma}

\begin{proof}
Let $S \subset A$ be the multiplicative set of elements which map
to invertible elements of $\Gamma(Z, \mathcal{O}_Z) = (A/I)_f$.
If $\mathfrak p$ is a prime of $A$ which does not specialize to $Z$,
then $\mathfrak p$ generates the unit ideal in $(A/I)_f$. Hence
we can write $f^n =  g + h$ for some $n \geq 0$, $g \in \mathfrak p$,
$h \in I$. Then $g \in S$ and we see that $\mathfrak p$ is not in
the spectrum of $S^{-1}A$. Conversely, if $\mathfrak p$ does specialize
to $Z$, say $\mathfrak p \subset \mathfrak q \supset I$ with
$f \not \in \mathfrak q$, then we see that $S^{-1}A$ maps to
$A_\mathfrak q$ and hence $\mathfrak p$ is in the spectrum of $S^{-1}A$.
This proves (1).

\medskip\noindent
The isomorphism class of the localization $S^{-1}A$ depends only
on the corresponding subset $\Spec(S^{-1}A) \subset \Spec(A)$, whence
(2) holds. By construction $S^{-1}A$ maps surjectively onto
$(A/I)_f$, hence (3). The final statement follows as the multiplicative subset
$S' \subset A'$ corresponding to $Z'$ contains the image of the
multiplicative subset $S$.
\end{proof}

\noindent
Let $A$ be a ring. Let $E \subset A$ be a finite subset. We get a
stratification of $X = \Spec(A)$ into locally closed subschemes by
looking at the vanishing behaviour of the elements of $E$. More precisely,
given a disjoint union decomposition $E = E' \amalg E''$ we set
\begin{equation}
\label{equation-stratum}
Z(E', E'') =
\bigcap\nolimits_{f \in E'} D(f) \cap \bigcap\nolimits_{f \in E''} V(f) =
D(\prod\nolimits_{f \in E'} f) \cap V( \sum\nolimits_{f \in E''} fA)
\end{equation}
The points of $Z(E', E'')$ are exactly those $x \in X$ such that
$f \in E'$ maps to a nonzero element in $\kappa(x)$ and $f \in E''$
maps to zero in $\kappa(x)$. Thus it is clear that
\begin{equation}
\label{equation-stratify}
X = \coprod\nolimits_{E = E' \amalg E''} Z(E', E'')
\end{equation}
set theoretically. Observe that each stratum is constructible.

\begin{lemma}
\label{lemma-refine}
Let $X = \Spec(A)$ as above. Given any finite stratification
$X = \coprod T_i$ by constructible subsets, there exists a finite
subset $E \subset A$ such that the stratification (\ref{equation-stratify})
refines $X = \coprod T_i$.
\end{lemma}

\begin{proof}
We may write $T_i = \bigcup_j U_{i, j} \cap V_{i, j}^c$ as a finite union
for some $U_{i, j}$ and $V_{i, j}$ quasi-compact open in $X$.
Then we may write $U_{i, j} = \bigcup D(f_{i, j, k})$ and
$V_{i, j} = \bigcup D(g_{i, j, l})$. Then we set
$E = \{f_{i, j, k}\} \cup \{g_{i, j, l}\}$. This does the job, because
the stratification (\ref{equation-stratify}) is the one whose strata are
labeled by the vanishing pattern of the elements of $E$ which
clearly refines the given stratification.
\end{proof}

\noindent
We continue the discussion.
Given a finite subset $E \subset A$ we set
\begin{equation}
\label{equation-ring}
A_E = \prod\nolimits_{E = E' \amalg E''} A_{Z(E', E'')}^\sim
\end{equation}
with notation as in Lemma \ref{lemma-localization}. This makes sense because
(\ref{equation-stratum}) shows that each $Z(E', E'')$ has the correct shape.
We take the spectrum of this ring and denote it
\begin{equation}
\label{equation-spectrum}
X_E = \Spec(A_E) = \coprod\nolimits_{E = E' \amalg E''} X_{E', E''}
\end{equation}
with $X_{E', E''} = \Spec(A_{Z(E', E'')}^\sim)$. Note that
\begin{equation}
\label{equation-closed}
Z_E = \coprod\nolimits_{E = E' \amalg E''} Z(E', E'')
\longrightarrow
X_E
\end{equation}
is a closed subscheme. By construction the closed subscheme $Z_E$
contains all the closed points of the affine scheme $X_E$ as every point
of $X_{E', E''}$ specializes to a point of $Z(E', E'')$.

\medskip\noindent
Let $I(A)$ be the partially ordered set of all finite subsets of $A$.
This is a directed partially ordered set. For $E_1 \subset E_2$ there
is a canonical transition map $A_{E_1} \to A_{E_2}$ of $A$-algebras.
Namely, given a decomposition $E_2 = E'_2 \amalg E''_2$ we set
$E'_1 = E_1 \cap E'_2$ and $E''_1 = E_1 \cap E''_2$. Then observe that
$Z(E'_1, E''_1) \subset Z(E'_2, E''_2)$ hence a unique $A$-algebra map
$A_{Z(E'_1, E''_1)}^\sim \to A_{Z(E'_2, E''_2)}^\sim$ by
Lemma \ref{lemma-localization}. Using these maps collectively we obtain
the desired ring map $A_{E_1} \to A_{E_2}$. Observe that the corresponding
map of affine schemes
\begin{equation}
\label{equation-transition}
X_{E_2} \longrightarrow X_{E_1}
\end{equation}
maps $Z_{E_2}$ into $Z_{E_1}$. By uniqueness we obtain a system of
$A$-algebras over $I(A)$ and we set
\begin{equation}
\label{equation-colimit-ring}
A_w = \colim_{E \in I(A)} A_E
\end{equation}
This $A$-algebra is ind-Zariski and faithfully flat over $A$.
Finally, we set $X_w = \Spec(A_w)$ and endow it with the closed subscheme
$Z = \lim_{E \in I(A)} Z_E$. In a formula
\begin{equation}
\label{equation-final}
X_w = \lim_{E \in I(A)} X_E \supset Z = \lim_{E \in I(A)} Z_E
\end{equation}

\begin{lemma}
\label{lemma-make-w-local}
Let $X = \Spec(A)$ be an affine scheme. With $A \to A_w$, $X_w = \Spec(A_w)$,
and $Z \subset X_w$ as above.
\begin{enumerate}
\item $A \to A_w$ is ind-Zariski and faithfully flat,
\item $X_w \to X$ induces a bijection $Z \to X$,
\item $Z$ is the set of closed points of $X_w$,
\item $Z$ is a reduced scheme, and
\item every point of $X_w$ specializes to a unique point of $Z$.
\end{enumerate}
In particular, $X_w$ is w-local (Definition \ref{definition-w-local}).
\end{lemma}

\begin{proof}
The map $A \to A_w$ is ind-Zariski by construction.
For every $E$ the morphism $Z_E \to X$ is a bijection, hence (2).
As $Z \subset X_w$ we conclude $X_w \to X$ is surjective and
$A \to A_w$ is faithfully flat by
Algebra, Lemma \ref{algebra-lemma-ff-rings}. This proves (1).

\medskip\noindent
Suppose that $y \in X_w$, $y \not \in Z$. Then there
exists an $E$ such that the image of $y$ in $X_E$ is not contained in
$Z_E$. Then for all $E \subset E'$ also $y$ maps to an element of $X_{E'}$
not contained in $Z_{E'}$. Let $T_{E'} \subset X_{E'}$ be the reduced
closed subscheme which is the closure of the image of $y$. It is
clear that $T = \lim_{E \subset E'} T_{E'}$ is the closure of $y$ in $X_w$.
For every $E \subset E'$ the scheme $T_{E'} \cap Z_{E'}$ is nonempty
by construction of $X_{E'}$. Hence $\lim T_{E'} \cap Z_{E'}$ is nonempty
and we conclude that $T \cap Z$ is nonempty. Thus $y$ is not a closed point.
It follows that every closed point of $X_w$ is in $Z$.

\medskip\noindent
Suppose that $y \in X_w$ specializes to $z, z' \in Z$. We will show that
$z = z'$ which will finish the proof of (3) and will imply (5).
Let $x, x' \in X$ be the images of $z$ and $z'$. Since $Z \to X$ is
bijective it suffices to show that $x = x'$. If $x \not = x'$, then
there exists an $f \in A$ such that $x \in D(f)$ and $x' \in V(f)$
(or vice versa). Set $E = \{f\}$ so that
$$
X_E = \Spec(A_f) \amalg \Spec(A_{V(f)}^\sim)
$$
Then we see that $z$ and $z'$ map $x_E$ and $x'_E$ which are in different
parts of the given decomposition of $X_E$ above. But then it impossible
for $x_E$ and $x'_E$ to be specializations of a common point.
This is the desired contradition.

\medskip\noindent
Recall that given a finite subset $E \subset A$ we have $Z_E$
is a disjoint union of the locally closed subschemes $Z(E', E'')$
each isomorphic to the spectrum of $(A/I)_f$ where $I$ is the ideal
generated by $E''$ and $f$ the product of the elements of $E'$.
Any nilpotent element $b$ of $(A/I)_f$ is the class of $g/f^n$
for some $g \in A$. Then setting $E' = E \cup \{g\}$ the reader
verifies that $b$ is pulls back to zero under the transition map
$Z_{E'} \to Z_E$ of the system. This proves (4).
\end{proof}

\begin{remark}
\label{remark-size-w}
Let $A$ be a ring. Let $\kappa$ be an infinite cardinal bigger or
equal than the cardinality of $A$. Then the cardinality of $A_w$
(Lemma \ref{lemma-make-w-local})
is at most $\kappa$. Namely, each $A_E$ has cardinality at most
$\kappa$ and the set of finite subsets of $A$ has cardinality at most $\kappa$
as well. Thus the result follows as $\kappa \otimes \kappa = \kappa$, see
Sets, Section \ref{sets-section-cardinals}.
\end{remark}

\begin{lemma}[Universal property of the construction]
\label{lemma-universal}
Let $A$ be a ring. Let $A \to A_w$ be the ring map constructed in
Lemma \ref{lemma-make-w-local}. For any ring map $A \to B$ such that
$\Spec(B)$ is w-local, there is a unique factorization $A \to A_w \to B$
such that $\Spec(B) \to \Spec(A_w)$ is w-local.
\end{lemma}

\begin{proof}
Denote $Y = \Spec(B)$ and $Y_0 \subset Y$ the set of closed points.
Denote $f : Y \to X$ the given morphism.
Recall that $Y_0$ is profinite, in particular every constructible
subset of $Y_0$ is open and closed. Let $E \subset A$ be a finite subset.
Recally that $A_w = \colim A_E$ and that the set of closed points of
$\Spec(A_w)$ is the limit of the closed subsets $Z_E \subset X_E = \Spec(A_E)$.
Thus it suffices to show there is a unique factorization $A \to A_E \to B$
such that $Y \to X_E$ maps $Y_0$ into $Z_E$.
Since $Z_E \to X = \Spec(A)$ is bijective, and since the strata
$Z(E', E'')$ are constructible we see that
$$
Y_0 = \coprod f^{-1}(Z(E', E'')) \cap Y_0
$$
is a disjoint union decomposition into open and closed subsets.
As $Y_0 = \pi_0(Y)$ we obtain a corresponding decomposition of
$Y$ into open and closed pieces. Thus it suffices to construct
the factorization in case $f(Y_0) \subset Z(E', E'')$ for
some decomposition $E = E' \amalg E''$.
In this case $f(Y)$ is contained in the set of points of $X$
specializing to $Z(E', E'')$ which is homeomorphic to $X_{E', E''}$.
Thus we obtain a unique continuous map $Y \to X_{E', E''}$ over $X$. By
Lemma \ref{lemma-fully-faithful-spaces-over-X}
this corresponds to a unique morphism of schemes
$Y \to X_{E', E''}$ over $X$. This finishes the proof.
\end{proof}

\noindent
Recall that the spectrum of a ring is profinite if and only if
every point is closed. There are in fact a whole slew of equivalent
conditions that imply this. See
Algebra, Lemma \ref{algebra-lemma-ring-with-only-minimal-primes} or
Topology, Lemma \ref{topology-lemma-characterize-profinite-spectral}.

\begin{lemma}
\label{lemma-profinite-goes-up}
Let $A$ be a ring such that $\Spec(A)$ is profinite. Let $A \to B$ be a
ring map. Then $\Spec(B)$ is profinite in each of the following cases:
\begin{enumerate}
\item if $\mathfrak q,\mathfrak q' \subset B$ lie over the same
prime of $A$, then neither $\mathfrak q \subset \mathfrak q'$, nor
$\mathfrak q' \subset \mathfrak q$,
\item $A \to B$ induces algebraic extensions of residue fields,
\item $A \to B$ is a local isomorphism,
\item $A \to B$ identifies local rings,
\item $A \to B$ is weakly \'etale,
\item $A \to B$ is quasi-finite,
\item $A \to B$ is unramified,
\item $A \to B$ is \'etale,
\item $B$ is a filtered colimit of $A$-algebras as in (1) -- (8),
\item etc.
\end{enumerate}
\end{lemma}

\begin{proof}
By the references mentioned above
(Algebra, Lemma \ref{algebra-lemma-ring-with-only-minimal-primes} or
Topology, Lemma \ref{topology-lemma-characterize-profinite-spectral})
there are no specializations between distinct points of $\Spec(A)$ and
$\Spec(B)$ is profinite if and only if there are no specializations
between distinct points of $\Spec(B)$. These specializations can only
happen in the fibres of $\Spec(B) \to \Spec(A)$. In this way we see
that (1) is true.

\medskip\noindent
The assumption in (2) implies all primes of $B$ are maximal by
Algebra, Lemma \ref{algebra-lemma-finite-residue-extension-closed}.
Thus (2) holds.
If $A \to B$ is a local isomorphism or identifies local rings,
then the residue field extensions are trivial, so (3) and (4)
follow from (2).
If $A \to B$ is weakly \'etale, then More on Algebra, Lemma
\ref{more-algebra-lemma-weakly-etale-residue-field-extensions}
tells us it induces separable algebraic residue field extensions, so
(5) follows from (2).
If $A \to B$ is quasi-finite, then the fibres are finite discrete
topological spaces. Hence (6) follows from (1).
Hence (3) follows from (1). Cases (7) and (8)
follow from this as unramfied and \'etale ring map are quasi-finite
(Algebra, Lemmas
\ref{algebra-lemma-unramified-quasi-finite} and
\ref{algebra-lemma-etale-quasi-finite}).
If $B = \colim B_i$ is a filtered colimit of $A$-algebras, then
$\Spec(B) = \colim \Spec(B_i)$, hence if each $\Spec(B_i)$
is profinite, so is $\Spec(B)$. This proves (9).
\end{proof}

\begin{lemma}
\label{lemma-localize-along-closed-profinite}
Let $A$ be a ring. Let $V(I) \subset \Spec(A)$ be a closed subset
which is a profinite topological space. Then there exists an
ind-Zariski ring map $A \to B$ such that $\Spec(B)$ is w-local,
the set of closed points is $V(IB)$, and $A/I \cong B/IB$.
\end{lemma}

\begin{proof}
Let $A \to A_w$ and $Z \subset Y = \Spec(A_w)$ as in
Lemma \ref{lemma-make-w-local}.
Let $T \subset Z$ be the inverse image of $V(I)$.
Then $T \to V(I)$ is a homeomorphism by
Topology, Lemma \ref{topology-lemma-bijective-map}.
Let $B = (A_w)_T^\sim$, see Lemma \ref{lemma-localization}.
It is clear that $B$ is w-local with closed points $V(IB)$.
The ring map $A/I \to B/IB$ is ind-Zariski
and induces a homeomorphism on underlying
topological spaces. Hence it is an ismorphism by
Lemma \ref{lemma-local-isomorphism-fully-faithful}.
\end{proof}

\begin{lemma}
\label{lemma-w-local-algebraic-residue-field-extensions}
Let $A$ be a ring such that $X = \Spec(A)$ is w-local. Let $I \subset A$
be the radical ideal cutting out the set $X_0$ of closed points in $X$.
Let $A \to B$ be a ring map inducing algebraic extensions on residue
fields at primes. Then
\begin{enumerate}
\item every point of $Z = V(IB)$ is a closed point of $\Spec(B)$,
\item there exists an ind-Zariski ring map $B \to C$ such that
\begin{enumerate}
\item $B/IB \to C/IC$ is an isomorphism,
\item the space $Y = \Spec(C)$ is w-local,
\item the induced map $p : Y \to X$ is w-local, and
\item $p^{-1}(X_0)$ is the set of closed points of $Y$.
\end{enumerate}
\end{enumerate}
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-profinite-goes-up} applied to $A/I \to B/IB$
all points of $Z = V(IB) = \Spec(B/IB)$ are closed, in fact $\Spec(B/IB)$
is a profinite space.
To finish the proof we apply Lemma \ref{lemma-localize-along-closed-profinite}
to $IB \subset B$.
\end{proof}





\section{Identifying local rings versus ind-Zariski}
\label{section-connected-components}

\noindent
An ind-Zariski ring map $A \to B$ identifies local rings
(Lemma \ref{lemma-ind-zariski-implies}). The converse does not hold
(Examples, Section \ref{examples-section-not-ind-etale}).
However, it turns out that there is a kind of structure theorem for
ring maps which identify local rings in terms of ind-Zariski
ring maps, see Proposition \ref{proposition-maps-wich-identify-local-rings}.

\medskip\noindent
Let $A$ be a ring. Let $X = \Spec(A)$. The space of connected
components $\pi_0(X)$ is a profinite space by
Topology, Lemma \ref{topology-lemma-spectral-pi0}
(and Algebra, Lemma \ref{algebra-lemma-spec-spectral}).

\begin{lemma}
\label{lemma-construct}
Let $A$ be a ring. Let $X = \Spec(A)$. Let $T \subset \pi_0(X)$ be a
closed subset. There exists a surjective ind-Zariski ring map $A \to B$
such that $\Spec(B) \to \Spec(A)$ induces a homeomorphism of $\Spec(B)$
with the inverse image of $T$ in $X$.
\end{lemma}

\begin{proof}
Let $Z \subset X$ be the inverse image of $T$. Then $Z$ is the intersection
$Z = \bigcap Z_\alpha$ of the open and closed subsets of $X$ containing $Z$,
see Topology, Lemma \ref{topology-lemma-closed-union-connected-components}.
For each $\alpha$ we have $Z_\alpha = \Spec(A_\alpha)$ where
$A \to A_\alpha$ is a local isomorphism (a localization at an idempotent).
Setting $B = \colim A_\alpha$ proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-construct-profinite}
Let $A$ be a ring and let $X = \Spec(A)$. Let $T$ be a profinite space and
let $T \to \pi_0(X)$ be a continuous map. There exists an
ind-Zariski ring map $A \to B$ such that with $Y = \Spec(B)$ the diagram
$$
\xymatrix{
Y \ar[r] \ar[d] & \pi_0(Y) \ar[d] \\
X \ar[r] & \pi_0(X)
}
$$
is cartesian in the category of topological spaces and such that
$\pi_0(Y) = T$ as spaces over $\pi_0(X)$.
\end{lemma}

\begin{proof}
Namely, write $T = \lim T_i$ as the limit of an inverse system finite
discrete spaces over a directed partially ordered set (see
Topology, Lemma \ref{topology-lemma-profinite}). For each $i$ let
$Z_i = \text{Im}(T \to \pi_0(X) \times T_i)$. This is a closed subset.
Observe that $X \times T_i$ is the spectrum of $A_i = \prod_{t \in T_i} A$
and that $A \to A_i$ is a local isomorphism. By Lemma \ref{lemma-construct}
we see that $Z_i \subset \pi_0(X \times T_i) = \pi_0(X) \times T_i$
corresponds to a surjection $A_i \to B_i$ which is ind-Zariski
such that $\Spec(B_i) = X \times_{\pi_0(X)} Z_i$ as subsets of
$X \times T_i$. The transition maps $T_i \to T_{i'}$ induce maps
$Z_i \to Z_{i'}$ and $X \times_{\pi_0(X)} Z_i \to X \times_{\pi_0(X)} Z_{i'}$.
Hence ring maps $B_{i'} \to B_i$
(Lemmas \ref{lemma-local-isomorphism-fully-faithful} and
\ref{lemma-ind-zariski-implies}).
Set $B = \colim B_i$. Because $T = \lim Z_i$ we have
$X \times_{\pi_0(X)} T = \lim  X \times_{\pi_0(X)} Z_i$
and hence $Y = \Spec(B) = \lim \Spec(B_i)$
fits into the cartesian diagram
$$
\xymatrix{
Y \ar[r] \ar[d] & T \ar[d] \\
X \ar[r] & \pi_0(X)
}
$$
of topological spaces. By Lemma \ref{lemma-silly}
we conclude that $T = \pi_0(Y)$.
\end{proof}

\begin{lemma}
\label{lemma-w-local-morphism-equal-points-stalks-is-iso}
Let $A \to B$ be ring map such that
\begin{enumerate}
\item $A \to B$ identifies local rings,
\item the topological spaces $\Spec(B)$, $\Spec(A)$ are w-local,
\item $\Spec(B) \to \Spec(A)$ is w-local, and
\item $\pi_0(\Spec(B)) \to \pi_0(\Spec(A))$ is bijective.
\end{enumerate}
Then $A \to B$ is an isomorphism
\end{lemma}

\begin{proof}
Let $X_0 \subset X = \Spec(A)$ and $Y_0 \subset Y = \Spec(B)$ be the
sets of closed points. By assumption $Y_0$ maps into $X_0$ and
the induced map $Y_0 \to X_0$ is a bijection.
As a space $\Spec(A)$ is the disjoint union of the spectra
of the local rings of $A$ at closed points.
Similarly for $B$. Hence $X \to Y$ is a bijection.
Since $A \to B$ is flat we have going down
(Algebra, Lemma \ref{algebra-lemma-flat-going-down}).
Thus Algebra, Lemma \ref{algebra-lemma-unique-prime-over-localize-below}
shows for any prime $\mathfrak q \subset B$ lying over
$\mathfrak p \subset A$ we have $B_\mathfrak q = B_\mathfrak p$.
Since $B_\mathfrak q = A_\mathfrak p$ by assumption, we
see that $A_\mathfrak p = B_\mathfrak p$ for all primes $\mathfrak p$
of $A$. Thus $A = B$ by
Algebra, Lemma \ref{algebra-lemma-characterize-zero-local}.
\end{proof}

\begin{lemma}
\label{lemma-w-local-morphism-equal-stalks-is-ind-zariski}
Let $A \to B$ be ring map such that
\begin{enumerate}
\item $A \to B$ identifies local rings,
\item the topological spaces $\Spec(B)$, $\Spec(A)$ are w-local, and
\item $\Spec(B) \to \Spec(A)$ is w-local.
\end{enumerate}
Then $A \to B$ is ind-Zariski.
\end{lemma}

\begin{proof}
Set $X = \Spec(A)$ and $Y = \Spec(B)$. Let $X_0 \subset X$ and
$Y_0 \subset Y$ be the set of closed points. Let $A \to A'$ be the ind-Zariski
morphism of affine schemes such that with $X' = \Spec(A')$ the diagram
$$
\xymatrix{
X' \ar[r] \ar[d] & \pi_0(X') \ar[d] \\
X \ar[r] & \pi_0(X)
}
$$
is cartesian in the category of topological spaces and such that
$\pi_0(X') = \pi_0(Y)$ as spaces over $\pi_0(X)$, see
Lemma \ref{lemma-construct-profinite}. By
Lemma \ref{lemma-silly} we see that $X'$ is w-local and
the set of closed points $X'_0 \subset X'$ is the inverse image of $X_0$.

\medskip\noindent
We obtain a continuous map $Y \to X'$ of underlying topological spaces
over $X$ identifying $\pi_0(Y)$ with $\pi_0(X')$. By
Lemma \ref{lemma-local-isomorphism-fully-faithful}
(and Lemma \ref{lemma-ind-zariski-implies})
this is corresponds to a morphism of affine schemes $Y \to X'$
over $X$. Since $Y \to X$ maps $Y_0$ into $X_0$ we see that
$Y \to X'$ maps $Y_0$ into $X'_0$, i.e., $Y \to X'$ is w-local.
By Lemma \ref{lemma-w-local-morphism-equal-points-stalks-is-iso}
we see that $Y \cong X'$ and we win.
\end{proof}

\noindent
The following proposition is a warm up for the type of result
we will prove later.

\begin{proposition}
\label{proposition-maps-wich-identify-local-rings}
Let $A \to B$ be a ring map which identifies local rings.
Then there exists a faithfully flat, ind-Zariski ring map
$B \to B'$ such that $A \to B'$ is ind-Zariski.
\end{proposition}

\begin{proof}
Let $A \to A_w$, resp. $B \to B_w$ be the faithfully flat, ind-Zariski ring
map constructed in Lemma \ref{lemma-make-w-local} for $A$, resp.\ $B$.
Since $\Spec(B_w)$ is w-local, there exists a unique factorization
$A \to A_w \to B_w$ such that $\Spec(B_w) \to \Spec(A_w)$ is w-local
by Lemma \ref{lemma-universal}. Note that $A_w \to B_w$ identifies
local rings, see
Lemma \ref{lemma-local-isomorphism-permanence}.
By Lemma \ref{lemma-w-local-morphism-equal-stalks-is-ind-zariski}
this means $A_w \to B_w$ is ind-Zariski. Since $B \to B_w$ is
faithfully flat, ind-Zariski (Lemma \ref{lemma-make-w-local})
and the composition $A \to B \to B_w$ is ind-Zariski
(Lemma \ref{lemma-composition-ind-zariski})
the proposition is proved.
\end{proof}





\section{Ind-\'etale algebra}
\label{section-ind-etale}

\noindent
We start with a definition.

\begin{definition}
\label{definition-ind-etale}
A ring map $A \to B$ is said to be {\it ind-\'etale} if $B$ can be written
as a filtered colimit of \'etale $A$-algebras.
\end{definition}

\noindent
The category of ind-\'etale algebras is closed under a number of natural
operations.

\begin{lemma}
\label{lemma-base-change-ind-etale}
Let $A \to B$ and $A \to A'$ be ring maps. Let $B' = B \otimes_A A'$
be the base change of $B$.
If $A \to B$ is ind-\'etale, then $A' \to B'$ is ind-\'etale.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-composition-ind-etale}
Let $A \to B$ and $B \to C$ be ring maps. If $A \to B$ and $B \to C$
are ind-\'etale, then $A \to C$ is ind-\'etale.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-ind-ind-etale}
A filtered colimit of ind-\'etale $A$-algebras is ind-\'etale over $A$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-ind-etale-permanence}
Let $A$ be a ring. Let $B \to C$ be an $A$-algebra map of ind-\'etale
$A$-algebras. Then $C$ is an ind-\'etale $B$-algebra.
\end{lemma}

\begin{proof}
Write $B = \colim B_i$ and $C = \colim C_j$ as filtered colimits
of \'etale $A$-algebras. Then
$$
C = B \otimes_B C = \colim_{(i, j)} B \otimes_{B_i} C_j
$$
where the colimit is over the partially ordered set of pairs $(i, j)$
such that $B_i \to B \to C$ factors through $C_j \to C$. Note that
the factorization $B_i \to C_j$ is \'etale by
Algebra, Lemma \ref{algebra-lemma-map-between-etale}.
Some details omitted.
\end{proof}

\begin{lemma}
\label{lemma-ind-etale-implies}
Let $A \to B$ be ind-\'etale. Then $A \to B$ is weakly \'etale
(More on Algebra, Definition \ref{more-algebra-definition-weakly-etale}).
\end{lemma}

\begin{proof}
This follows from More on Algebra, Lemma
\ref{more-algebra-lemma-when-weakly-etale}.
\end{proof}






\section{Constructing ind-\'etale algebras}
\label{section-construction-ind-etale}

\noindent
Let $A$ be a ring. Recall that any \'etale ring map $A \to B$ is isomorphic
to a standard smooth ring map of relative dimension $0$. Such a ring map
is of the form
$$
A \longrightarrow A[x_1, \ldots, x_n]/(f_1, \ldots, f_n)
$$
where the determinant of the $n \times n$-matrix with entries
$\partial f_i/\partial x_j$ is invertible in the quotient ring. See
Algebra, Lemma \ref{algebra-lemma-etale-standard-smooth}.

\medskip\noindent
Let $S(A)$ be the set of all {\it faithfully flat}\footnote{In the presence
of flatness, e.g., for smooth or \'etale ring maps,
this just means that the induced map on spectra is surjective. See
Algebra, Lemma \ref{algebra-lemma-ff-rings}.}
standard smooth $A$-algebras of relative dimension $0$.
Let $I(A)$ be the partially ordered (by inclusion) set of finite
subsets $E$ of $S(A)$. Note that $I(A)$ is a directed partially
ordered set. For $E = \{A \to B_1, \ldots, A \to B_n\}$ set
$$
B_E = B_1 \otimes_A \ldots \otimes_A B_n
$$
Observe that $B_E$ is a faithfully flat \'etale $A$-algebra.
For $E \subset E'$, there is a canonical transition map $B_E \to B_{E'}$
of \'etale $A$-algebras. Namely, say $E = \{A \to B_1, \ldots, A \to B_n\}$
and $E' = \{A \to B_1, \ldots, A \to B_{n + m}\}$ then
$B_E \to B_{E'}$ sends $b_1 \otimes \ldots \otimes b_n$ to the
element $b_1 \otimes \ldots \otimes b_n \otimes 1 \otimes \ldots \otimes 1$
of $B_{E'}$. This construction defines a system of faithfully flat
\'etale $A$-algebras over $I(A)$ and we set
$$
T(A) = \colim_{E \in I(A)} B_E
$$
Observe that $T(A)$ is a faitfully flat ind-\'etale $A$-algebra
(Algebra, Lemma \ref{algebra-lemma-colimit-faithfully-flat}). By construction
given any faithfully flat \'etale $A$-algebra $B$ there is a (non-unique)
$A$-algebra map $B \to T(A)$. Namely, pick some $(A \to B_0) \in S(A)$
and an isomorphism $B \cong B_0$. Then the canonical coprojection
$$
B \to B_0 \to 
T(A) = \colim_{E \in I(A)} B_E
$$
is the desired map.

\begin{lemma}
\label{lemma-first-construction}
Given a ring $A$ there exists a faithfully flat ind-\'etale $A$-algebra $C$
such that every faithfully flat \'etale ring map $C \to B$ has a section.
\end{lemma}

\begin{proof}
Set $T^1(A) = T(A)$ and $T^{n + 1}(A) = T(T^n(A))$. Let
$$
C = \colim T^n(A)
$$
This algebra is faithfully flat over each $T^n(A)$ and in particular
over $A$, see
Algebra, Lemma \ref{algebra-lemma-colimit-faithfully-flat}.
Moreover, $C$ is ind-\'etale over $A$ by Lemma \ref{lemma-ind-ind-etale}.
If $C \to B$ is \'etale, then there exists an $n$ and an \'etale
ring map $T^n(A) \to B'$ such that $B = C \otimes_{T^n(A)} B'$, see
Algebra, Lemma \ref{algebra-lemma-etale}.
If $C \to B$ is faithfully flat, then $\Spec(B) \to \Spec(C) \to \Spec(T^n(A))$
is surjective, hence $\Spec(B') \to \Spec(T^n(A))$ is surjective.
In other words, $T^n(A) \to B'$ is faithfully flat.
By our construction, there is a $T^n(A)$-algebra map
$B' \to T^{n + 1}(A)$. This induces a $C$-algebra map $B \to C$
which finishes the proof.
\end{proof}

\begin{remark}
\label{remark-size-T}
Let $A$ be a ring. Let $\kappa$ be an infinite cardinal bigger or
equal than the cardinality of $A$. Then the cardinality of $T(A)$
is at most $\kappa$. Namely, each $B_E$ has cardinality at most
$\kappa$ and the index set $I(A)$ has cardinality at most $\kappa$
as well. Thus the result follows as $\kappa \otimes \kappa = \kappa$, see
Sets, Section \ref{sets-section-cardinals}. It follows that the
ring constructed in the proof of Lemma \ref{lemma-first-construction}
has cardinality at most $\kappa$ as well.
\end{remark}

\begin{remark}
\label{remark-first-construction-functorial}
The construction $A \mapsto T(A)$ is functorial in the following sense:
If $A \to A'$ is a ring map, then we can construct a commutative diagram
$$
\xymatrix{
A \ar[r] \ar[d] & T(A) \ar[d] \\
A' \ar[r] & T(A')
}
$$
Namely, given $(A \to A[x_1, \ldots, x_n]/(f_1, \ldots, f_n))$ in
$S(A)$ we can use the ring map $\varphi : A \to A'$ to obtain a corresponding
element $(A' \to A'[x_1, \ldots, x_n]/(f^\varphi_1, \ldots, f^\varphi_n))$
of $S(A')$ where $f^\varphi$ means the polynomial obtained by applying
$\varphi$ to the coefficients of the polynomial $f$.
Moreover, there is a commutative diagram
$$
\xymatrix{
A \ar[r] \ar[d] & A[x_1, \ldots, x_n]/(f_1, \ldots, f_n) \ar[d] \\
A' \ar[r] & A'[x_1, \ldots, x_n]/(f^\varphi_1, \ldots, f^\varphi_n)
}
$$
which is a in the category of rings. For $E \subset S(A)$ finite, set
$E' = \varphi(E)$ and define $B_E \to B_{E'}$ in the obvious manner.
Taking the colimit gives the desired map $T(A) \to T(A')$, see
Categories, Lemma \ref{categories-lemma-functorial-colimit}.
\end{remark}

\begin{lemma}
\label{lemma-have-sections-quotient}
Let $A$ be a ring such that every faithfully flat \'etale ring map
$A \to B$ has a section. Then the same is true for every quotient ring
$A/I$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-have-sections-strictly-henselian}
Let $A$ be a ring such that every faithfully flat \'etale ring map
$A \to B$ has a section. Then every local ring of $A$ at a maximal
ideal is strictly henselian.
\end{lemma}

\begin{proof}
Let $\mathfrak m$ be a maximal ideal of $A$. Let $A \to B$ be an
\'etale ring map and let $\mathfrak q \subset B$ be a prime
lying over $\mathfrak m$. By the description of the strict henselization
$A_\mathfrak m^{sh}$ in
Algebra, Lemma \ref{algebra-lemma-strict-henselization-different}
it suffices to show that $A_\mathfrak m = B_\mathfrak q$.
Note that there are finitely many primes
$\mathfrak q = \mathfrak q_1, \mathfrak q_2, \ldots, \mathfrak q_n$
lying over $\mathfrak m$ and there are no specializations
between them as an \'etale ring map is quasi-finite, see
Algebra, Lemma \ref{algebra-lemma-etale-quasi-finite}.
Thus $\mathfrak q_i$ is a maximal ideal and we can find
$g \in \mathfrak q_2 \cap \ldots \cap \mathfrak q_n$, $g \not \in \mathfrak q$
(Algebra, Lemma \ref{algebra-lemma-silly}).
After replacing $B$ by $B_g$ we see that $\mathfrak q$
is the only prime of $B$ lying over $\mathfrak m$.
The image $U \subset \Spec(A)$ of $\Spec(B) \to \Spec(A)$ is
open (Algebra, Proposition \ref{algebra-proposition-fppf-open}).
Thus the complement $\Spec(A) \setminus U$ is closed
and we can find $f \in A$, $f \not \in \mathfrak p$ such that
$\Spec(A) = U \cup D(f)$. The ring map $A \to B \times A_f$
is faithfully flat and \'etale, hence has a section
$\sigma : B \times A_f \to A$ by assumption on $A$.
Observe that $\sigma$ is \'etale, hence flat as a map between \'etale
$A$-algebras (Algebra, Lemma \ref{algebra-lemma-map-between-etale}).
Since $\mathfrak q$ is the only prime of $B \times A_f$ lying
over $A$ we find that $A_\mathfrak p \to B_\mathfrak q$ has
a section which is also flat. Thus
$A_\mathfrak p \to B_\mathfrak q \to A_\mathfrak p$
are flat local ring maps whose composition is the identity. Since
a flat local homomorphism of local rings is injective we conclude these
maps are isomorphisms as desired.
\end{proof}

\begin{lemma}
\label{lemma-have-sections-localize}
Let $A$ be a ring such that every faithfully flat \'etale ring map
$A \to B$ has a section. Let $Z \subset \Spec(A)$ be a closed subscheme
of the form $D(f) \cap V(I)$ and let $A \to A_Z^\sim$ be as constructed
in Lemma \ref{lemma-localization}.
Then every faithfully flat \'etale ring map $A_Z^\sim \to C$ has
a section.
\end{lemma}

\begin{proof}
There exists an \'etale ring map $A \to B'$ such that
$C = B' \otimes_A A_Z^\sim$ as $A_Z^\sim$-algebras.
The image $U' \subset \Spec(A)$ of $\Spec(B') \to \Spec(A)$
is open and contains $V(I)$, hence we can find $f \in I$ such
that $\Spec(A) = U' \cup D(f)$. Then $A \to B' \times A_f$
is \'etale and faithfully flat. By assumption there is a section
$B' \times A_f \to A$. Localizing we obtain the desired section
$C \to A_Z^\sim$.
\end{proof}

\begin{lemma}
\label{lemma-get-w-local-algebraic-residue-field-extensions}
Let $A \to B$ be a ring map inducing algebraic extensions on residue fields.
There exists a commutative diagram
$$
\xymatrix{
B \ar[r] & D \\
A \ar[r] \ar[u] & C \ar[u]
}
$$
with the following properties:
\begin{enumerate}
\item $A \to C$ is faithfully flat and ind-\'etale,
\item $B \to D$ is faithfully flat and ind-\'etale,
\item $\Spec(C)$ is w-local,
\item $\Spec(D)$ is w-local,
\item $\Spec(D) \to \Spec(C)$ is w-local,
\item the set of closed points of $\Spec(D)$ is the inverse image
of the set of closed points of $\Spec(C)$,
\item the set of closed points of $\Spec(C)$ surjects onto $\Spec(A)$,
\item the set of closed points of $\Spec(D)$ surjects onto $\Spec(B)$,
\item for $\mathfrak m \subset C$ maximal the local ring
$C_\mathfrak m$ is strictly henselian.
\end{enumerate}
\end{lemma}

\begin{proof}
There is a faithfully flat, ind-Zariski ring map $A \to A'$ such that
$\Spec(A')$ is w-local and such that the set of closed points of
$\Spec(A')$ maps onto $\Spec(A)$, see Lemma \ref{lemma-make-w-local}.
Let $I \subset A'$ be the ideal such that $V(I)$ is the set
of closed points of $\Spec(A')$.
Choose $A' \to C'$ as in Lemma \ref{lemma-first-construction}.
Note that the local rings $C'_{\mathfrak m'}$ at maximal ideals
$\mathfrak m' \subset C'$ are strictly henselian by
Lemma \ref{lemma-have-sections-strictly-henselian}.
We apply Lemma \ref{lemma-w-local-algebraic-residue-field-extensions}
to $A' \to C'$ and $I \subset A'$ to get $C' \to C$ with $C'/IC' \cong C/IC$.
Note that since $A' \to C'$ is faithfully flat, $\Spec(C'/IC')$
surjects onto the set of closed points of $A'$ and in particular
onto $\Spec(A)$. Moreover, as $V(IC) \subset \Spec(C)$
is the set of closed points of $C$ and $C' \to C$ is ind-Zariski
(and identifies local rings) we obtain properties (1), (3), (7), and (9).

\medskip\noindent
Denote $J \subset C$ the ideal such that $V(J)$ is the set of closed
points of $\Spec(C)$. Set $D' = B \otimes_A C$. The ring
map $C \to D'$ induces algebraic residue field extensions. Keep in mind that
since $V(J) \to \Spec(A)$ is surjective the map $T = V(JD) \to \Spec(B)$
is surjective too. Apply
Lemma \ref{lemma-w-local-algebraic-residue-field-extensions}
to $C \to D'$ and $J \subset C$ to get 
$D' \to D$ with $D'/JD' \cong D/JD$.
All of the remaining properties given in the lemma are
immediate from the results of
Lemma \ref{lemma-w-local-algebraic-residue-field-extensions}.
\end{proof}








\section{Weakly \'etale versus pro-\'etale}
\label{section-weakly-etale}

\noindent
Recall that a ring homomorphism $A \to B$ is {\it weakly \'etale}
if $A \to B$ is flat and $B \otimes_A B \to B$ is flat. We have
proved some properties of such ring maps in
More on Algebra, Section \ref{more-algebra-section-weakly-etale}.
In particular, if $A \to B$ is a local homomorphism, and $A$ is a
strictly henselian local rings, then $A = B$, see
More on Algebra, Theorem \ref{more-algebra-theorem-olivier}.
Using this theorem and the work we've done above we obtain
the following structure theorem for weakly \'etale ring maps.

\begin{proposition}
\label{proposition-weakly-etale}
Let $A \to B$ be a weakly \'etale ring map.
Then there exists a faithfully flat, ind-\'etale ring map
$B \to B'$ such that $A \to B'$ is ind-\'etale.
\end{proposition}

\begin{proof}
The ring map $A \to B$ induces (separable) algebraic extensions of
residue fields, see More on Algebra, Lemma
\ref{more-algebra-lemma-weakly-etale-residue-field-extensions}.
Thus we may apply
Lemma \ref{lemma-get-w-local-algebraic-residue-field-extensions}
and choose a diagram
$$
\xymatrix{
B \ar[r] & D \\
A \ar[r] \ar[u] & C \ar[u]
}
$$
with the properties as listed in the lemma. Note that $C \to D$
is weakly \'etale by
More on Algebra, Lemma \ref{more-algebra-lemma-weakly-etale-permanence}.
Pick a maximal ideal $\mathfrak m \subset D$. By construction
this lies over a maximal ideal $\mathfrak m' \subset C$.
By More on Algebra, Theorem \ref{more-algebra-theorem-olivier}
the ring map $C_{\mathfrak m'} \to D_\mathfrak m$ is an isomorphism.
As every point of $\Spec(C)$ specializes to a closed point we conclude that
$C \to D$ identifies local rings.
Thus Proposition \ref{proposition-maps-wich-identify-local-rings}
applies to the ring map $C \to D$. Pick $D \to D'$ faithfully flat
and ind-Zariski such that $C \to D'$ is ind-Zariski. Then
$B \to D'$ is a solution to the problem posed in the proposition.
\end{proof}








\section{Constructing w-contractible covers}
\label{section-w-contractible}

\noindent
In this section we construct w-contractible covers of affine schemes.

\begin{definition}
\label{definition-w-contractible}
Let $A$ be a ring. We say $A$ is {\it w-contractible} if every
faithfully flat weakly-etale ring map $A \to B$ has a section.
\end{definition}

\noindent
We remark that by Proposition \ref{proposition-weakly-etale}
an equivalent definition would be to ask that every faithfully
flat, ind-\'etale ring map $A \to B$ has a section.
Here is a key observation.

\begin{lemma}
\label{lemma-w-local-stricly-henselian-extremally-disconnected}
Let $A$ be a ring such that
\begin{enumerate}
\item $\Spec(A)$ is w-local,
\item $\pi_0(\Spec(A))$ is extremally disconnected, and
\item for every maximal ideal $\mathfrak m \subset A$ the
local ring $A_\mathfrak m$ is strictly henselian.
\end{enumerate}
Then $A$ is w-contractible.
\end{lemma}

\begin{proof}
We will use without further mention the fact that a flat map
$A \to B$ is faithfully flat if and only if every closed point
of $\Spec(A)$ is in the image of $\Spec(B) \to \Spec(A)$
Let $A \to B$ be a faithfully flat, ind-\'etale ring map.
We will show that $A \to B$ has a section.

\medskip\noindent
Let $I \subset A$ be an ideal such that $V(I) \subset \Spec(A)$ is
the set of closed points of $\Spec(A)$. 
We may replace $B$ by the ring $C$ constructed in
Lemma \ref{lemma-w-local-algebraic-residue-field-extensions}
for $A \to B$ and $I \subset A$.
Thus we may assume $\Spec(B)$ is w-local such that the set of
closed points of $\Spec(B)$ is $V(IB)$.

\medskip\noindent
Assume $\Spec(B)$ is w-local and the set of closed points of $\Spec(B)$
is $V(IB)$. Then $A \to B$ identifies local rings by condition (3)
as it suffices to check this at maximal ideals of $B$ which lie over
maximal ideals of $A$. Choose a continuous section to the surjective
continuous map $V(IB) \to V(I)$. This is possible as
$V(I) \cong \pi_0(\Spec(A))$ is extremally disconnected, see
Topology, Proposition
\ref{topology-proposition-projective-in-category-hausdorff-qc}.
The image is a closed subspace $T \subset \pi_0(\Spec(B)) \cong V(JB)$
mapping homeomorphically onto $\pi_0(A)$. Replacing $B$ by the ind-Zariski
quotient ring constructed in Lemma \ref{lemma-construct}
we see that we may assume $\pi_0(\Spec(B)) \to \pi_0(\Spec(A))$
is bijective. At this point $A \to B$ is an isomorphism by
Lemma \ref{lemma-w-local-morphism-equal-points-stalks-is-iso}.
\end{proof}

\begin{proposition}
\label{proposition-find-w-contractible}
For every ring $A$ there exists a faithfully flat, ind-\'etale ring
map $A \to D$ such that $D$ is w-contractible.
\end{proposition}

\begin{proof}
Applying Lemma \ref{lemma-get-w-local-algebraic-residue-field-extensions}
to $\text{id}_A : A \to A$ we find a faithfully flat, ind-\'etale ring map
$A \to C$ such that $C$ is w-local and such that every local ring at a
maximal ideal of $C$ is strictly henselian.
Choose an extremally disconnected space $T$ and a surjective
continuous map $T \to \pi_0(\Spec(C))$, see
Topology, Lemma \ref{topology-lemma-existence-projective-cover}.
Note that $T$ is profinite. Apply Lemma \ref{lemma-construct-profinite}
to find an ind-Zariski ring map $C \to D$ such that
$\pi_0(\Spec(D)) \to \pi_0(\Spec(C))$ realizes $T \to \pi_0(\Spec(C))$
and such that
$$
\xymatrix{
\Spec(D) \ar[r] \ar[d] & \pi_0(\Spec(D)) \ar[d] \\
\Spec(C) \ar[r] & \pi_0(\Spec(C))
}
$$
is cartesian in the category of topological spaces. Note that $\Spec(D)$
is w-local, that $\Spec(D) \to \Spec(C)$ is w-local, and that the
set of closed points of $\Spec(D)$ is the inverse image of the
set of closed points of $\Spec(C)$, see Lemma \ref{lemma-silly}.
Thus it is still true that the local rings of $D$ at its maximal
ideals are strictly henselian (as they are isomorphic to the
local rings at the corresponding maximal ideals of $C$).
It follows from
Lemma \ref{lemma-w-local-stricly-henselian-extremally-disconnected}
that $D$ is w-contractible.
\end{proof}

\begin{remark}
\label{remark-size-w-contractible}
Let $A$ be a ring. Let $\kappa$ be an infinite cardinal bigger or
equal than the cardinality of $A$. Then the cardinality of the
ring $D$ constructed in Proposition \ref{proposition-find-w-contractible}
is at most
$$
\kappa^{2^{2^{2^\kappa}}}.
$$
Namely, the ring map $A \to D$ is
constructed as a composition
$$
A \to A_w = A' \to C' \to C \to D.
$$
Here the first three steps of the construction are carried out
in the first paragraph of the proof of
Lemma \ref{lemma-get-w-local-algebraic-residue-field-extensions}.
For the first step we have $|A_w| \leq \kappa$ by
Remark \ref{remark-size-w}.
We have $|C'| \leq \kappa$ by
Remark \ref{remark-size-T}.
Then $|C| \leq \kappa$ because $C$ is a localization of $(C')_w$
(it is constructed from $C'$ by an application of
Lemma \ref{lemma-localize-along-closed-profinite}
in the proof of Lemma \ref{lemma-w-local-algebraic-residue-field-extensions}).
Thus $C$ has at most $2^\kappa$ maximal ideals.
Finally, the ring map $C \to D$ identifies local rings and the
cardinality of the set of maximal ideals of $D$ is at most
$2^{2^{2^\kappa}}$ by
Topology, Remark \ref{topology-remark-size-projective-cover}.
Since $D \subset \prod_{\mathfrak m \subset D} D_\mathfrak m$ we see
that $D$ has at most the size displayed above.
\end{remark}






\section{The pro-\'etale site}
\label{section-proetale}

\noindent
The (small) pro-\'etale site of a scheme has some remarkable properties.
In particular, it has enough w-contractible objects which implies
a number of useful consequences for the derived category
of abelian sheaves and for inverse systems of sheaves. Thus it is
well adapted to deal with some of the intricacies of working
with $\ell$-adic sheaves.

\medskip\noindent
On the other hand, the pro-\'etale topology is a bit like
the fpqc topology (see Topologies, Section \ref{topologies-section-fpqc})
in that the topos of sheaves on the small pro-\'etale site of a scheme
depends on the choice of the underlying category of schemes. Thus we cannot
speak of {\it the} pro-\'etale topos of a scheme. However, it will be
true that the cohomology groups of a sheaf are unchanged if we enlarge
our underlying category of schemes.

\medskip\noindent
Another curiosity is that we define pro-\'etale coverings using weakly
\'etale morphisms of schemes, see
More on Morphisms, Section \ref{more-morphisms-section-weakly-etale}.
The reason is that, on the one hand, it is somewhat awkward to define
the notion of a pro-\'etale morphism of schemes, and on the other,
Proposition \ref{proposition-weakly-etale}
assures us that we obtain the same sheaves with the
definition that follows.

\begin{definition}
\label{definition-fpqc-covering}
Let $T$ be a scheme. A {\it pro-\'etale covering of $T$} is a family
of morphisms $\{f_i : T_i \to T\}_{i \in I}$ of schemes
such that each $f_i$ is weakly-\'etale and such that for every affine open
$U \subset T$ there exists $n \geq 0$, a map
$a : \{1, \ldots, n\} \to I$ and affine opens
$V_j \subset T_{a(j)}$, $j = 1, \ldots, n$
with $\bigcup_{j = 1}^n f_{a(j)}(V_j) = U$.
\end{definition}

\noindent
To be sure this condition implies that $T = \bigcup f_i(T_i)$.
Here is a lemma that will allow us to recognize pro-\'etale coverings.
It will also allow us to reduce many lemmas about pro-\'etale coverings
to the corresponding results for fpqc coverings.

\begin{lemma}
\label{lemma-recognize-proetale-covering}
Let $T$ be a scheme. Let $\{f_i : T_i \to T\}_{i \in I}$ be a family of
morphisms of schemes with target $T$. The following are equivalent
\begin{enumerate}
\item $\{f_i : T_i \to T\}_{i \in I}$ is a pro-\'etale covering,
\item each $f_i$ is weakly \'etale and $\{f_i : T_i \to T\}_{i \in I}$
is an fpqc covering,
\item each $f_i$ is weakly \'etale and for every affine open $U \subset T$
there exist quasi-compact opens $U_i \subset T_i$ which are almost all empty,
such that $U = \bigcup f_i(U_i)$,
\item each $f_i$ is weakly \'etale and there exists an affine open covering
$T = \bigcup_{\alpha \in A} U_\alpha$ and for each $\alpha \in A$
there exist $i_{\alpha, 1}, \ldots, i_{\alpha, n(\alpha)} \in I$
and quasi-compact opens $U_{\alpha, j} \subset T_{i_{\alpha, j}}$ such that
$U_\alpha =
\bigcup_{j = 1, \ldots, n(\alpha)} f_{i_{\alpha, j}}(U_{\alpha, j})$.
\end{enumerate}
If $T$ is quasi-separated, these are also equivalent to
\begin{enumerate}
\item[(5)] each $f_i$ is weakly \'etale, and for every $t \in T$ there exist
$i_1, \ldots, i_n \in I$ and quasi-compact opens $U_j \subset T_{i_j}$
such that $\bigcup_{j = 1, \ldots, n} f_{i_j}(U_j)$ is a
(not necessarily open) neighbourhood of $t$ in $T$.
\end{enumerate}
\end{lemma}

\begin{proof}
The equivalence of (1) and (2) is immediate from the definitions.
Hence the lemma follows from
Topologies, Lemma \ref{topologies-lemma-recognize-fpqc-covering}.
\end{proof}

\begin{lemma}
\label{lemma-etale-proetale}
Any \'etale covering and any Zariski covering is a pro-\'etale covering.
\end{lemma}

\begin{proof}
This folows from the corresponding result for fpqc coverings
(Topologies, Lemma
\ref{topologies-lemma-zariski-etale-smooth-syntomic-fppf-fpqc}),
Lemma \ref{lemma-recognize-proetale-covering}, and
the fact that an \'etale morphism is a weakly \'etale morphism, see
More on Morphisms, Lemma \ref{more-morphisms-lemma-when-weakly-etale}.
\end{proof}

\begin{lemma}
\label{lemma-proetale}
Let $T$ be a scheme.
\begin{enumerate}
\item If $T' \to T$ is an isomorphism then $\{T' \to T\}$
is a pro-\'etale covering of $T$.
\item If $\{T_i \to T\}_{i\in I}$ is a pro-\'etale covering and for each
$i$ we have a pro-\'etale covering $\{T_{ij} \to T_i\}_{j\in J_i}$, then
$\{T_{ij} \to T\}_{i \in I, j\in J_i}$ is a pro-\'etale covering.
\item If $\{T_i \to T\}_{i\in I}$ is a pro-\'etale covering
and $T' \to T$ is a morphism of schemes then
$\{T' \times_T T_i \to T'\}_{i\in I}$ is a pro-\'etale covering.
\end{enumerate}
\end{lemma}

\begin{proof}
This follows from the fact that composition and base changes
of weakly \'etale morphisms are weakly \'etale
(More on Morphisms, Lemmas
\ref{more-morphisms-lemma-composition-weakly-etale} and
\ref{more-morphisms-lemma-base-change-weakly-etale}),
Lemma \ref{lemma-recognize-proetale-covering}, and
the corresponding results for fpqc coverings, see
Topologies, Lemma \ref{topologies-lemma-fpqc}.
\end{proof}

\begin{lemma}
\label{lemma-proetale-affine}
Let $T$ be an affine scheme. Let $\{T_i \to T\}_{i \in I}$ be a pro-\'etale
covering of $T$. Then there exists a pro-\'etale covering
$\{U_j \to T\}_{j = 1, \ldots, n}$ which is a refinement
of $\{T_i \to T\}_{i \in I}$ such that each $U_j$ is an affine
scheme. Moreover, we may choose each $U_j$ to be open affine
in one of the $T_i$.
\end{lemma}

\begin{proof}
This follows directly from the definition.
\end{proof}

\noindent
Thus we define the corresponding standard coverings of affines as follows.

\begin{definition}
\label{definition-standard-proetale}
Let $T$ be an affine scheme. A {\it standard pro-\'etale covering}
of $T$ is a family $\{f_i : T_i \to T\}_{i = 1, \ldots, n}$
with each $T_j$ is affine, each $f_i$ is weakly \'etale, and
$T = \bigcup f_i(T_i)$.
\end{definition}

\noindent
We interrupt the discussion for any explanation of the notion
of w-contractible rings in terms of pro-\'etale coverings.

\begin{lemma}
\label{lemma-w-contractible-proetale-cover}
Let $T = \Spec(A)$ be an affine scheme. The following are equivalent
\begin{enumerate}
\item $A$ is w-contractible, and
\item every pro-\'etale covering of $T$ can be refined by
a Zariski covering of the form $T = \coprod_{i = 1, \ldots, n} U_i$.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume $A$ is w-contractible. By Lemma \ref{lemma-proetale-affine}
it suffices to prove we can refine every standard pro-\'etale covering
$\{f_i : T_i \to T\}_{i = 1, \ldots, n}$ by a Zariski covering of $T$.
The morphism $\coprod T_i \to T$ is a surjective weakly \'etale morphism
of affine schemes. Hence by Definition \ref{definition-w-contractible}
there exists a morphism $\sigma : T \to \coprod T_i$ over $T$.
Then the Zariski covering $T = \coprod \sigma^{-1}(T_i)$
refines $\{f_i : T_i \to T\}$.

\medskip\noindent
Conversely, assume (2). If $A \to B$ is faithfully flat and weakly \'etale,
then $\{\Spec(B) \to T\}$ is a pro-\'etale covering.
Hence there exists a Zariski covering $T = \coprod U_i$
and morphisms $U_i \to \Spec(B)$ over $T$. Since $T = \coprod U_i$
we obtain $T \to \Spec(B)$, i.e., an $A$-algebra map $B \to A$.
This means $A$ is w-contractible.
\end{proof}

\noindent
We follow the general outline given in
Topologies, Section \ref{topologies-section-procedure}
for constructing the big pro-\'etale site we will be working with.
However, because we need a bit larger rings to accomodate for the size
of certain constructions we modify the constructions slightly.

\begin{definition}
\label{definition-big-proetale-site}
A {\it big pro-\'etale site} is any site $\Sch_\proetale$ as in
Sites, Definition \ref{sites-definition-site} constructed as follows:
\begin{enumerate}
\item Choose any set of schemes $S_0$, and any set of pro-\'etale coverings
$\text{Cov}_0$ among these schemes.
\item Change the function $Bound$ of
Sets, Equation (\ref{sets-equation-bound}) into
$$
Bound(\kappa) = \max\{\kappa^{2^{2^{2^\kappa}}}, \kappa^{\aleph_0}, \kappa^+\}.
$$
\item As underlying category take any category $\Sch_\alpha$
constructed as in Sets, Lemma \ref{sets-lemma-construct-category}
starting with the set $S_0$ and the function $Bound$.
\item Choose any set of coverings as in
Sets, Lemma \ref{sets-lemma-coverings-site} starting with the
category $\Sch_\alpha$ and the class of pro-\'etale coverings,
and the set $\text{Cov}_0$ chosen above.
\end{enumerate}
\end{definition}

\noindent
See the remarks following
Topologies, Definition \ref{topologies-definition-big-zariski-site}
for motivation and explanation regarding the definition of big sites.

\medskip\noindent
Before we continue with the introduction of the big and small
pro-\'etale sites of a scheme, let us point out that (1) our category
contains many weakly contractible objects, and (2) the topology on a
big pro-\'etale site $\Sch_\proetale$ is in some sense induced from
the pro-\'etale topology on the category of all schemes.

\begin{lemma}
\label{lemma-w-contractible-is-weakly-contractible}
Let $\Sch_\proetale$ be a big pro-\'etale site as in
Definition \ref{definition-big-proetale-site}.
Let $T = \Spec(A)$ be an affine object of $\Sch_\proetale$.
If $A$ is w-contractible, then $T$ is a weakly contractible
(Cohomology of Sites, Definition
\ref{sites-definition-w-contractible})
object of $\Sch_\proetale$.
\end{lemma}

\begin{proof}
Let $\mathcal{F} \to \mathcal{G}$ be a surjection of sheaves on
$\Sch_\proetale$. Let $s \in \mathcal{G}(T)$. We have to show that
$s$ is in the image of $\mathcal{F}(T) \to \mathcal{G}(T)$. We can find a
covering $\{T_i \to T\}$ of $\Sch_\proetale$ such that $s$ lifts
to a section of $\mathcal{F}$ over $T_i$
(Sites, Definition \ref{sites-definition-sheaves-injective-surjective}).
By Lemma \ref{lemma-w-contractible-proetale-cover}
we can refine $\{T_i \to T\}$ by a Zariski
covering of the form $T = \coprod_{j = 1, \ldots, m} V_j$.
Hence we get $t_j \in \mathcal{F}(U_j)$ mapping to $s|_{U_j}$.
Since Zariski coverings are coverings in $\Sch_\proetale$
(Lemma \ref{lemma-etale-proetale}) we conclude that
$\mathcal{F}(T) = \prod \mathcal{F}(U_j)$.
Thus, taking $t = (t_1, \ldots, t_m) \in \mathcal{F}(T)$
is a section mapping to $s$.
\end{proof}

\begin{lemma}
\label{lemma-get-many-weakly-contractible}
Let $\Sch_\proetale$ be a big pro-\'etale site as in
Definition \ref{definition-big-proetale-site}.
For every object $T$ of $\Sch_\proetale$ there exists
a covering $\{T_i \to T\}$ in $\Sch_\proetale$
with each $T_i$ affine and the spectrum of a w-contractible
ring. In particular, $T_i$ is weakly contractible in $\Sch_\proetale$.
\end{lemma}

\begin{proof}
For those readers who do not care about set-theoretical isssues
this lemma is a trivial consequence of
Lemma \ref{lemma-w-contractible-is-weakly-contractible} and
Proposition \ref{proposition-find-w-contractible}.
Here are the details.
Choose an affine open covering $T = \bigcup U_i$. Write $U_i = \Spec(A_i)$.
Choose faithfully flat, ind-\'etale ring maps $A_i \to D_i$
such that $D_i$ is w-contractible as in
Proposition \ref{proposition-find-w-contractible}.
The family of morphisms $\{\Spec(D_i) \to T\}$ is a
pro-\'etale covering.
If we can show that $\Spec(D_i)$ is isomorphic to an object, say $T_i$,
of $\Sch_\proetale$, then $\{T_i \to T\}$ will be combinatorially
equivalent to a covering of $\Sch_\proetale$ by the construction
of $\Sch_\proetale$ in Definition \ref{definition-big-proetale-site}
and more precisely the application of
Sets, Lemma \ref{sets-lemma-coverings-site} in the last step.
To prove $\Spec(D_i)$ is isomorphic to an object of
$\Sch_\proetale$, it suffices to prove that
$|D_i| \leq Bound(\text{Size}(T))$ by the construction
of $\Sch_\proetale$ in Definition \ref{definition-big-proetale-site}
and more precisely the application of
Sets, Lemma \ref{sets-lemma-construct-category} in step (3).
Since $|A_i| \leq \text{size}(U_i) \leq \text{size}(T)$
by Sets, Lemmas \ref{sets-lemma-bound-affine} and
\ref{sets-lemma-bound-finite-type} we get
$|D_i| \leq \kappa^{2^{2^{2^\kappa}}}$ where $\kappa = \text{size}(T)$
by Remark \ref{remark-size-w-contractible}.
Thus by our choice of the function $Bound$ in
Definition \ref{definition-big-proetale-site} we win.
\end{proof}

\begin{lemma}
\label{lemma-proetale-induced}
Let $\Sch_\proetale$ be a big pro-\'etale site as in
Definition \ref{definition-big-proetale-site}.
Let $T \in \Ob(\Sch_\proetale)$.
Let $\{T_i \to T\}_{i \in I}$ be an arbitrary pro-\'etale covering of $T$.
There exists a covering $\{U_j \to T\}_{j \in J}$ of $T$ in the site
$\Sch_\proetale$ which refines $\{T_i \to T\}_{i \in I}$.
\end{lemma}

\begin{proof}
Namely, we first let $\{V_k \to T\}$ be a covering as in
Lemma \ref{lemma-get-many-weakly-contractible}.
Then the pro-\'etale coverings $\{T_i \times_T V_k \to V_k\}$
can be refined by a finite disjoint open covering
$V_k = V_{k, 1} \amalg \ldots \amalg V_{k, n_k}$, see
Lemma \ref{lemma-w-contractible-proetale-cover}.
Then $\{V_{k, i} \to T\}$ is a covering of $\Sch_\proetale$
which refines $\{T_i \to T\}_{i \in I}$.
\end{proof}

\begin{definition}
\label{definition-big-small-proetale}
Let $S$ be a scheme. Let $\Sch_\proetale$ be a big pro-\'etale
site containing $S$.
\begin{enumerate}
\item The {\it big pro-\'etale site of $S$}, denoted
$(\Sch/S)_\proetale$, is the site $\Sch_\proetale/S$
introduced in Sites, Section \ref{sites-section-localize}.
\item The {\it small pro-\'etale site of $S$}, which we denote
$S_\proetale$, is the full subcategory of $(\Sch/S)_\proetale$
whose objects are those $U/S$ such that $U \to S$ is weakly \'etale.
A covering of $S_\proetale$ is any covering $\{U_i \to U\}$ of
$(\Sch/S)_\proetale$ with $U \in \Ob(S_\proetale)$.
\item The {\it big affine pro-\'etale site of $S$}, denoted
$(\textit{Aff}/S)_\proetale$, is the full subcategory of
$(\Sch/S)_\proetale$ whose objects are affine $U/S$.
A covering of $(\textit{Aff}/S)_\proetale$ is any covering
$\{U_i \to U\}$ of $(\Sch/S)_\proetale$ which is a
standard pro-\'etale covering.
\end{enumerate}
\end{definition}

\noindent
It is not completely clear that the small pro-\'etale site and
the big affine pro-\'etale site are sites. We check this now.

\begin{lemma}
\label{lemma-verify-site-proetale}
Let $S$ be a scheme. Let $\Sch_\proetale$ be a big pro-\'etale site
containing $S$. Both $S_\proetale$ and $(\textit{Aff}/S)_\proetale$ are sites.
\end{lemma}

\begin{proof}
Let us show that $S_\proetale$ is a site. It is a category with a
given set of families of morphisms with fixed target. Thus we
have to show properties (1), (2) and (3) of
Sites, Definition \ref{sites-definition-site}.
Since $(\Sch/S)_\proetale$ is a site, it suffices to prove
that given any covering $\{U_i \to U\}$ of $(\Sch/S)_\proetale$
with $U \in \Ob(S_\proetale)$ we also have $U_i \in \Ob(S_\proetale)$.
This follows from the definitions
as the composition of weakly \'etale morphisms is weakly \'etale.

\medskip\noindent
To show that $(\textit{Aff}/S)_\proetale$ is a site, reasoning as above,
it suffices to show that the collection of standard pro-\'etale coverings
of affines satisfies properties (1), (2) and (3) of
Sites, Definition \ref{sites-definition-site}.
This follows from Lemma \ref{lemma-recognize-proetale-covering}
and the corresponding result for standard fpqc coverings
(Topologies, Lemma \ref{topologies-lemma-fpqc-affine-axioms}).
\end{proof}

\begin{lemma}
\label{lemma-fibre-products-proetale}
Let $S$ be a scheme. Let $\Sch_\proetale$ be a big pro-\'etale
site containing $S$. Let $\Sch$ be the category of all schemes.
\begin{enumerate}
\item The categories $\Sch_\proetale$, $(\Sch/S)_\proetale$,
$S_\proetale$, and $(\textit{Aff}/S)_\proetale$ have fibre products
agreeing with fibre products in $\Sch$.
\item The categories $\Sch_\proetale$, $(\Sch/S)_\proetale$,
$S_\proetale$ have equalizers agreeing with equalizers in $\Sch$.
\item The categories $(\Sch/S)_\proetale$, and $S_\proetale$ both have
a final object, namely $S/S$.
\item The category $\Sch_\proetale$ has a final object agreeing
with the final object of $\Sch$, namely $\Spec(\mathbf{Z})$.
\end{enumerate}
\end{lemma}

\begin{proof}
The category $\Sch_\proetale$ contains $\Spec(\mathbf{Z})$ and
is closed under products and fibre products by construction, see
Sets, Lemma \ref{sets-lemma-what-is-in-it}.
Suppose we have $U \to S$, $V \to U$, $W \to U$ morphisms
of schemes with $U, V, W \in \Ob(\Sch_\proetale)$.
The fibre product $V \times_U W$ in $\Sch_\proetale$
is a fibre product in $\Sch$ and
is the fibre product of $V/S$ with $W/S$ over $U/S$ in
the category of all schemes over $S$, and hence also a
fibre product in $(\Sch/S)_\proetale$.
This proves the result for $(\Sch/S)_\proetale$.
If $U \to S$, $V \to U$ and $W \to U$ are weakly \'etale then so is
$V \times_U W \to S$ (see
More on Morphisms, Section \ref{more-morphisms-section-weakly-etale})
and hence we get fibre products for $S_\proetale$.
If $U, V, W$ are affine, so is $V \times_U W$ and hence we
get fibre products for $(\textit{Aff}/S)_\proetale$.

\medskip\noindent
Let $a, b : U \to V$ be two morphisms in $\Sch_\proetale$.
In this case the equalizer of $a$ and $b$ (in the category of schemes) is
$$
V
\times_{\Delta_{V/\Spec(\mathbf{Z})}, V \times_{\Spec(\mathbf{Z})} V, (a, b)}
(U \times_{\Spec(\mathbf{Z})} U)
$$
which is an object of $\Sch_\proetale$ by what we saw above.
Thus $\Sch_\proetale$ has equalizers. If $a$ and $b$ are morphisms over $S$,
then the equalizer (in the category of schemes) is also given by
$$
V \times_{\Delta_{V/S}, V \times_S V, (a, b)} (U \times_S U)
$$
hence we see that $(\Sch/S)_\proetale$ has equalizers. Moreover, if
$U$ and $V$ are weakly-\'etale over $S$, then so is the equalizer
above as a fibre product of schemes weakly \'etale over $S$.
Thus $S_\proetale$ has equalizers. The statements on final objects
is clear.
\end{proof}

\noindent
Next, we check that the big pro-\'etale site defines the same
topos as the big pro-\'etale site.

\begin{lemma}
\label{lemma-affine-big-site-proetale}
Let $S$ be a scheme. Let $\Sch_\proetale$ be a big pro-\'etale
site containing $S$.
The functor $(\textit{Aff}/S)_\proetale \to (\Sch/S)_\proetale$
is a special cocontinuous functor. Hence it induces an equivalence
of topoi from $\Sh((\textit{Aff}/S)_\proetale)$ to
$\Sh((\Sch/S)_\proetale)$.
\end{lemma}

\begin{proof}
The notion of a special cocontinuous functor is introduced in
Sites, Definition \ref{sites-definition-special-cocontinuous-functor}.
Thus we have to verify assumptions (1) -- (5) of
Sites, Lemma \ref{sites-lemma-equivalence}.
Denote the inclusion functor
$u : (\textit{Aff}/S)_\proetale \to (\Sch/S)_\proetale$.
Being cocontinuous just means that any pro-\'etale covering of
$T/S$, $T$ affine, can be refined by a standard pro-\'etale
covering of $T$. This is the content of
Lemma \ref{lemma-proetale-affine}.
Hence (1) holds. We see $u$ is continuous simply because a standard
pro-\'etale covering is a pro-\'etale covering. Hence (2) holds.
Parts (3) and (4) follow immediately from the fact that $u$ is
fully faithful. And finally condition (5) follows from the
fact that every scheme has an affine open covering.
\end{proof}

\begin{lemma}
\label{lemma-put-in-T}
Let $\Sch_\proetale$ be a big pro-\'etale site.
Let $f : T \to S$ be a morphism in $\Sch_\proetale$.
The functor $T_\proetale \to (\Sch/S)_\proetale$
is cocontinuous and induces a morphism of topoi
$$
i_f :
\Sh(T_\proetale)
\longrightarrow
\Sh((\Sch/S)_\proetale)
$$
For a sheaf $\mathcal{G}$ on $(\Sch/S)_\proetale$
we have the formula $(i_f^{-1}\mathcal{G})(U/T) = \mathcal{G}(U/S)$.
The functor $i_f^{-1}$ also has a left adjoint $i_{f, !}$ which commutes
with fibre products and equalizers.
\end{lemma}

\begin{proof}
Denote the functor $u : T_\proetale \to (\Sch/S)_\proetale$.
In other words, given a weakly \'etale morphism $j : U \to T$ corresponding
to an object of $T_\proetale$ we set $u(U \to T) = (f \circ j : U \to S)$.
This functor commutes with fibre products, see
Lemma \ref{lemma-fibre-products-proetale}.
Moreover, $T_\proetale$ has equalizers and $u$ commutes with them
by Lemma \ref{lemma-fibre-products-proetale}.
It is clearly cocontinuous.
It is also continuous as $u$ transforms coverings to coverings and
commutes with fibre products. Hence the lemma follows from
Sites, Lemmas \ref{sites-lemma-when-shriek}
and \ref{sites-lemma-preserve-equalizers}.
\end{proof}

\begin{lemma}
\label{lemma-at-the-bottom}
Let $S$ be a scheme. Let $\Sch_\proetale$ be a big pro-\'etale
site containing $S$.
The inclusion functor $S_\proetale \to (\Sch/S)_\proetale$
satisfies the hypotheses of Sites, Lemma \ref{sites-lemma-bigger-site}
and hence induces a morphism of sites
$$
\pi_S : (\Sch/S)_\proetale \longrightarrow S_\proetale
$$
and a morphism of topoi
$$
i_S : \Sh(S_\proetale) \longrightarrow \Sh((\Sch/S)_\proetale)
$$
such that $\pi_S \circ i_S = \text{id}$. Moreover, $i_S = i_{\text{id}_S}$
with $i_{\text{id}_S}$ as in Lemma \ref{lemma-put-in-T}. In particular the
functor $i_S^{-1} = \pi_{S, *}$ is described by the rule
$i_S^{-1}(\mathcal{G})(U/S) = \mathcal{G}(U/S)$.
\end{lemma}

\begin{proof}
In this case the functor $u : S_\proetale \to (\Sch/S)_\proetale$,
in addition to the properties seen in the proof of
Lemma \ref{lemma-put-in-T} above, also is fully faithful
and transforms the final object into the final object.
The lemma follows from Sites, Lemma \ref{sites-lemma-bigger-site}.
\end{proof}

\begin{definition}
\label{definition-restriction-small-proetale}
In the situation of
Lemma \ref{lemma-at-the-bottom}
the functor $i_S^{-1} = \pi_{S, *}$ is often
called the {\it restriction to the small pro-\'etale site}, and for a sheaf
$\mathcal{F}$ on the big pro-\'etale site we denote
$\mathcal{F}|_{S_\proetale}$ this restriction.
\end{definition}

\noindent
With this notation in place we have for a sheaf $\mathcal{F}$ on the
big site and a sheaf $\mathcal{G}$ on the big site that
\begin{align*}
\Mor_{\Sh(S_\proetale)}(\mathcal{F}|_{S_\proetale}, \mathcal{G})
& =
\Mor_{\Sh((\Sch/S)_\proetale)}(\mathcal{F},
i_{S, *}\mathcal{G}) \\
\Mor_{\Sh(S_\proetale)}(\mathcal{G}, \mathcal{F}|_{S_\proetale})
& =
\Mor_{\Sh((\Sch/S)_\proetale)}(\pi_S^{-1}\mathcal{G}, \mathcal{F})
\end{align*}
Moreover, we have $(i_{S, *}\mathcal{G})|_{S_\proetale} = \mathcal{G}$
and we have $(\pi_S^{-1}\mathcal{G})|_{S_\proetale} = \mathcal{G}$.

\begin{lemma}
\label{lemma-morphism-big}
Let $\Sch_\proetale$ be a big pro-\'etale site.
Let $f : T \to S$ be a morphism in $\Sch_\proetale$.
The functor
$$
u : (\Sch/T)_\proetale \longrightarrow (\Sch/S)_\proetale, \quad
V/T \longmapsto V/S
$$
is cocontinuous, and has a continuous right adjoint
$$
v : (\Sch/S)_\proetale \longrightarrow (\Sch/T)_\proetale, \quad
(U \to S) \longmapsto (U \times_S T \to T).
$$
They induce the same morphism of topoi
$$
f_{big} :
\Sh((\Sch/T)_\proetale)
\longrightarrow
\Sh((\Sch/S)_\proetale)
$$
We have $f_{big}^{-1}(\mathcal{G})(U/T) = \mathcal{G}(U/S)$.
We have $f_{big, *}(\mathcal{F})(U/S) = \mathcal{F}(U \times_S T/T)$.
Also, $f_{big}^{-1}$ has a left adjoint $f_{big!}$ which commutes with
fibre products and equalizers.
\end{lemma}

\begin{proof}
The functor $u$ is cocontinuous, continuous, and commutes with fibre products
and equalizers (details omitted; compare with proof of
Lemma \ref{lemma-put-in-T}). Hence
Sites, Lemmas \ref{sites-lemma-when-shriek} and
\ref{sites-lemma-preserve-equalizers}
apply and we deduce the formula
for $f_{big}^{-1}$ and the existence of $f_{big!}$. Moreover,
the functor $v$ is a right adjoint because given $U/T$ and $V/S$
we have $\Mor_S(u(U), V) = \Mor_T(U, V \times_S T)$
as desired. Thus we may apply
Sites, Lemmas \ref{sites-lemma-have-functor-other-way} and
\ref{sites-lemma-have-functor-other-way-morphism}
to get the formula for $f_{big, *}$.
\end{proof}

\begin{lemma}
\label{lemma-morphism-big-small}
Let $\Sch_\proetale$ be a big pro-\'etale site.
Let $f : T \to S$ be a morphism in $\Sch_\proetale$.
\begin{enumerate}
\item We have $i_f = f_{big} \circ i_T$ with $i_f$ as in
Lemma \ref{lemma-put-in-T} and $i_T$ as in
Lemma \ref{lemma-at-the-bottom}.
\item The functor $S_\proetale \to T_\proetale$,
$(U \to S) \mapsto (U \times_S T \to T)$ is continuous and induces
a morphism of topoi
$$
f_{small} : \Sh(T_\proetale) \longrightarrow \Sh(S_\proetale).
$$
We have $f_{small, *}(\mathcal{F})(U/S) = \mathcal{F}(U \times_S T/T)$.
\item We have a commutative diagram of morphisms of sites
$$
\xymatrix{
T_\proetale \ar[d]_{f_{small}} &
(\Sch/T)_\proetale \ar[d]^{f_{big}} \ar[l]^{\pi_T}\\
S_\proetale &
(\Sch/S)_\proetale \ar[l]_{\pi_S}
}
$$
so that $f_{small} \circ \pi_T = \pi_S \circ f_{big}$ as morphisms of topoi.
\item We have $f_{small} = \pi_S \circ f_{big} \circ i_T = \pi_S \circ i_f$.
\end{enumerate}
\end{lemma}

\begin{proof}
The equality $i_f = f_{big} \circ i_T$ follows from the
equality $i_f^{-1} = i_T^{-1} \circ f_{big}^{-1}$ which is
clear from the descriptions of these functors above.
Thus we see (1).

\medskip\noindent
The functor $u : S_\proetale \to T_\proetale$,
$u(U \to S) = (U \times_S T \to T)$
transforms coverings into coverings and commutes with fibre products,
see Lemmas \ref{lemma-proetale} and \ref{lemma-fibre-products-proetale}.
Moreover, both $S_\proetale$, $T_\proetale$ have final objects,
namely $S/S$ and $T/T$ and $u(S/S) = T/T$. Hence by
Sites, Proposition \ref{sites-proposition-get-morphism}
the functor $u$ corresponds to a morphism of sites
$T_\proetale \to S_\proetale$. This in turn gives rise to the
morphism of topoi, see
Sites, Lemma \ref{sites-lemma-morphism-sites-topoi}. The description
of the pushforward is clear from these references.

\medskip\noindent
Part (3) follows because $\pi_S$ and $\pi_T$ are given by the
inclusion functors and $f_{small}$ and $f_{big}$ by the
base change functors $U \mapsto U \times_S T$.

\medskip\noindent
Statement (4) follows from (3) by precomposing with $i_T$.
\end{proof}

\noindent
In the situation of the lemma, using the terminology of
Definition \ref{definition-restriction-small-proetale}
we have: for $\mathcal{F}$ a sheaf on the big pro-\'etale site of $T$
$$
(f_{big, *}\mathcal{F})|_{S_\proetale} =
f_{small, *}(\mathcal{F}|_{T_\proetale}),
$$
This equality is clear from the commutativity of the diagram of
sites of the lemma, since restriction to the small pro-\'etale site of
$T$, resp.\ $S$ is given by $\pi_{T, *}$, resp.\ $\pi_{S, *}$. A similar
formula involving pullbacks and restrictions is false.

\begin{lemma}
\label{lemma-composition-proetale}
Given schemes $X$, $Y$, $Y$ in $\Sch_\proetale$
and morphisms $f : X \to Y$, $g : Y \to Z$ we have
$g_{big} \circ f_{big} = (g \circ f)_{big}$ and
$g_{small} \circ f_{small} = (g \circ f)_{small}$.
\end{lemma}

\begin{proof}
This follows from the simple description of pushforward
and pullback for the functors on the big sites from
Lemma \ref{lemma-morphism-big}. For the functors
on the small sites this follows from the description of
the pushforward functors in Lemma \ref{lemma-morphism-big-small}.
\end{proof}

\noindent
We can think about a sheaf on the big pro-\'etale site of $S$ as a collection
of sheaves on the small pro-\'etale site on schemes over $S$.

\begin{lemma}
\label{lemma-characterize-sheaf-big}
Let $S$ be a scheme contained in a big pro-\'etale site $\Sch_\proetale$.
A sheaf $\mathcal{F}$ on the big pro-\'etale site $(\Sch/S)_\proetale$
is given by the following data:
\begin{enumerate}
\item for every $T/S \in \Ob((\Sch/S)_\proetale)$ a sheaf
$\mathcal{F}_T$ on $T_\proetale$,
\item for every $f : T' \to T$ in
$(\Sch/S)_\proetale$ a map
$c_f : f_{small}^{-1}\mathcal{F}_T \to \mathcal{F}_{T'}$.
\end{enumerate}
These data are subject to the following conditions:
\begin{enumerate}
\item[(\romannumeral1)] given any $f : T' \to T$ and $g : T'' \to T'$ in
$(\Sch/S)_\proetale$ the composition
$g_{small}^{-1}c_f \circ c_g$ is equal to $c_{f \circ g}$, and
\item[(\romannumeral2)] if $f : T' \to T$ in $(\Sch/S)_\proetale$
is weakly \'etale then $c_f$ is an isomorphism.
\end{enumerate}
\end{lemma}

\begin{proof}
Identical to the proof of
Topologies, Lemma \ref{topologies-lemma-characterize-sheaf-big-etale}.
\end{proof}

\begin{lemma}
\label{lemma-alternative}
Let $S$ be a scheme. Let $S_{affine, \proetale}$ denote the full subcategory
of $S_\proetale$ consisting of affine objects. A covering of
$S_{affine, \proetale}$ will be a standard \'etale covering, see
Definition \ref{definition-standard-proetale}.
Then restriction
$$
\mathcal{F} \longmapsto \mathcal{F}|_{S_{affine, \acute{e}tale}}
$$
defines an equivalence of topoi
$\Sh(S_\proetale) \cong \Sh(S_{affine, \proetale})$.
\end{lemma}

\begin{proof}
This you can show directly from the definitions, and is a good exercise.
But it also follows immediately from
Sites, Lemma \ref{sites-lemma-equivalence}
by checking that the inclusion functor
$S_{affine, \proetale} \to S_\proetale$
is a special cocontinuous functor (see
Sites, Definition \ref{sites-definition-special-cocontinuous-functor}).
\end{proof}

\noindent
Next we show that cohomology of sheaves is independent of the choice
of a partial universe. Namely, the functor $g_*$ of the lemma below
is an embedding of pro-\'etale topoi which does not change cohomology.

\begin{lemma}
\label{lemma-proetale-cohomology-independent-partial-universe}
Let $S$ be a scheme. Let $S_\proetale \subset S_\proetale'$ be
two small pro-\'etale sites of $S$ as constructed in
Definition \ref{definition-big-small-proetale}. Then the inclusion functor
satisfies the assumptions of 
Sites, Lemma \ref{sites-lemma-bigger-site}.
Hence there exist morphisms of topoi
$$
\xymatrix{
\Sh(S_\proetale) \ar[r]^g &
\Sh(S_\proetale') \ar[r]^f &
\Sh(S_\proetale)
}
$$
whose composition is isomorphic to the identity and with $f_* = g^{-1}$.
Moreover,
\begin{enumerate}
\item for $\mathcal{F}' \in \textit{Ab}(S_\proetale')$ we have
$H^p(S_\proetale', \mathcal{F}') = H^p(S_\proetale, g^{-1}\mathcal{F}')$,
\item for $\mathcal{F} \in \textit{Ab}(S_\proetale)$ we have
$$
H^p(S_\proetale, \mathcal{F}) =
H^p(S_\proetale', g_*\mathcal{F}) =
H^p(S_\proetale', f^{-1}\mathcal{F}).
$$
\end{enumerate}
\end{lemma}

\begin{proof}
The inclusion functor is fully faithful and continuous.
We have seen that $S_\proetale$ and $S_\proetale'$ have fibre products
and final objects and that our functor commutes with these
(Lemma \ref{lemma-fibre-products-proetale}).
It follows from Lemma \ref{lemma-proetale-induced}
that the inclusion functor is cocontinuous.
Hence the existence of $f$ and $g$ follows from
Sites, Lemma \ref{sites-lemma-bigger-site}.
The equality in (1) is
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-cohomology-bigger-site}.
Part (2) follows from (1) as
$\mathcal{F} = g^{-1}g_*\mathcal{F} = g^{-1}f^{-1}\mathcal{F}$.
\end{proof}

\begin{lemma}
\label{lemma-proetale-subcanonical}
Let $S$ be a scheme. The topology on each of the pro-\'etale sites
$S_\proetale$, $(\Sch/S)_\proetale$, $S_{affine, \proetale}$, and
$(\textit{Aff}/S)_\proetale$ is subcanonical.
\end{lemma}

\begin{proof}
Combine Lemma \ref{lemma-recognize-proetale-covering} and
Descent, Lemma \ref{descent-lemma-fpqc-universal-effective-epimorphisms}.
\end{proof}

\begin{lemma}
\label{lemma-proetale-enough-w-contractible}
Let $S$ be a scheme. The pro-\'etale sites
$S_\proetale$, $(\Sch/S)_\proetale$, $S_{affine, \proetale}$, and
$(\textit{Aff}/S)_\proetale$ have enough quasi-compact, weakly contractible
objects, see Sites, Definition \ref{sites-definition-w-contractible}.
\end{lemma}

\begin{proof}
Follows immediately from Lemma \ref{lemma-get-many-weakly-contractible}.
\end{proof}







\section{Points of the pro-\'etale site}
\label{section-points}

\noindent
We first apply Deligne's criterion to show that there are enough points.

\begin{lemma}
\label{lemma-points-proetale}
Let $S$ be a scheme. The pro-\'etale sites
$S_\proetale$, $(\Sch/S)_\proetale$, $S_{affine, \proetale}$, and
$(\textit{Aff}/S)_\proetale$ have enough points.
\end{lemma}

\begin{proof}
The big topos is equivalent to the topos defined by
$(\textit{Aff}/S)_\proetale$, see
Lemma \ref{lemma-affine-big-site-proetale}.
The topos of sheaves on $S_\proetale$ is equivalent to the topos
associated to $S_{affine, \proetale}$, see
Lemma \ref{lemma-alternative}.
The result for the sites $(\textit{Aff}/S)_\proetale$ and
$S_{affine, \proetale}$ follows immediately from Deligne's result
Sites, Proposition \ref{sites-proposition-criterion-points}.
\end{proof}

\noindent
Let $S$ be a scheme. Let $\overline{s} : \Spec(k) \to S$ be a geometric
point. We define a {\it pro-\'etale neighbourhood} of $\overline{s}$
to be a commutative diagram
$$
\xymatrix{
\Spec(k) \ar[r]_-{\overline{u}} \ar[rd]_{\overline{s}} & U \ar[d] \\
& S
}
$$
with $U \to S$ weakly \'etale. In exactly the same manner as in the
chapter on \'etale cohomogy one shows that the category of pro-\'etale
neighbourhoods of $\overline{s}$ is cofiltered. Moreover, if
$(U, \overline{u})$ is a pro-\'etale neighbourhood, and if $\{U_i \to U\}$
is a pro-\'etale covering, then there exists an $i$ and a lift of
$\overline{u}$ to a geometric point $\overline{u}_i$ of $U_i$.
For $\mathcal{F}$ in $\Sh(S_\proetale)$ define the {\it stalk
of $\mathcal{F}$ at $\overline{s}$} by the formula
$$
\mathcal{F}_{\overline{s}} = \colim_{(U, \overline{u})} \mathcal{F}(U)
$$
where the colimit is over all \'etale neighbourhoods $(U, \overline{u})$
of $\overline{s}$ with $U \in \Ob(S_\proetale)$.
A formal argument using the facts above shows the functor
$\mathcal{F} \mapsto \mathcal{F}_{\overline{s}}$
defines a point of the topos $\Sh(S_\proetale)$:
it is an exact functor which commutes with arbitrary colimits.

\medskip\noindent
Contrary to the situation with the \'etale topos of $S$ it is not true
that every point of $\Sh(S_\proetale)$ is of this form, and it is not
true that the collection of points associated to geometric point is
conservative. Namely, suppose that $S = \Spec(k)$ where $k$ is an
algebraically closed field. Let $A$ be an abelian group.
Consider the sheaf $\mathcal{F}$ on $S_\proetale$ defined by the rule
$$
\mathcal{F}(U) = \frac{\{\text{functions }U \to A\}}%
{\{\text{locally constant functions}\}}
$$
Then $\mathcal{F}(U) = 0$ if $U = S = \Spec(k)$ but in general $\mathcal{F}$
is not zero. Namely, $S_\proetale$ contains objects with infinitely many
points. For example, let $E = \lim E_n$ be an inverse limit of
finite sets with surjective transition maps,
e.g., $E = \lim \mathbf{Z}/n\mathbf{Z}$.
The scheme $\Spec(\colim \text{Map}(E_n, k))$
is an object of $S_\proetale$ because $\colim \text{Map}(E_n, k)$
is weakly \'etale (even ind-Zariski) over $k$.
Thus $\mathcal{F}$ is a nonzero abelian sheaf whose stalk at the
unique geometric point of $S$ is zero.

\medskip\noindent
The solution is to use the existence of quasi-compact, weakly contractible
objects. First, there are enough quasi-compact, weakly contractible objects by
Lemma \ref{lemma-proetale-enough-w-contractible}.
Second, if $W \in \Ob(S_\proetale)$ is quasi-compact, weakly contractible,
then the functor
$$
\Sh(S_\proetale) \longrightarrow \textit{Sets},\quad
\mathcal{F} \longmapsto \mathcal{F}(W)
$$
is an exact functor $\Sh(S_\proetale) \to \textit{Sets}$ which commutes
with all limits. The functor
$$
\textit{Ab}(S_\proetale) \longrightarrow \textit{Ab},\quad
\mathcal{F} \longmapsto \mathcal{F}(W)
$$
is exact and commutes with direct sums (as $W$ is quasi-compact, see
Sites, Lemma \ref{sites-lemma-directed-colimits-sections}), hence
commutes with all limits and colimits. Moreover, we can check exactness of
a complex of abelian sheaves by evaluation at the
quasi-compact, weakly contractible objects of $S_\proetale$, see
Cohomology on Sites, Proposition
\ref{sites-cohomology-proposition-enough-weakly-contractibles}.




\section{Compact generation}
\label{section-compact-generation}

\noindent
Let $S$ be a scheme. The site $S_\proetale$ has enough quasi-compact,
weakly contractible objects $U$. For any sheaf of rings $\mathcal{A}$
on $S_\proetale$ the corresponding objects $j_{U!}\mathcal{A}_U$
are compact objects of the derived category $D(\mathcal{A})$, see
Cohomology on Sites, Lemma
\ref{sites-cohomology-lemma-quasi-compact-weakly-contractible-compact}.
Since every complex of $\mathcal{A}$-modules is quasi-isomorphic to
a complex whose terms are direct sums of the modules
$j_{U!}\mathcal{A}_U$ (details omitted). Thus we see that
$D(\mathcal{A})$ is generated by its compact objects.

\medskip\noindent
The same argument works for the big pro-\'etale site of $S$.














\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
