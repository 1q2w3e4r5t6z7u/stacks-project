\input{preamble}

% OK, start here.
%
\begin{document}

\title{Derived Categories}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
We first discuss triangulated categories and localization in triangulated
categories. Next, we prove that the homotopy category of complexes in an
additive category is a triangulated category. Once this is done we define
the derived category of an abelian category as the localization of the
of homotopy category with respect to quasi-isomorphisms.
A good reference is Verdier's thesis \cite{Verdier}.



\section{Triangulated categories}
\label{section-triangulated-categories}

\noindent
Triangulated categories are a convenient tool to describe the type
of structure inherent in the derived category of an abelian category.
Some references are \cite{Verdier} and \cite{Neeman}.




\section{Triangulated categories: Definitions}
\label{section-triangulated-definitions}

\noindent
In this section we collect most of the definitions concerning triangulated
and pre-triangulated categories.

\begin{definition}
\label{definition-triangle}
Let $\mathcal{D}$ be an additive category.
Let $[n] : \mathcal{D} \to \mathcal{D}$, $E \mapsto E[n]$
be a collection of additive functors indexed by $n \in \mathbf{Z}$ such that
$[n] \circ [m] = [n + m]$  and $[0] = \text{id}$ (equality as functors).
In this situation
we call {\it triangle} a sixtuple $(X, Y, Z, f, g, h)$
where $X, Y, Z \in \text{Ob}(\mathcal{D})$ and
$f : X \to Y$, $g : Y \to Z$ and $h : Z \to X[1]$ are morphisms
of $\mathcal{D}$.
A {\it morphism of triangles}
$(X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')$
is given by morphisms $a : X \to X'$, $b : Y \to Y'$ and $c : Z \to Z'$
of $\mathcal{D}$ such that
$b \circ f = f' \circ a$, $c  \circ g = g' \circ b$ and
$a[1] \circ h = h' \circ c$.
\end{definition}

\noindent
A morphism of triangles is visualized by the following
commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^a &
Y \ar[r] \ar[d]^b &
Z \ar[r] \ar[d]^c &
X[1] \ar[d]^{a[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
Here is the definition of a triangulated category as given in
Verdier's thesis.

\begin{definition}
\label{definition-triangulated-category}
A {\it triangulated category} consists of a triple
$(\mathcal{D}, \{[n]\}_{n\in \mathbf{Z}}, \mathcal{T})$
where
\begin{enumerate}
\item $\mathcal{D}$ is an additive category,
\item $[n] : \mathcal{D} \to \mathcal{D}$, $E \mapsto E[n]$
be a collection of additive functors indexed by $n \in \mathbf{Z}$ such that
$[n] \circ [m] = [n + m]$ and $[0] = \text{id}$ (equality as functors), and
\item $\mathcal{T}$ is a set of triangles called the
{\it distinguished triangles}
\end{enumerate}
subject to the following conditions
\begin{enumerate}
\item[TR1] Any triangle isomorphic to a distinguished triangle is
a distinguished triangle. Any triangle of the form
$(X, X, 0, \text{id}, 0, 0)$ is distinguished.
For any morphism $f : X \to Y$ of $\mathcal{D}$ there exists a
distinguished triangle of the form $(X, Y, Z, f, g, h)$.
\item[TR2] The triangle $(X, Y, Z, f, g, h)$ is distinguished
if and only if the triangle $(Y, Z, X[1], g, h, -f[1])$ is.
\item[TR3] Given a solid commutative square
$$
\xymatrix{
X \ar[r] \ar[d]^a &
Y \ar[r] \ar[d]^b &
Z \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{a[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
whose rows are distinguished triangles there exists a morphism
$c : Z \to Z'$ such that $(a, b, c)$ is a morphism of triangles.
\item[TR4] Given objects $X$, $Y$, $Z$ of $\mathcal{D}$, and morphisms
$f : X \to Y$, $g : Y \to Z$, and distinguished triangles
$(X, Y, Q_1, f, p_1, d_1)$,
$(X, Z, Q_2, g \circ f, p_2, d_2)$,
and
$(Y, Z, Q_3, g, p_3, d_3)$,
there exist
morphisms $a : Q_1 \to Q_2$ and $b : Q_2 \to Q_3$ such
that
\begin{enumerate}
\item $(Q_1, Q_2, Q_3, a, b, p_1[1] \circ d_3)$ is a
distinguished triangle,
\item the triple $(\text{id}_X, g, a)$ is
a morphism of triangles
$(X, Y, Q_1, f, p_1, d_1) \to (X, Z, Q_2, g \circ f, p_2, d_2)$, and
\item the triple $(f, \text{id}_Z, b)$ is a morphism of triangles
$(X, Z, Q_2, g \circ f, p_2, d_2) \to (Y, Z, Q_3, g, p_3, d_3)$.
\end{enumerate}
\end{enumerate}
We will call $(\mathcal{D}, [\ ], \mathcal{T})$ a
{\it pre-triangulated category} if TR1, TR2 and TR3 hold.
\end{definition}

\noindent
The explanation of TR4 is that if you think of $Q_1$ as
$Y/X$, $Q_2$ as $Z/X$ and $Q_3$ as $Z/Y$, then TR4(a) expresses
the isomorphism $(Z/X)/(Y/Z) \cong Z/Y$ and TR(b) and TR(c)
express that we can compare the triangles $X \to Y \to Q_1 \to X[1]$
etc with morphisms of triangles. For a more precise reformuation
of this idea see the proof of Lemma \ref{lemma-two-split-injections}.

\medskip\noindent
The sign in TR2 means that if $(X, Y, Z, f, g, h)$ is a distinguished triangle
then in the long sequence
\begin{equation}
\label{equation-rotate}
\ldots \to
Z[-1] \xrightarrow{-h[-1]}
X \xrightarrow{f}
Y \xrightarrow{g}
Z \xrightarrow{h}
X[1] \xrightarrow{-f[1]}
Y[1] \xrightarrow{-g[1]}
Z[1] \to \ldots
\end{equation}
each four term sequence gives a distinguished triangle.

\medskip\noindent
As usual we abuse notation and we simply speak of a (pre-)triangulated
category $\mathcal{D}$ without explicitly introducing notation for the
additional data. The notion of a pre-triangulated category is
useful in finding statements equivalent to TR4.

\medskip\noindent
We have the following definition of a triangulated functor.

\begin{definition}
\label{definition-exact-functor-triangulated-categories}
Let $\mathcal{D}$, $\mathcal{D}'$ be pre-triangulated
categories. An {\it exact functor}, or a {\it triangulated functor}
from $\mathcal{D}$ to $\mathcal{D}'$ is a functor
$F : \mathcal{D} \to \mathcal{D}'$ together
with given functorial isomorphisms $\xi_X : F(X[1]) \to F(X)[1]$
such that for every distinguished triangle
$(X, Y, Z, f, g, h)$ of $\mathcal{D}$ the triangle
$(F(X), F(Y), F(Z), F(f), F(g), \xi_X \circ F(h))$
is a distinguished triangle of $\mathcal{D}'$.
\end{definition}

\noindent
An exact functor is additive, see
Lemma \ref{lemma-exact-functor-additive}.
When we say two triangulated categories are equivalent we mean that
they are equivalent in the $2$-category of triangulated categories.
A $2$-morphism $a : (F, \xi) \to (F', \xi')$ in this $2$-category is
simply a transformation of functors $a : F \to F'$ which is compatible
with $\xi$ and $\xi'$, i.e.,
$$
\xymatrix{
F \circ [1] \ar[r]_\xi \ar[d]_{a \star 1} & [1] \circ F \ar[d]^{1 \star a} \\
F' \circ [1] \ar[r]^{\xi'} & [1] \circ F'
}
$$
commutes.

\begin{definition}
\label{definition-triangulated-subcategory}
Let $(\mathcal{D}, [\ ], \mathcal{T})$ be a pre-triangulated category.
A {\it pre-triangulated subcategory}\footnote{This definition may be
nonstandard. If $\mathcal{D}'$ is a full subcategory then $\mathcal{T}'$
is the intersection of the set of triangles in $\mathcal{D}'$ with
$\mathcal{T}$, see
Lemma \ref{lemma-triangulated-subcategory}.
In this case we drop $\mathcal{T}'$ from the notation.}
is a pair $(\mathcal{D}', \mathcal{T}')$ such that
\begin{enumerate}
\item $\mathcal{D}'$ is an additive subcategory of $\mathcal{D}$
which is preserved under $[1]$ and $[-1]$,
\item $\mathcal{T}' \subset \mathcal{T}$ is a subset such that for every
$(X, Y, Z, f, g, h) \in \mathcal{T}'$ we have
$X, Y, Z \in \text{Ob}(\mathcal{D}')$ and
$f, g, h \in \text{Arrows}(\mathcal{D}')$, and
\item $(\mathcal{D}', [\ ], \mathcal{T}')$ is a pre-triangulated
category.
\end{enumerate}
If $\mathcal{D}$ is a triangulated category, then we say
$(\mathcal{D}', \mathcal{T}')$ is a {\it triangulated subcategory} if
it is a pre-triangulated subcategory and
$(\mathcal{D}', [\ ], \mathcal{T}')$ is a triangulated category.
\end{definition}

\noindent
In this situation the inclusion functor
$\mathcal{D}' \to \mathcal{D}$ is an exact functor
with $\xi_X : X[1] \to X[1]$ given by the identity on $X[1]$.

\medskip\noindent
We will see in
Lemma \ref{lemma-composition-zero}
that for a distinguished triangle $(X, Y, Z, f, g, h)$
in a pre-triangulated category the composition $g \circ f : X \to Z$ is zero.
Thus the sequence (\ref{equation-rotate}) is a complex.
A homological functor is one that turns this complex into a long
exact sequence.

\begin{definition}
\label{definition-homological}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $\mathcal{A}$ be an abelian category.
An additive functor $H : \mathcal{D} \to \mathcal{A}$ is called
{\it homological} if for every distinguished triangle
$(X, Y, Z, f, g, h)$ the sequence
$$
H(X) \to H(Y) \to H(Z)
$$
is exact in the abelian category $\mathcal{A}$. An additive functor
$H : \mathcal{D}^{opp} \to \mathcal{A}$ is called {\it cohomological}
if the corresponding functor $\mathcal{D} \to \mathcal{A}^{opp}$ is
homological.
\end{definition}

\noindent
If $H : \mathcal{D} \to \mathcal{A}$ is a homological functor
we often write $H^n(X) = H(X[n])$ so that $H(X) = H^0(X)$.
Our discussion of TR2 above implies that says that a distinguished triangle
$(X, Y, Z, f, g, h)$ determines a long exact sequence
\begin{equation}
\label{equation-long-exact-cohomology-sequence}
\xymatrix{
H^{-1}(Z) \ar[r]^{h[-1]} &
H^0(X) \ar[r]^f &
H^0(Y) \ar[r]^g &
H^0(Z) \ar[r]^h &
H^1(X)
}
\end{equation}
This will be called the {\it long exact sequence} associated to the
distinguished triangle and the homological functor. As indicated
we will not use any signs for the morphisms in the long exact
sequence. This has the side effect that maps in the long exact sequence
associated to the rotation (TR2) of a distinguished triangle differ
from the maps in the sequence above by some signs.

\begin{definition}
\label{definition-delta-functor}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{D}$ be a triangulated category.
A {\it $\delta$-functor from $\mathcal{A}$ to $\mathcal{D}$} is
given by a functor $G : \mathcal{A} \to \mathcal{D}$ and
a rule which assigns to every short exact sequence
$$
0 \to A \xrightarrow{a} B \xrightarrow{b} C \to 0
$$
a morphism $\delta = \delta_{A \to B \to C} : G(C) \to G(A)[1]$
such that
\begin{enumerate}
\item the triangle
$(G(A), G(B), G(C), G(a), G(b), \delta_{A \to B \to C})$
is a distinguished triangle of $\mathcal{D}$
for any short exact sequence as above, and
\item for every morphism $(A \to B \to C) \to (A' \to B' \to C')$
of short exact sequences the diagram
$$
\xymatrix{
G(C) \ar[d] \ar[rr]_{\delta_{A \to B \to C}} & &
G(A)[1] \ar[d] \\
G(C') \ar[rr]^{\delta_{A' \to B' \to C'}} & &
G(A')[1]
}
$$
is commutative.
\end{enumerate}
In this situation we call
$(G(A), G(B), G(C), G(a), G(b), \delta_{A \to B \to C})$
the {\it image of the short exact sequence under the
given $\delta$-functor}.
\end{definition}

\noindent
Note how a $\delta$-functor comes equipped with additional structure.
Strictly speaking it does not make sense to say that a given
functor $\mathcal{A} \to \mathcal{D}$ is a $\delta$-functor, but we
will often do so anyway.












\section{Triangulated categories: Elementary results}
\label{section-elementary-results}

\noindent
Most of the results in this section are proved for pre-triangulated categories
and a fortiori hold in any triangulated category.

\begin{lemma}
\label{lemma-composition-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
Then $g \circ f = 0$,
$h \circ g = 0$ and $f[1] \circ h = 0$.
\end{lemma}

\begin{proof}
By TR1 we know $(X, X, 0, 1, 0, 0)$ is a distinguished triangle.
Apply TR3 to
$$
\xymatrix{
X \ar[r] \ar[d]^1 &
X \ar[r] \ar[d]^f &
0 \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{1[1]} \\
X \ar[r]^f &
Y \ar[r]^g &
Z \ar[r]^h &
X[1]
}
$$
Of course the dotted arrow is the zero map. Hence the commutativity of
the diagram implies that $g \circ f = 0$. For the other cases
rotate the triangle, i.e., apply TR2.
\end{proof}

\begin{lemma}
\label{lemma-representable-homological}
Let $\mathcal{D}$ be a pre-triangulated category.
For any object $W$ of $\mathcal{D}$ the functor
$\text{Hom}_{\mathcal{D}}(W, -)$ is homological, and the functor
$\text{Hom}_{\mathcal{D}}(-, W)$ is cohomological.
\end{lemma}

\begin{proof}
Consider a distinguished triangle $(X, Y, Z, f, g, h)$.
We have already seen that $g \circ f = 0$, see
Lemma \ref{lemma-composition-zero}.
Suppose $a : W \to Y$ is a morphism such that $g \circ a = 0$.
Then we get a commutative diagram
$$
\xymatrix{
W \ar[r]_1 \ar@{..>}[d]^b &
W \ar[r] \ar[d]^a &
0 \ar[r] \ar[d]^0 &
W[1] \ar@{..>}[d]^{b[1]} \\
X \ar[r] & Y \ar[r] & Z \ar[r] & X[1]
}
$$
Both rows are distinguished triangles (use TR1 for the top row).
Hence we can fill the dotted arrow $b$ (first rotate using TR2,
then apply TR3, and then rotate back). This proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-third-isomorphism-triangle}
Let $\mathcal{D}$ be a pre-triangulated category.
Let
$$
(a, b, c) : (X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')
$$
be a morphism of distinguished triangles. If two among $a, b, c$
are isomorphisms so is the third.
\end{lemma}

\begin{proof}
Assume that $a$ and $c$ are isomorphisms.
For any object $W$ of $\mathcal{D}$ write
$H_W( - ) = \text{Hom}_{\mathcal{D}}(W, -)$.
Then we get a commutative diagram of abelian groups
$$
\xymatrix{
H_W(Z[-1]) \ar[r] \ar[d] &
H_W(X) \ar[r] \ar[d] &
H_W(Y) \ar[r] \ar[d] &
H_W(Z) \ar[r] \ar[d] &
H_W(X[1]) \ar[d] \\
H_W(Z'[-1]) \ar[r] &
H_W(X') \ar[r] &
H_W(Y') \ar[r] &
H_W(Z') \ar[r] &
H_W(X'[1])
}
$$
By assumption the right two and left two vertical arrows are bijective.
As $H_W$ is homological by
Lemma \ref{lemma-representable-homological}
and the five lemma
(Homology, Lemma \ref{homology-lemma-five-lemma})
it follows that the middle vertical arrow is an isomorphism.
Hence by Yoneda's lemma, see
Categories, Lemma \ref{categories-lemma-yoneda}
we see that $b$ is an isomorphism.
This implies the other cases by rotating (using TR2).
\end{proof}

\begin{lemma}
\label{lemma-third-map-square-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let
$$
(0, b, 0), (0, b', 0) : (X, Y, Z, f, g, h) \to (X, Y, Z, f, g, h)
$$
be endomorphisms of a distinguished triangle. Then $bb' = 0$.
\end{lemma}

\begin{proof}
Picture
$$
\xymatrix{
X \ar[r] \ar[d]^0 &
Y \ar[r] \ar[d]^{b, b'} \ar@{..>}[ld]^\alpha &
Z \ar[r] \ar[d]^0 \ar@{..>}[ld]^\beta &
X[1] \ar[d]^0 \\
X \ar[r] & Y \ar[r] & Z \ar[r] & X[1]
}
$$
Applying
Lemma \ref{lemma-third-isomorphism-triangle}
we find dotted arrows $\alpha$ and $\beta$ such that
$b' = f \circ \alpha$ and $b = \beta \circ g$. Then
$bb' = \beta \circ g \circ f \circ \alpha = 0$
as $g \circ f = 0$ by
Lemma \ref{lemma-composition-zero}.
\end{proof}

\begin{lemma}
\label{lemma-third-map-idempotent}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
If
$$
\xymatrix{
Z \ar[r]_f \ar[d]_c & X[1] \ar[d]^{a[1]} \\
Z \ar[r]^f & X[1]
}
$$
is commutative and $a^2 = a$, $c^2 = c$, then there exists a
morphism $b : Y \to Y$ with $b^2 = b$ such that
$(a, b, c)$ is an endomorphism of the triangle $(X, Y, Z, f, g, h)$.
\end{lemma}

\begin{proof}
By TR3 there exists a morphism $b'$ such that
$(a, b', c)$ is an endormorphism of $(X, Y, Z, f, g, h)$.
Then $(0, (b')^2 - b', 0)$ is also an endomorphism. By
Lemma \ref{lemma-third-map-square-zero}
we see that $(b')^2 - b'$ has square zero.
Set $b = b' - (2b' - 1)((b')^2 - b') = 3(b')^2 - 2(b')^3$.
A computation shows that $(a, b, c)$ is an endomorphism and
that $b^2 - b = (4(b')^2 - 4b' - 3)((b')^2 - b')^2 = 0$.
\end{proof}

\begin{lemma}
\label{lemma-cone-triangle-unique-isomorphism}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
There exists a distinguished triangle $(X, Y, Z, f, g, h)$ which
is unique up to (nonunique) isomorphism of triangles.
More precisely, given a second such distinguished triangle
$(X, Y, Z', f, g', h')$ there exists an isomorphism
$$
(1, 1, c) : (X, Y, Z, f, g, h) \longrightarrow (X, Y, Z', f, g', h')
$$
\end{lemma}

\begin{proof}
Existence by TR1. Uniqueness up to isomorphism by TR3 and
Lemma \ref{lemma-third-isomorphism-triangle}.
\end{proof}

\begin{lemma}
\label{lemma-third-object-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item $f$ is an isomorphism,
\item $(X, Y, 0, f, 0, 0)$ is a distinguished triangle, and
\item for any distinguished triangle $(X, Y, Z, f, g, h)$ we have $Z = 0$.
\end{enumerate}
\end{lemma}

\begin{proof}
Immediate from
Lemma \ref{lemma-cone-triangle-unique-isomorphism}
and TR1.
\end{proof}

\begin{lemma}
\label{lemma-direct-sum-triangles}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ be triangles.
The following are equivalent
\begin{enumerate}
\item $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')$
is a distinguished triangle,
\item both $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ are
distinguished triangles.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (2). By TR1 we may choose a distinguished triangle
$(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$.
By TR3 we can find morphisms of distinguished triangles
$(X, Y, Z, f, g, h) \to
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$
and
$(X', Y', Z', f', g', h') \to
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$.
Taking the direct sum of these morphisms
we obtain a morphism of triangles
$$
\xymatrix{
(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')
\ar[d]^{(1, 1, c)} \\
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'').
}
$$
Let $W$ be any object in $\mathcal{D}$ and apply the functor
$H_W = \text{Hom}_{\mathcal{D}}(W, -)$ to this diagram.
By
Lemma \ref{lemma-representable-homological}
(applied three times)
we deduce that $H_W(c) : H_W(Z \oplus Z') \to H_W(Q)$
is an isomorphism. Hence $c$ is an isomorphism and we conclude that
(1) holds.

\medskip\noindent
Assume (1). We will show that $(X, Y, Z, f, g, h)$ is a distinguished
triangle. Let $W$ be any object in $\mathcal{D}$ and set
$H_W = \text{Hom}_{\mathcal{D}}(W, -)$. By
Lemma \ref{lemma-representable-homological}
we see that $H_W(X) \to H_W(Y) \to H_W(Z) \to H_W(Z[1])$ is exact as
it is a direct summand of the exact sequence associated to the distinguished
triangle $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')$. Using TR1 let
$(X, Y, Q, f, g'', h'')$ be a distinguished triangle. By TR3 there exists
a morphism of distinguished triangles
 $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h') \to (X, Y, Q, f, g'', h'')$.
Composing this with the inclusion map we get a morphism of triangles
$$
(1, 1, c) :
(X, Y, Z, f, g, h)
\longrightarrow
(X, Y, Q, f, g'', h'')
$$
Applying $H_W$ and using the above we once again see that
$H_W(c) : H_W(Z) \to H_W(Q)$ is an isomorphism and we conclude that
$c$ is an isomorphism. Hence we win.
\end{proof}

\begin{lemma}
\label{lemma-split}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
\begin{enumerate}
\item If $h = 0$, then there exists a left inverse $s : Z \to Y$ to $g$.
\item For any left inverse $s : Z \to Y$ of $g$ the map
$f \oplus s : X \oplus Z \to Y$ is an isomorphism.
\item For any objects $X', Z'$ of $\mathcal{D}$ the triangle
$(X', X' \oplus Z', Z', (1, 0), (0, 1), 0)$ is distinguished.
\end{enumerate}
\end{lemma}

\begin{proof}
To see (1) use that
$\text{Hom}_{\mathcal{D}}(Z, Y) \to \text{Hom}_{\mathcal{D}}(Z, Z) \to
\text{Hom}_{\mathcal{D}}(Z, X[1])$
is exact by
Lemma \ref{lemma-representable-homological}.
By the same token, if $s$ is as in (2), then $h = 0$ and the sequence
$$
0 \to \text{Hom}_{\mathcal{D}}(W, X) \to \text{Hom}_{\mathcal{D}}(W, Y)
\to \text{Hom}_{\mathcal{D}}(W, Z) \to 0
$$
is split exact (split by $s : Z \to Y$). Hence by Yoneda's lemma we
see that $X \oplus Z \to Y$ is an isomorphism. The last assertion follows
from TR1 and
Lemma \ref{lemma-direct-sum-triangles}.
\end{proof}

\begin{lemma}
\label{lemma-when-split}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item $f$ has a kernel,
\item $f$ has a cokernel,
\item $f$ is isomorphic to a map $K \oplus Z \to Z \oplus Q$
induced by $\text{id}_Z$.
\end{enumerate}
\end{lemma}

\begin{proof}
Any morphism isomorphic to a map of the form
$X' \oplus Z \to Z \oplus Y'$ has both a kernel and a cokernel.
Hence (3) $\Rightarrow$ (1), (2).
Next we prove (1) $\Rightarrow$ (3).
Suppose first that $f : X \to Y$ is a monomorphism, i.e., its kernel is zero.
By TR1 there exists a distinguished triangle $(X, Y, Z, f, g, h)$
and by
Lemma \ref{lemma-representable-homological}
we see that $h = 0$. Then
Lemma \ref{lemma-split}
implies that $Y = X \oplus Z$, i.e., we see that (3) holds.
Next, assume $f$ has a kernel $K$. As $K \to X$ is a monomorphism we
conclude $X = K \oplus X'$ and $f|_{X'} : X' \to Y$ is a monomorphism.
Hence $Y = X' \oplus Y'$ and we win.
The implication (2) $\Rightarrow$ (3) is dual to this.
\end{proof}

\begin{lemma}
\label{lemma-projectors-have-images}
Let $\mathcal{D}$ be an additive category which has countable products
and has kernels of maps which have a left inverse. Then $\mathcal{D}$
has kernels of idempotents.
\end{lemma}

\begin{proof}
Let $\mathcal{D}$ be an additive category. Let $X$ be an object of
$\mathcal{D}$ and let $e : X \to X$ be an idempotent. Then
functor
$$
W \longmapsto \text{Ker}(
\text{Mor}_{\mathcal{D}}(W, X)
\xrightarrow{e}
\text{Mor}_{\mathcal{D}}(W, X)
)
$$
if representable if and only if $e$ has a kernel. Note that for any
abelian group $A$ and idempotent endomorphism $e : A \to A$ we have
$$
\text{Ker}(e : A \to A)
= \text{Ker}(\Phi :
\prod\nolimits_{n \in \mathbf{N}} A
\to
\prod\nolimits_{n \in \mathbf{N}} A
)
$$
where
$$
\Phi(a_1, a_2, a_3, \ldots) = (ea_1 + (1 - e)a_2, ea_2 + (1 - e)a_3, \ldots)
$$
Moreover, $\Phi$ has the left inverse
$$
\Psi(a_1, a_2, a_3, \ldots) =
(a_1, (1 - e)a_1 + ea_2, (1 - e)a_2 + ea_3, \ldots).
$$
Hence if $\mathcal{D}$ has countable products and kernels of maps which
have a left inverse, then we see that kernel of $e$ exists.
\end{proof}

\begin{lemma}
\label{lemma-projectors-have-images-triangulated}
Let $\mathcal{D}$ be a pre-triangulated category.
If $\mathcal{D}$ has countable products, then $\mathcal{D}$
has kernels of idempotents.
If $\mathcal{D}$ has countable coproducts, then $\mathcal{D}$
has kernels of idempotents.
\end{lemma}

\begin{proof}
Assume $\mathcal{D}$ has countable products. Then it suffices to
check that morphisms which have a left inverse have kernels.
Any morphism which has a left inverse is an epimorphism, hence
has a kernel by
Lemma \ref{lemma-when-split}.
The second statement is dual to the first.
\end{proof}

\noindent
The following lemma makes it slightly easier to prove that a
pre-triangulated category is triangulated.

\begin{lemma}
\label{lemma-easier-axiom-four}
Let $\mathcal{D}$ be a pre-triangulated category.
In order to prove TR4 it suffices to show that given
any pair of composable morphisms
$f : X \to Y$ and $g : Y \to Z$ there exist
\begin{enumerate}
\item isomorphisms $i : X' \to X$, $j : Y' \to Y$ and
$k : Z' \to Z$, and then setting $f' = j^{-1}fi : X' \to Y'$ and
$g' = k^{-1}gj : Y' \to Z'$ there exist
\item distinguished triangles
$(X', Y', Q_1, f', p_1, d_1)$,
$(X', Z', Q_2, g' \circ f', p_2, d_2)$
and
$(Y', Z', Q_3, g', p_3, d_3)$,
such that the assertion of TR4 holds.
\end{enumerate}
\end{lemma}

\begin{proof}
The replacement of $X, Y, Z$ by $X', Y', Z'$ is harmless by our
definition of distinguished triangles and their isomorphisms.
The lemma follows from the fact that the distinguished triangles
$(X', Y', Q_1, f', p_1, d_1)$,
$(X', Z', Q_2, g' \circ f', p_2, d_2)$
and
$(Y', Z', Q_3, g', p_3, d_3)$
are unique up to isomorphism by
Lemma \ref{lemma-cone-triangle-unique-isomorphism}.
\end{proof}

\begin{lemma}
\label{lemma-triangulated-subcategory}
Let $\mathcal{D}$ be a pre-triangulated category.
Assume that $\mathcal{D}'$ is an additive full subcategory of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item there exists a set of triangles $\mathcal{T}'$ such that
$(\mathcal{D}', \mathcal{T}')$ is a pre-triangulated subcategory
of $\mathcal{D}$,
\item $\mathcal{D}'$ is preserved under $[1], [-1]$ and
given any morphism $f : X \to Y$ in $\mathcal{D}'$ there exists
a distinguished triangle $(X, Y, Z, f, g, h)$ in $\mathcal{D}$
such that $Z$ is isomorphic to an object of $\mathcal{D}'$.
\end{enumerate}
In this case $\mathcal{T}'$ is the set of distinguished triangles
$(X, Y, Z, f, g, h)$ of $\mathcal{D}$ such that
$X, Y, Z \in \text{Ob}(\mathcal{D}')$ and
$f, g, h \in \text{Arrows}(\mathcal{D}')$. Finally, if $\mathcal{D}$
is a triangulated category, then (1) and (2) are also equivalent to
\begin{enumerate}
\item[(3)] $\mathcal{D}'$ is a triangulated subcategory.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-exact-functor-additive}
An exact functor of pre-triangulated categories is additive.
\end{lemma}

\begin{proof}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of
pre-triangulated categories. Since
$(0, 0, 0, 1_0, 1_0, 0)$ is a distinguished triangle of $\mathcal{D}$
the triangle
$$
(F(0), F(0), F(0), 1_{F(0)}, 1_{F(0)}, F(0))
$$
is distinguished in $\mathcal{D}'$.
This implies that $1_{F(0)} \circ 1_{F(0)}$ is zero, see
Lemma \ref{lemma-composition-zero}.
Hence $F(0)$ is the zero object of $\mathcal{D}'$. This also implies
that $F$ applied to any zero morphism is zero (since a morphism in
an additive category is zero if and only if it factors through the
zero objet). Next, using that
$(X, X \oplus Y, Y, (1, 0), (0, 1), 0)$ is a distinguished triangle,
we see that $(F(X), F(X \oplus Y), F(Y), F(1, 0), F(0, 1), 0)$ is
one too. This implies that the map
$F(1, 0) \oplus F(0, 1) : F(X) \oplus F(Y) \to F(X \oplus Y)$
is an isomorphism, see
Lemma \ref{lemma-split}.
We omit the rest of the argument.
\end{proof}

\noindent
The proof of the following result uses TR4.

\begin{proposition}
\label{proposition-9}
Let $\mathcal{D}$ be a triangulated category. Any commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d] & Y \ar[d] \\
X' \ar[r] & Y'
}
$$
can be extended to a diagram
$$
\xymatrix{
X \ar[r] \ar[d] & Y \ar[r] \ar[d] & Z \ar[r] \ar[d] & X[1] \ar[d] \\
X' \ar[r] \ar[d] & Y' \ar[r] \ar[d] & Z' \ar[r] \ar[d] & X'[1] \ar[d] \\
X'' \ar[r] \ar[d] & Y'' \ar[r] \ar[d] & Z'' \ar[r] \ar[d] & X''[1] \ar[d] \\
X[1] \ar[r] & Y[1] \ar[r] & Z[1] \ar[r] & X[2]
}
$$
where all the squares are commutative, except for the lower right square
which is anticommutative. Moreover, each of the rows and columns are
distinguished triangles. Finally, the morphisms on the bottom row
(resp.\ right column) are obtained from the morphisms of the top row
(resp.\ left column) by applying $[1]$.
\end{proposition}

\begin{proof}
During this proof we avoid writing the arrows in order to make the proof
legible. Choose distinguished triangles
$(X, Y, Z)$, $(X', Y', Z')$, $(X, X', X'')$, $(Y, Y', Y'')$, and
and $(X, Y', A)$. Note that the morphism $X \to Y'$ is both equal
to the composition $X \to Y \to Y'$ and equal to the composition
$X \to X' \to Y'$. Hence, we can find morphisms
\begin{enumerate}
\item $a : Z \to A$ and $b : A \to Y''$, and
\item $a' : X'' \to A$ and $b' : A \to Z'$
\end{enumerate}
as in TR4. Denote $c : Y'' \to Z[1]$ the composition
$Y'' \to Y[1] \to Z[1]$ and denote $c' : Z' \to X''[1]$ the composition
$Z' \to X'[1] \to X''[1]$. The conclusion of our application TR4
are that
\begin{enumerate}
\item $(Z, A, Y'', a, b, c)$, $(X'', A, Z', a', b', c')$
are distinguished triangles,
\item $(X, Y, Z) \to (X, Y', A)$,
$(X, Y', A) \to (Y, Y', Y'')$,
$(X, X', X'') \to (X, Y', A)$,
$(X, Y', A) \to (X', Y', Z')$
are morphisms of triangles.
\end{enumerate}
First using that
$(X, X', X'') \to (X, Y', A)$ and $(X, Y', A) \to (Y, Y', Y'')$.
are morphisms of triangles we see the first of the commutative diagrams
$$
\xymatrix{
X' \ar[r] \ar[d] & Y' \ar[d] \\
X'' \ar[r]^{b \circ a'} \ar[d] & Y'' \ar[d] \\
X[1] \ar[r] & Y[1] 
}
\quad\quad
\xymatrix{
Y \ar[r] \ar[d] & Z \ar[d]^{b' \circ a} \ar[r] & X[1] \ar[d] \\
Y' \ar[r] & Z' \ar[r] & X'[1]
}
$$
is commutative. The second is commutative too using that
$(X, Y, Z) \to (X, Y', A)$ and $(X, Y', A) \to (X', Y', Z')$ are morphisms
of triangles. At this point we choose a distinguished triangle
$(X'', Y'' , Z'')$ starting with the map $b \circ a' : X'' \to Y''$.

\medskip\noindent
Next we apply TR4 one more time to the morphisms
$X'' \to A \to Y''$ and the triangles
$(X'', A, Z', a', b', c')$,
$(X'', Y'', Z'')$, and
$(A, Y'', Z[1], b, c , -a[1])$ to get morphisms
$a'' : Z' \to Z''$ and $b'' : Z'' \to Z[1]$.
Then $(Z', Z'', Z[1], a'', b'', - b'[1] \circ a[1])$ is a distinguished
triangle, hence also $(Z, Z', Z'', -b' \circ a, a'', -b'')$
and hence also $(Z, Z', Z'', b' \circ a, a'', b'')$.
Moreover, $(X'', A, Z') \to (X'', Y'', Z'')$ and
$(X'', Y'', Z'') \to (A, Y'', Z[1], b, c , -a[1])$
are morphisms of triangles.
At this point we have defined all the distinguished triangles
and all the morphisms, and all that's left is to verify some
commutativity relations.

\medskip\noindent
To see that the middle square in the diagram commutes, note
that the arrow $Y' \to Z'$ factors as $Y' \to A \to Z'$
because $(X, Y', A) \to (X', Y', Z')$ is a morphism of triangles.
Similarly, the morphism $Y' \to Y''$ factors as
$Y' \to A \to Y''$ because $(X, Y', A) \to (Y, Y', Y'')$ is a
morphism of triangles. Hence the middle square commutes because
the square with sides $(A, Z', Z'', Y'')$ commutes as
$(X'', A, Z') \to (X'', Y'', Z'')$ is a morphism of triangles (by TR4).
The square with sides $(Y'', Z'', Y[1], Z[1])$ commutes
because $(X'', Y'', Z'') \to (A, Y'', Z[1], b, c , -a[1])$
is a morphism of triangles and $c : Y'' \to Z[1]$ is the composition
$Y'' \to Y[1] \to Z[1]$.
The square with sides $(Z', X'[1], X''[1], Z'')$ is commutative
because $(X'', A, Z') \to (X'', Y'', Z'')$ is a morphism of triangles
and $c' : Z' \to X''[1]$ is the composition $Z' \to X'[1] \to X''[1]$.
Finally, we have to show that the square with sides
$(Z'', X''[1], Z[1], X[2])$ anticommutes. This holds because
$(X'', Y'', Z'') \to (A, Y'', Z[1], b, c , -a[1])$
is a morphism of triangles and we're done.
\end{proof}









\section{Triangulated categories: Localization}
\label{section-localization}

\noindent
In order to construct the derived category starting from the homotopy
category of compexes, we will use a localization process.

\begin{definition}
\label{definition-localization}
Let $\mathcal{D}$ be a pre-triangulated category. We say a multiplicative
system $S$ is {\it compatible with the triangulated structure} if
the following two conditions hold:
\begin{enumerate}
\item[MS5] For $s \in S$ we have $s[n] \in S$ for all $n \in \mathbf{Z}$.
\item[MS6] Given a solid commutative square
$$
\xymatrix{
X \ar[r] \ar[d]^s &
Y \ar[r] \ar[d]^{s'} &
Z \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{s[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
whose rows are distinguished triangles with $s, s' \in S$
there exists a morphism $s'' : Z \to Z'$ in $S$ such that
$(s, s', s'')$ is a morphism of triangles.
\end{enumerate}
\end{definition}

\noindent
It turns out that these axioms are not independent of the
axioms defining multiplicative systems.

\begin{lemma}
\label{lemma-localization-conditions}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $S$ be a set of morphisms of $\mathcal{D}$ and assume that axioms
MS1, MS5, MS6 hold (see
Categories, Definition \ref{categories-definition-multiplicative-system}
and
Definition \ref{definition-localization}).
Then MS2 holds.
\end{lemma}

\begin{proof}
Suppose that $f : X \to Y$ is a morphism of $\mathcal{D}$ and
$t : X \to X'$ an element of $S$. Choose a distinguished triangle
$(X, Y, Z, f, g, h)$. Next, choose a distinguished triangle
$(X', Y', Z, f', g', t[1] \circ h)$ (here we use TR1 and TR2).
By MS5, MS6 (and TR2 to rotate) we can find the dotted arrow
in the commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^t &
Y \ar[r] \ar@{..>}[d]^{s'} &
Z \ar[r] \ar[d]^1 &
X[1] \ar[d]^{t[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z \ar[r] &
X'[1]
}
$$
with moreover $s' \in S$. This proves LMS2. The proof of RMS2 is dual.
\end{proof}

\begin{lemma}
\label{lemma-triangle-functor-localize}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of
pre-triangulated categories.  Let
$$
S = \{f \in \text{Arrows}(\mathcal{D})
\mid F(f)\text{ is an isomorphism}\}
$$
Then $S$ is a saturated (see
Categories,
Definition \ref{categories-definition-saturated-multiplicative-system})
multiplicative system compatible with the
triangulated structure on $\mathcal{D}$.
\end{lemma}

\begin{proof}
We have to prove axioms MS1 -- MS6, see
Categories, Definitions \ref{categories-definition-multiplicative-system} and
\ref{categories-definition-saturated-multiplicative-system}
and
Definition \ref{definition-localization}.
MS1, MS4, and MS5 are direct from the definitions. MS6 follows from TR3 and
Lemma \ref{lemma-third-isomorphism-triangle}.
By
Lemma \ref{lemma-localization-conditions}
we conclude that MS2 holds. To finish the proof we have to show that
MS3 holds. To do this let $f, g : X \to Y$ be morphisms of $\mathcal{D}$,
and let $t : Z \to X$ be an element of $S$ such that $f \circ t = g \circ t$.
As $\mathcal{D}$ is additive this simply means that $a \circ t = 0$ with
$a = f - g$. Choose a distinguished triangle $(Z, X, Q, t, g, h)$ using
TR1 and TR2. Since $a \circ t = 0$ we see by
Lemma \ref{lemma-representable-homological}
there exists a morphism $i : Q \to Y$ such that $i \circ g = a$.
Finally, using TR1 again we can choose a triangle
$(Q, Y, W, i, j, k)$. Here is a picture
$$
\xymatrix{
Z \ar[r]_t & X \ar[r]_g \ar[d]^1 & Q \ar[r] \ar[d]^i & Z[1] \\
& X \ar[r]_a & Y \ar[d]^j \\
& & W
}
$$
OK, and now we apply the functor $F$ to this diagram.
Since $t \in S$ we see that $F(Q) = 0$, see
Lemma \ref{lemma-third-object-zero}.
Hence $F(j)$ is an isomorphism by the same lemma, i.e., $j \in S$.
Finally, $j \circ a = j \circ i \circ g = 0$ as $j \circ i = 0$.
Thus $j \circ f = j \circ g$ and we see that LMS3 holds.
The proof of RMS3 is dual.
\end{proof}

\begin{lemma}
\label{lemma-homological-functor-localize}
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor between a
pre-triangulated category and an abelian category. Let
$$
S = \{f \in \text{Arrows}(\mathcal{D})
\mid H^i(f)\text{ is an isomorphism for all }i \in \mathbf{Z}\}
$$
Then $S$ is a saturated (see
Categories,
Definition \ref{categories-definition-saturated-multiplicative-system})
multiplicative system compatible with the
triangulated structure on $\mathcal{D}$.
\end{lemma}

\begin{proof}
We have to prove axioms MS1 -- MS6, see
Categories, Definitions \ref{categories-definition-multiplicative-system} and
\ref{categories-definition-saturated-multiplicative-system}
and
Definition \ref{definition-localization}.
MS1, MS4, and MS5 are direct from the definitions.
MS6 follows from TR3 and the long exact cohomology sequence
(\ref{equation-long-exact-cohomology-sequence}).
By
Lemma \ref{lemma-localization-conditions}
we conclude that MS2 holds. To finish the proof we have to show that
MS3 holds. To do this let $f, g : X \to Y$ be morphisms of $\mathcal{D}$,
and let $t : Z \to X$ be an element of $S$ such that $f \circ t = g \circ t$.
As $\mathcal{D}$ is additive this simply means that $a \circ t = 0$ with
$a = f - g$. Choose a distinguished triangle $(Z, X, Q, t, g, h)$ using
TR1 and TR2. Since $a \circ t = 0$ we see by
Lemma \ref{lemma-representable-homological}
there exists a morphism $i : Q \to Y$ such that $i \circ g = a$.
Finally, using TR1 again we can choose a triangle
$(Q, Y, W, i, j, k)$. Here is a picture
$$
\xymatrix{
Z \ar[r]_t & X \ar[r]_g \ar[d]^1 & Q \ar[r] \ar[d]^i & Z[1] \\
& X \ar[r]_a & Y \ar[d]^j \\
& & W
}
$$
OK, and now we apply the functors $H^i$ to this diagram.
Since $t \in S$ we see that $H^i(Q) = 0$ by the long exact cohomology
sequence (\ref{equation-long-exact-cohomology-sequence}).
Hence $H^i(j)$ is an isomorphism for all $i$ by the same argument,
i.e., $j \in S$. Finally, $j \circ a = j \circ i \circ g = 0$ as
$j \circ i = 0$. Thus $j \circ f = j \circ g$ and we see that LMS3 holds.
The proof of RMS3 is dual.
\end{proof}

\begin{proposition}
\label{proposition-construct-localization}
Let $\mathcal{D}$ be a pre-triangulated category. Let $S$ be a multiplicative
system compatible with the triangulated structure.
Then there exists a unique structure of a pre-triangulated category on
$S^{-1}\mathcal{D}$ such that the localization functor
$Q : \mathcal{D} \to S^{-1}\mathcal{D}$ is exact.
Moreover, if $\mathcal{D}$ is a triangulated category, so is
$S^{-1}\mathcal{D}$.
\end{proposition}

\begin{proof}
We have seen that $S^{-1}\mathcal{D}$ is an additive category
and that the localization functor $Q$ is additive in
Homology, Lemma \ref{homology-lemma-localization-additive},
It is clear that we may define $Q(X)[n] = Q(X[n])$ since
$\mathcal{S}$ is preserved under the shift functors $[n]$ by
MS5. Finally, we say a triangle of $S^{-1}\mathcal{D}$ is distinguished
if it is isomorphic to the image of a distinguished triangle under
the localization functor $Q$.

\medskip\noindent
Proof of TR1. The only thing to prove here is that if
$a : Q(X) \to Q(Y)$ is a morphism of $S^{-1}\mathcal{D}$, then
$a$ fits into a distinguish triangle. Write $a = Q(s)^{-1} \circ Q(f)$ for
some $s : Y \to Y'$ in $S$ and $f : X \to Y'$. Choose a distinguished
triangle $(X, Y', Z, f, g, h)$ in $\mathcal{D}$. Then we see that
$(Q(X), Q(Y), Q(Z), a, Q(g) \circ Q(s), Q(h))$ is a distinguished triangle
of $S^{-1}\mathcal{D}$.

\medskip\noindent
Proof of TR2. This is immediate from the definitions.

\medskip\noindent
Proof of TR3. Note that the existence of the dotted arrow which is
required to exist may be proven after replacing the two triangles
by isomorphic triangles. Hence we may assume given distinguished
triangles $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ of
$\mathcal{D}$ and a commutative diagram
$$
\xymatrix{
Q(X) \ar[r]_{Q(f)} \ar[d]_a & Q(Y) \ar[d]^b \\
Q(X') \ar[r]^{Q(f')} & Q(Y')
}
$$
in $S^{-1}\mathcal{D}$. Now we apply
Categories, Lemma \ref{categories-lemma-left-localization-diagram}
to find a morphism $f'' : X'' \to Y''$ in $\mathcal{D}$ and a commutative
diagram
$$
\xymatrix{
X \ar[d]_f \ar[r]_k & X'' \ar[d]^{f''} & X' \ar[d]^{f'} \ar[l]^s \\
Y \ar[r]^l & Y'' & Y' \ar[l]_t
}
$$
in $\mathcal{D}$ with $s, t \in S$ and $a = s^{-1}k$, $b = t^{-1}l$.
At this point we can use TR3 for $\mathcal{D}$ and MS6 to find
a commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^k &
Y \ar[r] \ar[d]^l &
Z \ar[r] \ar[d]^m &
X[1] \ar[d]^{g[1]} \\
X'' \ar[r] &
Y'' \ar[r] &
Z'' \ar[r] &
X''[1] \\
X' \ar[r] \ar[u]_s &
Y' \ar[r] \ar[u]_t &
Z' \ar[r] \ar[u]_r &
X'[1] \ar[u]_{s[1]}
}
$$
with $r \in S$. It follows that setting $c = Q(r)^{-1}Q(m)$ we obtain
the desired morphism of triangles
$$
\xymatrix{
(Q(X), Q(Y), Q(Z), Q(f), Q(g), Q(h))
\ar[d]^{(a, b, c)} \\
(Q(X'), Q(Y'), Q(Z'), Q(f'), Q(g'), Q(h'))
}
$$

\medskip\noindent
This proves the first statement of the lemma. If $\mathcal{D}$ is also
a triangulated category, then we still have to prove TR4 in order to show
that $S^{-1}\mathcal{D}$ is triangulated as well. To do this we reduce by
Lemma \ref{lemma-easier-axiom-four}
to the following statement: Given composable morphisms
$a : Q(X) \to Q(Y)$ and $b : Q(Y) \to Q(Z)$ we have to produce
an octahedron after possibly replacing $Q(X), Q(Y), Q(Z)$ by isomorphic
objects. To do this we may first replace $Y$ by an object such that
$a = Q(f)$ for some morphism $f : X \to Y$ in $\mathcal{D}$. (More precisely,
write $a = s^{-1}f$ with $s : Y \to Y'$ in $S$ and $f : X \to Y'$. Then
replace $Y$ by $Y'$.) After this we similarly replace $Z$ by an object such
that $b = Q(g)$ for some morphism $g : Y \to Z$. Now we can find
distinguished triangles $(X, Y, Q_1, f, p_1, d_1)$,
$(X, Z, Q_2, g \circ f, p_2, d_2)$, and
$(Y, Z, Q_3, g, p_3, d_3)$ in $\mathcal{D}$ (by TR1), and
morphisms $a : Q_1 \to Q_2$ and $b : Q_2 \to Q_3$ as in TR4.
Then it is immediately verified that applying the functor $Q$ to
all these data gives a corresponding structure in $S^{-1}\mathcal{D}$
\end{proof}

\noindent
The universal property of the localization of a triangulated category
is as follows (we formulate this for pre-triangulated categories, hence
it holds a fortiori for triangulated categories).

\begin{lemma}
\label{lemma-universal-property-localization}
Let $\mathcal{D}$ be a pre-triangulated category. Let $S$ be a multiplicative
system compatible with the triangulated category. Let
$Q : \mathcal{D} \to S^{-1}\mathcal{D}$ be the localization functor, see
Proposition \ref{proposition-construct-localization}.
\begin{enumerate}
\item If $H : \mathcal{D} \to \mathcal{A}$ is a homological functor into
an abelian category $\mathcal{A}$ such that $H(s)$ is an isomorphism for
all $s \in S$, then the unique factorization
$H' : S^{-1}\mathcal{D} \to \mathcal{A}$ such that $H = H' \circ Q$ (see
Categories, Lemma \ref{categories-lemma-properties-left-localization})
is a homological functor too.
\item If $F : \mathcal{D} \to \mathcal{D}'$ is an exact functor into
a pre-triangulated category $\mathcal{D}'$ such that $F(s)$ is an isomorphism
for all $s \in S$, then the unique factorization
$F' : S^{-1}\mathcal{D} \to \mathcal{D}'$ such that $F = F' \circ Q$ (see
Categories, Lemma \ref{categories-lemma-properties-left-localization})
is an exact functor too.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma proves itself. Details omitted.
\end{proof}

\noindent
The following lemma describes the kernel (see
Definition \ref{definition-kernel-category})
of the localization functor.

\begin{lemma}
\label{lemma-kernel-localization}
Let $\mathcal{D}$ be a pre-triangulated category. Let $S$ be a multiplicative
system compatible with the triangulated structure. Let $Z$ be an object
of $\mathcal{D}$. The following are equivalent
\begin{enumerate}
\item $Q(Z) = 0$ in $S^{-1}\mathcal{D}$,
\item there exists $Z' \in \text{Ob}(\mathcal{D})$ such that
$0 : Z \to Z'$ is an element of $S$,
\item there exists $Z' \in \text{Ob}(\mathcal{D})$ such that
$0 : Z' \to Z$ is an element of $S$, and
\item there exists an object $Z'$ and a distinguished triangle
$(X, Y, Z \oplus Z', f, g, h)$ such that $f \in S$.
\end{enumerate}
If $S$ is saturated, then these are also equivalent to
\begin{enumerate}
\item[(4)] the morphism $0 \to Z$ is an element of $S$,
\item[(5)] the morphism $Z \to 0$ is an element of $S$,
\item[(6)] there exists a distinguished triangle $(X, Y, Z, f, g, h)$
such that $f \in S$.
\end{enumerate}
\end{lemma}

\begin{proof}
The equivalence of (1), (2), and (3) is
Homology, Lemma \ref{homology-lemma-kernel-localization}.
If (2) holds, then $(Z'[-1], Z'[-1] \oplus Z, Z, (1, 0), (0, 1), 0)$
is a distinguised triangle (see
Lemma \ref{lemma-split})
with ``$0 \in S$''. By rotating we conclude that (4) holds.
If $(X, Y, Z \oplus Z', f, g, h)$ is a distinguished triangle with $f \in S$
then $Q(f)$ is an isomorphism hence $Q(Z \oplus Z') = 0$ hence $Q(Z) = 0$.
Thus (1) -- (4) are all equivalent.

\medskip\noindent
Next, assume that $S$ is saturated. Note that each of (4), (5), (6)
implies one of the equivalent conditions (1) -- (4). Suppose that
$Q(Z) = 0$. Then $0 \to Z$ is a morphism of $\mathcal{D}$ which becomes
an isomorphism in $S^{-1}\mathcal{D}$. According to
Categories, Lemma \ref{categories-lemma-what-gets-inverted}
the fact that $S$ is saturated implies that $0 \to Z$ is in $S$.
Hence (1) $\Rightarrow$ (4). Dually (1) $\Rightarrow$ (5).
Finally, if $0 \to Z$ is in $S$, then the triangle
$(0, Z, Z, 0, \text{id}_Z, 0)$ is distinguished by TR1 and TR2 and
is a triangle as in (4).
\end{proof}








\section{Triangulated categories: Quotients}
\label{section-quotients}

\noindent
Given a triangulated category and a triangulated subcategory we can
construct another triangulated category by taking the ``quotient''.
The construction uses a localization. This is similar to the quotient
of an abelian category by a Serre subcategory, see
Homology, Section \ref{homology-section-serre-subcategories}.
Before we do the actual construction we briefly discuss kernels
of exact functors.

\begin{definition}
\label{definition-saturated}
Let $\mathcal{D}$ be a pre-triangulated category. We say a full
pre-triangulated subcategory $\mathcal{D}'$ of $\mathcal{D}$ is
{\it saturated} if whenever $X \oplus Y$ is isomorphic to an object
of $\mathcal{D}'$ then both $X$ and $Y$ are isomorphic to objects
of $\mathcal{D}'$.
\end{definition}

\begin{lemma}
\label{lemma-triangle-functor-kernel}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of
pre-triangulated categories. Let $\mathcal{D}''$ be the full subcategory
of $\mathcal{D}$ with objects
$$
\text{Ob}(\mathcal{D}'') =
\{X \in \text{Ob}(\mathcal{D}) \mid F(X) = 0\}
$$
Then $\mathcal{D}''$ is a strictly full saturated pre-triangulated
subcategory of $\mathcal{D}$. If $\mathcal{D}$ is a triangulated category,
then $\mathcal{D}''$ is a triangulated subcategory.
\end{lemma}

\begin{proof}
It is clear that $\mathcal{D}''$ is preserved under $[1]$ and $[-1]$.
If $(X, Y, Z, f, g, h)$ is a distinguished triangle of $\mathcal{D}$
and $F(X) = F(Y) = 0$, then also $F(Z) = 0$ as
$(F(X), F(Y), F(Z), F(f), F(g), F(h))$ is distinguished.
Hence we may apply
Lemma \ref{lemma-triangulated-subcategory}
to see that $\mathcal{D}''$ is a pre-triangulated subcategory (respectively
a triangulated subcategory if $\mathcal{D}$ is a triangulated category).
The final assertion of being saturated follows from
$F(X) \oplus F(Y) = 0 \Rightarrow F(X) = F(Y) = 0$.
\end{proof}

\begin{lemma}
\label{lemma-homological-functor-kernel}
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor of
a pre-triangulated category into an abelian category.
Let $\mathcal{D}'$ be the full subcategory of $\mathcal{D}$ with objects
$$
\text{Ob}(\mathcal{D}') =
\{X \in \text{Ob}(\mathcal{D}) \mid
H(X[n]) = 0\text{ for all }n \in \mathbf{Z}\}
$$
Then $\mathcal{D}'$ is a strictly full saturated pre-triangulated subcategory
of $\mathcal{D}$. If $\mathcal{D}$ is a triangulated category, then
$\mathcal{D}'$ is a triangulated subcategory.
\end{lemma}

\begin{proof}
It is clear that $\mathcal{D}'$ is preserved under $[1]$ and $[-1]$.
If $(X, Y, Z, f, g, h)$ is a distinguished triangle of $\mathcal{D}$
and $H(X[n]) = H(Y[n]) = 0$ for all $n$, then also $H(Z[n]) = 0$ for all $n$
by the long exact sequence (\ref{equation-long-exact-cohomology-sequence}).
Hence we may apply
Lemma \ref{lemma-triangulated-subcategory}
to see that $\mathcal{D}'$ is a pre-triangulated subcategory (respectively
a triangulated subcategory if $\mathcal{D}$ is a triangulated category).
The assertion of being saturated follows from
\begin{align*}
H((X \oplus Y)[n]) = 0 & \Rightarrow H(X[n] \oplus Y[n]) = 0 \\
& \Rightarrow H(X[n]) \oplus H(Y[n]) = 0 \\
& \Rightarrow H(X[n]) = H(Y[n]) = 0
\end{align*}
for all $n \in \mathbf{Z}$.
\end{proof}

\begin{definition}
\label{definition-kernel-category}
Let $\mathcal{D}$ be a (pre-)triangulated category.
\begin{enumerate}
\item Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor.
The {\it kernel of $F$} is the strictly full saturated
(pre-)triangulated subcategory described in
Lemma \ref{lemma-triangle-functor-kernel}.
\item Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor.
The {\it kernel of $H$} is the strictly full saturated
(pre-)triangulated subcategory described in
Lemma \ref{lemma-homological-functor-kernel}.
\end{enumerate}
These are sometimes denoted $\text{Ker}(F)$ or $\text{Ker}(H)$.
\end{definition}

\noindent
The proof of the following lemma uses TR4.

\begin{lemma}
\label{lemma-construct-multiplicative-system}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{D}' \subset \mathcal{D}$ be a full triangulated
subcategory. Set
\begin{equation}
\label{equation-multiplicative-system}
S =
\left\{
\begin{matrix}
f \in \text{Arrows}(\mathcal{D})
\text{ such that there exists a distinguished triangle }\\
(X, Y, Z, f, g, h) \text{ of }\mathcal{D}\text{ with }
Z\text{ isomorphic to an object of }\mathcal{D}'
\end{matrix}
\right\}
\end{equation}
Then $S$ is a multiplicative system compatible with the triangulated
structure on $\mathcal{D}$. In this situation the following are equivalent
\begin{enumerate}
\item $S$ is a saturated multiplicative system,
\item $\mathcal{D}'$ is a saturated triangulated subcategory.
\end{enumerate}
\end{lemma}

\begin{proof}
To prove the first assertion we have to prove that
MS1, MS2, MS3 and MS5, MS6 hold.

\medskip\noindent
Proof of MS1. It is clear that identities are in $S$ because
$(X, X, 0, 1, 0, 0)$ is distinguished for every object $X$ of $\mathcal{D}$
and because $0$ is an object of $\mathcal{D}'$. Let $f : X \to Y$
and $g : Y \to Z$ be composable morphisms contained in $S$.
Choose distinguished triangles $(X, Y, Q_1, f, p_1, d_1)$,
$(X, Z, Q_2, g \circ f, p_2, d_2)$, and $(Y, Z, Q_3, g, p_3, d_3)$.
By assumption we know that $Q_1$ and $Q_3$ are isomorphic to objects
of $\mathcal{D}'$. By TR4 we know there exists a distinguished
triangle $(Q_1, Q_2, Q_3, a, b, c)$. Since $\mathcal{D}'$ is a
triangulated subcategory we conclude that $Q_2$ is isomorphic to
an object of $\mathcal{D}'$. Hence $g \circ f \in S$.

\medskip\noindent
Proof of MS3. Let $a : X \to Y$ be a morphism and let $t : Z \to X$ be
an element of $S$ such that $a \circ t = 0$. To prove LMS3 we have to
find a $s \in S$ such that $s \circ a = 0$. Choose a distinguished
triangle $(Z, X, Q, t, g, h)$ using TR1 and TR2. Since $a \circ t = 0$
we see by
Lemma \ref{lemma-representable-homological}
there exists a morphism $i : Q \to Y$ such that $i \circ g = a$.
Finally, using TR1 again we can choose a triangle
$(Q, Y, W, i, j, k)$. Here is a picture
$$
\xymatrix{
Z \ar[r]_t & X \ar[r]_g \ar[d]^1 & Q \ar[r] \ar[d]^i & Z[1] \\
& X \ar[r]_a & Y \ar[d]^j \\
& & W
}
$$
Since $t \in S$ we see that $Q$ is isomorphic to an object of $\mathcal{D}'$.
Hence $j \in S$. Finally, $j \circ a = j \circ i \circ g = 0$ as
$j \circ i = 0$. Thus $j \circ f = j \circ g$ and we see that LMS3 holds.
The proof of RMS3 is dual.

\medskip\noindent
Proof of MS5. Follows as distinguished triangles and $\mathcal{D}'$
are stable under translations

\medskip\noindent
Proof of MS6. Suppose given a commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^s &
Y \ar[d]^{s'} \\
X' \ar[r] &
Y'
}
$$
with $s, s' \in S$. By
Proposition \ref{proposition-9}
we can extend this to a nine square diagram. As $s, s'$ are elments of $S$
we see that $X'', Y''$ are isomorphic to objects of $\mathcal{D}'$.
Since $\mathcal{D}'$ is a full triangulated subcategory we see that
$Z''$ is also an object of $\mathcal{D}'$. Whence the morphism $Z' \to Z''$
is an element of $S$. This proves MS6.

\medskip\noindent
MS2 is a formal consquence of MS1, MS5, and MS6, see
Lemma \ref{lemma-localization-conditions}.
This finishes the proof of the first assertion of the lemma.

\medskip\noindent
Let's assume that $S$ is saturated. (In the following we will use
rotation of distinguished triangles without further mention.)
Let $X \oplus Y$ be an object isomorphic to an object of $\mathcal{D}'$.
Consider the morphism $f : 0 \to X$. The composition
$0 \to X \to X \oplus Y$ is an element
of $S$ as $(0, X \oplus Y, X \oplus Y, 0, 1, 0)$ is a distinguished
triangle. The composition $Y[-1] \to 0 \to X$ is an element of $S$
as $(X, X \oplus Y, Y, (1, 0), (0, 1), 0)$ is a distinguished triangle, see
Lemma \ref{lemma-split}.
Hence $0 \to X$ is an element of $S$ (as $S$ is saturated).
Thus $X$ is isomorphic to an object of $\mathcal{D}'$ as desired.

\medskip\noindent
Finally, assume $\mathcal{D}'$ satisfies condition (2) of the lemma.
Let
$$
W \xrightarrow{h}
X \xrightarrow{g}
Y \xrightarrow{f} Z
$$
be composable morphisms of $\mathcal{D}$ such that $fg, gh \in S$.
We will build up a picture of objects as in the diagram below.
$$
\xymatrix{
 & &
Q_{12} \ar[ld]_{\!+\!1} & &
Q_{23} \ar[ld]_{\!+\!1} \ar[ll]_{\!+\!1} \\
 &
Q_1 \ar[ld]_{\!+\!1} & &
Q_2 \ar[ld]_{\!+\!1} \ar[ll]_{\!+\!1} \ar[lu] & &
Q_3 \ar[ld]_{\!+\!1} \ar[ll]_{\!+\!1} \ar[lu] \\
W \ar[rr] & &
X \ar[lu] \ar[rr] & &
Y \ar[lu] \ar[rr] & &
Z \ar[lu]
}
$$
First choose distinguished triangles
$(W, X, Q_1)$, $(X, Y, Q_2)$, $(Y, Z, Q_3)$ $(W, Y, Q_{12})$, and
$(X, Z, Q_{23})$. Denote $s : Q_2 \to Q_1[1]$ the composition
$Q_2 \to X[1] \to Q_1[1]$. Denote $t : Q_3 \to Q_2[1]$ the
composition $Q_3 \to Y[1] \to Q_2[1]$.
By TR4 applied to the composition $W \to X \to Y$
and the composition $X \to Y \to Z$ there exist
a distinguished triangles $(Q_1, Q_{12}, Q_2)$ and $(Q_2, Q_{23}, Q_3)$
which use the morphisms $s$ and $t$.
The objects $Q_{12}$ and $Q_{23}$ are isomorphic to objects of
$\mathcal{D}'$ as $W \to Y$ and $X \to Z$ are assumed in $S$.
Hence also $s[1]t$ is an element of $S$ as $S$ is closed under compositions
and shifts.
Note that $s[1]t = 0$ as $Y[1] \to Q_2[1] \to X[2]$ is zero, see
Lemma \ref{lemma-composition-zero}.
Hence $Q_3 \oplus Q_1[2]$ is isomorphic to an object of $\mathcal{D}'$, see
Lemma \ref{lemma-split}.
By assumption on $\mathcal{D}'$ we conclude that $Q_3, Q_1$ are isomorphic
to objects of $\mathcal{D}'$. Looking at the distinguished triangle
$(Q_1, Q_{12}, Q_2)$ we conclude that $Q_2$ is also isomorphic to
an object of $\mathcal{D}'$. Looking at the distinguished triangle
$(X, Y, Q_2)$ we finally conclude that $g \in S$. (It is also
follows that $h, f \in S$, but we don't need this.)
\end{proof}

\begin{definition}
\label{definition-quotient-category}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{B}$ be a full triangulated subcategory.
We define the {\it quotient category $\mathcal{D}/\mathcal{B}$}
by the formula $\mathcal{D}/\mathcal{B} = S^{-1}\mathcal{D}$, where
$S$ is the multiplicative system of $\mathcal{D}$ associated to
$\mathcal{B}$ via
Lemma \ref{lemma-construct-multiplicative-system}.
The localization functor $Q : \mathcal{D} \to \mathcal{D}/\mathcal{B}$
is called the {\it quotient functor} in this case.
\end{definition}

\noindent
Note that the quotient functor
$Q : \mathcal{D} \to \mathcal{D}/\mathcal{B}$
is an exact functor of triangulated categories, see
Proposition \ref{proposition-construct-localization}.
The universal property of this construction is the following.

\begin{lemma}
\label{lemma-universal-property-quotient}
Let $\mathcal{D}$ be a triangulated category. Let $\mathcal{B}$
be a full triangulated subcategory of $\mathcal{D}$. Let
$Q : \mathcal{D} \to \mathcal{D}/\mathcal{B}$ be the quotient functor.
\begin{enumerate}
\item If $H : \mathcal{D} \to \mathcal{A}$ is a homological functor into
an abelian category $\mathcal{A}$ such that
$\mathcal{B} \subset \text{Ker}(H)$ then there exists a unique factorization
$H' : \mathcal{D}/\mathcal{B} \to \mathcal{A}$ such that $H = H' \circ Q$
and $H'$ is a homological functor too.
\item If $F : \mathcal{D} \to \mathcal{D}'$ is an exact functor into
a pre-triangulated category $\mathcal{D}'$ such that
$\mathcal{B} \subset \text{Ker}(F)$ then there exists a unique factorization
$F' : \mathcal{D}/\mathcal{B} \to \mathcal{D}'$ such that $F = F' \circ Q$
and $F'$ is an exact functor too.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma follows from
Lemma \ref{lemma-universal-property-localization}.
Namely, if $f : X \to Y$ is a morphism of $\mathcal{D}$
such that for some distinguished triangle $(X, Y, Z, f, g, h)$
the object $Z$ is isomorphic to an object of $\mathcal{B}$, then
$H(f)$, resp.\ $F(f)$ is an isomorphism under the assumptions of
(1), resp.\ (2). Details omitted.
\end{proof}

\noindent
The kernel of the quotient functor can be described as follows.

\begin{lemma}
\label{lemma-kernel-quotient}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{B}$ be a full triangulated subcategory.
The kernel of the quotient functor
$Q : \mathcal{D} \to \mathcal{D}/\mathcal{B}$
is the strictly full subcategory of $\mathcal{D}$ whose objects are
$$
\text{Ob}(\text{Ker}(Q)) =
\left\{
\begin{matrix}
Z \in \text{Ob}(\mathcal{D})
\text{ such that there exists a }Z' \in \text{Ob}(\mathcal{D}) \\
\text{ such that }Z \oplus Z'\text{ is isomorphic to an object of }\mathcal{B}
\end{matrix}
\right\}
$$
In other words it is the smallest strictly full saturated triangulated
subcategory of $\mathcal{D}$ containing $\mathcal{B}$.
\end{lemma}

\begin{proof}
First note that the kernel is automatically a strictly full
triangulated subcategory stable containing summands of any of its objects, see
Lemma \ref{lemma-triangle-functor-kernel}.
The description of its objects follows from the definitions and
Lemma \ref{lemma-kernel-localization} part (4).
\end{proof}

\noindent
Let $\mathcal{D}$ be a triangulated category.
At this point we have constructions which induce order
preserving maps between
\begin{enumerate}
\item the partially ordered set of multiplicative systems $S$ in $\mathcal{D}$
compatible with the triangulated structure, and
\item the partially ordered set of full triangulated subcategories
$\mathcal{B} \subset \mathcal{D}$.
\end{enumerate}
Namely, the constructions are given by
$S \mapsto \mathcal{B}(S) = \text{Ker}(Q : \mathcal{D} \to S^{-1}\mathcal{D})$
and $\mathcal{B} \mapsto S(\mathcal{B})$
where $S(\mathcal{B})$ is the multiplicative set of
(\ref{equation-multiplicative-system}), i.e.,
$$
S(\mathcal{B}) =
\left\{
\begin{matrix}
f \in \text{Arrows}(\mathcal{D})
\text{ such that there exists a distinguished triangle }\\
(X, Y, Z, f, g, h) \text{ of }\mathcal{D}\text{ with }
Z\text{ isomorphic to an object of }\mathcal{B}
\end{matrix}
\right\}
$$
Note that it is not the case that these operations are mutually inverse.

\begin{lemma}
\label{lemma-operations}
Let $\mathcal{D}$ be a triangulated category. The operations described above
have the following properties
\begin{enumerate}
\item $S(\mathcal{B}(S))$ is the ``saturation'' of $S$, i.e., it is the
smallest saturated multiplicative system in $\mathcal{D}$ containing $S$, and
\item $\mathcal{B}(S(\mathcal{B}))$ is the ``saturation'' of $\mathcal{B}$,
i.e., it is the smallest strictly full saturated triangulated subcategory of
$\mathcal{D}$ containing $\mathcal{B}$.
\end{enumerate}
In particular, the constructions define mutually inverse maps between
the (partially ordered) set of saturated multiplicative systems in
$\mathcal{D}$ compatible with the triangulated structure on $\mathcal{D}$
and
the (partially ordered) set of strictly full saturated triangulated
subcategories of $\mathcal{D}$.
\end{lemma}

\begin{proof}
First, let's start with a full triangulated subcategory $\mathcal{B}$. Then
$\mathcal{B}(S(\mathcal{B})) =
\text{Ker}(Q : \mathcal{D} \to \mathcal{D}/\mathcal{B})$
and hence (2) is the content of
Lemma \ref{lemma-kernel-quotient}.

\medskip\noindent
Next, suppose that $S$ is multiplicative system in $\mathcal{D}$ compatible
with the triangulation on $\mathcal{D}$. Then
$\mathcal{B}(S) = \text{Ker}(Q : \mathcal{D} \to S^{-1}\mathcal{D})$.
Hence (using
Lemma \ref{lemma-third-object-zero}
in the localized category)
\begin{align*}
S(\mathcal{B}(S))
& =
\left\{
\begin{matrix}
f \in \text{Arrows}(\mathcal{D})
\text{ such that there exists a distinguished}\\
\text{triangle }(X, Y, Z, f, g, h) \text{ of }\mathcal{D}\text{ with }Q(Z) = 0
\end{matrix}
\right\}
\\
& =
\{f \in \text{Arrows}(\mathcal{D}) \mid Q(f)\text{ is an isomorphism}\} \\
& = \hat S = S'
\end{align*}
in the notation of
Categories, Lemma \ref{categories-lemma-what-gets-inverted}.
The final statement of that lemma finishes the proof.
\end{proof}

\begin{lemma}
\label{lemma-acyclic-general}
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor from a
triangulated category $\mathcal{D}$ to an abelian category $\mathcal{A}$, see
Definition \ref{definition-homological}.
The subcategory $\text{Ker}(H)$ of $\mathcal{D}$ is a strictly full
saturated triangulated subcategory of $\mathcal{D}$ whose corresponding
saturated multiplicative system (see
Lemma \ref{lemma-operations})
is the set
$$
S = \{f \mid H^i(f)\text{ is an isomorphism for all }i \in \mathbf{Z}\}.
$$
The functor $H$ factors through the quotient functor
$Q : \mathcal{D} \to \mathcal{D}/\text{Ker}(H)$.
\end{lemma}

\begin{proof}
The category $\text{Ker}(H)$ is a strictly full saturated triangulated
subcategory of $\mathcal{D}$ by
Lemma \ref{lemma-homological-functor-kernel}.
The set $S$ is a saturated multiplicative system compatible with the
triangulated structure by
Lemma \ref{lemma-homological-functor-localize}.
Recall that the multiplicative system corresponding to
$\text{Ker}(H)$ is the set
$$
\left\{
\begin{matrix}
f \in \text{Arrows}(K(\mathcal{A}))
\text{ such that there exists a distinguished triangle }\\
(X, Y, Z, f, g, h)\text{ with } H^i(Z) = 0 \text{ for all }i
\end{matrix}
\right\}
$$
By the long exact cohomology sequence, see
(\ref{equation-long-exact-cohomology-sequence}),
it is clear that $f$ is an element of this set if and only if $f$ is
an element of $S$. Finally, the factorization of $H$ through $Q$ is a
consequence of
Lemma \ref{lemma-universal-property-quotient}.
\end{proof}

\noindent
It is clear that in the lemma above the factorization of $H$ through
$\mathcal{D}/\text{Ker}(H)$ is the universal factorization. Namely, if
$F : \mathcal{D} \to \mathcal{D}'$ is an exact functor of triangulated
categories and if there exists a homological functor
$H' : \mathcal{D}' \to \mathcal{A}$ such that $H \cong H' \circ F$, then
$F$ factors through the quotient functor
$Q : \mathcal{D} \to \mathcal{D}/\text{Ker}(H)$.








\section{Homotopy category}
\label{section-homotopy}

\noindent
Let $\mathcal{A}$ be an additive category. The homotopy category
$K(\mathcal{A})$ of $\mathcal{A}$ is the the category of complexes of
$\mathcal{A}$ with morphisms given by morphisms of complexes up to homotopy.
Here is the formal definition.

\begin{definition}
\label{definition-complexes-notation}
Let $\mathcal{A}$ be an additive category.
\begin{enumerate}
\item We set $\text{Comp}(\mathcal{A}) = \text{CoCh}(\mathcal{A})$
be the {\it category of (cochain) complexes}.
\item A complex $K^\bullet$ is said to be
{\it bounded below} if $K^n = 0$ for all $n \ll 0$.
\item A complex $K^\bullet$ is said to be
{\it bounded above} if $K^n = 0$ for all $n \gg 0$.
\item A complex $K^\bullet$ is said to be
{\it bounded} if $K^n = 0$ for all $|n| \gg 0$.
\item We let
$\text{Comp}^{+}(\mathcal{A})$, $\text{Comp}^{-}(\mathcal{A})$,
resp.\ $\text{Comp}^b(\mathcal{A})$ be the full subcategory
of $\text{Comp}(\mathcal{A})$ whose objects are the complexes
which are bounded below, bounded above, resp.\ bounded.
\item We let $K(\mathcal{A})$ be the category with the same objects
as $\text{Comp}(\mathcal{A})$ but as morphisms homotopy classes of
maps of complexes (see
Homology, Lemma \ref{homology-lemma-compose-homotopy-cochain}).
\item We let $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$,
resp.\ $K^b(\mathcal{A})$ be the full subcategory of $K(\mathcal{A})$
whose objects are bounded below, bounded above, resp.\ bounded
complexes of $\mathcal{A}$.
\end{enumerate}
\end{definition}

\noindent
It will turn out that the categories $K(\mathcal{A})$,
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
are triangulated categories. To prove this we first develop
some machinery related to cones and split exact sequences.




\section{Homotopy category: Cones and termwise split sequences}
\label{section-cones}

\noindent
Let $\mathcal{A}$ be an additive category, and let
$K(\mathcal{A})$ denote the category of complexes of
$\mathcal{A}$ with morphisms given by morphisms of
complexes up to homotopy. Note that the shift functors
$[n]$ on complexes, see
Homology, Definition \ref{homology-definition-shift-cochain},
give rise to functors $[n] : K(\mathcal{A}) \to K(\mathcal{A})$
such that $[n] \circ [m] = [n + m]$ and $[0] = \text{id}$.

\begin{definition}
\label{definition-cone}
Let $\mathcal{A}$ be an additive category.
Let $f : K^\bullet \to L^\bullet$ be a morphism of
complexes of $\mathcal{A}$. The {\it cone} of $f$
is the complex $C(f)^\bullet$ given by
$C(f)^n = L^n \oplus K^{n + 1}$ and
differential
$$
d_{C(f)}^n =
\left(
\begin{matrix}
d^n_L & f^{n + 1} \\
0 & -d_K^{n + 1}
\end{matrix}
\right)
$$
It comes equipped with canonical morphisms of complexes
$i : L^\bullet \to C(f)^\bullet$ and $p : C(f)^\bullet \to K^\bullet[1]$
induced by the obvious maps $L^n \to C(f)^n \to K^{n + 1}$.
\end{definition}

\noindent
In other words $(K, L, C(f), f, i, p)$ forms a triangle:
$$
K^\bullet \to L^\bullet \to C(f)^\bullet \to K^\bullet[1]
$$
The formation of this triangle is
functorial in the following sense.

\begin{lemma}
\label{lemma-functorial-cone}
Suppose that
$$
\xymatrix{
K_1^\bullet \ar[r]_{f_1} \ar[d]_a & L_1^\bullet \ar[d]^b \\
K_2^\bullet \ar[r]^{f_2} & L_2^\bullet
}
$$
is a diagram of morphisms of complexes which is commutative
up to homotopy. Then there exists a morphism
$c : C(f_1)^\bullet \to C(f_2)^\bullet$ which gives rise to
a morphism of triangles
$(a, b, c) : (K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_1, i_1, p_1)
\to
(K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_2, i_2, p_2)$
of $K(\mathcal{A})$.
\end{lemma}

\begin{proof}
Let $h^n : K_1^n \to L_2^{n - 1}$ be a family of morphisms such that
$f_2 \circ a - b \circ f_1 = d \circ h + h \circ d$.
Define $c^n$ by the matrix
$$
c^n =
\left(
\begin{matrix}
a^n & h^{n + 1} \\
0 & b^n
\end{matrix}
\right) :
L_1^n \oplus K_1^{n + 1} \to L_2^n \oplus K_2^{n + 1}
$$
A matrix computation show that $c$ is a morphism of complexes.
It is trivial that $c \circ i_1 = i_2 \circ b$, and it is
trivial also to check that $p_2 \circ c = a \circ p_1$.
\end{proof}

\noindent
Note that the morphism $c : C(f_1)^\bullet \to C(f_2)^\bullet$
constructed in the
proof of Lemma \ref{lemma-functorial-cone} in general depends on the
chosen homotopy $h$ between $f_2 \circ a$ and $b \circ f_1$.

\begin{definition}
\label{definition-termwise-split-map}
Let $\mathcal{A}$ be an additive category.
A {\it termwise split injection $\alpha : A^\bullet \to B^\bullet$}
is a morphism of complexes such that each $A^n \to B^n$
is isomorphic to the inclusion of a direct summand.
A {\it termwise split surjection $\beta : B^\bullet \to C^\bullet$}
is a morphism of complexes such that each $B^n \to C^n$
is isomorphic to the projection onto a direct summand.
\end{definition}

\begin{lemma}
\label{lemma-make-commute-map}
Let $\mathcal{A}$ be an additive category.
Let
$$
\xymatrix{
A^\bullet \ar[r]_f \ar[d]_a & B^\bullet \ar[d]^b \\
C^\bullet \ar[r]^g & D^\bullet
}
$$
be a diagram of morphisms of complexes commuting up to homotopy.
If $f$ is a split injection, then $b$ is homotopic to a
morphism which makes the diagram commute.
If $g$ is a split surjection, then $a$ is homotopic to a
morphism which makes the diagram commute.
\end{lemma}

\begin{proof}
Let $h^n : A^n \to D^{n - 1}$ be a collection of morphisms
such that $bf - ga = dh + hd$. Suppose that $\pi^n : B^n \to A^n$
are morphisms splitting the morphisms $f^n$.
Take $b' = b + dh\pi + h\pi d$.
Suppose $s^n : D^n \to C^n$ are morphisms splitting the morphisms
$g^n : C^n \to D^n$. Take $a' = a + dsh + shd$.
Computations omitted.
\end{proof}


\noindent
The following lemma can be used to replace an morphism of complexes
by a morphism where in each degree the map is the injection of a
direct summand.

\begin{lemma}
\label{lemma-make-injective}
Let $\mathcal{A}$ be an additive category.
Let $\alpha : K^\bullet \to L^\bullet$ be a morphism
of complexes of $\mathcal{A}$.
There exists a factorization
$$
\xymatrix{
K^\bullet \ar[r]^{\tilde \alpha} \ar@/_1pc/[rr]_\alpha &
\tilde L^\bullet \ar[r]^\pi &
L^\bullet
}
$$
such that
\begin{enumerate}
\item $\tilde \alpha$ is a termwise split injection (see
Definition \ref{definition-termwise-split-map}),
\item there is a map of complexes $s : L^\bullet \to \tilde L^\bullet$
such that $\pi \circ s = \text{id}_{L^\bullet}$ and such that
$s \circ \pi$ is homotopic to $\text{id}_{\tilde L^\bullet}$.
\end{enumerate}
Moreover, if both $K^\bullet$ and $L^\bullet$ are in
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$,
then so is $\tilde L^\bullet$.
\end{lemma}

\begin{proof}
We set
$$
\tilde L^n = L^n \oplus K^n \oplus K^{n + 1}
$$
and we define
$$
d^n_{\tilde L} =
\left(
\begin{matrix}
d^n_L & 0 & 0 \\
0 & d^n_K & \text{id}_{K^{n + 1}} \\
0 & 0 & -d^{n + 1}_K
\end{matrix}
\right)
$$
Moreover, we set
$$
\tilde \alpha =
\left(
\begin{matrix}
\alpha \\
\text{id}_{K^n} \\
0
\end{matrix}
\right)
$$
which is clearly a split injection. It is also clear that it defines a morphism
of complexes. We define
$$
\pi =
\left(
\begin{matrix}
\text{id}_{L^n} &
0 &
0
\end{matrix}
\right)
$$
so that clearly $\pi \circ \tilde \alpha = \alpha$. We set
$$
s =
\left(
\begin{matrix}
\text{id}_{L^n} \\
0 \\
0
\end{matrix}
\right)
$$
so that $\pi \circ s = \text{id}_{L^\bullet}$. Finally,
let $h^n : \tilde L^n \to \tilde L^{n - 1}$ be the map
which maps the summand $K^n$ of $L^n$ via the identity morphism
to the summand $K^n$ of $L^{n - 1}$. Then it is a trivial matter
(see computations in remark below) to prove that
$$
\text{id}_{\tilde L^\bullet} - s \circ \pi
=
d \circ h + h \circ d
$$
which finishes the proof of the lemma.
\end{proof}

\begin{remark}
\label{remark-compute-modules}
To see the last displayed equality in the proof above we can argue
with elements as follows. We have
$s\pi(l, k, k^{+}) = (l, 0, 0)$.
Hence the morphism of the left hand side maps
$(l, k, k^{+})$ to $(0, k, k^{+})$.
On the other hand $h(l, k, k^{+}) = (0, 0, k)$ and
$d(l, k, k^{+}) = (dl, dk + k^{+}, -dk^{+})$.
Hence $(dh + hd)(l, k, k^{+}) =
d(0, 0, k) + h(dl, dk + k^{+}, -dk^{+}) =
(0, k, -dk) + (0, 0, dk + k^{+}) = (0, k, k^{+})$
as desired.
\end{remark}

\begin{definition}
\label{definition-split-ses}
Let $\mathcal{A}$ be an additive category.
A {\it termwise split sequence of complexes of $\mathcal{A}$}
is a complex of complexes
$$
0 \to
A^\bullet \xrightarrow{\alpha}
B^\bullet \xrightarrow{\beta}
C^\bullet \to 0
$$
together with given direct sum decompositions
$B^n = A^n \oplus C^n$
compatible with $\alpha^n$ and $\beta^n$.
We often write $s^n : C^n \to B^n$ and $\pi^n : B^n \to A^n$
for the maps induced by the direct sum decompositions.
According to
Homology, Lemma \ref{homology-lemma-ses-termwise-split-cochain}
we get an associated morphism of complexes
$$
\delta : C^\bullet \longrightarrow A^\bullet[1]
$$
which in degree $n$ is the map $\pi^{n + 1} \circ d_C^n \circ s^n$.
In other words
$(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
forms a triangle
$$
A^\bullet \to B^\bullet \to C^\bullet \to A^\bullet[1]
$$
This will be the {\it triangle associated to the termwise
split sequence of complexes}.
\end{definition}

\begin{lemma}
\label{lemma-make-commute}
Let $\mathcal{A}$ be an additive category.
Let $0 \to A_i^\bullet \to B_i^\bullet \to C_i^\bullet \to 0$, $i = 1, 2$
be termwise split exact sequences. Suppose that
$a : A_1^\bullet \to A_2^\bullet$,
$b : B_1^\bullet \to B_2^\bullet$, and
$c : C_1^\bullet \to C_2^\bullet$ are morphisms of complexes
such that
$$
\xymatrix{
A_1^\bullet \ar[d]_a \ar[r] &
B_1^\bullet \ar[r] \ar[d]_b &
C_1^\bullet \ar[d]_c \\
A_2^\bullet \ar[r] & B_2^\bullet \ar[r] & C_2^\bullet
}
$$
commutes in $K(\mathcal{A})$. Then there exists a morphism
$b' : B_1^\bullet \to B_2^\bullet$
which is homotopic to $b$ such that the diagram above commutes
in the category of complexes.
\end{lemma}

\begin{proof}
Let $f^n : A_1^n \to B_2^{n - 1}$ be a collection of morphisms
such that $b \circ \alpha_1 - \alpha_2 \circ a =
d  \circ f + f \circ d$. Let
$g^n : B_1^n \to C_2^{n - 1}$ be a collection of morphisms
such that $c \circ \beta_1 - \beta_2 \circ b =
d  \circ g + g \circ d$. Suppose that
$\pi^n : B_1^n \to A_1^n$ (resp.\ $s^n : C_2^n \to B_2^n$)
are the morphisms splitting the morphisms $\alpha_1^n$
(resp.\ $\beta_2^n$). Set $h^n = - f^n \circ \pi^n + s^{n - 1} \circ g^n$.
Take $b' = b + d \circ h + h \circ d$. Computation omitted.
\end{proof}

\begin{lemma}
\label{lemma-third-isomorphism}
Let $\mathcal{A}$ be an additive category.
Let $f_1 : K_1^\bullet \to L_1^\bullet$ and
$f_2 : K_2^\bullet \to L_2^\bullet$ be morphisms of complexes.
Let
$$
(a, b, c) :
(K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_1, i_1, p_1)
\longrightarrow
(K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_2, i_2, p_2)
$$
be any morphism of triangles of $K(\mathcal{A})$.
If $a$ and $b$ are homotopy equivalences then so is $c$.
\end{lemma}

\begin{proof}
Let $a^{-1} : K_2^\bullet \to K_1^\bullet$ be a morphism of complexes which
is inverse to $a$ in $K(\mathcal{A})$.
Let $b^{-1} : L_2^\bullet \to L_1^\bullet$ be a morphism of complexes which
is inverse to $b$ in $K(\mathcal{A})$.
Let $c' : C(f_2)^\bullet \to C(f_1)^\bullet$
be the morphism from Lemma \ref{lemma-functorial-cone} applied
to $f_1 \circ a^{-1} = b^{-1} \circ f_2$. If we can show that
$c \circ c'$ and $c' \circ c$ are isomorphisms in $K(\mathcal{A})$
then we win. Hence it suffices to prove the following: Given
a morphism of triangles
$(1, 1, c) : (K^\bullet, L^\bullet, C(f)^\bullet, f, i, p)$
in $K(\mathcal{A})$ the morphism $c$ is an isomorphism in $K(\mathcal{A})$.
By assumption the two squares in the diagram
$$
\xymatrix{
L^\bullet \ar[r] \ar[d]_1 &
C(f)^\bullet \ar[r] \ar[d]_c &
K^\bullet[1] \ar[d]_1 \\
L^\bullet \ar[r] &
C(f)^\bullet \ar[r] &
K^\bullet[1]
}
$$
commute up to homotopy. By construction of $C(f)^\bullet$ the rows
form termwise split sequences of complexes.
By Lemma \ref{lemma-make-commute} we may replace $c$ by
a morphism homotopic to $c$ such that the diagram commutes in the
category of complexes. In this case each $c^n$ is an isomorphism
(because an upper triangular matrix with $1$'s on the diagonal is invertible).
\end{proof}

\noindent
Hence if $a$ and $b$ are homotopy equivalences then
the resulting morphism of triangles is an isomorphism of triangles
in $K(\mathcal{A})$.
It turns out that the collection of triangles of $K(\mathcal{A})$
given by cones and the collection of triangles of $K(\mathcal{A})$
given by termwise split sequences of complexes are the same
up to isomorphisms, at least up to sign!

\begin{lemma}
\label{lemma-the-same-up-to-isomorphisms}
Let $\mathcal{A}$ be an additive category.
\begin{enumerate}
\item Given a termwise split sequence of complexes
$(\alpha : A^\bullet \to B^\bullet,
\beta : B^\bullet \to C^\bullet, s^n, \pi^n)$
there exists a homotopy equivalence $C(\alpha)^\bullet \to C^\bullet$
such that the diagram
$$
\xymatrix{
A^\bullet \ar[r] \ar[d] & B^\bullet \ar[d] \ar[r] &
C(\alpha)^\bullet \ar[r]_{-p} \ar[d] & A^\bullet[1] \ar[d] \\
A^\bullet \ar[r] & B^\bullet \ar[r] &
C^\bullet \ar[r]^\delta & A^\bullet[1]
}
$$
defines an isomorphism of triangles in $K(\mathcal{A})$.
\item Given a morphism of complexes $f : K^\bullet \to L^\bullet$
there exists an isomorphism of triangles
$$
\xymatrix{
K^\bullet \ar[r] \ar[d] & \tilde L^\bullet \ar[d] \ar[r] &
M^\bullet \ar[r]_{\delta} \ar[d] & K^\bullet[1] \ar[d] \\
K^\bullet \ar[r] & L^\bullet \ar[r] &
C(f)^\bullet \ar[r]^{-p} & K^\bullet[1]
}
$$
where the upper triangle is the triangle associated to a
termwise split exact sequence $K^\bullet \to \tilde L^\bullet \to M^\bullet$.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). We have $C(\alpha)^n = B^n \oplus A^{n + 1}$
and we simply define $C(\alpha)^n \to C^n$ via the projection
onto $B^n$ followed by $\beta^n$. This defines
a morphism of complexes because the compositions
$A^{n + 1} \to B^{n + 1} \to B^n \to C^n$ are zero.
To get a homotopy inverse we take
$C^\bullet \to C(\alpha)^\bullet$ given by
$(s^n , -\delta^n)$ in degree $n$. This is a morphism of complexes
because the morphism $\delta^n$ can be characterized as the
unique morphism $C^n \to A^{n + 1}$ such that
$d \circ s^n - s^{n + 1} \circ d = \alpha \circ \delta^n$,
see proof of
Homology, Lemma \ref{homology-lemma-ses-termwise-split-cochain}.
The composition
$C^\bullet \to C(f)^\bullet \to C^\bullet$ is the identity.
The composition $C(f)^\bullet \to C^\bullet \to C(f)^\bullet$
is equal to the morphism
$$
\left(
\begin{matrix}
s^n \circ \beta^n & 0 \\
-\delta^n \circ \beta^n & 0
\end{matrix}
\right)
$$
To see that this is homotopic to the identity map
use the homotopy $h^n : C(\alpha)^n \to C(\alpha)^{n - 1})$
given by the matrix
$$
\left(
\begin{matrix}
0 & 0 \\
\pi^n & 0
\end{matrix}
\right) : C(\alpha)^n = B^n \oplus A^{n + 1} \to
B^{n - 1} \oplus A^n = C(\alpha)^{n - 1}
$$
It is trivial to verify that
$$
\left(
\begin{matrix}
1 & 0 \\
0 & 1
\end{matrix}
\right)
-
\left(
\begin{matrix}
s^n &
-\delta^n
\end{matrix}
\right)
\left(
\begin{matrix}
\beta^n \\
0
\end{matrix}
\right)
=
\left(
\begin{matrix}
d & \alpha^{n + 1} \\
0 & -d
\end{matrix}
\right)
\left(
\begin{matrix}
0 & 0 \\
\pi^n & 0
\end{matrix}
\right)
+
\left(
\begin{matrix}
0 & 0 \\
\pi^{n + 1} & 0
\end{matrix}
\right)
\left(
\begin{matrix}
d & \alpha^{n + 1} \\
0 & -d
\end{matrix}
\right)
$$
To finish the proof of (1) we have to show that the morphisms
$-p : C(\alpha)^\bullet \to A^\bullet[1]$ (see
Definition \ref{definition-cone})
and  $C(\alpha)^\bullet \to C^\bullet \to A^\bullet[1]$ agree up
to homotopy. This is clear from the above. Namely, we can use the homotopy
inverse $(s, -\delta) : C^\bullet \to C(\alpha)^\bullet$
and check instead that the two maps
$C^\bullet \to A^\bullet[1]$ agree. And note that
$p \circ (s, -\delta) = -\delta$ as desired.

\medskip\noindent
Proof of (2). We let $\tilde f : K^\bullet \to \tilde L^\bullet$,
$s : L^\bullet \to \tilde L^\bullet$
and $\pi : L^\bullet \to L^\bullet$ be as in
Lemma \ref{lemma-make-injective}. By Lemmas \ref{lemma-functorial-cone}
and \ref{lemma-third-isomorphism}
the triangles $(K^\bullet, L^\bullet, C(f), i, p)$ and
$(K^\bullet, \tilde L^\bullet, C(\tilde f), \tilde i, \tilde p)$
are isomorphic. Note that we can compose isomorphisms of
triangles. Thus we may replace $L^\bullet$ by
$\tilde L^\bullet$ and $f$ by $\tilde f$. In other words
we may assume that $f$ is a termwise split injection.
In this case the result follows from part (1).
\end{proof}


\begin{lemma}
\label{lemma-sequence-maps-split}
Let $\mathcal{A}$ be an additive category.
Let $A_1^\bullet \to A_2^\bullet \to \ldots \to A_n^\bullet$
be a sequence of composable morphisms of complexes.
There exists a commutative diagram
$$
\xymatrix{
A_1^\bullet \ar[r] &
A_2^\bullet \ar[r] &
\ldots \ar[r] &
A_n^\bullet \\
B_1^\bullet \ar[r] \ar[u] &
B_2^\bullet \ar[r] \ar[u] &
\ldots \ar[r] &
B_n^\bullet \ar[u]
}
$$
such that each morphism $B_i^\bullet \to B_{i + 1}^\bullet$
is a split injection and each $B_i^\bullet \to A_i^\bullet$
is a homotopy equivalence. Moreover, if all $A_i^\bullet$ are in
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$,
then so are the $B_i^\bullet$.
\end{lemma}

\begin{proof}
The case $n = 1$ is without content.
Lemma \ref{lemma-make-injective} is the case $n = 2$.
Suppose we have constructed the diagram
except for $B_n$. Applying Lemma \ref{lemma-make-injective} to
the composition $B_{n - 1} \to A_{n - 1} \to A_n$.
The result is a factorization $B_{n - 1} \to \tilde B_n \to A_n$
as desired.
\end{proof}


\begin{lemma}
\label{lemma-rotate-triangle}
Let $\mathcal{A}$ be an additive category. Let
$(\alpha : A^\bullet \to B^\bullet, \beta : B^\bullet \to C^\bullet, s^n,
\pi^n)$ be a termwise split sequence of complexes.
Let $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
be the associated triangle.
Then the triangle
$(C^\bullet[-1], A^\bullet, B^\bullet, \delta[-1], \alpha, \beta)$
is isomorphic to the triangle
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, p)$.
\end{lemma}

\begin{proof}
We write $B^n = A^n \oplus C^n$ and we identify $\alpha^n$ and $\beta^n$
with the natural inclusion and projection maps. By construction of $\delta$ we
have
$$
d_B^n =
\left(
\begin{matrix}
d_A^n & \delta^n \\
0 & d_C^n
\end{matrix}
\right)
$$
On the other hand the cone of $\delta[-1] : C^\bullet[-1] \to A^\bullet$
is given as $C(\delta[-1])^n = A^n \oplus C^n$ with differential identical
with the matrix above! Whence the lemma.
\end{proof}

\begin{lemma}
\label{lemma-rotate-cone}
Let $\mathcal{A}$ be an additive category.
Let $f : K^\bullet \to L^\bullet$ be a morphism of complexes.
The triangle $(L^\bullet, C(f)^\bullet, K^\bullet[1], i, p, f[1])$ is
the triangle associated to the termwise split sequence
$$
0 \to L^\bullet \to C(f)^\bullet \to K^\bullet[1] \to 0
$$
coming from the definition of the cone of $f$.
\end{lemma}

\begin{proof}
Immediate from the definitions.
\end{proof}



\section{Homotopy category: Distinguished triangles}
\label{section-homotopy-triangulated}

\noindent
Since we want our boundary maps in long exact sequences of cohomology
to be given by the maps in the snake lemma without signs we define
distinguished triangles in the homotopy category as follows.

\begin{definition}
\label{definition-distinguished-triangle}
Let $\mathcal{A}$ be an additive category.
A triangle $(X, Y, Z, f, g, h)$ of $K(\mathcal{A})$ is
called a {\it distinguished triangle of $K(\mathcal{A})$}
if it is isomorphic to the triangle associated to
a termwise split exact sequence of complexes, see Definition
\ref{definition-split-ses}.
Same definition for $K^{+}(\mathcal{A})$.
\end{definition}

\noindent
Note that according to Lemma \ref{lemma-the-same-up-to-isomorphisms}
a triangle of the form $(K^\bullet, L^\bullet, C(f)^\bullet, f, i, -p)$
is a distinguished triangle.
This does indeed lead to a triangulated category, see
Proposition \ref{lemma-the-same-up-to-isomorphisms}.
Before we can prove the proposition we need one more lemma
in order to be able to prove TR4.

\begin{lemma}
\label{lemma-two-split-injections}
Let $\mathcal{A}$ be an additive category. Suppose that
$\alpha : A^\bullet \to B^\bullet$ and $\beta : B^\bullet \to C^\bullet$
are split injections of complexes. Then there exist distinguished triangles
$(A^\bullet, B^\bullet, Q_1^\bullet, \alpha, p_1, d_1)$,
$(A^\bullet, C^\bullet, Q_2^\bullet, \beta \circ \alpha, p_2, d_2)$
and
$(B^\bullet, C^\bullet, Q_3^\bullet, \beta, p_3, d_3)$
for which TR4 holds.
\end{lemma}

\begin{proof}
Say $\pi_1^n : B^n \to A^n$, and $\pi_3^n : C^n \to B^n$ are the splittings.
Then also $A^\bullet \to C^\bullet$ is a split injection with splittings
$\pi_2^n = \pi_1^n \circ \pi_3^n$. Let us write $Q_1^\bullet$, $Q_2^\bullet$
and $Q_3^\bullet$ for the ``quotient'' complexes. In other words,
$Q_1^n = \text{Ker}(\pi_1^n)$, $Q_3^n = \text{Ker}(\pi_3^n)$ and
$Q_2^n = \text{Ker}(\pi_2^n)$. Note that the kernels exist. Then
$B^n = A^n \oplus Q_1^n$ and $C_n = B^n \oplus Q_3^n$, where we think of $A^n$
as a subobject of $B^n$ and so on. This implies
$C^n = A^n \oplus Q_1^n \oplus Q_3^n$. Note that
$\pi_2^n = \pi_1^n \circ \pi_3^n$ is zero on both $Q_1^n$ and $Q_3^n$. Hence
$Q_2^n = Q_1^n \oplus Q_3^n$. Consider the commutative diagram
$$
\begin{matrix}
0 & \to & A^\bullet & \to & B^\bullet & \to & Q_1^\bullet & \to & 0 \\
  &     & \downarrow&     & \downarrow&     & \downarrow  & \\
0 & \to & A^\bullet & \to & C^\bullet & \to & Q_2^\bullet & \to & 0 \\
  &     & \downarrow&     & \downarrow&     & \downarrow  & \\
0 & \to & B^\bullet & \to & C^\bullet & \to & Q_3^\bullet & \to & 0
\end{matrix}
$$
The rows of this diagram are termwise split exact sequences, and
hence determine distinguished triangles by
definition. Moreover downward arrows in the diagram above
are compatible with the chosen splittings and hence
define morphisms of triangles
$$
(A^\bullet \to B^\bullet \to Q_1^\bullet \to A^\bullet[1])
\longrightarrow
(A^\bullet \to C^\bullet \to Q_2^\bullet \to A^\bullet[1])
$$
and
$$
(A^\bullet \to C^\bullet \to Q_2^\bullet \to A^\bullet[1])
\longrightarrow
(B^\bullet \to C^\bullet \to Q_3^\bullet \to B^\bullet[1]).
$$
Note that the splittings $Q_3^n \to C^n$
of the bottom split sequence in the diagram provides a splitting
for the split sequence
$0 \to Q_1^\bullet \to Q_2^\bullet \to Q_3^\bullet \to 0$
upon composing with $C^n \to Q_2^n$. It follows easily from this
that the morphism $\delta : Q_3^\bullet \to Q_1^\bullet[1]$
in the corresponding distinguished triangle
$$
(Q_1^\bullet \to Q_2^\bullet \to Q_3^\bullet \to Q_1^\bullet[1])
$$
is equal to the composition $Q_3^\bullet \to B^\bullet[1] \to Q_1^\bullet[1]$.
Hence we get a structure as in the conclusion of axiom TR4.
\end{proof}

\begin{proposition}
\label{proposition-homotopy-category-triangulated}
Let $\mathcal{A}$ be an additive category.
The category $K(\mathcal{A})$ of complexes up to
homotopy with its natural translation functors
and distinguished triangles as defined above
is a triangulated category.
\end{proposition}

\begin{proof}
Proof of TR1. By definition every triangle isomorphic to a distinguished
one is distinguished. Also, any triangle $(A^\bullet, A^\bullet, 0, 1, 0, 0)$
is distinguished since $0 \to A^\bullet \to A^\bullet \to 0 \to 0$ is
a termwise split sequence of complexes. Finally, given any morphism of
complexes $f : K^\bullet \to L^\bullet$ the triangle
$(K, L, C(f), f, i, -p)$ is distinguished by
Lemma \ref{lemma-the-same-up-to-isomorphisms}.

\medskip\noindent
Proof of TR2. Let $(X, Y, Z, f, g, h)$ be a triangle.
Assume $(Y, Z, X[1], g, h, -f[1])$ is distinguished.
Then there exists a termwise split sequence of complexes
$A^\bullet \to B^\bullet \to C^\bullet$ such that the associated
triangle $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
is isomorphic to $(Y, Z, X[1], g, h, -f[1])$. Rotating back we see
that $(X, Y, Z, f, g, h)$ is isomorphic to
$(C^\bullet[-1], A^\bullet, B^\bullet, -\delta[-1], \alpha, \beta)$.
It follows from Lemma \ref{lemma-rotate-triangle} that the triangle
$(C^\bullet[-1], A^\bullet, B^\bullet, \delta[-1], \alpha, \beta)$
is isomorphic to
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, p)$.
Precomposing the previous isomorphism of triangles with $-1$ on $Y$
it follows that $(X, Y, Z, f, g, h)$ is isomorphic to
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, -p)$.
Hence it is distinguished by
Lemma \ref{lemma-the-same-up-to-isomorphisms}.
On the other hand, suppose that $(X, Y, Z, f, g, h)$ is distinguished.
By Lemma \ref{lemma-the-same-up-to-isomorphisms} this means that it is
isomorphic to a triangle of the form
$(K^\bullet, L^\bullet, C(f), f, i, -p)$ for some morphism of
complexes $f$. Then the rotated triangle $(Y, Z, X[1], g, h, -f[1])$ is
isomorphic to $(L^\bullet, C(f), K^\bullet[1], i, -p, -f[1])$ which is
isomorphic to the triangle $(L^\bullet, C(f), K^\bullet[1], i, p, f[1])$.
By Lemma \ref{lemma-rotate-cone} this triangle is distinguished.
Hence $(Y, Z, X[1], g, h, -f[1])$ is distinguished as desired.

\medskip\noindent
Proof of TR3. Let
$(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$
be distinguished triangles of $K(\mathcal{A})$
and let $a : X \to X'$ and $b : Y \to Y'$ be morphisms
such that $f' \circ a = b \circ f$. By Lemma \ref{lemma-functorial-cone}
we may assume that
$(X, Y, Z, f, g, h) = (X, Y, C(f), f, i, p)$ and
$(X', Y', Z', f', g', h') = (X', Y', C(f'), f', i', p')$.
At this point we simply apply Lemma \ref{lemma-functorial-cone}
to the commutative diagram given by $f, f', a, b$.

\medskip\noindent
Proof of TR4. At this point we know that $K(\mathcal{A})$
is a pre-triangulated category. Hence we can use
Lemma \ref{lemma-easier-axiom-four}. Let $A^\bullet \to B^\bullet$
and $B^\bullet \to C^\bullet$ be composable morphisms of
$K(\mathcal{A})$. By Lemma \ref{lemma-sequence-maps-split} we may assume that
$A^\bullet \to B^\bullet$ and $B^\bullet \to C^\bullet$
are split injective morphisms. In this case the result follows
from Lemma \ref{lemma-two-split-injections}.
\end{proof}

\begin{remark}
\label{remark-boundedness-conditions-triangulated}
Let $\mathcal{A}$ be an additive category.
Exactly the same proof as the proof of
Proposition \ref{proposition-homotopy-category-triangulated}
shows that the categories
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
are triangulated categories. Namely, the cone of a morphisms between
bounded (above, below) is bounded (above, below).
But we prove below that these are triangulated subcategories
of $K(\mathcal{A})$ which gives another proof.
\end{remark}

\begin{lemma}
\label{lemma-bounded-triangulated-subcategories}
Let $\mathcal{A}$ be an additive subcategory. The categories
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
are full triangulated subcategories of $K(\mathcal{A})$.
\end{lemma}

\begin{proof}
Each of the categories mentioned is a full additive subcategory.
We use the criterion of 
Lemma \ref{lemma-triangulated-subcategory}
to show that they are triangulated subcategories.
It is clear that each of the categories 
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
is preserved under the shift functors $[1], [-1]$.
Finally, suppose that $f : A^\bullet \to B^\bullet$ is a morphism
in $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$.
Then $(A^\bullet, B^\bullet, C(f)^\bullet, f, i, -p)$ is a distinguished
triangle of $K(\mathcal{A})$ with $C(f)^\bullet \in K^{+}(\mathcal{A})$,
$K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$ as is clear from the construction
of the cone. Thus the lemma is proved. (Alternatively,
$K^\bullet \to L^\bullet$ is isomorphic to an termwise split injection
of complexes in $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or
$K^b(\mathcal{A})$, see
Lemma \ref{lemma-make-injective}
and then one can directly take the associated
distinguished triangle.)
\end{proof}





\section{Derived categories}
\label{section-derived-categories}

\noindent
In this section we construct the derived category of an abelian category
$\mathcal{A}$ by inverting the quasi-isomorphisms in $K(\mathcal{A})$.
Before we do this recall that the functors
$H^i : \text{Comp}(\mathcal{A}) \to \mathcal{A}$
factor through $K(\mathcal{A})$, see
Homology, Lemma \ref{homology-lemma-map-cohomology-homotopy-cochain}.
Moreover, in
Homology, Definition \ref{homology-definition-comology-shift}
we have defined identifications $H^i(K^\bullet[n]) = H^{i + n}(K^\bullet)$.
At this point it makes sense to redefine
$$
H^i(K^\bullet) = H^0(K^\bullet[i])
$$
in order to avoid confusion and possible sign errors.

\begin{lemma}
\label{lemma-cohomology-homological}
Let $\mathcal{A}$ be an abelian category. The functor
$$
H^0 : K(\mathcal{A}) \longrightarrow \mathcal{A}
$$
is homological.
\end{lemma}

\begin{proof}
Because $H^0$ is a functor, and by our definition of distinguished triangles
it suffices to prove that given a termwise split short exact sequence
of complexes $0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
the sequence $H^0(A^\bullet) \to H^0(B^\bullet) \to H^0(C^\bullet)$
is exact. This follows from
Homology, Lemma \ref{homology-lemma-long-exact-sequence-cochain}.
\end{proof}

\noindent
In particular, this lemma implies that a distinguished triangle
$(X, Y, Z, f, g, h)$ in $K(\mathcal{A})$ gives rise to a long exact
cohomology sequence
$$
\xymatrix{
\ldots \ar[r] &
H^i(X) \ar[r]^{H^i(f)} &
H^i(Y) \ar[r]^{H^i(g)} &
H^i(Z) \ar[r]^{H^i(h)} &
H^{i + 1}(X) \ar[r] & \ldots
}
$$
see (\ref{equation-long-exact-cohomology-sequence}). Moreover, there is
a compatibility with the long exact sequence of cohomology associated to
a short exact sequence of complexes (insert future reference here). For
example, if $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
is the distinguished triangle associated to a termwise split exact
sequence of complexes (see
Definition \ref{definition-split-ses}),
then the cohomology sequence above agrees with the one defined using the
snake lemma, see
Homology, Lemma \ref{homology-lemma-long-exact-sequence-cochain}
and for agreement of sequences, see
Homology, Lemma \ref{homology-lemma-ses-termwise-split-long-cochain}.

\medskip\noindent
Recall that a complex $K^\bullet$ is {\it acyclic} if $H^i(K^\bullet) = 0$
for all $i \in \mathbf{Z}$. Moreover, recall that a morphism of complexes
$f : K^\bullet \to L^\bullet$ is a {\it quasi-isomorphism} if and only if
$H^i(f)$ is an isomorphism for all $i$. See
Homology, Definition \ref{homology-definition-quasi-isomorphism-cochain}.

\begin{lemma}
\label{lemma-acyclic}
Let $\mathcal{A}$ be an abelian category. The full subcategory
$\text{Ac}(\mathcal{A})$ of $K(\mathcal{A})$ consisting of acyclic complexes
is a strictly full saturated triangulated subcategory of $K(\mathcal{A})$.
The corresponding saturated multiplicative system (see
Lemma \ref{lemma-operations})
of $K(\mathcal{A})$ is the set $\text{Qis}(\mathcal{A})$
of quasi-isomorphisms.
\end{lemma}

\begin{proof}
We know that $H^0$ is a homological functor by
Lemma \ref{lemma-cohomology-homological}.
Thus this lemma is a special case of
Lemma \ref{lemma-acyclic-general}.
\end{proof}

\begin{definition}
\label{definition}
Let $\mathcal{A}$ be an abelian category.
Let $\text{Ac}(\mathcal{A})$ and $\text{Qis}(\mathcal{A})$
be as in
Lemma \ref{lemma-acyclic}.
The {\it derived category of $\mathcal{A}$} is the triangulated
category
$$
D(\mathcal{A}) =
K(\mathcal{A})/\text{Ac}(\mathcal{A}) =
\text{Qis}(\mathcal{A})^{-1} K(\mathcal{A}).
$$
\end{definition}






\section{Injective resolutions}
\label{section-injective-resolutions}

\noindent
In this section we prove some lemmas regarding the existence
of injective resolutions in abelian categories having enough injectives.

\medskip\noindent
Given an object $A$ of an abelian category $\mathcal{A}$ we get a complex
$$
A[0] = ( \ldots \to 0 \to A \to 0 \to \ldots )
$$
where $A$ is placed in degree zero. Hence a natural functor
$\mathcal{A} \to \text{Comp}(\mathcal{A})$, $A \mapsto A[0]$.

\begin{definition}
\label{definition-injective-resolution}
Let $\mathcal{A}$ be an abelian category.
Let $A \in \text{Ob}(\mathcal{A})$.
An {\it injective resolution of $A$} is a complex
$I^\bullet$ together with a map $A \to I^0$ such
that:
\begin{enumerate}
\item We have $I^n = 0$ for $n < 0$.
\item Each $I^n$ is an injective object of $\mathcal{A}$.
\item The map $A \to I^0$ is an isomorphism onto $\text{Ker}(d^0)$.
\item We have $H^i(I^\bullet) = 0$ for $i > 0$.
\end{enumerate}
Hence $A[0] \to I^\bullet$ is a quasi-isomorphism.
In other words the complex
$$
\ldots \to 0 \to A \to I^0 \to I^1 \to \ldots
$$
is acyclic.
Let $K^\bullet$ be a complex in $\mathcal{A}$.
An {\it injective resolution of $K^\bullet$} is a complex
$I^\bullet$ together with a map $\alpha : K^\bullet \to I^\bullet$
of complexes such that
\begin{enumerate}
\item We have $I^n = 0$ for $n \ll 0$, i.e., $I^\bullet$ is bounded below.
\item Each $I^n$ is an injective object of $\mathcal{A}$.
\item The map $\alpha : K^\bullet \to I^\bullet$ is a
quasi-isomorphism.
\end{enumerate}
\end{definition}

\noindent
In other words an injective resolution $K^\bullet \to I^\bullet$
gives rise to a diagram
$$
\xymatrix{
\ldots \ar[r] & K^{n - 1} \ar[d] \ar[r] & K^n \ar[d] \ar[r] &
K^{n + 1} \ar[d] \ar[r] & \ldots \\
\ldots \ar[r] & I^{n - 1} \ar[r] & I^n \ar[r] & I^{n + 1} \ar[r] & \ldots
}
$$
which induces an isomorphism on cohomology objects in each degree.
An injective resolution of an object $A$ of $\mathcal{A}$
is almost the same thing as an injective resolution of
the complex $A[0]$.

\begin{lemma}
\label{lemma-cohomology-bounded-below}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a complex of $\mathcal{A}$.
\begin{enumerate}
\item If $K^\bullet$ has an injective resolution then
$H^n(K^\bullet) = 0$ for $n \ll 0$.
\item If $H^n(K^\bullet) = 0$ for all $n \ll 0$ then there
exists a quasi-isomorphism $K^\bullet \to L^\bullet$
with $L^\bullet$ bounded below.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted. For the second statement use
$L^\bullet = K^\bullet / \tau_{\leq n}K^\bullet$ for
some $n \ll 0$. See
Homology, Section \ref{homology-section-truncations}
for the definition of the truncation $\tau_{\leq n}$.
\end{proof}

\begin{lemma}
\label{lemma-injective-resolutions-exist}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
\begin{enumerate}
\item Any object of $\mathcal{A}$ has an injective resolution.
\item If $H^n(K^\bullet) = 0$ for all $n \ll 0$ then
$K^\bullet$ has an injective resolution.
\item If $K^\bullet$ is bounded below then there exists
an injective resolution $\alpha : K^\bullet \to I^\bullet$
such that each $\alpha^n : K^n \to I^n$ is injective.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). First choose an injection $A \to I^0$ of $A$ into an
injective object of $\mathcal{A}$. Next, choose an injection
$I_0/A \to I^1$ into an injective object of $\mathcal{A}$.
Denote $d^0$ the induced map $I^0 \to I^1$.
Next, choose an injection $I^1/\text{Im}(d^0) \to I^2$ into
an injective object of $\mathcal{A}$. Denote $d^1$ the induced
map $I^1 \to I^2$. And so on.

\medskip\noindent
By Lemma \ref{lemma-cohomology-bounded-below} part (2) follows from part (3).

\medskip\noindent
Proof of (3). Consider the following induction hypothesis
$IH_n$: There are $I^j$, $j \leq n$ injective objects almost
all zero, maps $d^j : I^j \to I^{j + 1}$ for $j < n$
and injective maps $\alpha^j : K^j \to I^j$ for $j \leq n$
such that the diagram
$$
\xymatrix{
\ldots \ar[r] & K^{n - 1} \ar[d]^\alpha \ar[r] &
K^n \ar[d]^\alpha \ar[r] &
K^{n + 1} \ar[r] & \ldots \\
\ldots \ar[r] & I^{n - 1} \ar[r] & I^n &  &
}
$$
is commutative, such that $d^j \circ d^{j - 1} = 0$ for $j < n$
and such that $\alpha$ induces isomorphisms
$H^j(K^\bullet) \to \text{Ker}(d^j)/\text{Im}(d^{j - 1})$
for $j < n$. Note that this implies
\begin{equation}
\label{equation-star}
\alpha(\text{Im}(d^{n - 1}))
\subset
\alpha(\text{Ker}(d^n)) \cap d^{n - 1}(I^{n - 1})
\end{equation}
and
\begin{equation}
\label{equation-star-star}
\alpha(\text{Im}(d^{n - 1}))
\subset
\alpha(K^n) \cap d^{n - 1}(I^{n - 1}).
\end{equation}
If these inclusions are not equalities, then choose an injection
$K^n/\text{Im}(d^{n - 1}) \to I$ into an injective object $I$.
Denote $\alpha' : K^n \to I$ the induced map.
Replace $I^n$ by $\tilde I^n = I^n \oplus I$. Use the
map $(d^{n - 1}, 0) : I^{n - 1} \to I^n \oplus I$ and use
the map $(\alpha^n , \alpha') : K^n \to I^n \oplus I$.
It is easy to see that after these replacements we have
equality in Equations (\ref{equation-star}) and (\ref{equation-star-star}).
Once this is the
case consider the diagram
$$
\xymatrix{
K^n/\text{Ker}(d^n) \ar[r] \ar[d] & K^{n + 1} \\
I^n/(d^{n - 1}(L^{n - 1}) + \alpha(\text{Ker}(d^n))) &
}
$$
Both the horizontal and the vertical arrows are injective.
Hence the push-out $M$ of this diagram contains both
$K^{n + 1}$ and $I^n/(d^{n - 1}(L^{n - 1}) + \alpha(\text{Ker}(d^n)))$
as subobjects. Choose an injection $M \to I^{n + 1}$.
By construction we get $d^n : I^n \to I^{n + 1}$
and an injective map $\alpha^{n + 1} : K^{n + 1} \to I^{n + 1}$.
The equality in Equation (\ref{equation-star}) and the construction of
$d^{n + 1}$ garantee that $\alpha : H^n(K^\bullet) \to
\text{Ker}(d^n)/\text{Im}(d^{n - 1})$ is an isomorphism.
In other words $IH_{n + 1}$ holds.

\medskip\noindent
We finish the proof of (3) by the following observations.
First we note that $IH_n$ is true for all $n << 0$ since
we can just take $I_j = 0$ for $j \leq n$ in this case.
Next, we note that in the proof of $IH_n \Rightarrow IH_{n + 1}$
we only modified the object $I^n$, the map $d^{n - 1}$ and
the map $\alpha^n$. Hence we see that proceding by induction
we produce a definite complex $I^\bullet$ which is bounded below
and consists of injective objects, and a termwise
injective quasi-isomorphism $\alpha : K^\bullet \to I^\bullet$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-lift}
Let $\mathcal{A}$ be an abelian category.
Consider a solid diagram
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_\gamma & L^\bullet \ar@{-->}[dl]^\beta \\
I^\bullet
}
$$
where $I^\bullet$ is bounded below and consists of injective
objects, and $\alpha$ is a quasi-isomorphism.
\begin{enumerate}
\item There exists a map of complexes $\beta$ making the diagram
commute up to homotopy.
\item If $\alpha$ is injective in every degree
then we can find a $\beta$ which makes the diagram commute.
\end{enumerate}
\end{lemma}

\begin{proof}
We first show that (2) implies (1). Namely, let
$\tilde \alpha : K \to \tilde L^\bullet$, $\pi$, $s$ be as in
Lemma \ref{lemma-make-injective}. Since $\tilde \alpha$ is injective
by (2) there exists a morphism $\tilde \beta : \tilde L^\bullet \to I^\bullet$
such that $\gamma = \tilde \beta \circ \tilde \alpha$. Set
$\beta = \tilde \beta \circ s$. Then we have
$$
\beta \circ \alpha
=
\tilde \beta \circ s \circ \pi \circ \tilde \alpha
\sim
\tilde \beta \circ \tilde \alpha
=
\gamma
$$
as desired.

\medskip\noindent
Assume that $\alpha : K^\bullet \to L^\bullet$ is injective.
Suppose we have already defined $\beta$ in all degrees
$\leq n - 1$ compatible with differentials and such that
$\gamma^j = \beta^j \circ \alpha^j$ for all $j \leq n - 1$.
Consider the commutative solid diagram
$$
\xymatrix{
K^{n - 1} \ar[r] \ar@/_2pc/[dd]_\gamma \ar[d]^\alpha &
K^n \ar@/^2pc/[dd]^\gamma \ar[d]^\alpha \\
L^{n - 1} \ar[r] \ar[d]^\beta &
L^n \ar@{-->}[d] \\
I^{n - 1} \ar[r] &
I^n
}
$$
Thus we see that the dotted arrow is prescribed on the subobjects
$\alpha(K^n)$ and $d^{n - 1}(L^{n - 1})$. Moreover, these two arrows
agree on $\alpha(d^{n - 1}(K^{n - 1}))$. Hence if
\begin{equation}
\label{equation-qis}
\alpha(d^{n - 1}(K^{n - 1}))
=
\alpha(K^n) \cap d^{n - 1}(L^{n - 1})
\end{equation}
then these morphisms glue to a morphism
$\alpha(K^n) + d^{n - 1}(L^{n - 1}) \to I^n$ and, using the injectivity
of $I^n$, we can extend this to a morphism from all of $L^n$ into $I^n$.
After this by induction we get the morphism $\beta$ for all $n$ simlutaneously
(note that we can set $\beta^n = 0$ for all $n \ll 0$ since $I^\bullet$
is bounded below -- in this way starting the induction).

\medskip\noindent
It remains to prove the equality (\ref{equation-qis}).
The reader is encouraged to argue this for themselves with a suitable
diagram chase. Nonetheless here is our argument.
Note that the inclusion
$\alpha(d^{n - 1}(K^{n - 1})) \subset \alpha(K^n) \cap d^{n - 1}(L^{n - 1})$
is obvious. Take an object $T$ of $\mathcal{A}$ and a morphism
$x : T \to L^n$ whose image is contained in the subobject
$\alpha(K^n) \cap d^{n - 1}(L^{n - 1})$.
Since $\alpha$ is injective we see that $x = \alpha \circ x'$ for
some $x' : T \to K^n$. Moreover, since $x$ lies in $d^{n - 1}(L^{n - 1})$
we see that $d^n \circ x = 0$. Hence using injectivity of $\alpha$ again
we see that $d^n \circ x' = 0$. Thus $x'$ gives a morphism
$[x'] : T \to H^n(K^\bullet)$. On the other hand the corresponding
map $[x] : T \to H^n(L^\bullet)$ induced by $x$ is zero by assumption.
Since $\alpha$ is a quasi-isomorphism we conclude that $[x'] = 0$.
This of course means exactly that the image of $x'$ is
contained in $d^{n - 1}(K^{n - 1})$ and we win.
\end{proof}

\begin{lemma}
\label{lemma-acyclic-is-zero}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be an acyclic complex.
Let $I^\bullet$ be bounded below and consisting of injective objects.
Any morphism $K^\bullet \to I^\bullet$ is homotopic to zero.
\end{lemma}

\begin{proof}
Let $\alpha : K^\bullet \to I^\bullet$ be a morphism of
complexes. Assume that $\alpha^j = 0$ for $j < n$.
We will show that there exists a morphism $h : K^{n + 1} \to I^n$
such that $\alpha^n = h \circ d$. Thus $\alpha$ will be homotopic
to the morphism of complexes $\beta$ defined by
$$
\beta^j =
\left\{
\begin{matrix}
0 & \text{if} & j \leq n \\
\alpha^{n + 1} - d \circ h & \text{if} & j = n + 1 \\
\alpha^j & \text{if} & j > n + 1
\end{matrix}
\right.
$$
This will clearly prove the lemma (by induction).
To prove the existence of $h$ note that
$\alpha^n|_{d^{n - 1}(K^{n - 1})} = 0$ since
$\alpha^{n - 1} = 0$. Since $K^\bullet$ is acyclic we
have $d^{n - 1}(K^{n - 1}) = \text{Ker}(K^n \to K^{n + 1})$.
Hence we can think of $\alpha^n$ as a map into $I^n$ defined
on the subobject $\text{Im}(K^n \to K^{n + 1})$ of $K^{n + 1}$.
By injectivity of the object $I^n$ we can extend this to
a map $h : K^{n + 1} \to I^n$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-equal-up-to-homotopy}
Let $\mathcal{A}$ be an abelian category.
Consider a solid diagram
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_\gamma & L^\bullet \ar@{-->}[dl]^{\beta_i} \\
I^\bullet
}
$$
where $I^\bullet$ is bounded below and consists of injective
objects, and $\alpha$ is a quasi-isomorphism.
Any two morphisms $\beta_1, \beta_2$ making the diagram commute
up to homotopy are homotopic.
\end{lemma}

\begin{proof}
Let $\tilde \alpha : K \to \tilde L^\bullet$, $\pi$, $s$ be as in
Lemma \ref{lemma-make-injective}. If we can show that $\beta_1 \circ\pi$
is homotopic to $\beta_2 \circ \pi$, then we deduce that
$\beta_1 \sim \beta_2$ because $\pi \circ s$ is the identity.
Hence we may assume $\alpha^n : K^n \to L^n$ is the
inclusion of a direct summand for all $n$. Thus we get a
short exact sequence of complexes
$$
0 \to K^\bullet \to L^\bullet \to M^\bullet \to 0
$$
which is termwise split and such that $M^\bullet$ is acyclic.
We choose splittings $L^n = K^n \oplus M^n$, so we have
$\beta_i^n : K^n \oplus M^n \to I^n$ and $\gamma^n : K^n \to I^n$.
In this case the condition on $\beta_i$ is that there are morphisms
$h_i^n : K^n \to I^{n - 1}$ such that
$$
\gamma^n - \beta_i^n|_{K^n} = d \circ h_i^n + h_i^{n + 1} \circ d
$$
Thus we see that
$$
\beta_1^n|_{K^n} - \beta_2^n|_{K^n}
=
d \circ (h_1^n - h_2^n) + (h_1^{n + 1} - h_2^{n + 1}) \circ d
$$
Consider the map $h^n : K^n \oplus M^n \to I^{n - 1}$ which
equals $h_1^n - h_2^n$ on the first summand and zero on the second.
Then we see that
$$
\beta_1^n - \beta_2^n
-
(d \circ h^n + h^{n + 1}) \circ d)
$$
is a morphism of complexes $L^\bullet \to I^\bullet$
which is identically zero on the subcomplex $K^\bullet$.
Hence it factors as $L^\bullet \to M^\bullet \to I^\bullet$.
Thus the result of the lemma follows from Lemma \ref{lemma-acyclic-is-zero}.
\end{proof}

\begin{lemma}
\label{lemma-injective-resolution-ses}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
For any short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
of $\text{Comp}^{+}(\mathcal{A})$ there exists a
commutative diagram in $\text{Comp}^{+}(\mathcal{A})$
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I_1^\bullet \ar[r] &
I_2^\bullet \ar[r] &
I_3^\bullet \ar[r] &
0
}
$$
where the vertical arrows are injective resolutions and
the rows are short exact sequences of complexes.
In fact, given any quasi-isomorphism $A^\bullet \to I^\bullet$
we may assume $I_1^\bullet = I^\bullet$.
\end{lemma}

\begin{proof}
Step 1. Choose an injective resolution $A^\bullet \to I^\bullet$ (see
Lemma \ref{lemma-injective-resolutions-exist}) or use the given one.
Recall that $\text{Comp}^{+}(\mathcal{A})$ is an
abelian category, see
Homology, Lemma \ref{homology-lemma-cat-cochain-abelian}.
Hence we may form the pushout along
the injective map $A^\bullet \to I^\bullet$ to get
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I^\bullet \ar[r] &
E^\bullet \ar[r] &
C^\bullet \ar[r] &
0
}
$$
Note that the lower short exact sequence is termwise split, see
Homology, Lemma \ref{homology-lemma-characterize-injectives}.
Hence it suffices to prove the lemma when
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$ is
termwise split.

\medskip\noindent
Step 2. Choose splittings. In other words, write
$B^n = A^n \oplus C^n$. Denote $\delta : C^\bullet \to A^\bullet[1]$
the morphism as in
Homology, Lemma \ref{homology-lemma-ses-termwise-split-cochain}.
Choose injective resolutions $f_1 : A^\bullet \to I_1^\bullet$
and $f_3 : C^\bullet \to I_3^\bullet$. (If $A^\bullet$ is a complex of
injectives, then use $I_1^\bullet = A^\bullet$.)
We may assume $f_3$ is injective in
every degree. By Lemma \ref{lemma-morphisms-lift} we may find
a morphism $\delta' : I_3^\bullet \to I_1^\bullet[1]$ such
that $\delta' \circ f_3 = f_1[1] \circ \delta$ (equality of
morphisms of complexes). Set $I_2^n = I_1^n \oplus I_3^n$.
Define
$$
d_{I_2}^n =
\left(
\begin{matrix}
d_{I_1}^n & (\delta')^n \\
0 & d_{I_3}^n
\end{matrix}
\right)
$$
and define the maps $B^n \to I_2^n$ to be given as the
sum of the maps $A^n \to I_1^n$ and $C^n \to I_3^n$.
Everything is clear.
\end{proof}




\section{Injective resolutions: derived category}
\label{section-derived-category}

\noindent
The above material suggests the following definition.

\begin{definition}
\label{definition-derived-category}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
The {\it derived category (bounded below version)} of $\mathcal{A}$
is the category $D^{+}(\mathcal{A})$ whose
\begin{enumerate}
\item objects are bounded below complexes of injectives, and
\item morphisms are morphisms of complexes up to homotopy.
\end{enumerate}
\end{definition}

\noindent
There is another construction of the derived category which is
more general. Namely $\mathcal{A}$ can be an arbitrary abelian
category. The idea is that one takes the category
$K^{+}(\mathcal{A})$, see Definition \ref{definition-complexes-notation},
and inverts all quasi-isomorphisms. This can be done for the category
$K(\mathcal{A})$ of
unbounded complexes as well. This we will discuss elsewhere
(insert future reference here). It is true that the constructions
agree, i.e., give equivalent categories, when $\mathcal{A}$ has enough
injectives, see (insert future reference here).
Moreover, the derived category (with either construction) comes equipped
with the additional structure of a triangulated category,
see Section \ref{section-triangulated-categories} for the definition.
For the category $D^{+}(\mathcal{A})$ we define this structure in
Section \ref{section-derived-triangulated}.

\medskip\noindent
To formulate some first properties of the derived category we remark that
since homotopic maps induce the same maps on cohomology there is a
sequence of functors
$$
H^n : K(\mathcal{A}) \longrightarrow \mathcal{A}
$$
Moreover, we have defined the derived category
$D^{+}(\mathcal{A})$ as a full subcategory
of $K^{+}(\mathcal{A}) \subset K(\mathcal{A})$. Hence we also get functors
$$
H^n : D^{+}(\mathcal{A}) \longrightarrow \mathcal{A}
$$
by restricting the above $H^n$.

\begin{definition}
\label{definition-localization-functor}
Let $\mathcal{A}$ be an abelian category with enough injectives.
A {\it localization functor}\footnote{This is likely nonstandard terminology.}
is a functor
$$
j : K^{+}(\mathcal{A}) \longrightarrow D^{+}(\mathcal{A})
$$
and for every $K^\bullet \in \text{Ob}(K^{+}(\mathcal{A}))$ a
morphism of complexes $i_K : K^\bullet \to j(K^\bullet)$
with the following properties:
\begin{enumerate}
\item For every $K^\bullet$ the morphism $i_K : K^\bullet \to j(K^\bullet)$
is a quasi-isomorphism.
\item For every morphism $\alpha : K^\bullet \to L^\bullet$ of
$K^{+}(\mathcal{A})$ we have $j(\alpha) \circ i_K = i_L \circ \alpha$.
\item There are canonical isomorphisms $H^n \circ j = H^n$.
\item Given a morphism of complexes $\alpha : K^\bullet \to L^\bullet$
then $j(\alpha)$ is invertible if and only if $\alpha$ is a
quasi-isomorphism.
\item For any $K^\bullet$ we have $j(K^\bullet) \cong 0$ if and only
if $K^\bullet$ is acyclic.
\end{enumerate}
\end{definition}

\noindent
The conditions above are not logically independent.

\begin{lemma}
\label{lemma-into-derived-category}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
Then a localization functor $j$ exists and is 
unique up to unique isomorphism of functors.
\end{lemma}

\begin{proof}
Consider the set of all objects $K^\bullet$ of $K^{+}(\mathcal{A})$.
(Recall that by our conventions any category has a set of
objects unless mentioned otherwise.)
By Lemma \ref{lemma-injective-resolutions-exist} every object
has an injective resolution.
By the axiom of choice we can choose for each $K^\bullet$
an injective resolution $i_K : K^\bullet \to j(K^\bullet)$.

\medskip\noindent
Next, consider the set of all morphisms
$\alpha : K^\bullet \to L^\bullet$
of $K^{+}(\mathcal{A})$ (we represent each one by a
particular choice of representative).
For each of these consider the diagram
$$
\xymatrix{
K^\bullet \ar[d] \ar[r]_\alpha & L^\bullet \ar[d] \\
j(K^\bullet) \ar@{-->}[r] & j(L^\bullet)
}
$$
By Lemma \ref{lemma-morphisms-lift} there exists a dotted arrow
making the diagram commute up to homotopy (i.e., commute in
$K^{+}(\mathcal{A})$). We choose one (using the axiom of choice)
and denote it
$j(\alpha) : j(K^\bullet) \to j(L^\bullet)$.

\medskip\noindent
To verify that $j$ is a functor we have to show that
$j(\beta) \circ j(\alpha) = j(\beta \circ \alpha)$
whenever given morphisms $\alpha : K^\bullet \to L^\bullet$
and $\beta : L^\bullet \to M^\bullet$ in $K^{+}(\mathcal{A})$.
For this note that both
$j(\beta) \circ j(\alpha)$ and $j(\beta \circ \alpha)$
make the following diagram commute up
to homotopy
$$
\xymatrix{
K^\bullet \ar[d] \ar[r]_{\beta \circ \alpha} & M^\bullet \ar[d] \\
j(K^\bullet) \ar[r] & j(M^\bullet)
}
$$
Hence it follows from Lemma \ref{lemma-morphisms-equal-up-to-homotopy}
that they are equal up
to homotopy, i.e., equal as morphisms in $D^{+}(\mathcal{A})$.

\medskip\noindent
Properties (1), (2) hold by construction.
The isomorphism $H^n = H^n \circ j$ comes from the
quasi-isomorphisms $K^\bullet \to j(K^\bullet)$ which
are compatible with morphisms. Also, part (5) follows from part (4).

\medskip\noindent
Let us prove (4). It is clear that if $j(\alpha)$ is invertible,
then $\alpha$ is a quasi-isomorphism, by property (3).
Suppose that $\alpha$ is a quasi-isomorphism. Then we apply
Lemma \ref{lemma-morphisms-lift} to get the dotted arrow
in the following diagram
$$
\xymatrix{
K^\bullet \ar[d] \ar[r]_\alpha & L^\bullet \ar[d] \\
j(K^\bullet) & j(L^\bullet) \ar@{-->}[l]
}
$$
and we use Lemma \ref{lemma-morphisms-equal-up-to-homotopy} to see that
it is an inverse to
$j(\alpha)$. This finishes the proof of the lemma.
\end{proof}

\begin{remark}
\label{remark-big-localization}
Suppose that $\mathcal{A}$ is a ``big'' abelian category with enough injectives
such as the category of abelian groups. In this case we have to be slightly
more carefull in constructing our localization functor since we cannot use
the axiom of choice with a quantifier ranging over a class. But note that
the proof of the lemma does show that any two localization functors are
canonically isomorphic. Namely, given quasi-isomorphisms
$i : K^\bullet \to I^\bullet$ and $i' : K^\bullet \to J^\bullet$ of
a bounded below complex $K^\bullet$ into bounded below complexes of injectives
there exists a unique(!) morphism $a : I^\bullet \to J^\bullet$
in $D^{+}(\mathcal{A})$ such that $i' = i \circ a$ as morphisms in
$D^{+}(\mathcal{A})$. Hence the only issue is existence, and we will see how
to deal with this in the next section.
\end{remark}

\begin{remark}
\label{remark-failure}
Allthough the derived category $D^{+}(\mathcal{A})$ is an additive category,
it is not an abelian category itself (in most cases). It does have a zero
object but no kernels and cokernels in general. Hence it not possible to define
the notion of a short exact sequence in $D^{+}(\mathcal{A})$. The solution to
this conundrum is to add additional structure to the category
$D^{+}(\mathcal{A})$, namely a set of ``distinguished triangles''.
See Definition \ref{definition-derived-triangulated} below.
The result is the notion of a triangulated category which is an
additive category, endowed with translation functors $[n]$
and a set of triangles subject to a list of axioms.
See \cite{Verdier} and Section \ref{section-triangulated-categories}.
One reason for introducing trianglulated categories is to be able to speak
about exact functors between derived categories (especially derived
functors).
\end{remark}






\section{Injective resolutions: triangles}
\label{section-derived-triangulated}

\noindent
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
Denote $\mathcal{I} \subset \mathcal{A}$ the full subcategory consisting
of all injective objects of $\mathcal{A}$. Note that $\mathcal{I}$
is an additive category. Hence the derived category
$D^{+}(\mathcal{A}) = K^{+}(\mathcal{I})$ is the
homotopy category of bounded below complexes in an additive category.
Thus Definition \ref{definition-distinguished-triangle}
gives a notion of a distinguished triangle. By
Proposition \ref{proposition-homotopy-category-triangulated}
we see $D^{+}(\mathcal{A})$ a triangulated category.
Note that any short exact sequence
$0 \to I^\bullet \to B^\bullet \to C^\bullet \to 0$
of complexes of $\mathcal{A}$ with $I^\bullet$ a complex of injectives
is termwise split (see
Homology, Lemma \ref{homology-lemma-characterize-injectives}).

\begin{definition}
\label{definition-derived-triangulated}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
The structure of a triangulated category on
the derived category $D^{+}(\mathcal{A})$ is the one where
a {\it distinguished triangle in the derived category}
$D^{+}(\mathcal{A})$ is any triangle of $D^{+}(\mathcal{A})$
isomorphic to the triangle associated to a short exact sequence
of complexes of injectives (see Definition \ref{definition-split-ses}).
\end{definition}

\noindent
This makes sense by the discussion above.
Next we would like to show that a resolution
functor $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
is compatible with the given structures of triangulated
categories.

\begin{lemma}
\label{lemma-j-is-exact}
Let $\mathcal{A}$ be an abelian category.
Any localization functor
$j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
(see Definition \ref{definition-localization-functor})
is exact.
\end{lemma}

\begin{proof}
Denote $i_{K^\bullet} : K^\bullet \to j(K^\bullet)$ the
canonical maps of Definition \ref{definition-localization-functor}.
First we discuss the existence of the functorial isomorphism
$j(K^\bullet[1]) \to j(K^\bullet)[1]$.
Consider the diagram
$$
\xymatrix{
K^\bullet[1] \ar[d]^{i_{K^\bullet[1]}} \ar@{=}[r] &
K^\bullet[1] \ar[d]^{i_{K^\bullet}[1]} \\
j(K^\bullet[1]) \ar@{-->}[r] & j(K^\bullet)[1]
}
$$
By Lemmas \ref{lemma-morphisms-lift}
and \ref{lemma-morphisms-equal-up-to-homotopy}
there exists a unique dotted arrow in $D^{+}(\mathcal{A})$
making the diagram commute in $K^{+}(\mathcal{A})$.
We omit the verification that this gives a functorial isomorphism.
(Hint: use Lemma \ref{lemma-morphisms-equal-up-to-homotopy} again.)

\medskip\noindent
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle of $K^{+}(\mathcal{A})$.
We have to show that $(j(X), j(Y), j(Z), j(f), j(g), j(h))$ is
a distinguished triangle of $D^{+}(\mathcal{A})$. To see this, since
$j$ is a functor, we may replace $(X, Y, Z, f, g, h)$ by any triangle
isomorphic to it and prove it for that triangle. Hence we may and do
assume that $(X, Y, Z, f, g, h)$ is the distinguished triangle
associated to a termwise split sequence of complexes
$$
0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0.
$$
Choose splittings $(s^n, \pi^n)$ and denote
$\delta : C^\bullet \to A^\bullet[1]$ the associated
morphism. Set
$$
J^n = j(A)^n \oplus j(C)^n
$$
and define a differential by the matrix
$$
d_J^n =
\left(
\begin{matrix}
d_{I_1}^n & j(\delta)^n \\
0 & d_{I_2}^n
\end{matrix}
\right).
\text{ Also, note that: }
d_B^n =
\left(
\begin{matrix}
d_{A}^n & \delta^n \\
0 & d_{B}^n
\end{matrix}
\right)
$$
Thus we get a morphism of termwise split
sequences of complexes
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r]_\alpha \ar[d] &
B^\bullet \ar[r]_\beta \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
j(A^\bullet) \ar[r]^a &
J^\bullet \ar[r]^b &
j(C^\bullet) \ar[r] &
0
}
$$
where the middle vertical arrow is compatible with the
splittings of both the top row and the bottom row.
Since the left and right vertical arrows are quasi-isomorphisms
also the middle vertical arrow is a quasi-isomorphism.
Hence we see that $J^\bullet \cong j(B^\bullet)$ in a manner which
identifies $a$ with $j(\alpha)$
and $b$ with $j(\beta)$.
The lower short exact sequence of the diagram implies that the
triangle
$(j(A^\bullet), J^\bullet, j(C^\bullet), a, b, j(\delta))$
is distinguished in $D^{+}(\mathcal{A})$. By definition of
a triangulated category and using the isomorphism
$J^\bullet \to j(B^\bullet)$ above we deduce that
the triangle
$$
(j(A^\bullet), j(B^\bullet), j(C^\bullet), j(\alpha), j(\beta), j(\delta))
$$
is distinguished as desired. Some details omitted.
\end{proof}

\noindent
Here is another type of exact functor.

\begin{lemma}
\label{lemma-additive-exact-homotopy-category}
Let $\mathcal{A}$, $\mathcal{B}$ be additive categories.
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor.
The induced functors
$$
F : K(\mathcal{A}) \longrightarrow K(\mathcal{B}),
\text{ and }
F : K^{+}(\mathcal{A}) \longrightarrow K^{+}(\mathcal{B})
$$
are exact functors of triangulated categories.
\end{lemma}

\begin{proof}
Suppose $A^\bullet \to B^\bullet \to C^\bullet$
is a termwise split sequence of complexes of $\mathcal{A}$ with splittings
$(s^n, \pi^n)$ and associated morphism $\delta : C^\bullet \to A^\bullet[1]$,
see Definition \ref{definition-split-ses}. Then
$F(A^\bullet) \to F(B^\bullet) \to F(C^\bullet)$
is a termwise split sequence of complexes with splittings
$(F(s^n), \pi^n)$ and associated morphism
$F(\delta) : F(C^\bullet) \to F(A^\bullet)[1]$.
Thus $F$ transforms distinguished triangles into distinguished triangles.
\end{proof}

\begin{lemma}
\label{lemma-composition-exact}
Let $\mathcal{D}, \mathcal{D}', \mathcal{D}''$ be triangulated categories.
Let $F : \mathcal{D} \to \mathcal{D}'$ and
$F' : \mathcal{D}' \to \mathcal{D}''$ be exact functors.
Then $F' \circ F$ is an exact functor.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}









\section{Injective resolutions: functorially}
\label{section-functorial-injective-resolutions}

\noindent
In this section we redo the construction of the localization functor
$K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ in case the
category $\mathcal{A}$ has functorial injective embeddings.
There are two reasons for this: First of all the proof is easier.
Second, the proof also works if $\mathcal{A}$ is a ``big'' abelian
category. See Remark \ref{remark-big-abelian-category} below.

\medskip\noindent
Let $\mathcal{A}$ be an abelian category.
Consider the category $\text{InjRes}(\mathcal{A})$
of arrows $\alpha : K^\bullet \to I^\bullet$
where $K^\bullet$ is a bounded below complex of $\mathcal{A}$,
$I^\bullet$ is a bounded below complex of injectives of $\mathcal{A}$
and $\alpha$ is a quasi-isomorphism. In other words, $\alpha$ is
an injective resolution and $K^\bullet$ is bounded below.
There is an obvious functor
$$
s : \text{InjRes}(\mathcal{A}) \longrightarrow \text{Comp}^{+}(\mathcal{A})
$$
defined by $(\alpha : K^\bullet \to I^\bullet) \mapsto K^\bullet$.
If $\mathcal{A}$ has enough injectives, then there is also
a functor
$$
t : \text{InjRes}(\mathcal{A}) \longrightarrow D^{+}(\mathcal{A})
$$
defined by $(\alpha : K^\bullet \to I^\bullet) \mapsto I^\bullet$.

\begin{lemma}
\label{lemma-functorial-injective-resolutions}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has functorial injective embeddings.
Then there exists a functor
$inj : \text{Comp}^{+}(\mathcal{A}) \to \text{InjRes}(\mathcal{A})$
such that $s \circ j = \text{id}$. Moreover, the composition
$t \circ inj : \text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
factors through $\text{Comp}^{+}(\mathcal{A}) \to K^{+}(\mathcal{A})$
to give a functor
$$
j = \overline{t \circ inj} :
K^{+}(\mathcal{A})
\longrightarrow
D^{+}(\mathcal{A})
$$
which is a localization functor, see
Definition \ref{definition-localization-functor}.
\end{lemma}

\begin{proof}
Let $A \mapsto (A \to J(A))$ be a functorial injective embedding, see
Homology, Definition \ref{homology-definition-functorial-injective-embedding}.
We first note that we may assume $J(0) = 0$. Namely, if not then
for any object $A$ we have $0 \to A \to 0$ which gives
a direct sum decomposition $J(A) = J(0) \oplus \text{Ker}(J(A) \to J(0))$.
Note that the functorial morphism $A \to J(A)$ has to map
into the second summand. Hence we can replace our functor
by $J'(A) = \text{Ker}(J(A) \to J(0))$ if needed.

\medskip\noindent
Let $K^\bullet$ be a bounded below complex of $\mathcal{A}$.
Say $K^p = 0$ if $p < B$.
We are going to construct a double complex $I^{\bullet, \bullet}$
of injectives, together with a map $\alpha : K^\bullet \to I^{\bullet, 0}$
to which we will apply
Homology, Lemma \ref{homology-lemma-double-complex-gives-resolution}.
First we set $I^{p, q} = 0$ whenever $q < 0$.
Next, we set $I^{p, 0} = J(K^p)$ and $\alpha^p : K^p \to I^{p, 0}$
the functorial embedding. Since $J$ is a functor we see that
$I^{\bullet, 0}$ is a complex and that $\alpha$ is a
morphism of complexes. Each $\alpha^p$ is injective. And
$I^{p, 0} = 0$ for $p < B$ because $J(0) = 0$. Next, we set
$I^{p, 1} = J(\text{Coker}(K^p \to I^{p, 0}))$. Again by functoriality
we see that $I^{\bullet, 1}$ is a complex. And again we get
that $I^{p, 1} = 0$ for $p < B$. It is also clear that
$K^p$ maps isomorphically onto $\text{Ker}(I^{p, 0} \to I^{p, 1})$.
As our third step we take $I^{p, 2} = J(\text{Coker}(I^{p, 0} \to I^{p, 1}))$.
And so on and so forth.

\medskip\noindent
At this point we can apply
Homology, Lemma \ref{homology-lemma-double-complex-gives-resolution}
to get that the map
$$
\alpha : K^\bullet \to sI^\bullet
$$
is a quasi-isomorphism. To prove we get a functor $inj$ it
rests to show that the construction above
is functorial. This verification is omitted.

\medskip\noindent
Suppose we have a functor $inj$ such that $s \circ inj = \text{id}$.
Set $j = t \circ inj$. Hence we will use the notation
$K^\bullet \mapsto inj(K^\bullet) = (K^\bullet \to j(K^\bullet))$
(similarly to
Homology, Definition \ref{homology-definition-functorial-injective-embedding}).
Suppose $\alpha , \beta : K^\bullet \to L^\bullet$ are two homotopic
maps of bounded below complexes of maps. Consider the maps
$inj(\alpha), inj(\beta)$ in the category $\text{InjRes}(\mathcal{A})$.
They induce a commutative diagram
$$
\xymatrix{
K^\bullet
\ar@<1ex>[r]^-{\alpha} \ar@<-1ex>[r]_-{\beta}
\ar[d] &
L^\bullet \ar[d] \\
j(K)^\bullet
\ar@<1ex>[r]^-{j(\alpha)} \ar@<-1ex>[r]_-{j(\beta)}
&
j(L)^\bullet
}
$$
Since the vertical arrows are quasi-isomorphisms, and $\alpha$ and $\beta$
are homotopic we see that
the morphisms $j(\alpha)$ and $j(\beta)$ are homotopic
by Lemma \ref{lemma-morphisms-equal-up-to-homotopy}. Hence
simply taking the $j$ of the class of a morphism up to
homotopy gives a well-defined class of morphisms between
$j(K^\bullet)$ and $j(L^\bullet)$. (Note that we are not
making any choices here.) The other statements of
Lemma \ref{lemma-morphisms-equal-up-to-homotopy}
are proved in exactly the same way as their corresponding proofs
in that lemma.
\end{proof}

\begin{remark}
\label{remark-big-abelian-category}
Let $\text{Mod}(\mathcal{O}_X)$ be the category of $\mathcal{O}_X$-modules
on a ringed space $(X, \mathcal{O}_X)$ (or more generally on a
ringed site). We will see later that $\text{Mod}(\mathcal{O}_X)$ has enough
injectives and in fact functorial injective embeddings, see
Injectives, Theorem \ref{injectives-theorem-sheaves-modules-injectives}.
Note that the proof of Lemma \ref{lemma-into-derived-category} does
not apply to $\text{Mod}(\mathcal{O}_X)$. But the proof of
Lemma \ref{lemma-functorial-injective-resolutions} does apply
to $\text{Mod}(\mathcal{O}_X)$. Thus we obtain
$$
j : K^{+}(\text{Mod}(\mathcal{O}_X))
\longrightarrow
D^{+}(\text{Mod}(\mathcal{O}_X))
$$
which is a localization functor. This argument works for
\begin{enumerate}
\item The category $\text{Mod}(R)$ of $R$-modules over a ring $R$.
\item The category $\textit{PMod}(\mathcal{O})$ of presheaves of
$\mathcal{O}$-modules on a site endowed with a presheaf of rings.
\item The category $\textit{Mod}(\mathcal{O})$ of presheaves of
$\mathcal{O}$-modules on a ringed site.
\item Add more here as needed.
\end{enumerate}
\end{remark}




\section{Injective resolutions: canonical delta-functor}
\label{section-canonical-delta-functor}

\noindent
The derived category should be the receptacle for the universal
cohomology functor. Hence in particular a short exact sequence
in the abelian category $\mathcal{A}$ should lead to a triangle
in the derived category. In order to state the result we use
the notion of a $\delta$-functor from an abelian category
into a triangulated category, see
Definition \ref{definition-delta-functor}.

\begin{lemma}
\label{lemma-exact-compose-delta-functor}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{A}$ be an abelian category.
Let $G : \mathcal{A} \to \mathcal{D}$ be a $\delta$-functor.
\begin{enumerate}
\item Let $\mathcal{D}'$ be a triangulated category.
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor.
Then the composition $F \circ G$ is a $\delta$-functor as well.
\item Let $\mathcal{A}'$ be an abelian category. Hence
$H : \mathcal{A}' \to \mathcal{A}$ be an exact functor.
Hence $G \circ H$ is a $\delta$-functor as well.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
Let $\mathcal{A}$ be an abelian category with enough injectives.
Consider the functors
$$
\mathcal{A} \to \text{Comp}^{+}(\mathcal{A})
\to K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})
$$
where the final arrow is a localization functor.
The two categories $\mathcal{A}$,
$\text{Comp}^{+}(\mathcal{A})$ are abelian
(see
Homology, Lemma \ref{homology-lemma-cat-cochain-abelian})
and the functor between them is exact. The last two are trianglulated and the
functor between them is exact (see Lemma \ref{lemma-j-is-exact}).

\medskip\noindent
Consider the functor
$\text{Comp}^{+}(\mathcal{A}) \to K^{+}(\mathcal{A})$.
This functor is not a $\delta$-functor in general.
The easiest way to see this is to consider a nonsplit
short exact sequence $0 \to A \to B \to C \to 0$
of objects of $\mathcal{A}$. Since
$\text{Hom}_{K^{+}(\mathcal{A})}(C[0], A[1]) = 0$
we see that any distinguished triangle arising from
this short exact sequence would look like
$(A[0], B[0], C[0], a, b, 0)$. But the existence of such a
distinguished triangle in $K^{+}(\mathcal{A})$ implies
that the extension is split (left as exercise). A contradiction.

\medskip\noindent
It turns out that the functor
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ is a
$\delta$-functor. In order to see this we have to define
the morphisms $\delta$ associated to a short exact sequence
$$
0 \to A^\bullet \xrightarrow{a} B^\bullet \xrightarrow{b} C^\bullet \to 0
$$
of bounded below complexes in the abelian category $\mathcal{A}$.
Consider the cone $C(a)^\bullet$ of the morphism $a$.
We have $C(a)^n = B^n \oplus A^{n + 1}$ and we define
$(\tilde b)^n : C(a)^n \to C^n$ via the projection to $B^n$ followed
by $b ^n$. Hence a morphism of complexes
$$
\tilde b : C(a)^\bullet \longrightarrow C^\bullet.
$$
It is clear that $\tilde b \circ i = b$ where $i$ is as in
Definition \ref{definition-cone}.
Note that the kernel of $\tilde b$ is identified with
the cone of $\text{id}_{A^\bullet}$ which is acyclic.
Hence we see that $\tilde b$ is a quasi-isomorphism.
According to Lemma \ref{lemma-the-same-up-to-isomorphisms} the triangle
$$
(A, B, C(a), a, i, -p)
$$
is a distinguished triangle in $K^{+}(\mathcal{A})$.
As $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ is
exact (see Lemma \ref{lemma-j-is-exact}) we see that
$(j(A), j(B), j(C(a)), j(a), j(i), -j(p))$ is a distinguished
triangle in $D^{+}(\mathcal{A})$. Since $\tilde b$ is a quasi-isomorphism
we see that $j(\tilde b)$ is an isomorphism in $D^{+}(\mathcal{A})$.
Hence we deduce that
$$
(j(A), j(B), j(C), j(a), j(b), -j(p) \circ j(\tilde b)^{-1})
$$
is a distinguished triangle of $D^{+}(\mathcal{A})$.
This suggests the following lemma.

\begin{lemma}
\label{lemma-canonical-delta-functor}
Let $\mathcal{A}$ be an abelian category.
Let $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ be
a localization functor. The functor
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
defined using $j$ has the natural structure of a $\delta$-functor, with
$$
\delta_{A^\bullet \to B^\bullet \to C^\bullet} = -j(p) \circ j(\tilde b)^{-1}
$$
as explained above.
\end{lemma}

\begin{proof}
We have already seen that this choice leads to a distinguished
triangle whenever given a short exact sequence of complexes.
We have to show that given a commutative diagram
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r]_a \ar[d]_f &
B^\bullet \ar[r]_b \ar[d]_g &
C^\bullet \ar[r] \ar[d]_h &
0 \\
0 \ar[r] &
(A')^\bullet \ar[r]^{a'} &
(B')^\bullet \ar[r]^{b'} &
(C')^\bullet \ar[r] &
0
}
$$
we get the desired commutative diagram of
Definition \ref{definition-delta-functor} (2).
By Lemma \ref{lemma-functorial-cone}
the pair $(f, g)$ induces a canonical morphism
$c : C(a)^\bullet \to C(a')^\bullet$. It is a simple computation
to show that $\tilde b' \circ c = h \circ \tilde b$ and
$f[1] \circ p = p' \circ c$. From this the result follows directly.
\end{proof}

\begin{lemma}
\label{lemma-compare-triangles-ses}
Let $\mathcal{A}$ be an abelian category.
Let $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ be
a localization functor.
Let
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
D^\bullet \ar[r] &
E^\bullet \ar[r] &
F^\bullet \ar[r] &
0
}
$$
be a commutative diagram of morphisms of complexes
such that the rows are short exact sequences of complexes, and
the vertical arrows are quasi-isomorphisms.
The $\delta$-functor of Lemma \ref{lemma-canonical-delta-functor} above
maps the to short exact sequences
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
and
$0 \to D^\bullet \to E^\bullet \to F^\bullet \to 0$
to isomorphic distinguished triangles.
\end{lemma}

\begin{proof}
Trivial from the fact that $j$ transforms quasi-isomorphisms
into isomorphisms and that the associated distinguished
triangles are functorial.
\end{proof}

\begin{lemma}
\label{lemma-compare-trianigles-split-case}
Let $\mathcal{A}$ be an abelian category.
Let $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ be
a localization functor.
Let
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] &
B^\bullet \ar[r] &
C^\bullet \ar[r] &
0
}
$$
be a short exact sequences of complexes. Assume this short exact sequence
is termwise split. Let
$(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
be the distinguished triangle of $K^{+}(\mathcal{A})$
associated to the sequence. The $\delta$-functor of
Lemma \ref{lemma-canonical-delta-functor} above
maps the short exact sequences
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
to the distinguished triangle
$$
(j(A^\bullet), j(B^\bullet), j(C^\bullet), j(\alpha), j(\beta), j(\delta)).
$$
\end{lemma}

\begin{proof}
First note that the statement makes sense because by
Lemma \ref{lemma-j-is-exact} the functor $j$ is exact.
Then the result follows from
Lemma \ref{lemma-the-same-up-to-isomorphisms}
which gives an isomorphism between the two triangles.
\end{proof}

\begin{lemma}
\label{lemma-ses-injective-ses}
Let $\mathcal{A}$ be an abelian category.
Let $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ be
a localization functor.
Let
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I_1^\bullet \ar[r] &
I_2^\bullet \ar[r] &
I_3^\bullet \ar[r] &
0
}
$$
be a commutative diagram of morphisms of complexes
such that the rows are short exact sequences of complexes, and
the vertical arrows are injective resolutions
(see Lemma \ref{lemma-injective-resolution-ses}).
The $\delta$-functor of Lemma \ref{lemma-canonical-delta-functor} above
maps the short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
to the distinguished triangle of $D^{+}(\mathcal{A})$
associated to the short exact sequence
$0 \to I_1^\bullet \to I_2^\bullet \to I_3^\bullet \to 0$
(see Definition \ref{definition-derived-triangulated}).
\end{lemma}

\begin{proof}
Combine Lemmas \ref{lemma-compare-triangles-ses}
and \ref{lemma-compare-trianigles-split-case}.
\end{proof}






\section{Injective resolutions: Right derived functors}
\label{section-right-derived-functor}

\noindent
At this point we can use the material above to define the right derived
functors of a left exact functor between an abelian category having
enough injectives and a general abelian category.

\begin{definition}
\label{definition-right-derived-functor}
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$ be a left exact functor.
Assume $\mathcal{A}$ has enough injectives.
The {\it right derived functor $RF$} of $F$ is the functor
$$
RF : D^{+}(\mathcal{A}) \longrightarrow K^{+}(\mathcal{B})
$$
defined by $RF(I^\bullet) = F(I^\bullet)$ for any bounded
below complex of injectives.
Let $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ be
a localization functor. We also denote $RF$ any of the arrows
labeled $RF$ in the following commutative diagram
$$
\xymatrix{
\mathcal{A} \ar[r] \ar[rrrd]_{RF} &
\text{Comp}^{+}(\mathcal{A}) \ar[r] \ar[rrd]^{RF} &
K^{+}(\mathcal{A}) \ar[r]_j \ar[rd]^{RF} &
D^{+}(\mathcal{A}) \ar[d]^{RF} \\
& & & K^{+}(\mathcal{B})
}
$$
\end{definition}

\noindent
It is clear that we can use this definition even if $F$ is just additive
and $\mathcal{B}$ is just an additive category. However in this generality
the construction does not give the correct notion of a derived functor.
The following is a more important remark.

\begin{remark}
\label{remark-right-derived-functor}
If $\mathcal{B}$ has enough injectives as well and if
$j : K^{+}(\mathcal{B}) \to D^{+}(\mathcal{B})$ is a localization functor
for $\mathcal{B}$, then often the functors $j \circ RF$ are denoted
$RF$ and called the right derived functors of $F$ as well.
\end{remark}

\noindent
It actually often makes more sense to do this since many results about
derived functors are proved using spectral sequences, double complexes
and whatnot which often given quasi-isomorphisms between certain complexes
and hence naturally isomorphisms in the derived category but not in the
category $K^{+}(\mathcal{B})$.

\begin{lemma}
\label{lemma-right-derived-properties}
With assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
\begin{enumerate}
\item The functor $RF$ is an exact functor
$D^{+}(\mathcal{A}) \to K^{+}(\mathcal{B})$.
\item The functor $RF$ is an exact functor
$K^{+}(\mathcal{A}) \to K^{+}(\mathcal{B})$.
\item The functor $RF$ is a $\delta$-functor
$\text{Comp}^{+}(\mathcal{A}) \to K^{+}(\mathcal{B})$.
\item The functor $RF$ is a $\delta$-functor
$\mathcal{A} \to K^{+}(\mathcal{B})$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $\mathcal{I} \subset \mathcal{A}$ be the full subcategory of $\mathcal{A}$
consisting of injective objects. Recall that
$D^{+}(\mathcal{A}) = K^{+}(\mathcal{I})$ as a triangulated category.
Hence the first statement follows from
Lemma \ref{lemma-additive-exact-homotopy-category}, since
$RF = F$ on $D^{+}(\mathcal{A}) = K^{+}(\mathcal{I})$.
The second statement follows since
$j$ is exact (see Lemma \ref{lemma-j-is-exact}) and the compositions of exact
functors is exact (see Lemma \ref{lemma-composition-exact}).
The third statement follows since
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ is a $\delta$-functor
(see Lemma \ref{lemma-canonical-delta-functor})
and Lemma \ref{lemma-exact-compose-delta-functor}.
Finally, the last assertion follows since
$\mathcal{A} \to \text{Comp}^{+}(\mathcal{A})$
transforms short exact sequences into short exact sequences.
\end{proof}

\begin{definition}
\label{definition-higher-derived-functors}
With assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
Let $i \in \mathbf{Z}$.
The {\it $i$th right derived functor $R^iF$ of $F$} is the functor
$H^i \circ RF$ with target $\mathcal{B}$ and source
any of the categories $\mathcal{A}$, $\text{Comp}^{+}(\mathcal{A})$,
$K^{+}(\mathcal{A})$ and $D^{+}(\mathcal{A})$.
\end{definition}

\begin{lemma}
\label{lemma-higher-derived-functors}
With assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
\begin{enumerate}
\item For any short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
of complexes in $\text{Comp}^{+}(\mathcal{A})$ there
is an associated long exact sequence
$$
\ldots \to 
R^{i - 1}F(C^\bullet) \to
R^iF(A^\bullet) \to
R^iF(B^\bullet) \to
R^iF(C^\bullet) \to
R^{i + 1}F(A^\bullet) \to \ldots
$$
\item The functors $R^iF : \mathcal{A} \to \mathcal{B}$
are zero for $i < 0$. Also $R^0F = F : \mathcal{A} \to \mathcal{B}$.
\item We have $R^iF(I) = 0$ for $i > 0$ and $I$ injective.
\item The sequence $(R^iF, \delta)$ forms a universal $\delta$-functor (see
Homology, Definition \ref{homology-definition-universal-delta-functor})
from $\mathcal{A}$ to $\mathcal{B}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-F-acyclic}
With assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
An object $A$ of $\mathcal{A}$ is called {\it $F$-acyclic}
if $R^iF(A) = 0$ for all $i > 0$.
\end{definition}

\begin{lemma}
\label{lemma-F-acyclic-ses}
With assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
Let $0 \to A \to B \to C \to 0$ be a short exact sequence
of $\mathcal{A}$.
\begin{enumerate}
\item If $A$ and $C$ are $F$-acyclic then so is $B$.
\item If $A$ and $B$ are $F$-acyclic then so is $C$.
\item If $B$ and $C$ are $F$-acyclic and $F(B) \to F(C)$ is surjective
then $A$ is $F$-acyclic.
\end{enumerate}
In each of the three cases
$$
0 \to F(A) \to F(B) \to F(C) \to 0
$$
is a short exact sequence of $\mathcal{B}$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-leray-acyclicity}
(Leray's acyclicity lemma)
With assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
Let $A^\bullet$ be a bounded below complex of
$F$-acyclic objects. The canonical map
$$
F(A^\bullet) \longrightarrow RF(A^\bullet)
$$
is a quasi-isomorphism.
\end{lemma}

\begin{proof}
The canonical map comes by applying $F$ to the canonical map
$A^\bullet \to j(A^\bullet)$ of the localization functor.
Let $C^\bullet$ be the cone of $A^\bullet \to j(A^\bullet)$.
It is clear that $C^\bullet$ is a bounded below complex of
$F$-acyclic objects which is acyclic as a complex (i.e., quasi-isomorphic
to zero). Since $F(C^\bullet)$ is the cone of
$F(A^\bullet) \to RF(A^\bullet)$ we see there is a distinguished
triangle $(F(A^\bullet), RF(A^\bullet), F(C^\bullet), a, b, c)$
in $K^{+}(\mathcal{B})$. Hence it suffices to show that $F(C^\bullet)$
is an acyclic complex. In other words, it suffices to prove the lemma
in case $A^\bullet$ is a bounded below acyclic complex of $F$-acyclic objects.

\medskip\noindent
Suppose $A^\bullet$ looks like this
$$
0 \to A^n \to A^{n + 1} \to A^{n + 2} \to \ldots
$$
Set
$Z^m = \text{Im}(A^{m - 1} \to A^m) = \text{Ker}(A^m \to A^{m + 1})$.
Note that $Z^n = 0$ is $F$-acyclic. Then $A^n \cong Z^{n + 1}$
is $F$-acyclic. Then $0 \to Z^{n + 1} \to A^{n + 1} \to Z^{n + 2} \to 0$
is short exact. By Lemma \ref{lemma-F-acyclic-ses} we conclude that
$Z^{n + 2}$ is $F$-acyclic and 
$0 \to F(Z^{n + 1}) \to F(A^{n + 1}) \to F(Z^{n + 2}) \to 0$ is exact.
By induction on $m$ we see that $Z^m$ is $F$-acyclic for
all $m$ and each of the sequences
$$
0 \to F(Z^m) \to F(A^m) \to F(Z^{m + 1}) \to 0
$$
is short exact. Hence we see that $F(A^\bullet)$ is exact as desired.
\end{proof}

\begin{remark}
\label{remark-right-derived-exact-functor}
Assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
Suppose that $F$ is actually an exact functor.
In this case, for any injective resolution $I^\bullet$ of any object $A$
we see that $F(I^\bullet)$ is exact in positive degrees.
Hence we see that any object $A$ is $F$-acyclic.
In other words the functors $R^pF$ are all zero.
Hence by Lemma \ref{lemma-leray-acyclicity} the
value of the derived functor $RF$ on $A^\bullet$ is
(canonically) quasi-isomorphic to $F(A^\bullet)$
for any bounded below complex $A^\bullet$ of $\mathcal{A}$.
In other words, the canonical transformation
$F \to RF$ as functors $K^{+}(\mathcal{A}) \to K^{+}(\mathcal{B})$
is a quasi-isomorphism on every object in this case.
If we postcompose with a localization functor of $\mathcal{B}$
then we see that this transformation becomes an isomorphism of functors.
\end{remark}



\section{Injective resolutions: Cartan-Eilenberg}
\label{section-cartan-eilenberg}

\begin{definition}
\label{definition-cartan-eilenberg}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a bounded below complex.
A {\it Cartan-Eilenberg resolution} of $K^\bullet$
is given by a double complex $I^{\bullet, \bullet}$
and a morphism of complexes $\epsilon : K^\bullet \to I^{\bullet, 0}$
with the following properties:
\begin{enumerate}
\item There exists a $i \ll 0$ such that $I^{p, q} = 0$ for all $p < i$
and all $q$.
\item We have $I^{p, q} = 0$ if $q < 0$.
\item The complex $I^{p, \bullet}$ is an injective resolution of $K^p$.
\item The complex $\text{Ker}(d_1^{p, \bullet})$ is an injective resolution
of $\text{Ker}(d_K^p)$.
\item The complex $\text{Im}(d_1^{p, \bullet})$ is an injective resolution
of $\text{Im}(d_K^p)$.
\item The complex $H^p_{I}(I^{\bullet, \bullet})$ is an injective resolution
of $H^p(K^\bullet)$.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-cartan-eilenberg}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a bounded below complex.
There exists a Cartan-Eilenberg resolution of $K^\bullet$.
\end{lemma}

\begin{proof}
Suppose that $K^p = 0$ for $p < n$. Decompose $K^\bullet$ into
short exact sequences as follows: Set $Z^p = \text{Ker}(d^p)$,
$B^p = \text{Im}(d^{p - 1})$, $H^p = Z^p/B^p$, and consider
$$
\begin{matrix}
0 \to Z^n \to K^n \to B^{n + 1} \to 0 \\
0 \to B^{n + 1} \to Z^{n + 1} \to H^{n + 1} \to 0 \\
0 \to Z^{n + 1} \to K^{n + 1} \to B^{n + 2} \to 0 \\
0 \to B^{n + 2} \to Z^{n + 2} \to H^{n + 2} \to 0 \\
\ldots
\end{matrix}
$$
Set $I^{p, q} = 0$ for $p < n$. Inductively we choose
injective resolutions as follows:
\begin{enumerate}
\item Choose an injective resolution $Z^n \to J_Z^{n, \bullet}$.
\item Using Lemma \ref{lemma-injective-resolution-ses} choose injective
resolutions $K^n \to I^{n, \bullet}$, $B^{n + 1} \to J_B^{n + 1, \bullet}$,
and an exact sequence of complexes
$0 \to J_Z^{n, \bullet} \to I^{n, \bullet} \to J_B^{n + 1, \bullet} \to 0$
compatible with the short exact sequence
$0 \to Z^n \to K^n \to B^{n + 1} \to 0$.
\item Using Lemma \ref{lemma-injective-resolution-ses} choose injective
resolutions $Z^{n + 1} \to J_Z^{n + 1, \bullet}$,
$H^{n + 1} \to J_H^{n + 1, \bullet}$,
and an exact sequence of complexes
$0 \to J_B^{n + 1, \bullet} \to J_Z^{n + 1, \bullet}
\to J_H^{n + 1, \bullet} \to 0$
compatible with the short exact sequence
$0 \to B^{n + 1} \to Z^{n + 1} \to H^{n + 1} \to 0$.
\item Etc.
\end{enumerate}
Taking as maps $d_1^\bullet : I^{p, \bullet} \to I^{p + 1, \bullet}$
the compositions
$I^{p, \bullet} \to J_B^{p + 1, \bullet} \to
J_Z^{p + 1, \bullet} \to I^{p + 1, \bullet}$ everything is clear.
\end{proof}

\begin{lemma}
\label{lemma-two-ss-complex-functor}
Notations and assumptions as in
Definition \ref{definition-right-derived-functor}.
Let $K^\bullet$ be a bounded below complex of $\mathcal{A}$.
Let $I^{\bullet, \bullet}$ be a Cartan-Eilenberg resolution
for $K^\bullet$. The spectral sequences
$({}'E_r, {}'d_r)_{r \geq 0}$ and $({}''E_r, {}''d_r)_{r \geq 0}$
associated to the double complex $F(I^{\bullet, \bullet})$
satisfy the relations
$$
{}'E_2^{p, q} = H^p(R^qF(K^\bullet))\footnote{This notation sucks!
It really means the $p$th cohomology group of the complex with
terms $R^qF(K^n)$. Not the $p$th cohomology of the $q$th derived
functor of $F$ applied to $K^\bullet$...}
\quad
\text{and}
\quad
{}''E_2^{p, q} = R^pF(H^q(K^\bullet))
$$
Moreover, these spectral sequences converge to $R^{p + q}F(K^\bullet)$
and the associated induced filtrations on $R^{p + q}F(K^\bullet)$ are finite.
\end{lemma}

\begin{proof}
This is immediate from the definition of a Cartan-Eilenberg resolution and
Homology, Lemmas \ref{homology-lemma-ss-double-complex} and
\ref{homology-lemma-first-quadrant-ss}.
\end{proof}

\begin{remark}
\label{remark-functorial-ss}
The spectral sequences of Lemma \ref{lemma-two-ss-complex-functor}
are functorial in the complex $K^\bullet$. This follows from functoriality
properties of Cartan-Eilenberg resolutions. On the other hand, they are
both examples of a more general spectral sequence which may be associated
to a filtered complex of $\mathcal{A}$. The functoriality will follow from
its construction. We will return to this in the section on the filtered
derived category, see Remark \ref{remark-final-functorial}.
\end{remark}










\section{Injective resolutions: Composition of right derived functors}
\label{section-composition-right-derived-functors}

\noindent
The statement of the following lemma is slightly clumsy (for the moment)
since we are not mapping into the derived category of $\mathcal{C}$.
If we compose with a localization functor into the derived category
of $\mathcal{C}$ (see Remark \ref{remark-right-derived-functor})
then $t$ becomes an isomorphism of functors.

\begin{lemma}
\label{lemma-compose-derived-functors}
Let $\mathcal{A}, \mathcal{B}, \mathcal{C}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$
and $G : \mathcal{B} \to \mathcal{C}$ be left exact functors.
Let $j_{\mathcal{A}} : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ and
$j_{\mathcal{B}} : K^{+}(\mathcal{B}) \to D^{+}(\mathcal{B})$ be
localization functors. If $F(I)$ is $G$-acyclic for each injective object $I$
of $\mathcal{A}$, then we have a transformation of functors
$$
t : R(G \circ F) \longrightarrow RG \circ RF
$$
which is an quasi-isomorphism for every complex.
\end{lemma}

\begin{proof}
Let $A^\bullet$ be a bounded below complex of $\mathcal{A}$.
The map $t$ is just the canonical map
$$
G(F(j_{\mathcal{A}}(A^\bullet)))
\longrightarrow
G(j_{\mathcal{B}}(F(j_{\mathcal{A}}(A^\bullet)))).
$$
Under the hypotheses of the lemma we may apply
Leray's acyclicty lemma (Lemma \ref{lemma-leray-acyclicity})
to see that this is a quasi-isomorphism.
\end{proof}

\begin{lemma}
\label{lemma-grothendieck-spectral-sequence}
(Grothendieck spectral sequence.)
With assumptions as in Lemma \ref{lemma-compose-derived-functors}.
Let $A$ be an object of $\mathcal{A}$.
There exists a spectral sequence $(E_r^{p, q}, d_r^{p, q})_{r \geq 0}$
associated to a filtered complex with
$$
E_2^{p, q} = R^pG(R^qF(A))
$$
converging to $R^{p + q}(G \circ F)(A)$. Moreover, the induced filtration
on each $R^n(G \circ F)(A)$ is finite.
\end{lemma}

\begin{proof}
Choose an injective resolution $A \to I^\bullet$.
Choose a Cartan-Eilenberg resolution
$F(I^\bullet) \to I^{\bullet, \bullet}$
using
Lemma \ref{lemma-cartan-eilenberg}.
Apply
Lemma \ref{lemma-two-ss-complex-functor}
(use the second spectral sequence).
Details omitted.
\end{proof}




\section{Injective resolutions: filtered derived category}
\label{section-filtered-derived}

\noindent
A reference for this section is \cite[I, Chapter V]{cotangent}.
The goal is to understand the derived category $DF^{+}(\mathcal{A})$
of bounded below complexes of finitely filtered objects.
We are less general than the discussion in Illusie in that we
assume the abelian category $\mathcal{A}$ to have enough injectives.
We will slightly generalize Illusie's discussion by allowing our
filtered complexes to have infinitely many nonzero $\text{gr}^p(K^\bullet)$
(but retaining the requirement that each term has a finite filtration).
The rational for this generalization is that it is not essentially
harder and it allows us to apply the discussion to the spectral sequences of
Lemma \ref{lemma-two-ss-complex-functor}, see also
Remark \ref{remark-functorial-ss}.

\medskip\noindent
Note that some of this discussion can more generally be done in any
``exact category'' with enough injectives. Compare \cite{Buhler}, \cite{Keller}.

\begin{definition}
\label{definition-filtered-complexes-notation}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item Let $\alpha : K^\bullet \to L^\bullet$ be a morphism of
complexes of $\text{Fil}(\mathcal{A})$. We say that
$\alpha$ is a {\it filtered quasi-isomorphism} if
for each $p \in \mathbf{Z}$ the morphism
$\text{gr}^p(K^\bullet) \to \text{gr}^p(L^\bullet)$ is
a quasi-isomorphism.
\item We denote $\text{Fil}^f(\mathcal{A})$ the full subcategory
of $\text{Fil}(\mathcal{A})$ whose objects consist of
those $A \in \text{Ob}(\text{Fil}(\mathcal{A}))$
whose filtration is finite (see
Homology, Definition \ref{homology-definition-filtered}).
\item We say an object $I$ of $\text{Fil}^f(\mathcal{A})$
is {\it filtered injective} if each $\text{gr}^p(I)$ is
an injective object of $\mathcal{A}$.
\item Let $K^\bullet$ be a complex of $\text{Fil}^f(\mathcal{A})$.
We say that $K^\bullet$ is {\it filtered acyclic} if
for each $p \in \mathbf{Z}$ the complex $\text{gr}^p(K^\bullet)$ is
acyclic.
\item We denote $\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$ the
{\it category of bounded below complexes of finite filtered objects}
whose objects are bounded below complexes
$K^\bullet$ of $\text{Fil}^f(\mathcal{A})$.
\item We let $KF^{+}(\mathcal{A})$ be the category with the same objects
as $\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$
but as morphisms homotopy classes of
maps of complexes (see
Homology, Lemma \ref{homology-lemma-compose-homotopy-cochain}).
This is a triangulated category, see
Proposition \ref{proposition-homotopy-category-triangulated}.
\item Assume $\mathcal{A}$ has enough injectives.
By analogy with Definition \ref{definition-derived-category}
the {\it filtered derived category (bounded below version)} of $\mathcal{A}$
is the category $DF^{+}(\mathcal{A})$ whose
\begin{enumerate}
\item objects are bounded below complexes of filtered injective objects
of $\text{Fil}^f(\mathcal{A})$, and
\item morphisms are morphisms of complexes of $\text{Fil}^f(\mathcal{A})$
up to homotopy.
\end{enumerate}
This is a triangulated category, because the category of filtered
injective objects of $\text{Fil}^f(\mathcal{A})$ is additive.
In other words, using
Proposition \ref{proposition-homotopy-category-triangulated}
once again.
\end{enumerate}
\end{definition}

\noindent
Hence there are functors $\text{gr}^p$ fitting
into a commutative diagram
$$
\xymatrix{
\text{Fil}^f(\mathcal{A}) \ar[r] \ar[d]_{\text{gr}^p} &
\text{Comp}^{+}(\text{Fil}^f(\mathcal{A})) \ar[r] \ar[d]_{\text{gr}^p} &
KF^{+}(\mathcal{A}) \ar[d]_{\text{gr}^p} &
DF^{+}(\mathcal{A}) \ar[d]_{\text{gr}^p} \\
\mathcal{A} \ar[r] &
\text{Comp}^{+}(\mathcal{A}) \ar[r] &
K^{+}(\mathcal{A}) &
D^{+}(\mathcal{A})
}
$$
There is a similar diagram corresponding to the forgetful
functor $\text{Fil}^f(\mathcal{A}) \to \mathcal{A}$.
Note that the functors $KF^{+}(\mathcal{A}) \to K^{+}(\mathcal{A})$
and $DF^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
are exact functors of triangulated categories,
see Lemma \ref{lemma-additive-exact-homotopy-category}.
We will fill in the ``missing'' horizontal arrows in a moment.

\medskip\noindent
In Exercises, Section \ref{exercises-section-filtered-derived}
we provide the correct statements regarding the uniqueness and
existence of injective resolutions in the filtered sense.
Briefly, assume the abelian category $\mathcal{A}$ has enough injectives.
An {\it filtered injective resolution} of an object $K^\bullet$
of $\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$
is given by a filtered quasi-isomorphism
$$
K^\bullet \longrightarrow I^\bullet
$$
into an object $I^\bullet$ of $\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$
all of whose terms are filtered injective. The first result is that such
an injective resolution always exists.
See Exercise \ref{exercises-exercise-injective-resolution-complex}.
The second result is that given a solid diagram
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_\gamma & L^\bullet \ar@{-->}[dl]^\beta \\
I^\bullet
}
$$
of complexes of $\text{Fil}^f(\mathcal{A})$, with $K^\bullet$, $L^\bullet$
and $I^\bullet$ are bounded below, each $I^n$ a filtered injective object,
and $\alpha$ a filtered quasi-isomorphism there is a dotted arrow, then there
exists a dotted arrow making the diagram commute up to homotopy.
See Exercise \ref{exercises-exercise-morphisms-lift}.
And finally the third result is that any two dotted arrows in the diagram
above making the diagram commute up to homotopy differ by a homotopy.
See Exercise \ref{exercises-exercise-morphisms-equal-up-to-homotopy}.
This in particular implies that given
$K^\bullet, I^\bullet \in \text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$,
$K^\bullet$ filtered acyclic, $I^\bullet$ consisting of injectives,
then $\text{Hom}_{KF^{+}(\mathcal{A})}(K^\bullet, I^\bullet) = 0$.

\begin{lemma}
\label{lemma-filtered-localization-functor}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
There exists a {\it localization functor}
$$
j : KF^{+}(\mathcal{A}) \longrightarrow DF^{+}(\mathcal{A})
$$
together with for each $K^\bullet \in \text{Ob}(KF^{+}(\mathcal{A}))$
a morphism $i_K : K^\bullet \to j(K^\bullet)$ with the following properties.
\begin{enumerate}
\item For every $K^\bullet \in \text{Ob}(KF^{+}(\mathcal{A}))$ the morphism
$i_K : K^\bullet \to j(K^\bullet)$
is a filtered quasi-isomorphism.
\item For every morphism $\alpha : K^\bullet \to L^\bullet$ of
$KF^{+}(\mathcal{A})$ we have $j(\alpha) \circ i_K = i_L \circ \alpha$.
\item Given a morphism of complexes $\alpha : K^\bullet \to L^\bullet$
then $j(\alpha)$ is invertible if and only if $\alpha$ is a
filtered quasi-isomorphism.
\item For any $K^\bullet$ we have $j(K^\bullet) \cong 0$ if and only
if $K^\bullet$ is filtered acyclic.
\end{enumerate}
Furthermore, $j$ is an exact functor of triangulated categories,
and the diagrams
$$
\xymatrix{
KF^{+}(\mathcal{A}) \ar[d]_{\text{gr}^p} \ar[r]_j &
DF^{+}(\mathcal{A}) \ar[d]_{\text{gr}^p} \\
K^{+}(\mathcal{A}) \ar[r]^j &
D^{+}(\mathcal{A})
}
\quad
\xymatrix{
KF^{+}(\mathcal{A}) \ar[d]^{\text{forget }F} \ar[r]_j &
DF^{+}(\mathcal{A}) \ar[d]^{\text{forget }F} \\
K^{+}(\mathcal{A}) \ar[r]^j &
D^{+}(\mathcal{A})
}
$$
are commutative up to a canonical isomorphisms of functors.
\end{lemma}

\begin{proof}
Omitted. Hint: Argue exactly as in the proof of
Lemma \ref{lemma-into-derived-category}
using the results discussed above the lemma.
For the last statement argue as in the proof of
Lemma \ref{lemma-canonical-delta-functor}.
\end{proof}

\begin{remark}
\label{remark-filtered-localization-big}
We claim this result only if $\mathcal{A}$ is a category in our sense,
namely if it has a set of objects. However, suppose given a big abelian
category $\mathcal{A}$ with enough injectives, such as
$\text{Mod}(\mathcal{O}_X)$ for example. Then for any given set of objects
$\{A_i\}_{i\in I}$ there is an abelian subcategory
$\mathcal{A}' \subset \mathcal{A}$ containing all of them
and having enough injectives, see
Sets, Lemma \ref{sets-lemma-abelian-injectives}.
Thus we may use the lemma above for $\mathcal{A}'$.
This essentially means that if we use a set worth of diagrams, etc 
then we will never run into trouble using the lemma.
\end{remark}

\noindent
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $T : \mathcal{A} \to \mathcal{B}$ be a left exact functor.
(We cannot use the letter $F$ for the functor since this would
conflict too much with our use of the letter $F$ to indicate
filtrations.)
Assume $\mathcal{A}$ has enough injectives.
At this point we can redo the discussion of 
Section \ref{section-right-derived-functor} to define the
{\it right filtered derived functors}
\begin{equation}
\label{equation-filtered-derived-functor}
RT : DF^{+}(\mathcal{A}) \longrightarrow KF^{+}(\mathcal{B})
\end{equation}
of our functor $T$. Namely, given a bounded below complex $I^\bullet$
consisting of filtered injective objects we set
$RT(I^\bullet) = T(I^\bullet)$ as a complex, with filtration
$F^p(RT(I^\bullet)) := T(F^p(I^\bullet))$. Note that by
Exercise \ref{exercises-exercise-split-injective} every term
\begin{equation}
\label{equation-decompose}
I^n \cong \bigoplus\nolimits_{p \in \mathbf{Z}} \text{gr}^p(I^n)
\end{equation}
compatible with filtrations. Hence it is clear that
$\text{gr}^p(T(I^\bullet)) = T(\text{gr}^p(I^\bullet))$.
This implies that
\begin{equation}
\label{equation-commute-gr}
\text{gr}^p \circ RT \cong RT \circ \text{gr}^p
\end{equation}
and
\begin{equation}
\label{equation-commute-forget}
(\text{forget }F) \circ RT \cong RT \circ (\text{forget }F)
\end{equation}
as functors $DF^{+}(\mathcal{A}) \to K^{+}(\mathcal{B})$.
Here the functor $RT$ on the left hand side is the one from
Definition \ref{definition-right-derived-functor}.
As in Remark \ref{remark-right-derived-functor} we point out that it
is customary (and useful) to think of the filtered derived functor
as a functor $DF^{+}(\mathcal{A}) \to DF^{+}(\mathcal{B})$
by postcomposing by a localization functor
$j : KF^{+}(\mathcal{B}) \to DF^{+}(\mathcal{B})$ as in
Lemma \ref{lemma-filtered-localization-functor}
in those cases where $\mathcal{B}$ has enough injectives.

\medskip\noindent
Precomposing with a localization functor $j$ for $\mathcal{A}$
we also get derived functors
$$
RT : \text{Fil}^f(\mathcal{A}) \to KF^{+}(\mathcal{B}),
\quad
RT : \text{Comp}^{+}(\text{Fil}^f(\mathcal{A})) \to KF^{+}(\mathcal{B}),
$$
and finally
$$
RT : KF^{+}(\mathcal{A}) \to KF^{+}(\mathcal{B}).
$$
Note that since $\text{Fil}^f(\mathcal{A})$, and
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$ are no longer
abelian it does not make sense to say that $RT$ restricts to
a $\delta$-functor on them. (As mentioned before this can be
repaired by thinking of these categories as exact categories and
formulating the notion of a $\delta$-functor from an exact category
into a triangulated category.)
But it does make sense, and it is true
by construction, that $RT$ is an exact functor of triangulated
categories on the categories $DF^{+}(\mathcal{A})$ and
$KF^{+}(\mathcal{A})$.

\medskip\noindent
Actually, this is somewhat besides the point since we are going
to use the filtered derived functor mainly to prove things about
the actual right derived functors of $T$. In fact, mainly we will
use the following lemma.

\begin{lemma}
\label{lemma-ss-filtered-derived}
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $T : \mathcal{A} \to \mathcal{B}$ be a left exact functor.
Assume $\mathcal{A}$ has enough injectives.
Let $(K^\bullet, F)$ be an object of
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$.
There exists a spectral sequence $(E_r^{p, q}, d_r)_{r\geq 0}$
which is the spectral sequence
associated to an object of
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{B}))$
with
$$
E_1^{p, q} = R^{p + q}T(\text{gr}^p(K^\bullet))
$$
which converges to $R^{p + q}T(K^\bullet)$ inducing a finite
filtration on each $R^nT(K^\bullet)$. Moreover the construction
of this spectral sequence is functorial in the object
$K^\bullet$ of $\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$.
In fact the terms $(E_r, d_r)$ for $r \geq 2$ do not depend
on any choices.
\end{lemma}

\begin{proof}
Instead of quoting the abstract constructions above we
show how the existence of filtered injective resolutions gives
rise to this spectral sequence.
Choose a filtered injective resolution $K^\bullet \to I^\bullet$.
Consider the complex $RT(K^\bullet) = T(I^\bullet)$, filtered as
in the definition of $RT$, see
Equation (\ref{equation-filtered-derived-functor}).
Thus we can consider the spectral sequence
$(E_r, d_r)_{r \geq 0}$ associated to
this as a filtered complex in $\mathcal{B}$, see
Homology, Section \ref{homology-section-filtered-complex}.
By
Homology, Lemma \ref{homology-lemma-spectral-sequence-filtered-complex}
we have $E_1^{p, q} = H^{p + q}(\text{gr}^p(T(I^\bullet)))$.
By Equation (\ref{equation-decompose}) we have
$E_1^{p, q} = H^{p + q}(T(\text{gr}^p(I^\bullet)))$, and
by definition of a filtered injective resolution the
map $\text{gr}^p(K^\bullet) \to \text{gr}^p(I^\bullet)$
is an injective resolution. Hence
$E_1^{p, q} = R^{p + q}T(\text{gr}^p(K^\bullet))$.

\medskip\noindent
On the other hand, each $I^n$ has a finite filtration and hence
each $T(I^n)$ has a finite filtration. Thus we may apply
Homology, Lemma \ref{homology-lemma-biregular-ss-converges}
to conclude that the
spectral sequence converges to $H^n(T(I^\bullet)) = R^nT(K^\bullet)$
moreover inducing finite filtrations on each of the terms.

\medskip\noindent
Suppose that $K^\bullet \to L^\bullet$ is a morphism of
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$. By our results above,
for example Lemma \ref{lemma-filtered-localization-functor}, there
exists a commutative diagram
$$
\xymatrix{
K^\bullet \ar[r] \ar[d] & L^\bullet \ar[d] \\
I^\bullet \ar[r] & J^\bullet
}
$$
where the vertical arrows are filtered injective resolutions.
Hence we get a morphism of filtered complexes
$T(I^\bullet) \to T(J^\bullet)$ which gives rise to the
morphism of spectral sequences, see
Homology,
Lemma \ref{homology-lemma-spectral-sequence-filtered-complex-functorial}.
The last statement follows from this easily.
\end{proof}

\begin{remark}
\label{remark-final-functorial}
As promised in
Remark \ref{remark-functorial-ss}
we discuss the connection of the lemma
above with the constructions using Cartan-Eilenberg resolutions.
Namely, assume the notations of
Lemma \ref{lemma-two-ss-complex-functor}.
In particular $K^\bullet$ is a bounded below complex of
$\mathcal{A}$ and $T : \mathcal{A} \to \mathcal{B}$ is a
left exact functor. We give an alternative construction of the
spectral sequences ${}'E$ and ${}''E$ 

\medskip\noindent
First spectral sequence. Consider the ``stupid'' filtration
on $K^\bullet$
obtained by setting $F^p(K^\bullet) = \sigma_{\geq p}(K^\bullet)$, see
Homology, Section \ref{homology-section-truncations}.
Note that this stupid in the sense that
$d(F^p(K^\bullet)) \subset F^{p + 1}(K^\bullet)$, compare
Homology, Lemma \ref{homology-lemma-spectral-sequence-filtered-complex-d1}.
Note that $\text{gr}^p(K^\bullet) = K^p[p]$ with this filtration.
According to the above there is a spectral sequence
with $E_1$ term $E_1^{p, q} = R^{p + q}T(K^p[p])$.
Then the $E_2$ term is clearly $E_2^{p, q} = H^p(R^{p + q}T(K^\bullet))$
as in the spectral sequence ${}'E_r$.

\medskip\noindent
Second spectral sequence. Consider the filtration on the complex $K^\bullet$
obtained by setting $F^p(K^\bullet) = \tau_{\leq -p}(K^\bullet)$,see
Homology, Section \ref{homology-section-truncations}.
The minus sign is necessary
to get a decreasing filtration. Note that
$\text{gr}^p(K^\bullet)$ is quasi-isomorphic to $H^{-p}(K^\bullet)[-p]$
with this filtration. According to the above there is a spectral sequence
with $E_1$ term
$$
E_1^{p, q}
= R^{p + q}T(H^{-p}(K^\bullet)[-p])
= R^{2p + q}T(H^{-p}(K^\bullet)) = {}''E_2^{i, j}
$$
with $i = 2p + q$ and $j = -p$. (This looks unnatural, but note that we
could just have well developped the whole theory of filtered complexes
using increasing filtrations, with the end result that this then looks
natural, but the other one doesn't.) We leave it to the reader to see
that the differentials match up.

\medskip\noindent
Actually, given a Cartan-Eilenberg resolution
$K^\bullet \to I^{\bullet, \bullet}$ the induced morphism
$K^\bullet \to sI^\bullet$ into the associated simple complex
will be a filtered injective resolution for either filtration
using suitable filtrations on $sI^\bullet$. This can be used
to match up the spectral sequences exactly.
\end{remark}




\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
