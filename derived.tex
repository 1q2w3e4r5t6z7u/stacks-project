\input{preamble}

% OK, start here.
%
\begin{document}

\title{Derived Categories}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
We first discuss triangulated categories and localization in triangulated
categories. Next, we prove that the homotopy category of complexes in an
additive category is a triangulated category. Once this is done we define
the derived category of an abelian category as the localization of the
of homotopy category with respect to quasi-isomorphisms.
A good reference is Verdier's thesis \cite{Verdier}.



\section{Triangulated categories}
\label{section-triangulated-categories}

\noindent
Triangulated categories are a convenient tool to describe the type
of structure inherent in the derived category of an abelian category.
Some references are \cite{Verdier} and \cite{Neeman}.




\section{Triangulated categories: Definitions}
\label{section-triangulated-definitions}

\noindent
In this section we collect most of the definitions concerning triangulated
and pre-triangulated categories.

\begin{definition}
\label{definition-triangle}
Let $\mathcal{D}$ be an additive category.
Let $[n] : \mathcal{D} \to \mathcal{D}$, $E \mapsto E[n]$
be a collection of additive functors indexed by $n \in \mathbf{Z}$ such that
$[n] \circ [m] = [n + m]$  and $[0] = \text{id}$ (equality as functors).
In this situation
we call {\it triangle} a sixtuple $(X, Y, Z, f, g, h)$
where $X, Y, Z \in \text{Ob}(\mathcal{D})$ and
$f : X \to Y$, $g : Y \to Z$ and $h : Z \to X[1]$ are morphisms
of $\mathcal{D}$.
A {\it morphism of triangles}
$(X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')$
is given by morphisms $a : X \to X'$, $b : Y \to Y'$ and $c : Z \to Z'$
of $\mathcal{D}$ such that
$b \circ f = f' \circ a$, $c  \circ g = g' \circ b$ and
$a[1] \circ h = h' \circ c$.
\end{definition}

\noindent
A morphism of triangles is visualized by the following
commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^a &
Y \ar[r] \ar[d]^b &
Z \ar[r] \ar[d]^c &
X[1] \ar[d]^{a[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
Here is the definition of a triangulated category as given in
Verdier's thesis.

\begin{definition}
\label{definition-triangulated-category}
A {\it triangulated category} consists of a triple
$(\mathcal{D}, \{[n]\}_{n\in \mathbf{Z}}, \mathcal{T})$
where
\begin{enumerate}
\item $\mathcal{D}$ is an additive category,
\item $[n] : \mathcal{D} \to \mathcal{D}$, $E \mapsto E[n]$
be a collection of additive functors indexed by $n \in \mathbf{Z}$ such that
$[n] \circ [m] = [n + m]$ and $[0] = \text{id}$ (equality as functors), and
\item $\mathcal{T}$ is a set of triangles called the
{\it distinguished triangles}
\end{enumerate}
subject to the following conditions
\begin{enumerate}
\item[TR1] Any triangle isomorphic to a distinguished triangle is
a distinguished triangle. Any triangle of the form
$(X, X, 0, \text{id}, 0, 0)$ is distinguished.
For any morphism $f : X \to Y$ of $\mathcal{D}$ there exists a
distinguished triangle of the form $(X, Y, Z, f, g, h)$.
\item[TR2] The triangle $(X, Y, Z, f, g, h)$ is distinguished
if and only if the triangle $(Y, Z, X[1], g, h, -f[1])$ is.
\item[TR3] Given a solid commutative square
$$
\xymatrix{
X \ar[r] \ar[d]^a &
Y \ar[r] \ar[d]^b &
Z \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{a[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
whose rows are distinguished triangles there exists a morphism
$c : Z \to Z'$ such that $(a, b, c)$ is a morphism of triangles.
\item[TR4] Given objects $X$, $Y$, $Z$ of $\mathcal{D}$, and morphisms
$f : X \to Y$, $g : Y \to Z$, and distinguished triangles
$(X, Y, Q_1, f, p_1, d_1)$,
$(X, Z, Q_2, g \circ f, p_2, d_2)$,
and
$(Y, Z, Q_3, g, p_3, d_3)$,
there exist
morphisms $a : Q_1 \to Q_2$ and $b : Q_2 \to Q_3$ such
that
\begin{enumerate}
\item $(Q_1, Q_2, Q_3, a, b, p_1[1] \circ d_3)$ is a
distinguished triangle,
\item the triple $(\text{id}_X, g, a)$ is
a morphism of triangles
$(X, Y, Q_1, f, p_1, d_1) \to (X, Z, Q_2, g \circ f, p_2, d_2)$, and
\item the triple $(f, \text{id}_Z, b)$ is a morphism of triangles
$(X, Z, Q_2, g \circ f, p_2, d_2) \to (Y, Z, Q_3, g, p_3, d_3)$.
\end{enumerate}
\end{enumerate}
We will call $(\mathcal{D}, [\ ], \mathcal{T})$ a
{\it pre-triangulated category} if TR1, TR2 and TR3 hold.
\end{definition}

\noindent
The explanation of TR4 is that if you think of $Q_1$ as
$Y/X$, $Q_2$ as $Z/X$ and $Q_3$ as $Z/Y$, then TR4(a) expresses
the isomorphism $(Z/X)/(Y/Z) \cong Z/Y$ and TR(b) and TR(c)
express that we can compare the triangles $X \to Y \to Q_1 \to X[1]$
etc with morphisms of triangles. For a more precise reformuation
of this idea see the proof of Lemma \ref{lemma-two-split-injections}.

\medskip\noindent
The sign in TR2 means that if $(X, Y, Z, f, g, h)$ is a distinguished triangle
then in the long sequence
\begin{equation}
\label{equation-rotate}
\ldots \to
Z[-1] \xrightarrow{-h[-1]}
X \xrightarrow{f}
Y \xrightarrow{g}
Z \xrightarrow{h}
X[1] \xrightarrow{-f[1]}
Y[1] \xrightarrow{-g[1]}
Z[1] \to \ldots
\end{equation}
each four term sequence gives a distinguished triangle.

\medskip\noindent
As usual we abuse notation and we simply speak of a (pre-)triangulated
category $\mathcal{D}$ without explicitly introducing notation for the
additional data. The notion of a pre-triangulated category is
useful in finding statements equivalent to TR4.

\medskip\noindent
We have the following definition of a triangulated functor.

\begin{definition}
\label{definition-exact-functor-triangulated-categories}
Let $\mathcal{D}$, $\mathcal{D}'$ be pre-triangulated
categories. An {\it exact functor}, or a {\it triangulated functor}
from $\mathcal{D}$ to $\mathcal{D}'$ is a functor
$F : \mathcal{D} \to \mathcal{D}'$ together
with given functorial isomorphisms $\xi_X : F(X[1]) \to F(X)[1]$
such that for every distinguished triangle
$(X, Y, Z, f, g, h)$ of $\mathcal{D}$ the triangle
$(F(X), F(Y), F(Z), F(f), F(g), \xi_X \circ F(h))$
is a distinguished triangle of $\mathcal{D}'$.
\end{definition}

\noindent
An exact functor is additive, see
Lemma \ref{lemma-exact-functor-additive}.
When we say two triangulated categories are equivalent we mean that
they are equivalent in the $2$-category of triangulated categories.
A $2$-morphism $a : (F, \xi) \to (F', \xi')$ in this $2$-category is
simply a transformation of functors $a : F \to F'$ which is compatible
with $\xi$ and $\xi'$, i.e.,
$$
\xymatrix{
F \circ [1] \ar[r]_\xi \ar[d]_{a \star 1} & [1] \circ F \ar[d]^{1 \star a} \\
F' \circ [1] \ar[r]^{\xi'} & [1] \circ F'
}
$$
commutes.

\begin{definition}
\label{definition-triangulated-subcategory}
Let $(\mathcal{D}, [\ ], \mathcal{T})$ be a pre-triangulated category.
A {\it pre-triangulated subcategory}\footnote{This definition may be
nonstandard. If $\mathcal{D}'$ is a full subcategory then $\mathcal{T}'$
is the intersection of the set of triangles in $\mathcal{D}'$ with
$\mathcal{T}$, see
Lemma \ref{lemma-triangulated-subcategory}.
In this case we drop $\mathcal{T}'$ from the notation.}
is a pair $(\mathcal{D}', \mathcal{T}')$ such that
\begin{enumerate}
\item $\mathcal{D}'$ is an additive subcategory of $\mathcal{D}$
which is preserved under $[1]$ and $[-1]$,
\item $\mathcal{T}' \subset \mathcal{T}$ is a subset such that for every
$(X, Y, Z, f, g, h) \in \mathcal{T}'$ we have
$X, Y, Z \in \text{Ob}(\mathcal{D}')$ and
$f, g, h \in \text{Arrows}(\mathcal{D}')$, and
\item $(\mathcal{D}', [\ ], \mathcal{T}')$ is a pre-triangulated
category.
\end{enumerate}
If $\mathcal{D}$ is a triangulated category, then we say
$(\mathcal{D}', \mathcal{T}')$ is a {\it triangulated subcategory} if
it is a pre-triangulated subcategory and
$(\mathcal{D}', [\ ], \mathcal{T}')$ is a triangulated category.
\end{definition}

\noindent
In this situation the inclusion functor
$\mathcal{D}' \to \mathcal{D}$ is an exact functor
with $\xi_X : X[1] \to X[1]$ given by the identity on $X[1]$.

\medskip\noindent
We will see in
Lemma \ref{lemma-composition-zero}
that for a distinguished triangle $(X, Y, Z, f, g, h)$
in a pre-triangulated category the composition $g \circ f : X \to Z$ is zero.
Thus the sequence (\ref{equation-rotate}) is a complex.
A homological functor is one that turns this complex into a long
exact sequence.

\begin{definition}
\label{definition-homological}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $\mathcal{A}$ be an abelian category.
An additive functor $H : \mathcal{D} \to \mathcal{A}$ is called
{\it homological} if for every distinguished triangle
$(X, Y, Z, f, g, h)$ the sequence
$$
H(X) \to H(Y) \to H(Z)
$$
is exact in the abelian category $\mathcal{A}$. An additive functor
$H : \mathcal{D}^{opp} \to \mathcal{A}$ is called {\it cohomological}
if the corresponding functor $\mathcal{D} \to \mathcal{A}^{opp}$ is
homological.
\end{definition}

\noindent
If $H : \mathcal{D} \to \mathcal{A}$ is a homological functor
we often write $H^n(X) = H(X[n])$ so that $H(X) = H^0(X)$.
Our discussion of TR2 above implies that says that a distinguished triangle
$(X, Y, Z, f, g, h)$ determines a long exact sequence
\begin{equation}
\label{equation-long-exact-cohomology-sequence}
\xymatrix{
H^{-1}(Z) \ar[r]^{h[-1]} &
H^0(X) \ar[r]^f &
H^0(Y) \ar[r]^g &
H^0(Z) \ar[r]^h &
H^1(X)
}
\end{equation}
This will be called the {\it long exact sequence} associated to the
distinguished triangle and the homological functor. As indicated
we will not use any signs for the morphisms in the long exact
sequence. This has the side effect that maps in the long exact sequence
associated to the rotation (TR2) of a distinguished triangle differ
from the maps in the sequence above by some signs.

\begin{definition}
\label{definition-delta-functor}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{D}$ be a triangulated category.
A {\it $\delta$-functor from $\mathcal{A}$ to $\mathcal{D}$} is
given by a functor $G : \mathcal{A} \to \mathcal{D}$ and
a rule which assigns to every short exact sequence
$$
0 \to A \xrightarrow{a} B \xrightarrow{b} C \to 0
$$
a morphism $\delta = \delta_{A \to B \to C} : G(C) \to G(A)[1]$
such that
\begin{enumerate}
\item the triangle
$(G(A), G(B), G(C), G(a), G(b), \delta_{A \to B \to C})$
is a distinguished triangle of $\mathcal{D}$
for any short exact sequence as above, and
\item for every morphism $(A \to B \to C) \to (A' \to B' \to C')$
of short exact sequences the diagram
$$
\xymatrix{
G(C) \ar[d] \ar[rr]_{\delta_{A \to B \to C}} & &
G(A)[1] \ar[d] \\
G(C') \ar[rr]^{\delta_{A' \to B' \to C'}} & &
G(A')[1]
}
$$
is commutative.
\end{enumerate}
In this situation we call
$(G(A), G(B), G(C), G(a), G(b), \delta_{A \to B \to C})$
the {\it image of the short exact sequence under the
given $\delta$-functor}.
\end{definition}

\noindent
Note how a $\delta$-functor comes equipped with additional structure.
Strictly speaking it does not make sense to say that a given
functor $\mathcal{A} \to \mathcal{D}$ is a $\delta$-functor, but we
will often do so anyway.












\section{Triangulated categories: Elementary results}
\label{section-elementary-results}

\noindent
Most of the results in this section are proved for pre-triangulated categories
and a fortiori hold in any triangulated category.

\begin{lemma}
\label{lemma-composition-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
Then $g \circ f = 0$,
$h \circ g = 0$ and $f[1] \circ h = 0$.
\end{lemma}

\begin{proof}
By TR1 we know $(X, X, 0, 1, 0, 0)$ is a distinguished triangle.
Apply TR3 to
$$
\xymatrix{
X \ar[r] \ar[d]^1 &
X \ar[r] \ar[d]^f &
0 \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{1[1]} \\
X \ar[r]^f &
Y \ar[r]^g &
Z \ar[r]^h &
X[1]
}
$$
Of course the dotted arrow is the zero map. Hence the commutativity of
the diagram implies that $g \circ f = 0$. For the other cases
rotate the triangle, i.e., apply TR2.
\end{proof}

\begin{lemma}
\label{lemma-representable-homological}
Let $\mathcal{D}$ be a pre-triangulated category.
For any object $W$ of $\mathcal{D}$ the functor
$\text{Hom}_{\mathcal{D}}(W, -)$ is homological, and the functor
$\text{Hom}_{\mathcal{D}}(-, W)$ is cohomological.
\end{lemma}

\begin{proof}
Consider a distinguished triangle $(X, Y, Z, f, g, h)$.
We have already seen that $g \circ f = 0$, see
Lemma \ref{lemma-composition-zero}.
Suppose $a : W \to Y$ is a morphism such that $g \circ a = 0$.
Then we get a commutative diagram
$$
\xymatrix{
W \ar[r]_1 \ar@{..>}[d]^b &
W \ar[r] \ar[d]^a &
0 \ar[r] \ar[d]^0 &
W[1] \ar@{..>}[d]^{b[1]} \\
X \ar[r] & Y \ar[r] & Z \ar[r] & X[1]
}
$$
Both rows are distinguished triangles (use TR1 for the top row).
Hence we can fill the dotted arrow $b$ (first rotate using TR2,
then apply TR3, and then rotate back). This proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-third-isomorphism-triangle}
Let $\mathcal{D}$ be a pre-triangulated category.
Let
$$
(a, b, c) : (X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')
$$
be a morphism of distinguished triangles. If two among $a, b, c$
are isomorphisms so is the third.
\end{lemma}

\begin{proof}
Assume that $a$ and $c$ are isomorphisms.
For any object $W$ of $\mathcal{D}$ write
$H_W( - ) = \text{Hom}_{\mathcal{D}}(W, -)$.
Then we get a commutative diagram of abelian groups
$$
\xymatrix{
H_W(Z[-1]) \ar[r] \ar[d] &
H_W(X) \ar[r] \ar[d] &
H_W(Y) \ar[r] \ar[d] &
H_W(Z) \ar[r] \ar[d] &
H_W(X[1]) \ar[d] \\
H_W(Z'[-1]) \ar[r] &
H_W(X') \ar[r] &
H_W(Y') \ar[r] &
H_W(Z') \ar[r] &
H_W(X'[1])
}
$$
By assumption the right two and left two vertical arrows are bijective.
As $H_W$ is homological by
Lemma \ref{lemma-representable-homological}
and the five lemma
(Lemma \ref{lemma-five-lemma})
it follows that the middle vertical arrow is an isomorphism.
Hence by Yoneda's lemma, see
Categories, Lemma \ref{categories-lemma-yoneda}
we see that $b$ is an isomorphism.
This implies the other cases by rotating (using TR2).
\end{proof}

\begin{lemma}
\label{lemma-third-map-square-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let
$$
(0, b, 0), (0, b', 0) : (X, Y, Z, f, g, h) \to (X, Y, Z, f, g, h)
$$
be endomorphisms of a distinguished triangle. Then $bb' = 0$.
\end{lemma}

\begin{proof}
Picture
$$
\xymatrix{
X \ar[r] \ar[d]^0 &
Y \ar[r] \ar[d]^{b, b'} \ar@{..>}[ld]^\alpha &
Z \ar[r] \ar[d]^0 \ar@{..>}[ld]^\beta &
X[1] \ar[d]^0 \\
X \ar[r] & Y \ar[r] & Z \ar[r] & X[1]
}
$$
Applying
Lemma \ref{lemma-third-isomorphism-triangle}
we find dotted arrows $\alpha$ and $\beta$ such that
$b' = f \circ \alpha$ and $b = \beta \circ g$. Then
$bb' = \beta \circ g \circ f \circ \alpha = 0$
as $g \circ f = 0$ by
Lemma \ref{lemma-composition-zero}.
\end{proof}

\begin{lemma}
\label{lemma-third-map-idempotent}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
If
$$
\xymatrix{
Z \ar[r]_f \ar[d]_c & X[1] \ar[d]^{a[1]} \\
Z \ar[r]^f & X[1]
}
$$
is commutative and $a^2 = a$, $c^2 = c$, then there exists a
morphism $b : Y \to Y$ with $b^2 = b$ such that
$(a, b, c)$ is an endomorphism of the triangle $(X, Y, Z, f, g, h)$.
\end{lemma}

\begin{proof}
By TR3 there exists a morphism $b'$ such that
$(a, b', c)$ is an endormorphism of $(X, Y, Z, f, g, h)$.
Then $(0, (b')^2 - b', 0)$ is also an endomorphism. By
Lemma \ref{lemma-third-map-square-zero}
we see that $(b')^2 - b'$ has square zero.
Set $b = b' - (2b' - 1)((b')^2 - b') = 3(b')^2 - 2(b')^3$.
A computation shows that $(a, b, c)$ is an endomorphism and
that $b^2 - b = (4(b')^2 - 4b' - 3)((b')^2 - b')^2 = 0$.
\end{proof}

\begin{lemma}
\label{lemma-cone-triangle-unique-isomorphism}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
There exists a distinguished triangle $(X, Y, Z, f, g, h)$ which
is unique up to (nonunique) isomorphism of triangles.
More precisely, given a second such distinguished triangle
$(X, Y, Z', f, g', h')$ there exists an isomorphism
$$
(1, 1, c) : (X, Y, Z, f, g, h) \longrightarrow (X, Y, Z', f, g', h')
$$
\end{lemma}

\begin{proof}
Existence by TR1. Uniqueness up to isomorphism by TR3 and
Lemma \ref{lemma-third-isomorphism-triangle}.
\end{proof}

\begin{lemma}
\label{lemma-third-object-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item $f$ is an isomorphism,
\item $(X, Y, 0, f, 0, 0)$ is a distinguished triangle, and
\item for any distinguished triangle $(X, Y, Z, f, g, h)$ we have $Z = 0$.
\end{enumerate}
\end{lemma}

\begin{proof}
Immediate from
Lemma \ref{lemma-cone-triangle-unique-isomorphism}
and TR1.
\end{proof}

\begin{lemma}
\label{lemma-direct-sum-triangles}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ be triangles.
The following are equivalent
\begin{enumerate}
\item $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')$
is a distinguished triangle,
\item both $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ are
distinguished triangles.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (2). By TR1 we may choose a distinguished triangle
$(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$.
By TR3 we can find morphisms of distinguished triangles
$(X, Y, Z, f, g, h) \to
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$
and
$(X', Y', Z', f', g', h') \to
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$.
Taking the direct sum of these morphisms
we obtain a morphism of triangles
$$
\xymatrix{
(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')
\ar[d]^{(1, 1, c)} \\
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'').
}
$$
Let $W$ be any object in $\mathcal{D}$ and apply the functor
$H_W = \text{Hom}_{\mathcal{D}}(W, -)$ to this diagram.
By
Lemma \ref{lemma-representable-homological}
(applied three times)
we deduce that $H_W(c) : H_W(Z \oplus Z') \to H_W(Q)$
is an isomorphism. Hence $c$ is an isomorphism and we conclude that
(1) holds.

\medskip\noindent
Assume (1). We will show that $(X, Y, Z, f, g, h)$ is a distinguished
triangle. Let $W$ be any object in $\mathcal{D}$ and set
$H_W = \text{Hom}_{\mathcal{D}}(W, -)$. By
Lemma \ref{lemma-representable-homological}
we see that $H_W(X) \to H_W(Y) \to H_W(Z) \to H_W(Z[1])$ is exact as
it is a direct summand of the exact sequence associated to the distinguished
triangle $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')$. Using TR1 let
$(X, Y, Q, f, g'', h'')$ be a distinguished triangle. By TR3 there exists
a morphism of distinguished triangles
 $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h') \to (X, Y, Q, f, g'', h'')$.
Composing this with the inclusion map we get a morphism of triangles
$$
(1, 1, c) :
(X, Y, Z, f, g, h)
\longrightarrow
(X, Y, Q, f, g'', h'')
$$
Applying $H_W$ and using the above we once again see that
$H_W(c) : H_W(Z) \to H_W(Q)$ is an isomorphism and we conclude that
$c$ is an isomorphism. Hence we win.
\end{proof}

\begin{lemma}
\label{lemma-split}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
\begin{enumerate}
\item If $h = 0$, then there exists a left inverse $s : Z \to Y$ to $g$.
\item For any left inverse $s : Z \to Y$ of $g$ the map
$f \oplus s : X \oplus Z \to Y$ is an isomorphism.
\item For any objects $X', Z'$ of $\mathcal{D}$ the triangle
$(X', X' \oplus Z', Z', (1, 0), (0, 1), 0)$ is distinguished.
\end{enumerate}
\end{lemma}

\begin{proof}
To see (1) use that
$\text{Hom}_{\mathcal{D}}(Z, Y) \to \text{Hom}_{\mathcal{D}}(Z, Z) \to
\text{Hom}_{\mathcal{D}}(Z, X[1])$
is exact by
Lemma \ref{lemma-representable-homological}.
By the same token, if $s$ is as in (2), then $h = 0$ and the sequence
$$
0 \to \text{Hom}_{\mathcal{D}}(W, X) \to \text{Hom}_{\mathcal{D}}(W, Y)
\to \text{Hom}_{\mathcal{D}}(W, Z) \to 0
$$
is split exact (split by $s : Z \to Y$). Hence by Yoneda's lemma we
see that $X \oplus Z \to Y$ is an isomorphism. The last assertion follows
from TR1 and
Lemma \ref{lemma-direct-sum-triangles}.
\end{proof}

\begin{lemma}
\label{lemma-when-split}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item $f$ has a kernel,
\item $f$ has a cokernel,
\item $f$ is isomorphic to a map $K \oplus Z \to Z \oplus Q$
induced by $\text{id}_Z$.
\end{enumerate}
\end{lemma}

\begin{proof}
Any morphism isomorphic to a map of the form
$X' \oplus Z \to Z \oplus Y'$ has both a kernel and a cokernel.
Hence (3) $\Rightarrow$ (1), (2).
Next we prove (1) $\Rightarrow$ (3).
Suppose first that $f : X \to Y$ is a monomorphism, i.e., its kernel is zero.
By TR1 there exists a distinguished triangle $(X, Y, Z, f, g, h)$
and by
Lemma \ref{lemma-representable-homological}
we see that $h = 0$. Then
Lemma \ref{lemma-split}
implies that $Y = X \oplus Z$, i.e., we see that (3) holds.
Next, assume $f$ has a kernel $K$. As $K \to X$ is a monomorphism we
conclude $X = K \oplus X'$ and $f|_{X'} : X' \to Y$ is a monomorphism.
Hence $Y = X' \oplus Y'$ and we win.
The implication (2) $\Rightarrow$ (3) is dual to this.
\end{proof}

\begin{lemma}
\label{lemma-projectors-have-images}
Let $\mathcal{D}$ be an additive category which has countable products
and has kernels of maps which have a left inverse. Then $\mathcal{D}$
has kernels of idempotents.
\end{lemma}

\begin{proof}
Let $\mathcal{D}$ be an additive category. Let $X$ be an object of
$\mathcal{D}$ and let $e : X \to X$ be an idempotent. Then
functor
$$
W \longmapsto \text{Ker}(
\text{Mor}_{\mathcal{D}}(W, X)
\xrightarrow{e}
\text{Mor}_{\mathcal{D}}(W, X)
)
$$
if representable if and only if $e$ has a kernel. Note that for any
abelian group $A$ and idempotent endomorphism $e : A \to A$ we have
$$
\text{Ker}(e : A \to A)
= \text{Ker}(\Phi :
\prod\nolimits_{n \in \mathbf{N}} A
\to
\prod\nolimits_{n \in \mathbf{N}} A
)
$$
where
$$
\Phi(a_1, a_2, a_3, \ldots) = (ea_1 + (1 - e)a_2, ea_2 + (1 - e)a_3, \ldots)
$$
Moreover, $\Phi$ has the left inverse
$$
\Psi(a_1, a_2, a_3, \ldots) =
(a_1, (1 - e)a_1 + ea_2, (1 - e)a_2 + ea_3, \ldots).
$$
Hence if $\mathcal{D}$ has countable products and kernels of maps which
have a left inverse, then we see that kernel of $e$ exists.
\end{proof}

\begin{lemma}
\label{lemma-projectors-have-images-triangulated}
Let $\mathcal{D}$ be a pre-triangulated category.
If $\mathcal{D}$ has countable products, then $\mathcal{D}$
has kernels of idempotents.
If $\mathcal{D}$ has countable coproducts, then $\mathcal{D}$
has kernels of idempotents.
\end{lemma}

\begin{proof}
Assume $\mathcal{D}$ has countable products. Then it suffices to
check that morphisms which have a left inverse have kernels.
Any morphism which has a left inverse is an epimorphism, hence
has a kernel by
Lemma \ref{lemma-when-split}.
The second statement is dual to the first.
\end{proof}

\noindent
The following lemma makes it slightly easier to prove that a
pre-triangulated category is triangulated.

\begin{lemma}
\label{lemma-easier-axiom-four}
Let $\mathcal{D}$ be a pre-triangulated category.
In order to prove TR4 it suffices to show that given
any pair of composable morphisms
$f : X \to Y$ and $g : Y \to Z$ there exist
\begin{enumerate}
\item isomorphisms $i : X' \to X$, $j : Y' \to Y$ and
$k : Z' \to Z$, and then setting $f' = j^{-1}fi : X' \to Y'$ and
$g' = k^{-1}gj : Y' \to Z'$ there exist
\item distinguished triangles
$(X', Y', Q_1, f', p_1, d_1)$,
$(X', Z', Q_2, g' \circ f', p_2, d_2)$
and
$(Y', Z', Q_3, g', p_3, d_3)$,
such that the assertion of TR4 holds.
\end{enumerate}
\end{lemma}

\begin{proof}
The replacement of $X, Y, Z$ by $X', Y', Z'$ is harmless by our
definition of distinguished triangles and their isomorphisms.
The lemma follows from the fact that the distinguished triangles
$(X', Y', Q_1, f', p_1, d_1)$,
$(X', Z', Q_2, g' \circ f', p_2, d_2)$
and
$(Y', Z', Q_3, g', p_3, d_3)$
are unique up to isomorphism by
Lemma \ref{lemma-cone-triangle-unique-isomorphism}.
\end{proof}

\begin{lemma}
\label{lemma-triangulated-subcategory}
Let $\mathcal{D}$ be a pre-triangulated category.
Assume that $\mathcal{D}'$ is an additive full subcategory of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item there exists a set of triangles $\mathcal{T}'$ such that
$(\mathcal{D}', \mathcal{T}')$ is a pre-triangulated subcategory
of $\mathcal{D}$,
\item $\mathcal{D}'$ is preserved under $[1], [-1]$ and
given any morphism $f : X \to Y$ in $\mathcal{D}'$ there exists
a distinguished triangle $(X, Y, Z, f, g, h)$ in $\mathcal{D}$
such that $Z$ is isomorphic to an object of $\mathcal{D}'$.
\end{enumerate}
In this case $\mathcal{T}'$ is the set of distinguished triangles
$(X, Y, Z, f, g, h)$ of $\mathcal{D}$ such that
$X, Y, Z \in \text{Ob}(\mathcal{D}')$ and
$f, g, h \in \text{Arrows}(\mathcal{D}')$. Finally, if $\mathcal{D}$
is a triangulated category, then (1) and (2) are also equivalent to
\begin{enumerate}
\item[(3)] $\mathcal{D}'$ is a triangulated subcategory.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-exact-functor-additive}
An exact functor of pre-triangulated categories is additive.
\end{lemma}

\begin{proof}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of
pre-triangulated categories. Since
$(0, 0, 0, 1_0, 1_0, 0)$ is a distinguished triangle of $\mathcal{D}$
the triangle
$$
(F(0), F(0), F(0), 1_{F(0)}, 1_{F(0)}, F(0))
$$
is distinguished in $\mathcal{D}'$.
This implies that $1_{F(0)} \circ 1_{F(0)}$ is zero, see
Lemma \ref{lemma-composition-zero}.
Hence $F(0)$ is the zero object of $\mathcal{D}'$. This also implies
that $F$ applied to any zero morphism is zero (since a morphism in
an additive category is zero if and only if it factors through the
zero objet). Next, using that
$(X, X \oplus Y, Y, (1, 0), (0, 1), 0)$ is a distinguished triangle,
we see that $(F(X), F(X \oplus Y), F(Y), F(1, 0), F(0, 1), 0)$ is
one too. This implies that the map
$F(1, 0) \oplus F(0, 1) : F(X) \oplus F(Y) \to F(X \oplus Y)$
is an isomorphism, see
Lemma \ref{lemma-split}.
We omit the rest of the argument.
\end{proof}

\noindent
The proof of the following result uses TR4.

\begin{proposition}
\label{proposition-9}
Let $\mathcal{D}$ be a triangulated category. Any commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d] & Y \ar[d] \\
X' \ar[r] & Y'
}
$$
can be extended to a diagram
$$
\xymatrix{
X \ar[r] \ar[d] & Y \ar[r] \ar[d] & Z \ar[r] \ar[d] & X[1] \ar[d] \\
X' \ar[r] \ar[d] & Y' \ar[r] \ar[d] & Z' \ar[r] \ar[d] & X'[1] \ar[d] \\
X'' \ar[r] \ar[d] & Y'' \ar[r] \ar[d] & Z'' \ar[r] \ar[d] & X''[1] \ar[d] \\
X[1] \ar[r] & Y[1] \ar[r] & Z[1] \ar[r] & X[2]
}
$$
where all the squares are commutative, except for the lower right square
which is anticommutative. Moreover, each of the rows and columns are
distinguished triangles. Finally, the morphisms on the bottom row
(resp.\ right column) are obtained from the morphisms of the top row
(resp.\ left column) by applying $[1]$.
\end{proposition}

\begin{proof}
During this proof we avoid writing the arrows in order to make the proof
legible. Choose distinguished triangles
$(X, Y, Z)$, $(X', Y', Z')$, $(X, X', X'')$, $(Y, Y', Y'')$, and
and $(X, Y', A)$. Note that the morphism $X \to Y'$ is both equal
to the composition $X \to Y \to Y'$ and equal to the composition
$X \to X' \to Y'$. Hence, we can find morphisms
\begin{enumerate}
\item $a : Z \to A$ and $b : A \to Y''$, and
\item $a' : X'' \to A$ and $b' : A \to Z'$
\end{enumerate}
as in TR4. Denote $c : Y'' \to Z[1]$ the composition
$Y'' \to Y[1] \to Z[1]$ and denote $c' : Z' \to X''[1]$ the composition
$Z' \to X'[1] \to X''[1]$. The conclusion of our application TR4
are that
\begin{enumerate}
\item $(Z, A, Y'', a, b, c)$, $(X'', A, Z', a', b', c')$
are distinguished triangles,
\item $(X, Y, Z) \to (X, Y', A)$,
$(X, Y', A) \to (Y, Y', Y'')$,
$(X, X', X'') \to (X, Y', A)$,
$(X, Y', A) \to (X', Y', Z')$
are morphisms of triangles.
\end{enumerate}
First using that
$(X, X', X'') \to (X, Y', A)$ and $(X, Y', A) \to (Y, Y', Y'')$.
are morphisms of triangles we see the first of the commutative diagrams
$$
\xymatrix{
X' \ar[r] \ar[d] & Y' \ar[d] \\
X'' \ar[r]^{b \circ a'} \ar[d] & Y'' \ar[d] \\
X[1] \ar[r] & Y[1] 
}
\quad\quad
\xymatrix{
Y \ar[r] \ar[d] & Z \ar[d]^{b' \circ a} \ar[r] & X[1] \ar[d] \\
Y' \ar[r] & Z' \ar[r] & X'[1]
}
$$
is commutative. The second is commutative too using that
$(X, Y, Z) \to (X, Y', A)$ and $(X, Y', A) \to (X', Y', Z')$ are morphisms
of triangles. At this point we choose a distinguished triangle
$(X'', Y'' , Z'')$ starting with the map $b \circ a' : X'' \to Y''$.

\medskip\noindent
Next we apply TR4 one more time to the morphisms
$X'' \to A \to Y''$ and the triangles
$(X'', A, Z', a', b', c')$,
$(X'', Y'', Z'')$, and
$(A, Y'', Z[1], b, c , -a[1])$ to get morphisms
$a'' : Z' \to Z''$ and $b'' : Z'' \to Z[1]$.
Then $(Z', Z'', Z[1], a'', b'', - b'[1] \circ a[1])$ is a distinguished
triangle, hence also $(Z, Z', Z'', -b' \circ a, a'', -b'')$
and hence also $(Z, Z', Z'', b' \circ a, a'', b'')$.
Moreover, $(X'', A, Z') \to (X'', Y'', Z'')$ and
$(X'', Y'', Z'') \to (A, Y'', Z[1], b, c , -a[1])$
are morphisms of triangles.
At this point we have defined all the distinguished triangles
and all the morphisms, and all that's left is to verify some
commutativity relations.

\medskip\noindent
To see that the middle square in the diagram commutes, note
that the arrow $Y' \to Z'$ factors as $Y' \to A \to Z'$
because $(X, Y', A) \to (X', Y', Z')$ is a morphism of triangles.
Similarly, the morphism $Y' \to Y''$ factors as
$Y' \to A \to Y''$ because $(X, Y', A) \to (Y, Y', Y'')$ is a
morphism of triangles. Hence the middle square commutes because
the square with sides $(A, Z', Z'', Y'')$ commutes as
$(X'', A, Z') \to (X'', Y'', Z'')$ is a morphism of triangles (by TR4).
The square with sides $(Y'', Z'', Y[1], Z[1])$ commutes
because $(X'', Y'', Z'') \to (A, Y'', Z[1], b, c , -a[1])$
is a morphism of triangles and $c : Y'' \to Z[1]$ is the composition
$Y'' \to Y[1] \to Z[1]$.
The square with sides $(Z', X'[1], X''[1], Z'')$ is commutative
because $(X'', A, Z') \to (X'', Y'', Z'')$ is a morphism of triangles
and $c' : Z' \to X''[1]$ is the composition $Z' \to X'[1] \to X''[1]$.
Finally, we have to show that the square with sides
$(Z'', X''[1], Z[1], X[2])$ anticommutes. This holds because
$(X'', Y'', Z'') \to (A, Y'', Z[1], b, c , -a[1])$
is a morphism of triangles and we're done.
\end{proof}









\section{Triangulated categories: Localization}
\label{section-localization}

\noindent
In order to construct the derived category starting from the homotopy
category of compexes, we will use a localization process.

\begin{definition}
\label{definition-localization}
Let $\mathcal{D}$ be a pre-triangulated category. We say a multiplicative
system $S$ is {\it compatible with the triangulated structure} if
the following two conditions hold:
\begin{enumerate}
\item[MS5] For $s \in S$ we have $s[n] \in S$ for all $n \in \mathbf{Z}$.
\item[MS6] Given a solid commutative square
$$
\xymatrix{
X \ar[r] \ar[d]^s &
Y \ar[r] \ar[d]^{s'} &
Z \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{s[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
whose rows are distinguished triangles with $s, s' \in S$
there exists a morphism $s'' : Z \to Z'$ in $S$ such that
$(s, s', s'')$ is a morphism of triangles.
\end{enumerate}
\end{definition}

\noindent
It turns out that these axioms are not independent of the
axioms defining multiplicative systems.

\begin{lemma}
\label{lemma-localization-conditions}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $S$ be a set of morphisms of $\mathcal{D}$ and assume that axioms
MS1, MS5, MS6 hold (see
Categories, Definition \ref{categories-definition-multiplicative-system}
and
Definition \ref{definition-localization}).
Then MS2 holds.
\end{lemma}

\begin{proof}
Suppose that $f : X \to Y$ is a morphism of $\mathcal{D}$ and
$t : X \to X'$ an element of $S$. Choose a distinguished triangle
$(X, Y, Z, f, g, h)$. Next, choose a distinguished triangle
$(X', Y', Z, f', g', t[1] \circ h)$ (here we use TR1 and TR2).
By MS5, MS6 (and TR2 to rotate) we can find the dotted arrow
in the commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^t &
Y \ar[r] \ar@{..>}[d]^{s'} &
Z \ar[r] \ar[d]^1 &
X[1] \ar[d]^{t[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z \ar[r] &
X'[1]
}
$$
with moreover $s' \in S$. This proves LMS2. The proof of RMS2 is dual.
\end{proof}

\begin{lemma}
\label{lemma-triangle-functor-localize}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of
pre-triangulated categories.  Let
$$
S = \{f \in \text{Arrows}(\mathcal{D})
\mid F(f)\text{ is an isomorphism}\}
$$
Then $S$ is a saturated multiplicative system compatible with the
triangulated structure on $\mathcal{D}$.
\end{lemma}

\begin{proof}
We have to prove axioms MS1 -- MS6, see
Categories, Definitions \ref{categories-definition-multiplicative-system} and
\ref{categories-definition-saturated-multiplicative-system}
and
Definition \ref{definition-localization}.
MS1, MS4, and MS5 are direct from the definitions. MS6 follows from TR3 and
Lemma \ref{lemma-third-isomorphism-triangle}.
By
Lemma \ref{lemma-localization-conditions}
we conclude that MS2 holds. To finish the proof we have to show that
MS3 holds. To do this let $f, g : X \to Y$ be morphisms of $\mathcal{D}$,
and let $t : Z \to X$ be an element of $S$ such that $f \circ t = g \circ t$.
As $\mathcal{D}$ is additive this simply means that $a \circ t = 0$ with
$a = f - g$. Choose a distinguished triangle $(Z, X, Q, t, g, h)$ using
TR1 and TR2. Since $a \circ t = 0$ we see by
Lemma \ref{lemma-representable-homological}
there exists a morphism $i : Q \to Y$ such that $i \circ g = a$.
Finally, using TR1 again we can choose a triangle
$(Q, Y, W, i, j, k)$. Here is a picture
$$
\xymatrix{
Z \ar[r]_t & X \ar[r]_g \ar[d]^1 & Q \ar[r] \ar[d]^i & Z[1] \\
& X \ar[r]_a & Y \ar[d]^j \\
& & W
}
$$
OK, and now we apply the functor $F$ to this diagram.
Since $t \in S$ we see that $F(Q) = 0$, see
Lemma \ref{lemma-third-object-zero}.
Hence $F(j)$ is an isomorphism by the same lemma, i.e., $j \in S$.
Finally, $j \circ a = j \circ i \circ g = 0$ as $j \circ i = 0$.
Thus $j \circ f = j \circ g$ and we see that LMS3 holds.
The proof of RMS3 is dual.
\end{proof}

\begin{lemma}
\label{lemma-triangle-functor-kernel}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of
pre-triangulated categories. Let $\mathcal{D}''$ be the full subcategory
of $\mathcal{D}$ with objects
$$
\text{Ob}(\mathcal{D}'') =
\{X \in \text{Ob}(\mathcal{D}) \mid F(X) = 0\}
$$
Then $\mathcal{D}''$ is a strictly full pre-triangulated subcategory of
$\mathcal{D}$. If $\mathcal{D}$ is a triangulated category, then
$\mathcal{D}''$ is a triangulated subcategory.
Moreover, if $X \oplus Y \in \text{Ob}(\mathcal{D}'')$
then $X, Y \in \text{Ob}(\mathcal{D}'')$.
\end{lemma}

\begin{proof}
It is clear that $\mathcal{D}''$ is preserved under $[1]$ and $[-1]$.
If $(X, Y, Z, f, g, h)$ is a distinguished triangle of $\mathcal{D}$
and $F(X) = F(Y) = 0$, then also $F(Z) = 0$ as
$(F(X), F(Y), F(Z), F(f), F(g), F(h))$ is distinguished.
Hence we may apply
Lemma \ref{lemma-triangulated-subcategory}
to see that $\mathcal{D}''$ is a pre-triangulated subcategory (respectively
a triangulated subcategory if $\mathcal{D}$ is a triangulated category).
The final assertion follows from
$F(X) \oplus F(Y) = 0 \Rightarrow F(X) = F(Y) = 0$.
\end{proof}

\noindent
The proof of the following lemma uses TR4.

\begin{lemma}
\label{lemma-construct-multiplicative-system}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{D}' \subset \mathcal{D}$ be a full triangulated
subcategory. Set
\begin{equation}
\label{equation-multiplicative-system}
S =
\left\{
\begin{matrix}
f \in \text{Arrows}(\mathcal{D})
\text{ such that there exists a distinguished triangle }\\
(X, Y, Z, f, g, h) \text{ of }\mathcal{D}\text{ with }
Z\text{ isomorphic to an object of }\mathcal{D}'
\end{matrix}
\right\}
\end{equation}
Then $S$ is a multiplicative system compatible with the triangulated
structure on $\mathcal{D}$. In this situation the following are equivalent
\begin{enumerate}
\item $S$ is a saturated multiplicative system,
\item If $X \oplus Y$ is isomorphic to an object of $\mathcal{D}'$
then both $X$ and $Y$ are isomorphic to objects of $\mathcal{D}'$.
\end{enumerate}
\end{lemma}

\begin{proof}
To prove the first assertion we have to prove that
MS1, MS2, MS3 and MS5, MS6 hold.

\medskip\noindent
Proof of MS1. It is clear that identities are in $S$ because
$(X, X, 0, 1, 0, 0)$ is distinguished for every object $X$ of $\mathcal{D}$
and because $0$ is an object of $\mathcal{D}'$. Let $f : X \to Y$
and $g : Y \to Z$ be composable morphisms contained in $S$.
Choose distinguished triangles $(X, Y, Q_1, f, p_1, d_1)$,
$(X, Z, Q_2, g \circ f, p_2, d_2)$, and $(Y, Z, Q_3, g, p_3, d_3)$.
By assumption we know that $Q_1$ and $Q_3$ are isomorphic to objects
of $\mathcal{D}'$. By TR4 we know there exists a distinguished
triangle $(Q_1, Q_2, Q_3, a, b, c)$. Since $\mathcal{D}'$ is a
triangulated subcategory we conclude that $Q_2$ is isomorphic to
an object of $\mathcal{D}'$. Hence $g \circ f \in S$.

\medskip\noindent
Proof of MS3. Let $a : X \to Y$ be a morphism and let $t : Z \to X$ be
an element of $S$ such that $a \circ t = 0$. To prove LMS3 we have to
find a $s \in S$ such that $s \circ a = 0$. Choose a distinguished
triangle $(Z, X, Q, t, g, h)$ using TR1 and TR2. Since $a \circ t = 0$
we see by
Lemma \ref{lemma-representable-homological}
there exists a morphism $i : Q \to Y$ such that $i \circ g = a$.
Finally, using TR1 again we can choose a triangle
$(Q, Y, W, i, j, k)$. Here is a picture
$$
\xymatrix{
Z \ar[r]_t & X \ar[r]_g \ar[d]^1 & Q \ar[r] \ar[d]^i & Z[1] \\
& X \ar[r]_a & Y \ar[d]^j \\
& & W
}
$$
Since $t \in S$ we see that $Q$ is isomorphic to an object of $\mathcal{D}'$.
Hence $j \in S$. Finally, $j \circ a = j \circ i \circ g = 0$ as
$j \circ i = 0$. Thus $j \circ f = j \circ g$ and we see that LMS3 holds.
The proof of RMS3 is dual.

\medskip\noindent
Proof of MS5. Follows as distinguished triangles and $\mathcal{D}'$
are stable under translations

\medskip\noindent
Proof of MS6. Suppose given a commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^s &
Y \ar[d]^{s'} \\
X' \ar[r] &
Y'
}
$$
with $s, s' \in S$. By
Proposition \ref{proposition-9}
we can extend this to a nine square diagram. As $s, s'$ are elments of $S$
we see that $X'', Y''$ are isomorphic to objects of $\mathcal{D}'$.
Since $\mathcal{D}'$ is a full triangulated subcategory we see that
$Z''$ is also an object of $\mathcal{D}'$. Whence the morphism $Z' \to Z''$
is an element of $S$. This proves MS6.

\medskip\noindent
MS2 is a formal consquence of MS1, MS5, and MS6, see
Lemma \ref{lemma-localization-conditions}.
This finishes the proof of the first assertion of the lemma.

\medskip\noindent
Let's assume that $S$ is saturated. (In the following we will use
rotation of distinguished triangles without further mention.)
Let $X \oplus Y$ be an object isomorphic to an object of $\mathcal{D}'$.
Consider the morphism $f : 0 \to X$. The composition
$0 \to X \to X \oplus Y$ is an element
of $S$ as $(0, X \oplus Y, X \oplus Y, 0, 1, 0)$ is a distinguished
triangle. The composition $Y[-1] \to 0 \to X$ is an element of $S$
as $(X, X \oplus Y, Y, (1, 0), (0, 1), 0)$ is a distinguished triangle, see
Lemma \ref{lemma-split}.
Hence $0 \to X$ is an element of $S$ (as $S$ is saturated).
Thus $X$ is isomorphic to an object of $\mathcal{D}'$ as desired.

\medskip\noindent
Finally, assume $\mathcal{D}'$ satisfies condition (2) of the lemma.
Let
$$
W \xrightarrow{h}
X \xrightarrow{g}
Y \xrightarrow{f} Z
$$
be composable morphisms of $\mathcal{D}$ such that $fg, gh \in S$.
We will build up a picture of objects as in the diagram below.
$$
\xymatrix{
 & &
Q_{12} \ar[ld]_{\!+\!1} & &
Q_{23} \ar[ld]_{\!+\!1} \ar[ll]_{\!+\!1} \\
 &
Q_1 \ar[ld]_{\!+\!1} & &
Q_2 \ar[ld]_{\!+\!1} \ar[ll]_{\!+\!1} \ar[lu] & &
Q_3 \ar[ld]_{\!+\!1} \ar[ll]_{\!+\!1} \ar[lu] \\
W \ar[rr] & &
X \ar[lu] \ar[rr] & &
Y \ar[lu] \ar[rr] & &
Z \ar[lu]
}
$$
First choose distinguished triangles
$(W, X, Q_1)$, $(X, Y, Q_2)$, $(Y, Z, Q_3)$ $(W, Y, Q_{12})$, and
$(X, Z, Q_{23})$. Denote $s : Q_2 \to Q_1[1]$ the composition
$Q_2 \to X[1] \to Q_1[1]$. Denote $t : Q_3 \to Q_2[1]$ the
composition $Q_3 \to Y[1] \to Q_2[1]$.
By TR4 applied to the composition $W \to X \to Y$
and the composition $X \to Y \to Z$ there exist
a distinguished triangles $(Q_1, Q_{12}, Q_2)$ and $(Q_2, Q_{23}, Q_3)$
which use the morphisms $s$ and $t$.
The objects $Q_{12}$ and $Q_{23}$ are isomorphic to objects of
$\mathcal{D}'$ as $W \to Y$ and $X \to Z$ are assumed in $S$.
Hence also $s[1]t$ is an element of $S$ as $S$ is closed under compositions
and shifts.
Note that $s[1]t = 0$ as $Y[1] \to Q_2[1] \to X[2]$ is zero, see
Lemma \ref{lemma-composition-zero}.
Hence $Q_3 \oplus Q_1[2]$ is isomorphic to an object of $\mathcal{D}'$, see
Lemma \ref{lemma-split}.
By assumption on $\mathcal{D}'$ we conclude that $Q_3, Q_1$ are isomorphic
to objects of $\mathcal{D}'$. Looking at the distinguished triangle
$(Q_1, Q_{12}, Q_2)$ we conclude that $Q_2$ is also isomorphic to
an object of $\mathcal{D}'$. Looking at the distinguished triangle
$(X, Y, Q_2)$ we finally conclude that $g \in S$. (It is also
follows that $h, f \in S$, but we don't need this.)
\end{proof}






\section{Homotopy category}
\label{section-homotopy}

\noindent
Let $\mathcal{A}$ be an additive category. The homotopy category
$K(\mathcal{A})$ of $\mathcal{A}$ is the the category of complexes of
$\mathcal{A}$ with morphisms given by morphisms of complexes up to homotopy.
Here is the formal definition.

\begin{definition}
\label{definition-complexes-notation}
Let $\mathcal{A}$ be an additive category.
\begin{enumerate}
\item We set $\text{Comp}(\mathcal{A}) = \text{CoCh}(\mathcal{A})$
be the {\it category of (cochain) complexes}.
\item A complex $K^\bullet$ is said to be
{\it bounded below} if $K^n = 0$ for all $n \ll 0$.
\item A complex $K^\bullet$ is said to be
{\it bounded above} if $K^n = 0$ for all $n \gg 0$.
\item A complex $K^\bullet$ is said to be
{\it bounded} if $K^n = 0$ for all $|n| \gg 0$.
\item We let
$\text{Comp}^{+}(\mathcal{A})$, $\text{Comp}^{-}(\mathcal{A})$,
resp.\ $\text{Comp}^b(\mathcal{A})$ be the full subcategory
of $\text{Comp}(\mathcal{A})$ whose objects are the complexes
which are bounded below, bounded above, resp.\ bounded.
\item We let $K(\mathcal{A})$ be the category with the same objects
as $\text{Comp}(\mathcal{A})$ but as morphisms homotopy classes of
maps of complexes (see
Lemma \ref{lemma-compose-homotopy-cochain}).
\item We let $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$,
resp.\ $K^b(\mathcal{A})$ be the full subcategory of $K(\mathcal{A})$
whose objects are bounded below, bounded above, resp.\ bounded
complexes of $\mathcal{A}$.
\end{enumerate}
\end{definition}

\noindent
It will turn out that the categories $K(\mathcal{A})$,
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
are triangulated categories. To prove this we first develop
some machinery related to cones and split exact sequences.




\section{Homotopy category: Cones and termwise split sequences}
\label{section-cones}

\noindent
Let $\mathcal{A}$ be an additive category, and let
$K(\mathcal{A})$ denote the category of complexes of
$\mathcal{A}$ with morphisms given by morphisms of
complexes up to homotopy. In this section we show that
there is a natural structure of a triangulated category on
$K(\mathcal{A})$. Note that the shift functors
$[n]$ on complexes, see Definition \ref{definition-shift-cochain},
give rise to functors $[n] : K(\mathcal{A}) \to K(\mathcal{A})$
such that $[n] \circ [m] = [n + m]$ and $[0] = \text{id}$.

\begin{definition}
\label{definition-cone}
Let $\mathcal{A}$ be an additive category.
Let $f : K^\bullet \to L^\bullet$ be a morphism of
complexes of $\mathcal{A}$. The {\it cone} of $f$
is the complex $C(f)^\bullet$ given by
$C(f)^n = L^n \oplus K^{n + 1}$ and
differential
$$
d_{C(f)}^n =
\left(
\begin{matrix}
d^n_L & f^{n + 1} \\
0 & -d_K^{n + 1}
\end{matrix}
\right)
$$
It comes equipped with canonical morphisms of complexes
$i : L^\bullet \to C(f)^\bullet$ and $p : C(f)^\bullet \to K^\bullet[1]$
induced by the obvious maps $L^n \to C(f)^n \to K^{n + 1}$.
\end{definition}

\noindent
In other words $(K, L, C(f), f, i, p)$ forms a triangle:
$$
K^\bullet \to L^\bullet \to C(f)^\bullet \to K^\bullet[1]
$$
The formation of this triangle is
functorial in the following sense.

\begin{lemma}
\label{lemma-functorial-cone}
Suppose that
$$
\xymatrix{
K_1^\bullet \ar[r]_{f_1} \ar[d]_a & L_1^\bullet \ar[d]^b \\
K_2^\bullet \ar[r]^{f_2} & L_2^\bullet
}
$$
is a diagram of morphisms of complexes which is commutative
up to homotopy. Then there exists a morphism
$c : C(f_1)^\bullet \to C(f_2)^\bullet$ which gives rise to
a morphism of triangles
$(a, b, c) : (K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_1, i_1, p_1)
\to
(K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_2, i_2, p_2)$
of $K(\mathcal{A})$.
\end{lemma}

\begin{proof}
Let $h^n : K_1^n \to L_2^{n - 1}$ be a family of morphisms such that
$f_2 \circ a - b \circ f_1 = d \circ h + h \circ d$.
Define $c^n$ by the matrix
$$
c^n =
\left(
\begin{matrix}
a^n & h^{n + 1} \\
0 & b^n
\end{matrix}
\right) :
L_1^n \oplus K_1^{n + 1} \to L_2^n \oplus K_2^{n + 1}
$$
A matrix computation show that $c$ is a morphism of complexes.
It is trivial that $c \circ i_1 = i_2 \circ b$, and it is
trivial also to check that $p_2 \circ c = a \circ p_1$.
\end{proof}

\noindent
Note that the morphism $c : C(f_1)^\bullet \to C(f_2)^\bullet$
constructed in the
proof of Lemma \ref{lemma-functorial-cone} in general depends on the
chosen homotopy $h$ between $f_2 \circ a$ and $b \circ f_1$.

\begin{definition}
\label{definition-termwise-split-map}
Let $\mathcal{A}$ be an additive category.
A {\it termwise split injection $\alpha : A^\bullet \to B^\bullet$}
is a morphism of complexes such that each $A^n \to B^n$
is isomorphic to the inclusion of a direct summand.
A {\it termwise split surjection $\beta : B^\bullet \to C^\bullet$}
is a morphism of complexes such that each $B^n \to C^n$
is isomorphic to the projection onto a direct summand.
\end{definition}

\begin{lemma}
\label{lemma-make-commute-map}
Let $\mathcal{A}$ be an additive category.
Let
$$
\xymatrix{
A^\bullet \ar[r]_f \ar[d]_a & B^\bullet \ar[d]^b \\
C^\bullet \ar[r]^g & D^\bullet
}
$$
be a diagram of morphisms of complexes commuting up to homotopy.
If $f$ is a split injection, then $b$ is homotopic to a
morphism which makes the diagram commute.
If $g$ is a split surjection, then $a$ is homotopic to a
morphism which makes the diagram commute.
\end{lemma}

\begin{proof}
Let $h^n : A^n \to D^{n - 1}$ be a collection of morphisms
such that $bf - ga = dh + hd$. Let
Suppose that $\pi^n : B^n \to A^n$
are morphisms splitting the morphisms $f^n$.
Take $b' = b + dh\pi + h\pi d$.
Suppose $s^n : D^n \to C^n$ are morphisms splitting the morphisms
$g^n : C^n \to D^n$. Take $a' = a + dsh + shd$.
Computations omitted.
\end{proof}


\noindent
The following lemma can be used to replace an morphism of complexes
by a morphism where in each degree the map is the injection of a
direct summand.

\begin{lemma}
\label{lemma-make-injective}
Let $\mathcal{A}$ be an additive category.
Let $\alpha : K^\bullet \to L^\bullet$ be a morphism
of complexes of $\mathcal{A}$.
There exists a factorization
$$
\xymatrix{
K^\bullet \ar[r]^{\tilde \alpha} \ar@/_1pc/[rr]_\alpha &
\tilde L^\bullet \ar[r]^\pi &
L^\bullet
}
$$
such that
\begin{enumerate}
\item $\tilde \alpha$ is a termwise split injection (see
Definition \ref{definition-termwise-split-map}),
\item there is a map of complexes $s : L^\bullet \to \tilde L^\bullet$
such that $\pi \circ s = \text{id}_{L^\bullet}$ and such that
$s \circ \pi$ is homotopic to $\text{id}_{\tilde L^\bullet}$.
\end{enumerate}
\end{lemma}

\begin{proof}
We set
$$
\tilde L^n = L^n \oplus K^n \oplus K^{n + 1}
$$
and we define
$$
d^n_{\tilde L} =
\left(
\begin{matrix}
d^n_L & 0 & 0 \\
0 & d^n_K & \text{id}_{K^{n + 1}} \\
0 & 0 & -d^{n + 1}_K
\end{matrix}
\right)
$$
Moreover, we set
$$
\tilde \alpha =
\left(
\begin{matrix}
\alpha \\
\text{id}_{K^n} \\
0
\end{matrix}
\right)
$$
which is clearly a split injection. It is also clear that it defines a morphism
of complexes. We define
$$
\pi =
\left(
\begin{matrix}
\text{id}_{L^n} &
0 &
0
\end{matrix}
\right)
$$
so that clearly $\pi \circ \tilde \alpha = \alpha$. We set
$$
s =
\left(
\begin{matrix}
\text{id}_{L^n} \\
0 \\
0
\end{matrix}
\right)
$$
so that $\pi \circ s = \text{id}_{L^\bullet}$. Finally,
let $h^n : \tilde L^n \to \tilde L^{n - 1}$ be the map
which maps the summand $K^n$ of $L^n$ via the identity morphism
to the summand $K^n$ of $L^{n - 1}$. Then it is a trivial matter
(see computations in remark below) to prove that
$$
\text{id}_{\tilde L^\bullet} - s \circ \pi
=
d \circ h + h \circ d
$$
which finishes the proof of the lemma.
\end{proof}

\begin{remark}
\label{remark-compute-modules}
To see the last displayed equality in the proof above we can argue
with elements as follows. We have
$s\pi(l, k, k^{+}) = (l, 0, 0)$.
Hence the morphism of the left hand side maps
$(l, k, k^{+})$ to $(0, k, k^{+})$.
On the other hand $h(l, k, k^{+}) = (0, 0, k)$ and
$d(l, k, k^{+}) = (dl, dk + k^{+}, -dk^{+})$.
Hence $(dh + hd)(l, k, k^{+}) =
d(0, 0, k) + h(dl, dk + k^{+}, -dk^{+}) =
(0, k, -dk) + (0, 0, dk + k^{+}) = (0, k, k^{+})$
as desired.
\end{remark}

\begin{definition}
\label{definition-split-ses}
Let $\mathcal{A}$ be an additive category.
A {\it termwise split sequence of complexes of $\mathcal{A}$}
is a complex of complexes
$$
0 \to
A^\bullet \xrightarrow{\alpha}
B^\bullet \xrightarrow{\beta}
C^\bullet \to 0
$$
together with given direct sum decompositions
$B^n = A^n \oplus C^n$
compatible with $\alpha^n$ and $\beta^n$.
We often write $s^n : C^n \to B^n$ and $\pi^n : B^n \to A^n$
for the maps induced by the direct sum decompositions.
According to Lemma \ref{lemma-ses-termwise-split-cochain}
we get an associated morphism of complexes
$$
\delta : C^\bullet \longrightarrow A^\bullet[1]
$$
which in degree $n$ is the map $\pi^{n + 1} \circ d_C^n \circ s^n$.
In other words
$(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
forms a triangle
$$
A^\bullet \to B^\bullet \to C^\bullet \to A^\bullet[1]
$$
This will be the {\it triangle associated to the termwise
split sequence of complexes}.
\end{definition}

\begin{lemma}
\label{lemma-make-commute}
Let $\mathcal{A}$ be an additive category.
Let $0 \to A_i^\bullet \to B_i^\bullet \to C_i^\bullet \to 0$, $i = 1, 2$
be termwise split exact sequences. Suppose that
$a : A_1^\bullet \to A_2^\bullet$,
$b : B_1^\bullet \to B_2^\bullet$, and
$c : C_1^\bullet \to C_2^\bullet$ are morphisms of complexes
such that
$$
\xymatrix{
A_1^\bullet \ar[d]_a \ar[r] &
B_1^\bullet \ar[r] \ar[d]_b &
C_1^\bullet \ar[d]_c \\
A_2^\bullet \ar[r] & B_2^\bullet \ar[r] & C_2^\bullet
}
$$
commutes in $K(\mathcal{A})$. Then there exists a morphism
$b' : B_1^\bullet \to B_2^\bullet$
which is homotopic to $b$ such that the diagram above commutes
in the category of complexes.
\end{lemma}

\begin{proof}
Let $f^n : A_1^n \to B_2^{n - 1}$ be a collection of morphisms
such that $b \circ \alpha_1 - \alpha_2 \circ a =
d  \circ f + f \circ d$. Let
$g^n : B_1^n \to C_2^{n - 1}$ be a collection of morphisms
such that $c \circ \beta_1 - \beta_2 \circ b =
d  \circ g + g \circ d$. Suppose that
$\pi^n : B_1^n \to A_1^n$ (resp.\ $s^n : C_2^n \to B_2^n$)
are the morphisms splitting the morphisms $\alpha_1^n$
(resp.\ $\beta_2^n$). Set $h^n = - f^n \circ \pi^n + s^{n - 1} \circ g^n$.
Take $b' = b + d \circ h + h \circ d$. Computation omitted.
\end{proof}

\begin{lemma}
\label{lemma-third-isomorphism}
Let $\mathcal{A}$ be an additive category.
Let $f_1 : K_1^\bullet \to L_1^\bullet$ and
$f_2 : K_2^\bullet \to L_2^\bullet$ be morphisms of complexes.
Let $(a, b, c) : (K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_1, i_1, p_1)
\to  (K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_2, i_2, p_2)$
be any morphism of triangles of $K(\mathcal{A})$.
If $a$ and $b$ are homotopy equivalences then so is $c$.
\end{lemma}

\begin{proof}
Let $a^{-1} : K_2^\bullet \to K_1^\bullet$ be a morphism of complexes which
is inverse to $a$ in $K(\mathcal{A})$.
Let $b^{-1} : L_2^\bullet \to L_1^\bullet$ be a morphism of complexes which
is inverse to $b$ in $K(\mathcal{A})$.
Let $c' : C(f_2)^\bullet \to C(f_1)^\bullet$
be the morphism from Lemma \ref{lemma-functorial-cone} applied
to $f_1 \circ a^{-1} = b^{-1} \circ f_2$. If we can show that
$c \circ c'$ and $c' \circ c$ are isomorphisms in $K(\mathcal{A})$
then we win. Hence it suffices to prove the following: Given
a morphism of triangles
$(1, 1, c) : (K^\bullet, L^\bullet, C(f)^\bullet, f, i, p)$
the morphism $c$ is an isomorphism in $K(\mathcal{A})$.
By assumption the two squares in the diagram
$$
\xymatrix{
L^\bullet \ar[r] \ar[d]_1 &
C(f)^\bullet \ar[r] \ar[d]_c &
K^\bullet[1] \ar[d]_1 \\
L^\bullet \ar[r] &
C(f)^\bullet \ar[r] &
K^\bullet[1]
}
$$
commute up to homotopy. By construction of $C(f)^\bullet$ the rows
form termwise split sequences of complexes.
By Lemma \ref{lemma-make-commute} we may replace $c$ by
a morphism homotopic to $c$ such that the diagram commutes in the
category of complexes. In this case each $c^n$ is an isomorphism
(because an upper triangular matrix with $1$'s on the diagonal is invertible).
\end{proof}

\noindent
Hence if $a$ and $b$ are homotopy equivalences then
the resulting morphism of triangles is an isomorphism of triangles
in $K(\mathcal{A})$.
It turns out that the collection of triangles of $K(\mathcal{A})$
given by cones and the collection of triangles of $K(\mathcal{A})$
given by termwise split sequences of complexes are the same
up to isomorphisms, at least up to sign!

\begin{lemma}
\label{lemma-the-same-up-to-isomorphisms}
Let $\mathcal{A}$ be an additive category.
\begin{enumerate}
\item Given a termwise split sequence of complexes
$(\alpha : A^\bullet \to B^\bullet,
\beta : B^\bullet \to C^\bullet, s^n, \pi^n)$
there exists a homotopy equivalence $C(\alpha)^\bullet \to C^\bullet$
such that the diagram
$$
\xymatrix{
A^\bullet \ar[r] \ar[d] & B^\bullet \ar[d] \ar[r] &
C(\alpha)^\bullet \ar[r]_{-p} \ar[d] & A^\bullet[1] \ar[d] \\
A^\bullet \ar[r] & B^\bullet \ar[r] &
C^\bullet \ar[r]^\delta & A^\bullet[1]
}
$$
defines an isomorphism of triangles in $K(\mathcal{A})$.
\item Given a morphism of complexes $f : K^\bullet \to L^\bullet$
there exists an isomorphism of triangles
$$
\xymatrix{
K^\bullet \ar[r] \ar[d] & \tilde L^\bullet \ar[d] \ar[r] &
M^\bullet \ar[r]_{\delta} \ar[d] & K^\bullet[1] \ar[d] \\
K^\bullet \ar[r] & L^\bullet \ar[r] &
C(f)^\bullet \ar[r]^{-p} & K^\bullet[1]
}
$$
where the upper triangle is the triangle associated to a
termwise split exact sequence $K^\bullet \to \tilde L^\bullet \to M^\bullet$.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). We have $C(\alpha)^n = B^n \oplus A^{n + 1}$
and we simply define $C(\alpha)^n \to C^n$ via the projection
onto $B^n$ followed by $\beta^n$. This defines
a morphism of complexes because the compositions
$A^{n + 1} \to B^{n + 1} \to B^n \to C^n$ are zero.
To get a homotopy inverse we take
$C^\bullet \to C(\alpha)^\bullet$ given by
$(s^n , -\delta^n)$ in degree $n$. This is a morphism of complexes
because the morphism $\delta^n$ can be characterized as the
unique morphism $C^n \to A^{n + 1}$ such that
$d \circ s^n - s^{n + 1} \circ d = \alpha \circ \delta^n$,
see proof of Lemma \ref{lemma-ses-termwise-split-cochain}. The composition
$C^\bullet \to C(f)^\bullet \to C^\bullet$ is the identity.
The composition $C(f)^\bullet \to C^\bullet \to C(f)^\bullet$
is equal to the morphism
$$
\left(
\begin{matrix}
s^n \circ \beta^n & 0 \\
-\delta^n \circ \beta^n & 0
\end{matrix}
\right)
$$
To see that this is homotopic to the identity map
use the homotopy $h^n : C(\alpha)^n \to C(\alpha)^{n - 1})$
given by the matrix
$$
\left(
\begin{matrix}
0 & 0 \\
\pi^n & 0
\end{matrix}
\right) : C(\alpha)^n = B^n \oplus A^{n + 1} \to
B^{n - 1} \oplus A^n = C(\alpha)^{n - 1}
$$
It is trivial to verify that
$$
\left(
\begin{matrix}
1 & 0 \\
0 & 1
\end{matrix}
\right)
-
\left(
\begin{matrix}
s^n &
-\delta^n
\end{matrix}
\right)
\left(
\begin{matrix}
\beta^n \\
0
\end{matrix}
\right)
=
\left(
\begin{matrix}
d & \alpha^{n + 1} \\
0 & -d
\end{matrix}
\right)
\left(
\begin{matrix}
0 & 0 \\
\pi^n & 0
\end{matrix}
\right)
+
\left(
\begin{matrix}
0 & 0 \\
\pi^{n + 1} & 0
\end{matrix}
\right)
\left(
\begin{matrix}
d & \alpha^{n + 1} \\
0 & -d
\end{matrix}
\right)
$$
To finish the proof of (1) we have to show that the morphisms
$-p : C(\alpha)^\bullet \to A^\bullet[1]$ (see
Definition \ref{definition-cone})
and  $C(\alpha)^\bullet \to C^\bullet \to A^\bullet[1]$ agree up
to homotopy. This is clear from the above. Namely, we can use the homotopy
inverse $(s, -\delta) : C^\bullet \to C(\alpha)^\bullet$
and check instead that the two maps
$C^\bullet \to A^\bullet[1]$ agree. And note that
$p \circ (s, -\delta) = -\delta$ as desired.

\medskip\noindent
Proof of (2). We let $\tilde f : K^\bullet \to \tilde L^\bullet$,
$s : L^\bullet \to \tilde L^\bullet$
and $\pi : L^\bullet \to L^\bullet$ be as in
Lemma \ref{lemma-make-injective}. By Lemmas \ref{lemma-functorial-cone}
and \ref{lemma-third-isomorphism}
the triangles $(K^\bullet, L^\bullet, C(f), i, p)$ and
$(K^\bullet, \tilde L^\bullet, C(\tilde f), \tilde i, \tilde p)$
are isomorphic. Note that we can compose isomorphisms of
triangles. Thus we may replace $L^\bullet$ by
$\tilde L^\bullet$ and $f$ by $\tilde f$. In other words
we may assume that $f$ is a termwise split injection.
In this case the result follows from part (1).
\end{proof}


\begin{lemma}
\label{lemma-sequence-maps-split}
Let $\mathcal{A}$ be an additive category.
Let $A_1^\bullet \to A_2^\bullet \to \ldots \to A_n^\bullet$
be a sequence of composable morphisms of complexes.
There exists a commutative diagram
$$
\xymatrix{
A_1^\bullet \ar[r] &
A_2^\bullet \ar[r] &
\ldots \ar[r] &
A_n^\bullet \\
B_1^\bullet \ar[r] \ar[u] &
B_2^\bullet \ar[r] \ar[u] &
\ldots \ar[r] &
B_n^\bullet \ar[u]
}
$$
such that each morphism $B_i^\bullet \to B_{i + 1}^\bullet$
is a split injection and each $B_i^\bullet \to A_i^\bullet$
is a homotopy equivalence.
\end{lemma}

\begin{proof}
The case $n = 1$ is without content.
Lemma \ref{lemma-make-injective} is the case $n = 2$.
Suppose we have constructed the diagram
except for $B_n$. Applying Lemma \ref{lemma-make-injective} to
the composition $B_{n - 1} \to A_{n - 1} \to A_n$.
The result is a factorization $B_{n - 1} \to \tilde B_n \to A_n$
as desired.
\end{proof}


\begin{lemma}
\label{lemma-rotate-triangle}
Let $\mathcal{A}$ be an additive category. Let
$(\alpha : A^\bullet \to B^\bullet, \beta : B^\bullet \to C^\bullet, s^n,
\pi^n)$ be a termwise split sequence of complexes.
Let $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
be the associated triangle.
Then the triangle
$(C^\bullet[-1], A^\bullet, B^\bullet, \delta[-1], \alpha, \beta)$
is isomorphic to the triangle
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, p)$.
\end{lemma}

\begin{proof}
We write $B^n = A^n \oplus C^n$ and we identify $\alpha^n$ and $\beta^n$
with the natural inclusion and projection maps. By construction of $\delta$ we
have
$$
d_B^n =
\left(
\begin{matrix}
d_A^n & \delta^n \\
0 & d_C^n
\end{matrix}
\right)
$$
On the other hand the cone of $\delta[-1] : C^\bullet[-1] \to A^\bullet$
is given as $C(\delta[-1])^n = A^n \oplus C^n$ with differential identical
with the matrix above! Whence the lemma.
\end{proof}

\begin{lemma}
\label{lemma-rotate-cone}
Let $\mathcal{A}$ be an additive category.
Let $f : K^\bullet \to L^\bullet$ be a morphism of complexes.
The triangle $(L^\bullet, C(f)^\bullet, K^\bullet[1], i, p, f[1])$ is
the triangle associated to the termwise split sequence
$$
0 \to L^\bullet \to C(f)^\bullet \to K^\bullet[1] \to 0
$$
coming from the definition of the cone of $f$.
\end{lemma}

\begin{proof}
Immediate from the definitions.
\end{proof}



\section{Homotopy category: Distinguished triangles}
\label{section-homotopy-triangulated}

\noindent
Since we want our boundary maps in long exact sequences of cohomology
to be given by the maps in the snake lemma without signs we define
distinguished triangles as follows.

\begin{definition}
\label{definition-distinguished-triangle}
Let $\mathcal{A}$ be an additive category.
A triangle $(X, Y, Z, f, g, h)$ of $K(\mathcal{A})$ is
called a {\it distinguished triangle of $K(\mathcal{A})$}
if it is isomorphic to the triangle associated to
a termwise split exact sequence of complexes, see Definition
\ref{definition-split-ses}.
Same definition for $K^{+}(\mathcal{A})$.
\end{definition}

\noindent
Note that according to Lemma \ref{lemma-the-same-up-to-isomorphisms}
a triangle of the form $(K^\bullet, L^\bullet, C(f)^\bullet, f, i, -p)$
is a distinguished triangle.
This does indeed lead to a triangulated category, see
Proposition \ref{lemma-the-same-up-to-isomorphisms}.
Before we can prove the proposition we need one more lemma
in order to be able to prove TR4.

\begin{lemma}
\label{lemma-two-split-injections}
Let $\mathcal{A}$ be an additive category. Suppose that
$\alpha : A^\bullet \to B^\bullet$ and $\beta : B^\bullet \to C^\bullet$
are split injections of complexes. Then there exist distinguished triangles
$(A^\bullet, B^\bullet, Q_1^\bullet, \alpha, p_1, d_1)$,
$(A^\bullet, C^\bullet, Q_2^\bullet, \beta \circ \alpha, p_2, d_2)$
and
$(B^\bullet, C^\bullet, Q_3^\bullet, \beta, p_3, d_3)$
for which TR4 holds.
\end{lemma}

\begin{proof}
Say $\pi_1^n : B^n \to A^n$, and $\pi_3^n : C^n \to B^n$ are the splittings.
Then also $A^\bullet \to C^\bullet$ is a split injection with splittings
$\pi_2^n = \pi_1^n \circ \pi_3^n$. Let us write $Q_1^\bullet$, $Q_2^\bullet$
and $Q_3^\bullet$ for the ``quotient'' complexes. In other words,
$Q_1^n = \text{Ker}(\pi_1^n)$, $Q_3^n = \text{Ker}(\pi_3^n)$ and
$Q_2^n = \text{Ker}(\pi_2^n)$. Note that the kernels exist. Then
$B^n = A^n \oplus Q_1^n$ and $C_n = B^n \oplus Q_3^n$, where we think of $A^n$
as a subobject of $B^n$ and so on. This implies
$C^n = A^n \oplus Q_1^n \oplus Q_3^n$. Note that
$\pi_2^n = \pi_1^n \circ \pi_3^n$ is zero on both $Q_1^n$ and $Q_3^n$. Hence
$Q_2^n = Q_1^n \oplus Q_3^n$. Consider the commutative diagram
$$
\begin{matrix}
0 & \to & A^\bullet & \to & B^\bullet & \to & Q_1^\bullet & \to & 0 \\
  &     & \downarrow&     & \downarrow&     & \downarrow  & \\
0 & \to & A^\bullet & \to & C^\bullet & \to & Q_2^\bullet & \to & 0 \\
  &     & \downarrow&     & \downarrow&     & \downarrow  & \\
0 & \to & B^\bullet & \to & C^\bullet & \to & Q_3^\bullet & \to & 0
\end{matrix}
$$
The rows of this diagram are termwise split exact sequences, and
hence determine distinguished triangles by
definition. Moreover downward arrows in the diagram above
are compatible with the chosen splittings and hence
define morphisms of triangles
$$
(A^\bullet \to B^\bullet \to Q_1^\bullet \to A^\bullet[1])
\longrightarrow
(A^\bullet \to C^\bullet \to Q_2^\bullet \to A^\bullet[1])
$$
and
$$
(A^\bullet \to C^\bullet \to Q_2^\bullet \to A^\bullet[1])
\longrightarrow
(B^\bullet \to C^\bullet \to Q_3^\bullet \to B^\bullet[1])
$$
by our specific choice of the splitting of the middle row
in the large displayed diagram above.
Note that the splittings $Q_3^n \to C^n$
of the bottom split sequence in the diagram provides a splitting
for the split sequence
$0 \to Q_1^\bullet \to Q_2^\bullet \to Q_3^\bullet \to 0$
upon composing with $C^n \to Q_2^n$. It follows easily from this
that the morphism $\delta : Q_3^\bullet \to Q_1^\bullet[1]$
in the corresponding distinguished triangle
$$
(Q_1^\bullet \to Q_2^\bullet \to Q_3^\bullet \to Q_1^\bullet[1])
$$
is equal to the composition $Q_3^\bullet \to B^\bullet[1] \to Q_1^\bullet[1]$.
Hence we get a structure as in the conclusion of axiom TR4.
\end{proof}

\begin{proposition}
\label{proposition-homotopy-category-triangulated}
Let $\mathcal{A}$ be an additive category.
The category $K(\mathcal{A})$ of complexes up to
homotopy with its natural translation functors
and distinguished triangles as defined above
is a triangulated category. Same statement for
$K^{+}(\mathcal{A})$.
\end{proposition}

\begin{proof}
Proof of TR1. By definition every triangle isomorphic to a distinguished
one is distinguished. Also, any triangle $(A^\bullet, A^\bullet, 0, 1, 0, 0)$
is distinguished since $0 \to A^\bullet \to A^\bullet \to 0 \to 0$ is
a termwise split sequence of complexes. Finally, given any morphism of
complexes $f : K^\bullet \to L^\bullet$ the triangle
$(K, L, C(f), f, i, -p)$ is distinguished by
Lemma \ref{lemma-the-same-up-to-isomorphisms}.

\medskip\noindent
Proof of TR2. Let $(X, Y, Z, f, g, h)$ be a triangle.
Assume $(Y, Z, X[1], g, h, -f[1])$ is distinguished.
Then there exists a termwise split sequence of complexes
$A^\bullet \to B^\bullet \to C^\bullet$ such that the associated
triangle $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
is isomorphic to $(Y, Z, X[1], g, h, -f[1])$. Rotating back we see
that $(X, Y, Z, f, g, h)$ is isomorphic to
$(C^\bullet[-1], A^\bullet, B^\bullet, -\delta[-1], \alpha, \beta)$.
It follows from Lemma \ref{lemma-rotate-triangle} that the triangle
$(C^\bullet[-1], A^\bullet, B^\bullet, \delta[-1], \alpha, \beta)$
is isomorphic to
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, p)$.
Precomposing the previous isomorphism of triangles with $-1$ on $Y$
it follows that $(X, Y, Z, f, g, h)$ is isomorphic to
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, -p)$.
Hence it is distinguished by
Lemma \ref{lemma-the-same-up-to-isomorphisms}.
On the other hand, suppose that $(X, Y, Z, f, g, h)$ is distinguished.
By Lemma \ref{lemma-the-same-up-to-isomorphisms} this means that it is
isomorphic to a triangle of the form
$(K^\bullet, L^\bullet, C(f), f, i, -p)$ for some morphism of
complexes $f$. Then the rotated triangle $(Y, Z, X[1], g, h, -f[1])$ is
isomorphic to $(L^\bullet, C(f), K^\bullet[1], i, -p, -f[1])$ which is
isomorphic to the triangle $(L^\bullet, C(f), K^\bullet[1], i, p, f[1])$.
By Lemma \ref{lemma-rotate-cone} this triangle is distinguished.
Hence $(Y, Z, X[1], g, h, -f[1])$ is distinguished as desired.

\medskip\noindent
Proof of TR3. Let
$(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$
be distinguished triangles of $K(\mathcal{A})$
and let $a : X \to X'$ and $b : Y \to Y'$ be morphisms
such that $f' \circ a = b \circ f$. By Lemma \ref{lemma-functorial-cone}
we may assume that
$(X, Y, Z, f, g, h) = (X, Y, C(f), f, i, p)$ and
$(X', Y', Z', f', g', h') = (X', Y', C(f'), f', i', p')$.
At this point we simply apply Lemma \ref{lemma-functorial-cone}
to the commutative diagram given by $f, f', a, b$.

\medskip\noindent
Proof of TR4. At this point we know that $K(\mathcal{A})$
is a pre-triangulated category. Hence we can use
Lemma \ref{lemma-easier-axiom-four}. Let $A^\bullet \to B^\bullet$
and $B^\bullet \to C^\bullet$ be composable morphisms of
$K(\mathcal{A})$. By Lemma \ref{lemma-sequence-maps-split} we may assume that
$A^\bullet \to B^\bullet$ and $B^\bullet \to C^\bullet$
are split injective morphisms. In this case the result follows
from Lemma \ref{lemma-two-split-injections}.

\medskip\noindent
For the proof of the stament on $K^{+}(\mathcal{A})$, note that
the cone construction applied to a morphism of bounded below
complexes produces a bounded below complex. Similarly, given a termwise
split sequence of complexes such that two out of the three complexes
are bounded below then the third one is as well. In this way
we see that the arguments for the case of $K(\mathcal{A})$ apply
to $K^{+}(\mathcal{A})$ as well. Details omitted.
\end{proof}










\section{Injective resolutions}
\label{section-injective-resolutions}

\noindent
In this section we prove some lemmas regarding the existence
of injective resolutions in abelian categories having enough injectives.

\medskip\noindent
Given an object $A$ of an abelian category $\mathcal{A}$ we get a complex
$$
A[0] = ( \ldots \to 0 \to A \to 0 \to \ldots )
$$
where $A$ is placed in degree zero. Hence a natural functor
$\mathcal{A} \to \text{Comp}(\mathcal{A})$, $A \mapsto A[0]$.

\begin{definition}
\label{definition-injective-resolution}
Let $\mathcal{A}$ be an abelian category.
Let $A \in \text{Ob}(\mathcal{A})$.
An {\it injective resolution of $A$} is a complex
$I^\bullet$ together with a map $A \to I^0$ such
that:
\begin{enumerate}
\item We have $I^n = 0$ for $n < 0$.
\item Each $I^n$ is an injective object of $\mathcal{A}$.
\item The map $A \to I^0$ is an isomorphism onto $\text{Ker}(d^0)$.
\item We have $H^i(I^\bullet) = 0$ for $i > 0$.
\end{enumerate}
Hence $A[0] \to I^\bullet$ is a quasi-isomorphism.
In other words the complex
$$
\ldots \to 0 \to A \to I^0 \to I^1 \to \ldots
$$
is acyclic.
Let $K^\bullet$ be a complex in $\mathcal{A}$.
An {\it injective resolution of $K^\bullet$} is a complex
$I^\bullet$ together with a map $\alpha : K^\bullet \to I^\bullet$
of complexes such that
\begin{enumerate}
\item We have $I^n = 0$ for $n \ll 0$, i.e., $I^\bullet$ is bounded below.
\item Each $I^n$ is an injective object of $\mathcal{A}$.
\item The map $\alpha : K^\bullet \to I^\bullet$ is a
quasi-isomorphism.
\end{enumerate}
\end{definition}

\noindent
In other words an injective resolution $K^\bullet \to I^\bullet$
gives rise to a diagram
$$
\xymatrix{
\ldots \ar[r] & K^{n - 1} \ar[d] \ar[r] & K^n \ar[d] \ar[r] &
K^{n + 1} \ar[d] \ar[r] & \ldots \\
\ldots \ar[r] & I^{n - 1} \ar[r] & I^n \ar[r] & I^{n + 1} \ar[r] & \ldots
}
$$
which induces an isomorphism on cohomology objects in each degree.
An injective resolution of an object $A$ of $\mathcal{A}$
is almost the same thing as an injective resolution of
the complex $A[0]$.

\begin{lemma}
\label{lemma-cohomology-bounded-below}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a complex of $\mathcal{A}$.
\begin{enumerate}
\item If $K^\bullet$ has an injective resolution then
$H^n(K^\bullet) = 0$ for $n \ll 0$.
\item If $H^n(K^\bullet) = 0$ for all $n \ll 0$ then there
exists a quasi-isomorphism $K^\bullet \to L^\bullet$
with $L^\bullet$ bounded below.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted. For the second statement use
$L^\bullet = K^\bullet / \tau_{\leq n}K^\bullet$ for
some $n \ll 0$. See Section \ref{section-truncations} for
the definition of the truncation $\tau_{\leq n}$.
\end{proof}

\begin{lemma}
\label{lemma-injective-resolutions-exist}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
\begin{enumerate}
\item Any object of $\mathcal{A}$ has an injective resolution.
\item If $H^n(K^\bullet) = 0$ for all $n \ll 0$ then
$K^\bullet$ has an injective resolution.
\item If $K^\bullet$ is bounded below then there exists
an injective resolution $\alpha : K^\bullet \to I^\bullet$
such that each $\alpha^n : K^n \to I^n$ is injective.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). First choose an injection $A \to I^0$ of $A$ into an
injective object of $\mathcal{A}$. Next, choose an injection
$I_0/A \to I^1$ into an injective object of $\mathcal{A}$.
Denote $d^0$ the induced map $I^0 \to I^1$.
Next, choose an injection $I^1/\text{Im}(d^0) \to I^2$ into
an injective object of $\mathcal{A}$. Denote $d^1$ the induced
map $I^1 \to I^2$. And so on.

\medskip\noindent
By Lemma \ref{lemma-cohomology-bounded-below} part (2) follows from part (3).

\medskip\noindent
Proof of (3). Consider the following induction hypothesis
$IH_n$: There are $I^j$, $j \leq n$ injective objects almost
all zero, maps $d^j : I^j \to I^{j + 1}$ for $j < n$
and injective maps $\alpha^j : K^j \to I^j$ for $j \leq n$
such that the diagram
$$
\xymatrix{
\ldots \ar[r] & K^{n - 1} \ar[d]^\alpha \ar[r] &
K^n \ar[d]^\alpha \ar[r] &
K^{n + 1} \ar[r] & \ldots \\
\ldots \ar[r] & I^{n - 1} \ar[r] & I^n &  &
}
$$
is commutative, such that $d^j \circ d^{j - 1} = 0$ for $j < n$
and such that $\alpha$ induces isomorphisms
$H^j(K^\bullet) \to \text{Ker}(d^j)/\text{Im}(d^{j - 1})$
for $j < n$. Note that this implies
\begin{equation}
\label{equation-star}
\alpha(\text{Im}(d^{n - 1}))
\subset
\alpha(\text{Ker}(d^n)) \cap d^{n - 1}(I^{n - 1})
\end{equation}
and
\begin{equation}
\label{equation-star-star}
\alpha(\text{Im}(d^{n - 1}))
\subset
\alpha(K^n) \cap d^{n - 1}(I^{n - 1}).
\end{equation}
If these inclusions are not equalities, then choose an injection
$K^n/\text{Im}(d^{n - 1}) \to I$ into an injective object $I$.
Denote $\alpha' : K^n \to I$ the induced map.
Replace $I^n$ by $\tilde I^n = I^n \oplus I$. Use the
map $(d^{n - 1}, 0) : I^{n - 1} \to I^n \oplus I$ and use
the map $(\alpha^n , \alpha') : K^n \to I^n \oplus I$.
It is easy to see that after these replacements we have
equality in Equations (\ref{equation-star}) and (\ref{equation-star-star}).
Once this is the
case consider the diagram
$$
\xymatrix{
K^n/\text{Ker}(d^n) \ar[r] \ar[d] & K^{n + 1} \\
I^n/(d^{n - 1}(L^{n - 1}) + \alpha(\text{Ker}(d^n))) &
}
$$
Both the horizontal and the vertical arrows are injective.
Hence the push-out $M$ of this diagram contains both
$K^{n + 1}$ and $I^n/(d^{n - 1}(L^{n - 1}) + \alpha(\text{Ker}(d^n)))$
as subobjects. Choose an injection $M \to I^{n + 1}$.
By construction we get $d^n : I^n \to I^{n + 1}$
and an injective map $\alpha^{n + 1} : K^{n + 1} \to I^{n + 1}$.
The equality in Equation (\ref{equation-star}) and the construction of
$d^{n + 1}$ garantee that $\alpha : H^n(K^\bullet) \to
\text{Ker}(d^n)/\text{Im}(d^{n - 1})$ is an isomorphism.
In other words $IH_{n + 1}$ holds.

\medskip\noindent
We finish the proof of (3) by the following observations.
First we note that $IH_n$ is true for all $n << 0$ since
we can just take $I_j = 0$ for $j \leq n$ in this case.
Next, we note that in the proof of $IH_n \Rightarrow IH_{n + 1}$
we only modified the object $I^n$, the map $d^{n - 1}$ and
the map $\alpha^n$. Hence we see that proceding by induction
we produce a definite complex $I^\bullet$ which is bounded below
and consists of injective objects, and a termwise
injective quasi-isomorphism $\alpha : K^\bullet \to I^\bullet$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-lift}
Let $\mathcal{A}$ be an abelian category.
Consider a solid diagram
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_\gamma & L^\bullet \ar@{-->}[dl]^\beta \\
I^\bullet
}
$$
where $I^\bullet$ is bounded below and consists of injective
objects, and $\alpha$ is a quasi-isomorphism.
\begin{enumerate}
\item There exists a map of complexes $\beta$ making the diagram
commute up to homotopy.
\item If $\alpha$ is injective in every degree
then we can find a $\beta$ which makes the diagram commute.
\end{enumerate}
\end{lemma}

\begin{proof}
We first show that (2) implies (1). Namely, let
$\tilde \alpha : K \to \tilde L^\bullet$, $\pi$, $s$ be as in
Lemma \ref{lemma-make-injective}. Since $\tilde \alpha$ is injective
by (2) there exists a morphism $\tilde \beta : \tilde L^\bullet \to I^\bullet$
such that $\gamma = \tilde \beta \circ \tilde \alpha$. Set
$\beta = \tilde \beta \circ s$. Then we have
$$
\beta \circ \alpha
=
\tilde \beta \circ s \circ \pi \circ \tilde \alpha
\sim
\tilde \beta \circ \tilde \alpha
=
\gamma
$$
as desired.

\medskip\noindent
Assume that $\alpha : K^\bullet \to L^\bullet$ is injective.
Suppose we have already defined $\beta$ in all degrees
$\leq n - 1$ compatible with differentials and such that
$\gamma^j = \beta^j \circ \alpha^j$ for all $j \leq n - 1$.
Consider the commutative solid diagram
$$
\xymatrix{
K^{n - 1} \ar[r] \ar@/_2pc/[dd]_\gamma \ar[d]^\alpha &
K^n \ar@/^2pc/[dd]^\gamma \ar[d]^\alpha \\
L^{n - 1} \ar[r] \ar[d]^\beta &
L^n \ar@{-->}[d] \\
I^{n - 1} \ar[r] &
I^n
}
$$
Thus we see that the dotted arrow is prescribed on the subobjects
$\alpha(K^n)$ and $d^{n - 1}(L^{n - 1})$. Moreover, these two arrows
agree on $\alpha(d^{n - 1}(K^{n - 1}))$. Hence if
\begin{equation}
\label{equation-qis}
\alpha(d^{n - 1}(K^{n - 1}))
=
\alpha(K^n) \cap d^{n - 1}(L^{n - 1})
\end{equation}
then these morphisms glue to a morphism
$\alpha(K^n) + d^{n - 1}(L^{n - 1}) \to I^n$ and, using the injectivity
of $I^n$, we can extend this to a morphism from all of $L^n$ into $I^n$.
After this by induction we get the morphism $\beta$ for all $n$ simlutaneously
(note that we can set $\beta^n = 0$ for all $n \ll 0$ since $I^\bullet$
is bounded below -- in this way starting the induction).

\medskip\noindent
It remains to prove the equality (\ref{equation-qis}).
The reader is encouraged to argue this for themselves with a suitable
diagram chase. Nonetheless here is our argument.
Note that the inclusion
$\alpha(d^{n - 1}(K^{n - 1})) \subset \alpha(K^n) \cap d^{n - 1}(L^{n - 1})$
is obvious. Take an object $T$ of $\mathcal{A}$ and a morphism
$x : T \to L^n$ whose image is contained in the subobject
$\alpha(K^n) \cap d^{n - 1}(L^{n - 1})$.
Since $\alpha$ is injective we see that $x = \alpha \circ x'$ for
some $x' : T \to K^n$. Moreover, since $x$ lies in $d^{n - 1}(L^{n - 1})$
we see that $d^n \circ x = 0$. Hence using injectivity of $\alpha$ again
we see that $d^n \circ x' = 0$. Thus $x'$ gives a morphism
$[x'] : T \to H^n(K^\bullet)$. On the other hand the corresponding
map $[x] : T \to H^n(L^\bullet)$ induced by $x$ is zero by assumption.
Since $\alpha$ is a quasi-isomorphism we conclude that $[x'] = 0$.
This of course means exactly that the image of $x'$ is
contained in $d^{n - 1}(K^{n - 1})$ and we win.
\end{proof}

\begin{lemma}
\label{lemma-acyclic-is-zero}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be an acyclic complex.
Let $I^\bullet$ be bounded below and consisting of injective objects.
Any morphism $K^\bullet \to I^\bullet$ is homotopic to zero.
\end{lemma}

\begin{proof}
Let $\alpha : K^\bullet \to I^\bullet$ be a morphism of
complexes. Assume that $\alpha^j = 0$ for $j < n$.
We will show that there exists a morphism $h : K^{n + 1} \to I^n$
such that $\alpha^n = h \circ d$. Thus $\alpha$ will be homotopic
to the morphism of complexes $\beta$ defined by
$$
\beta^j =
\left\{
\begin{matrix}
0 & \text{if} & j \leq n \\
\alpha^{n + 1} - d \circ h & \text{if} & j = n + 1 \\
\alpha^j & \text{if} & j > n + 1
\end{matrix}
\right.
$$
This will clearly prove the lemma (by induction).
To prove the existence of $h$ note that
$\alpha^n|_{d^{n - 1}(K^{n - 1})} = 0$ since
$\alpha^{n - 1} = 0$. Since $K^\bullet$ is acyclic we
have $d^{n - 1}(K^{n - 1}) = \text{Ker}(K^n \to K^{n + 1})$.
Hence we can think of $\alpha^n$ as a map into $I^n$ defined
on the subobject $\text{Im}(K^n \to K^{n + 1})$ of $K^{n + 1}$.
By injectivity of the object $I^n$ we can extend this to
a map $h : K^{n + 1} \to I^n$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-equal-up-to-homotopy}
Let $\mathcal{A}$ be an abelian category.
Consider a solid diagram
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_\gamma & L^\bullet \ar@{-->}[dl]^{\beta_i} \\
I^\bullet
}
$$
where $I^\bullet$ is bounded below and consists of injective
objects, and $\alpha$ is a quasi-isomorphism.
Any two morphisms $\beta_1, \beta_2$ making the diagram commute
up to homotopy are homotopic.
\end{lemma}

\begin{proof}
Let $\tilde \alpha : K \to \tilde L^\bullet$, $\pi$, $s$ be as in
Lemma \ref{lemma-make-injective}. If we can show that $\beta_1 \circ\pi$
is homotopic to $\beta_2 \circ \pi$, then we deduce that
$\beta_1 \sim \beta_2$ because $\pi \circ s$ is the identity.
Hence we may assume $\alpha^n : K^n \to L^n$ is the
inclusion of a direct summand for all $n$. Thus we get a
short exact sequence of complexes
$$
0 \to K^\bullet \to L^\bullet \to M^\bullet \to 0
$$
which is termwise split and such that $M^\bullet$ is acyclic.
We choose splittings $L^n = K^n \oplus M^n$, so we have
$\beta_i^n : K^n \oplus M^n \to I^n$ and $\gamma^n : K^n \to I^n$.
In this case the condition on $\beta_i$ is that there are morphisms
$h_i^n : K^n \to I^{n - 1}$ such that
$$
\gamma^n - \beta_i^n|_{K^n} = d \circ h_i^n + h_i^{n + 1} \circ d
$$
Thus we see that
$$
\beta_1^n|_{K^n} - \beta_2^n|_{K^n}
=
d \circ (h_1^n - h_2^n) + (h_1^{n + 1} - h_2^{n + 1}) \circ d
$$
Consider the map $h^n : K^n \oplus M^n \to I^{n - 1}$ which
equals $h_1^n - h_2^n$ on the first summand and zero on the second.
Then we see that
$$
\beta_1^n - \beta_2^n
-
(d \circ h^n + h^{n + 1}) \circ d)
$$
is a morphism of complexes $L^\bullet \to I^\bullet$
which is identically zero on the subcomplex $K^\bullet$.
Hence it factors as $L^\bullet \to M^\bullet \to I^\bullet$.
Thus the result of the lemma follows from Lemma \ref{lemma-acyclic-is-zero}.
\end{proof}

\begin{lemma}
\label{lemma-injective-resolution-ses}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
For any short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
of $\text{Comp}^{+}(\mathcal{A})$ there exists a
commutative diagram in $\text{Comp}^{+}(\mathcal{A})$
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I_1^\bullet \ar[r] &
I_2^\bullet \ar[r] &
I_3^\bullet \ar[r] &
0
}
$$
where the vertical arrows are injective resolutions and
the rows are short exact sequences of complexes.
In fact, given any quasi-isomorphism $A^\bullet \to I^\bullet$
we may assume $I_1^\bullet = I^\bullet$.
\end{lemma}

\begin{proof}
Step 1. Choose an injective resolution $A^\bullet \to I^\bullet$ (see
Lemma \ref{lemma-injective-resolutions-exist}) or use the given one.
Recall that $\text{Comp}^{+}(\mathcal{A})$ is an
abelian category, see Lemma \ref{lemma-cat-cochain-abelian}.
Hence we may form the pushout along
the injective map $A^\bullet \to I^\bullet$ to get
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I^\bullet \ar[r] &
E^\bullet \ar[r] &
C^\bullet \ar[r] &
0
}
$$
Note that the lower short exact sequence is termwise split, see
Lemma \ref{lemma-characterize-injectives}. Hence it suffices to
prove the lemma when
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$ is
termwise split.

\medskip\noindent
Step 2. Choose splittings. In other words, write
$B^n = A^n \oplus C^n$. Denote $\delta : C^\bullet \to A^\bullet[1]$
the morphism as in Lemma \ref{lemma-ses-termwise-split-cochain}. Choose
injective resolutions $f_1 : A^\bullet \to I_1^\bullet$
and $f_3 : C^\bullet \to I_3^\bullet$. (If $A^\bullet$ is a complex of
injectives, then use $I_1^\bullet = A^\bullet$.)
We may assume $f_3$ is injective in
every degree. By Lemma \ref{lemma-morphisms-lift} we may find
a morphism $\delta' : I_3^\bullet \to I_1^\bullet[1]$ such
that $\delta' \circ f_3 = f_1[1] \circ \delta$ (equality of
morphisms of complexes). Set $I_2^n = I_1^n \oplus I_3^n$.
Define
$$
d_{I_2}^n =
\left(
\begin{matrix}
d_{I_1}^n & (\delta')^n \\
0 & d_{I_3}^n
\end{matrix}
\right)
$$
and define the maps $B^n \to I_2^n$ to be given as the
sum of the maps $A^n \to I_1^n$ and $C^n \to I_3^n$.
Everything is clear.
\end{proof}














\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
