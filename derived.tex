\input{preamble}

% OK, start here.
%
\begin{document}

\title{Derived Categories}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
We first discuss triangulated categories and localization in triangulated
categories. Next, we prove that the homotopy category of complexes in an
additive category is a triangulated category. Once this is done we define
the derived category of an abelian category as the localization of the
of homotopy category with respect to quasi-isomorphisms.
A good reference is Verdier's thesis \cite{Verdier}.



\section{Triangulated categories}
\label{section-triangulated-categories}

\noindent
Triangulated categories are a convenient tool to describe the type
of structure inherent in the derived category of an abelian category.
Some references are \cite{Verdier} and \cite{Neeman}.




\section{The definition of a triangulated category}
\label{section-triangulated-definitions}

\noindent
In this section we collect most of the definitions concerning triangulated
and pre-triangulated categories.

\begin{definition}
\label{definition-triangle}
Let $\mathcal{D}$ be an additive category.
Let $[n] : \mathcal{D} \to \mathcal{D}$, $E \mapsto E[n]$
be a collection of additive functors indexed by $n \in \mathbf{Z}$ such that
$[n] \circ [m] = [n + m]$  and $[0] = \text{id}$ (equality as functors).
In this situation
we call {\it triangle} a sixtuple $(X, Y, Z, f, g, h)$
where $X, Y, Z \in \Ob(\mathcal{D})$ and
$f : X \to Y$, $g : Y \to Z$ and $h : Z \to X[1]$ are morphisms
of $\mathcal{D}$.
A {\it morphism of triangles}
$(X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')$
is given by morphisms $a : X \to X'$, $b : Y \to Y'$ and $c : Z \to Z'$
of $\mathcal{D}$ such that
$b \circ f = f' \circ a$, $c  \circ g = g' \circ b$ and
$a[1] \circ h = h' \circ c$.
\end{definition}

\noindent
A morphism of triangles is visualized by the following
commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^a &
Y \ar[r] \ar[d]^b &
Z \ar[r] \ar[d]^c &
X[1] \ar[d]^{a[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
Here is the definition of a triangulated category as given in
Verdier's thesis.

\begin{definition}
\label{definition-triangulated-category}
A {\it triangulated category} consists of a triple
$(\mathcal{D}, \{[n]\}_{n\in \mathbf{Z}}, \mathcal{T})$
where
\begin{enumerate}
\item $\mathcal{D}$ is an additive category,
\item $[n] : \mathcal{D} \to \mathcal{D}$, $E \mapsto E[n]$
be a collection of additive functors indexed by $n \in \mathbf{Z}$ such that
$[n] \circ [m] = [n + m]$ and $[0] = \text{id}$ (equality as functors), and
\item $\mathcal{T}$ is a set of triangles called the
{\it distinguished triangles}
\end{enumerate}
subject to the following conditions
\begin{enumerate}
\item[TR1] Any triangle isomorphic to a distinguished triangle is
a distinguished triangle. Any triangle of the form
$(X, X, 0, \text{id}, 0, 0)$ is distinguished.
For any morphism $f : X \to Y$ of $\mathcal{D}$ there exists a
distinguished triangle of the form $(X, Y, Z, f, g, h)$.
\item[TR2] The triangle $(X, Y, Z, f, g, h)$ is distinguished
if and only if the triangle $(Y, Z, X[1], g, h, -f[1])$ is.
\item[TR3] Given a solid commutative square
$$
\xymatrix{
X \ar[r] \ar[d]^a &
Y \ar[r] \ar[d]^b &
Z \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{a[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
whose rows are distinguished triangles there exists a morphism
$c : Z \to Z'$ such that $(a, b, c)$ is a morphism of triangles.
\item[TR4] Given objects $X$, $Y$, $Z$ of $\mathcal{D}$, and morphisms
$f : X \to Y$, $g : Y \to Z$, and distinguished triangles
$(X, Y, Q_1, f, p_1, d_1)$,
$(X, Z, Q_2, g \circ f, p_2, d_2)$,
and
$(Y, Z, Q_3, g, p_3, d_3)$,
there exist
morphisms $a : Q_1 \to Q_2$ and $b : Q_2 \to Q_3$ such
that
\begin{enumerate}
\item $(Q_1, Q_2, Q_3, a, b, p_1[1] \circ d_3)$ is a
distinguished triangle,
\item the triple $(\text{id}_X, g, a)$ is
a morphism of triangles
$(X, Y, Q_1, f, p_1, d_1) \to (X, Z, Q_2, g \circ f, p_2, d_2)$, and
\item the triple $(f, \text{id}_Z, b)$ is a morphism of triangles
$(X, Z, Q_2, g \circ f, p_2, d_2) \to (Y, Z, Q_3, g, p_3, d_3)$.
\end{enumerate}
\end{enumerate}
We will call $(\mathcal{D}, [\ ], \mathcal{T})$ a
{\it pre-triangulated category} if TR1, TR2 and TR3 hold.
\end{definition}

\noindent
The explanation of TR4 is that if you think of $Q_1$ as
$Y/X$, $Q_2$ as $Z/X$ and $Q_3$ as $Z/Y$, then TR4(a) expresses
the isomorphism $(Z/X)/(Y/Z) \cong Z/Y$ and TR(b) and TR(c)
express that we can compare the triangles $X \to Y \to Q_1 \to X[1]$
etc with morphisms of triangles. For a more precise reformuation
of this idea see the proof of Lemma \ref{lemma-two-split-injections}.

\medskip\noindent
The sign in TR2 means that if $(X, Y, Z, f, g, h)$ is a distinguished triangle
then in the long sequence
\begin{equation}
\label{equation-rotate}
\ldots \to
Z[-1] \xrightarrow{-h[-1]}
X \xrightarrow{f}
Y \xrightarrow{g}
Z \xrightarrow{h}
X[1] \xrightarrow{-f[1]}
Y[1] \xrightarrow{-g[1]}
Z[1] \to \ldots
\end{equation}
each four term sequence gives a distinguished triangle.

\medskip\noindent
As usual we abuse notation and we simply speak of a (pre-)triangulated
category $\mathcal{D}$ without explicitly introducing notation for the
additional data. The notion of a pre-triangulated category is
useful in finding statements equivalent to TR4.

\medskip\noindent
We have the following definition of a triangulated functor.

\begin{definition}
\label{definition-exact-functor-triangulated-categories}
Let $\mathcal{D}$, $\mathcal{D}'$ be pre-triangulated
categories. An {\it exact functor}, or a {\it triangulated functor}
from $\mathcal{D}$ to $\mathcal{D}'$ is a functor
$F : \mathcal{D} \to \mathcal{D}'$ together
with given functorial isomorphisms $\xi_X : F(X[1]) \to F(X)[1]$
such that for every distinguished triangle
$(X, Y, Z, f, g, h)$ of $\mathcal{D}$ the triangle
$(F(X), F(Y), F(Z), F(f), F(g), \xi_X \circ F(h))$
is a distinguished triangle of $\mathcal{D}'$.
\end{definition}

\noindent
An exact functor is additive, see
Lemma \ref{lemma-exact-functor-additive}.
When we say two triangulated categories are equivalent we mean that
they are equivalent in the $2$-category of triangulated categories.
A $2$-morphism $a : (F, \xi) \to (F', \xi')$ in this $2$-category is
simply a transformation of functors $a : F \to F'$ which is compatible
with $\xi$ and $\xi'$, i.e.,
$$
\xymatrix{
F \circ [1] \ar[r]_\xi \ar[d]_{a \star 1} & [1] \circ F \ar[d]^{1 \star a} \\
F' \circ [1] \ar[r]^{\xi'} & [1] \circ F'
}
$$
commutes.

\begin{definition}
\label{definition-triangulated-subcategory}
Let $(\mathcal{D}, [\ ], \mathcal{T})$ be a pre-triangulated category.
A {\it pre-triangulated subcategory}\footnote{This definition may be
nonstandard. If $\mathcal{D}'$ is a full subcategory then $\mathcal{T}'$
is the intersection of the set of triangles in $\mathcal{D}'$ with
$\mathcal{T}$, see
Lemma \ref{lemma-triangulated-subcategory}.
In this case we drop $\mathcal{T}'$ from the notation.}
is a pair $(\mathcal{D}', \mathcal{T}')$ such that
\begin{enumerate}
\item $\mathcal{D}'$ is an additive subcategory of $\mathcal{D}$
which is preserved under $[1]$ and $[-1]$,
\item $\mathcal{T}' \subset \mathcal{T}$ is a subset such that for every
$(X, Y, Z, f, g, h) \in \mathcal{T}'$ we have
$X, Y, Z \in \Ob(\mathcal{D}')$ and
$f, g, h \in \text{Arrows}(\mathcal{D}')$, and
\item $(\mathcal{D}', [\ ], \mathcal{T}')$ is a pre-triangulated
category.
\end{enumerate}
If $\mathcal{D}$ is a triangulated category, then we say
$(\mathcal{D}', \mathcal{T}')$ is a {\it triangulated subcategory} if
it is a pre-triangulated subcategory and
$(\mathcal{D}', [\ ], \mathcal{T}')$ is a triangulated category.
\end{definition}

\noindent
In this situation the inclusion functor
$\mathcal{D}' \to \mathcal{D}$ is an exact functor
with $\xi_X : X[1] \to X[1]$ given by the identity on $X[1]$.

\medskip\noindent
We will see in
Lemma \ref{lemma-composition-zero}
that for a distinguished triangle $(X, Y, Z, f, g, h)$
in a pre-triangulated category the composition $g \circ f : X \to Z$ is zero.
Thus the sequence (\ref{equation-rotate}) is a complex.
A homological functor is one that turns this complex into a long
exact sequence.

\begin{definition}
\label{definition-homological}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $\mathcal{A}$ be an abelian category.
An additive functor $H : \mathcal{D} \to \mathcal{A}$ is called
{\it homological} if for every distinguished triangle
$(X, Y, Z, f, g, h)$ the sequence
$$
H(X) \to H(Y) \to H(Z)
$$
is exact in the abelian category $\mathcal{A}$. An additive functor
$H : \mathcal{D}^{opp} \to \mathcal{A}$ is called {\it cohomological}
if the corresponding functor $\mathcal{D} \to \mathcal{A}^{opp}$ is
homological.
\end{definition}

\noindent
If $H : \mathcal{D} \to \mathcal{A}$ is a homological functor
we often write $H^n(X) = H(X[n])$ so that $H(X) = H^0(X)$.
Our discussion of TR2 above implies that says that a distinguished triangle
$(X, Y, Z, f, g, h)$ determines a long exact sequence
\begin{equation}
\label{equation-long-exact-cohomology-sequence}
\xymatrix{
H^{-1}(Z) \ar[r]^{h[-1]} &
H^0(X) \ar[r]^f &
H^0(Y) \ar[r]^g &
H^0(Z) \ar[r]^h &
H^1(X)
}
\end{equation}
This will be called the {\it long exact sequence} associated to the
distinguished triangle and the homological functor. As indicated
we will not use any signs for the morphisms in the long exact
sequence. This has the side effect that maps in the long exact sequence
associated to the rotation (TR2) of a distinguished triangle differ
from the maps in the sequence above by some signs.

\begin{definition}
\label{definition-delta-functor}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{D}$ be a triangulated category.
A {\it $\delta$-functor from $\mathcal{A}$ to $\mathcal{D}$} is
given by a functor $G : \mathcal{A} \to \mathcal{D}$ and
a rule which assigns to every short exact sequence
$$
0 \to A \xrightarrow{a} B \xrightarrow{b} C \to 0
$$
a morphism $\delta = \delta_{A \to B \to C} : G(C) \to G(A)[1]$
such that
\begin{enumerate}
\item the triangle
$(G(A), G(B), G(C), G(a), G(b), \delta_{A \to B \to C})$
is a distinguished triangle of $\mathcal{D}$
for any short exact sequence as above, and
\item for every morphism $(A \to B \to C) \to (A' \to B' \to C')$
of short exact sequences the diagram
$$
\xymatrix{
G(C) \ar[d] \ar[rr]_{\delta_{A \to B \to C}} & &
G(A)[1] \ar[d] \\
G(C') \ar[rr]^{\delta_{A' \to B' \to C'}} & &
G(A')[1]
}
$$
is commutative.
\end{enumerate}
In this situation we call
$(G(A), G(B), G(C), G(a), G(b), \delta_{A \to B \to C})$
the {\it image of the short exact sequence under the
given $\delta$-functor}.
\end{definition}

\noindent
Note how a $\delta$-functor comes equipped with additional structure.
Strictly speaking it does not make sense to say that a given
functor $\mathcal{A} \to \mathcal{D}$ is a $\delta$-functor, but we
will often do so anyway.












\section{Elementary results on triangulated categories}
\label{section-elementary-results}

\noindent
Most of the results in this section are proved for pre-triangulated categories
and a fortiori hold in any triangulated category.

\begin{lemma}
\label{lemma-composition-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
Then $g \circ f = 0$,
$h \circ g = 0$ and $f[1] \circ h = 0$.
\end{lemma}

\begin{proof}
By TR1 we know $(X, X, 0, 1, 0, 0)$ is a distinguished triangle.
Apply TR3 to
$$
\xymatrix{
X \ar[r] \ar[d]^1 &
X \ar[r] \ar[d]^f &
0 \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{1[1]} \\
X \ar[r]^f &
Y \ar[r]^g &
Z \ar[r]^h &
X[1]
}
$$
Of course the dotted arrow is the zero map. Hence the commutativity of
the diagram implies that $g \circ f = 0$. For the other cases
rotate the triangle, i.e., apply TR2.
\end{proof}

\begin{lemma}
\label{lemma-representable-homological}
Let $\mathcal{D}$ be a pre-triangulated category.
For any object $W$ of $\mathcal{D}$ the functor
$\Hom_\mathcal{D}(W, -)$ is homological, and the functor
$\Hom_\mathcal{D}(-, W)$ is cohomological.
\end{lemma}

\begin{proof}
Consider a distinguished triangle $(X, Y, Z, f, g, h)$.
We have already seen that $g \circ f = 0$, see
Lemma \ref{lemma-composition-zero}.
Suppose $a : W \to Y$ is a morphism such that $g \circ a = 0$.
Then we get a commutative diagram
$$
\xymatrix{
W \ar[r]_1 \ar@{..>}[d]^b &
W \ar[r] \ar[d]^a &
0 \ar[r] \ar[d]^0 &
W[1] \ar@{..>}[d]^{b[1]} \\
X \ar[r] & Y \ar[r] & Z \ar[r] & X[1]
}
$$
Both rows are distinguished triangles (use TR1 for the top row).
Hence we can fill the dotted arrow $b$ (first rotate using TR2,
then apply TR3, and then rotate back). This proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-third-isomorphism-triangle}
Let $\mathcal{D}$ be a pre-triangulated category.
Let
$$
(a, b, c) : (X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')
$$
be a morphism of distinguished triangles. If two among $a, b, c$
are isomorphisms so is the third.
\end{lemma}

\begin{proof}
Assume that $a$ and $c$ are isomorphisms.
For any object $W$ of $\mathcal{D}$ write
$H_W( - ) = \Hom_\mathcal{D}(W, -)$.
Then we get a commutative diagram of abelian groups
$$
\xymatrix{
H_W(Z[-1]) \ar[r] \ar[d] &
H_W(X) \ar[r] \ar[d] &
H_W(Y) \ar[r] \ar[d] &
H_W(Z) \ar[r] \ar[d] &
H_W(X[1]) \ar[d] \\
H_W(Z'[-1]) \ar[r] &
H_W(X') \ar[r] &
H_W(Y') \ar[r] &
H_W(Z') \ar[r] &
H_W(X'[1])
}
$$
By assumption the right two and left two vertical arrows are bijective.
As $H_W$ is homological by
Lemma \ref{lemma-representable-homological}
and the five lemma
(Homology, Lemma \ref{homology-lemma-five-lemma})
it follows that the middle vertical arrow is an isomorphism.
Hence by Yoneda's lemma, see
Categories, Lemma \ref{categories-lemma-yoneda}
we see that $b$ is an isomorphism.
This implies the other cases by rotating (using TR2).
\end{proof}

\begin{lemma}
\label{lemma-third-map-square-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let
$$
(0, b, 0), (0, b', 0) : (X, Y, Z, f, g, h) \to (X, Y, Z, f, g, h)
$$
be endomorphisms of a distinguished triangle. Then $bb' = 0$.
\end{lemma}

\begin{proof}
Picture
$$
\xymatrix{
X \ar[r] \ar[d]^0 &
Y \ar[r] \ar[d]^{b, b'} \ar@{..>}[ld]^\alpha &
Z \ar[r] \ar[d]^0 \ar@{..>}[ld]^\beta &
X[1] \ar[d]^0 \\
X \ar[r] & Y \ar[r] & Z \ar[r] & X[1]
}
$$
Applying
Lemma \ref{lemma-third-isomorphism-triangle}
we find dotted arrows $\alpha$ and $\beta$ such that
$b' = f \circ \alpha$ and $b = \beta \circ g$. Then
$bb' = \beta \circ g \circ f \circ \alpha = 0$
as $g \circ f = 0$ by
Lemma \ref{lemma-composition-zero}.
\end{proof}

\begin{lemma}
\label{lemma-third-map-idempotent}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
If
$$
\xymatrix{
Z \ar[r]_f \ar[d]_c & X[1] \ar[d]^{a[1]} \\
Z \ar[r]^f & X[1]
}
$$
is commutative and $a^2 = a$, $c^2 = c$, then there exists a
morphism $b : Y \to Y$ with $b^2 = b$ such that
$(a, b, c)$ is an endomorphism of the triangle $(X, Y, Z, f, g, h)$.
\end{lemma}

\begin{proof}
By TR3 there exists a morphism $b'$ such that
$(a, b', c)$ is an endormorphism of $(X, Y, Z, f, g, h)$.
Then $(0, (b')^2 - b', 0)$ is also an endomorphism. By
Lemma \ref{lemma-third-map-square-zero}
we see that $(b')^2 - b'$ has square zero.
Set $b = b' - (2b' - 1)((b')^2 - b') = 3(b')^2 - 2(b')^3$.
A computation shows that $(a, b, c)$ is an endomorphism and
that $b^2 - b = (4(b')^2 - 4b' - 3)((b')^2 - b')^2 = 0$.
\end{proof}

\begin{lemma}
\label{lemma-cone-triangle-unique-isomorphism}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
There exists a distinguished triangle $(X, Y, Z, f, g, h)$ which
is unique up to (nonunique) isomorphism of triangles.
More precisely, given a second such distinguished triangle
$(X, Y, Z', f, g', h')$ there exists an isomorphism
$$
(1, 1, c) : (X, Y, Z, f, g, h) \longrightarrow (X, Y, Z', f, g', h')
$$
\end{lemma}

\begin{proof}
Existence by TR1. Uniqueness up to isomorphism by TR3 and
Lemma \ref{lemma-third-isomorphism-triangle}.
\end{proof}

\begin{lemma}
\label{lemma-third-object-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item $f$ is an isomorphism,
\item $(X, Y, 0, f, 0, 0)$ is a distinguished triangle, and
\item for any distinguished triangle $(X, Y, Z, f, g, h)$ we have $Z = 0$.
\end{enumerate}
\end{lemma}

\begin{proof}
Immediate from
Lemma \ref{lemma-cone-triangle-unique-isomorphism}
and TR1.
\end{proof}

\begin{lemma}
\label{lemma-direct-sum-triangles}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ be triangles.
The following are equivalent
\begin{enumerate}
\item $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')$
is a distinguished triangle,
\item both $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ are
distinguished triangles.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (2). By TR1 we may choose a distinguished triangle
$(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$.
By TR3 we can find morphisms of distinguished triangles
$(X, Y, Z, f, g, h) \to
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$
and
$(X', Y', Z', f', g', h') \to
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$.
Taking the direct sum of these morphisms
we obtain a morphism of triangles
$$
\xymatrix{
(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')
\ar[d]^{(1, 1, c)} \\
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'').
}
$$
Let $W$ be any object in $\mathcal{D}$ and apply the functor
$H_W = \Hom_\mathcal{D}(W, -)$ to this diagram.
By
Lemma \ref{lemma-representable-homological}
(applied three times)
we deduce that $H_W(c) : H_W(Z \oplus Z') \to H_W(Q)$
is an isomorphism. Hence $c$ is an isomorphism and we conclude that
(1) holds.

\medskip\noindent
Assume (1). We will show that $(X, Y, Z, f, g, h)$ is a distinguished
triangle. Let $W$ be any object in $\mathcal{D}$ and set
$H_W = \Hom_\mathcal{D}(W, -)$. By
Lemma \ref{lemma-representable-homological}
we see that $H_W(X) \to H_W(Y) \to H_W(Z) \to H_W(Z[1])$ is exact as
it is a direct summand of the exact sequence associated to the distinguished
triangle $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')$. Using TR1 let
$(X, Y, Q, f, g'', h'')$ be a distinguished triangle. By TR3 there exists
a morphism of distinguished triangles
 $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h') \to (X, Y, Q, f, g'', h'')$.
Composing this with the inclusion map we get a morphism of triangles
$$
(1, 1, c) :
(X, Y, Z, f, g, h)
\longrightarrow
(X, Y, Q, f, g'', h'')
$$
Applying $H_W$ and using the above we once again see that
$H_W(c) : H_W(Z) \to H_W(Q)$ is an isomorphism and we conclude that
$c$ is an isomorphism. Hence we win.
\end{proof}

\begin{lemma}
\label{lemma-split}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
\begin{enumerate}
\item If $h = 0$, then there exists a left inverse $s : Z \to Y$ to $g$.
\item For any left inverse $s : Z \to Y$ of $g$ the map
$f \oplus s : X \oplus Z \to Y$ is an isomorphism.
\item For any objects $X', Z'$ of $\mathcal{D}$ the triangle
$(X', X' \oplus Z', Z', (1, 0), (0, 1), 0)$ is distinguished.
\end{enumerate}
\end{lemma}

\begin{proof}
To see (1) use that
$\Hom_\mathcal{D}(Z, Y) \to \Hom_\mathcal{D}(Z, Z) \to
\Hom_\mathcal{D}(Z, X[1])$
is exact by
Lemma \ref{lemma-representable-homological}.
By the same token, if $s$ is as in (2), then $h = 0$ and the sequence
$$
0 \to \Hom_\mathcal{D}(W, X) \to \Hom_\mathcal{D}(W, Y)
\to \Hom_\mathcal{D}(W, Z) \to 0
$$
is split exact (split by $s : Z \to Y$). Hence by Yoneda's lemma we
see that $X \oplus Z \to Y$ is an isomorphism. The last assertion follows
from TR1 and
Lemma \ref{lemma-direct-sum-triangles}.
\end{proof}

\begin{lemma}
\label{lemma-when-split}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item $f$ has a kernel,
\item $f$ has a cokernel,
\item $f$ is isomorphic to a map $K \oplus Z \to Z \oplus Q$
induced by $\text{id}_Z$.
\end{enumerate}
\end{lemma}

\begin{proof}
Any morphism isomorphic to a map of the form
$X' \oplus Z \to Z \oplus Y'$ has both a kernel and a cokernel.
Hence (3) $\Rightarrow$ (1), (2).
Next we prove (1) $\Rightarrow$ (3).
Suppose first that $f : X \to Y$ is a monomorphism, i.e., its kernel is zero.
By TR1 there exists a distinguished triangle $(X, Y, Z, f, g, h)$
and by
Lemma \ref{lemma-representable-homological}
we see that $h = 0$. Then
Lemma \ref{lemma-split}
implies that $Y = X \oplus Z$, i.e., we see that (3) holds.
Next, assume $f$ has a kernel $K$. As $K \to X$ is a monomorphism we
conclude $X = K \oplus X'$ and $f|_{X'} : X' \to Y$ is a monomorphism.
Hence $Y = X' \oplus Y'$ and we win.
The implication (2) $\Rightarrow$ (3) is dual to this.
\end{proof}

\begin{lemma}
\label{lemma-projectors-have-images}
Let $\mathcal{D}$ be an additive category which has countable products
and has kernels of maps which have a left inverse. Then $\mathcal{D}$
has kernels of idempotents.
\end{lemma}

\begin{proof}
Let $\mathcal{D}$ be an additive category. Let $X$ be an object of
$\mathcal{D}$ and let $e : X \to X$ be an idempotent. Then
functor
$$
W \longmapsto \text{Ker}(
\Mor_\mathcal{D}(W, X)
\xrightarrow{e}
\Mor_\mathcal{D}(W, X)
)
$$
if representable if and only if $e$ has a kernel. Note that for any
abelian group $A$ and idempotent endomorphism $e : A \to A$ we have
$$
\text{Ker}(e : A \to A)
= \text{Ker}(\Phi :
\prod\nolimits_{n \in \mathbf{N}} A
\to
\prod\nolimits_{n \in \mathbf{N}} A
)
$$
where
$$
\Phi(a_1, a_2, a_3, \ldots) = (ea_1 + (1 - e)a_2, ea_2 + (1 - e)a_3, \ldots)
$$
Moreover, $\Phi$ has the left inverse
$$
\Psi(a_1, a_2, a_3, \ldots) =
(a_1, (1 - e)a_1 + ea_2, (1 - e)a_2 + ea_3, \ldots).
$$
Hence if $\mathcal{D}$ has countable products and kernels of maps which
have a left inverse, then we see that kernel of $e$ exists.
\end{proof}

\begin{lemma}
\label{lemma-projectors-have-images-triangulated}
Let $\mathcal{D}$ be a pre-triangulated category.
If $\mathcal{D}$ has countable products, then $\mathcal{D}$
has kernels of idempotents.
If $\mathcal{D}$ has countable coproducts, then $\mathcal{D}$
has kernels of idempotents.
\end{lemma}

\begin{proof}
Assume $\mathcal{D}$ has countable products. Then it suffices to
check that morphisms which have a left inverse have kernels.
Any morphism which has a left inverse is an epimorphism, hence
has a kernel by
Lemma \ref{lemma-when-split}.
The second statement is dual to the first.
\end{proof}

\noindent
The following lemma makes it slightly easier to prove that a
pre-triangulated category is triangulated.

\begin{lemma}
\label{lemma-easier-axiom-four}
Let $\mathcal{D}$ be a pre-triangulated category.
In order to prove TR4 it suffices to show that given
any pair of composable morphisms
$f : X \to Y$ and $g : Y \to Z$ there exist
\begin{enumerate}
\item isomorphisms $i : X' \to X$, $j : Y' \to Y$ and
$k : Z' \to Z$, and then setting $f' = j^{-1}fi : X' \to Y'$ and
$g' = k^{-1}gj : Y' \to Z'$ there exist
\item distinguished triangles
$(X', Y', Q_1, f', p_1, d_1)$,
$(X', Z', Q_2, g' \circ f', p_2, d_2)$
and
$(Y', Z', Q_3, g', p_3, d_3)$,
such that the assertion of TR4 holds.
\end{enumerate}
\end{lemma}

\begin{proof}
The replacement of $X, Y, Z$ by $X', Y', Z'$ is harmless by our
definition of distinguished triangles and their isomorphisms.
The lemma follows from the fact that the distinguished triangles
$(X', Y', Q_1, f', p_1, d_1)$,
$(X', Z', Q_2, g' \circ f', p_2, d_2)$
and
$(Y', Z', Q_3, g', p_3, d_3)$
are unique up to isomorphism by
Lemma \ref{lemma-cone-triangle-unique-isomorphism}.
\end{proof}

\begin{lemma}
\label{lemma-triangulated-subcategory}
Let $\mathcal{D}$ be a pre-triangulated category.
Assume that $\mathcal{D}'$ is an additive full subcategory of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item there exists a set of triangles $\mathcal{T}'$ such that
$(\mathcal{D}', \mathcal{T}')$ is a pre-triangulated subcategory
of $\mathcal{D}$,
\item $\mathcal{D}'$ is preserved under $[1], [-1]$ and
given any morphism $f : X \to Y$ in $\mathcal{D}'$ there exists
a distinguished triangle $(X, Y, Z, f, g, h)$ in $\mathcal{D}$
such that $Z$ is isomorphic to an object of $\mathcal{D}'$.
\end{enumerate}
In this case $\mathcal{T}'$ is the set of distinguished triangles
$(X, Y, Z, f, g, h)$ of $\mathcal{D}$ such that
$X, Y, Z \in \Ob(\mathcal{D}')$ and
$f, g, h \in \text{Arrows}(\mathcal{D}')$. Finally, if $\mathcal{D}$
is a triangulated category, then (1) and (2) are also equivalent to
\begin{enumerate}
\item[(3)] $\mathcal{D}'$ is a triangulated subcategory.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-exact-functor-additive}
An exact functor of pre-triangulated categories is additive.
\end{lemma}

\begin{proof}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of
pre-triangulated categories. Since
$(0, 0, 0, 1_0, 1_0, 0)$ is a distinguished triangle of $\mathcal{D}$
the triangle
$$
(F(0), F(0), F(0), 1_{F(0)}, 1_{F(0)}, F(0))
$$
is distinguished in $\mathcal{D}'$.
This implies that $1_{F(0)} \circ 1_{F(0)}$ is zero, see
Lemma \ref{lemma-composition-zero}.
Hence $F(0)$ is the zero object of $\mathcal{D}'$. This also implies
that $F$ applied to any zero morphism is zero (since a morphism in
an additive category is zero if and only if it factors through the
zero objet). Next, using that
$(X, X \oplus Y, Y, (1, 0), (0, 1), 0)$ is a distinguished triangle,
we see that $(F(X), F(X \oplus Y), F(Y), F(1, 0), F(0, 1), 0)$ is
one too. This implies that the map
$F(1, 0) \oplus F(0, 1) : F(X) \oplus F(Y) \to F(X \oplus Y)$
is an isomorphism, see
Lemma \ref{lemma-split}.
We omit the rest of the argument.
\end{proof}

\begin{lemma}
\label{lemma-exact-equivalence}
Let $F : \mathcal{D} \to \mathcal{D}'$ be a fully faithful exact functor
of pre-triangulated categories. Then a triangle $(X, Y, Z, f, g, h)$
of $\mathcal{D}$ is distinguished if and only if
$(F(X), F(Y), F(Z), F(f), F(g), F(h))$ is distinguished in $\mathcal{D}'$.
\end{lemma}

\begin{proof}
The ``if'' part is clear. Assume $(F(X), F(Y), F(Z))$ is
distinguished in $\mathcal{D}'$. Pick a distinguished triangle
$(X, Y, Z', f, g', h')$ in $\mathcal{D}$. By
Lemma \ref{lemma-cone-triangle-unique-isomorphism}
there exists an isomorphism of triangles
$$
(1, 1, c') : (F(X), F(Y), F(Z)) \longrightarrow (F(X), F(Y), F(Z')).
$$
Since $F$ is fully faithful, there exists a morphism $c : Z \to Z'$
such that $F(c) = c'$. Then $(1, 1, c)$ is an isomorphism between
$(X, Y, Z)$ and $(X, Y, Z')$. Hence $(X, Y, Z)$ is distinguished
by TR1.
\end{proof}

\begin{lemma}
\label{lemma-composition-exact}
Let $\mathcal{D}, \mathcal{D}', \mathcal{D}''$ be pre-triangulated categories.
Let $F : \mathcal{D} \to \mathcal{D}'$ and
$F' : \mathcal{D}' \to \mathcal{D}''$ be exact functors.
Then $F' \circ F$ is an exact functor.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-exact-compose-homological-functor}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $\mathcal{A}$ be an abelian category.
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor.
\begin{enumerate}
\item Let $\mathcal{D}'$ be a pre-triangulated category.
Let $F : \mathcal{D}' \to \mathcal{D}$ be an exact functor.
Then the composition $G \circ F$ is a homological functor as well.
\item Let $\mathcal{A}'$ be an abelian category. Hence
$G : \mathcal{A} \to \mathcal{A}'$ be an exact functor.
Hence $G \circ H$ is a homological functor as well.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-exact-compose-delta-functor}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{A}$ be an abelian category.
Let $G : \mathcal{A} \to \mathcal{D}$ be a $\delta$-functor.
\begin{enumerate}
\item Let $\mathcal{D}'$ be a triangulated category.
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor.
Then the composition $F \circ G$ is a $\delta$-functor as well.
\item Let $\mathcal{A}'$ be an abelian category. Hence
$H : \mathcal{A}' \to \mathcal{A}$ be an exact functor.
Hence $G \circ H$ is a $\delta$-functor as well.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-compose-delta-functor-homological}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{A}$ be an abelian category.
Let $G : \mathcal{A} \to \mathcal{D}$ be a $\delta$-functor.
Let $H : \mathcal{D} \to \mathcal{B}$ be a homological functor.
Assume that $H^{-1}(G(A)) = 0$ for all $A$ in $\mathcal{A}$.
Then the collection
$$
\{H^n \circ G, H^n(\delta_{A \to B \to C})\}_{n \geq 0}
$$
is a $\delta$-functor from $\mathcal{A} \to \mathcal{B}$, see
Homology, Definition \ref{homology-definition-cohomological-delta-functor}.
\end{lemma}

\begin{proof}
The notation signifies the following. If
$0 \to A \xrightarrow{a} B \xrightarrow{b} C \to 0$ is
a short exact sequence in $\mathcal{A}$, then
$$
\delta = \delta_{A \to B \to C} : G(C) \to G(A)[1]
$$
is a morphism in $\mathcal{D}$ such that
$(G(A), G(B), G(C), a, b, \delta)$ is
a distinguished triangle, see
Definition \ref{definition-delta-functor}.
Then $H^n(\delta) : H^n(G(C)) \to H^n(G(A)[1]) = H^{n + 1}(G(A))$
is clearly functorial in the short exact sequence.
Finally, the long exact cohomology sequence
(\ref{equation-long-exact-cohomology-sequence})
combined with the vanishing of $H^{-1}(G(C))$
gives a long exact sequence
$$
0 \to H^0(G(A)) \to H^0(G(B)) \to H^0(G(C))
\xrightarrow{H^0(\delta)} H^1(G(A)) \to \ldots
$$
in $\mathcal{B}$ as desired.
\end{proof}

\noindent
The proof of the following result uses TR4.

\begin{proposition}
\label{proposition-9}
Let $\mathcal{D}$ be a triangulated category. Any commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d] & Y \ar[d] \\
X' \ar[r] & Y'
}
$$
can be extended to a diagram
$$
\xymatrix{
X \ar[r] \ar[d] & Y \ar[r] \ar[d] & Z \ar[r] \ar[d] & X[1] \ar[d] \\
X' \ar[r] \ar[d] & Y' \ar[r] \ar[d] & Z' \ar[r] \ar[d] & X'[1] \ar[d] \\
X'' \ar[r] \ar[d] & Y'' \ar[r] \ar[d] & Z'' \ar[r] \ar[d] & X''[1] \ar[d] \\
X[1] \ar[r] & Y[1] \ar[r] & Z[1] \ar[r] & X[2]
}
$$
where all the squares are commutative, except for the lower right square
which is anticommutative. Moreover, each of the rows and columns are
distinguished triangles. Finally, the morphisms on the bottom row
(resp.\ right column) are obtained from the morphisms of the top row
(resp.\ left column) by applying $[1]$.
\end{proposition}

\begin{proof}
During this proof we avoid writing the arrows in order to make the proof
legible. Choose distinguished triangles
$(X, Y, Z)$, $(X', Y', Z')$, $(X, X', X'')$, $(Y, Y', Y'')$, and
and $(X, Y', A)$. Note that the morphism $X \to Y'$ is both equal
to the composition $X \to Y \to Y'$ and equal to the composition
$X \to X' \to Y'$. Hence, we can find morphisms
\begin{enumerate}
\item $a : Z \to A$ and $b : A \to Y''$, and
\item $a' : X'' \to A$ and $b' : A \to Z'$
\end{enumerate}
as in TR4. Denote $c : Y'' \to Z[1]$ the composition
$Y'' \to Y[1] \to Z[1]$ and denote $c' : Z' \to X''[1]$ the composition
$Z' \to X'[1] \to X''[1]$. The conclusion of our application TR4
are that
\begin{enumerate}
\item $(Z, A, Y'', a, b, c)$, $(X'', A, Z', a', b', c')$
are distinguished triangles,
\item $(X, Y, Z) \to (X, Y', A)$,
$(X, Y', A) \to (Y, Y', Y'')$,
$(X, X', X'') \to (X, Y', A)$,
$(X, Y', A) \to (X', Y', Z')$
are morphisms of triangles.
\end{enumerate}
First using that
$(X, X', X'') \to (X, Y', A)$ and $(X, Y', A) \to (Y, Y', Y'')$.
are morphisms of triangles we see the first of the commutative diagrams
$$
\xymatrix{
X' \ar[r] \ar[d] & Y' \ar[d] \\
X'' \ar[r]^{b \circ a'} \ar[d] & Y'' \ar[d] \\
X[1] \ar[r] & Y[1] 
}
\quad\quad
\xymatrix{
Y \ar[r] \ar[d] & Z \ar[d]^{b' \circ a} \ar[r] & X[1] \ar[d] \\
Y' \ar[r] & Z' \ar[r] & X'[1]
}
$$
is commutative. The second is commutative too using that
$(X, Y, Z) \to (X, Y', A)$ and $(X, Y', A) \to (X', Y', Z')$ are morphisms
of triangles. At this point we choose a distinguished triangle
$(X'', Y'' , Z'')$ starting with the map $b \circ a' : X'' \to Y''$.

\medskip\noindent
Next we apply TR4 one more time to the morphisms
$X'' \to A \to Y''$ and the triangles
$(X'', A, Z', a', b', c')$,
$(X'', Y'', Z'')$, and
$(A, Y'', Z[1], b, c , -a[1])$ to get morphisms
$a'' : Z' \to Z''$ and $b'' : Z'' \to Z[1]$.
Then $(Z', Z'', Z[1], a'', b'', - b'[1] \circ a[1])$ is a distinguished
triangle, hence also $(Z, Z', Z'', -b' \circ a, a'', -b'')$
and hence also $(Z, Z', Z'', b' \circ a, a'', b'')$.
Moreover, $(X'', A, Z') \to (X'', Y'', Z'')$ and
$(X'', Y'', Z'') \to (A, Y'', Z[1], b, c , -a[1])$
are morphisms of triangles.
At this point we have defined all the distinguished triangles
and all the morphisms, and all that's left is to verify some
commutativity relations.

\medskip\noindent
To see that the middle square in the diagram commutes, note
that the arrow $Y' \to Z'$ factors as $Y' \to A \to Z'$
because $(X, Y', A) \to (X', Y', Z')$ is a morphism of triangles.
Similarly, the morphism $Y' \to Y''$ factors as
$Y' \to A \to Y''$ because $(X, Y', A) \to (Y, Y', Y'')$ is a
morphism of triangles. Hence the middle square commutes because
the square with sides $(A, Z', Z'', Y'')$ commutes as
$(X'', A, Z') \to (X'', Y'', Z'')$ is a morphism of triangles (by TR4).
The square with sides $(Y'', Z'', Y[1], Z[1])$ commutes
because $(X'', Y'', Z'') \to (A, Y'', Z[1], b, c , -a[1])$
is a morphism of triangles and $c : Y'' \to Z[1]$ is the composition
$Y'' \to Y[1] \to Z[1]$.
The square with sides $(Z', X'[1], X''[1], Z'')$ is commutative
because $(X'', A, Z') \to (X'', Y'', Z'')$ is a morphism of triangles
and $c' : Z' \to X''[1]$ is the composition $Z' \to X'[1] \to X''[1]$.
Finally, we have to show that the square with sides
$(Z'', X''[1], Z[1], X[2])$ anticommutes. This holds because
$(X'', Y'', Z'') \to (A, Y'', Z[1], b, c , -a[1])$
is a morphism of triangles and we're done.
\end{proof}








\section{Localization of triangulated categories}
\label{section-localization}

\noindent
In order to construct the derived category starting from the homotopy
category of compexes, we will use a localization process.

\begin{definition}
\label{definition-localization}
Let $\mathcal{D}$ be a pre-triangulated category. We say a multiplicative
system $S$ is {\it compatible with the triangulated structure} if
the following two conditions hold:
\begin{enumerate}
\item[MS5] For $s \in S$ we have $s[n] \in S$ for all $n \in \mathbf{Z}$.
\item[MS6] Given a solid commutative square
$$
\xymatrix{
X \ar[r] \ar[d]^s &
Y \ar[r] \ar[d]^{s'} &
Z \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{s[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
whose rows are distinguished triangles with $s, s' \in S$
there exists a morphism $s'' : Z \to Z'$ in $S$ such that
$(s, s', s'')$ is a morphism of triangles.
\end{enumerate}
\end{definition}

\noindent
It turns out that these axioms are not independent of the
axioms defining multiplicative systems.

\begin{lemma}
\label{lemma-localization-conditions}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $S$ be a set of morphisms of $\mathcal{D}$ and assume that axioms
MS1, MS5, MS6 hold (see
Categories, Definition \ref{categories-definition-multiplicative-system}
and
Definition \ref{definition-localization}).
Then MS2 holds.
\end{lemma}

\begin{proof}
Suppose that $f : X \to Y$ is a morphism of $\mathcal{D}$ and
$t : X \to X'$ an element of $S$. Choose a distinguished triangle
$(X, Y, Z, f, g, h)$. Next, choose a distinguished triangle
$(X', Y', Z, f', g', t[1] \circ h)$ (here we use TR1 and TR2).
By MS5, MS6 (and TR2 to rotate) we can find the dotted arrow
in the commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^t &
Y \ar[r] \ar@{..>}[d]^{s'} &
Z \ar[r] \ar[d]^1 &
X[1] \ar[d]^{t[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z \ar[r] &
X'[1]
}
$$
with moreover $s' \in S$. This proves LMS2. The proof of RMS2 is dual.
\end{proof}

\begin{lemma}
\label{lemma-triangle-functor-localize}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of
pre-triangulated categories.  Let
$$
S = \{f \in \text{Arrows}(\mathcal{D})
\mid F(f)\text{ is an isomorphism}\}
$$
Then $S$ is a saturated (see
Categories,
Definition \ref{categories-definition-saturated-multiplicative-system})
multiplicative system compatible with the
triangulated structure on $\mathcal{D}$.
\end{lemma}

\begin{proof}
We have to prove axioms MS1 -- MS6, see
Categories, Definitions \ref{categories-definition-multiplicative-system} and
\ref{categories-definition-saturated-multiplicative-system}
and
Definition \ref{definition-localization}.
MS1, MS4, and MS5 are direct from the definitions. MS6 follows from TR3 and
Lemma \ref{lemma-third-isomorphism-triangle}.
By
Lemma \ref{lemma-localization-conditions}
we conclude that MS2 holds. To finish the proof we have to show that
MS3 holds. To do this let $f, g : X \to Y$ be morphisms of $\mathcal{D}$,
and let $t : Z \to X$ be an element of $S$ such that $f \circ t = g \circ t$.
As $\mathcal{D}$ is additive this simply means that $a \circ t = 0$ with
$a = f - g$. Choose a distinguished triangle $(Z, X, Q, t, g, h)$ using
TR1 and TR2. Since $a \circ t = 0$ we see by
Lemma \ref{lemma-representable-homological}
there exists a morphism $i : Q \to Y$ such that $i \circ g = a$.
Finally, using TR1 again we can choose a triangle
$(Q, Y, W, i, j, k)$. Here is a picture
$$
\xymatrix{
Z \ar[r]_t & X \ar[r]_g \ar[d]^1 & Q \ar[r] \ar[d]^i & Z[1] \\
& X \ar[r]_a & Y \ar[d]^j \\
& & W
}
$$
OK, and now we apply the functor $F$ to this diagram.
Since $t \in S$ we see that $F(Q) = 0$, see
Lemma \ref{lemma-third-object-zero}.
Hence $F(j)$ is an isomorphism by the same lemma, i.e., $j \in S$.
Finally, $j \circ a = j \circ i \circ g = 0$ as $j \circ i = 0$.
Thus $j \circ f = j \circ g$ and we see that LMS3 holds.
The proof of RMS3 is dual.
\end{proof}

\begin{lemma}
\label{lemma-homological-functor-localize}
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor between a
pre-triangulated category and an abelian category. Let
$$
S = \{f \in \text{Arrows}(\mathcal{D})
\mid H^i(f)\text{ is an isomorphism for all }i \in \mathbf{Z}\}
$$
Then $S$ is a saturated (see
Categories,
Definition \ref{categories-definition-saturated-multiplicative-system})
multiplicative system compatible with the
triangulated structure on $\mathcal{D}$.
\end{lemma}

\begin{proof}
We have to prove axioms MS1 -- MS6, see
Categories, Definitions \ref{categories-definition-multiplicative-system} and
\ref{categories-definition-saturated-multiplicative-system}
and
Definition \ref{definition-localization}.
MS1, MS4, and MS5 are direct from the definitions.
MS6 follows from TR3 and the long exact cohomology sequence
(\ref{equation-long-exact-cohomology-sequence}).
By
Lemma \ref{lemma-localization-conditions}
we conclude that MS2 holds. To finish the proof we have to show that
MS3 holds. To do this let $f, g : X \to Y$ be morphisms of $\mathcal{D}$,
and let $t : Z \to X$ be an element of $S$ such that $f \circ t = g \circ t$.
As $\mathcal{D}$ is additive this simply means that $a \circ t = 0$ with
$a = f - g$. Choose a distinguished triangle $(Z, X, Q, t, g, h)$ using
TR1 and TR2. Since $a \circ t = 0$ we see by
Lemma \ref{lemma-representable-homological}
there exists a morphism $i : Q \to Y$ such that $i \circ g = a$.
Finally, using TR1 again we can choose a triangle
$(Q, Y, W, i, j, k)$. Here is a picture
$$
\xymatrix{
Z \ar[r]_t & X \ar[r]_g \ar[d]^1 & Q \ar[r] \ar[d]^i & Z[1] \\
& X \ar[r]_a & Y \ar[d]^j \\
& & W
}
$$
OK, and now we apply the functors $H^i$ to this diagram.
Since $t \in S$ we see that $H^i(Q) = 0$ by the long exact cohomology
sequence (\ref{equation-long-exact-cohomology-sequence}).
Hence $H^i(j)$ is an isomorphism for all $i$ by the same argument,
i.e., $j \in S$. Finally, $j \circ a = j \circ i \circ g = 0$ as
$j \circ i = 0$. Thus $j \circ f = j \circ g$ and we see that LMS3 holds.
The proof of RMS3 is dual.
\end{proof}

\begin{proposition}
\label{proposition-construct-localization}
Let $\mathcal{D}$ be a pre-triangulated category. Let $S$ be a multiplicative
system compatible with the triangulated structure.
Then there exists a unique structure of a pre-triangulated category on
$S^{-1}\mathcal{D}$ such that the localization functor
$Q : \mathcal{D} \to S^{-1}\mathcal{D}$ is exact.
Moreover, if $\mathcal{D}$ is a triangulated category, so is
$S^{-1}\mathcal{D}$.
\end{proposition}

\begin{proof}
We have seen that $S^{-1}\mathcal{D}$ is an additive category
and that the localization functor $Q$ is additive in
Homology, Lemma \ref{homology-lemma-localization-additive},
It is clear that we may define $Q(X)[n] = Q(X[n])$ since
$\mathcal{S}$ is preserved under the shift functors $[n]$ by
MS5. Finally, we say a triangle of $S^{-1}\mathcal{D}$ is distinguished
if it is isomorphic to the image of a distinguished triangle under
the localization functor $Q$.

\medskip\noindent
Proof of TR1. The only thing to prove here is that if
$a : Q(X) \to Q(Y)$ is a morphism of $S^{-1}\mathcal{D}$, then
$a$ fits into a distinguish triangle. Write $a = Q(s)^{-1} \circ Q(f)$ for
some $s : Y \to Y'$ in $S$ and $f : X \to Y'$. Choose a distinguished
triangle $(X, Y', Z, f, g, h)$ in $\mathcal{D}$. Then we see that
$(Q(X), Q(Y), Q(Z), a, Q(g) \circ Q(s), Q(h))$ is a distinguished triangle
of $S^{-1}\mathcal{D}$.

\medskip\noindent
Proof of TR2. This is immediate from the definitions.

\medskip\noindent
Proof of TR3. Note that the existence of the dotted arrow which is
required to exist may be proven after replacing the two triangles
by isomorphic triangles. Hence we may assume given distinguished
triangles $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ of
$\mathcal{D}$ and a commutative diagram
$$
\xymatrix{
Q(X) \ar[r]_{Q(f)} \ar[d]_a & Q(Y) \ar[d]^b \\
Q(X') \ar[r]^{Q(f')} & Q(Y')
}
$$
in $S^{-1}\mathcal{D}$. Now we apply
Categories, Lemma \ref{categories-lemma-left-localization-diagram}
to find a morphism $f'' : X'' \to Y''$ in $\mathcal{D}$ and a commutative
diagram
$$
\xymatrix{
X \ar[d]_f \ar[r]_k & X'' \ar[d]^{f''} & X' \ar[d]^{f'} \ar[l]^s \\
Y \ar[r]^l & Y'' & Y' \ar[l]_t
}
$$
in $\mathcal{D}$ with $s, t \in S$ and $a = s^{-1}k$, $b = t^{-1}l$.
At this point we can use TR3 for $\mathcal{D}$ and MS6 to find
a commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^k &
Y \ar[r] \ar[d]^l &
Z \ar[r] \ar[d]^m &
X[1] \ar[d]^{g[1]} \\
X'' \ar[r] &
Y'' \ar[r] &
Z'' \ar[r] &
X''[1] \\
X' \ar[r] \ar[u]_s &
Y' \ar[r] \ar[u]_t &
Z' \ar[r] \ar[u]_r &
X'[1] \ar[u]_{s[1]}
}
$$
with $r \in S$. It follows that setting $c = Q(r)^{-1}Q(m)$ we obtain
the desired morphism of triangles
$$
\xymatrix{
(Q(X), Q(Y), Q(Z), Q(f), Q(g), Q(h))
\ar[d]^{(a, b, c)} \\
(Q(X'), Q(Y'), Q(Z'), Q(f'), Q(g'), Q(h'))
}
$$

\medskip\noindent
This proves the first statement of the lemma. If $\mathcal{D}$ is also
a triangulated category, then we still have to prove TR4 in order to show
that $S^{-1}\mathcal{D}$ is triangulated as well. To do this we reduce by
Lemma \ref{lemma-easier-axiom-four}
to the following statement: Given composable morphisms
$a : Q(X) \to Q(Y)$ and $b : Q(Y) \to Q(Z)$ we have to produce
an octahedron after possibly replacing $Q(X), Q(Y), Q(Z)$ by isomorphic
objects. To do this we may first replace $Y$ by an object such that
$a = Q(f)$ for some morphism $f : X \to Y$ in $\mathcal{D}$. (More precisely,
write $a = s^{-1}f$ with $s : Y \to Y'$ in $S$ and $f : X \to Y'$. Then
replace $Y$ by $Y'$.) After this we similarly replace $Z$ by an object such
that $b = Q(g)$ for some morphism $g : Y \to Z$. Now we can find
distinguished triangles $(X, Y, Q_1, f, p_1, d_1)$,
$(X, Z, Q_2, g \circ f, p_2, d_2)$, and
$(Y, Z, Q_3, g, p_3, d_3)$ in $\mathcal{D}$ (by TR1), and
morphisms $a : Q_1 \to Q_2$ and $b : Q_2 \to Q_3$ as in TR4.
Then it is immediately verified that applying the functor $Q$ to
all these data gives a corresponding structure in $S^{-1}\mathcal{D}$
\end{proof}

\noindent
The universal property of the localization of a triangulated category
is as follows (we formulate this for pre-triangulated categories, hence
it holds a fortiori for triangulated categories).

\begin{lemma}
\label{lemma-universal-property-localization}
Let $\mathcal{D}$ be a pre-triangulated category. Let $S$ be a multiplicative
system compatible with the triangulated category. Let
$Q : \mathcal{D} \to S^{-1}\mathcal{D}$ be the localization functor, see
Proposition \ref{proposition-construct-localization}.
\begin{enumerate}
\item If $H : \mathcal{D} \to \mathcal{A}$ is a homological functor into
an abelian category $\mathcal{A}$ such that $H(s)$ is an isomorphism for
all $s \in S$, then the unique factorization
$H' : S^{-1}\mathcal{D} \to \mathcal{A}$ such that $H = H' \circ Q$ (see
Categories, Lemma \ref{categories-lemma-properties-left-localization})
is a homological functor too.
\item If $F : \mathcal{D} \to \mathcal{D}'$ is an exact functor into
a pre-triangulated category $\mathcal{D}'$ such that $F(s)$ is an isomorphism
for all $s \in S$, then the unique factorization
$F' : S^{-1}\mathcal{D} \to \mathcal{D}'$ such that $F = F' \circ Q$ (see
Categories, Lemma \ref{categories-lemma-properties-left-localization})
is an exact functor too.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma proves itself. Details omitted.
\end{proof}

\noindent
The following lemma describes the kernel (see
Definition \ref{definition-kernel-category})
of the localization functor.

\begin{lemma}
\label{lemma-kernel-localization}
Let $\mathcal{D}$ be a pre-triangulated category. Let $S$ be a multiplicative
system compatible with the triangulated structure. Let $Z$ be an object
of $\mathcal{D}$. The following are equivalent
\begin{enumerate}
\item $Q(Z) = 0$ in $S^{-1}\mathcal{D}$,
\item there exists $Z' \in \Ob(\mathcal{D})$ such that
$0 : Z \to Z'$ is an element of $S$,
\item there exists $Z' \in \Ob(\mathcal{D})$ such that
$0 : Z' \to Z$ is an element of $S$, and
\item there exists an object $Z'$ and a distinguished triangle
$(X, Y, Z \oplus Z', f, g, h)$ such that $f \in S$.
\end{enumerate}
If $S$ is saturated, then these are also equivalent to
\begin{enumerate}
\item[(4)] the morphism $0 \to Z$ is an element of $S$,
\item[(5)] the morphism $Z \to 0$ is an element of $S$,
\item[(6)] there exists a distinguished triangle $(X, Y, Z, f, g, h)$
such that $f \in S$.
\end{enumerate}
\end{lemma}

\begin{proof}
The equivalence of (1), (2), and (3) is
Homology, Lemma \ref{homology-lemma-kernel-localization}.
If (2) holds, then $(Z'[-1], Z'[-1] \oplus Z, Z, (1, 0), (0, 1), 0)$
is a distinguised triangle (see
Lemma \ref{lemma-split})
with ``$0 \in S$''. By rotating we conclude that (4) holds.
If $(X, Y, Z \oplus Z', f, g, h)$ is a distinguished triangle with $f \in S$
then $Q(f)$ is an isomorphism hence $Q(Z \oplus Z') = 0$ hence $Q(Z) = 0$.
Thus (1) -- (4) are all equivalent.

\medskip\noindent
Next, assume that $S$ is saturated. Note that each of (4), (5), (6)
implies one of the equivalent conditions (1) -- (4). Suppose that
$Q(Z) = 0$. Then $0 \to Z$ is a morphism of $\mathcal{D}$ which becomes
an isomorphism in $S^{-1}\mathcal{D}$. According to
Categories, Lemma \ref{categories-lemma-what-gets-inverted}
the fact that $S$ is saturated implies that $0 \to Z$ is in $S$.
Hence (1) $\Rightarrow$ (4). Dually (1) $\Rightarrow$ (5).
Finally, if $0 \to Z$ is in $S$, then the triangle
$(0, Z, Z, 0, \text{id}_Z, 0)$ is distinguished by TR1 and TR2 and
is a triangle as in (4).
\end{proof}

\begin{lemma}
\label{lemma-limit-triangles}
Let $\mathcal{D}$ be a triangulated category.
Let $S$ be a saturated multiplicative system in $\mathcal{D}$.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle in $\mathcal{D}$.
Consider the category of morphisms of triangles
$$
\mathcal{I} =
\{(s, s', s'') : (X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')
\mid (s, s', s'') \in S\}
$$
Then $\mathcal{I}$ is a filtered category and the functors
$\mathcal{I} \to X/S$, $\mathcal{I} \to Y/S$, and $\mathcal{I} \to Z/S$
are surjective on objects.
\end{lemma}

\begin{proof}
We strongly suggest the reader skip the proof of this lemma and instead
works it out on a napkin.
The category $\mathcal{I}$ is nonempty as the identity provides an object.
This proves the first condition of the definition of a filtered category, see
Categories, Definition \ref{categories-definition-directed}.

\medskip\noindent
Note that if $s : X \to X'$ is a morphism of $S$, then using
MS2 we can find $s' : Y \to Y'$ and $f' : X' \to Y'$ such that
$f' \circ s = s' \circ f$, whereupon we can use MS6 to complete
this into an object of $\mathcal{I}$. Hence certainly the surjectivity
statement is correct.

\medskip\noindent
Next we check condition (3) of
Categories, Definition \ref{categories-definition-directed}.
Suppose $(s_1, s_1', s_1'') : (X, Y, Z) \to (X_1, Y_1, Z_1)$ and
$(s_2, s_2', s_2'') : (X, Y, Z) \to (X_2, Y_2, Z_2)$
are objects of $\mathcal{I}$, and suppose $(a, b, c), (a', b', c')$
are two morphisms between them. Since $a \circ s_1 = a' \circ s_1$
there exists a morphism $s_3 : X_2 \to X_3$ such that
$s_3 \circ a = s_3 \circ a'$. Using the surjectivity statement
we can complete this to a morphism of triangles
$(s_3, s_3', s_3'') : (X_2, Y_2, Z_2) \to (X_3, Y_3, Z_3)$
with $s_3, s_3', s_3'' \in S$. Thus
$(s_3 \circ s_2, s_3' \circ s_2', s_3'' \circ s_2'') :
(X, Y, Z) \to (X_3, Y_3, Z_3)$ is also an object of $\mathcal{I}$
and after composing the maps $(a, b, c), (a', b', c')$ with
$(s_3, s_3', s_3'')$ we obtain $a = a'$. By rotating we may do the
same to get $b = b'$ and $c = c'$.

\medskip\noindent
Finally, we check condition (2) of
Categories, Definition \ref{categories-definition-directed}.
Suppose we are given two objects
$(s_1, s_1', s_1'') : (X, Y, Z) \to (X_1, Y_1, Z_1)$ and
$(s_2, s_2', s_2'') : (X, Y, Z) \to (X_2, Y_2, Z_2)$
of $\mathcal{I}$. Pick a morphism $s_3 : X \to X_3$
in $S$ such that there exist morphisms $a : X_1 \to X_3$ and
$a' : X_2 \to X_3$ with $s_3 = a \circ s_1$ and $s_3 = a' \circ s_2$.
Because $S$ is a saturated multiplicative system we see that $a' \in S$
(because $S$ is the set of arrows of $\mathcal{D}$ which are turned into
isomorphisms in $S^{-1}\mathcal{D}$, see
Categories, Lemma \ref{categories-lemma-what-gets-inverted}).
Hence, by the essential surjectivity above, we can find a morphism
$(a, b, c) : (X_2, Y_2, Z_2) \to (X_3, Y_3, Z_3)$ with $a, b, c \in S$
such that $X \to X_3$ factors through $X \to X_1$. Replacing
$(X_2, Y_2, Z_2)$ by $(X_3, Y_3, Z_3)$ and repeating this argument
twice more, we may assume that $s_2 = a \circ s_1$, $s_2' = b \circ s_1'$,
and $s_2'' = c \circ s_1''$. The problem is that it may not be the case
that $b \circ f_1 = f_2 \circ a$, etc, i.e., we don't know that
$(a, b, c)$ is a morphism of triangles from $(X_1, Y_1, Z_1)$ to
$(X_2, Y_2, Z_2)$. On the other hand, we do know that
$(a, b, c) \circ (s_1, s_1', s_1'')$ is a morphism of triangles.
Using MS3 one more time this means there exist morphisms
$s_3 : X_2 \to X_3$, $s_3' : Y_2 \to Y_3$, and $s_3'' : Z_2 \to Z_3$
in $S$ such that the required equalities hold after post-composing
with them, e.g., $s_3' \circ b \circ f_1 = s_3' \circ f_2 \circ a$, etc.
Using the essential surjectivity above once more we see that we may find
a morphism of triangles
$(s_4, s_4', s_4'') : (X_2, Y_2, Z_2) \to (X_4, Y_4, Z_4)$
with $s_4, s_4', s_4'' \in S$ such that
$s_4$ factors through $s_3$,
$s_4'$ factors through $s_3'$, and
$s_4''$ factors through $s_3''$.
We conclude that $(s_4 \circ a, s_4' \circ b, s_4'' \circ c)$ is a
morphism of triangles from $(X_1, Y_1, Z_1)$ to $(X_4, Y_4, Z_4)$.
\end{proof}









\section{Quotients of triangulated categories}
\label{section-quotients}

\noindent
Given a triangulated category and a triangulated subcategory we can
construct another triangulated category by taking the ``quotient''.
The construction uses a localization. This is similar to the quotient
of an abelian category by a Serre subcategory, see
Homology, Section \ref{homology-section-serre-subcategories}.
Before we do the actual construction we briefly discuss kernels
of exact functors.

\begin{definition}
\label{definition-saturated}
Let $\mathcal{D}$ be a pre-triangulated category. We say a full
pre-triangulated subcategory $\mathcal{D}'$ of $\mathcal{D}$ is
{\it saturated} if whenever $X \oplus Y$ is isomorphic to an object
of $\mathcal{D}'$ then both $X$ and $Y$ are isomorphic to objects
of $\mathcal{D}'$.
\end{definition}

\begin{lemma}
\label{lemma-triangle-functor-kernel}
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor of
pre-triangulated categories. Let $\mathcal{D}''$ be the full subcategory
of $\mathcal{D}$ with objects
$$
\Ob(\mathcal{D}'') =
\{X \in \Ob(\mathcal{D}) \mid F(X) = 0\}
$$
Then $\mathcal{D}''$ is a strictly full saturated pre-triangulated
subcategory of $\mathcal{D}$. If $\mathcal{D}$ is a triangulated category,
then $\mathcal{D}''$ is a triangulated subcategory.
\end{lemma}

\begin{proof}
It is clear that $\mathcal{D}''$ is preserved under $[1]$ and $[-1]$.
If $(X, Y, Z, f, g, h)$ is a distinguished triangle of $\mathcal{D}$
and $F(X) = F(Y) = 0$, then also $F(Z) = 0$ as
$(F(X), F(Y), F(Z), F(f), F(g), F(h))$ is distinguished.
Hence we may apply
Lemma \ref{lemma-triangulated-subcategory}
to see that $\mathcal{D}''$ is a pre-triangulated subcategory (respectively
a triangulated subcategory if $\mathcal{D}$ is a triangulated category).
The final assertion of being saturated follows from
$F(X) \oplus F(Y) = 0 \Rightarrow F(X) = F(Y) = 0$.
\end{proof}

\begin{lemma}
\label{lemma-homological-functor-kernel}
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor of
a pre-triangulated category into an abelian category.
Let $\mathcal{D}'$ be the full subcategory of $\mathcal{D}$ with objects
$$
\Ob(\mathcal{D}') =
\{X \in \Ob(\mathcal{D}) \mid
H(X[n]) = 0\text{ for all }n \in \mathbf{Z}\}
$$
Then $\mathcal{D}'$ is a strictly full saturated pre-triangulated subcategory
of $\mathcal{D}$. If $\mathcal{D}$ is a triangulated category, then
$\mathcal{D}'$ is a triangulated subcategory.
\end{lemma}

\begin{proof}
It is clear that $\mathcal{D}'$ is preserved under $[1]$ and $[-1]$.
If $(X, Y, Z, f, g, h)$ is a distinguished triangle of $\mathcal{D}$
and $H(X[n]) = H(Y[n]) = 0$ for all $n$, then also $H(Z[n]) = 0$ for all $n$
by the long exact sequence (\ref{equation-long-exact-cohomology-sequence}).
Hence we may apply
Lemma \ref{lemma-triangulated-subcategory}
to see that $\mathcal{D}'$ is a pre-triangulated subcategory (respectively
a triangulated subcategory if $\mathcal{D}$ is a triangulated category).
The assertion of being saturated follows from
\begin{align*}
H((X \oplus Y)[n]) = 0 & \Rightarrow H(X[n] \oplus Y[n]) = 0 \\
& \Rightarrow H(X[n]) \oplus H(Y[n]) = 0 \\
& \Rightarrow H(X[n]) = H(Y[n]) = 0
\end{align*}
for all $n \in \mathbf{Z}$.
\end{proof}

\begin{lemma}
\label{lemma-homological-functor-bounded}
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor of
a pre-triangulated category into an abelian category.
Let $\mathcal{D}_H^{+}, \mathcal{D}_H^{-}, \mathcal{D}_H^b$
be the full subcategory of $\mathcal{D}$ with objects
$$
\begin{matrix}
\Ob(\mathcal{D}_H^{+}) =
\{X \in \Ob(\mathcal{D}) \mid
H(X[n]) = 0\text{ for all }n \ll 0\} \\
\Ob(\mathcal{D}_H^{-}) =
\{X \in \Ob(\mathcal{D}) \mid
H(X[n]) = 0\text{ for all }n \gg 0\} \\
\Ob(\mathcal{D}_H^b) =
\{X \in \Ob(\mathcal{D}) \mid
H(X[n]) = 0\text{ for all }|n| \gg 0\}
\end{matrix}
$$
Each of these is a strictly full saturated pre-triangulated subcategory
of $\mathcal{D}$. If $\mathcal{D}$ is a triangulated category, then
each is a triangulated subcategory.
\end{lemma}

\begin{proof}
Let us prove this for $\mathcal{D}_H^{+}$.
It is clear that it is preserved under $[1]$ and $[-1]$.
If $(X, Y, Z, f, g, h)$ is a distinguished triangle of $\mathcal{D}$
and $H(X[n]) = H(Y[n]) = 0$ for all $n \ll 0$, then also $H(Z[n]) = 0$
for all $n \ll 0$ by the long exact sequence
(\ref{equation-long-exact-cohomology-sequence}).
Hence we may apply
Lemma \ref{lemma-triangulated-subcategory}
to see that $\mathcal{D}_H^{+}$ is a pre-triangulated subcategory
(respectively a triangulated subcategory if $\mathcal{D}$ is a
triangulated category). The assertion of being saturated follows from
\begin{align*}
H((X \oplus Y)[n]) = 0 & \Rightarrow H(X[n] \oplus Y[n]) = 0 \\
& \Rightarrow H(X[n]) \oplus H(Y[n]) = 0 \\
& \Rightarrow H(X[n]) = H(Y[n]) = 0
\end{align*}
for all $n \in \mathbf{Z}$.
\end{proof}

\begin{definition}
\label{definition-kernel-category}
Let $\mathcal{D}$ be a (pre-)triangulated category.
\begin{enumerate}
\item Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor.
The {\it kernel of $F$} is the strictly full saturated
(pre-)triangulated subcategory described in
Lemma \ref{lemma-triangle-functor-kernel}.
\item Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor.
The {\it kernel of $H$} is the strictly full saturated
(pre-)triangulated subcategory described in
Lemma \ref{lemma-homological-functor-kernel}.
\end{enumerate}
These are sometimes denoted $\text{Ker}(F)$ or $\text{Ker}(H)$.
\end{definition}

\noindent
The proof of the following lemma uses TR4.

\begin{lemma}
\label{lemma-construct-multiplicative-system}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{D}' \subset \mathcal{D}$ be a full triangulated
subcategory. Set
\begin{equation}
\label{equation-multiplicative-system}
S =
\left\{
\begin{matrix}
f \in \text{Arrows}(\mathcal{D})
\text{ such that there exists a distinguished triangle }\\
(X, Y, Z, f, g, h) \text{ of }\mathcal{D}\text{ with }
Z\text{ isomorphic to an object of }\mathcal{D}'
\end{matrix}
\right\}
\end{equation}
Then $S$ is a multiplicative system compatible with the triangulated
structure on $\mathcal{D}$. In this situation the following are equivalent
\begin{enumerate}
\item $S$ is a saturated multiplicative system,
\item $\mathcal{D}'$ is a saturated triangulated subcategory.
\end{enumerate}
\end{lemma}

\begin{proof}
To prove the first assertion we have to prove that
MS1, MS2, MS3 and MS5, MS6 hold.

\medskip\noindent
Proof of MS1. It is clear that identities are in $S$ because
$(X, X, 0, 1, 0, 0)$ is distinguished for every object $X$ of $\mathcal{D}$
and because $0$ is an object of $\mathcal{D}'$. Let $f : X \to Y$
and $g : Y \to Z$ be composable morphisms contained in $S$.
Choose distinguished triangles $(X, Y, Q_1, f, p_1, d_1)$,
$(X, Z, Q_2, g \circ f, p_2, d_2)$, and $(Y, Z, Q_3, g, p_3, d_3)$.
By assumption we know that $Q_1$ and $Q_3$ are isomorphic to objects
of $\mathcal{D}'$. By TR4 we know there exists a distinguished
triangle $(Q_1, Q_2, Q_3, a, b, c)$. Since $\mathcal{D}'$ is a
triangulated subcategory we conclude that $Q_2$ is isomorphic to
an object of $\mathcal{D}'$. Hence $g \circ f \in S$.

\medskip\noindent
Proof of MS3. Let $a : X \to Y$ be a morphism and let $t : Z \to X$ be
an element of $S$ such that $a \circ t = 0$. To prove LMS3 we have to
find a $s \in S$ such that $s \circ a = 0$. Choose a distinguished
triangle $(Z, X, Q, t, g, h)$ using TR1 and TR2. Since $a \circ t = 0$
we see by
Lemma \ref{lemma-representable-homological}
there exists a morphism $i : Q \to Y$ such that $i \circ g = a$.
Finally, using TR1 again we can choose a triangle
$(Q, Y, W, i, j, k)$. Here is a picture
$$
\xymatrix{
Z \ar[r]_t & X \ar[r]_g \ar[d]^1 & Q \ar[r] \ar[d]^i & Z[1] \\
& X \ar[r]_a & Y \ar[d]^j \\
& & W
}
$$
Since $t \in S$ we see that $Q$ is isomorphic to an object of $\mathcal{D}'$.
Hence $j \in S$. Finally, $j \circ a = j \circ i \circ g = 0$ as
$j \circ i = 0$. Thus $j \circ f = j \circ g$ and we see that LMS3 holds.
The proof of RMS3 is dual.

\medskip\noindent
Proof of MS5. Follows as distinguished triangles and $\mathcal{D}'$
are stable under translations

\medskip\noindent
Proof of MS6. Suppose given a commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^s &
Y \ar[d]^{s'} \\
X' \ar[r] &
Y'
}
$$
with $s, s' \in S$. By
Proposition \ref{proposition-9}
we can extend this to a nine square diagram. As $s, s'$ are elments of $S$
we see that $X'', Y''$ are isomorphic to objects of $\mathcal{D}'$.
Since $\mathcal{D}'$ is a full triangulated subcategory we see that
$Z''$ is also an object of $\mathcal{D}'$. Whence the morphism $Z' \to Z''$
is an element of $S$. This proves MS6.

\medskip\noindent
MS2 is a formal consquence of MS1, MS5, and MS6, see
Lemma \ref{lemma-localization-conditions}.
This finishes the proof of the first assertion of the lemma.

\medskip\noindent
Let's assume that $S$ is saturated. (In the following we will use
rotation of distinguished triangles without further mention.)
Let $X \oplus Y$ be an object isomorphic to an object of $\mathcal{D}'$.
Consider the morphism $f : 0 \to X$. The composition
$0 \to X \to X \oplus Y$ is an element
of $S$ as $(0, X \oplus Y, X \oplus Y, 0, 1, 0)$ is a distinguished
triangle. The composition $Y[-1] \to 0 \to X$ is an element of $S$
as $(X, X \oplus Y, Y, (1, 0), (0, 1), 0)$ is a distinguished triangle, see
Lemma \ref{lemma-split}.
Hence $0 \to X$ is an element of $S$ (as $S$ is saturated).
Thus $X$ is isomorphic to an object of $\mathcal{D}'$ as desired.

\medskip\noindent
Finally, assume $\mathcal{D}'$ satisfies condition (2) of the lemma.
Let
$$
W \xrightarrow{h}
X \xrightarrow{g}
Y \xrightarrow{f} Z
$$
be composable morphisms of $\mathcal{D}$ such that $fg, gh \in S$.
We will build up a picture of objects as in the diagram below.
$$
\xymatrix{
 & &
Q_{12} \ar[ld]_{\!+\!1} & &
Q_{23} \ar[ld]_{\!+\!1} \ar[ll]_{\!+\!1} \\
 &
Q_1 \ar[ld]_{\!+\!1} & &
Q_2 \ar[ld]_{\!+\!1} \ar[ll]_{\!+\!1} \ar[lu] & &
Q_3 \ar[ld]_{\!+\!1} \ar[ll]_{\!+\!1} \ar[lu] \\
W \ar[rr] & &
X \ar[lu] \ar[rr] & &
Y \ar[lu] \ar[rr] & &
Z \ar[lu]
}
$$
First choose distinguished triangles
$(W, X, Q_1)$, $(X, Y, Q_2)$, $(Y, Z, Q_3)$ $(W, Y, Q_{12})$, and
$(X, Z, Q_{23})$. Denote $s : Q_2 \to Q_1[1]$ the composition
$Q_2 \to X[1] \to Q_1[1]$. Denote $t : Q_3 \to Q_2[1]$ the
composition $Q_3 \to Y[1] \to Q_2[1]$.
By TR4 applied to the composition $W \to X \to Y$
and the composition $X \to Y \to Z$ there exist
a distinguished triangles $(Q_1, Q_{12}, Q_2)$ and $(Q_2, Q_{23}, Q_3)$
which use the morphisms $s$ and $t$.
The objects $Q_{12}$ and $Q_{23}$ are isomorphic to objects of
$\mathcal{D}'$ as $W \to Y$ and $X \to Z$ are assumed in $S$.
Hence also $s[1]t$ is an element of $S$ as $S$ is closed under compositions
and shifts.
Note that $s[1]t = 0$ as $Y[1] \to Q_2[1] \to X[2]$ is zero, see
Lemma \ref{lemma-composition-zero}.
Hence $Q_3 \oplus Q_1[2]$ is isomorphic to an object of $\mathcal{D}'$, see
Lemma \ref{lemma-split}.
By assumption on $\mathcal{D}'$ we conclude that $Q_3, Q_1$ are isomorphic
to objects of $\mathcal{D}'$. Looking at the distinguished triangle
$(Q_1, Q_{12}, Q_2)$ we conclude that $Q_2$ is also isomorphic to
an object of $\mathcal{D}'$. Looking at the distinguished triangle
$(X, Y, Q_2)$ we finally conclude that $g \in S$. (It is also
follows that $h, f \in S$, but we don't need this.)
\end{proof}

\begin{definition}
\label{definition-quotient-category}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{B}$ be a full triangulated subcategory.
We define the {\it quotient category $\mathcal{D}/\mathcal{B}$}
by the formula $\mathcal{D}/\mathcal{B} = S^{-1}\mathcal{D}$, where
$S$ is the multiplicative system of $\mathcal{D}$ associated to
$\mathcal{B}$ via
Lemma \ref{lemma-construct-multiplicative-system}.
The localization functor $Q : \mathcal{D} \to \mathcal{D}/\mathcal{B}$
is called the {\it quotient functor} in this case.
\end{definition}

\noindent
Note that the quotient functor
$Q : \mathcal{D} \to \mathcal{D}/\mathcal{B}$
is an exact functor of triangulated categories, see
Proposition \ref{proposition-construct-localization}.
The universal property of this construction is the following.

\begin{lemma}
\label{lemma-universal-property-quotient}
Let $\mathcal{D}$ be a triangulated category. Let $\mathcal{B}$
be a full triangulated subcategory of $\mathcal{D}$. Let
$Q : \mathcal{D} \to \mathcal{D}/\mathcal{B}$ be the quotient functor.
\begin{enumerate}
\item If $H : \mathcal{D} \to \mathcal{A}$ is a homological functor into
an abelian category $\mathcal{A}$ such that
$\mathcal{B} \subset \text{Ker}(H)$ then there exists a unique factorization
$H' : \mathcal{D}/\mathcal{B} \to \mathcal{A}$ such that $H = H' \circ Q$
and $H'$ is a homological functor too.
\item If $F : \mathcal{D} \to \mathcal{D}'$ is an exact functor into
a pre-triangulated category $\mathcal{D}'$ such that
$\mathcal{B} \subset \text{Ker}(F)$ then there exists a unique factorization
$F' : \mathcal{D}/\mathcal{B} \to \mathcal{D}'$ such that $F = F' \circ Q$
and $F'$ is an exact functor too.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma follows from
Lemma \ref{lemma-universal-property-localization}.
Namely, if $f : X \to Y$ is a morphism of $\mathcal{D}$
such that for some distinguished triangle $(X, Y, Z, f, g, h)$
the object $Z$ is isomorphic to an object of $\mathcal{B}$, then
$H(f)$, resp.\ $F(f)$ is an isomorphism under the assumptions of
(1), resp.\ (2). Details omitted.
\end{proof}

\noindent
The kernel of the quotient functor can be described as follows.

\begin{lemma}
\label{lemma-kernel-quotient}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{B}$ be a full triangulated subcategory.
The kernel of the quotient functor
$Q : \mathcal{D} \to \mathcal{D}/\mathcal{B}$
is the strictly full subcategory of $\mathcal{D}$ whose objects are
$$
\Ob(\text{Ker}(Q)) =
\left\{
\begin{matrix}
Z \in \Ob(\mathcal{D})
\text{ such that there exists a }Z' \in \Ob(\mathcal{D}) \\
\text{ such that }Z \oplus Z'\text{ is isomorphic to an object of }\mathcal{B}
\end{matrix}
\right\}
$$
In other words it is the smallest strictly full saturated triangulated
subcategory of $\mathcal{D}$ containing $\mathcal{B}$.
\end{lemma}

\begin{proof}
First note that the kernel is automatically a strictly full
triangulated subcategory stable containing summands of any of its objects, see
Lemma \ref{lemma-triangle-functor-kernel}.
The description of its objects follows from the definitions and
Lemma \ref{lemma-kernel-localization} part (4).
\end{proof}

\noindent
Let $\mathcal{D}$ be a triangulated category.
At this point we have constructions which induce order
preserving maps between
\begin{enumerate}
\item the partially ordered set of multiplicative systems $S$ in $\mathcal{D}$
compatible with the triangulated structure, and
\item the partially ordered set of full triangulated subcategories
$\mathcal{B} \subset \mathcal{D}$.
\end{enumerate}
Namely, the constructions are given by
$S \mapsto \mathcal{B}(S) = \text{Ker}(Q : \mathcal{D} \to S^{-1}\mathcal{D})$
and $\mathcal{B} \mapsto S(\mathcal{B})$
where $S(\mathcal{B})$ is the multiplicative set of
(\ref{equation-multiplicative-system}), i.e.,
$$
S(\mathcal{B}) =
\left\{
\begin{matrix}
f \in \text{Arrows}(\mathcal{D})
\text{ such that there exists a distinguished triangle }\\
(X, Y, Z, f, g, h) \text{ of }\mathcal{D}\text{ with }
Z\text{ isomorphic to an object of }\mathcal{B}
\end{matrix}
\right\}
$$
Note that it is not the case that these operations are mutually inverse.

\begin{lemma}
\label{lemma-operations}
Let $\mathcal{D}$ be a triangulated category. The operations described above
have the following properties
\begin{enumerate}
\item $S(\mathcal{B}(S))$ is the ``saturation'' of $S$, i.e., it is the
smallest saturated multiplicative system in $\mathcal{D}$ containing $S$, and
\item $\mathcal{B}(S(\mathcal{B}))$ is the ``saturation'' of $\mathcal{B}$,
i.e., it is the smallest strictly full saturated triangulated subcategory of
$\mathcal{D}$ containing $\mathcal{B}$.
\end{enumerate}
In particular, the constructions define mutually inverse maps between
the (partially ordered) set of saturated multiplicative systems in
$\mathcal{D}$ compatible with the triangulated structure on $\mathcal{D}$
and
the (partially ordered) set of strictly full saturated triangulated
subcategories of $\mathcal{D}$.
\end{lemma}

\begin{proof}
First, let's start with a full triangulated subcategory $\mathcal{B}$. Then
$\mathcal{B}(S(\mathcal{B})) =
\text{Ker}(Q : \mathcal{D} \to \mathcal{D}/\mathcal{B})$
and hence (2) is the content of
Lemma \ref{lemma-kernel-quotient}.

\medskip\noindent
Next, suppose that $S$ is multiplicative system in $\mathcal{D}$ compatible
with the triangulation on $\mathcal{D}$. Then
$\mathcal{B}(S) = \text{Ker}(Q : \mathcal{D} \to S^{-1}\mathcal{D})$.
Hence (using
Lemma \ref{lemma-third-object-zero}
in the localized category)
\begin{align*}
S(\mathcal{B}(S))
& =
\left\{
\begin{matrix}
f \in \text{Arrows}(\mathcal{D})
\text{ such that there exists a distinguished}\\
\text{triangle }(X, Y, Z, f, g, h) \text{ of }\mathcal{D}\text{ with }Q(Z) = 0
\end{matrix}
\right\}
\\
& =
\{f \in \text{Arrows}(\mathcal{D}) \mid Q(f)\text{ is an isomorphism}\} \\
& = \hat S = S'
\end{align*}
in the notation of
Categories, Lemma \ref{categories-lemma-what-gets-inverted}.
The final statement of that lemma finishes the proof.
\end{proof}

\begin{lemma}
\label{lemma-acyclic-general}
Let $H : \mathcal{D} \to \mathcal{A}$ be a homological functor from a
triangulated category $\mathcal{D}$ to an abelian category $\mathcal{A}$, see
Definition \ref{definition-homological}.
The subcategory $\text{Ker}(H)$ of $\mathcal{D}$ is a strictly full
saturated triangulated subcategory of $\mathcal{D}$ whose corresponding
saturated multiplicative system (see
Lemma \ref{lemma-operations})
is the set
$$
S = \{f \mid H^i(f)\text{ is an isomorphism for all }i \in \mathbf{Z}\}.
$$
The functor $H$ factors through the quotient functor
$Q : \mathcal{D} \to \mathcal{D}/\text{Ker}(H)$.
\end{lemma}

\begin{proof}
The category $\text{Ker}(H)$ is a strictly full saturated triangulated
subcategory of $\mathcal{D}$ by
Lemma \ref{lemma-homological-functor-kernel}.
The set $S$ is a saturated multiplicative system compatible with the
triangulated structure by
Lemma \ref{lemma-homological-functor-localize}.
Recall that the multiplicative system corresponding to
$\text{Ker}(H)$ is the set
$$
\left\{
\begin{matrix}
f \in \text{Arrows}(K(\mathcal{A}))
\text{ such that there exists a distinguished triangle }\\
(X, Y, Z, f, g, h)\text{ with } H^i(Z) = 0 \text{ for all }i
\end{matrix}
\right\}
$$
By the long exact cohomology sequence, see
(\ref{equation-long-exact-cohomology-sequence}),
it is clear that $f$ is an element of this set if and only if $f$ is
an element of $S$. Finally, the factorization of $H$ through $Q$ is a
consequence of
Lemma \ref{lemma-universal-property-quotient}.
\end{proof}

\noindent
It is clear that in the lemma above the factorization of $H$ through
$\mathcal{D}/\text{Ker}(H)$ is the universal factorization. Namely, if
$F : \mathcal{D} \to \mathcal{D}'$ is an exact functor of triangulated
categories and if there exists a homological functor
$H' : \mathcal{D}' \to \mathcal{A}$ such that $H \cong H' \circ F$, then
$F$ factors through the quotient functor
$Q : \mathcal{D} \to \mathcal{D}/\text{Ker}(H)$.








\section{The homotopy category}
\label{section-homotopy}

\noindent
Let $\mathcal{A}$ be an additive category. The homotopy category
$K(\mathcal{A})$ of $\mathcal{A}$ is the the category of complexes of
$\mathcal{A}$ with morphisms given by morphisms of complexes up to homotopy.
Here is the formal definition.

\begin{definition}
\label{definition-complexes-notation}
Let $\mathcal{A}$ be an additive category.
\begin{enumerate}
\item We set $\text{Comp}(\mathcal{A}) = \text{CoCh}(\mathcal{A})$
be the {\it category of (cochain) complexes}.
\item A complex $K^\bullet$ is said to be
{\it bounded below} if $K^n = 0$ for all $n \ll 0$.
\item A complex $K^\bullet$ is said to be
{\it bounded above} if $K^n = 0$ for all $n \gg 0$.
\item A complex $K^\bullet$ is said to be
{\it bounded} if $K^n = 0$ for all $|n| \gg 0$.
\item We let
$\text{Comp}^{+}(\mathcal{A})$, $\text{Comp}^{-}(\mathcal{A})$,
resp.\ $\text{Comp}^b(\mathcal{A})$ be the full subcategory
of $\text{Comp}(\mathcal{A})$ whose objects are the complexes
which are bounded below, bounded above, resp.\ bounded.
\item We let $K(\mathcal{A})$ be the category with the same objects
as $\text{Comp}(\mathcal{A})$ but as morphisms homotopy classes of
maps of complexes (see
Homology, Lemma \ref{homology-lemma-compose-homotopy-cochain}).
\item We let $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$,
resp.\ $K^b(\mathcal{A})$ be the full subcategory of $K(\mathcal{A})$
whose objects are bounded below, bounded above, resp.\ bounded
complexes of $\mathcal{A}$.
\end{enumerate}
\end{definition}

\noindent
It will turn out that the categories $K(\mathcal{A})$,
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
are triangulated categories. To prove this we first develop
some machinery related to cones and split exact sequences.




\section{Cones and termwise split sequences}
\label{section-cones}

\noindent
Let $\mathcal{A}$ be an additive category, and let
$K(\mathcal{A})$ denote the category of complexes of
$\mathcal{A}$ with morphisms given by morphisms of
complexes up to homotopy. Note that the shift functors
$[n]$ on complexes, see
Homology, Definition \ref{homology-definition-shift-cochain},
give rise to functors $[n] : K(\mathcal{A}) \to K(\mathcal{A})$
such that $[n] \circ [m] = [n + m]$ and $[0] = \text{id}$.

\begin{definition}
\label{definition-cone}
Let $\mathcal{A}$ be an additive category.
Let $f : K^\bullet \to L^\bullet$ be a morphism of
complexes of $\mathcal{A}$. The {\it cone} of $f$
is the complex $C(f)^\bullet$ given by
$C(f)^n = L^n \oplus K^{n + 1}$ and
differential
$$
d_{C(f)}^n =
\left(
\begin{matrix}
d^n_L & f^{n + 1} \\
0 & -d_K^{n + 1}
\end{matrix}
\right)
$$
It comes equipped with canonical morphisms of complexes
$i : L^\bullet \to C(f)^\bullet$ and $p : C(f)^\bullet \to K^\bullet[1]$
induced by the obvious maps $L^n \to C(f)^n \to K^{n + 1}$.
\end{definition}

\noindent
In other words $(K, L, C(f), f, i, p)$ forms a triangle:
$$
K^\bullet \to L^\bullet \to C(f)^\bullet \to K^\bullet[1]
$$
The formation of this triangle is
functorial in the following sense.

\begin{lemma}
\label{lemma-functorial-cone}
Suppose that
$$
\xymatrix{
K_1^\bullet \ar[r]_{f_1} \ar[d]_a & L_1^\bullet \ar[d]^b \\
K_2^\bullet \ar[r]^{f_2} & L_2^\bullet
}
$$
is a diagram of morphisms of complexes which is commutative
up to homotopy. Then there exists a morphism
$c : C(f_1)^\bullet \to C(f_2)^\bullet$ which gives rise to
a morphism of triangles
$(a, b, c) : (K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_1, i_1, p_1)
\to
(K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_2, i_2, p_2)$
of $K(\mathcal{A})$.
\end{lemma}

\begin{proof}
Let $h^n : K_1^n \to L_2^{n - 1}$ be a family of morphisms such that
$f_2 \circ a - b \circ f_1 = d \circ h + h \circ d$.
Define $c^n$ by the matrix
$$
c^n =
\left(
\begin{matrix}
a^n & h^{n + 1} \\
0 & b^n
\end{matrix}
\right) :
L_1^n \oplus K_1^{n + 1} \to L_2^n \oplus K_2^{n + 1}
$$
A matrix computation show that $c$ is a morphism of complexes.
It is trivial that $c \circ i_1 = i_2 \circ b$, and it is
trivial also to check that $p_2 \circ c = a \circ p_1$.
\end{proof}

\noindent
Note that the morphism $c : C(f_1)^\bullet \to C(f_2)^\bullet$
constructed in the
proof of Lemma \ref{lemma-functorial-cone} in general depends on the
chosen homotopy $h$ between $f_2 \circ a$ and $b \circ f_1$.

\begin{definition}
\label{definition-termwise-split-map}
Let $\mathcal{A}$ be an additive category.
A {\it termwise split injection $\alpha : A^\bullet \to B^\bullet$}
is a morphism of complexes such that each $A^n \to B^n$
is isomorphic to the inclusion of a direct summand.
A {\it termwise split surjection $\beta : B^\bullet \to C^\bullet$}
is a morphism of complexes such that each $B^n \to C^n$
is isomorphic to the projection onto a direct summand.
\end{definition}

\begin{lemma}
\label{lemma-make-commute-map}
Let $\mathcal{A}$ be an additive category.
Let
$$
\xymatrix{
A^\bullet \ar[r]_f \ar[d]_a & B^\bullet \ar[d]^b \\
C^\bullet \ar[r]^g & D^\bullet
}
$$
be a diagram of morphisms of complexes commuting up to homotopy.
If $f$ is a split injection, then $b$ is homotopic to a
morphism which makes the diagram commute.
If $g$ is a split surjection, then $a$ is homotopic to a
morphism which makes the diagram commute.
\end{lemma}

\begin{proof}
Let $h^n : A^n \to D^{n - 1}$ be a collection of morphisms
such that $bf - ga = dh + hd$. Suppose that $\pi^n : B^n \to A^n$
are morphisms splitting the morphisms $f^n$.
Take $b' = b + dh\pi + h\pi d$.
Suppose $s^n : D^n \to C^n$ are morphisms splitting the morphisms
$g^n : C^n \to D^n$. Take $a' = a + dsh + shd$.
Computations omitted.
\end{proof}


\noindent
The following lemma can be used to replace an morphism of complexes
by a morphism where in each degree the map is the injection of a
direct summand.

\begin{lemma}
\label{lemma-make-injective}
Let $\mathcal{A}$ be an additive category.
Let $\alpha : K^\bullet \to L^\bullet$ be a morphism
of complexes of $\mathcal{A}$.
There exists a factorization
$$
\xymatrix{
K^\bullet \ar[r]^{\tilde \alpha} \ar@/_1pc/[rr]_\alpha &
\tilde L^\bullet \ar[r]^\pi &
L^\bullet
}
$$
such that
\begin{enumerate}
\item $\tilde \alpha$ is a termwise split injection (see
Definition \ref{definition-termwise-split-map}),
\item there is a map of complexes $s : L^\bullet \to \tilde L^\bullet$
such that $\pi \circ s = \text{id}_{L^\bullet}$ and such that
$s \circ \pi$ is homotopic to $\text{id}_{\tilde L^\bullet}$.
\end{enumerate}
Moreover, if both $K^\bullet$ and $L^\bullet$ are in
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$,
then so is $\tilde L^\bullet$.
\end{lemma}

\begin{proof}
We set
$$
\tilde L^n = L^n \oplus K^n \oplus K^{n + 1}
$$
and we define
$$
d^n_{\tilde L} =
\left(
\begin{matrix}
d^n_L & 0 & 0 \\
0 & d^n_K & \text{id}_{K^{n + 1}} \\
0 & 0 & -d^{n + 1}_K
\end{matrix}
\right)
$$
Moreover, we set
$$
\tilde \alpha =
\left(
\begin{matrix}
\alpha \\
\text{id}_{K^n} \\
0
\end{matrix}
\right)
$$
which is clearly a split injection. It is also clear that it defines a morphism
of complexes. We define
$$
\pi =
\left(
\begin{matrix}
\text{id}_{L^n} &
0 &
0
\end{matrix}
\right)
$$
so that clearly $\pi \circ \tilde \alpha = \alpha$. We set
$$
s =
\left(
\begin{matrix}
\text{id}_{L^n} \\
0 \\
0
\end{matrix}
\right)
$$
so that $\pi \circ s = \text{id}_{L^\bullet}$. Finally,
let $h^n : \tilde L^n \to \tilde L^{n - 1}$ be the map
which maps the summand $K^n$ of $\tilde L^n$ via the identity morphism
to the summand $K^n$ of $\tilde L^{n - 1}$. Then it is a trivial matter
(see computations in remark below) to prove that
$$
\text{id}_{\tilde L^\bullet} - s \circ \pi
=
d \circ h + h \circ d
$$
which finishes the proof of the lemma.
\end{proof}

\begin{remark}
\label{remark-compute-modules}
To see the last displayed equality in the proof above we can argue
with elements as follows. We have
$s\pi(l, k, k^{+}) = (l, 0, 0)$.
Hence the morphism of the left hand side maps
$(l, k, k^{+})$ to $(0, k, k^{+})$.
On the other hand $h(l, k, k^{+}) = (0, 0, k)$ and
$d(l, k, k^{+}) = (dl, dk + k^{+}, -dk^{+})$.
Hence $(dh + hd)(l, k, k^{+}) =
d(0, 0, k) + h(dl, dk + k^{+}, -dk^{+}) =
(0, k, -dk) + (0, 0, dk + k^{+}) = (0, k, k^{+})$
as desired.
\end{remark}

\begin{lemma}
\label{lemma-make-surjective}
Let $\mathcal{A}$ be an additive category.
Let $\alpha : K^\bullet \to L^\bullet$ be a morphism
of complexes of $\mathcal{A}$.
There exists a factorization
$$
\xymatrix{
K^\bullet \ar[r]^i \ar@/_1pc/[rr]_\alpha &
\tilde K^\bullet \ar[r]^{\tilde \alpha} &
L^\bullet
}
$$
such that
\begin{enumerate}
\item $\tilde \alpha$ is a termwise split surjection (see
Definition \ref{definition-termwise-split-map}),
\item there is a map of complexes $s : \tilde K^\bullet \to K^\bullet$
such that $s \circ i = \text{id}_{K^\bullet}$ and such that
$i \circ s$ is homotopic to $\text{id}_{\tilde K^\bullet}$.
\end{enumerate}
Moreover, if both $K^\bullet$ and $L^\bullet$ are in
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$,
then so is $\tilde K^\bullet$.
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-make-injective}.
Take
$$
\tilde K^n = K^n \oplus L^n \oplus L^{n + 1}
$$
and we define
$$
d^n_{\tilde K} =
\left(
\begin{matrix}
d^n_K & 0 & 0 \\
0 & d^n_L & \text{id}_{L^{n + 1}} \\
0 & 0 & -d^{n + 1}_L
\end{matrix}
\right)
$$
Moreover, we set
$$
\tilde \alpha =
\left(
\begin{matrix}
\alpha &
\text{id}_{L^n} &
0
\end{matrix}
\right)
$$
which is clearly a split surjection. It is also clear that it defines a
morphism of complexes. We define
$$
i =
\left(
\begin{matrix}
\text{id}_{K^n} \\
0 \\
0
\end{matrix}
\right)
$$
so that clearly $\tilde \alpha \circ i = \alpha$. We set
$$
s =
\left(
\begin{matrix}
\text{id}_{K^n} &
0 &
0
\end{matrix}
\right)
$$
so that $s \circ i = \text{id}_{K^\bullet}$. Finally,
let $h^n : \tilde K^n \to \tilde K^{n - 1}$ be the map
which maps the summand $L^n$ of $\tilde K^n$ via the identity morphism
to the summand $L^n$ of $\tilde K^{n - 1}$. Then it is a trivial matter
to prove that
$$
\text{id}_{\tilde K^\bullet} - i \circ s
=
d \circ h + h \circ d
$$
which finishes the proof of the lemma.
\end{proof}

\begin{definition}
\label{definition-split-ses}
Let $\mathcal{A}$ be an additive category.
A {\it termwise split sequence of complexes of $\mathcal{A}$}
is a complex of complexes
$$
0 \to
A^\bullet \xrightarrow{\alpha}
B^\bullet \xrightarrow{\beta}
C^\bullet \to 0
$$
together with given direct sum decompositions
$B^n = A^n \oplus C^n$
compatible with $\alpha^n$ and $\beta^n$.
We often write $s^n : C^n \to B^n$ and $\pi^n : B^n \to A^n$
for the maps induced by the direct sum decompositions.
According to
Homology, Lemma \ref{homology-lemma-ses-termwise-split-cochain}
we get an associated morphism of complexes
$$
\delta : C^\bullet \longrightarrow A^\bullet[1]
$$
which in degree $n$ is the map $\pi^{n + 1} \circ d_C^n \circ s^n$.
In other words
$(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
forms a triangle
$$
A^\bullet \to B^\bullet \to C^\bullet \to A^\bullet[1]
$$
This will be the {\it triangle associated to the termwise
split sequence of complexes}.
\end{definition}

\begin{lemma}
\label{lemma-triangle-independent-splittings}
Let $\mathcal{A}$ be an additive category. Let
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
be termwise split exact sequences as in
Definition \ref{definition-split-ses}.
Let $(\pi')^n$, $(s')^n$ be a second collection of splittings.
Denote $\delta' : C^\bullet \longrightarrow A^\bullet[1]$ the
morphism associated to this second set of splittings.
Then
$$
(1, 1, 1) :
(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)
\longrightarrow
(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta')
$$
is an isomorphism of triangles in $K(\mathcal{A})$.
\end{lemma}

\begin{proof}
The statement simply means that $\delta$ and $\delta'$ are
homotopic maps of complexes. This is
Homology, Lemma \ref{homology-lemma-ses-termwise-split-homotopy-cochain}.
\end{proof}

\begin{lemma}
\label{lemma-make-commute}
Let $\mathcal{A}$ be an additive category.
Let $0 \to A_i^\bullet \to B_i^\bullet \to C_i^\bullet \to 0$, $i = 1, 2$
be termwise split exact sequences. Suppose that
$a : A_1^\bullet \to A_2^\bullet$,
$b : B_1^\bullet \to B_2^\bullet$, and
$c : C_1^\bullet \to C_2^\bullet$ are morphisms of complexes
such that
$$
\xymatrix{
A_1^\bullet \ar[d]_a \ar[r] &
B_1^\bullet \ar[r] \ar[d]_b &
C_1^\bullet \ar[d]_c \\
A_2^\bullet \ar[r] & B_2^\bullet \ar[r] & C_2^\bullet
}
$$
commutes in $K(\mathcal{A})$. Then there exists a morphism
$b' : B_1^\bullet \to B_2^\bullet$
which is homotopic to $b$ such that the diagram above commutes
in the category of complexes.
\end{lemma}

\begin{proof}
Let $f^n : A_1^n \to B_2^{n - 1}$ be a collection of morphisms
such that $b \circ \alpha_1 - \alpha_2 \circ a =
d  \circ f + f \circ d$. Let
$g^n : B_1^n \to C_2^{n - 1}$ be a collection of morphisms
such that $c \circ \beta_1 - \beta_2 \circ b =
d  \circ g + g \circ d$. Suppose that
$\pi^n : B_1^n \to A_1^n$ (resp.\ $s^n : C_2^n \to B_2^n$)
are the morphisms splitting the morphisms $\alpha_1^n$
(resp.\ $\beta_2^n$). Set $h^n = - f^n \circ \pi^n + s^{n - 1} \circ g^n$.
Take $b' = b + d \circ h + h \circ d$. Computation omitted.
\end{proof}

\begin{lemma}
\label{lemma-third-isomorphism}
Let $\mathcal{A}$ be an additive category.
Let $f_1 : K_1^\bullet \to L_1^\bullet$ and
$f_2 : K_2^\bullet \to L_2^\bullet$ be morphisms of complexes.
Let
$$
(a, b, c) :
(K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_1, i_1, p_1)
\longrightarrow
(K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_2, i_2, p_2)
$$
be any morphism of triangles of $K(\mathcal{A})$.
If $a$ and $b$ are homotopy equivalences then so is $c$.
\end{lemma}

\begin{proof}
Let $a^{-1} : K_2^\bullet \to K_1^\bullet$ be a morphism of complexes which
is inverse to $a$ in $K(\mathcal{A})$.
Let $b^{-1} : L_2^\bullet \to L_1^\bullet$ be a morphism of complexes which
is inverse to $b$ in $K(\mathcal{A})$.
Let $c' : C(f_2)^\bullet \to C(f_1)^\bullet$
be the morphism from Lemma \ref{lemma-functorial-cone} applied
to $f_1 \circ a^{-1} = b^{-1} \circ f_2$. If we can show that
$c \circ c'$ and $c' \circ c$ are isomorphisms in $K(\mathcal{A})$
then we win. Hence it suffices to prove the following: Given
a morphism of triangles
$(1, 1, c) : (K^\bullet, L^\bullet, C(f)^\bullet, f, i, p)$
in $K(\mathcal{A})$ the morphism $c$ is an isomorphism in $K(\mathcal{A})$.
By assumption the two squares in the diagram
$$
\xymatrix{
L^\bullet \ar[r] \ar[d]_1 &
C(f)^\bullet \ar[r] \ar[d]_c &
K^\bullet[1] \ar[d]_1 \\
L^\bullet \ar[r] &
C(f)^\bullet \ar[r] &
K^\bullet[1]
}
$$
commute up to homotopy. By construction of $C(f)^\bullet$ the rows
form termwise split sequences of complexes.
By Lemma \ref{lemma-make-commute} we may replace $c$ by
a morphism homotopic to $c$ such that the diagram commutes in the
category of complexes. In this case each $c^n$ is an isomorphism
(because an upper triangular matrix with $1$'s on the diagonal is invertible).
\end{proof}

\noindent
Hence if $a$ and $b$ are homotopy equivalences then
the resulting morphism of triangles is an isomorphism of triangles
in $K(\mathcal{A})$.
It turns out that the collection of triangles of $K(\mathcal{A})$
given by cones and the collection of triangles of $K(\mathcal{A})$
given by termwise split sequences of complexes are the same
up to isomorphisms, at least up to sign!

\begin{lemma}
\label{lemma-the-same-up-to-isomorphisms}
Let $\mathcal{A}$ be an additive category.
\begin{enumerate}
\item Given a termwise split sequence of complexes
$(\alpha : A^\bullet \to B^\bullet,
\beta : B^\bullet \to C^\bullet, s^n, \pi^n)$
there exists a homotopy equivalence $C(\alpha)^\bullet \to C^\bullet$
such that the diagram
$$
\xymatrix{
A^\bullet \ar[r] \ar[d] & B^\bullet \ar[d] \ar[r] &
C(\alpha)^\bullet \ar[r]_{-p} \ar[d] & A^\bullet[1] \ar[d] \\
A^\bullet \ar[r] & B^\bullet \ar[r] &
C^\bullet \ar[r]^\delta & A^\bullet[1]
}
$$
defines an isomorphism of triangles in $K(\mathcal{A})$.
\item Given a morphism of complexes $f : K^\bullet \to L^\bullet$
there exists an isomorphism of triangles
$$
\xymatrix{
K^\bullet \ar[r] \ar[d] & \tilde L^\bullet \ar[d] \ar[r] &
M^\bullet \ar[r]_{\delta} \ar[d] & K^\bullet[1] \ar[d] \\
K^\bullet \ar[r] & L^\bullet \ar[r] &
C(f)^\bullet \ar[r]^{-p} & K^\bullet[1]
}
$$
where the upper triangle is the triangle associated to a
termwise split exact sequence $K^\bullet \to \tilde L^\bullet \to M^\bullet$.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). We have $C(\alpha)^n = B^n \oplus A^{n + 1}$
and we simply define $C(\alpha)^n \to C^n$ via the projection
onto $B^n$ followed by $\beta^n$. This defines
a morphism of complexes because the compositions
$A^{n + 1} \to B^{n + 1} \to B^n \to C^n$ are zero.
To get a homotopy inverse we take
$C^\bullet \to C(\alpha)^\bullet$ given by
$(s^n , -\delta^n)$ in degree $n$. This is a morphism of complexes
because the morphism $\delta^n$ can be characterized as the
unique morphism $C^n \to A^{n + 1}$ such that
$d \circ s^n - s^{n + 1} \circ d = \alpha \circ \delta^n$,
see proof of
Homology, Lemma \ref{homology-lemma-ses-termwise-split-cochain}.
The composition
$C^\bullet \to C(f)^\bullet \to C^\bullet$ is the identity.
The composition $C(f)^\bullet \to C^\bullet \to C(f)^\bullet$
is equal to the morphism
$$
\left(
\begin{matrix}
s^n \circ \beta^n & 0 \\
-\delta^n \circ \beta^n & 0
\end{matrix}
\right)
$$
To see that this is homotopic to the identity map
use the homotopy $h^n : C(\alpha)^n \to C(\alpha)^{n - 1})$
given by the matrix
$$
\left(
\begin{matrix}
0 & 0 \\
\pi^n & 0
\end{matrix}
\right) : C(\alpha)^n = B^n \oplus A^{n + 1} \to
B^{n - 1} \oplus A^n = C(\alpha)^{n - 1}
$$
It is trivial to verify that
$$
\left(
\begin{matrix}
1 & 0 \\
0 & 1
\end{matrix}
\right)
-
\left(
\begin{matrix}
s^n &
-\delta^n
\end{matrix}
\right)
\left(
\begin{matrix}
\beta^n \\
0
\end{matrix}
\right)
=
\left(
\begin{matrix}
d & \alpha^{n + 1} \\
0 & -d
\end{matrix}
\right)
\left(
\begin{matrix}
0 & 0 \\
\pi^n & 0
\end{matrix}
\right)
+
\left(
\begin{matrix}
0 & 0 \\
\pi^{n + 1} & 0
\end{matrix}
\right)
\left(
\begin{matrix}
d & \alpha^{n + 1} \\
0 & -d
\end{matrix}
\right)
$$
To finish the proof of (1) we have to show that the morphisms
$-p : C(\alpha)^\bullet \to A^\bullet[1]$ (see
Definition \ref{definition-cone})
and  $C(\alpha)^\bullet \to C^\bullet \to A^\bullet[1]$ agree up
to homotopy. This is clear from the above. Namely, we can use the homotopy
inverse $(s, -\delta) : C^\bullet \to C(\alpha)^\bullet$
and check instead that the two maps
$C^\bullet \to A^\bullet[1]$ agree. And note that
$p \circ (s, -\delta) = -\delta$ as desired.

\medskip\noindent
Proof of (2). We let $\tilde f : K^\bullet \to \tilde L^\bullet$,
$s : L^\bullet \to \tilde L^\bullet$
and $\pi : L^\bullet \to L^\bullet$ be as in
Lemma \ref{lemma-make-injective}. By
Lemmas \ref{lemma-functorial-cone} and \ref{lemma-third-isomorphism}
the triangles $(K^\bullet, L^\bullet, C(f), i, p)$ and
$(K^\bullet, \tilde L^\bullet, C(\tilde f), \tilde i, \tilde p)$
are isomorphic. Note that we can compose isomorphisms of
triangles. Thus we may replace $L^\bullet$ by
$\tilde L^\bullet$ and $f$ by $\tilde f$. In other words
we may assume that $f$ is a termwise split injection.
In this case the result follows from part (1).
\end{proof}


\begin{lemma}
\label{lemma-sequence-maps-split}
Let $\mathcal{A}$ be an additive category.
Let $A_1^\bullet \to A_2^\bullet \to \ldots \to A_n^\bullet$
be a sequence of composable morphisms of complexes.
There exists a commutative diagram
$$
\xymatrix{
A_1^\bullet \ar[r] &
A_2^\bullet \ar[r] &
\ldots \ar[r] &
A_n^\bullet \\
B_1^\bullet \ar[r] \ar[u] &
B_2^\bullet \ar[r] \ar[u] &
\ldots \ar[r] &
B_n^\bullet \ar[u]
}
$$
such that each morphism $B_i^\bullet \to B_{i + 1}^\bullet$
is a split injection and each $B_i^\bullet \to A_i^\bullet$
is a homotopy equivalence. Moreover, if all $A_i^\bullet$ are in
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$,
then so are the $B_i^\bullet$.
\end{lemma}

\begin{proof}
The case $n = 1$ is without content.
Lemma \ref{lemma-make-injective} is the case $n = 2$.
Suppose we have constructed the diagram
except for $B_n$. Applying Lemma \ref{lemma-make-injective} to
the composition $B_{n - 1} \to A_{n - 1} \to A_n$.
The result is a factorization $B_{n - 1} \to \tilde B_n \to A_n$
as desired.
\end{proof}


\begin{lemma}
\label{lemma-rotate-triangle}
Let $\mathcal{A}$ be an additive category. Let
$(\alpha : A^\bullet \to B^\bullet, \beta : B^\bullet \to C^\bullet, s^n,
\pi^n)$ be a termwise split sequence of complexes.
Let $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
be the associated triangle.
Then the triangle
$(C^\bullet[-1], A^\bullet, B^\bullet, \delta[-1], \alpha, \beta)$
is isomorphic to the triangle
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, p)$.
\end{lemma}

\begin{proof}
We write $B^n = A^n \oplus C^n$ and we identify $\alpha^n$ and $\beta^n$
with the natural inclusion and projection maps. By construction of $\delta$ we
have
$$
d_B^n =
\left(
\begin{matrix}
d_A^n & \delta^n \\
0 & d_C^n
\end{matrix}
\right)
$$
On the other hand the cone of $\delta[-1] : C^\bullet[-1] \to A^\bullet$
is given as $C(\delta[-1])^n = A^n \oplus C^n$ with differential identical
with the matrix above! Whence the lemma.
\end{proof}

\begin{lemma}
\label{lemma-rotate-cone}
Let $\mathcal{A}$ be an additive category.
Let $f : K^\bullet \to L^\bullet$ be a morphism of complexes.
The triangle $(L^\bullet, C(f)^\bullet, K^\bullet[1], i, p, f[1])$ is
the triangle associated to the termwise split sequence
$$
0 \to L^\bullet \to C(f)^\bullet \to K^\bullet[1] \to 0
$$
coming from the definition of the cone of $f$.
\end{lemma}

\begin{proof}
Immediate from the definitions.
\end{proof}






\section{Distinguished triangles in the homotopy category}
\label{section-homotopy-triangulated}

\noindent
Since we want our boundary maps in long exact sequences of cohomology
to be given by the maps in the snake lemma without signs we define
distinguished triangles in the homotopy category as follows.

\begin{definition}
\label{definition-distinguished-triangle}
Let $\mathcal{A}$ be an additive category.
A triangle $(X, Y, Z, f, g, h)$ of $K(\mathcal{A})$ is
called a {\it distinguished triangle of $K(\mathcal{A})$}
if it is isomorphic to the triangle associated to
a termwise split exact sequence of complexes, see Definition
\ref{definition-split-ses}.
Same definition for $K^{+}(\mathcal{A})$.
\end{definition}

\noindent
Note that according to Lemma \ref{lemma-the-same-up-to-isomorphisms}
a triangle of the form $(K^\bullet, L^\bullet, C(f)^\bullet, f, i, -p)$
is a distinguished triangle.
This does indeed lead to a triangulated category, see
Lemma \ref{lemma-the-same-up-to-isomorphisms}.
Before we can prove the proposition we need one more lemma
in order to be able to prove TR4.

\begin{lemma}
\label{lemma-two-split-injections}
Let $\mathcal{A}$ be an additive category. Suppose that
$\alpha : A^\bullet \to B^\bullet$ and $\beta : B^\bullet \to C^\bullet$
are split injections of complexes. Then there exist distinguished triangles
$(A^\bullet, B^\bullet, Q_1^\bullet, \alpha, p_1, d_1)$,
$(A^\bullet, C^\bullet, Q_2^\bullet, \beta \circ \alpha, p_2, d_2)$
and
$(B^\bullet, C^\bullet, Q_3^\bullet, \beta, p_3, d_3)$
for which TR4 holds.
\end{lemma}

\begin{proof}
Say $\pi_1^n : B^n \to A^n$, and $\pi_3^n : C^n \to B^n$ are the splittings.
Then also $A^\bullet \to C^\bullet$ is a split injection with splittings
$\pi_2^n = \pi_1^n \circ \pi_3^n$. Let us write $Q_1^\bullet$, $Q_2^\bullet$
and $Q_3^\bullet$ for the ``quotient'' complexes. In other words,
$Q_1^n = \text{Ker}(\pi_1^n)$, $Q_3^n = \text{Ker}(\pi_3^n)$ and
$Q_2^n = \text{Ker}(\pi_2^n)$. Note that the kernels exist. Then
$B^n = A^n \oplus Q_1^n$ and $C_n = B^n \oplus Q_3^n$, where we think of $A^n$
as a subobject of $B^n$ and so on. This implies
$C^n = A^n \oplus Q_1^n \oplus Q_3^n$. Note that
$\pi_2^n = \pi_1^n \circ \pi_3^n$ is zero on both $Q_1^n$ and $Q_3^n$. Hence
$Q_2^n = Q_1^n \oplus Q_3^n$. Consider the commutative diagram
$$
\begin{matrix}
0 & \to & A^\bullet & \to & B^\bullet & \to & Q_1^\bullet & \to & 0 \\
  &     & \downarrow&     & \downarrow&     & \downarrow  & \\
0 & \to & A^\bullet & \to & C^\bullet & \to & Q_2^\bullet & \to & 0 \\
  &     & \downarrow&     & \downarrow&     & \downarrow  & \\
0 & \to & B^\bullet & \to & C^\bullet & \to & Q_3^\bullet & \to & 0
\end{matrix}
$$
The rows of this diagram are termwise split exact sequences, and
hence determine distinguished triangles by
definition. Moreover downward arrows in the diagram above
are compatible with the chosen splittings and hence
define morphisms of triangles
$$
(A^\bullet \to B^\bullet \to Q_1^\bullet \to A^\bullet[1])
\longrightarrow
(A^\bullet \to C^\bullet \to Q_2^\bullet \to A^\bullet[1])
$$
and
$$
(A^\bullet \to C^\bullet \to Q_2^\bullet \to A^\bullet[1])
\longrightarrow
(B^\bullet \to C^\bullet \to Q_3^\bullet \to B^\bullet[1]).
$$
Note that the splittings $Q_3^n \to C^n$
of the bottom split sequence in the diagram provides a splitting
for the split sequence
$0 \to Q_1^\bullet \to Q_2^\bullet \to Q_3^\bullet \to 0$
upon composing with $C^n \to Q_2^n$. It follows easily from this
that the morphism $\delta : Q_3^\bullet \to Q_1^\bullet[1]$
in the corresponding distinguished triangle
$$
(Q_1^\bullet \to Q_2^\bullet \to Q_3^\bullet \to Q_1^\bullet[1])
$$
is equal to the composition $Q_3^\bullet \to B^\bullet[1] \to Q_1^\bullet[1]$.
Hence we get a structure as in the conclusion of axiom TR4.
\end{proof}

\begin{proposition}
\label{proposition-homotopy-category-triangulated}
Let $\mathcal{A}$ be an additive category.
The category $K(\mathcal{A})$ of complexes up to
homotopy with its natural translation functors
and distinguished triangles as defined above
is a triangulated category.
\end{proposition}

\begin{proof}
Proof of TR1. By definition every triangle isomorphic to a distinguished
one is distinguished. Also, any triangle $(A^\bullet, A^\bullet, 0, 1, 0, 0)$
is distinguished since $0 \to A^\bullet \to A^\bullet \to 0 \to 0$ is
a termwise split sequence of complexes. Finally, given any morphism of
complexes $f : K^\bullet \to L^\bullet$ the triangle
$(K, L, C(f), f, i, -p)$ is distinguished by
Lemma \ref{lemma-the-same-up-to-isomorphisms}.

\medskip\noindent
Proof of TR2. Let $(X, Y, Z, f, g, h)$ be a triangle.
Assume $(Y, Z, X[1], g, h, -f[1])$ is distinguished.
Then there exists a termwise split sequence of complexes
$A^\bullet \to B^\bullet \to C^\bullet$ such that the associated
triangle $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
is isomorphic to $(Y, Z, X[1], g, h, -f[1])$. Rotating back we see
that $(X, Y, Z, f, g, h)$ is isomorphic to
$(C^\bullet[-1], A^\bullet, B^\bullet, -\delta[-1], \alpha, \beta)$.
It follows from Lemma \ref{lemma-rotate-triangle} that the triangle
$(C^\bullet[-1], A^\bullet, B^\bullet, \delta[-1], \alpha, \beta)$
is isomorphic to
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, p)$.
Precomposing the previous isomorphism of triangles with $-1$ on $Y$
it follows that $(X, Y, Z, f, g, h)$ is isomorphic to
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, -p)$.
Hence it is distinguished by
Lemma \ref{lemma-the-same-up-to-isomorphisms}.
On the other hand, suppose that $(X, Y, Z, f, g, h)$ is distinguished.
By Lemma \ref{lemma-the-same-up-to-isomorphisms} this means that it is
isomorphic to a triangle of the form
$(K^\bullet, L^\bullet, C(f), f, i, -p)$ for some morphism of
complexes $f$. Then the rotated triangle $(Y, Z, X[1], g, h, -f[1])$ is
isomorphic to $(L^\bullet, C(f), K^\bullet[1], i, -p, -f[1])$ which is
isomorphic to the triangle $(L^\bullet, C(f), K^\bullet[1], i, p, f[1])$.
By Lemma \ref{lemma-rotate-cone} this triangle is distinguished.
Hence $(Y, Z, X[1], g, h, -f[1])$ is distinguished as desired.

\medskip\noindent
Proof of TR3. Let
$(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$
be distinguished triangles of $K(\mathcal{A})$
and let $a : X \to X'$ and $b : Y \to Y'$ be morphisms
such that $f' \circ a = b \circ f$. By Lemma \ref{lemma-functorial-cone}
we may assume that
$(X, Y, Z, f, g, h) = (X, Y, C(f), f, i, p)$ and
$(X', Y', Z', f', g', h') = (X', Y', C(f'), f', i', p')$.
At this point we simply apply Lemma \ref{lemma-functorial-cone}
to the commutative diagram given by $f, f', a, b$.

\medskip\noindent
Proof of TR4. At this point we know that $K(\mathcal{A})$
is a pre-triangulated category. Hence we can use
Lemma \ref{lemma-easier-axiom-four}. Let $A^\bullet \to B^\bullet$
and $B^\bullet \to C^\bullet$ be composable morphisms of
$K(\mathcal{A})$. By Lemma \ref{lemma-sequence-maps-split} we may assume that
$A^\bullet \to B^\bullet$ and $B^\bullet \to C^\bullet$
are split injective morphisms. In this case the result follows
from Lemma \ref{lemma-two-split-injections}.
\end{proof}

\begin{remark}
\label{remark-boundedness-conditions-triangulated}
Let $\mathcal{A}$ be an additive category.
Exactly the same proof as the proof of
Proposition \ref{proposition-homotopy-category-triangulated}
shows that the categories
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
are triangulated categories. Namely, the cone of a morphisms between
bounded (above, below) is bounded (above, below).
But we prove below that these are triangulated subcategories
of $K(\mathcal{A})$ which gives another proof.
\end{remark}

\begin{lemma}
\label{lemma-bounded-triangulated-subcategories}
Let $\mathcal{A}$ be an additive subcategory. The categories
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
are full triangulated subcategories of $K(\mathcal{A})$.
\end{lemma}

\begin{proof}
Each of the categories mentioned is a full additive subcategory.
We use the criterion of 
Lemma \ref{lemma-triangulated-subcategory}
to show that they are triangulated subcategories.
It is clear that each of the categories 
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, and $K^b(\mathcal{A})$
is preserved under the shift functors $[1], [-1]$.
Finally, suppose that $f : A^\bullet \to B^\bullet$ is a morphism
in $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$.
Then $(A^\bullet, B^\bullet, C(f)^\bullet, f, i, -p)$ is a distinguished
triangle of $K(\mathcal{A})$ with $C(f)^\bullet \in K^{+}(\mathcal{A})$,
$K^{-}(\mathcal{A})$, or $K^b(\mathcal{A})$ as is clear from the construction
of the cone. Thus the lemma is proved. (Alternatively,
$K^\bullet \to L^\bullet$ is isomorphic to an termwise split injection
of complexes in $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, or
$K^b(\mathcal{A})$, see
Lemma \ref{lemma-make-injective}
and then one can directly take the associated
distinguished triangle.)
\end{proof}

\begin{lemma}
\label{lemma-additive-exact-homotopy-category}
Let $\mathcal{A}$, $\mathcal{B}$ be additive categories.
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor.
The induced functors
$$
\begin{matrix}
F : K(\mathcal{A}) \longrightarrow K(\mathcal{B}) \\
F : K^{+}(\mathcal{A}) \longrightarrow K^{+}(\mathcal{B}) \\
F : K^{-}(\mathcal{A}) \longrightarrow K^{-}(\mathcal{B}) \\
F : K^b(\mathcal{A}) \longrightarrow K^b(\mathcal{B})
\end{matrix}
$$
are exact functors of triangulated categories.
\end{lemma}

\begin{proof}
Suppose $A^\bullet \to B^\bullet \to C^\bullet$
is a termwise split sequence of complexes of $\mathcal{A}$ with splittings
$(s^n, \pi^n)$ and associated morphism $\delta : C^\bullet \to A^\bullet[1]$,
see Definition \ref{definition-split-ses}. Then
$F(A^\bullet) \to F(B^\bullet) \to F(C^\bullet)$
is a termwise split sequence of complexes with splittings
$(F(s^n), F(\pi^n))$ and associated morphism
$F(\delta) : F(C^\bullet) \to F(A^\bullet)[1]$.
Thus $F$ transforms distinguished triangles into distinguished triangles.
\end{proof}




\section{Derived categories}
\label{section-derived-categories}

\noindent
In this section we construct the derived category of an abelian category
$\mathcal{A}$ by inverting the quasi-isomorphisms in $K(\mathcal{A})$.
Before we do this recall that the functors
$H^i : \text{Comp}(\mathcal{A}) \to \mathcal{A}$
factor through $K(\mathcal{A})$, see
Homology, Lemma \ref{homology-lemma-map-cohomology-homotopy-cochain}.
Moreover, in
Homology, Definition \ref{homology-definition-comology-shift}
we have defined identifications $H^i(K^\bullet[n]) = H^{i + n}(K^\bullet)$.
At this point it makes sense to redefine
$$
H^i(K^\bullet) = H^0(K^\bullet[i])
$$
in order to avoid confusion and possible sign errors.

\begin{lemma}
\label{lemma-cohomology-homological}
Let $\mathcal{A}$ be an abelian category. The functor
$$
H^0 : K(\mathcal{A}) \longrightarrow \mathcal{A}
$$
is homological.
\end{lemma}

\begin{proof}
Because $H^0$ is a functor, and by our definition of distinguished triangles
it suffices to prove that given a termwise split short exact sequence
of complexes $0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
the sequence $H^0(A^\bullet) \to H^0(B^\bullet) \to H^0(C^\bullet)$
is exact. This follows from
Homology, Lemma \ref{homology-lemma-long-exact-sequence-cochain}.
\end{proof}

\noindent
In particular, this lemma implies that a distinguished triangle
$(X, Y, Z, f, g, h)$ in $K(\mathcal{A})$ gives rise to a long exact
cohomology sequence
\begin{equation}
\label{equation-long-exact-cohomology-sequence-D}
\xymatrix{
\ldots \ar[r] &
H^i(X) \ar[r]^{H^i(f)} &
H^i(Y) \ar[r]^{H^i(g)} &
H^i(Z) \ar[r]^{H^i(h)} &
H^{i + 1}(X) \ar[r] & \ldots
}
\end{equation}
see (\ref{equation-long-exact-cohomology-sequence}). Moreover, there is
a compatibility with the long exact sequence of cohomology associated to
a short exact sequence of complexes (insert future reference here). For
example, if $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
is the distinguished triangle associated to a termwise split exact
sequence of complexes (see
Definition \ref{definition-split-ses}),
then the cohomology sequence above agrees with the one defined using the
snake lemma, see
Homology, Lemma \ref{homology-lemma-long-exact-sequence-cochain}
and for agreement of sequences, see
Homology, Lemma \ref{homology-lemma-ses-termwise-split-long-cochain}.

\medskip\noindent
Recall that a complex $K^\bullet$ is {\it acyclic} if $H^i(K^\bullet) = 0$
for all $i \in \mathbf{Z}$. Moreover, recall that a morphism of complexes
$f : K^\bullet \to L^\bullet$ is a {\it quasi-isomorphism} if and only if
$H^i(f)$ is an isomorphism for all $i$. See
Homology, Definition \ref{homology-definition-quasi-isomorphism-cochain}.

\begin{lemma}
\label{lemma-acyclic}
Let $\mathcal{A}$ be an abelian category. The full subcategory
$\text{Ac}(\mathcal{A})$ of $K(\mathcal{A})$ consisting of acyclic complexes
is a strictly full saturated triangulated subcategory of $K(\mathcal{A})$.
The corresponding saturated multiplicative system (see
Lemma \ref{lemma-operations})
of $K(\mathcal{A})$ is the set $\text{Qis}(\mathcal{A})$
of quasi-isomorphisms. In particular, the kernel of the localization
functor $Q : K(\mathcal{A}) \to \text{Qis}(\mathcal{A})^{-1}K(\mathcal{A})$
is $\text{Ac}(\mathcal{A})$ and the functor $H^0$ factors through $Q$.
\end{lemma}

\begin{proof}
We know that $H^0$ is a homological functor by
Lemma \ref{lemma-cohomology-homological}.
Thus this lemma is a special case of
Lemma \ref{lemma-acyclic-general}.
\end{proof}

\begin{definition}
\label{definition-unbounded-derived-category}
Let $\mathcal{A}$ be an abelian category.
Let $\text{Ac}(\mathcal{A})$ and $\text{Qis}(\mathcal{A})$
be as in
Lemma \ref{lemma-acyclic}.
The {\it derived category of $\mathcal{A}$} is the triangulated
category
$$
D(\mathcal{A}) =
K(\mathcal{A})/\text{Ac}(\mathcal{A}) =
\text{Qis}(\mathcal{A})^{-1} K(\mathcal{A}).
$$
We denote $H^0 : D(\mathcal{A}) \to \mathcal{A}$ the unique functor
whose composition with the quotient functor gives back the functor
$H^0$ defined above. Using
Lemma \ref{lemma-homological-functor-bounded}
we introduce the strictly full saturated triangulated subcategories
$D^{+}(\mathcal{A}), D^{-}(\mathcal{A}), D^b(\mathcal{A})$
whose sets of objects are
$$
\begin{matrix}
\Ob(D^{+}(\mathcal{A})) =
\{X \in \Ob(D(\mathcal{A})) \mid
H^n(X) = 0\text{ for all }n \ll 0\} \\
\Ob(D^{-}(\mathcal{A})) =
\{X \in \Ob(D(\mathcal{A})) \mid
H^n(X) = 0\text{ for all }n \gg 0\} \\
\Ob(D^b(\mathcal{A})) =
\{X \in \Ob(D(\mathcal{A})) \mid
H^n(X) = 0\text{ for all }|n| \gg 0\}
\end{matrix}
$$
The category $D^b(\mathcal{A})$ is called the {\it bounded derived
category} of $\mathcal{A}$.
\end{definition}

\noindent
Each of the variants $D^{+}(\mathcal{A}), D^{-}(\mathcal{A}), D^b(\mathcal{A})$
can be constructed as a localization of the corresponding homotopy category.
This relies on the following simple lemma.

\begin{lemma}
\label{lemma-complex-cohomology-bounded}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a complex.
\begin{enumerate}
\item If $H^n(K^\bullet) = 0$ for all $n \ll 0$, then there exists
a quasi-isomorphism $K^\bullet \to L^\bullet$ with $L^\bullet$
bounded below.
\item If $H^n(K^\bullet) = 0$ for all $n \gg 0$, then there exists
a quasi-isomorphism $M^\bullet \to K^\bullet$ with $M^\bullet$
bounded above.
\item If $H^n(K^\bullet) = 0$ for all $|n| \gg 0$, then there exists
a commutative diagram of morphisms of complexes
$$
\xymatrix{
K^\bullet \ar[r] & L^\bullet \\
M^\bullet \ar[u] \ar[r] & N^\bullet \ar[u]
}
$$
where all the arrows are quasi-isomorphisms, $L^\bullet$
bounded below, $M^\bullet$ bounded above, and $N^\bullet$ a bounded
complex.
\end{enumerate}
\end{lemma}

\begin{proof}
Pick $a \ll 0 \ll b$ and set $M^\bullet = \tau_{\leq a}K^\bullet$,
$L^\bullet = K^\bullet/\tau_{\leq b}K^\bullet$, and
$N^\bullet = L^\bullet/M^\bullet$.
See
Homology, Section \ref{homology-section-truncations}
for the truncation functors.
\end{proof}

\noindent
To state the following lemma denote
$\text{Ac}^{+}(\mathcal{A})$, $\text{Ac}^{-}(\mathcal{A})$,
resp.\ $\text{Ac}^b(\mathcal{A})$ the intersection of
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, resp.\ $K^b(\mathcal{A})$
with $\text{Ac}(\mathcal{A})$.
Denote $\text{Qis}^{+}(\mathcal{A})$, $\text{Qis}^{-}(\mathcal{A})$,
resp.\ $\text{Qis}^b(\mathcal{A})$ the intersection of
$K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, resp.\ $K^b(\mathcal{A})$
with $\text{Qis}(\mathcal{A})$.

\begin{lemma}
\label{lemma-bounded-derived}
Let $\mathcal{A}$ be an abelian category. The subcategories
$\text{Ac}^{+}(\mathcal{A})$, $\text{Ac}^{-}(\mathcal{A})$,
resp.\ $\text{Ac}^b(\mathcal{A})$
are strictly full saturated triangulated subcategories
of $K^{+}(\mathcal{A})$, $K^{-}(\mathcal{A})$, resp.\ $K^b(\mathcal{A})$.
The corresponding saturated multiplicative systems (see
Lemma \ref{lemma-operations})
are the sets $\text{Qis}^{+}(\mathcal{A})$, $\text{Qis}^{-}(\mathcal{A})$,
resp.\ $\text{Qis}^b(\mathcal{A})$.
\begin{enumerate}
\item The kernel of the functor $K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
is $\text{Ac}^{+}(\mathcal{A})$ and this induces an equivalence
of triangulated categories
$$
K^{+}(\mathcal{A})/\text{Ac}^{+}(\mathcal{A}) =
\text{Qis}^{+}(\mathcal{A})^{-1}K^{+}(\mathcal{A})
\longrightarrow
D^{+}(\mathcal{A})
$$
\item The kernel of the functor $K^{-}(\mathcal{A}) \to D^{-}(\mathcal{A})$
is $\text{Ac}^{-}(\mathcal{A})$ and this induces an equivalence
of triangulated categories
$$
K^{-}(\mathcal{A})/\text{Ac}^{-}(\mathcal{A}) =
\text{Qis}^{-}(\mathcal{A})^{-1}K^{-}(\mathcal{A})
\longrightarrow
D^{-}(\mathcal{A})
$$
\item The kernel of the functor $K^b(\mathcal{A}) \to D^b(\mathcal{A})$
is $\text{Ac}^b(\mathcal{A})$ and this induces an equivalence
of triangulated categories
$$
K^b(\mathcal{A})/\text{Ac}^b(\mathcal{A}) =
\text{Qis}^b(\mathcal{A})^{-1}K^b(\mathcal{A})
\longrightarrow
D^b(\mathcal{A})
$$
\end{enumerate}
\end{lemma}

\begin{proof}
The initial statements follow from
Lemma \ref{lemma-acyclic-general}
by considering the restriction of the homological functor $H^0$.
The statement on kernels in (1), (2), (3) is a consequence of the
definitions in each case.
Each of the functors is essentially surjective by
Lemma \ref{lemma-complex-cohomology-bounded}.
To finish the proof we have to show the functors are fully faithful.
We first do this for the bounded below version.

\medskip\noindent
Suppose that $K^\bullet, L^\bullet$ are bounded above complexes.
A morphism between these in $D(\mathcal{A})$ is of the form
$s^{-1}f$ for a pair
$f : K^\bullet \to (L')^\bullet$, $s : L^\bullet \to (L')^\bullet$
where $s$ is a quasi-isomorphism. This implies that $(L')^\bullet$
has cohomology bounded below. Hence by
Lemma \ref{lemma-complex-cohomology-bounded}
we can choose a quasi-isomorphism
$s' : (L')^\bullet \to (L'')^\bullet$
with $(L'')^\bullet$ bounded below. Then the pair $(s' \circ f, s' \circ s)$
defines a morphism in $\text{Qis}^{+}(\mathcal{A})^{-1}K^{+}(\mathcal{A})$.
Hence the functor is ``full''. Finally, suppose that the pair
$f : K^\bullet \to (L')^\bullet$, $s : L^\bullet \to (L')^\bullet$
defines a morphism in $\text{Qis}^{+}(\mathcal{A})^{-1}K^{+}(\mathcal{A})$
which is zero in $D(\mathcal{A})$. This means that there exists a
quasi-isomorphism $s' : (L')^\bullet \to (L'')^\bullet$
such that $s' \circ f = 0$. Using
Lemma \ref{lemma-complex-cohomology-bounded}
once more we obtain a quasi-isomorphism
$s'' : (L'')^\bullet \to (L''')^\bullet$
with $(L''')^\bullet$ bounded below.
Thus we see that $s'' \circ s' \circ f = 0$ which implies that
$s^{-1}f$ is zero in $\text{Qis}^{+}(\mathcal{A})^{-1}K^{+}(\mathcal{A})$.
This finishes the proof that the functor in (1) is an equivalence.

\medskip\noindent
The proof of (2) is dual to the proof of (1).
To prove (3) we may use the result of (2). Hence it suffices to
prove that the functor
$\text{Qis}^b(\mathcal{A})^{-1}K^b(\mathcal{A})
\to \text{Qis}^{-}(\mathcal{A})^{-1}K^{-}(\mathcal{A})$
is fully faithful. The argument given in the previous paragraph
applies directly to show this where we consistently work with complexes
which are already bounded above.
\end{proof}







\section{The canonical delta-functor}
\label{section-canonical-delta-functor}

\noindent
The derived category should be the receptacle for the universal
cohomology functor. In order to state the result we use
the notion of a $\delta$-functor from an abelian category
into a triangulated category, see
Definition \ref{definition-delta-functor}.

\medskip\noindent
Consider the functor
$\text{Comp}(\mathcal{A}) \to K(\mathcal{A})$.
This functor is {\bf not} a $\delta$-functor in general.
The easiest way to see this is to consider a nonsplit
short exact sequence $0 \to A \to B \to C \to 0$
of objects of $\mathcal{A}$. Since
$\Hom_{K(\mathcal{A})}(C[0], A[1]) = 0$
we see that any distinguished triangle arising from
this short exact sequence would look like
$(A[0], B[0], C[0], a, b, 0)$. But the existence of such a
distinguished triangle in $K(\mathcal{A})$ implies
that the extension is split. A contradiction.

\medskip\noindent
It turns out that the functor
$\text{Comp}(\mathcal{A}) \to D(\mathcal{A})$ is a
$\delta$-functor. In order to see this we have to define
the morphisms $\delta$ associated to a short exact sequence
$$
0 \to A^\bullet \xrightarrow{a} B^\bullet \xrightarrow{b} C^\bullet \to 0
$$
of complexes in the abelian category $\mathcal{A}$.
Consider the cone $C(a)^\bullet$ of the morphism $a$.
We have $C(a)^n = B^n \oplus A^{n + 1}$ and we define
$q^n : C(a)^n \to C^n$ via the projection to $B^n$ followed
by $b^n$. Hence a morphism of complexes
$$
q : C(a)^\bullet \longrightarrow C^\bullet.
$$
It is clear that $q \circ i = b$ where $i$ is as in
Definition \ref{definition-cone}.
Note that, as $a^\bullet$ is injective in each degree,
the kernel of $q$ is identified with the cone of
$\text{id}_{A^\bullet}$ which is acyclic. Hence we see that
$q$ is a quasi-isomorphism. According to
Lemma \ref{lemma-the-same-up-to-isomorphisms}
the triangle
$$
(A, B, C(a), a, i, -p)
$$
is a distinguished triangle in $K(\mathcal{A})$.
As the localization functor
$K(\mathcal{A}) \to D(\mathcal{A})$ is
exact we see that $(A, B, C(a), a, i, -p)$ is a distinguished
triangle in $D(\mathcal{A})$. Since $q$ is a quasi-isomorphism
we see that $q$ is an isomorphism in $D(\mathcal{A})$.
Hence we deduce that
$$
(A, B, C, a, b, -p \circ q^{-1})
$$
is a distinguished triangle of $D(\mathcal{A})$.
This suggests the following lemma.

\begin{lemma}
\label{lemma-derived-canonical-delta-functor}
Let $\mathcal{A}$ be an abelian category. The functor
$\text{Comp}(\mathcal{A}) \to D(\mathcal{A})$
defined has the natural structure of a $\delta$-functor,
with
$$
\delta_{A^\bullet \to B^\bullet \to C^\bullet} = - p \circ q^{-1}
$$
with $p$ and $q$ as explained above. The same construction turns the
functors
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$,
$\text{Comp}^{-}(\mathcal{A}) \to D^{-}(\mathcal{A})$, and
$\text{Comp}^b(\mathcal{A}) \to D^b(\mathcal{A})$
into $\delta$-functors.
\end{lemma}

\begin{proof}
We have already seen that this choice leads to a distinguished
triangle whenever given a short exact sequence of complexes.
We have to show that given a commutative diagram
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r]_a \ar[d]_f &
B^\bullet \ar[r]_b \ar[d]_g &
C^\bullet \ar[r] \ar[d]_h &
0 \\
0 \ar[r] &
(A')^\bullet \ar[r]^{a'} &
(B')^\bullet \ar[r]^{b'} &
(C')^\bullet \ar[r] &
0
}
$$
we get the desired commutative diagram of
Definition \ref{definition-delta-functor} (2).
By Lemma \ref{lemma-functorial-cone}
the pair $(f, g)$ induces a canonical morphism
$c : C(a)^\bullet \to C(a')^\bullet$. It is a simple computation
to show that $q' \circ c = h \circ q$ and
$f[1] \circ p = p' \circ c$. From this the result follows directly.
\end{proof}

\begin{lemma}
\label{lemma-derived-compare-triangles-ses}
Let $\mathcal{A}$ be an abelian category.
Let
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
D^\bullet \ar[r] &
E^\bullet \ar[r] &
F^\bullet \ar[r] &
0
}
$$
be a commutative diagram of morphisms of complexes
such that the rows are short exact sequences of complexes, and
the vertical arrows are quasi-isomorphisms.
The $\delta$-functor of
Lemma \ref{lemma-derived-canonical-delta-functor}
above
maps the to short exact sequences
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
and
$0 \to D^\bullet \to E^\bullet \to F^\bullet \to 0$
to isomorphic distinguished triangles.
\end{lemma}

\begin{proof}
Trivial from the fact that $K(\mathcal{A}) \to D(\mathcal{A})$
transforms quasi-isomorphisms into isomorphisms and that the
associated distinguished triangles are functorial.
\end{proof}

\begin{lemma}
\label{lemma-derived-compare-triangles-split-case}
Let $\mathcal{A}$ be an abelian category. Let
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] &
B^\bullet \ar[r] &
C^\bullet \ar[r] &
0
}
$$
be a short exact sequences of complexes.
Assume this short exact sequence is termwise split. Let
$(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
be the distinguished triangle of $K(\mathcal{A})$
associated to the sequence. The $\delta$-functor of
Lemma \ref{lemma-derived-canonical-delta-functor}
above maps the short exact sequences
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
to a triangle isomorphic to the distinguished triangle
$$
(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta).
$$
\end{lemma}

\begin{proof}
Follows from
Lemma \ref{lemma-the-same-up-to-isomorphisms}.
\end{proof}







\section{Triangulated subcategories of the derived category}
\label{section-triangulated-sub}

\noindent
Let $\mathcal{A}$ be an abelian category. In this section we are
going to look for strictly full saturated triangulated subcategories
$\mathcal{D}' \subset D(\mathcal{A}$ and in the bounded versions.

\medskip\noindent
Here is a simple construction. Let $\mathcal{B} \subset \mathcal{A}$
be a Serre subcategory, see
Homology, Section \ref{homology-section-serre-subcategories}.
We let $D_\mathcal{B}(\mathcal{A})$ the full subcategory of
$D(\mathcal{A})$ whose objects are
$$
\Ob(D_\mathcal{B}(\mathcal{A}))
=
\{X \in \Ob(D(\mathcal{A})) \mid
H^n(X) \text{ is an object of }\mathcal{B}\text{ for all }n\}
$$
We also define
$D^{+}_\mathcal{B}(\mathcal{A}) =
D^{+}(\mathcal{A}) \cap D_\mathcal{B}(\mathcal{A})$
and similarly for the other bounded versions.

\begin{lemma}
\label{lemma-cohomology-in-serre-subcategory}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{B} \subset \mathcal{A}$ be a Serre subcategory.
The category $D_\mathcal{B}(\mathcal{A})$ is a strictly full
saturated abelian subcategory of $D(\mathcal{A})$.
Similarly for the bounded versions.
\end{lemma}

\begin{proof}
By
Homology, Lemma \ref{homology-lemma-serre-subcategory-is-kernel}
we have an exact functor $F : \mathcal{A} \to \mathcal{A}/\mathcal{B}$
whose kernel is $\mathcal{B}$. Hence we see that
$D_\mathcal{B}(\mathcal{A})$ is the kernel of $F \circ H^0$ as in
Lemma \ref{lemma-homological-functor-kernel}.
\end{proof}

\noindent
An interesting feature of the situation of the lemma is that the
functor $D(\mathcal{B}) \to D(\mathcal{A})$ factors through a canonical
exact functor
\begin{equation}
\label{equation-compare}
D(\mathcal{B}) \longrightarrow D_\mathcal{B}(\mathcal{A})
\end{equation}
After all a complex made from objects of $\mathcal{B}$ certainly
gives rise to an object of $D_\mathcal{B}(\mathcal{A})$ and as
distinguished triangles in $D_\mathcal{B}(\mathcal{A})$ are exactly the
distinguished triangles of $D(\mathcal{A})$ whose vertices are in
$D_\mathcal{B}(\mathcal{A})$ we see that the functor is exact since
$D(\mathcal{B}) \to D(\mathcal{A})$ is exact. Similarly we obtain functors
$D^+(\mathcal{B}) \longrightarrow D^+_\mathcal{B}(\mathcal{A})$ etc
for the bounded versions. A key question in many cases is whether the
displayed functor is an equivalence.

\medskip\noindent
Note that $D_\mathcal{B}(\mathcal{A})$ is also the kernel of the functor
$D(\mathcal{A}) \to D(\mathcal{A}/\mathcal{B})$
where $\mathcal{A}/\mathcal{B}$ is the quotient abelian category
constructed in
Homology, Lemma \ref{homology-lemma-serre-subcategory-is-kernel}.
Thus we obtain a canonical functor
$$
D(\mathcal{A})/D_\mathcal{B}(\mathcal{A})
\longrightarrow
D(\mathcal{A}/\mathcal{B})
$$
by
Lemma \ref{lemma-universal-property-quotient}.
Similarly for the bounded versions.

\begin{lemma}
\label{lemma-derived-of-quotient}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{B} \subset \mathcal{A}$ be a Serre subcategory.
Then $D(\mathcal{A}) \to D(\mathcal{A}/\mathcal{B})$
is essentially surjective.
\end{lemma}

\begin{proof}
We will use the description of the category $\mathcal{A}/\mathcal{B}$
in the proof of
Homology, Lemma \ref{homology-lemma-serre-subcategory-is-kernel}.
Let $(X^\bullet, d^\bullet)$ be a complex of $\mathcal{A}/\mathcal{B}$.
For each $i$ we have an object $X^i$ of $\mathcal{A}$ and
$d^i = (s^i, f^i)$ where $s^i : Y^i \to X^i$ is a morphism of $\mathcal{A}$
whose kernel and cokernel are in $\mathcal{B}$ and $f^i : Y^i \to X^{i + 1}$
is an arbitrary morphism of $\mathcal{A}$. Next, consider the complex
$$
\ldots \to
X^i \oplus Y^i \oplus Y^{i + 1} \to 
X^{i + 1} \oplus Y^{i + 1} \oplus Y^{i + 2} \to \ldots
$$
in $\mathcal{A}$ with differential given by
$$
\left(
\begin{matrix}
0 & f^i & s^{i + 1} \\
0 & 0 & - \text{id}_{Y^{i + 1}} \\
0 & 0 & 0
\end{matrix}
\right).
$$
This complex becomes quasi-isomorphic to the complex $(X^\bullet, d^\bullet)$
in $\mathcal{A}/\mathcal{B}$ by the maps
$$
(\text{id}_{X^i}, s^i, 0) : X^i \oplus Y^i \oplus Y^{i + 1} \to X^i
$$
Calculation omitted.
\end{proof}

\begin{lemma}
\label{lemma-quotient-by-serre-easy}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{B} \subset \mathcal{A}$ be a Serre subcategory.
Suppose that the functor $v : \mathcal{A} \to \mathcal{A}/\mathcal{B}$
has a left adjoint $u : \mathcal{A}/\mathcal{B} \to \mathcal{A}$
such that $vu \cong \text{id}$. Then
$$
D(\mathcal{A})/D_\mathcal{B}(\mathcal{A}) = D(\mathcal{A}/\mathcal{B})
$$
and similarly for the bounded versions.
\end{lemma}

\begin{proof}
The functor $D(v) : D(\mathcal{A}) \to D(\mathcal{A}/\mathcal{B})$
is essentially surjective by
Lemma \ref{lemma-derived-of-quotient}.
For an object $X$ of $D(\mathcal{A})$ the adjunction mapping
$c_X : uvX \to X$ maps to an isomorphism in $D(\mathcal{A}/\mathcal{B})$
because $vuv \cong v$ by the assumption that $vu \cong \text{id}$.
Thus in a distinguished triangle $(uvX, X, Z, c_X, g, h)$ the object
$Z$ is an object of $D_\mathcal{B}(\mathcal{A})$ as we see by looking
at the long exact cohomology sequence.
Hence $c_X$ is an element of the multiplicative sytem used to define
the quotient category $D(\mathcal{A})/D_\mathcal{B}(\mathcal{A})$.
Thus $uvX \cong X$ in $D(\mathcal{A})/D_\mathcal{B}(\mathcal{A})$.
For $X, Y \in \Ob(\mathcal{A}))$ the map
$$
\Hom_{D(\mathcal{A})/D_\mathcal{B}(\mathcal{A})}(X, Y)
\longrightarrow
\Hom_{D(\mathcal{A}/\mathcal{B})}(vX, vY)
$$
is bijective because $u$ gives an inverse (by the remarks above).
\end{proof}









\section{Filtered derived categories}
\label{section-filtered-derived-category}

\noindent
A reference for this section is \cite[I, Chapter V]{cotangent}.
Let $\mathcal{A}$ be an abelian category.
The goal is to define the filtered derived category $DF(\mathcal{A})$
of $\mathcal{A}$. In some sense this is the derived category
of the category $\text{Fil}^f(\mathcal{A})$
of objects with a finite filtration in $\mathcal{A}$.
We will slightly generalize Illusie's discussion by allowing our
filtered complexes to have infinitely many nonzero $\text{gr}^p(K^\bullet)$
but we retaining the requirement that each term has a finite filtration.
The rationale for this generalization is that it is not
harder and it allows us to apply the discussion to the spectral sequences of
Lemma \ref{lemma-two-ss-complex-functor}, see also
Remark \ref{remark-functorial-ss}.

\medskip\noindent
We will use the notation regarding filtered objects introduced in
Homology, Section \ref{homology-section-filtrations}.
The category of filtered objects of $\mathcal{A}$ is
denoted $\text{Fil}(\mathcal{A})$.
All filtrations will be decreasing by fiat.

\begin{definition}
\label{definition-finite-filtered}
Let $\mathcal{A}$ be an abelian category. The
{\it category of finite filtered objects of $\mathcal{A}$}
is the category of filtered objects
$(A, F)$ of $\mathcal{A}$ whose filtration $F$ is finite.
We denote it $\text{Fil}^f(\mathcal{A})$.
\end{definition}

\noindent
Thus $\text{Fil}^f(\mathcal{A})$ is a full subcategory of
$\text{Fil}(\mathcal{A})$. For each $p \in \mathbf{Z}$ there is
a functor
$\text{gr}^p : \text{Fil}^f(\mathcal{A}) \to \mathcal{A}$.
There is a functor
$\text{gr} = \bigoplus_{p \in \mathbf{Z}} \text{gr}^p :
\text{Fil}^f(\mathcal{A}) \to \mathcal{A}$.
Finally, there is a functor
$$
(\text{forget }F) : \text{Fil}^f(\mathcal{A}) \longrightarrow \mathcal{A}
$$
which associates to the filtered object $(A, F)$ the underlying object
of $\mathcal{A}$.
The category $\text{Fil}^f(\mathcal{A})$ is an additive category, but not
abelian in general, see
Homology, Example \ref{homology-example-not-abelian}.
The construction in this section is a special case of a more general
construction of the derived category of an
``exact category'', see for example \cite{Buhler}, \cite{Keller}.

\medskip\noindent
Because the functors $\text{gr}^p$, $\text{gr}$, $(\text{forget }F)$
are additive they induce exact functors of triangulated categories
$$
\text{gr}^p, \text{gr}, (\text{forget }F):
K(\text{Fil}^f(\mathcal{A}))
\longrightarrow
K(\mathcal{A})
$$
by
Lemma \ref{lemma-additive-exact-homotopy-category}.
By analogy with the case of the homotopy category of an abelian category
we make the following definitions.

\begin{definition}
\label{definition-filtered-acyclic}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item Let $\alpha : K^\bullet \to L^\bullet$ be a morphism of
$K(\text{Fil}^f(\mathcal{A}))$. We say that
$\alpha$ is a {\it filtered quasi-isomorphism} if
the morphism $\text{gr}(\alpha)$ is a quasi-isomorphism.
\item Let $K^\bullet$ be an object of $K(\text{Fil}^f(\mathcal{A}))$.
We say that $K^\bullet$ is {\it filtered acyclic} if
the complex $\text{gr}(K^\bullet)$ is acyclic.
\end{enumerate}
\end{definition}

\noindent
Note that $\alpha : K^\bullet \to L^\bullet$ is a filtered quasi-isomorphism
if and only if each $\text{gr}^p(\alpha)$ is a quasi-isomorphism. Similarly
a complex $K^\bullet$ is filtered acyclic if and only if each
$\text{gr}^p(K^\bullet)$ is acyclic.

\begin{lemma}
\label{lemma-filtered-cohomology-homological}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item The functor 
$K(\text{Fil}^f(\mathcal{A})) \longrightarrow \mathcal{A}$,
$K^\bullet \longmapsto H^0(\text{gr}(K^\bullet))$
is homological.
\item The functor
$K(\text{Fil}^f(\mathcal{A})) \rightarrow \mathcal{A}$,
$K^\bullet \longmapsto H^0(\text{gr}^p(K^\bullet))$
is homological.
\item The functor 
$K(\text{Fil}^f(\mathcal{A})) \longrightarrow \mathcal{A}$,
$K^\bullet \longmapsto H^0((\text{forget }F)K^\bullet)$
is homological.
\end{enumerate}
\end{lemma}

\begin{proof}
This follows from the fact that
$H^0 : K(\mathcal{A}) \to \mathcal{A}$ is homological, see
Lemma \ref{lemma-cohomology-homological}
and the fact that the functors $\text{gr}, \text{gr}^p, (\text{forget }F)$
are exact functors of triangulated categories. See
Lemma \ref{lemma-exact-compose-homological-functor}.
\end{proof}

\begin{lemma}
\label{lemma-filtered-acyclic}
Let $\mathcal{A}$ be an abelian category. The full subcategory
$\text{FAc}(\mathcal{A})$ of $K(\text{Fil}^f(\mathcal{A}))$
consisting of filtered acyclic complexes is a strictly full saturated
triangulated subcategory of $K(\text{Fil}^f(\mathcal{A}))$.
The corresponding saturated multiplicative system (see
Lemma \ref{lemma-operations})
of $K(\text{Fil}^f(\mathcal{A}))$ is the set
$\text{FQis}(\mathcal{A})$ of filtered quasi-isomorphisms.
In particular, the kernel of the localization
functor
$$
Q :
K(\text{Fil}^f(\mathcal{A}))
\longrightarrow
\text{FQis}(\mathcal{A})^{-1}K(\text{Fil}^f(\mathcal{A}))
$$
is $\text{FAc}(\mathcal{A})$ and the functor $H^0 \circ \text{gr}$
factors through $Q$.
\end{lemma}

\begin{proof}
We know that $H^0 \circ \text{gr}$ is a homological functor by
Lemma \ref{lemma-filtered-cohomology-homological}.
Thus this lemma is a special case of
Lemma \ref{lemma-acyclic-general}.
\end{proof}

\begin{definition}
\label{definition-filtered-derived}
Let $\mathcal{A}$ be an abelian category.
Let $\text{FAc}(\mathcal{A})$ and $\text{FQis}(\mathcal{A})$
be as in
Lemma \ref{lemma-filtered-acyclic}.
The {\it filtered derived category of $\mathcal{A}$}
is the triangulated category
$$
DF(\mathcal{A}) =
K(\text{Fil}^f(\mathcal{A}))/\text{FAc}(\mathcal{A}) =
\text{FQis}(\mathcal{A})^{-1} K(\text{Fil}^f(\mathcal{A})).
$$
\end{definition}

\begin{lemma}
\label{lemma-filtered-derived-functors}
The functors $\text{gr}^p, \text{gr}, (\text{forget }F)$ induce
canonical exact functors
$$
\text{gr}^p, \text{gr}, (\text{forget }F):
DF(\mathcal{A})
\longrightarrow
D(\mathcal{A})
$$
which commute with the localization functors.
\end{lemma}

\begin{proof}
This follows from the universal propery of localization, see
Lemma \ref{lemma-universal-property-localization},
provided we can show that a filtered quasi-isomorphism is turned
into a quasi-isomorphism by each of the functors
$\text{gr}^p, \text{gr}, (\text{forget }F)$. This is true by definition
for the first two. For the last one the statement we have to do a little
bit of work. Let $f : K^\bullet \to L^\bullet$ be a filtered
quasi-isomorphism in $K(\text{Fil}^f(\mathcal{A}))$.
Choose a distinguished triangle $(K^\bullet, L^\bullet, M^\bullet, f, g, h)$
which contains $f$. Then $M^\bullet$ is filtered acyclic, see
Lemma \ref{lemma-filtered-acyclic}.
Hence by the corresponding lemma for $K(\mathcal{A})$ it suffices
to show that a filtered acyclic complex is an acyclic complex if
we forget the filtration.
This follows from
Homology, Lemma \ref{homology-lemma-filtered-acyclic}.
\end{proof}

\begin{definition}
\label{definition-filtered-derived-bounded}
Let $\mathcal{A}$ be an abelian category.
The {\it bounded filtered derived category} $DF^b(\mathcal{A})$ is
the full subcategory of $DF(\mathcal{A})$ with objects those $X$
such that $\text{gr}(X) \in D^b(\mathcal{A})$.
Similarly for the bounded below filtered derived category
$DF^{+}(\mathcal{A})$ and the bounded above filtered derived category
$DF^{-}(\mathcal{A})$.
\end{definition}

\begin{lemma}
\label{lemma-filtered-complex-cohomology-bounded}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet \in K(\text{Fil}^f(\mathcal{A}))$.
\begin{enumerate}
\item If $H^n(\text{gr}(K^\bullet)) = 0$ for all $n < a$, then there exists
a filtered quasi-isomorphism $K^\bullet \to L^\bullet$ with
$L^n = 0$ for all $n < a$.
\item If $H^n(\text{gr}(K^\bullet)) = 0$ for all $n > b$, then there exists
a filtered quasi-isomorphism $M^\bullet \to K^\bullet$ with
$M^n = 0$ for all $n > b$.
\item If $H^n(\text{gr}(K^\bullet)) = 0$ for all $|n| \gg 0$, then there
exists a commutative diagram of morphisms of complexes
$$
\xymatrix{
K^\bullet \ar[r] & L^\bullet \\
M^\bullet \ar[u] \ar[r] & N^\bullet \ar[u]
}
$$
where all the arrows are filtered quasi-isomorphisms, $L^\bullet$
bounded below, $M^\bullet$ bounded above, and $N^\bullet$ a bounded
complex.
\end{enumerate}
\end{lemma}

\begin{proof}
Suppose that $H^n(\text{gr}(K^\bullet)) = 0$ for all $n < a$. By
Homology, Lemma \ref{homology-lemma-filtered-acyclic}
the sequence
$$
K^{a - 1} \xrightarrow{d^{a - 2}} K^{a - 1} \xrightarrow{d^{a - 1}} K^a
$$
is an exact sequence of objects of $\mathcal{A}$ and the morphisms
$d^{a - 2}$ and $d^{a - 1}$ are strict. Hence
$\text{Coim}(d^{a - 1}) = \text{Im}(d^{a - 1})$ in $\text{Fil}^f(\mathcal{A})$
and the map $\text{gr}(\text{Im}(d^{a - 1})) \to \text{gr}(K^a)$
is injective with image equal to the image of
$\text{gr}(K^{a - 1}) \to \text{gr}(K^a)$, see
Homology, Lemma \ref{homology-lemma-characterize-strict}.
This means that the map $K^\bullet \to \tau_{\geq a}K^\bullet$
into the truncation
$$
\tau_{\geq a}K^\bullet =
(\ldots \to 0 \to K^a/\text{Im}(d^{a - 1}) \to K^{a + 1} \to \ldots)
$$
is a filtered quasi-isomorphism. This proves (1). The proof of (2)
is dual to the proof of (1). Part (3) follows formally from (1) and (2).
\end{proof}

\noindent
To state the following lemma denote
$\text{FAc}^{+}(\mathcal{A})$, $\text{FAc}^{-}(\mathcal{A})$,
resp.\ $\text{FAc}^b(\mathcal{A})$ the intersection of
$K^{+}(\text{Fil}^f\mathcal{A})$, $K^{-}(\text{Fil}^f\mathcal{A})$,
resp.\ $K^b(\text{Fil}^f\mathcal{A})$ with $\text{FAc}(\mathcal{A})$.
Denote $\text{FQis}^{+}(\mathcal{A})$, $\text{FQis}^{-}(\mathcal{A})$,
resp.\ $\text{FQis}^b(\mathcal{A})$ the intersection of
$K^{+}(\text{Fil}^f\mathcal{A})$, $K^{-}(\text{Fil}^f\mathcal{A})$,
resp.\ $K^b(\text{Fil}^f\mathcal{A})$ with $\text{FQis}(\mathcal{A})$.

\begin{lemma}
\label{lemma-filtered-bounded-derived}
Let $\mathcal{A}$ be an abelian category. The subcategories
$\text{FAc}^{+}(\mathcal{A})$, $\text{FAc}^{-}(\mathcal{A})$,
resp.\ $\text{FAc}^b(\mathcal{A})$
are strictly full saturated triangulated subcategories
of $K^{+}(\text{Fil}^f\mathcal{A})$, $K^{-}(\text{Fil}^f\mathcal{A})$,
resp.\ $K^b(\text{Fil}^f\mathcal{A})$.
The corresponding saturated multiplicative systems (see
Lemma \ref{lemma-operations})
are the sets $\text{FQis}^{+}(\mathcal{A})$, $\text{FQis}^{-}(\mathcal{A})$,
resp.\ $\text{FQis}^b(\mathcal{A})$.
\begin{enumerate}
\item The kernel of the functor
$K^{+}(\text{Fil}^f\mathcal{A}) \to DF^{+}(\mathcal{A})$
is $\text{FAc}^{+}(\mathcal{A})$ and this induces an equivalence
of triangulated categories
$$
K^{+}(\text{Fil}^f\mathcal{A})/\text{FAc}^{+}(\mathcal{A}) =
\text{FQis}^{+}(\mathcal{A})^{-1}K^{+}(\text{Fil}^f\mathcal{A})
\longrightarrow
DF^{+}(\mathcal{A})
$$
\item The kernel of the functor
$K^{-}(\text{Fil}^f\mathcal{A}) \to DF^{-}(\mathcal{A})$
is $\text{FAc}^{-}(\mathcal{A})$ and this induces an equivalence
of triangulated categories
$$
K^{-}(\text{Fil}^f\mathcal{A})/\text{FAc}^{-}(\mathcal{A}) =
\text{FQis}^{-}(\mathcal{A})^{-1}K^{-}(\text{Fil}^f\mathcal{A})
\longrightarrow
DF^{-}(\mathcal{A})
$$
\item The kernel of the functor
$K^b(\text{Fil}^f\mathcal{A}) \to DF^b(\mathcal{A})$
is $\text{FAc}^b(\mathcal{A})$ and this induces an equivalence
of triangulated categories
$$
K^b(\text{Fil}^f\mathcal{A})/\text{FAc}^b(\mathcal{A}) =
\text{FQis}^b(\mathcal{A})^{-1}K^b(\text{Fil}^f\mathcal{A})
\longrightarrow
DF^b(\mathcal{A})
$$
\end{enumerate}
\end{lemma}

\begin{proof}
This follows from the results above, in particular
Lemma \ref{lemma-filtered-complex-cohomology-bounded},
by exactly the same arguments as used in the proof of
Lemma \ref{lemma-bounded-derived}.
\end{proof}











\section{Derived functors in general}
\label{section-derived-functors}

\noindent
A reference for this section is Deligne's expos\'ee XVII in \cite{SGA4}.
A very general notion of right and left derived functors exists where
we have an exact functor between triangulated categories, a multiplicative
system in the source category and we want to find the ``correct'' extension
of the exact functor to the localized category.

\begin{situation}
\label{situation-derived-functor}
Here $F : \mathcal{D} \to \mathcal{D}'$ is an exact functor of triangulated
categories and $S$ is a saturated multiplicative
system in $\mathcal{D}$ compatible with the structure
of triangulated category on $\mathcal{D}$.
\end{situation}

\noindent
Let $X \in \Ob(\mathcal{D})$. Recall from
Categories, Remark \ref{categories-remark-left-localization-morphisms-colimit}
the filtered category $X/S$ of arrows $s : X \to X'$ in $S$ with source $X$.
Dually, in
Categories, Remark \ref{categories-remark-right-localization-morphisms-colimit}
we defined the cofiltered category $S/X$ of arrows $s : X' \to X$ in $S$
with target $X$.

\begin{definition}
\label{definition-right-derived-functor-defined}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $X \in \Ob(\mathcal{D})$.
\begin{enumerate}
\item we say the {\it right derived functor $RF$ is defined at}
$X$ if the ind-object
$$
(X/S) \longrightarrow \mathcal{D}',\quad
(s : X \to X') \longmapsto F(X')
$$
is essentially constant\footnote{For a discussion of when an ind-object
or pro-object of a category is essentially constant we refer to
Categories, Section \ref{categories-section-essentially-constant}.};
in this case the value
$Y$ in $\mathcal{D}'$ is called the {\it value of $RF$ at $X$}.
\item we say the {\it left derived functor $LF$ is defined at} $X$
if the pro-object
$$
(S/X) \longrightarrow \mathcal{D}',\quad
(s: X' \to X) \longmapsto F(X')
$$
is essentially constant; in this case the value $Y$ in $\mathcal{D}'$
is called the {\it value of $LF$ at $X$}.
\end{enumerate}
By abuse of notation we often denote the values simply
$RF(X)$ or $LF(X)$.
\end{definition}

\noindent
It will turn out that the full subcategory of $\mathcal{D}$ consisting
of objects where $RF$ is defined is a triangulated subcategory, and
$RF$ will define functor on this subcategory which transforms morphisms
of $s$ into isomorphisms.

\begin{lemma}
\label{lemma-derived-functor}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
\begin{enumerate}
\item If $RF$ is defined at $X$ and $Y$ then there exists a unique
morphism $RF(f) : RF(X) \to RF(Y)$ between the values such that
for any commutative diagram
$$
\xymatrix{
X \ar[d]_f \ar[r]_s & X' \ar[d]^{f'} \\
Y \ar[r]^{s'} & Y'
}
$$
with $s, s' \in S$ the diagram
$$
\xymatrix{
F(X) \ar[d] \ar[r] & F(X') \ar[d] \ar[r] & RF(X) \ar[d] \\
F(Y) \ar[r] & F(Y') \ar[r] & RF(Y)
}
$$
commutes.
\item If $LF$ is defined at $X$ and $Y$ then there exists a unique
morphism $LF(f) : LF(X) \to LF(Y)$ between the values such that
for any commutative diagram
$$
\xymatrix{
X' \ar[d]_{f'} \ar[r]_s & X \ar[d]^f \\
Y' \ar[r]^{s'} & Y
}
$$
with $s, s'$ in $S$ the diagram
$$
\xymatrix{
LF(X) \ar[d] \ar[r] & F(X') \ar[d] \ar[r] & F(X) \ar[d] \\
LF(Y) \ar[r] & F(Y') \ar[r] & F(Y)
}
$$
commutes.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) holds if we only assume that the colimits
$$
RF(X) = \colim_{s : X' \to X} F(X')
\quad\text{and}\quad
RF(Y) = \colim_{s' : Y' \to Y} F(Y')
$$
exist. Namely, to give a morphism $RF(X) \to RF(Y)$ between the colimits
is the same thing as giving for each $s : X \to X'$ in $\Ob(X/S)$
a morphism $F(X') \to RF(Y)$ compatible with morphisms in the category
$X/S$. To get the morphism we choose a commutative diagram
$$
\xymatrix{
X \ar[d]_f \ar[r]_s & X' \ar[d]^{f'} \\
Y \ar[r]^{s'} & Y'
}
$$
with $s, s'$ in $S$ as is possible by MS2 and we set
$F(X') \to RF(Y)$ equal to the composition $F(X') \to F(Y') \to RF(Y)$.
To see that this is independent of the choice of the diagram above use
MS3. Details omitted. The proof of (2) is dual.
\end{proof}

\begin{lemma}
\label{lemma-derived-inverts}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $s : X \to Y$ be an element of $S$.
\begin{enumerate}
\item $RF$ is defined at $X$ if and only if it is defined at $Y$.
In this case the map $RF(s) : RF(X) \to RF(Y)$ between values
is an isomorphism.
\item $LF$ is defined at $X$ if and only if it is defined at $Y$.
In this case the map $LF(s) : LF(X) \to LF(Y)$ between values
is an isomorphism.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-derived-shift}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $X$ be an object of $\mathcal{D}$ and $n \in \mathbf{Z}$.
\begin{enumerate}
\item $RF$ is defined at $X$ if and only if it is defined at $X[n]$.
In this case there is a canonical isomorphism
$RF(X)[n]= RF(X[n])$ between values.
\item $LF$ is defined at $X$ if and only if it is defined at $X[n]$.
In this case there is a canonical isomorphism
$LF(X)[n] \to LF(X[n])$ between values.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-2-out-of-3-defined}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle of $\mathcal{D}$.
If $RF$ is defined at two out of three of $X, Y, Z$, then it is defined
at the third. Moreover, in this case
$$
(RF(X), RF(Y), RF(Z), RF(f), RF(g), RF(h))
$$
is a distinguished triangle in $\mathcal{D}'$. Similarly for $LF$.
\end{lemma}

\begin{proof}
Say $RF$ is defined at $X, Y$ with values $A, B$.
Let $RF(f) : A \to B$ be the induced morphism, see
Lemma \ref{lemma-derived-functor}.
We may choose a distinguished triangle
$(A, B, C, RF(f), b, c)$
in $\mathcal{D}'$. We claim that $C$ is a value of $RF$ at $Z$.

\medskip\noindent
To see this pick $s : X \to X'$ in $S$ such that there exists a morphism
$\alpha : A \to F(X')$ as in
Categories,
Definition \ref{categories-definition-essentially-constant-diagram}.
We may choose a commutative diagram
$$
\xymatrix{
X \ar[d]_f \ar[r]_s & X' \ar[d]^{f'} \\
Y \ar[r]^{s'} & Y'
}
$$
with $s' \in S$ by MS2. Using that $Y/S$ is filtered we can (after replacing
$s'$ by some $s'' : Y \to Y''$ in $S$) assume that there exists
a morphism $\beta : B \to F(Y')$ as in
Categories,
Definition \ref{categories-definition-essentially-constant-diagram}.
Picture
$$
\xymatrix{
A \ar[d]_{RF(f)} \ar[r]_-\alpha &
F(X') \ar[r] \ar[d]^{F(f')} &
A \ar[d]^{RF(f)} \\
B \ar[r]^-\beta & F(Y') \ar[r] & B
}
$$
It may not be true that the left square commutes, but the outer and
right squares commute.
The assumption that the ind-object $\{F(Y')\}_{s' : Y' \to Y}$
is essentially constant means that there exists a $s'' : Y \to Y''$
in $S$ and a morphism $h : Y' \to Y''$ with such that $s'' = h \circ s'$ and
$F(h)$ equal to $F(Y') \to B \to F(Y') \to F(Y'')$. Hence
after replacing $Y'$ by $Y''$ and $\beta$ by $F(h) \circ \beta$ the
diagram will commute (by direct computation with arrows).

\medskip\noindent
Using MS6 choose a morphism of triangles
$$
(s, s', s'') : (X, Y, Z, f, g, h) \longrightarrow (X', Y', Z', f', g', h')
$$
with $s'' \in S$. By TR3 choose a morphism of triangles
$$
(\alpha, \beta, \gamma) :
(A, B, C, RF(f), b, c)
\longrightarrow
(F(X'), F(Y'), F(Z'), F(f'), F(g'), F(h'))
$$

\medskip\noindent
By
Lemma \ref{lemma-derived-inverts}
it suffices to prove that $RF(Z')$ is defined and has value $C$.
Consider the category $\mathcal{I}$ of
Lemma \ref{lemma-limit-triangles}
of triangles
$$
\mathcal{I} =
\{(t, t', t'') : (X', Y', Z', f', g', h') \to (X'', Y'', Z'', f'', g'', h'')
\mid (t, t', t'') \in S\}
$$
To show that the system $F(Z'')$ is essentially constant over the category
$Z'/S$ is equivalent to showing that the system of $F(Z'')$ is essentially
constant over $\mathcal{I}$ by using the surjectivity of the functor
$\mathcal{I} \to Z'/S$. For any object $W$ in $\mathcal{D}'$ we can
consider the diagram
$$
\xymatrix{
\lim_\mathcal{I} \Mor_{\mathcal{D}'}(F(X''), W) \ar[r] &
\Mor_{\mathcal{D}'}(A, W) \\
\lim_\mathcal{I} \Mor_{\mathcal{D}'}(F(Y''), W) \ar[u] \ar[r] &
\Mor_{\mathcal{D}'}(B, W) \ar[u] \\
\lim_\mathcal{I} \Mor_{\mathcal{D}'}(F(Z''), W) \ar[u] \ar[r] &
\Mor_{\mathcal{D}'}(C, W) \ar[u] \\
\lim_\mathcal{I} \Mor_{\mathcal{D}'}(F(X''[1]), W) \ar[u]
\ar[r] &
\Mor_{\mathcal{D}'}(A[1], W) \ar[u] \\
\lim_\mathcal{I} \Mor_{\mathcal{D}'}(F(Y''[1]), W) \ar[u]
\ar[r] &
\Mor_{\mathcal{D}'}(B[1], W) \ar[u]
}
$$
which shows that the middle arrow is an isomorphism by the 5 lemma.
In this way we conclude that $C$ is the colimit
$\colim_\mathcal{I} F(Z'')$. To see that the ind-object
is essentially constant it now suffices to show that for any
object $W$ in $\mathcal{D}'$ the map
$$
\colim_\mathcal{I} \Mor_{\mathcal{D}'}(W, F(Z''))
\longrightarrow
\Mor_{\mathcal{D}'}(W, C)
$$
is bijective, see
Categories, Lemma \ref{categories-lemma-characterize-essentially-constant-ind}.
To see this we can use again the 5 lemma and the commutative diagram
$$
\xymatrix{
\colim_\mathcal{I} \Mor_{\mathcal{D}'}(W, F(X''))
\ar[r] &
\Mor_{\mathcal{D}'}(W, A) \\
\colim_\mathcal{I} \Mor_{\mathcal{D}'}(W, F(Y''))
\ar[u] \ar[r] &
\Mor_{\mathcal{D}'}(W, B) \ar[u] \\
\colim_\mathcal{I} \Mor_{\mathcal{D}'}(W, F(Z''))
\ar[u] \ar[r] &
\Mor_{\mathcal{D}'}(W, C) \ar[u] \\
\colim_\mathcal{I} \Mor_{\mathcal{D}'}(W, F(X''[1]))
\ar[u] \ar[r] &
\Mor_{\mathcal{D}'}(W, A[1]) \ar[u] \\
\colim_\mathcal{I} \Mor_{\mathcal{D}'}(W, F(Y''[1]))
\ar[u] \ar[r] &
\Mor_{\mathcal{D}'}(W, B[1]) \ar[u]
}
$$
and the fact that
Categories, Lemma \ref{categories-lemma-characterize-essentially-constant-ind}
guarantees that the other horizontal arrows are isomorphisms.
\end{proof}

\begin{lemma}
\label{lemma-direct-sum-defined}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $X, Y$ be objects of $\mathcal{D}$.
If $RF$ is defined at $X \oplus Y$, then it is defined
at $X$ and $Y$. Moreover, in this case
$RF(X \oplus Y) = RF(X) \oplus RF(Y)$. Similarly for $LF$.
\end{lemma}

\begin{proof}
Since $S$ is a saturated system for any $s : X \to X'$ and $s' : Y \to Y'$
in $S$ the morphism $s \oplus s' : X \oplus Y \to X' \oplus Y'$ is an
element of $S$ (as $S$ is the set of arrows which become invertible
under the additive localization functor
$Q : \mathcal{D} \to S^{-1}\mathcal{D}$, see
Categories, Lemma \ref{categories-lemma-what-gets-inverted}).
To prove the lemma for $RF$ it suffices to show that these arrows
$s \oplus s'$ are cofinal in the filtered category $(X \oplus Y)/S$.
To do this pick any $t : X \oplus Y \to Z$ in $S$.
Using MS2 we can find morphisms $Z \to X'$, $Z \to Y'$
and $s : X \to X'$, $s' : Y \to Y'$ in $S$ such that
$$
\xymatrix{
X \ar[d]^s & X \oplus Y \ar[d] \ar[l] \ar[r] & Y \ar[d]_{s'} \\
X' & Z \ar[l] \ar[r] & Y'
}
$$
commutes. Hence the desired result. The proof for $LF$ is dual.
\end{proof}

\begin{proposition}
\label{proposition-derived-functor}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
The full subcategory $\mathcal{E}$ of $\mathcal{D}$ consisting of
objects at which $RF$ is defined is a strictly full saturated triangulated
subcategory of $\mathcal{D}$. Choosing values using the axiom of choice
gives rise to an exact functor
$$
RF : \mathcal{E} \longrightarrow \mathcal{D}'
$$
of triangulated categories. Elements of $S$ with either source or target
in $\mathcal{E}$ are morphisms of $\mathcal{E}$. Any element of
$S_\mathcal{E} = \text{Arrows}(\mathcal{E}) \cap S$
is transformed into an isomorphism by $RF$. Hence an exact functor
$$
RF : S_\mathcal{E}^{-1}\mathcal{E} \longrightarrow \mathcal{D}'.
$$
A similar result holds for $LF$.
\end{proposition}

\begin{proof}
This is just a summary of the results obtained in
Lemmas \ref{lemma-derived-functor},
\ref{lemma-derived-inverts},
\ref{lemma-derived-shift},
\ref{lemma-2-out-of-3-defined}, and
\ref{lemma-direct-sum-defined}.
\end{proof}

\begin{definition}
\label{definition-everywhere-defined}
In
Situation \ref{situation-derived-functor}.
We say $F$ is {\it right deriveable}, or that $RF$ {\it everywhere defined}
if $RF$ is defined at every object of $\mathcal{D}$.
We say $F$ is {\it left deriveable}, or that $LF$ {\it everywhere defined}
if $LF$ is defined at every object of $\mathcal{D}$.
\end{definition}

\noindent
In this case we obtain a right (resp.\ left) derived functor
\begin{equation}
\label{equation-everywhere}
RF : S^{-1}\mathcal{D} \longrightarrow \mathcal{D}',
\quad\text{(resp. }
LF : S^{-1}\mathcal{D} \longrightarrow \mathcal{D}'),
\end{equation}
see
Proposition \ref{proposition-derived-functor}.
In most interesting situations it is not the case that $RF \circ Q$ is
equal to $F$. In fact, it might happen that the canonical map
$F(X) \to RF(X)$ is never an isomorphism. In practice this does not happen,
because in practice we only know how to prove $F$ is right deriveable by
showing that $RF$ can be computed by evaluating $F$ at judiciously chosen
objects of the triangulated category $\mathcal{D}$. This warrents
a definition.

\begin{definition}
\label{definition-computes}
In
Situation \ref{situation-derived-functor}.
\begin{enumerate}
\item An object $X$ of $\mathcal{D}$ {\it computes} $RF$ if $RF$ is defined
at $X$ and the canonical map $F(X) \to RF(X)$ is an isomorphism.
\item An object $X$ of $\mathcal{D}$ {\it computes} $LF$ if $LF$ is defined
at $X$ and the canonical map $LF(X) \to F(X)$ is an isomorphism.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-computes-shift}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $X$ be an object of $\mathcal{D}$ and $n \in \mathbf{Z}$.
\begin{enumerate}
\item $X$ computes $RF$ if and only if $X[n]$ computes $RF$.
\item $X$ computes $LF$ if and only if $X[n]$ computes $LF$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-2-out-of-3-computes}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle of $\mathcal{D}$.
If $X, Y$ compute $RF$ then so does $Z$. Similar for $LF$.
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-2-out-of-3-defined}
we know that $RF$ is defined at $Z$ and that $RF$ applied to the
triangle produces a distinguished triangle.
Consider the morphism of distinguished triangles
$$
\xymatrix{\
(F(X), F(Y), F(Z), F(f), F(g), F(h)) \ar[d] \\
(RF(X), RF(Y), RF(Z), RF(f), RF(g), RF(h))
}
$$
Two out of three maps are isomorphisms, hence so is the third.
\end{proof}

\begin{lemma}
\label{lemma-direct-sum-computes}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
Let $X, Y$ be objects of $\mathcal{D}$.
If $X \oplus Y$ computes $RF$, then $X$ and $Y$ compute $RF$.
Similarly for $LF$.
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-direct-sum-defined}
we know that $RF$ is defined at $X$ and $Y$ and that
$RF(X \oplus Y) = RF(X) \oplus RF(Y)$.
Since the map
$$
F(X) \oplus F(Y) = F(X \oplus Y) \longrightarrow
RF(X \oplus Y) = RF(X) \oplus RF(Y)
$$
is compatible with direct sum decompositions we win.
\end{proof}

\begin{lemma}
\label{lemma-existence-computes}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
\begin{enumerate}
\item If for every object $X \in \Ob(\mathcal{D})$
there exists an arrow $s : X \to X'$ in $S$ such that $X'$ computes
$RF$, then $RF$ is everywhere defined.
\item If for every object $X \in \Ob(\mathcal{D})$
there exists an arrow $s : X' \to X$ in $S$ such that $X'$ computes
$LF$, then $LF$ is everywhere defined.
\end{enumerate}
\end{lemma}

\begin{proof}
This is clear from the definitions.
\end{proof}

\begin{lemma}
\label{lemma-find-existence-computes}
Assumptions and notation as in
Situation \ref{situation-derived-functor}.
If there exists a subset $\mathcal{I} \subset \Ob(\mathcal{D})$
such that
\begin{enumerate}
\item for all $X \in \Ob(\mathcal{D})$
there exists $s : X \to X'$ in $S$ with $X' \in \mathcal{I}$,
and
\item for every arrow $s : X \to X'$ in $S$ with $X, X' \in \mathcal{I}$
the map $F(s) : F(X) \to F(X')$ is an isomorphism,
\end{enumerate}
then $RF$ is everywhere defined and every $X \in \mathcal{I}$
computes $RF$. Dually, if there exists a subset
$\mathcal{P} \subset \Ob(\mathcal{D})$
such that
\begin{enumerate}
\item for all $X \in \Ob(\mathcal{D})$
there exists $s : X' \to X$ in $S$ with $X' \in \mathcal{P}$,
and
\item for every arrow $s : X \to X'$ in $S$ with $X, X' \in \mathcal{P}$
the map $F(s) : F(X) \to F(X')$ is an isomorphism,
\end{enumerate}
then $LF$ is everywhere defined and every $X \in \mathcal{P}$
computes $LF$.
\end{lemma}

\begin{proof}
Let $X$ be an object of $\mathcal{D}$.
Assumption (1) implies that the arrows $s : X \to X'$ in $S$ with
$X' \in \mathcal{I}$ are cofinal in the category $X/S$. Assumption
(2) implies that $F$ is constant on this cofinal subcategory.
Clearly this implies that $F : (X/S) \to \mathcal{D}'$ is essentially
constant with value $F(X')$ for any $s : X \to X'$ in $S$
with $X' \in \mathcal{I}$.
\end{proof}

\begin{lemma}
\label{lemma-compose-derived-functors-general}
Let $\mathcal{A}, \mathcal{B}, \mathcal{C}$ be triangulated categories.
Let $S$, resp.\ $S'$ be a saturated multiplicative system in
$\mathcal{A}$, resp.\ $\mathcal{B}$ compatible with the triangulated structure.
Let $F : \mathcal{A} \to \mathcal{B}$ and $G : \mathcal{B} \to \mathcal{C}$
be exact functors. Denote $F' : \mathcal{A} \to (S')^{-1}\mathcal{B}$ the
composition of $F$ with the localization functor.
\begin{enumerate}
\item If $RF'$, $RG$, $R(G \circ F)$ are everywhere defined, then there
is a canonical transformation of functors
$t : R(G \circ F) \longrightarrow RG \circ RF'$.
\item If $LF'$, $LG$, $L(G \circ F)$ are everywhere defined, then there
is a canonical transformation of functors
$t : LG \circ LF' \to L(G \circ F)$.
\end{enumerate}
\end{lemma}

\begin{proof}
In this proof we try to be careful. Hence let us think of
the derived functors as the functors
$$
RF' : S^{-1}\mathcal{A} \to (S')^{-1}\mathcal{B},\quad
R(G \circ F) : S^{-1}\mathcal{A} \to \mathcal{C},\quad
RG : (S')^{-1}\mathcal{B} \to \mathcal{C}.
$$
Let us denote
$Q_A : \mathcal{A} \to S^{-1}\mathcal{A}$ and
$Q_B : \mathcal{B} \to (S')^{-1}\mathcal{B}$
the localization functors. Then $F' = Q_B \circ F$. Note that for
every object $Y$ of $\mathcal{B}$ there is a canonical map
$$
G(Y) \longrightarrow RG(Q_B(Y))
$$
in other words, there is a transformation of functors
$t' : G \to RG \circ Q_B$. Let $X$ be an object of $\mathcal{A}$.
We have
\begin{align*}
R(G \circ F)(Q_A(X))
& = \colim_{s : X \to X' \in S} G(F(X')) \\
& \xrightarrow{t'} \colim_{s : X \to X' \in S} RG(Q_B(F(X'))) \\
& = \colim_{s : X \to X' \in S} RG(F'(X')) \\
& = RG(\colim_{s : X \to X' \in S} F'(X')) \\
& = RG(RF'(X)).
\end{align*}
The system $F'(X')$ is essentially constant in the category
$(S')^{-1}\mathcal{B}$. Hence we may pull the colimit inside the
functor $RG$ in the third equality of the diagram above, see
Categories, Lemma \ref{categories-lemma-image-essentially-constant}
and its proof. We omit the proof this this defines a transformation
of functors. The case of left derived functors is similar.
\end{proof}




\section{Derived functors on derived categories}
\label{section-derived-functors-classical}

\noindent
In practice derived functors come about most often when given an
additive functor between abelian categories.

\begin{situation}
\label{situation-classical}
Here $F : \mathcal{A} \to \mathcal{B}$ is an additive functor between
abelian categories. This induces exact functors
$$
F : K(\mathcal{A}) \to K(\mathcal{B}),\quad
K^{+}(\mathcal{A}) \to K^{+}(\mathcal{B}),\quad
K^{-}(\mathcal{A}) \to K^{-}(\mathcal{B}).
$$
We also denote $F$ the composition $K(\mathcal{A}) \to D(\mathcal{B})$,
$K^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$, and
$K^{-}(\mathcal{A}) \to D(\mathcal{B})$ of $F$ with the localization
functor $K(\mathcal{B}) \to D(\mathcal{B})$, etc. This situation leads
to four derived functors we will consider in the following.
\begin{enumerate}
\item The right derived functor of
$F : K(\mathcal{A}) \to D(\mathcal{B})$
relative to the multiplicative system $\text{Qis}(\mathcal{A})$.
\item The right derived functor of
$F : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$
relative to the multiplicative system $\text{Qis}^{+}(\mathcal{A})$.
\item The left derived functor of
$F : K(\mathcal{A}) \to D(\mathcal{B})$
relative to the multiplicative system $\text{Qis}(\mathcal{A})$.
\item The left derived functor of
$F : K^{-}(\mathcal{A}) \to D^{-}(\mathcal{B})$
relative to the multiplicative system $\text{Qis}(\mathcal{A})$.
\end{enumerate}
Each of these cases is an example of
Situation \ref{situation-derived-functor}.
\end{situation}

\noindent
Some of the ambiguity that may arise is alleviated by the following.

\begin{lemma}
\label{lemma-irrelevant}
In
Situation \ref{situation-classical}.
\begin{enumerate}
\item Let $X$ be an object of $K^{+}(\mathcal{A})$.
The right derived functor of $K(\mathcal{A}) \to D(\mathcal{B})$
is defined at $X$ if and only if the right derived functor of
$K^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is defined at $X$.
Moreover, the values are canonically isomorphic.
\item Let $X$ be an object of $K^{+}(\mathcal{A})$.
Then $X$ computes the right derived functor of
$K(\mathcal{A}) \to D(\mathcal{B})$
if and only if $X$ computes the right derived functor of
$K^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$.
\item Let $X$ be an object of $K^{-}(\mathcal{A})$.
The left derived functor of $K(\mathcal{A}) \to D(\mathcal{B})$
is defined at $X$ if and only if the left derived functor of
$K^{-}(\mathcal{A}) \to D^{-}(\mathcal{B})$ is defined at $X$.
Moreover, the values are canonically isomorphic.
\item Let $X$ be an object of $K^{-}(\mathcal{A})$.
Then $X$ computes the left derived functor of
$K(\mathcal{A}) \to D(\mathcal{B})$ if and only if $X$ computes
the left derived functor of $K^{-}(\mathcal{A}) \to D^{-}(\mathcal{B})$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $X$ be an object of $K^{+}(\mathcal{A})$.
Consider a quasi-isomorphism $s : X \to X'$ in $K(\mathcal{A})$.
By
Lemma \ref{lemma-complex-cohomology-bounded}
there exists quasi-isomorphism $X' \to X''$ with $X''$ bounded below.
Hence we see that $X/\text{Qis}^+(\mathcal{A})$ is cofinal
in $X/\text{Qis}(\mathcal{A})$. Thus it is clear that (1) holds.
Part (2) follows directly from part (1).
Parts (3) and (4) are dual to parts (1) and (2).
\end{proof}

\noindent
Given an object $A$ of an abelian category $\mathcal{A}$ we get a complex
$$
A[0] = ( \ldots \to 0 \to A \to 0 \to \ldots )
$$
where $A$ is placed in degree zero. Hence a functor
$\mathcal{A} \to K(\mathcal{A})$, $A \mapsto A[0]$.
Let us temporarily say that a partial functor is one that is
defined on a subcategory.

\begin{definition}
\label{definition-derived-functor}
In
Situation \ref{situation-classical}.
\begin{enumerate}
\item The {\it right derived functors of $F$} are the partial functors
$RF$ associated to cases (1) and (2) of
Situation \ref{situation-classical}.
\item The {\it left derived functors of $F$} are the partial functors
$RF$ associated to cases (3) and (4) of
Situation \ref{situation-classical}.
\item An object $A$ of $\mathcal{A}$ is said to be
{\it right acyclic for $F$}, or {\it acyclic for $RF$}
if $A[0]$ computes $RF$.
\item An object $A$ of $\mathcal{A}$ is said to be
{\it left acyclic for $F$}, or {\it acyclic for $LF$}
if $A[0]$ computes $RF$.
\end{enumerate}
\end{definition}

\noindent
The following few lemmas give some criteria for the existence of
enough acyclics.

\begin{lemma}
\label{lemma-subcategory-right-resolution}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{I} \subset \Ob(\mathcal{A})$ be a subset such
that every object of $\mathcal{A}$ is a subobject of an element of
$\mathcal{I}$. For every $K^\bullet$ with $K^n = 0$ for $n < a$
there exists a quasi-isomorphism $K^\bullet \to I^\bullet$
with $I^n = 0$ for $n < a$, each $I^n \in \mathcal{I}$, and
each $K^n \to I^n$ injective.
\end{lemma}

\begin{proof}
Consider the following induction hypothesis $IH_n$:
There are $I^j \in \mathcal{I}$, $j \leq n$ almost
all zero, maps $d^j : I^j \to I^{j + 1}$ for $j < n$
and injective maps $\alpha^j : K^j \to I^j$ for $j \leq n$
such that the diagram
$$
\xymatrix{
\ldots \ar[r] & K^{n - 1} \ar[d]^\alpha \ar[r] &
K^n \ar[d]^\alpha \ar[r] &
K^{n + 1} \ar[r] & \ldots \\
\ldots \ar[r] & I^{n - 1} \ar[r] & I^n &  &
}
$$
is commutative, such that $d^j \circ d^{j - 1} = 0$ for $j < n$
and such that $\alpha$ induces isomorphisms
$H^j(K^\bullet) \to \text{Ker}(d^j)/\text{Im}(d^{j - 1})$
for $j < n$. Note that this implies
\begin{equation}
\label{equation-new-star}
\alpha(\text{Im}(d_K^{n - 1}))
\subset
\alpha(\text{Ker}(d_K^n)) \cap \text{Im}(d^{n - 1})
\subset
\alpha(K^n) \cap \text{Im}(d^{n - 1}).
\end{equation}
If these inclusions are not equalities, then choose an injection
$$
I^n \oplus K^n/\text{Im}(d_K^{n - 1}) \longrightarrow I
$$
with $I \in \mathcal{I}$. Denote $\alpha' : K^n \to I$ the map obtained
by composing $\alpha \oplus 1 : K^n \to I^n \oplus K^n/\text{Im}(d_K^{n - 1})$
with the displayed injection. Denote $d' : I^{n - 1} \to I$ the
composition $I^{n - 1} \to I^n \to I$ of $d^{n - 1}$ by the inclusion
of the first summand. Then
$\alpha'(K^n) \cap \text{Im}(d') = \alpha'(\text{Im}(d_K^{n - 1}))$
simply because the intersection of $\alpha'(K^n)$ with the first
summand of $I^n \oplus K^n/\text{Im}(d_K^{n - 1})$ is equal to
$\alpha'(\text{Im}(d_K^{n - 1}))$.
Hence, after replacing $I^n$ by $I$, $\alpha$ by $\alpha'$ and $d^{n - 1}$
by $d'$ we may assume that we have equality in
Equation (\ref{equation-new-star}). Once this is the
case consider the solid diagram
$$
\xymatrix{
K^n/\text{Ker}(d_K^n) \ar[r] \ar[d] & K^{n + 1} \ar@{..>}[d] \\
I^n/(\text{Im}(d^{n - 1}) + \alpha(\text{Ker}(d_K^n))) \ar@{..>}[r] & M
}
$$
The horizontal arrow is injective by fiat and the vertical arrow
is injective as we have equality in (\ref{equation-new-star}).
Hence the push-out $M$ of this diagram contains both
$K^{n + 1}$ and $I^n/(\text{Im}(d^{n - 1}) + \alpha(\text{Ker}(d_K^n)))$
as subobjects. Choose an injection $M \to I^{n + 1}$ with
$I^{n + 1} \in \mathcal{I}$. By construction we get
$d^n : I^n \to I^{n + 1}$ and an injective map
$\alpha^{n + 1} : K^{n + 1} \to I^{n + 1}$.
The equality in Equation (\ref{equation-new-star}) and the construction of
$d^n$ guarantee that $\alpha : H^n(K^\bullet) \to
\text{Ker}(d^n)/\text{Im}(d^{n - 1})$ is an isomorphism.
In other words $IH_{n + 1}$ holds.

\medskip\noindent
We finish the proof of by the following observations.
First we note that $IH_n$ is true for $n = a$ since
we can just take $I^j = 0$ for $j < a$ and $K^a \to I^a$ an injection
of $K^a$ into an element of $\mathcal{A}$.
Next, we note that in the proof of $IH_n \Rightarrow IH_{n + 1}$
we only modified the object $I^n$, the map $d^{n - 1}$ and
the map $\alpha^n$. Hence we see that proceeding by induction
we produce a complex $I^\bullet$ with $I^n = 0$ for $n < a$
consisting of objects from $\mathcal{I}$, and a termwise
injective quasi-isomorphism $\alpha : K^\bullet \to I^\bullet$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-subcategory-left-resolution}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{P} \subset \Ob(\mathcal{A})$ be a subset such
that every object of $\mathcal{A}$ is a quotient of an element of
$\mathcal{P}$. Then for every bounded above complex $K^\bullet$
there exists a quasi-isomorphism $P^\bullet \to K^\bullet$
with $P^\bullet$ bounded above and each $P^n \in \mathcal{P}$.
\end{lemma}

\begin{proof}
This lemma is dual to
Lemma \ref{lemma-subcategory-right-resolution}.
\end{proof}

\begin{lemma}
\label{lemma-subcategory-right-acyclics}
In
Situation \ref{situation-classical}.
Let $\mathcal{I} \subset \Ob(\mathcal{A})$ be a subset with the
following properties:
\begin{enumerate}
\item every object of $\mathcal{A}$ is a subobject of an element of
$\mathcal{I}$,
\item for any short exact sequence $0 \to P \to Q \to R \to 0$ of
$\mathcal{A}$ with $P, Q \in \mathcal{I}$, then $R \in \mathcal{I}$,
and $0 \to F(P) \to F(Q) \to F(R) \to 0$ is exact.
\end{enumerate}
Then every object of $\mathcal{I}$ is acyclic for $RF$.
\end{lemma}

\begin{proof}
Pick $A \in \mathcal{I}$.
Let $A[0] \to K^\bullet$ be a quasi-isomorphism with $L^\bullet$
bounded below. Then we can find a quasi-isomorphism
$K^\bullet \to I^\bullet$ with $I^\bullet$ bounded below and
each $I^n \in \mathcal{I}$, see
Lemma \ref{lemma-subcategory-right-resolution}.
Hence we see that these resolutions are cofinal in the category
$A[0]/\text{Qis}^{+}(\mathcal{A})$. To finish the proof it therefore
suffices to show that for any quasi-isomorphism
$A[0] \to I^\bullet$ with $I^\bullet$ bounded above and $I^n \in \mathcal{I}$
we have $F(A)[0] \to F(I^\bullet)$ is a quasi-isomorphism.
To see this suppose that $I^n = 0$ for $n < n_0$. Of course we may assume
that $n_0 < 0$. Starting with $n = n_0$ we prove inductively that
$\text{Im}(d^{n - 1}) = \text{Ker}(d^n)$ and $\text{Im}(d^{-1})$
are elements of $\mathcal{I}$ using propert (2) and the exact sequences
$$
0 \to \text{Ker}(d^n) \to I^n \to \text{Im}(d^n) \to 0.
$$
Moreover, property (2) also guarantees that the complex
$$
0 \to F(I^{n_0}) \to F(I^{n_0 + 1}) \to \ldots \to F(I^{-1}) \to
F(\text{Im}(d^{-1})) \to 0
$$
is exact. The exact sequence
$0 \to \text{Im}(d^{-1}) \to I^0 \to I^0/\text{Im}(d^{-1}) \to 0$
implies that $I^0/\text{Im}(d^{-1})$ is an element of $\mathcal{I}$.
The exact sequence $0 \to A \to I^0/\text{Im}(d^{-1}) \to \text{Im}(d^0) \to 0$
then implies that $\text{Im}(d^0) = \text{Ker}(d^1)$ is an elements of
$\mathcal{I}$ and from then on one continues as before to show that
$\text{Im}(d^{n - 1}) = \text{Ker}(d^n)$ is an element of $\mathcal{I}$
for all $n > 0$. Applying $F$ to each of the short exact sequences
mentioned above and using (2) we observe that $F(A)[0] \to F(I^\bullet)$
is an isomorphism as desired.
\end{proof}

\begin{lemma}
\label{lemma-subcategory-left-acyclics}
In
Situation \ref{situation-classical}.
Let $\mathcal{P} \subset \Ob(\mathcal{A})$ be a subset with the
following properties:
\begin{enumerate}
\item every object of $\mathcal{A}$ is a quotient of an element of
$\mathcal{P}$,
\item for any short exact sequence $0 \to P \to Q \to R \to 0$ of
$\mathcal{A}$ with $Q, R \in \mathcal{P}$, then $P \in \mathcal{P}$,
and $0 \to F(P) \to F(Q) \to F(R) \to 0$ is exact.
\end{enumerate}
Then every object of $\mathcal{P}$ is acyclic for $LF$.
\end{lemma}

\begin{proof}
Dual to the proof of
Lemma \ref{lemma-subcategory-right-acyclics}.
\end{proof}

\begin{proposition}
\label{proposition-enough-acyclics}
In
Situation \ref{situation-classical}.
\begin{enumerate}
\item If every object of $\mathcal{A}$ injects into an object acyclic
for $RF$, then $RF$ is defined on all of $K^{+}(\mathcal{A})$
and we obtain an exact functor
$$
RF : D^{+}(\mathcal{B}) \longrightarrow D^{+}(\mathcal{A})
$$
see (\ref{equation-everywhere}). Moreover, any bounded below complex
$K^\bullet$ whose terms are acyclic for $RF$ computes $RF$.
\item If every object of $\mathcal{A}$ is quotient of
an object acyclic for $LF$, then $LF$ is defined on all of
$K^{-}(\mathcal{A})$ and we obtain an exact functor
$$
LF : D^{-}(\mathcal{B}) \longrightarrow D^{-}(\mathcal{A})
$$
see (\ref{equation-everywhere}). Moreover, any bounded above complex
$K^\bullet$ whose terms are acyclic for $LF$ computes $LF$.
\end{enumerate}
\end{proposition}

\begin{proof}
Suppose every object of $\mathcal{A}$ injects into an object acyclic
for $RF$. Let $\mathcal{I}$ be the set of objects acyclic for $RF$.
Let $K^\bullet$ be a bounded below complex with $K^n \in \mathcal{I}$. By
Lemma \ref{lemma-subcategory-right-resolution}
the quasi-isomorphisms $\alpha : K^\bullet \to I^\bullet$ with
$I^\bullet$ bounded below and $I^n \in \mathcal{I}$ are cofinal in
the category $K^\bullet/\text{Qis}^+(\mathcal{A})$. Hence in order to
show that $K^\bullet$ computes $RF$ it suffices to show that
$F(K^\bullet) \to F(I^\bullet)$ is an isomorphism.
Note that $C(\alpha)^\bullet$ is an acyclic bounded below complex
all of whose terms are in $\mathcal{I}$.
Hence it suffices to show: given an acyclic bounded below complex
$I^\bullet$ all of whose terms are in $\mathcal{I}$ the complex
$F(I^\bullet)$ is acyclic.

\medskip\noindent
Say $I^n = 0$ for $n < n_0$. Then we break $I^\bullet$ into short
exact sequences
$0 \to \text{Im}(d^n) \to I^{n + 1} \to \text{Im}(d^{n + 1}) \to 0$
for $n \geq n_0$. These sequences induce distinguished triangles
$(\text{Im}(d^n), I^{n + 1}, \text{Im}(d^{n + 1}))$ by
Lemma \ref{lemma-derived-canonical-delta-functor}.
This implies inductively that
each $\text{Im}(d^n)$ is acyclic for $RF$ by
Lemma \ref{lemma-2-out-of-3-computes}.
Moreover, the long exact cohomology sequences
(\ref{equation-long-exact-cohomology-sequence-D})
associated to the distinguished triangles
$(F(\text{Im}(d^n)), F(I^{n + 1}), F(\text{Im}(d^{n + 1})))$
of $D^{+}(\mathcal{B})$ imply that
$$
0 \to F(\text{Im}(d^n)) \to F(I^{n + 1}) \to F(\text{Im}(d^{n + 1})) \to 0
$$
is short exact, and this in turn proves that $F(I^\bullet)$ is exact.

\medskip\noindent
Finally, since by
Lemma \ref{lemma-subcategory-right-resolution}
every object of $K^{+}(\mathcal{A})$ is quasi-isomorphic to such
a bounded below complex with terms in $\mathcal{I}$ we see that
$RF$ is everywhere defined, see
Lemma \ref{lemma-existence-computes}.
The proof in the case of $LF$ is dual.
\end{proof}






\section{Higher derived functors}
\label{section-higher-derived}

\noindent
The following simple lemma shows that right derived functors
``move to the right''.

\begin{lemma}
\label{lemma-negative-vanishing}
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor
between abelian categories. Let $K^\bullet \in K^{+}(\mathcal{A})$
and $a \in \mathbf{Z}$ such that $H^i(K^\bullet) = 0$ for all
$i < a$. If $RF$ is defined at $K^\bullet$, then
$H^i(RF(K^\bullet)) = 0$ for all $i < a$.
\end{lemma}

\begin{proof}
Let $K^\bullet \to L^\bullet$ be any quasi-isomorphism.
Then it is also true that $K^\bullet \to \tau_{\geq a}L^\bullet$
is a quasi-isomorphism by our assumption on $K^\bullet$.
Hence in the category $K^\bullet/\text{Qis}^{+}(\mathcal{A})$ the
quasi-isomorphisms $s : K^\bullet \to L^\bullet$ with $L^n = 0$ for $n < a$
are cofinal. Thus $RF$ is the value of the essentially constant
ind-object $F(L^\bullet)$ for these $s$ it follows that
$H^i(RF(K^\bullet)) = 0$ for $i < 0$.
\end{proof}

\begin{definition}
\label{definition-higher-derived-functors}
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor
between abelian categories. Assume
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere
defined. Let $i \in \mathbf{Z}$.
The {\it $i$th right derived functor $R^iF$ of $F$} is the functor
$$
R^iF = H^i \circ RF :
\mathcal{A}
\longrightarrow
\mathcal{B}
$$
\end{definition}

\noindent
The following lemma shows that it really does not make a lot
of sense to take the right derived functor unless the functor
is left exact.

\begin{lemma}
\label{lemma-left-exact-higher-derived}
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor
between abelian categories and assume
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere
defined.
\begin{enumerate}
\item We have $R^iF = 0$ for $i < 0$,
\item $R^0F$ is left exact,
\item the map $F \to R^0F$ is an isomorphism if and
only if $F$ is left exact.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $A$ be an object of $\mathcal{A}$. Let $A[0] \to K^\bullet$
be any quasi-isomorphism. Then it is also true that
$A[0] \to \tau_{\geq 0}K^\bullet$ is a quasi-isomorphism.
Hence in the category $A[0]/\text{Qis}^{+}(\mathcal{A})$ the
quasi-isomorphisms $s : A[0] \to K^\bullet$ with $K^n = 0$ for $n < 0$
are cofinal. Thus it is clear that $H^i(RF(A[0])) = 0$ for $i < 0$.
Moreover, for such an $s$ the sequence
$$
0 \to A \to K^0 \to K^1
$$
is exact. Hence if $F$ is left exact, then $0 \to F(A) \to F(K^0) \to F(K^1)$
is exact as well, and we see that $F(A) \to H^0(F(K^\bullet))$ is an
isomorphism for every $s : A[0] \to K^\bullet$ as above which implies
that $H^0(RF(A[0])) = F(A)$.

\medskip\noindent
Let $0 \to A \to B \to C \to 0$ be a short exact sequence of $\mathcal{A}$.
By
Lemma \ref{lemma-derived-canonical-delta-functor}
we obtain a distinguished triangle
$(A[0], B[0], C[0], a, b, c)$ in $K^{+}(\mathcal{A})$.
From the long exact cohomology sequence (and the vanishing for $i < 0$
proved above) we deduce that $0 \to R^0F(A) \to R^0F(B) \to R^0F(C)$
is exact. Hence $R^0F$ is left exact. Of course this also proves that if
$F \to R^0F$ is an isomorphism, then $F$ is left exact.
\end{proof}

\begin{lemma}
\label{lemma-F-acyclic}
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor
between abelian categories and assume
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere
defined. Let $A$ be an object of $\mathcal{A}$.
\begin{enumerate}
\item $A$ is right acyclic for $F$ if and only if
$F(A) \to R^0F(A)$ is an isomorphism and $R^iF(A) = 0$ for all $i > 0$,
\item if $F$ is left exact, then $A$ is right acyclic for $F$
if and only if $R^iF(A) = 0$ for all $i > 0$.
\end{enumerate}
\end{lemma}

\begin{proof}
If $A$ is right acyclic for $F$, then $RF(A[0]) = F(A)[0]$ and in
particular $F(A) \to R^0F(A)$ is an isomorphism and
$R^iF(A) = 0$ for $i \not = 0$. Conversely, if $F(A) \to R^0F(A)$
is an isomorphism and $R^iF(A) = 0$ for all $i > 0$ then
$F(A[0]) \to RF(A[0])$ is a quasi-isomorphism by
Lemma \ref{lemma-left-exact-higher-derived} part (1)
and hence $A$ is acyclic. If $F$ is left exact then $F = R^0F$, see
Lemma \ref{lemma-left-exact-higher-derived}.
\end{proof}

\begin{lemma}
\label{lemma-F-acyclic-ses}
Let $F : \mathcal{A} \to \mathcal{B}$ be a left exact functor
between abelian categories and assume
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere
defined. Let $0 \to A \to B \to C \to 0$ be a short exact sequence
of $\mathcal{A}$.
\begin{enumerate}
\item If $A$ and $C$ are right acyclic for $F$ then so is $B$.
\item If $A$ and $B$ are right acyclic for $F$ then so is $C$.
\item If $B$ and $C$ are right acyclic for $F$ and $F(B) \to F(C)$ is
surjective then $A$ is right acyclic for $F$.
\end{enumerate}
In each of the three cases
$$
0 \to F(A) \to F(B) \to F(C) \to 0
$$
is a short exact sequence of $\mathcal{B}$.
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-derived-canonical-delta-functor}
we obtain a distinguished triangle
$(A[0], B[0], C[0], a, b, c)$ in $K^{+}(\mathcal{A})$.
As $RF$ is an exact functor and since
$R^iF = 0$ for $i < 0$ and $R^0F = F$
(Lemma \ref{lemma-left-exact-higher-derived})
we obtain an exact cohomology sequence
$$
0 \to F(A) \to F(B) \to F(C) \to R^1F(A) \to \ldots
$$
in the abelian category $\mathcal{B}$. Thus the lemma follows from
the characterization of acyclic objects in
Lemma \ref{lemma-F-acyclic}.
\end{proof}

\begin{lemma}
\label{lemma-right-derived-delta-functor}
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor
between abelian categories and assume
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere defined.
\begin{enumerate}
\item The functors $R^iF$, $i \geq 0$ come equipped with a canonical
structure of a $\delta$-functor from $\mathcal{A} \to \mathcal{B}$, see
Homology, Definition \ref{homology-definition-cohomological-delta-functor}.
\item If every object of $\mathcal{A}$ is a subobject of a right
acyclic object for $F$, then $\{R^iF, \delta\}_{i \geq 0}$ is a
universal $\delta$-functor, see
Homology, Definition \ref{homology-definition-universal-delta-functor}.
\end{enumerate}
\end{lemma}

\begin{proof}
The functor $\mathcal{A} \to \text{Comp}^{+}(\mathcal{A})$,
$A \mapsto A[0]$ is exact. The functor
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
is a $\delta$-functor, see
Lemma \ref{lemma-derived-canonical-delta-functor}.
The functor $RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is exact.
Finally, the functor $H^0 : D^{+}(\mathcal{B}) \to \mathcal{B}$
is a homological functor, see
Definition \ref{definition-unbounded-derived-category}.
Hence we get the structure of a $\delta$-functor from
Lemma \ref{lemma-compose-delta-functor-homological}
and
Lemma \ref{lemma-exact-compose-delta-functor}.
Part (2) follows from
Homology, Lemma \ref{homology-lemma-efface-implies-universal}
and the description of acyclics in
Lemma \ref{lemma-F-acyclic}.
\end{proof}

\begin{lemma}
\label{lemma-leray-acyclicity}
(Leray's acyclicity lemma)
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor
between abelian categories and assume
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is everywhere defined.
Let $A^\bullet$ be a bounded below complex of $F$-acyclic objects.
The canonical map
$$
F(A^\bullet) \longrightarrow RF(A^\bullet)
$$
is an isomorphism in $D^{+}(\mathcal{B})$, i.e., $A^\bullet$ computes
$RF$.
\end{lemma}

\begin{proof}
First we claim the lemma holds for a bounded complex of acyclic objects.
Namely, it holds for complexes with at most one nonzero object by definition.
Suppose that $A^\bullet$ is a complex with $A^n = 0$ for
$n \not \in [a, b]$. Using the ``stupid'' truncations we obtain
a termwise split short exact sequence of complexes
$$
0 \to \sigma_{\geq a + 1} A^\bullet \to A^\bullet \to
\sigma_{\leq a} A^\bullet \to 0
$$
see
Homology, Section \ref{homology-section-truncations}.
Thus a distinguished triangle
$(\sigma_{\geq a + 1} A^\bullet, A^\bullet, \sigma_{\leq a} A^\bullet)$.
By induction hypothesis the two outer complexes compute $RF$.
Then the middle one does too by
Lemma \ref{lemma-2-out-of-3-computes}.

\medskip\noindent
Suppose that $A^\bullet$ is a bounded below complex of acyclic objects.
To show that $F(A) \to RF(A)$ is an isomorphism in $D^{+}(\mathcal{B})$
it suffices to show that $H^i(F(A)) \to H^i(RF(A))$ is an isomorphism for
all $i$. Pick $i$. Consider the termwise split short exact sequence of
complexes
$$
0 \to \sigma_{\geq i + 2} A^\bullet \to A^\bullet \to
\sigma_{\leq i + 1} A^\bullet \to 0.
$$
Note that this induces a termwise split short exact sequence
$$
0 \to \sigma_{\geq i + 2} F(A^\bullet) \to F(A^\bullet) \to
\sigma_{\leq i + 1} F(A^\bullet) \to 0.
$$
Hence we get distinguished triangles
$$
\begin{matrix}
(\sigma_{\geq i + 2} A^\bullet, A^\bullet,
\sigma_{\leq i + 1} A^\bullet) \\
(\sigma_{\geq a + 1} F(A^\bullet), F(A^\bullet),
\sigma_{\leq a} F(A^\bullet)) \\
(RF(\sigma_{\geq a + 1} A^\bullet), RF(A^\bullet),
RF(\sigma_{\leq a} A^\bullet))
\end{matrix}
$$
Using the last two we obtain a map of exact sequences
$$
\xymatrix{
H^i(\sigma_{\geq i + 2} F(A^\bullet)) \ar[r] \ar[d] &
H^i(F(A^\bullet)) \ar[r] \ar[d]^\alpha &
H^i(\sigma_{\leq i + 1} F(A^\bullet)) \ar[r] \ar[d]^\beta &
H^{i + 1}(\sigma_{\geq i + 2} F(A^\bullet)) \ar[d] \\
R^iF(\sigma_{\geq i + 2} A^\bullet) \ar[r] &
R^iF(A^\bullet) \ar[r] &
R^iF(\sigma_{\leq i + 1} A^\bullet) \ar[r] &
R^{i + 1}F(\sigma_{\geq i + 2} A^\bullet)
}
$$
By the results of the first paragraph the map $\beta$ is an isomorphism.
By inspection the objects on the upper left and the upper right
are zero. Hence to finish the proof we have to show that
$R^iF(\sigma_{\geq i + 2} A^\bullet) = 0$ and
$R^{i + 1}F(\sigma_{\geq i + 2} A^\bullet) = 0$.
This follows immediately from
Lemma \ref{lemma-negative-vanishing}.
\end{proof}

\begin{lemma}
\label{lemma-right-derived-exact-functor}
Let $F : \mathcal{A} \to \mathcal{B}$ be an exact functor of
abelian categories. Then
\begin{enumerate}
\item every object of $\mathcal{A}$ is right acyclic for $F$,
\item $RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ is everywhere defined,
\item $RF : D(\mathcal{A}) \to D(\mathcal{A})$ is everywhere defined,
\item every complex computes $RF$, in other words, the canonical
map $F(K^\bullet) \to RF(K^\bullet)$ is an isomorphism for all complexes, and
\item $R^iF = 0$ for $i \not = 0$.
\end{enumerate}
\end{lemma}

\begin{proof}
This is true because $F$ transforms acyclic complexes into acyclic complexes
and quasi-isomorphisms into quasi-isomorphisms. Details omitted.
\end{proof}










\section{Injective resolutions}
\label{section-injective-resolutions}

\noindent
In this section we prove some lemmas regarding the existence
of injective resolutions in abelian categories having enough injectives.

\begin{definition}
\label{definition-injective-resolution}
Let $\mathcal{A}$ be an abelian category.
Let $A \in \Ob(\mathcal{A})$.
An {\it injective resolution of $A$} is a complex
$I^\bullet$ together with a map $A \to I^0$ such
that:
\begin{enumerate}
\item We have $I^n = 0$ for $n < 0$.
\item Each $I^n$ is an injective object of $\mathcal{A}$.
\item The map $A \to I^0$ is an isomorphism onto $\text{Ker}(d^0)$.
\item We have $H^i(I^\bullet) = 0$ for $i > 0$.
\end{enumerate}
Hence $A[0] \to I^\bullet$ is a quasi-isomorphism.
In other words the complex
$$
\ldots \to 0 \to A \to I^0 \to I^1 \to \ldots
$$
is acyclic.
Let $K^\bullet$ be a complex in $\mathcal{A}$.
An {\it injective resolution of $K^\bullet$} is a complex
$I^\bullet$ together with a map $\alpha : K^\bullet \to I^\bullet$
of complexes such that
\begin{enumerate}
\item We have $I^n = 0$ for $n \ll 0$, i.e., $I^\bullet$ is bounded below.
\item Each $I^n$ is an injective object of $\mathcal{A}$.
\item The map $\alpha : K^\bullet \to I^\bullet$ is a
quasi-isomorphism.
\end{enumerate}
\end{definition}

\noindent
In other words an injective resolution $K^\bullet \to I^\bullet$
gives rise to a diagram
$$
\xymatrix{
\ldots \ar[r] & K^{n - 1} \ar[d] \ar[r] & K^n \ar[d] \ar[r] &
K^{n + 1} \ar[d] \ar[r] & \ldots \\
\ldots \ar[r] & I^{n - 1} \ar[r] & I^n \ar[r] & I^{n + 1} \ar[r] & \ldots
}
$$
which induces an isomorphism on cohomology objects in each degree.
An injective resolution of an object $A$ of $\mathcal{A}$
is almost the same thing as an injective resolution of
the complex $A[0]$.

\begin{lemma}
\label{lemma-cohomology-bounded-below}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a complex of $\mathcal{A}$.
\begin{enumerate}
\item If $K^\bullet$ has an injective resolution then
$H^n(K^\bullet) = 0$ for $n \ll 0$.
\item If $H^n(K^\bullet) = 0$ for all $n \ll 0$ then there
exists a quasi-isomorphism $K^\bullet \to L^\bullet$
with $L^\bullet$ bounded below.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted. For the second statement use
$L^\bullet = K^\bullet / \tau_{\leq n}K^\bullet$ for
some $n \ll 0$. See
Homology, Section \ref{homology-section-truncations}
for the definition of the truncation $\tau_{\leq n}$.
\end{proof}

\begin{lemma}
\label{lemma-injective-resolutions-exist}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
\begin{enumerate}
\item Any object of $\mathcal{A}$ has an injective resolution.
\item If $H^n(K^\bullet) = 0$ for all $n \ll 0$ then
$K^\bullet$ has an injective resolution.
\item If $K^\bullet$ is a complex with $K^n = 0$ for $n < a$, then
there exists an injective resolution $\alpha : K^\bullet \to I^\bullet$
with $I^n = 0$ for $n < a$ such that each $\alpha^n : K^n \to I^n$ is
injective.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). First choose an injection $A \to I^0$ of $A$ into an
injective object of $\mathcal{A}$. Next, choose an injection
$I_0/A \to I^1$ into an injective object of $\mathcal{A}$.
Denote $d^0$ the induced map $I^0 \to I^1$.
Next, choose an injection $I^1/\text{Im}(d^0) \to I^2$ into
an injective object of $\mathcal{A}$. Denote $d^1$ the induced
map $I^1 \to I^2$. And so on.
By Lemma \ref{lemma-cohomology-bounded-below} part (2) follows from part (3).
Part (3) is a special case of
Lemma \ref{lemma-subcategory-right-resolution}.
\end{proof}

\begin{lemma}
\label{lemma-acyclic-is-zero}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be an acyclic complex.
Let $I^\bullet$ be bounded below and consisting of injective objects.
Any morphism $K^\bullet \to I^\bullet$ is homotopic to zero.
\end{lemma}

\begin{proof}
Let $\alpha : K^\bullet \to I^\bullet$ be a morphism of
complexes. Assume that $\alpha^j = 0$ for $j < n$.
We will show that there exists a morphism $h : K^{n + 1} \to I^n$
such that $\alpha^n = h \circ d$. Thus $\alpha$ will be homotopic
to the morphism of complexes $\beta$ defined by
$$
\beta^j =
\left\{
\begin{matrix}
0 & \text{if} & j \leq n \\
\alpha^{n + 1} - d \circ h & \text{if} & j = n + 1 \\
\alpha^j & \text{if} & j > n + 1
\end{matrix}
\right.
$$
This will clearly prove the lemma (by induction).
To prove the existence of $h$ note that
$\alpha^n|_{d^{n - 1}(K^{n - 1})} = 0$ since
$\alpha^{n - 1} = 0$. Since $K^\bullet$ is acyclic we
have $d^{n - 1}(K^{n - 1}) = \text{Ker}(K^n \to K^{n + 1})$.
Hence we can think of $\alpha^n$ as a map into $I^n$ defined
on the subobject $\text{Im}(K^n \to K^{n + 1})$ of $K^{n + 1}$.
By injectivity of the object $I^n$ we can extend this to
a map $h : K^{n + 1} \to I^n$ as desired.
\end{proof}

\begin{remark}
\label{remark-easier-proofs}
Let $\mathcal{A}$ be an abelian category.
Using the fact that $K(\mathcal{A})$ is a triangulated category we
may use
Lemma \ref{lemma-acyclic-is-zero}
to obtain proofs of some of the lemmas below which are usually proved by
chasing through diagrams.
Namely, suppose that $\alpha : K^\bullet \to L^\bullet$ is a quasi-isomorphism
of complexes. Then
$$
(K^\bullet, L^\bullet, C(\alpha)^\bullet, \alpha, i, -p)
$$
is a distinguished triangle in $K(\mathcal{A})$
(Lemma \ref{lemma-the-same-up-to-isomorphisms})
and $C(f)^\bullet$ is an acyclic complex
(Lemma \ref{lemma-acyclic}).
Next, let $I^\bullet$ be a bounded below complex of injective objects. Then
$$
\xymatrix{
\Hom_{K(\mathcal{A})}(C(\alpha)^\bullet, I^\bullet) \ar[r] &
\Hom_{K(\mathcal{A})}(L^\bullet, I^\bullet) \ar[r] &
\Hom_{K(\mathcal{A})}(K^\bullet, I^\bullet) \ar[lld] \\
\Hom_{K(\mathcal{A})}(C(\alpha)^\bullet[-1], I^\bullet)
}
$$
is an exact sequence of abelian groups, see
Lemma \ref{lemma-representable-homological}.
At this point
Lemma \ref{lemma-acyclic-is-zero}
guarantees that the outer two groups are zero and hence
$\Hom_{K(\mathcal{A})}(L^\bullet, I^\bullet) =
\Hom_{K(\mathcal{A})}(K^\bullet, I^\bullet)$.
\end{remark}

\begin{lemma}
\label{lemma-morphisms-lift}
Let $\mathcal{A}$ be an abelian category.
Consider a solid diagram
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_\gamma & L^\bullet \ar@{-->}[dl]^\beta \\
I^\bullet
}
$$
where $I^\bullet$ is bounded below and consists of injective
objects, and $\alpha$ is a quasi-isomorphism.
\begin{enumerate}
\item There exists a map of complexes $\beta$ making the diagram
commute up to homotopy.
\item If $\alpha$ is injective in every degree
then we can find a $\beta$ which makes the diagram commute.
\end{enumerate}
\end{lemma}

\begin{proof}
The ``correct'' proof of part (1) is explained in
Remark \ref{remark-easier-proofs}.
We also give a direct proof here.

\medskip\noindent
We first show that (2) implies (1). Namely, let
$\tilde \alpha : K \to \tilde L^\bullet$, $\pi$, $s$ be as in
Lemma \ref{lemma-make-injective}. Since $\tilde \alpha$ is injective
by (2) there exists a morphism $\tilde \beta : \tilde L^\bullet \to I^\bullet$
such that $\gamma = \tilde \beta \circ \tilde \alpha$. Set
$\beta = \tilde \beta \circ s$. Then we have
$$
\beta \circ \alpha
=
\tilde \beta \circ s \circ \pi \circ \tilde \alpha
\sim
\tilde \beta \circ \tilde \alpha
=
\gamma
$$
as desired.

\medskip\noindent
Assume that $\alpha : K^\bullet \to L^\bullet$ is injective.
Suppose we have already defined $\beta$ in all degrees
$\leq n - 1$ compatible with differentials and such that
$\gamma^j = \beta^j \circ \alpha^j$ for all $j \leq n - 1$.
Consider the commutative solid diagram
$$
\xymatrix{
K^{n - 1} \ar[r] \ar@/_2pc/[dd]_\gamma \ar[d]^\alpha &
K^n \ar@/^2pc/[dd]^\gamma \ar[d]^\alpha \\
L^{n - 1} \ar[r] \ar[d]^\beta &
L^n \ar@{-->}[d] \\
I^{n - 1} \ar[r] &
I^n
}
$$
Thus we see that the dotted arrow is prescribed on the subobjects
$\alpha(K^n)$ and $d^{n - 1}(L^{n - 1})$. Moreover, these two arrows
agree on $\alpha(d^{n - 1}(K^{n - 1}))$. Hence if
\begin{equation}
\label{equation-qis}
\alpha(d^{n - 1}(K^{n - 1}))
=
\alpha(K^n) \cap d^{n - 1}(L^{n - 1})
\end{equation}
then these morphisms glue to a morphism
$\alpha(K^n) + d^{n - 1}(L^{n - 1}) \to I^n$ and, using the injectivity
of $I^n$, we can extend this to a morphism from all of $L^n$ into $I^n$.
After this by induction we get the morphism $\beta$ for all $n$ simultaneously
(note that we can set $\beta^n = 0$ for all $n \ll 0$ since $I^\bullet$
is bounded below -- in this way starting the induction).

\medskip\noindent
It remains to prove the equality (\ref{equation-qis}).
The reader is encouraged to argue this for themselves with a suitable
diagram chase. Nonetheless here is our argument.
Note that the inclusion
$\alpha(d^{n - 1}(K^{n - 1})) \subset \alpha(K^n) \cap d^{n - 1}(L^{n - 1})$
is obvious. Take an object $T$ of $\mathcal{A}$ and a morphism
$x : T \to L^n$ whose image is contained in the subobject
$\alpha(K^n) \cap d^{n - 1}(L^{n - 1})$.
Since $\alpha$ is injective we see that $x = \alpha \circ x'$ for
some $x' : T \to K^n$. Moreover, since $x$ lies in $d^{n - 1}(L^{n - 1})$
we see that $d^n \circ x = 0$. Hence using injectivity of $\alpha$ again
we see that $d^n \circ x' = 0$. Thus $x'$ gives a morphism
$[x'] : T \to H^n(K^\bullet)$. On the other hand the corresponding
map $[x] : T \to H^n(L^\bullet)$ induced by $x$ is zero by assumption.
Since $\alpha$ is a quasi-isomorphism we conclude that $[x'] = 0$.
This of course means exactly that the image of $x'$ is
contained in $d^{n - 1}(K^{n - 1})$ and we win.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-equal-up-to-homotopy}
Let $\mathcal{A}$ be an abelian category.
Consider a solid diagram
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_\gamma & L^\bullet \ar@{-->}[dl]^{\beta_i} \\
I^\bullet
}
$$
where $I^\bullet$ is bounded below and consists of injective
objects, and $\alpha$ is a quasi-isomorphism.
Any two morphisms $\beta_1, \beta_2$ making the diagram commute
up to homotopy are homotopic.
\end{lemma}

\begin{proof}
This follows from
Remark \ref{remark-easier-proofs}.
We also give a direct argument here.

\medskip\noindent
Let $\tilde \alpha : K \to \tilde L^\bullet$, $\pi$, $s$ be as in
Lemma \ref{lemma-make-injective}. If we can show that $\beta_1 \circ\pi$
is homotopic to $\beta_2 \circ \pi$, then we deduce that
$\beta_1 \sim \beta_2$ because $\pi \circ s$ is the identity.
Hence we may assume $\alpha^n : K^n \to L^n$ is the
inclusion of a direct summand for all $n$. Thus we get a
short exact sequence of complexes
$$
0 \to K^\bullet \to L^\bullet \to M^\bullet \to 0
$$
which is termwise split and such that $M^\bullet$ is acyclic.
We choose splittings $L^n = K^n \oplus M^n$, so we have
$\beta_i^n : K^n \oplus M^n \to I^n$ and $\gamma^n : K^n \to I^n$.
In this case the condition on $\beta_i$ is that there are morphisms
$h_i^n : K^n \to I^{n - 1}$ such that
$$
\gamma^n - \beta_i^n|_{K^n} = d \circ h_i^n + h_i^{n + 1} \circ d
$$
Thus we see that
$$
\beta_1^n|_{K^n} - \beta_2^n|_{K^n}
=
d \circ (h_1^n - h_2^n) + (h_1^{n + 1} - h_2^{n + 1}) \circ d
$$
Consider the map $h^n : K^n \oplus M^n \to I^{n - 1}$ which
equals $h_1^n - h_2^n$ on the first summand and zero on the second.
Then we see that
$$
\beta_1^n - \beta_2^n
-
(d \circ h^n + h^{n + 1}) \circ d)
$$
is a morphism of complexes $L^\bullet \to I^\bullet$
which is identically zero on the subcomplex $K^\bullet$.
Hence it factors as $L^\bullet \to M^\bullet \to I^\bullet$.
Thus the result of the lemma follows from Lemma \ref{lemma-acyclic-is-zero}.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-into-injective-complex}
Let $\mathcal{A}$ be an abelian category.
Let $I^\bullet$ be bounded below complex consisting of injective
objects. Let $L^\bullet \in K(\mathcal{A})$. Then
$$
\Mor_{K(\mathcal{A})}(L^\bullet, I^\bullet)
=
\Mor_{D(\mathcal{A})}(L^\bullet, I^\bullet).
$$
\end{lemma}

\begin{proof}
Let $a$ be an element of the right hand side.
We may represent $a = \gamma\alpha^{-1}$ where
$\alpha : K^\bullet \to L^\bullet$
is a quasi-isomorphism and $\gamma : K^\bullet \to I^\bullet$ is a map
of complexes. By
Lemma \ref{lemma-morphisms-lift}
we can find a morphism $\beta : L^\bullet \to I^\bullet$ such that
$\beta \circ \alpha$ is homotopic to $\gamma$. This proves that the
map is surjective. Let $b$ be an element of the left hand side
which maps to zero in the right hand side. Then $b$ is the homotopy class
of a morphism $\beta : L^\bullet \to I^\bullet$ such that there exists a
quasi-iomorphism $\alpha : K^\bullet \to L^\bullet$ with
$\beta  \circ \alpha$ homotopic to zero. Then
Lemma \ref{lemma-morphisms-equal-up-to-homotopy}
shows that $\beta$ is homotopic to zero also, i.e., $b = 0$.
\end{proof}

\begin{lemma}
\label{lemma-injective-resolution-ses}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
For any short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
of $\text{Comp}^{+}(\mathcal{A})$ there exists a
commutative diagram in $\text{Comp}^{+}(\mathcal{A})$
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I_1^\bullet \ar[r] &
I_2^\bullet \ar[r] &
I_3^\bullet \ar[r] &
0
}
$$
where the vertical arrows are injective resolutions and
the rows are short exact sequences of complexes.
In fact, given any injective resolution $A^\bullet \to I^\bullet$
we may assume $I_1^\bullet = I^\bullet$.
\end{lemma}

\begin{proof}
Step 1. Choose an injective resolution $A^\bullet \to I^\bullet$ (see
Lemma \ref{lemma-injective-resolutions-exist}) or use the given one.
Recall that $\text{Comp}^{+}(\mathcal{A})$ is an
abelian category, see
Homology, Lemma \ref{homology-lemma-cat-cochain-abelian}.
Hence we may form the pushout along
the injective map $A^\bullet \to I^\bullet$ to get
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I^\bullet \ar[r] &
E^\bullet \ar[r] &
C^\bullet \ar[r] &
0
}
$$
Note that the lower short exact sequence is termwise split, see
Homology, Lemma \ref{homology-lemma-characterize-injectives}.
Hence it suffices to prove the lemma when
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$ is
termwise split.

\medskip\noindent
Step 2. Choose splittings. In other words, write
$B^n = A^n \oplus C^n$. Denote $\delta : C^\bullet \to A^\bullet[1]$
the morphism as in
Homology, Lemma \ref{homology-lemma-ses-termwise-split-cochain}.
Choose injective resolutions $f_1 : A^\bullet \to I_1^\bullet$
and $f_3 : C^\bullet \to I_3^\bullet$. (If $A^\bullet$ is a complex of
injectives, then use $I_1^\bullet = A^\bullet$.)
We may assume $f_3$ is injective in
every degree. By Lemma \ref{lemma-morphisms-lift} we may find
a morphism $\delta' : I_3^\bullet \to I_1^\bullet[1]$ such
that $\delta' \circ f_3 = f_1[1] \circ \delta$ (equality of
morphisms of complexes). Set $I_2^n = I_1^n \oplus I_3^n$.
Define
$$
d_{I_2}^n =
\left(
\begin{matrix}
d_{I_1}^n & (\delta')^n \\
0 & d_{I_3}^n
\end{matrix}
\right)
$$
and define the maps $B^n \to I_2^n$ to be given as the
sum of the maps $A^n \to I_1^n$ and $C^n \to I_3^n$.
Everything is clear.
\end{proof}








\section{Projective resolutions}
\label{section-projective-resolutions}

\noindent
This section is dual to
Section \ref{section-injective-resolutions}.
We give definitions and state results, but we do not reprove the lemmas.

\begin{definition}
\label{definition-projective-resolution}
Let $\mathcal{A}$ be an abelian category.
Let $A \in \Ob(\mathcal{A})$.
An {\it projective resolution of $A$} is a complex
$P^\bullet$ together with a map $P^0 \to A$ such
that:
\begin{enumerate}
\item We have $P^n = 0$ for $n > 0$.
\item Each $P^n$ is an projective object of $\mathcal{A}$.
\item The map $P^0 \to A$ induces an isomorphism $\text{Coker}(d^{-1}) \to A$.
\item We have $H^i(P^\bullet) = 0$ for $i < 0$.
\end{enumerate}
Hence $P^\bullet \to A[0]$ is a quasi-isomorphism.
In other words the complex
$$
\ldots \to P^{-1} \to P^0 \to A \to 0 \to \ldots
$$
is acyclic. Let $K^\bullet$ be a complex in $\mathcal{A}$.
An {\it projective resolution of $K^\bullet$} is a complex
$P^\bullet$ together with a map $\alpha : P^\bullet \to K^\bullet$
of complexes such that
\begin{enumerate}
\item We have $P^n = 0$ for $n \gg 0$, i.e., $P^\bullet$ is bounded above.
\item Each $P^n$ is an projective object of $\mathcal{A}$.
\item The map $\alpha : P^\bullet \to K^\bullet$ is a
quasi-isomorphism.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-cohomology-bounded-above}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a complex of $\mathcal{A}$.
\begin{enumerate}
\item If $K^\bullet$ has a projective resolution then
$H^n(K^\bullet) = 0$ for $n \gg 0$.
\item If $H^n(K^\bullet) = 0$ for $n \gg 0$ then there
exists a quasi-isomorphism $L^\bullet \to K^\bullet$
with $L^\bullet$ bounded above.
\end{enumerate}
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-cohomology-bounded-below}.
\end{proof}

\begin{lemma}
\label{lemma-projective-resolutions-exist}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough projectives.
\begin{enumerate}
\item Any object of $\mathcal{A}$ has a projective resolution.
\item If $H^n(K^\bullet) = 0$ for all $n \gg 0$ then
$K^\bullet$ has a projective resolution.
\item If $K^\bullet$ is a complex with $K^n = 0$ for $n > a$, then
there exists a projective resolution $\alpha : P^\bullet \to K^\bullet$
with $P^n = 0$ for $n > a$ such that each $\alpha^n : P^n \to K^n$ is
surjective.
\end{enumerate}
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-injective-resolutions-exist}.
\end{proof}

\begin{lemma}
\label{lemma-projective-into-acyclic-is-zero}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be an acyclic complex.
Let $P^\bullet$ be bounded above and consisting of projective objects.
Any morphism $P^\bullet \to K^\bullet$ is homotopic to zero.
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-acyclic-is-zero}.
\end{proof}

\begin{remark}
\label{remark-easier-projective}
Let $\mathcal{A}$ be an abelian category.
Suppose that $\alpha : K^\bullet \to L^\bullet$ is a quasi-isomorphism
of complexes. Let $P^\bullet$ be a bounded above complex of projectives.
Then
$$
\Hom_{K(\mathcal{A})}(P^\bullet, K^\bullet)
\longrightarrow
\Hom_{K(\mathcal{A})}(P^\bullet, L^\bullet)
$$
is an isomorphism. This is dual to
Remark \ref{remark-easier-proofs}.
\end{remark}

\begin{lemma}
\label{lemma-morphisms-lift-projective}
Let $\mathcal{A}$ be an abelian category.
Consider a solid diagram
$$
\xymatrix{
K^\bullet & L^\bullet \ar[l]^\alpha \\
P^\bullet \ar[u] \ar@{-->}[ru]_\beta
}
$$
where $P^\bullet$ is bounded above and consists of projective
objects, and $\alpha$ is a quasi-isomorphism.
\begin{enumerate}
\item There exists a map of complexes $\beta$ making the diagram
commute up to homotopy.
\item If $\alpha$ is surjective in every degree
then we can find a $\beta$ which makes the diagram commute.
\end{enumerate}
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-morphisms-lift}.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-equal-up-to-homotopy-projective}
Let $\mathcal{A}$ be an abelian category. Consider a solid diagram
$$
\xymatrix{
K^\bullet & L^\bullet \ar[l]^\alpha \\
P^\bullet \ar[u] \ar@{-->}[ru]_{\beta_i} 
}
$$
where $P^\bullet$ is bounded above and consists of projective
objects, and $\alpha$ is a quasi-isomorphism.
Any two morphisms $\beta_1, \beta_2$ making the diagram commute
up to homotopy are homotopic.
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-morphisms-equal-up-to-homotopy}.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-from-projective-complex}
Let $\mathcal{A}$ be an abelian category.
Let $P^\bullet$ be bounded above complex consisting of projective
objects. Let $L^\bullet \in K(\mathcal{A})$. Then
$$
\Mor_{K(\mathcal{A})}(P^\bullet, L^\bullet)
=
\Mor_{D(\mathcal{A})}(P^\bullet, L^\bullet).
$$
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-morphisms-into-injective-complex}.
\end{proof}

\begin{lemma}
\label{lemma-projective-resolution-ses}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough projectives.
For any short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
of $\text{Comp}^{+}(\mathcal{A})$ there exists a
commutative diagram in $\text{Comp}^{+}(\mathcal{A})$
$$
\xymatrix{
0 \ar[r] &
P_1^\bullet \ar[r] \ar[d] &
P_2^\bullet \ar[r] \ar[d] &
P_3^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
A^\bullet \ar[r] &
B^\bullet \ar[r] &
C^\bullet \ar[r] &
0
}
$$
where the vertical arrows are projective resolutions and
the rows are short exact sequences of complexes.
In fact, given any projective resolution $P^\bullet \to C^\bullet$
we may assume $P_3^\bullet = P^\bullet$.
\end{lemma}

\begin{proof}
Dual to
Lemma \ref{lemma-injective-resolution-ses}.
\end{proof}

\begin{lemma}
\label{lemma-precise-vanishing}
Let $\mathcal{A}$ be an abelian category.
Let $P^\bullet$, $K^\bullet$ be complexes.
Let $n \in \mathbf{Z}$. Assume that
\begin{enumerate}
\item $P^\bullet$ is a bounded complex consisting of projective
objects,
\item $P^i = 0$ for $i < n$, and
\item $H^i(K^\bullet) = 0$ for $i \geq n$.
\end{enumerate}
Then
$\Hom_{K(\mathcal{A})}(P^\bullet, K^\bullet) =
\Hom_{D(\mathcal{A})}(P^\bullet, K^\bullet) = 0$.
\end{lemma}

\begin{proof}
The first equality follows from
Lemma \ref{lemma-morphisms-from-projective-complex}.
Note that there is a distinguished triangle
$$
(\tau_{\leq n - 1}K^\bullet, K^\bullet, \tau_{\geq n}K^\bullet, f, g, h)
$$
because the complex $K^\bullet/\tau_{\leq n - 1}K^\bullet$ is
quasi-isomorphic to $\tau_{\geq n}K^\bullet$. Hence, by
Lemma \ref{lemma-representable-homological}
it suffices to prove
$\Hom_{K(\mathcal{A})}(P^\bullet, \tau_{\leq n - 1}K^\bullet) = 0$ and
$\Hom_{K(\mathcal{A})}(P^\bullet, \tau_{\geq n} K^\bullet) = 0$.
The first vanishing is trivial and the second is
Lemma \ref{lemma-projective-into-acyclic-is-zero}.
\end{proof}

\begin{lemma}
\label{lemma-lift-map}
Let $\mathcal{A}$ be an abelian category.
Let $\beta : P^\bullet \to L^\bullet$ and
$\alpha : E^\bullet \to L^\bullet$ be
maps of complexes. Let $n \in \mathbf{Z}$. Assume
\begin{enumerate}
\item $P^\bullet$ is a bounded complex of projectives and
$P^i = 0$ for $i < n$,
\item $H^i(\alpha)$ is an isomorphism for $i > n$ and surjective
for $i = n$.
\end{enumerate}
Then there exists a map of complexes $\gamma : P^\bullet \to E^\bullet$
such that $\alpha \circ \gamma$ and $\beta$ are homotopic.
\end{lemma}

\begin{proof}
Consider the cone $C^\bullet = C(\alpha)^\bullet$ with map
$i : L^\bullet \to C^\bullet$.
Note that $i \circ \beta$ is zero by
Lemma \ref{lemma-precise-vanishing}.
Hence we can lift $\beta$ to $E^\bullet$ by
Lemma \ref{lemma-representable-homological}.
\end{proof}












\section{Right derived functors and injective resolutions}
\label{section-right-derived-functor}

\noindent
At this point we can use the material above to define the right derived
functors of an additive functor between an abelian category having
enough injectives and a general abelian category.

\begin{lemma}
\label{lemma-injective-acyclic}
Let $\mathcal{A}$ be an abelian category.
Let $I \in \Ob(\mathcal{A})$ be an injective object.
Let $I^\bullet$ be a bounded below complex of injectives in $\mathcal{A}$.
\begin{enumerate}
\item $I^\bullet$ computes $RF$ relative to $\text{Qis}^{+}(\mathcal{A})$
for any exact functor $F : K^{+}(\mathcal{A}) \to \mathcal{D}$
into any triangulated category $\mathcal{D}$.
\item $I$ is right acyclic for any additive functor
$F : \mathcal{A} \to \mathcal{B}$ into any abelian category $\mathcal{B}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (2) is a direct consequences of part (1) and
Definition \ref{definition-derived-functor}.
To prove (1) let $\alpha : I^\bullet \to K^\bullet$ be a quasi-isomorphism
into a complex. By
Lemma \ref{lemma-morphisms-equal-up-to-homotopy}
we see that $\alpha$ has a left inverse. Hence the category
$I^\bullet/\text{Qis}^{+}(\mathcal{A})$ is essentially constant with value
$\text{id} : I^\bullet \to I^\bullet$. Thus also the ind-object
$$
I^\bullet/\text{Qis}^{+}(\mathcal{A}) \longrightarrow \mathcal{D},\quad
(I^\bullet \to K^\bullet) \longmapsto F(K^\bullet)
$$
is essentially constant with value $F(I^\bullet)$. This proves (1), see
Definitions \ref{definition-right-derived-functor-defined} and
\ref{definition-computes}.
\end{proof}

\begin{lemma}
\label{lemma-enough-injectives-right-derived}
Let $\mathcal{A}$ be an abelian category with enough injectives.
\begin{enumerate}
\item For any exact functor $F : K^{+}(\mathcal{A}) \to \mathcal{D}$
into a triangulated category $\mathcal{D}$ the right derived
functor
$$
RF : D^{+}(\mathcal{A}) \longrightarrow \mathcal{D}
$$
is everywhere defined.
\item For any additive functor $F : \mathcal{A} \to \mathcal{B}$ into an
abelian category $\mathcal{B}$ the right derived functor
$$
RF : D^{+}(\mathcal{A}) \longrightarrow D^{+}(\mathcal{B})
$$
is everywhere defined.
\end{enumerate}
\end{lemma}

\begin{proof}
Combine
Lemma \ref{lemma-injective-acyclic}
and
Proposition \ref{proposition-enough-acyclics}
for the second assertion. To see the first assertion combine
Lemma \ref{lemma-injective-resolutions-exist},
Lemma \ref{lemma-injective-acyclic},
Lemma \ref{lemma-existence-computes},
and Equation (\ref{equation-everywhere}).
\end{proof}

\begin{lemma}
\label{lemma-right-derived-properties}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor.
\begin{enumerate}
\item The functor $RF$ is an exact functor
$D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$.
\item The functor $RF$ induces an exact functor
$K^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$.
\item The functor $RF$ induces a $\delta$-functor
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$.
\item The functor $RF$ induces a $\delta$-functor
$\mathcal{A} \to D^{+}(\mathcal{B})$.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma simply reviews some of the results obtained sofar.
Note that by
Lemma \ref{lemma-enough-injectives-right-derived}
$RF$ is everywhere defined. Here are some references:
\begin{enumerate}
\item The derived functor is exact: This boils down to
Lemma \ref{lemma-2-out-of-3-defined}.
\item This is true because $K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
is exact and compositions of exact functors are exact.
\item This is true because
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ is
a $\delta$-functor, see
Lemma \ref{lemma-derived-canonical-delta-functor}.
\item This is true because $\mathcal{A} \to \text{Comp}^{+}(\mathcal{A})$
is exact and precomposing a $\delta$-functor by an exact functor gives
a $\delta$-functor.
\end{enumerate}
\end{proof}

\begin{lemma}
\label{lemma-higher-derived-functors}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Let $F : \mathcal{A} \to \mathcal{B}$ be a left exact functor.
\begin{enumerate}
\item For any short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
of complexes in $\text{Comp}^{+}(\mathcal{A})$ there
is an associated long exact sequence
$$
\ldots \to 
H^i(RF(A^\bullet)) \to
H^i(RF(B^\bullet)) \to
H^i(RF(C^\bullet)) \to
H^{i + 1}(RF(A^\bullet)) \to \ldots
$$
\item The functors $R^iF : \mathcal{A} \to \mathcal{B}$
are zero for $i < 0$. Also $R^0F = F : \mathcal{A} \to \mathcal{B}$.
\item We have $R^iF(I) = 0$ for $i > 0$ and $I$ injective.
\item The sequence $(R^iF, \delta)$ forms a universal $\delta$-functor (see
Homology, Definition \ref{homology-definition-universal-delta-functor})
from $\mathcal{A}$ to $\mathcal{B}$.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma simply reviews some of the results obtained sofar.
Note that by
Lemma \ref{lemma-enough-injectives-right-derived}
$RF$ is everywhere defined. Here are some references:
\begin{enumerate}
\item This follows from
Lemma \ref{lemma-right-derived-properties} part (3)
combined with the long exact cohomology sequence
(\ref{equation-long-exact-cohomology-sequence-D}) for
$D^{+}(\mathcal{B})$.
\item This is
Lemma \ref{lemma-left-exact-higher-derived}.
\item This is the fact that injective objects are acyclic.
\item This is
Lemma \ref{lemma-right-derived-delta-functor}.
\end{enumerate}
\end{proof}






\section{Cartan-Eilenberg resolutions}
\label{section-cartan-eilenberg}

\begin{definition}
\label{definition-cartan-eilenberg}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a bounded below complex.
A {\it Cartan-Eilenberg resolution} of $K^\bullet$
is given by a double complex $I^{\bullet, \bullet}$
and a morphism of complexes $\epsilon : K^\bullet \to I^{\bullet, 0}$
with the following properties:
\begin{enumerate}
\item There exists a $i \ll 0$ such that $I^{p, q} = 0$ for all $p < i$
and all $q$.
\item We have $I^{p, q} = 0$ if $q < 0$.
\item The complex $I^{p, \bullet}$ is an injective resolution of $K^p$.
\item The complex $\text{Ker}(d_1^{p, \bullet})$ is an injective resolution
of $\text{Ker}(d_K^p)$.
\item The complex $\text{Im}(d_1^{p, \bullet})$ is an injective resolution
of $\text{Im}(d_K^p)$.
\item The complex $H^p_{I}(I^{\bullet, \bullet})$ is an injective resolution
of $H^p(K^\bullet)$.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-cartan-eilenberg}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Let $K^\bullet$ be a bounded below complex.
There exists a Cartan-Eilenberg resolution of $K^\bullet$.
\end{lemma}

\begin{proof}
Suppose that $K^p = 0$ for $p < n$. Decompose $K^\bullet$ into
short exact sequences as follows: Set $Z^p = \text{Ker}(d^p)$,
$B^p = \text{Im}(d^{p - 1})$, $H^p = Z^p/B^p$, and consider
$$
\begin{matrix}
0 \to Z^n \to K^n \to B^{n + 1} \to 0 \\
0 \to B^{n + 1} \to Z^{n + 1} \to H^{n + 1} \to 0 \\
0 \to Z^{n + 1} \to K^{n + 1} \to B^{n + 2} \to 0 \\
0 \to B^{n + 2} \to Z^{n + 2} \to H^{n + 2} \to 0 \\
\ldots
\end{matrix}
$$
Set $I^{p, q} = 0$ for $p < n$. Inductively we choose
injective resolutions as follows:
\begin{enumerate}
\item Choose an injective resolution $Z^n \to J_Z^{n, \bullet}$.
\item Using Lemma \ref{lemma-injective-resolution-ses} choose injective
resolutions $K^n \to I^{n, \bullet}$, $B^{n + 1} \to J_B^{n + 1, \bullet}$,
and an exact sequence of complexes
$0 \to J_Z^{n, \bullet} \to I^{n, \bullet} \to J_B^{n + 1, \bullet} \to 0$
compatible with the short exact sequence
$0 \to Z^n \to K^n \to B^{n + 1} \to 0$.
\item Using Lemma \ref{lemma-injective-resolution-ses} choose injective
resolutions $Z^{n + 1} \to J_Z^{n + 1, \bullet}$,
$H^{n + 1} \to J_H^{n + 1, \bullet}$,
and an exact sequence of complexes
$0 \to J_B^{n + 1, \bullet} \to J_Z^{n + 1, \bullet}
\to J_H^{n + 1, \bullet} \to 0$
compatible with the short exact sequence
$0 \to B^{n + 1} \to Z^{n + 1} \to H^{n + 1} \to 0$.
\item Etc.
\end{enumerate}
Taking as maps $d_1^\bullet : I^{p, \bullet} \to I^{p + 1, \bullet}$
the compositions
$I^{p, \bullet} \to J_B^{p + 1, \bullet} \to
J_Z^{p + 1, \bullet} \to I^{p + 1, \bullet}$ everything is clear.
\end{proof}

\begin{lemma}
\label{lemma-two-ss-complex-functor}
Let $F : \mathcal{A} \to \mathcal{B}$ be a left exact functor of
abelian categories.
Let $K^\bullet$ be a bounded below complex of $\mathcal{A}$.
Let $I^{\bullet, \bullet}$ be a Cartan-Eilenberg resolution
for $K^\bullet$. The spectral sequences
$({}'E_r, {}'d_r)_{r \geq 0}$ and $({}''E_r, {}''d_r)_{r \geq 0}$
associated to the double complex $F(I^{\bullet, \bullet})$
satisfy the relations
$$
{}'E_2^{p, q} = H^p(R^qF(K^\bullet))\footnote{This notation sucks!
It really means the $p$th cohomology group of the complex with
terms $R^qF(K^n)$. Not the $p$th cohomology of the $q$th derived
functor of $F$ applied to $K^\bullet$...}
\quad
\text{and}
\quad
{}''E_2^{p, q} = R^pF(H^q(K^\bullet))
$$
Moreover, these spectral sequences converge to $H^{p + q}(RF(K^\bullet))$
and the associated induced filtrations on
$H^{p + q}(RF(K^\bullet))$ are finite.
\end{lemma}

\begin{proof}
We will use the following remarks without further mention:
\begin{enumerate}
\item As $I^{p, \bullet}$ is an injective resolution of
$K^p$ we see that $RF$ is defined at $K^p[0]$
with value $F(I^{p, \bullet})$.
\item As $H^p_{I}(I^{\bullet, \bullet})$ is an injective resolution of
$H^p(K^\bullet)$ the derived functor $RF$ is defined at $H^p(K^\bullet)[0]$
with value $F(H^p_{I}(I^{\bullet, \bullet}))$.
\item By
Homology, Lemma \ref{homology-lemma-double-complex-gives-resolution}
the total complex $sI^\bullet$ is an injective resolution of
$K^\bullet$. Hence $RF$ is defined at $K^\bullet$ with value
$F(sI^\bullet)$.
\end{enumerate}
Consider the spectral sequences associated to
the double complex $K^{\bullet, \bullet} = F(I^{\bullet, \bullet})$, see
Homology, Lemma \ref{homology-lemma-ss-double-complex}.
These both converge, see
Homology, Lemma \ref{homology-lemma-first-quadrant-ss},
to the cohomology groups of the associated total complex
$s(F(I^{\bullet, \bullet}) = F(sI^\bullet)$ which computes
$H^n(RF(K^\bullet))$.

\medskip\noindent
Computation of the first spectral sequence. We have
${}'E_1^{p, q} = H^q(K^{p, \bullet})$ in other words
$$
{}'E_1^{p, q} = H^q(F(I^{p, \bullet})) = R^qF(K^p)
$$
and the maps ${}'E_1^{p, q} \to {}'E^{p + 1, q}$ are the maps
$R^qF(K^p) \to R^qF(K^{p + 1})$ as desired.

\medskip\noindent
Computation of the second spectral sequence. We have
${}''E_1^{p, q} = H^q(K^{\bullet, p}) = H^q(F(I^{\bullet, p}))$.
Note that the complex $I^{\bullet, p}$ is bounded below,
consists of injectives, and moreover each kernel, image, and
cohomology group of the differentials is an injective object
of $\mathcal{A}$. Hence we can split the differentials, i.e.,
each differential is a split surjection onto a direct summand.
It follows that the same is true after applying $F$. Hence
${}''E_1^{p, q} = F(H^q(I^{\bullet, p})) = F(H^q_I(I^{\bullet, p}))$.
The differentials on this are $(-1)^q$ times $F$ applied to
the differential of the complex $H^p_{I}(I^{\bullet, \bullet})$
which is an injective resolution of $H^p(K^\bullet)$. Hence the
description of the $E_2$ terms.
\end{proof}

\begin{remark}
\label{remark-functorial-ss}
The spectral sequences of Lemma \ref{lemma-two-ss-complex-functor}
are functorial in the complex $K^\bullet$. This follows from functoriality
properties of Cartan-Eilenberg resolutions. On the other hand, they are
both examples of a more general spectral sequence which may be associated
to a filtered complex of $\mathcal{A}$. The functoriality will follow from
its construction. We will return to this in the section on the filtered
derived category, see Remark \ref{remark-final-functorial}.
\end{remark}










\section{Composition of right derived functors}
\label{section-composition-right-derived-functors}

\noindent
Sometimes we can compute the right derived functor of a composition.
Suppose that $\mathcal{A}, \mathcal{B}, \mathcal{C}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$ and $G : \mathcal{B} \to \mathcal{C}$
be left exact functors. Assume that the right derived functors
$RF : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$,
$RG : D^{+}(\mathcal{B}) \to D^{+}(\mathcal{C})$, and
$R(G \circ F) : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{C})$
are everywhere defined. Then there exists a canonical transformation
$$
t : R(G \circ F) \longrightarrow RG \circ RF,
$$
see
Lemma \ref{lemma-compose-derived-functors-general}.
This transformation need not always be an isomorphism.

\begin{lemma}
\label{lemma-compose-derived-functors}
Let $\mathcal{A}, \mathcal{B}, \mathcal{C}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$
and $G : \mathcal{B} \to \mathcal{C}$ be left exact functors.
Assume $\mathcal{A}$, $\mathcal{B}$ have enough injectives.
If $F(I)$ is right acyclic for $G$ for each injective object $I$
of $\mathcal{A}$, then we have an isomorphism of functors
$$
t : R(G \circ F) \longrightarrow RG \circ RF.
$$
\end{lemma}

\begin{proof}
Let $A^\bullet$ be a bounded below complex of $\mathcal{A}$.
Choose an injective resolution $A^\bullet \to I^\bullet$.
The map $t$ is given (see proof of
Lemma \ref{lemma-compose-derived-functors-general})
by the maps
$$
R(G \circ F)(A^\bullet) =
(G \circ F)(I^\bullet) =
G(F(I^\bullet))) \to
RG(F(I^\bullet)) =
RG(RF(A^\bullet))
$$
where the arrow is an isomorphism by
Lemma \ref{lemma-leray-acyclicity}.
\end{proof}

\begin{lemma}
\label{lemma-grothendieck-spectral-sequence}
(Grothendieck spectral sequence.)
With assumptions as in Lemma \ref{lemma-compose-derived-functors}.
Let $A$ be an object of $\mathcal{A}$.
There exists a spectral sequence $(E_r^{p, q}, d_r^{p, q})_{r \geq 0}$
associated to a filtered complex with
$$
E_2^{p, q} = R^pG(R^qF(A))
$$
converging to $R^{p + q}(G \circ F)(A)$. Moreover, the induced filtration
on each $R^n(G \circ F)(A)$ is finite.
\end{lemma}

\begin{proof}
Choose an injective resolution $A \to I^\bullet$.
Choose a Cartan-Eilenberg resolution
$F(I^\bullet) \to I^{\bullet, \bullet}$
using
Lemma \ref{lemma-cartan-eilenberg}.
Apply
Lemma \ref{lemma-two-ss-complex-functor}
(use the second spectral sequence).
Details omitted.
\end{proof}






\section{Resolution functors}
\label{section-derived-category}

\noindent
Let $\mathcal{A}$ be an abelian category with enough injectives.
Denote $\mathcal{I}$ the full additive subcategory of $\mathcal{A}$ whose
objects are the injective objects of $\mathcal{A}$.
It turns out that $K^{+}(\mathcal{I})$ and $D^{+}(\mathcal{A})$
are equivalent in this case (see
Proposition \ref{proposition-derived-category}).
For many purposes it therefore makes sense to think of
$D^{+}(\mathcal{A})$ as the (easier to grok) category $K^{+}(\mathcal{I})$
in this case.

\begin{proposition}
\label{proposition-derived-category}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
Denote $\mathcal{I} \subset \mathcal{A}$ the strictly full
additive subcategory whose objects are the injective objects of
$\mathcal{A}$.
The functor
$$
K^{+}(\mathcal{I}) \longrightarrow D^{+}(\mathcal{A})
$$
is exact, fully faithful and essentially surjective, i.e.,
an equivalence of triangulated categories.
\end{proposition}

\begin{proof}
It is clear that the functor is exact.
It is essentially surjective by
Lemma \ref{lemma-injective-resolutions-exist}.
Fully faithfulness is a consequence of
Lemma \ref{lemma-morphisms-into-injective-complex}.
\end{proof}

\noindent
Proposition \ref{proposition-derived-category}
implies that we can find resolution functors.
It turns out that we can prove resolution functors exist
even in some cases where the abelian category $\mathcal{A}$ is
a ``big'' category, i.e., has a class of objects.

\begin{definition}
\label{definition-localization-functor}
Let $\mathcal{A}$ be an abelian category with enough injectives.
A {\it resolution functor}\footnote{This is likely nonstandard terminology.}
for $\mathcal{A}$ is given by the following data:
\begin{enumerate}
\item for all $K^\bullet \in \Ob(K^{+}(\mathcal{A}))$ a
bounded below complex of injectives $j(K^\bullet)$, and
\item for all $K^\bullet \in \Ob(K^{+}(\mathcal{A}))$ a
quasi-isomorphism $i_{K^\bullet} : K^\bullet \to j(K^\bullet)$.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-resolution-functor}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Given a resolution functor $(j, i)$ there is a unique way to
turn $j$ into a functor and $i$ into a $2$-isomorphism
producing a $2$-commutative diagram
$$
\xymatrix{
K^{+}(\mathcal{A}) \ar[rd] \ar[rr]_j & & K^{+}(\mathcal{I}) \ar[ld] \\
& D^{+}(\mathcal{A})
}
$$
where $\mathcal{I}$ is the full additive subcategory of $\mathcal{A}$
consisting of injective objects.
\end{lemma}

\begin{proof}
For every morphism $\alpha : K^\bullet \to L^\bullet$ of $K^{+}(\mathcal{A})$
there is a unique morphism
$j(\alpha) : j(K^\bullet) \to j(L^\bullet)$ in $K^{+}(\mathcal{I})$
such that
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_{i_{K^\bullet}} &
L^\bullet \ar[d]^{i_{L^\bullet}} \\
j(K^\bullet) \ar[r]^{j(\alpha)} & j(L^\bullet)
}
$$
is commutative in $K^{+}(\mathcal{A})$. To see this either use
Lemmas \ref{lemma-morphisms-lift} and
\ref{lemma-morphisms-equal-up-to-homotopy}
or the equivalent
Lemma \ref{lemma-morphisms-into-injective-complex}.
The uniqueness implies that $j$ is a functor, and the commutativity of
the diagram implies that $i$ gives a $2$-morphism which witnesses the
$2$-commutativity of the diagram of categories in the statement of
the lemma.
\end{proof}

\begin{lemma}
\label{lemma-into-derived-category}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
Then a resolution functor $j$ exists and is 
unique up to unique isomorphism of functors.
\end{lemma}

\begin{proof}
Consider the set of all objects $K^\bullet$ of $K^{+}(\mathcal{A})$.
(Recall that by our conventions any category has a set of
objects unless mentioned otherwise.)
By Lemma \ref{lemma-injective-resolutions-exist} every object
has an injective resolution.
By the axiom of choice we can choose for each $K^\bullet$
an injective resolution $i_{K^\bullet} : K^\bullet \to j(K^\bullet)$.
\end{proof}

\begin{lemma}
\label{lemma-j-is-exact}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Any resolution functor
$j : K^{+}(\mathcal{A}) \to K^{+}(\mathcal{I})$
is exact.
\end{lemma}

\begin{proof}
Denote $i_{K^\bullet} : K^\bullet \to j(K^\bullet)$ the
canonical maps of Definition \ref{definition-localization-functor}.
First we discuss the existence of the functorial isomorphism
$j(K^\bullet[1]) \to j(K^\bullet)[1]$.
Consider the diagram
$$
\xymatrix{
K^\bullet[1] \ar[d]^{i_{K^\bullet[1]}} \ar@{=}[rr] & &
K^\bullet[1] \ar[d]^{i_{K^\bullet}[1]} \\
j(K^\bullet[1]) \ar@{..>}[rr]^{\xi_{K^\bullet}} & & j(K^\bullet)[1]
}
$$
By Lemmas \ref{lemma-morphisms-lift}
and \ref{lemma-morphisms-equal-up-to-homotopy}
there exists a unique dotted arrow $\xi_{K^\bullet}$ in $K^{+}(\mathcal{I})$
making the diagram commute in $K^{+}(\mathcal{A})$.
We omit the verification that this gives a functorial isomorphism.
(Hint: use Lemma \ref{lemma-morphisms-equal-up-to-homotopy} again.)

\medskip\noindent
Let $(K^\bullet, L^\bullet, M^\bullet, f, g, h)$
be a distinguished triangle of $K^{+}(\mathcal{A})$.
We have to show that
$(j(K^\bullet), j(L^\bullet), j(M^\bullet), j(f), j(g),
\xi_{K^\bullet} \circ j(h))$ is
a distinguished triangle of $K^{+}(\mathcal{I})$.
Note that we have a commutative diagram
$$
\xymatrix{
K^\bullet \ar[r]_f \ar[d] &
L^\bullet \ar[r]_g \ar[d] &
M^\bullet \ar[rr]_h \ar[d] & &
K^\bullet[1] \ar[d] \\
j(K^\bullet) \ar[r]^{j(f)} &
j(L^\bullet) \ar[r]^{j(g)} &
j(M^\bullet) \ar[rr]^{\xi_{K^\bullet} \circ j(h)} & &
j(K^\bullet)[1]
}
$$
in $K^{+}(\mathcal{A})$ whose vertical arrows are the quasi-isomorphisms
$i_K, i_L, i_M$. Hence we see that the image of
$(j(K^\bullet), j(L^\bullet), j(M^\bullet), j(f), j(g),
\xi_{K^\bullet} \circ j(h))$
in $D^{+}(\mathcal{A})$ is isomorphic to a distinguished triangle
and hence a distinguished triangle by TR1. Thus we see from
Lemma \ref{lemma-exact-equivalence}
that $(j(K^\bullet), j(L^\bullet), j(M^\bullet), j(f), j(g),
\xi_{K^\bullet} \circ j(h))$ is a distinguished triangle in
$K^{+}(\mathcal{I})$.
\end{proof}

\begin{lemma}
\label{lemma-resolution-functor-quasi-inverse}
Let $\mathcal{A}$ be an abelian category which has enough injectives.
Let $j$ be a resolution functor. Write
$Q : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ for the natural functor.
Then $j = j' \circ Q$ for a unique
functor $j' : D^{+}(\mathcal{A}) \to K^{+}(\mathcal{I})$ which
is quasi-inverse to the canonical functor
$K^{+}(\mathcal{I}) \to D^{+}(\mathcal{A})$.
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-bounded-derived}
$Q$ is a localization functor.
To prove the existence of $j'$ it suffices to show that any element of
$\text{Qis}^{+}(\mathcal{A})$ is mapped to an isomorphism under
the functor $j$, see
Lemma \ref{lemma-universal-property-localization}.
This is true by the remarks following
Definition \ref{definition-localization-functor}.
\end{proof}

\begin{remark}
\label{remark-big-localization}
Suppose that $\mathcal{A}$ is a ``big'' abelian category with enough injectives
such as the category of abelian groups. In this case we have to be slightly
more careful in constructing our resolution functor since we cannot use
the axiom of choice with a quantifier ranging over a class. But note that
the proof of the lemma does show that any two localization functors are
canonically isomorphic. Namely, given quasi-isomorphisms
$i : K^\bullet \to I^\bullet$ and $i' : K^\bullet \to J^\bullet$ of
a bounded below complex $K^\bullet$ into bounded below complexes of injectives
there exists a unique(!) morphism $a : I^\bullet \to J^\bullet$
in $K^{+}(\mathcal{I})$ such that $i' = i \circ a$ as morphisms in
$K^{+}(\mathcal{I})$. Hence the only issue is existence, and we will see how
to deal with this in the next section.
\end{remark}










\section{Functorial injective embeddings and resolution functors}
\label{section-functorial-injective-resolutions}

\noindent
In this section we redo the construction of a resolution functor
$K^{+}(\mathcal{A}) \to K^{+}(\mathcal{I})$ in case the
category $\mathcal{A}$ has functorial injective embeddings.
There are two reasons for this: (1) the proof is easier and (2)
the construction also works if $\mathcal{A}$ is a ``big'' abelian
category. See
Remark \ref{remark-big-abelian-category}
below.

\medskip\noindent
Let $\mathcal{A}$ be an abelian category. As before denote $\mathcal{I}$
the additive full subcategory of $\mathcal{A}$ consisting of injective
objects. Consider the category $\text{InjRes}(\mathcal{A})$
of arrows $\alpha : K^\bullet \to I^\bullet$
where $K^\bullet$ is a bounded below complex of $\mathcal{A}$,
$I^\bullet$ is a bounded below complex of injectives of $\mathcal{A}$
and $\alpha$ is a quasi-isomorphism. In other words, $\alpha$ is
an injective resolution and $K^\bullet$ is bounded below.
There is an obvious functor
$$
s : \text{InjRes}(\mathcal{A}) \longrightarrow \text{Comp}^{+}(\mathcal{A})
$$
defined by $(\alpha : K^\bullet \to I^\bullet) \mapsto K^\bullet$.
There is also a functor
$$
t : \text{InjRes}(\mathcal{A}) \longrightarrow K^{+}(\mathcal{I})
$$
defined by $(\alpha : K^\bullet \to I^\bullet) \mapsto I^\bullet$.

\begin{lemma}
\label{lemma-functorial-injective-resolutions}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has functorial injective embeddings, see
Homology, Definition \ref{homology-definition-functorial-injective-embedding}.
\begin{enumerate}
\item There exists a functor
$inj : \text{Comp}^{+}(\mathcal{A}) \to \text{InjRes}(\mathcal{A})$
such that $s \circ inj = \text{id}$.
\item For any functor
$inj : \text{Comp}^{+}(\mathcal{A}) \to \text{InjRes}(\mathcal{A})$
such that $s \circ inj = \text{id}$ we obtain a resolution functor, see
Definition \ref{definition-localization-functor}.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $A \mapsto (A \to J(A))$ be a functorial injective embedding, see
Homology, Definition \ref{homology-definition-functorial-injective-embedding}.
We first note that we may assume $J(0) = 0$. Namely, if not then
for any object $A$ we have $0 \to A \to 0$ which gives
a direct sum decomposition $J(A) = J(0) \oplus \text{Ker}(J(A) \to J(0))$.
Note that the functorial morphism $A \to J(A)$ has to map
into the second summand. Hence we can replace our functor
by $J'(A) = \text{Ker}(J(A) \to J(0))$ if needed.

\medskip\noindent
Let $K^\bullet$ be a bounded below complex of $\mathcal{A}$.
Say $K^p = 0$ if $p < B$.
We are going to construct a double complex $I^{\bullet, \bullet}$
of injectives, together with a map $\alpha : K^\bullet \to I^{\bullet, 0}$
such that $\alpha$ induces a quasi-isomorphism of $K^\bullet$
with the associated total complex of $I^{\bullet, \bullet}$.
First we set $I^{p, q} = 0$ whenever $q < 0$.
Next, we set $I^{p, 0} = J(K^p)$ and $\alpha^p : K^p \to I^{p, 0}$
the functorial embedding. Since $J$ is a functor we see that
$I^{\bullet, 0}$ is a complex and that $\alpha$ is a
morphism of complexes. Each $\alpha^p$ is injective. And
$I^{p, 0} = 0$ for $p < B$ because $J(0) = 0$. Next, we set
$I^{p, 1} = J(\text{Coker}(K^p \to I^{p, 0}))$. Again by functoriality
we see that $I^{\bullet, 1}$ is a complex. And again we get
that $I^{p, 1} = 0$ for $p < B$. It is also clear that
$K^p$ maps isomorphically onto $\text{Ker}(I^{p, 0} \to I^{p, 1})$.
As our third step we take $I^{p, 2} = J(\text{Coker}(I^{p, 0} \to I^{p, 1}))$.
And so on and so forth.

\medskip\noindent
At this point we can apply
Homology, Lemma \ref{homology-lemma-double-complex-gives-resolution}
to get that the map
$$
\alpha : K^\bullet \to sI^\bullet
$$
is a quasi-isomorphism. To prove we get a functor $inj$ it
rests to show that the construction above
is functorial. This verification is omitted.

\medskip\noindent
Suppose we have a functor $inj$ such that $s \circ inj = \text{id}$.
For every object $K^\bullet$ of $\text{Comp}^{+}(\mathcal{A})$
we can write
$$
inj(K^\bullet) = (i_{K^\bullet} : K^\bullet \to j(K^\bullet))
$$
This provides us with a resolution functor as in
Definition \ref{definition-localization-functor}.
\end{proof}

\begin{remark}
\label{remark-match}
Suppose $inj$ is a functor such that $s \circ inj = \text{id}$
as in part (2) of
Lemma \ref{lemma-functorial-injective-resolutions}.
Write $inj(K^\bullet) = (i_{K^\bullet} : K^\bullet \to j(K^\bullet))$
as in the proof of that lemma.
Suppose $\alpha : K^\bullet \to L^\bullet$ is a map
of bounded below complexes. Consider the map
$inj(\alpha)$ in the category $\text{InjRes}(\mathcal{A})$.
It induces a commutative diagram
$$
\xymatrix{
K^\bullet
\ar[rr]^-{\alpha}
\ar[d]_{i_K} & &
L^\bullet \ar[d]^{i_L} \\
j(K)^\bullet
\ar[rr]^-{inj(\alpha)}
& &
j(L)^\bullet
}
$$
of morphisms of complexes.
Hence, looking at the proof of
Lemma \ref{lemma-resolution-functor}
we see that the functor $j : K^{+}(\mathcal{A}) \to K^{+}(\mathcal{I})$
is given by the rule
$$
j(\alpha\text{ up to homotopy}) = inj(\alpha)\text{ up to homotpy}\in
\Hom_{K^{+}(\mathcal{I})}(j(K^\bullet), j(L^\bullet))
$$
Hence we see that $j$ matches $t \circ inj$ in this case, i.e., the
diagram
$$
\xymatrix{
\text{Comp}^{+}(\mathcal{A}) \ar[rr]_{t \circ inj} \ar[rd] & &
K^{+}(\mathcal{I}) \\
& K^{+}(\mathcal{A}) \ar[ru]_j
}
$$
is commutative.
\end{remark}

\begin{remark}
\label{remark-big-abelian-category}
Let $\textit{Mod}(\mathcal{O}_X)$ be the category of $\mathcal{O}_X$-modules
on a ringed space $(X, \mathcal{O}_X)$ (or more generally on a
ringed site). We will see later that $\textit{Mod}(\mathcal{O}_X)$ has enough
injectives and in fact functorial injective embeddings, see
Injectives, Theorem \ref{injectives-theorem-sheaves-modules-injectives}.
Note that the proof of Lemma \ref{lemma-into-derived-category} does
not apply to $\textit{Mod}(\mathcal{O}_X)$. But the proof of
Lemma \ref{lemma-functorial-injective-resolutions} does apply
to $\textit{Mod}(\mathcal{O}_X)$. Thus we obtain
$$
j : K^{+}(\textit{Mod}(\mathcal{O}_X))
\longrightarrow
K^{+}(\mathcal{I})
$$
which is a resolution functor where $\mathcal{I}$ is the additive
category of injective $\mathcal{O}_X$-modules. This argument also
works in the following cases:
\begin{enumerate}
\item The category $\text{Mod}_R$ of $R$-modules over a ring $R$.
\item The category $\textit{PMod}(\mathcal{O})$ of presheaves of
$\mathcal{O}$-modules on a site endowed with a presheaf of rings.
\item The category $\textit{Mod}(\mathcal{O})$ of sheaves of
$\mathcal{O}$-modules on a ringed site.
\item Add more here as needed.
\end{enumerate}
\end{remark}









\section{Right derived functors via resolution functors}
\label{section-right-derived-functor-via-resolutions}

\noindent
The content of the following lemma is that we can simply define
$RF(K^\bullet) = F(j(K^\bullet)$ if we are given a resolution functor $j$.

\begin{lemma}
\label{lemma-right-derived-functor}
Let $\mathcal{A}$ be an abelian category with enough injectives
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor into
an abelian category. Let $(i, j)$ be a resolution functor, see
Definition \ref{definition-localization-functor}.
The right derived functor $RF$ of $F$ fits into the following
$2$-commutative diagram
$$
\xymatrix{
D^{+}(\mathcal{A}) \ar[rd]_{RF} \ar[rr]^{j'} & &
K^{+}(\mathcal{I}) \ar[ld]^F \\
& D^{+}(\mathcal{B})
}
$$
where $j'$ is the functor from
Lemma \ref{lemma-resolution-functor-quasi-inverse}.
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-injective-acyclic}
we have $RF(K^\bullet) = F(j(K^\bullet))$.
\end{proof}

\begin{remark}
\label{remark-right-derived-functor}
In the situation of
Lemma \ref{lemma-right-derived-functor}
we see that we have actually lifted the right derived
functor to an exact functor
$F \circ j' : D^{+}(\mathcal{A}) \to K^{+}(\mathcal{B})$.
It is occasionally useful to use such a factorization.
\end{remark}








\section{Filtered derived category and injective resolutions}
\label{section-filtered-derived}

\noindent
If the underlying abelian category $\mathcal{A}$ has enough injectives
then the category $\text{Fil}^f(\mathcal{A})$ has enough right
acyclic objects relative to any left exact functor.

\begin{definition}
\label{definition-filtered-complexes-notation}
Let $\mathcal{A}$ be an abelian category.
We say an object $I$ of $\text{Fil}^f(\mathcal{A})$
is {\it filtered injective} if each $\text{gr}^p(I)$ is
an injective object of $\mathcal{A}$.
\end{definition}

\noindent
This category is an example of an exact category, see
Injectives, Remark \ref{injectives-remark-embed-exact-category}.
A special role is played by the strict morphisms, see
Homology, Definition \ref{homology-definition-strict},
i.e., the morphisms $f$ such that $\text{Coim}(f) = \text{Im}(f)$.
We will say that a complex $A \to B \to C$ in $\text{Fil}^f(\mathcal{A})$ is
{\it exact} if the sequence $\text{gr}(A) \to \text{gr}(B) \to \text{gr}(C)$
is exact in $\mathcal{A}$. This implies that $A \to B$ and $B \to C$
are strict morphisms, see
Homology, Lemma \ref{homology-lemma-filtered-acyclic}.

\begin{lemma}
\label{lemma-filtered-injective}
Let $\mathcal{A}$ be an abelian category.
An object $I$ of $\text{Fil}^f(\mathcal{A})$ is filtered injective
if and only if
there exist $a \leq b$, injective objects $I_n$, $a \leq n \leq b$
of $\mathcal{A}$ and an isomorphism $I \cong \bigoplus_{a \leq n \leq b} I_n$
such that $F^pI = \bigoplus_{n \geq p} I_n$.
\end{lemma}

\begin{proof}
Follows from the fact that any injection $J \to M$ of $\mathcal{A}$
is split if $J$ is an injective object. Details omitted.
\end{proof}

\begin{lemma}
\label{lemma-split-strict-monomorphism}
Let $\mathcal{A}$ be an abelian category.
Any strict monomorphism $u : I \to A$ of $\text{Fil}^f(\mathcal{A})$
where $I$ is a filtered injective object is a split injection.
\end{lemma}

\begin{proof}
Let $p$ be the largest integer such that $F^pI \not = 0$.
In particular $\text{gr}^p(I) = F^pI$.
Let $I'$ be the object of $\text{Fil}^f(\mathcal{A})$ whose
underlying object of $\mathcal{A}$ is $F^pI$ and with filtration
given by $F^nI' = 0$ for $n > p$ and $F^nI' = I' = F^pI$ for
$n \leq p$. Note that $I' \to I$ is a strict monomorphism too.
The fact that $u$ is a strict monomorphism implies that
$F^pI \to A/F^{p + 1}(A)$ is injective, see
Homology, Lemma \ref{homology-lemma-characterize-strict}.
Choose a splitting $s : A/F^{p + 1}A \to F^pI$ in $\mathcal{A}$.
The induced morphism $s' : A \to I'$ is a strict morphism of
filtered objects splitting the composition $I' \to I \to A$.
Hence we can write $A = I' \oplus \text{Ker}(s')$ and
$I = I' \oplus \text{Ker}(s'|_I)$. Note that
$\text{ker}(s'|_I) \to \text{ker}(s')$ is a strict monomorphism
and that $\text{ker}(s'|_I)$ is a filtered injective object.
By induction on the length of the filtration on $I$ the map
$\text{ker}(s'|_I) \to \text{ker}(s')$ is a split injection.
Thus we win.
\end{proof}

\begin{lemma}
\label{lemma-injective-property-filtered-injective}
Let $\mathcal{A}$ be an abelian category. 
Let $u : A \to B$ be a strict monomorphism
of $\text{Fil}^f(\mathcal{A})$
and $f : A \to I$ a morphism from $A$ into a filtered injective object
in $\text{Fil}^f(\mathcal{A})$.
Then there exists a morphism $g : B \to I$ such that $f = g \circ u$.
\end{lemma}

\begin{proof}
The pushout $f' : I \to I \amalg_A B$ of $f$ by $u$ is a strict
monomorphism, see
Homology, Lemma \ref{homology-lemma-pushout-filtered}.
Hence the result follows formally from
Lemma \ref{lemma-split-strict-monomorphism}.
\end{proof}

\begin{lemma}
\label{lemma-strict-monomorphism-into-filtered-injective}
Let $\mathcal{A}$ be an abelian category with enough injectives.
For any object $A$ of $\text{Fil}^f(\mathcal{A})$ there exists
a strict monomorphism $A \to I$
where $I$ is a filtered injective object.
\end{lemma}

\begin{proof}
Pick $a \leq b$ such that $\text{gr}^p(A) = 0$ unless
$p \in \{a, a + 1, \ldots, b\}$. For each
$n \in \{a, a + 1, \ldots, b\}$ choose an injection
$u_n : A/F^nA \to I_n$ with $I_n$ and injective object.
Set $I = \bigoplus_{a \leq n \leq b} I_p$ with filtration
$F^pI = \bigoplus_{n \geq p} I_n$ and set $u : A \to I$ equal to
the direct sum of the maps $u_n$.
\end{proof}

\begin{lemma}
\label{lemma-filtered-injective-right-resolution-single-object}
Let $\mathcal{A}$ be an abelian category with enough injectives.
For any object $A$ of $\text{Fil}^f(\mathcal{A})$ there exists
a filtered quasi-isomorphism $A[0] \to I^\bullet$
where $I^\bullet$ is a complex of filtered injective objects
with $I^n = 0$ for $n < 0$.
\end{lemma}

\begin{proof}
First choose a strict monomorphism $u_0 : A \to I^0$ of $A$ into a filtered
injective object, see
Lemma \ref{lemma-strict-monomorphism-into-filtered-injective}.
Next, choose a strict monomorphism
$u_1 : \text{Coker}(u_0) \to I^1$ into a filtered injective object of
$\mathcal{A}$. Denote $d^0$ the induced map $I^0 \to I^1$.
Next, choose a strict monomorphism $u_2 : \text{Coker}(u_1) \to I^2$ into
a filtered injective object of $\mathcal{A}$. Denote $d^1$ the induced
map $I^1 \to I^2$. And so on. This works because each
of the sequences
$$
0 \to \text{Coker}(u_n) \to I^{n + 1} \to \text{Coker}(u_{n + 1}) \to 0
$$
is short exact, i.e., induces a short exact sequence on applying
$\text{gr}$. To see this use
Homology, Lemma \ref{homology-lemma-characterize-strict}.
\end{proof}

\begin{lemma}
\label{lemma-filtered-injective-right-resolution-map}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Let $f : A \to B$ be a morphism of $\text{Fil}^f(\mathcal{A})$.
Given filtered quasi-isomorphisms $A[0] \to I^\bullet$ and
$B[0] \to J^\bullet$ where $I^\bullet, J^\bullet$ are complexes of
filtered injective objects with $I^n = J^n = 0$ for $n < 0$, then
there exists a commutative diagram
$$
\xymatrix{
A[0] \ar[r] \ar[d] &
B[0] \ar[d] \\
I^\bullet \ar[r] &
J^\bullet
}
$$
\end{lemma}

\begin{proof}
As $A[0] \to I^\bullet$ and $C[0] \to J^\bullet$ are filtered
quasi-isomorphisms we conclude that $a : A \to I^0$, $b : B \to J^0$
and all the morphisms $d_I^n$, $d_J^n$ are strict, see
Homology, Lemma \ref{lemma-filtered-acyclic}.
We will inductively construct the maps $f^n$ in the following
commutative diagram
$$
\xymatrix{
A \ar[r]_a \ar[d]_f &
I^0 \ar[r] \ar[d]^{f^0} &
I^1 \ar[r] \ar[d]^{f^1} &
I^2 \ar[r] \ar[d]^{f^2} &
\ldots \\
B \ar[r]^b &
J^0 \ar[r] &
J^1 \ar[r] &
J^2 \ar[r] &
\ldots
}
$$
Because $A \to I^0$ is a strict monomorphism and because 
$J^0$ is filtered injective, we can find a morphism $f^0 : I^0 \to J^0$
such that $f^0 \circ a = b \circ f$, see
Lemma \ref{lemma-injective-property-filtered-injective}.
The composition $d_J^0 \circ b \circ f$ is zero, hence
$d_J^0 \circ f^0 \circ a = 0$, hence $d_J^0 \circ f^0$ factors
through a unique morphism
$$
\text{Coker}(a) = \text{Coim}(d_I^0) = \text{Im}(d_I^0) \longrightarrow J^1.
$$
As $\text{Im}(d_I^0) \to I^1$ is a strict monomorphism we can extend the
displayed arrow to a morphism $f^1 : I^1 \to J^1$ by
Lemma \ref{lemma-injective-property-filtered-injective}
again. And so on.
\end{proof}

\begin{lemma}
\label{lemma-filtered-injective-right-resolution-ses}
Let $\mathcal{A}$ be an abelian category with enough injectives.
Let $0 \to A \to B \to C \to 0$ be a short exact sequence in
$\text{Fil}^f(\mathcal{A})$.
Given filtered quasi-isomorphisms $A[0] \to I^\bullet$ and
$C[0] \to J^\bullet$ where $I^\bullet, J^\bullet$ are complexes of
filtered injective objects with $I^n = J^n = 0$ for $n < 0$, then
there exists a commutative diagram
$$
\xymatrix{
0 \ar[r] &
A[0] \ar[r] \ar[d] &
B[0] \ar[r] \ar[d] &
C[0] \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I^\bullet \ar[r] &
M^\bullet \ar[r] &
J^\bullet \ar[r] &
0
}
$$
where the lower row is a termwise split sequence of complexes.
\end{lemma}

\begin{proof}
As $A[0] \to I^\bullet$ and $C[0] \to J^\bullet$ are filtered
quasi-isomorphisms we conclude that $a : A \to I^0$, $c : C \to J^0$
and all the morphisms $d_I^n$, $d_J^n$ are strict, see
Homology, Lemma \ref{lemma-filtered-acyclic}.
We are going to step by step construct the south-east and the south
arrows in the following commutative diagram
$$
\xymatrix{
B \ar[r]_\beta \ar[rd]^b &
C \ar[r]_c \ar[rd]^{\overline{b}} &
J^0 \ar[d]^{\delta^0} \ar[r] &
J^1 \ar[d]^{\delta^1} \ar[r] & \ldots \\
A \ar[u]^\alpha \ar[r]^a &
I^0 \ar[r] &
I^1 \ar[r] &
I^2 \ar[r] & \ldots
}
$$
As $A \to B$ is a strict monomorphism, we can find a morphism
$b : B \to I^0$ such that $b \circ \alpha = a$, see
Lemma \ref{lemma-injective-property-filtered-injective}.
As $A$ is the kernel of the strict morphism $I^0 \to I^1$
and $\beta = \text{Coker}(\alpha)$ we obtain a unique morphism
$\overline{b} : C \to I^1$ fitting into the diagram.
As $c$ is a strict monomorphism and $I^1$ is filtered injective
we can find $\delta^0 : J^0 \to I^1$, see
Lemma \ref{lemma-injective-property-filtered-injective}.
Because $B \to C$ is a strict epimorphism and because
$B \to I^0 \to I^1 \to I^2$ is zero, we see that
$C \to I^1 \to I^2$ is zero. Hence $d_I^1 \circ \delta^0$
is zero on $C \cong \text{Im}(c)$.
Hence $d_I^1 \circ \delta^0$ factors through a unique morphism
$$
\text{Coker}(c) = \text{Coim}(d_J^0) = \text{Im}(d_J^0) \longrightarrow I^2.
$$
As $I^2$ is filtered injective and $\text{Im}(d_J^0) \to J^1$ is a
strict monomorphism we can extend the displayed morphism to a morphism
$\delta^1 : J^1 \to I^2$, see
Lemma \ref{lemma-injective-property-filtered-injective}.
And so on. We set $M^\bullet = I^\bullet \oplus J^\bullet$
with differential
$$
d_M^n =
\left(
\begin{matrix}
d_I^n & (-1)^{n + 1}\delta^n \\
0 & d_J^n
\end{matrix}
\right)
$$
Finally, the map $B[0] \to M^\bullet$ is given by
$b \oplus c \circ \beta : M \to I^0 \oplus J^0$.
\end{proof}

\begin{lemma}
\label{lemma-right-resolution-by-filtered-injectives}
Let $\mathcal{A}$ be an abelian category with enough injectives.
For every $K^\bullet \in K^{+}(\text{Fil}^f(\mathcal{A}))$
there exists a filtered quasi-isomorphism $K^\bullet \to I^\bullet$
with $I^\bullet$ bounded below,
each $I^n$ a filtered injective object, and
each $K^n \to I^n$ a strict monomorphism.
\end{lemma}

\begin{proof}
After replacing $K^\bullet$ by a shift (which is harmless for the proof)
we may assume that $K^n = 0$ for $n < 0$. Consider the
short exact sequences
$$
\begin{matrix}
0 \to \text{ker}(d_K^0) \to K^0 \to \text{Coim}(d_K^0) \to 0 \\
0 \to \text{ker}(d_K^1) \to K^1 \to \text{Coim}(d_K^1) \to 0 \\
0 \to \text{ker}(d_K^2) \to K^2 \to \text{Coim}(d_K^2) \to 0 \\
\ldots
\end{matrix}
$$
of the exact category $\text{Fil}^f(\mathcal{A})$
and the maps $u_i : \text{Coim}(d_K^i) \to \text{Ker}(d_K^{i + 1})$.
For each $i \geq 0$ we may choose filtered quasi-isomorphisms
$$
\begin{matrix}
\text{ker}(d_K^i)[0] \to I_{ker, i}^\bullet \\
\text{Coim}(d_K^i)[0] \to I_{coim, i}^\bullet
\end{matrix}
$$
with $I_{ker, i}^n, I_{coim, i}^n$ filtered injective and zero for $n < 0$, see
Lemma \ref{lemma-filtered-injective-right-resolution-single-object}.
By
Lemma \ref{lemma-filtered-injective-right-resolution-map}
we may lift $u_i$ to a morphism of complexes
$u_i^\bullet : I_{coim, i}^\bullet \to I_{ker, i + 1}^\bullet$.
Finally, for each $i \geq 0$ we may complete the diagrams
$$
\xymatrix{
0 \ar[r] &
\text{ker}(d_K^i)[0] \ar[r] \ar[d] &
K^i[0] \ar[r] \ar[d] &
\text{Coim}(d_K^i)[0] \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I_{ker, i}^\bullet \ar[r]^{\alpha_i} &
I_i^\bullet \ar[r]^{\beta_i} &
I_{coim, i}^\bullet \ar[r] &
0
}
$$
with the lower sequence a termwise split exact sequence, see
Lemma \ref{lemma-filtered-injective-right-resolution-ses}.
For $i \geq 0$ set $d_i : I_i^\bullet \to I_{i + 1}^\bullet$
equal to $d_i =  \alpha_{i + 1} \circ u_i^\bullet \circ \beta_i$.
Note that $d_i \circ d_{i - 1} = 0$ because
$\beta_i \circ \alpha_i = 0$. Hence we have constructed
a commutative diagram
$$
\xymatrix{
I_0^\bullet \ar[r] &
I_1^\bullet \ar[r] &
I_2^\bullet \ar[r] & \ldots \\
K^0[0] \ar[r] \ar[u] &
K^1[0] \ar[r] \ar[u] &
K^2[0] \ar[r] \ar[u] &
\ldots
}
$$
Here the vertical arrows are filtered quasi-isomorphisms.
The upper row is a complex of complexes and each complex consists of
filtered injective objects with no nonzero objects in degree $< 0$.
Thus we obtain a double complex by setting $I^{a, b} = I_a^b$ and using
$$
d_1^{a, b} : I^{a, b} = I_a^b \to I_{a + 1}^b = I^{a + 1, b}
$$
the map $d_a^b$ and using for
$$
d_2^{a, b} : I^{a, b} = I_a^b \to I_a^{b + 1} = I^{a, b + 1}
$$
the map $d_{I_a}^b$. Denote $\text{Tot}(I^{\bullet, \bullet})$
the total complex associated to this double complex, see
Homology, Definition \ref{homology-definition-associated-simple-complex}.
Observe that the maps $K^n[0] \to I_n^\bullet$ come from maps
$K^n \to I^{n, 0}$ which give rise to a map of complexes
$$
K^\bullet \longrightarrow \text{Tot}(I^{\bullet, \bullet})
$$
We claim this is a filtered quasi-isomorphism.
As $\text{gr}(-)$ is an additive functor, we see that
$\text{gr}(\text{Tot}(I^{\bullet, \bullet})) =
\text{Tot}(\text{gr}(I^{\bullet, \bullet}))$.
Thus we can use
Homology,
Lemma \ref{homology-lemma-double-complex-gives-resolution}
to conclude that
$\text{gr}(K^\bullet) \to \text{gr}(\text{Tot}(I^{\bullet, \bullet}))$
is a quasi-isomorphism as desired.
\end{proof}

\begin{lemma}
\label{lemma-filtered-acyclic-is-zero}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet, I^\bullet \in K(\text{Fil}^f(\mathcal{A}))$.
Assume $K^\bullet$ is filtered acyclic and
$I^\bullet$ bounded below and consisting of filtered injective objects.
Any morphism $K^\bullet \to I^\bullet$ is homotopic to zero:
$\Hom_{K(\text{Fil}^f(\mathcal{A}))}(K^\bullet, I^\bullet) = 0$.
\end{lemma}

\begin{proof}
Let $\alpha : K^\bullet \to I^\bullet$ be a morphism of
complexes. Assume that $\alpha^j = 0$ for $j < n$.
We will show that there exists a morphism $h : K^{n + 1} \to I^n$
such that $\alpha^n = h \circ d$. Thus $\alpha$ will be homotopic
to the morphism of complexes $\beta$ defined by
$$
\beta^j =
\left\{
\begin{matrix}
0 & \text{if} & j \leq n \\
\alpha^{n + 1} - d \circ h & \text{if} & j = n + 1 \\
\alpha^j & \text{if} & j > n + 1
\end{matrix}
\right.
$$
This will clearly prove the lemma (by induction).
To prove the existence of $h$ note that
$\alpha^n \circ d_K^{n - 1} = 0$ since
$\alpha^{n - 1} = 0$. Since $K^\bullet$ is filtered acyclic
we see that $d_K^{n - 1}$ and $d_K^n$ are strict and that
$$
0 \to \text{Im}(d_K^{n - 1}) \to K^n \to \text{Im}(d_K^n) \to 0
$$
is an exact sequence of the exact category $\text{Fil}^f(\mathcal{A})$, see
Homology, Lemma \ref{homology-lemma-filtered-acyclic}.
Hence we can think of $\alpha^n$ as a map into $I^n$ defined
on $\text{Im}(d_K^n)$.
Using that $\text{Im}(d_K^n) \to K^{n + 1}$ is a strict monomorphism
and that $I^n$ is filtered injective we may lift this map to a map
$h : K^{n + 1} \to I^n$ as desired, see
Lemma \ref{lemma-injective-property-filtered-injective}.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-into-filtered-injective-complex}
Let $\mathcal{A}$ be an abelian category.
Let $I^\bullet \in K(\text{Fil}^f(\mathcal{A}))$
be a bounded below complex consisting of
filtered injective objects.
\begin{enumerate}
\item Let $\alpha : K^\bullet \to L^\bullet$ in $K(\text{Fil}^f(\mathcal{A}))$
be a filtered quasi-isomorphism.
Then the map
$$
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(L^\bullet, I^\bullet)
\to
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(K^\bullet, I^\bullet)
$$
is bijective.
\item Let $L^\bullet \in K(\mathcal{A})$. Then
$$
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(L^\bullet, I^\bullet)
=
\Hom_{DF(\mathcal{A})}(L^\bullet, I^\bullet).
$$
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). Note that
$$
(K^\bullet, L^\bullet, C(\alpha)^\bullet, \alpha, i, -p)
$$
is a distinguished triangle in $K(\text{Fil}^f(\mathcal{A}))$
(Lemma \ref{lemma-the-same-up-to-isomorphisms})
and $C(f)^\bullet$ is a filtered acyclic complex
(Lemma \ref{lemma-filtered-acyclic}).
Then
$$
\xymatrix{
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(C(\alpha)^\bullet, I^\bullet) \ar[r] &
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(L^\bullet, I^\bullet) \ar[r] &
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(K^\bullet, I^\bullet) \ar[lld] \\
\Hom_{K(\text{Fil}^f(\mathcal{A}))}(C(\alpha)^\bullet[-1], I^\bullet)
}
$$
is an exact sequence of abelian groups, see
Lemma \ref{lemma-representable-homological}.
At this point
Lemma \ref{lemma-filtered-acyclic-is-zero}
guarantees that the outer two groups are zero and hence
$\Hom_{K(\mathcal{A})}(L^\bullet, I^\bullet) =
\Hom_{K(\mathcal{A})}(K^\bullet, I^\bullet)$.

\medskip\noindent
Proof of (2).
Let $a$ be an element of the right hand side.
We may represent $a = \gamma\alpha^{-1}$ where
$\alpha : K^\bullet \to L^\bullet$
is a filtered quasi-isomorphism and $\gamma : K^\bullet \to I^\bullet$
is a map of complexes. By part (1)
we can find a morphism $\beta : L^\bullet \to I^\bullet$ such that
$\beta \circ \alpha$ is homotopic to $\gamma$. This proves that the
map is surjective. Let $b$ be an element of the left hand side
which maps to zero in the right hand side. Then $b$ is the homotopy class
of a morphism $\beta : L^\bullet \to I^\bullet$ such that there exists a
filtered quasi-iomorphism $\alpha : K^\bullet \to L^\bullet$ with
$\beta  \circ \alpha$ homotopic to zero. Then part (1)
shows that $\beta$ is homotopic to zero also, i.e., $b = 0$.
\end{proof}

\begin{lemma}
\label{lemma-filtered-localization-functor}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{I}^f \subset \text{Fil}^f(\mathcal{A})$
denote the strictly full additive subcategory whose objects are
the filtered injective objects. The canonical functor
$$
K^{+}(\mathcal{I}^f)
\longrightarrow
DF^{+}(\mathcal{A})
$$
is exact, fully faithful and essentially surjective, i.e., an
equivalence of triangulated categories. Furthermore the diagrams
$$
\xymatrix{
K^{+}(\mathcal{I}^f) \ar[d]_{\text{gr}^p} \ar[r] &
DF^{+}(\mathcal{A}) \ar[d]_{\text{gr}^p} \\
K^{+}(\mathcal{I}) \ar[r] &
D^{+}(\mathcal{A})
}
\quad
\xymatrix{
K^{+}(\mathcal{I}^f) \ar[d]^{\text{forget }F} \ar[r] &
DF^{+}(\mathcal{A}) \ar[d]^{\text{forget }F} \\
K^{+}(\mathcal{I}) \ar[r] &
D^{+}(\mathcal{A})
}
$$
are commutative, where $\mathcal{I} \subset \mathcal{A}$ is the
strictly full additive subcategory whose objects are
the injective objects.
\end{lemma}

\begin{proof}
The functor $K^{+}(\mathcal{I}^f) \to DF^{+}(\mathcal{A})$
is essentially surjective by
Lemma \ref{lemma-right-resolution-by-filtered-injectives}.
It is fully faithful by
Lemma \ref{lemma-morphisms-into-filtered-injective-complex}.
It is an exact functor by our definitions regarding distinguished
triangles.
The commutativity of the squares is immediate.
\end{proof}

\begin{remark}
\label{remark-filtered-localization-big}
We can invert the arrow of the lemma
only if $\mathcal{A}$ is a category in our sense,
namely if it has a set of objects. However, suppose given a big abelian
category $\mathcal{A}$ with enough injectives, such as
$\textit{Mod}(\mathcal{O}_X)$ for example. Then for any given set of objects
$\{A_i\}_{i\in I}$ there is an abelian subcategory
$\mathcal{A}' \subset \mathcal{A}$ containing all of them
and having enough injectives, see
Sets, Lemma \ref{sets-lemma-abelian-injectives}.
Thus we may use the lemma above for $\mathcal{A}'$.
This essentially means that if we use a set worth of diagrams, etc 
then we will never run into trouble using the lemma.
\end{remark}

\noindent
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $T : \mathcal{A} \to \mathcal{B}$ be a left exact functor.
(We cannot use the letter $F$ for the functor since this would
conflict too much with our use of the letter $F$ to indicate
filtrations.) Note that $T$ induces an additive functor
$$
T : \text{Fil}^f(\mathcal{A}) \to \text{Fil}^f(\mathcal{B})
$$
by the rule $T(A, F) = (T(A), F)$ where $F^pT(A) = T(F^pA)$ which makes
sense as $T$ is left exact. (Warning: It may not be the case that
$\text{gr}(T(A)) = T(\text{gr}(A))$.)
This induces functors of triangulated categories
\begin{equation}
\label{equation-induced-T-filtered}
T :
K^{+}(\text{Fil}^f(\mathcal{A}))
\longrightarrow
K^{+}(\text{Fil}^f(\mathcal{B}))
\end{equation}
The filtered right derived functor of $T$ are is the right derived functor of
Definition \ref{definition-right-derived-functor-defined}
for this exact functor composed with the exact functor
$K^{+}(\text{Fil}^f(\mathcal{B})) \to DF^{+}(\mathcal{B})$ and the
multiplicative set $\text{FQis}^{+}(\mathcal{A})$.
Assume $\mathcal{A}$ has enough injectives. At this point we can redo the
discussion of 
Section \ref{section-right-derived-functor}
to define the
{\it filtered right derived functors}
\begin{equation}
\label{equation-filtered-derived-functor}
RT : DF^{+}(\mathcal{A}) \longrightarrow DF^{+}(\mathcal{B})
\end{equation}
of our functor $T$.

\medskip\noindent
However, instead we will proceed as in
Section \ref{section-right-derived-functor-via-resolutions},
and it will turn out that we can define $RT$ even if $T$ is just additive.
Namely, we first choose a quasi-inverse
$j' : DF^{+}(\mathcal{A}) \to K^{+}(\mathcal{I}^f)$ of the
equivalence of
Lemma \ref{lemma-filtered-localization-functor}.
By
Lemma \ref{lemma-exact-equivalence}
we see that $j'$ is an exact functor of triangulated categories.
Next, we note that for a filtered injective object $I$ we have
a (noncanonical) decomposition
\begin{equation}
\label{equation-decompose}
I \cong \bigoplus\nolimits_{p \in \mathbf{Z}} I_p,
\quad\text{with}\quad
F^pI = \bigoplus\nolimits_{q \geq p} I_q
\end{equation}
by
Lemma \ref{lemma-filtered-injective}.
Hence if $T$ is any additive functor $T : \mathcal{A} \to \mathcal{B}$
then we get an additive functor
\begin{equation}
\label{equation-extend-T}
T_{ext} : \mathcal{I}^f \to \text{Fil}^f(\mathcal{B})
\end{equation}
by setting $T_{ext}(I) = \bigoplus T(I_p)$ with
$F^pT_{ext}(I) = \bigoplus_{q \geq p} T(I_q)$. Note that we have the
property $\text{gr}(T_{ext}(I)) = T(\text{gr}(I))$ by construction.
Hence we obtain a functor
\begin{equation}
\label{equation-extend-T-complexes}
T_{ext} : K^{+}(\mathcal{I}^f) \to K^{+}(\text{Fil}^f(\mathcal{B}))
\end{equation}
which commutes with $\text{gr}$. Then we define
(\ref{equation-filtered-derived-functor}) by the composition
\begin{equation}
\label{equation-definition-filtered-derived-functor}
RT = T_{ext} \circ j'.
\end{equation}
Since $RT : D^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$ is computed
by injective resolutions as well, see
Lemmas \ref{lemma-injective-acyclic},
the commutation of $T$ with $\text{gr}$, and the commutative diagrams of
Lemma \ref{lemma-filtered-localization-functor}
imply that
\begin{equation}
\label{equation-commute-gr}
\text{gr}^p \circ RT \cong RT \circ \text{gr}^p
\end{equation}
and
\begin{equation}
\label{equation-commute-forget}
(\text{forget }F) \circ RT \cong RT \circ (\text{forget }F)
\end{equation}
as functors $DF^{+}(\mathcal{A}) \to D^{+}(\mathcal{B})$.

\medskip\noindent
The filtered derived functor $RT$ (\ref{equation-filtered-derived-functor})
induces functors
$$
\begin{matrix}
RT : \text{Fil}^f(\mathcal{A}) \to DF^{+}(\mathcal{B}), \\
RT : \text{Comp}^{+}(\text{Fil}^f(\mathcal{A})) \to DF^{+}(\mathcal{B}), \\
RT : KF^{+}(\mathcal{A}) \to DF^{+}(\mathcal{B}).
\end{matrix}
$$
Note that since $\text{Fil}^f(\mathcal{A})$, and
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$ are no longer
abelian it does not make sense to say that $RT$ restricts to
a $\delta$-functor on them. (This can be
repaired by thinking of these categories as exact categories and
formulating the notion of a $\delta$-functor from an exact category
into a triangulated category.)
But it does make sense, and it is true
by construction, that $RT$ is an exact functor on the triangulated
category $KF^{+}(\mathcal{A})$.

\begin{lemma}
\label{lemma-ss-filtered-derived}
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $T : \mathcal{A} \to \mathcal{B}$ be a left exact functor.
Assume $\mathcal{A}$ has enough injectives.
Let $(K^\bullet, F)$ be an object of
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$.
There exists a spectral sequence $(E_r^{p, q}, d_r)_{r\geq 0}$
which is the spectral sequence
associated to an object of
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{B}))$
with
$$
E_1^{p, q} = R^{p + q}T(\text{gr}^p(K^\bullet))
$$
which converges to $R^{p + q}T(K^\bullet)$ inducing a finite
filtration on each $R^nT(K^\bullet)$. Moreover the construction
of this spectral sequence is functorial in the object
$K^\bullet$ of $\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$.
In fact the terms $(E_r, d_r)$ for $r \geq 2$ do not depend
on any choices.
\end{lemma}

\begin{proof}
Choose a filtered quasi-isomorphism $K^\bullet \to I^\bullet$
with $I^\bullet$ a bounded below complex of filtered injective objects, see
Lemma \ref{lemma-right-resolution-by-filtered-injectives}.
Consider the complex $RT(K^\bullet) = T_{ext}(I^\bullet)$, see
(\ref{equation-definition-filtered-derived-functor}).
Thus we can consider the spectral sequence
$(E_r, d_r)_{r \geq 0}$ associated to
this as a filtered complex in $\mathcal{B}$, see
Homology, Section \ref{homology-section-filtered-complex}.
By
Homology, Lemma \ref{homology-lemma-spectral-sequence-filtered-complex}
we have $E_1^{p, q} = H^{p + q}(\text{gr}^p(T(I^\bullet)))$.
By Equation (\ref{equation-decompose}) we have
$E_1^{p, q} = H^{p + q}(T(\text{gr}^p(I^\bullet)))$, and
by definition of a filtered injective resolution the
map $\text{gr}^p(K^\bullet) \to \text{gr}^p(I^\bullet)$
is an injective resolution. Hence
$E_1^{p, q} = R^{p + q}T(\text{gr}^p(K^\bullet))$.

\medskip\noindent
On the other hand, each $I^n$ has a finite filtration and hence
each $T(I^n)$ has a finite filtration. Thus we may apply
Homology, Lemma \ref{homology-lemma-biregular-ss-converges}
to conclude that the
spectral sequence converges to $H^n(T(I^\bullet)) = R^nT(K^\bullet)$
moreover inducing finite filtrations on each of the terms.

\medskip\noindent
Suppose that $K^\bullet \to L^\bullet$ is a morphism of
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$.
Choose a filtered quasi-isomorphism $L^\bullet \to J^\bullet$
with $J^\bullet$ a bounded below complex of filtered injective
objects, see
Lemma \ref{lemma-right-resolution-by-filtered-injectives}.
By our results above,
for example
Lemma \ref{lemma-morphisms-into-filtered-injective-complex},
there exists a diagram
$$
\xymatrix{
K^\bullet \ar[r] \ar[d] & L^\bullet \ar[d] \\
I^\bullet \ar[r] & J^\bullet
}
$$
which commutes up to homotopy. Hence we get a morphism of filtered
complexes $T(I^\bullet) \to T(J^\bullet)$ which gives rise to the
morphism of spectral sequences, see
Homology,
Lemma \ref{homology-lemma-spectral-sequence-filtered-complex-functorial}.
The last statement follows from this.
\end{proof}

\begin{remark}
\label{remark-final-functorial}
As promised in
Remark \ref{remark-functorial-ss}
we discuss the connection of the lemma
above with the constructions using Cartan-Eilenberg resolutions.
Namely, assume the notations of
Lemma \ref{lemma-two-ss-complex-functor}.
In particular $K^\bullet$ is a bounded below complex of
$\mathcal{A}$ and $T : \mathcal{A} \to \mathcal{B}$ is a
left exact functor. We give an alternative construction of the
spectral sequences ${}'E$ and ${}''E$ 

\medskip\noindent
First spectral sequence. Consider the ``stupid'' filtration
on $K^\bullet$
obtained by setting $F^p(K^\bullet) = \sigma_{\geq p}(K^\bullet)$, see
Homology, Section \ref{homology-section-truncations}.
Note that this stupid in the sense that
$d(F^p(K^\bullet)) \subset F^{p + 1}(K^\bullet)$, compare
Homology, Lemma \ref{homology-lemma-spectral-sequence-filtered-complex-d1}.
Note that $\text{gr}^p(K^\bullet) = K^p[p]$ with this filtration.
According to the above there is a spectral sequence
with $E_1$ term $E_1^{p, q} = R^{p + q}T(K^p[p])$.
Then the $E_2$ term is clearly $E_2^{p, q} = H^p(R^{p + q}T(K^\bullet))$
as in the spectral sequence ${}'E_r$.

\medskip\noindent
Second spectral sequence. Consider the filtration on the complex $K^\bullet$
obtained by setting $F^p(K^\bullet) = \tau_{\leq -p}(K^\bullet)$,see
Homology, Section \ref{homology-section-truncations}.
The minus sign is necessary
to get a decreasing filtration. Note that
$\text{gr}^p(K^\bullet)$ is quasi-isomorphic to $H^{-p}(K^\bullet)[-p]$
with this filtration. According to the above there is a spectral sequence
with $E_1$ term
$$
E_1^{p, q}
= R^{p + q}T(H^{-p}(K^\bullet)[-p])
= R^{2p + q}T(H^{-p}(K^\bullet)) = {}''E_2^{i, j}
$$
with $i = 2p + q$ and $j = -p$. (This looks unnatural, but note that we
could just have well developped the whole theory of filtered complexes
using increasing filtrations, with the end result that this then looks
natural, but the other one doesn't.) We leave it to the reader to see
that the differentials match up.

\medskip\noindent
Actually, given a Cartan-Eilenberg resolution
$K^\bullet \to I^{\bullet, \bullet}$ the induced morphism
$K^\bullet \to sI^\bullet$ into the associated simple complex
will be a filtered injective resolution for either filtration
using suitable filtrations on $sI^\bullet$. This can be used
to match up the spectral sequences exactly.
\end{remark}






\section{Ext groups}
\label{section-ext}

\noindent
In this section we start describing the ext groups of objects
of an abelian category. First we have the following very general
definition.

\begin{definition}
\label{definition-ext}
Let $\mathcal{A}$ be an abelian category. Let $i \in \mathbf{Z}$. Let
$X, Y$ be objects of $D(\mathcal{A})$. The {\it $i$th extension group}
of $X$ by $Y$ is the group
$$
\text{Ext}^i_\mathcal{A}(X, Y) =
\Hom_{D(\mathcal{A})}(X, Y[i]) =
\Hom_{D(\mathcal{A})}(X[-i], Y).
$$
If $A, B \in \Ob(\mathcal{A})$ we set
$\text{Ext}^i_\mathcal{A}(A, B) = \text{Ext}^i_\mathcal{A}(A[0], B[0])$.
\end{definition}

\noindent
Since $\Hom_{D(\mathcal{A})}(X, -)$,
resp.\ $\Hom_{D(\mathcal{A})}(-, Y)$ is a homological,
resp.\ cohomological functor, see
Lemma \ref{lemma-representable-homological},
we see that a distinguished triangle $(Y, Y', Y'')$,
resp.\ $(X, X', X'')$ leads to a long exact sequence
$$
\ldots \to
\text{Ext}^i_\mathcal{A}(X, Y) \to
\text{Ext}^i_\mathcal{A}(X, Y') \to
\text{Ext}^i_\mathcal{A}(X, Y'') \to
\text{Ext}^{i + 1}_\mathcal{A}(X, Y) \to \ldots
$$
respectively
$$
\ldots \to
\text{Ext}^i_\mathcal{A}(X'', Y) \to
\text{Ext}^i_\mathcal{A}(X', Y) \to
\text{Ext}^i_\mathcal{A}(X, Y) \to
\text{Ext}^{i + 1}_\mathcal{A}(X'', Y) \to \ldots
$$
Note that since $D^+(\mathcal{A})$, $D^-(\mathcal{A})$, $D^b(\mathcal{A})$
are full subcategories we may compute the ext groups by Hom groups
in these categories provided $X$, $Y$ are contained in them.

\noindent
In case the category $\mathcal{A}$ has enough injectives or enough
projectives we can compute the Ext groups using injective or
projective resolutions. To avoid confusion, recall that having an
injective (resp.\ projective) resolution implies vanishing of homology
in all low (resp.\ high) degrees, see
Lemmas \ref{lemma-cohomology-bounded-below} and
\ref{lemma-cohomology-bounded-above}.

\begin{lemma}
\label{lemma-compute-ext-resolutions}
Let $\mathcal{A}$ be an abelian category.
Let $X^\bullet, Y^\bullet \in \Ob(K(\mathcal{A}))$.
\begin{enumerate}
\item Let $Y^\bullet \to I^\bullet$ be an injective resolution
(Definition \ref{definition-injective-resolution}). Then
$$
\text{Ext}^i_\mathcal{A}(X^\bullet, Y^\bullet) =
\Hom_{K(\mathcal{A})}(X^\bullet, I^\bullet[i]).
$$
\item Let $P^\bullet \to X^\bullet$ be a projective resolution
(Definition \ref{definition-projective-resolution}). Then
$$
\text{Ext}^i_\mathcal{A}(X^\bullet, Y^\bullet) =
\Hom_{K(\mathcal{A})}(P^\bullet[-i], Y^\bullet).
$$
\end{enumerate}
\end{lemma}

\begin{proof}
Follows immediately from
Lemma \ref{lemma-morphisms-into-injective-complex}
and
Lemma \ref{lemma-morphisms-from-projective-complex}.
\end{proof}

\noindent
In the rest of this section we discuss extensions of objects of the
abelian category itself. First we observe the following.

\begin{lemma}
\label{lemma-negative-exts}
Let $\mathcal{A}$ be an abelian category and let
$A, B \in \Ob(\mathcal{A})$.
For $i < 0$ we have $\text{Ext}^i_\mathcal{A}(B, A) = 0$.
We have $\text{Ext}^0_\mathcal{A}(B, A) = \Hom_\mathcal{A}(B, A)$.
\end{lemma}

\begin{proof}
Let $L^\bullet \to B[0]$ be any quasi-isomorphism.
Then it is also true that $\tau_{\leq 0}L^\bullet \to B[0]$
is a quasi-isomorphism. Hence a morphism $B[0] \to A[i]$
in $D(\mathcal{A})$ can be represented as $fs^{-1}$ where
$s : L^\bullet \to B[0]$ is a quasi-isomorphism, $f : L^\bullet \to A[i]$
a morphism, and $L^n = 0$ for $n > 0$. Thus $f = 0$ if $i < 0$.
If $i = 0$, then $f$ corresponds exactly to a morphism
$B = \text{Coker}(L^{-1} \to L^0) \to A$.
\end{proof}

\noindent
Let $\mathcal{A}$ be an abelian category.
Suppose that $0 \to A \to A' \to A'' \to 0$ is a short exact
sequence of objects of $\mathcal{A}$. Then
$0 \to A[0] \to A'[0] \to A''[0] \to 0$ leads to a distiguished
triangle in $D(\mathcal{A})$ (see
Lemma \ref{lemma-derived-canonical-delta-functor})
hence a long exact sequence of Ext groups
$$
0 \to \text{Ext}^0_\mathcal{A}(B, A) \to
\text{Ext}^0_\mathcal{A}(B, A') \to
\text{Ext}^0_\mathcal{A}(B, A'') \to
\text{Ext}^1_\mathcal{A}(B, A) \to \ldots
$$
Similarly, given a short exact sequence $0 \to B \to B' \to B'' \to 0$
we obtain a long exact sequence of Ext groups
$$
0 \to \text{Ext}^0_\mathcal{A}(B'', A) \to
\text{Ext}^0_\mathcal{A}(B', A) \to
\text{Ext}^0_\mathcal{A}(B, A) \to
\text{Ext}^1_\mathcal{A}(B'', A) \to \ldots
$$
We may view these Ext groups as an application of the construction of the
derived category. It shows one can define Ext groups and construct
the long exact sequence of Ext groups without needing the existence of enough
injectives or projectives. There is an alternative construction of the Ext
groups due to Yoneda which avoids the use of the derived category, see
\cite{Yoneda}.

\begin{definition}
\label{definition-yoneda-extension}
Let $\mathcal{A}$ be an abelian category.
Let $A, B \in \Ob(\mathcal{A})$.
A degree $i$ {\it Yoneda extension} of $B$ by $A$ is an exact sequence
$$
E : 0 \to A \to Z_{i - 1} \to Z_{i - 2} \to \ldots \to Z_0 \to B \to 0
$$
in $\mathcal{A}$. We say two Yoneda extensions $E$ and $E'$ of the same degree
are {\it equivalent} if there exists a commutative diagram
$$
\xymatrix{
0 \ar[r] & A \ar[r] & Z_{i - 1} \ar[r] & \ldots \ar[r] &
Z_0 \ar[r] & B \ar[r] & 0 \\
0 \ar[r] &
A \ar[r] \ar[u] \ar[d] &
Z''_{i - 1} \ar[r] \ar[u] \ar[d] &
\ldots \ar[r] &
Z''_0 \ar[r] \ar[u] \ar[d] & B \ar[r] \ar[u] \ar[d] & 0 \\
0 \ar[r] & A \ar[r] & Z'_{i - 1} \ar[r] & \ldots \ar[r] &
Z'_0 \ar[r] & B \ar[r] & 0
}
$$
where the middle row is a Yoneda extension as well.
\end{definition}

\noindent
It is not immediately clear that the equivalence of the definition is
an equivalence relation. Although it is instructive to prove this directly
this will also follow from
Lemma \ref{lemma-yoneda-extension}
below.

\medskip\noindent
Let $\mathcal{A}$ be an abelian category with objects $A$, $B$.
Given a Yoneda extension
$E : 0 \to A \to Z_{i - 1} \to Z_{i - 2} \to \ldots \to Z_0 \to B \to 0$
we define an associated element $\delta(E) \in \text{Ext}^i(B, A)$
as the morphism $\delta(E) = fs^{-1} : B[0] \to A[i]$ where
$s$ is the quasi-isomorphism
$$
(\ldots \to 0 \to A \to Z_{i - 1} \to \ldots \to Z_0 \to 0 \to \ldots)
\longrightarrow
B[0]
$$
and $f$ is the morphism of complexes
$$
(\ldots \to 0 \to A \to Z_{i - 1} \to \ldots \to Z_0 \to 0 \to \ldots)
\longrightarrow
A[i]
$$
We call $\delta(E) = fs^{-1}$ the {\it class} of the Yoneda extension.
It turns out that this class characterizes the equivalence class
of the Yoneda extension.

\begin{lemma}
\label{lemma-yoneda-extension}
Let $\mathcal{A}$ be an abelian category with objects $A$, $B$.
Any element in $\text{Ext}^i_\mathcal{A}(B, A)$ is $\delta(E)$
for some degree $i$ Yoneda extension of $B$ by $A$.
Given two Yoneda extensions $E$, $E'$ of the same degree
then $E$ is equivalent to $E'$ if and only if $\delta(E) = \delta(E')$.
\end{lemma}

\begin{proof}
Let $\xi : B[0] \to A[i]$ be an element of $\text{Ext}^i_\mathcal{A}(B, A)$.
We may write $\xi = f s^{-1}$ for some quasi-isomorphism
$s : L^\bullet \to B[0]$ and map $f : L^\bullet \to A[i]$.
After replacing $L^\bullet$ by $\tau_{\leq 0}L^\bullet$ we may assume
that $L^i = 0$ for $i > 0$. Picture
$$
\xymatrix{
L^{- i - 1} \ar[r] & L^{-i} \ar[r] \ar[d] & \ldots \ar[r] &
L^0 \ar[r] & B \ar[r] & 0 \\
& A
}
$$
Then setting $Z_{i - 1} = (L^{- i + 1} \oplus A)/L^{-i}$ and
$Z_j = L^{-j}$ for $j = i - 2, \ldots, 0$ we see that we obtain a
degree $i$ extension $E$ of $B$ by $A$ whose class $\delta(E)$ equals
$\xi$.

\medskip\noindent
It is immediate from the definitions that equivalent Yoneda extensions
have the same class. Suppose that
$E : 0 \to A \to Z_{i - 1} \to Z_{i - 2} \to \ldots \to Z_0 \to B \to 0$ and
$E' : 0 \to A \to Z'_{i - 1} \to Z'_{i - 2} \to \ldots \to Z'_0 \to B \to 0$
are Yoneda extensions with the same class.
By construction of $D(\mathcal{A})$ as the localization
of $K(\mathcal{A})$ at the set of quasi-isomorphisms, this means there
exists a complex $L^\bullet$ and quasi-isomorphisms
$$
t : L^\bullet \to
(\ldots \to 0 \to A \to Z_{i - 1} \to \ldots \to Z_0 \to 0 \to \ldots)
$$
and
$$
t' : L^\bullet \to
(\ldots \to 0 \to A \to Z'_{i - 1} \to \ldots \to Z'_0 \to 0 \to \ldots)
$$
such that $s \circ t = s' \circ t'$ and $f \circ t = f' \circ t'$, see
Categories, Section \ref{categories-section-localization}.
Let $E''$ be the degree $i$ extension of $B$ by $A$ constructed from
the pair $L^\bullet \to B[0]$ and $L^\bullet \to A[i]$ in the first
paragraph of the proof. Then the reader sees readily that there exists
``morphisms'' of degree $i$ Yoneda extensions $E'' \to E$ and $E'' \to E'$
as in the definition of equivalent Yoneda extensions (details omitted).
This finishes the proof.
\end{proof}

\begin{lemma}
\label{lemma-ext-1}
Let $\mathcal{A}$ be an abelian category. Let $A$, $B$ be objects
of $\mathcal{A}$. Then $\text{Ext}^1_\mathcal{A}(B, A)$ is
the group $\text{Ext}_\mathcal{A}(B, A)$ constructed in
Homology, Definition \ref{homology-definition-ext-group}.
\end{lemma}

\begin{proof}
This is the case $i = 1$ of
Lemma \ref{lemma-yoneda-extension}.
\end{proof}



\section{Unbounded complexes}
\label{section-unbounded}

\noindent
A reference for the material in this section is \cite{Spaltenstein}.
The following lemma is useful to find ``good'' left resolutions of
unbounded complexes.

\begin{lemma}
\label{lemma-special-direct-system}
Let $\mathcal{A}$ be an abelian category. Let
$\mathcal{P} \subset \Ob(\mathcal{A})$ be a subset.
Assume that every object of $\mathcal{A}$ is a quotient of an
element of $\mathcal{P}$. Let $K^\bullet$ be a complex.
There exists a commutative diagram
$$
\xymatrix{
P_1^\bullet \ar[d] \ar[r] & P_2^\bullet \ar[d] \ar[r] & \ldots \\
\tau_{\leq 1}K^\bullet \ar[r] & \tau_{\leq 2}K^\bullet \ar[r] & \ldots
}
$$
in the category of complexes such that
\begin{enumerate}
\item the vertical arrows are quasi-isomorphisms,
\item $P_1^\bullet$ is a bounded above complex with terms in
$\mathcal{P}$,
\item the arrows $P_n^\bullet \to P_{n + 1}^\bullet$
are termwise split injections and each cokernel
$P^i_{n + 1}/P^i_n$ is an element of $\mathcal{P}$.
\end{enumerate}
\end{lemma}

\begin{proof}
By
Lemma \ref{lemma-subcategory-left-resolution}
any bounded above complex has a resolution by a bounded above complex
whose terms are in $\mathcal{P}$. Thus we obtain the first complex
$P_1^\bullet$. By induction it suffices, given
$P_1^\bullet, \ldots, P_n^\bullet$ to construct
$P_{n + 1}^\bullet$ and the maps
$P_n^\bullet \to P_{n + 1}^\bullet$ and
$P_n^\bullet \to \tau_{\leq n + 1}K^\bullet$.
Consider the cone $C_1^\bullet$ of the composition
$P_n^\bullet \to \tau_{\leq n}K^\bullet \to \tau_{n + 1}L^\bullet$.
This fits into the distinguished triangle
$$
P_n^\bullet \to \tau_{n + 1}K^\bullet \to C_1^\bullet \to P_n^\bullet[1]
$$
Note that $C_1^\bullet$ is bounded above, hence we can choose a
quasi-isomorphism $Q^\bullet \to C_1^\bullet$ where $Q^\bullet$ is a
bounded above complex whose terms are elements of $\mathcal{P}$.
Take the cone $C_2^\bullet$ of the map of complexes
$Q^\bullet \to P_n^\bullet[1]$ to get the
distinguished triangle
$$
Q^\bullet \to P_n^\bullet[1] \to C_2^\bullet \to Q^\bullet[1]
$$
By the axioms of triangulated categories we obtain a map
of distinguished triangles
$$
\xymatrix{
P_n^\bullet \ar[r] \ar[d] &
C_2^\bullet[-1] \ar[r] \ar[d] &
Q^\bullet \ar[r] \ar[d] &
P_n^\bullet[1] \ar[d] \\
P_n^\bullet \ar[r] &
\tau_{n + 1}K^\bullet \ar[r] &
C_1^\bullet \ar[r] &
P_n^\bullet[1]
}
$$
in the triangulated category $K(\mathcal{A})$.
Set $P_{n + 1}^\bullet = C_2^\bullet[-1]$.
Note that (3) holds by construction.
Choose an actual morphism of complexes
$f : P_{n + 1}^\bullet \to \tau_{n + 1}K^\bullet$.
The left square of the diagram above commutes up to homotopy, but as
$P_n^\bullet \to P_{n + 1}^\bullet$ is a termwise split injection
we can lift the homotopy and modify our choice of $f$ to make it commute.
Finally, $f$ is a quasi-isomorphism, because both $P_n^\bullet \to P_n^\bullet$
and $Q^\bullet \to C_1^\bullet$ are.
\end{proof}

\begin{lemma}
\label{lemma-special-inverse-system}
Let $\mathcal{A}$ be an abelian category. Let
$\mathcal{I} \subset \Ob(\mathcal{A})$ be a subset.
Assume that every object of $\mathcal{A}$ is a subobject of an
element of $\mathcal{I}$. Let $K^\bullet$ be a complex.
There exists a commutative diagram
$$
\xymatrix{
\ldots \ar[r] &
\tau_{\geq -2}K^\bullet \ar[r] \ar[d] &
\tau_{\geq -1}K^\bullet \ar[d] \\
\ldots \ar[r] & I_2^\bullet \ar[r] & I_1^\bullet 
}
$$
in the category of complexes such that
\begin{enumerate}
\item the vertical arrows are quasi-isomorphisms,
\item $I_1^\bullet$ is a bounded above complex with terms in
$\mathcal{I}$,
\item the arrows $I_{n + 1}^\bullet \to I_n^\bullet$
are termwise split surjections and
$\text{Ker}(I^i_{n + 1} \to I^i_n)$ is an
element of $\mathcal{I}$.
\end{enumerate}
\end{lemma}

\begin{proof}
This lemma is dual to
Lemma \ref{lemma-special-direct-system}.
\end{proof}




\section{K-injective complexes}
\label{section-K-injective}

\noindent
The following types of complexes can be used to compute right derived
functors on the unbounded derived category.

\begin{definition}
\label{definition-K-injective}
Let $\mathcal{A}$ be an abelian category. A complex $I^\bullet$
is {\it K-injective} if for every acyclic complex $M^\bullet$ we
have $\Hom_{K(\mathcal{A})}(M^\bullet, I^\bullet) = 0$.
\end{definition}

\noindent
In the situation of the definition we have in fact
$\Hom_{K(\mathcal{A})}(M^\bullet[i], I^\bullet) = 0$ for all $i$
as the translate of an acyclic complex is acyclic.

\begin{lemma}
\label{lemma-K-injective}
Let $\mathcal{A}$ be an abelian category.
Let $I^\bullet$ be a complex. The following are equivalent
\begin{enumerate}
\item $I^\bullet$ is K-injective,
\item for every quasi-isomorphism $M^\bullet \to N^\bullet$ the map
$$
\Hom_{K(\mathcal{A})}(N^\bullet, I^\bullet)
\to \Hom_{K(\mathcal{A})}(M^\bullet, I^\bullet)
$$
is bijective, and
\item for every complex $N^\bullet$ the map
$$
\Hom_{K(\mathcal{A})}(N^\bullet, I^\bullet)
\to \Hom_{D(\mathcal{A})}(N^\bullet, I^\bullet)
$$
is an isomorphism.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (1). Then (2) holds because the functor
$\Hom_{K(\mathcal{A})}( - , I^\bullet)$ is cohomological
and the cone on a quasi-isomorphism is acyclic.

\medskip\noindent
Assume (2). A morphism $N^\bullet \to I^\bullet$ in $D(\mathcal{A})$
is of the form $fs^{-1} : N^\bullet \to I^\bullet$ where
$s : M^\bullet \to N^\bullet$ is a quasi-isomorphism and
$f : M^\bullet \to I^\bullet$ is a map. By (2) this corresponds to
a unique morphism $N^\bullet \to I^\bullet$ in $K(\mathcal{A})$, i.e.,
(3) holds.

\medskip\noindent
Assume (3). If $M^\bullet$ is acyclic then $M^\bullet$ is isomorphic
to the zero complex in $D(\mathcal{A})$ hence
$\Hom_{D(\mathcal{A})}(N^\bullet, I^\bullet) = 0$, whence
$\Hom_{K(\mathcal{A})}(N^\bullet, I^\bullet) = 0$ by (3),
i.e., (1) holds.
\end{proof}

\begin{lemma}
\label{lemma-bounded-below-injectives-K-injective}
Let $\mathcal{A}$ be an abelian category. A bounded below complex of
injectives is K-injective.
\end{lemma}

\begin{proof}
Follows from
Lemmas \ref{lemma-K-injective} and
\ref{lemma-morphisms-into-injective-complex}.
\end{proof}

\begin{lemma}
\label{lemma-enough-K-injectives-implies}
Let $\mathcal{A}$ be an abelian category.
Assume every complex has a quasi-isomorphism towards a K-injective complex.
Then any exact functor $F : K(\mathcal{A}) \to \mathcal{D}'$ of triangulated
categories has a right derived functor
$$
RF : D(\mathcal{A}) \longrightarrow \mathcal{D}'
$$
and $RF(I^\bullet) = I^\bullet$ for K-injective complexes $I^\bullet$.
\end{lemma}

\begin{proof}
To see this we apply
Lemma \ref{lemma-find-existence-computes}
with $\mathcal{I}$ the collection of K-injective complexes. Since (1)
holds by assumption, it suffices to prove that if $I^\bullet \to J^\bullet$
is a quasi-isomorphism of K-injective complexes, then
$F(I^\bullet) \to F(J^\bullet)$ is an isomorphism. This is clear because
$I^\bullet \to J^\bullet$ is a homotopy equivalence, i.e., an
isomorphism in $K(\mathcal{A})$, by
Lemma \ref{lemma-K-injective}.
\end{proof}

\noindent
The following lemma can be generalized to limits over bigger ordinals.

\begin{lemma}
\label{lemma-limit-K-injectives}
Let $\mathcal{A}$ be an abelian category. Let
$$
\ldots \to I_3^\bullet \to I_2^\bullet \to I_1^\bullet
$$
be an inverse system of K-injective complexes. Assume
\begin{enumerate}
\item each $I_n^\bullet$ is $K$-injective,
\item each map $I_{n + 1}^m \to I_n^m$ is a split surjection,
\item the limits $I^m = \lim I_n^m$ exist.
\end{enumerate}
Then the complex $I^\bullet$ is K-injective.
\end{lemma}

\begin{proof}
Let $M^\bullet$ be an acyclic complex. Let us abbreviate
$H_n(a, b) = \Hom_\mathcal{A}(M^a, I_n^b)$. With this notation
$\Hom_{K(\mathcal{A})}(M^\bullet, I^\bullet)$ is the cohomology
of the complex
$$
\prod_m \lim\limits_n H_n(m, m - 2)
\to
\prod_m \lim\limits_n H_n(m, m - 1)
\to
\prod_m \lim\limits_n H_n(m, m)
\to
\prod_m \lim\limits_n H_n(m, m + 1)
$$
in the third spot from the left.
We may exchange the order of $\prod$ and $\lim$ and each of the complexes
$$
\prod_m H_n(m, m - 2)
\to
\prod_m H_n(m, m - 1)
\to
\prod_m H_n(m, m)
\to
\prod_m H_n(m, m + 1)
$$
is exact by assumption (1). By assumption (2) the maps in the systems
$$
\ldots \to
\prod_m H_3(m, m - 2) \to
\prod_m H_2(m, m - 2) \to
\prod_m H_1(m, m - 2)
$$
are surjective. Thus the lemma follows from
Homology, Lemma \ref{homology-lemma-apply-Mittag-Leffler}.
\end{proof}

\begin{remark}
\label{remark-difficulty-K-injectives}
It appears that a combination of
Lemmas \ref{lemma-special-inverse-system},
\ref{lemma-enough-K-injectives-implies}, and
\ref{lemma-limit-K-injectives}
produces ``enough K-injectives'' for any abelian category with enough
injectives and countable limits. Actually, this may not work!
Namely, suppose that $K^\bullet$ is a complex and $I_n^\bullet$ is the
system of bounded above complexes of injectives produced by
Lemma \ref{lemma-special-inverse-system}.
Let $I^\bullet = \lim I_n^\bullet$ be the termwise limit which is
K-injective by
Lemma \ref{lemma-limit-K-injectives}.
The problem is that the map $K^\bullet \to I^\bullet$ may not be a
quasi-isomorphism. Namely, if $\lim_n$ is not exact in $\mathcal{A}$
then there is no reason to think that it is a quasi-isomorphism in general.
\end{remark}










\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
