\input{preamble}

% OK, start here.
%
\begin{document}

\title{Results on Schemes}


\maketitle

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we start proving some basic theorems of algebraic geometry.
A basic reference is \cite{EGA}.















\section{Absolute Noetherian Approximation}
\label{section-approximation}

\noindent
See Categories, Section \ref{categories-section-posets-limits}
for our conventions regarding directed systems.

\begin{lemma}
\label{lemma-directed-inverse-system-affine schemes-has-limit}
Let $I$ be a directed partially ordered set.
Let $(S_i, f_{ii'})$ be an inverse system of
schemes over $I$.  If all the schemes $S_i$
are affine, then the limit $S = \text{lim}_i\ S_i$ exists
in the category of schemes.
In fact $S$ is affine and $S = \text{Spec}(\text{colim}_i\ R_i)$
with $R_i = \Gamma(S_i, \mathcal{O})$.
\end{lemma}

\begin{proof}
Just define $S = \text{Spec}(\text{colim}_i\ R_i)$.
It follows from Schemes, Lemma \ref{schemes-lemma-morphism-into-affine}
that $S$ is the limit even in the category of locally ringed spaces.
\end{proof}

\begin{lemma}
\label{lemma-directed-inverse-system-has-limit}
Let $I$ be a directed partially ordered set.
Let $(S_i, f_{ii'})$ be an inverse system of
schemes over $I$. If all the morphisms $f_{ii'} : S_i \to S_{i'}$
are affine, then the limit $\text{lim}_i\ S_i$ exists
in the category of schemes.
Moreover, each of the morphisms $f_i : S \to S_i$ is affine.
\end{lemma}

\begin{proof}
Choose $i_0 \in I$. Note that $I$ is nonempty as the limit is directed.
For convenience write $S_0 = S_{i_0}$ and $i_0 = 0$.
For every $i \geq 0$ consider the quasi-coherent sheaf of
$\mathcal{O}_{S_0}$-algebras $\mathcal{A}_i = f_{i0,*}\mathcal{O}_{S_i}$.
Recall that $S_i = \underline{\text{Spec}}_{S_0}(\mathcal{A})$,
see Morphisms, Lemma \ref{morphisms-lemma-characterize-affine}.
Set $\mathcal{A} = \text{colim}_{i \geq 0}\ \mathcal{A}_i$.
This is a quasi-coherent sheaf of $\mathcal{O}_{S_0}$-algebras,
see Schemes, Section \ref{schemes-section-quasi-coherent}.
Set $S = \underline{\text{Spec}}_{S_0}(\mathcal{A})$.
By Morphisms, Lemma \ref{morphisms-lemma-affine-equivalence-algebras}
we get for $i \geq 0$ morphisms $f_i : S \to S_i$ compatible with
the transition morphisms. Note that the morphisms $f_i$ are
affine by Morphisms, Lemma \ref{morphisms-lemma-affine-permanence} for example.
By Lemma \ref{lemma-directed-inverse-system-affine schemes-has-limit} above
we see that for any affine open $U_0 \subset S_0$ the
inverse image $U = f_0^{-1}(U_0) \subset S$ is the limit of the
system of opens $U_i = f_i^{-1}(U_0)$, $i \geq 0$ in the
category of schemes.

\medskip\noindent
Let $T$ be a scheme. Let $g_i : T \to S_i$ be a compatible system
of morphisms. To show that $S = \text{lim}_i\ S_i$ we have
to prove there is a unique morphism $g : T \to S$ with
$g_i = f_i \circ g$ for all $i \in I$.
For every $t \in T$ there exists an affine open
$U_0 \subset S_0$ containing $g_0(t)$. Let $V \subset g_0^{-1}(U_0)$
be an affine open neighbourhood containing $t$.
By the remarks above we obtain a unique morphism
$g_V : V \to U = f_0^{-1}(U_0)$ such that $f_i \circ g_V = g_i|_{U_i}$
for all $i$. The open sets $V \subset T$ so constructed form
a basis for the topology of $T$. The morphisms $g_V$ glue to a morphism
$g : T \to S$ because of the uniqueness property. This gives the
desired morphism $g : T \to S$.
\end{proof}

\begin{lemma}
\label{lemma-limit-nonempty}
Let $I$ be a directed partially ordered set.
Let $(S_i, f_{ii'})$ be an inverse system of
schemes over $I$. Assume
\begin{enumerate}
\item all the morphisms $f_{ii'} : S_i \to S_{i'}$ are affine,
\item all the schemes $S_i$ are quasi-compact, and
\item all the schemes $S_i$ are nonempty.
\end{enumerate}
Then the limit $S = \text{lim}_i\ S_i$ is nonempty.
\end{lemma}

\begin{proof}
Choose $i_0 \in I$. Note that $I$ is nonempty as the limit is directed.
For convenience write $S_0 = S_{i_0}$ and $i_0 = 0$.
Choose an affine open covering $S_0 = \bigcup_{j = 1, \ldots, m} U_j$.
Since $I$ is directed there exists a $j \in \{1, \ldots, m\}$
such that $f_{i0}^{-1}(U_j) \not = \emptyset$ for all
$i \geq 0$. Hence $\lim_{i \geq 0}\ f_{i0}^{-1}(U_j)$ is not
empty since a directed colimit of nonzero rings is nonzero
(because $1 \not = 0$). As $\lim_{i \geq 0}\ f_{i0}^{-1}(U_j)$
is an open subscheme of the limit we win.
\end{proof}

\begin{lemma}
\label{lemma-descend-section}
Let $I$ be a directed partially ordered set.
Let $(S_i, f_{ii'})$ be an inverse system of schemes over $I$.
Assume
\begin{enumerate}
\item all the morphisms $f_{ii'} : S_i \to S_{i'}$ are affine,
\item all the schemes $S_i$ are quasi-compact and quasi-separated.
\end{enumerate}
Let $S = \text{lim}_i\ S_i$. Let $i \in I$.
Suppose that $\mathcal{F}_i$ is a quasi-coherent sheaf on $S_i$.
Set $\mathcal{F}_j = f_{ji}^*\mathcal{F}_i$ for $j \geq i$ and set
$\mathcal{F} = f_i^*\mathcal{F}_i$.
Then
$$
\Gamma(S, \mathcal{F}) = \text{colim}_{j \geq i}\ \Gamma(S_j, \mathcal{F}_j)
$$
\end{lemma}

\begin{proof}
Write $\mathcal{A}_j = f_{ji, *} \mathcal{O}_{S_j}$.
This is a quasi-coherent sheaf of $\mathcal{O}_{S_i}$-algebras
(see Morphisms, Lemma \ref{morphisms-lemma-affine-equivalence-algebras})
and $S_j$ is the relative spectrum of $\mathcal{A}_j$ over $S_i$.
In the proof of Lemma \ref{lemma-directed-inverse-system-has-limit}
we constructed $S$ as the relative spectrum of
$\mathcal{A} = \text{colim}_{j \geq i}\ \mathcal{A}_j$
over $S_i$. Set
$$
\mathcal{M}_j = \mathcal{F}_i \otimes_{\mathcal{O}_{S_i}} \mathcal{A}_j
$$
and
$$
\mathcal{M} = \mathcal{F}_i \otimes_{\mathcal{O}_{S_i}} \mathcal{A}.
$$
Then we have $f_{ji, *} \mathcal{F}_j = \mathcal{M}_j$
and $f_{i, *}\mathcal{F} = \mathcal{M}$. Since $\mathcal{A}$
is the colimit of the sheaves $\mathcal{A}_j$ and since tensor
product commutes with directed colimits, we conclude that
$\mathcal{M} = \text{colim}_{j \geq i}\ \mathcal{M}_j$.
Since $S_i$ is quasi-compact and quasi-separated we see that
\begin{eqnarray*}
\Gamma(S, \mathcal{F})
& = &
\Gamma(S_i, \mathcal{M}) \\
& = &
\Gamma(S_i, \text{colim}_{j \geq i} \ \mathcal{M}_j) \\
& = &
\text{colim}_{j \geq i}\ \Gamma(S_i, \mathcal{M}_j) \\
& = &
\text{colim}_{j \geq i}\ \Gamma(S_j, \mathcal{F}_j)
\end{eqnarray*}
see Sheaves, Lemma \ref{sheaves-lemma-directed-colimits-sections} and
Topology, Lemma \ref{topology-lemma-topology-quasi-separated-scheme}
for the middle equality.
\end{proof}

\begin{lemma}
\label{lemma-descend-opens}
Let $I$ be a directed partially ordered set.
Let $(S_i, f_{ii'})$ be an inverse system of
schemes over $I$. Assume
\begin{enumerate}
\item all the morphisms $f_{ii'} : S_i \to S_{i'}$ are affine,
\item all the schemes $S_i$ are quasi-compact and quasi-separated.
\end{enumerate}
Then we have the following:
\begin{enumerate}
\item Given any quasi-compact open $V \subset S = \text{lim}_i\ S_i$
there exists an $i \in I$ and a quasi-compact open $V_i \subset S_i$
such that $f_i^{-1}(V_i) = V$.
\item Given $V_i \subset S_i$ and $V_{i'} \subset S_{i'}$
quasi-compact opens such that $f_i^{-1}(V_i) = f_{i'}^{-1}(V_{i'})$
there exists an index $i'' \geq i, i'$ such that
$f_{i''i}^{-1}(V_i) = f_{i''i'}^{-1}(V_{i'})$.
\item If $V_{1, i}, \ldots, V_{n, i} \subset S_i$ are quasi-compact
opens and $S = f_i^{-1}(V_{1, i}) \cup \ldots \cup f_i^{-1}(V_{n, i})$
then $S_{i'} = f_{i'i}^{-1}(V_{1, i}) \cup \ldots \cup f_{i'i}^{-1}(V_{n, i})$
for some $i' \geq i$.
\end{enumerate}
\end{lemma}

\begin{proof}
Choose $i_0 \in I$. Note that $I$ is nonempty as the limit is directed.
For convenience we write $S_0 = S_{i_0}$ and $i_0 = 0$.
Choose an affine open covering $S_0 = U_{1, 0} \cup \ldots \cup U_{m, 0}$.
Denote $U_{j, i} \subset S_i$ the inverse image of $U_{j, 0}$
under the transition morphism for $i \geq 0$.
Denote $U_j$ the inverse image of $U_{j, 0}$ in $S$.
Note that $U_j = \text{lim}_i\ U_{j, i}$ is a limit of affine
schemes.

\medskip\noindent
We first prove the uniqueness statement: Let
$V_i \subset S_i$ and $V_{i'} \subset S_{i'}$
quasi-compact opens such that $f_i^{-1}(V_i) = f_{i'}^{-1}(V_{i'})$.
It suffices to show that $f_{i''i}^{-1}(V_i \cap U_{j, i''})$ and
$f_{i''i'}^{-1}(V_{i'} \cap U_{j, i''})$ become equal
for $i''$ large enough. Hence we reduce to the case
of a limit of affine schemes. In this case write
$S = \text{Spec}(R)$ and $S_i = \text{Spec}(R_i)$ for all $i \in I$.
We may write $V_i = S_i \setminus V(h_1, \ldots, h_m)$
and $V_{i'} = S_{i'} \setminus V(g_1, \ldots, g_n)$.
The assumption means that the ideals
$\sum g_jR$ and $\sum h_jR$ have the same radical
in $R$. This means that $g_j^N = \sum a_{jj'}h_{j'}$ and
$h_j^N = \sum b_{jj'} g_{j'}$ for some $N \gg 0$ and $a_{jj'}$
and $b_{jj'}$ in $R$.
Since $R = \text{colim}_i R_i$ we can chose an index
$i'' \geq i$ such that the equations
$g_j^N = \sum a_{jj'}h_{j'}$ and
$h_j^N = \sum b_{jj'} g_{j'}$ hold in $R_{i''}$ for some
$a_{jj'}$ and $b_{jj'}$ in $R_{i''}$. This implies that
the ideals $\sum g_jR_{i''}$ and $\sum h_jR_{i''}$ have the same radical
in $R_{i''}$ as desired.

\medskip\noindent
We prove existence. We may apply the uniqueness statement to
the limit of schemes
$U_{j_1} \cap U_{j_2} = \text{lim}_i\ U_{j_1, i} \cap U_{j_2, i}$
since these are still quasi-compact due to the fact that the
$S_i$ were assumed quasi-separated.
Hence it is enough to prove existence in the affine case.
In this case write $S = \text{Spec}(R)$ and $S_i = \text{Spec}(R_i)$
for all $i \in I$. Then $V = S \setminus V(g_1, \ldots, g_n)$
for some $g_1, \ldots, g_n \in R$. Choose any $i$ large enough
so that each of the $g_j$ comes from an element $g_{j, i} \in R_i$
and take $V_i = S_i \setminus V(g_{1, i}, \ldots, g_{n, i})$.

\medskip\noindent
The statement on coverings follows from the uniqueness statement
for the opens $V_{1, i} \cup \ldots \cup V_{n, i}$ and $S_i$ of $S_i$.
\end{proof}

\begin{lemma}
\label{lemma-limit-quasi-affine}
Let $I$ be a directed partially ordered set.
Let $(S_i, f_{ii'})$ be an inverse system of
schemes over $I$. Assume
\begin{enumerate}
\item all the morphisms $f_{ii'} : S_i \to S_{i'}$ are affine,
\item all the schemes $S_i$ are quasi-compact and quasi-separated, and
\item the limit $S = \text{lim}_i\ S_i$ is quasi-affine.
\end{enumerate}
Then for some $i_0 \in I$ the schemes $S_i$ for $i \geq i_0$
are quasi-affine.
\end{lemma}

\begin{proof}
Choose $i_0 \in I$. Note that $I$ is nonempty as the limit is directed.
For convenience we write $S_0 = S_{i_0}$ and $i_0 = 0$.
For any $s \in S$ we may choose an affine open
$U_0 \subset S_0$ containing $f_0(s)$. Since $S$ is quasi-affine
we may choose an element $a_s \in \Gamma(S, \mathcal{O}_S)$ such
that $s \in D(a_s) \subset f_0^{-1}(U_0)$, and such that
$D(a_s)$ is affine. By Lemma \ref{lemma-descend-section}
there exists an $i \geq 0$ such that $a_s$
comes from an element $a_{s, i} \in \Gamma(S_i, \mathcal{O}_{S_i})$.
For any index $j \geq i$ we denote $a_{s, j}$
the image of $a_{s, i}$ in the global sections of the
structure sheaf of $S_j$.
Consider the opens $D(a_{s, j}) \subset S_j$
and $U_j = f_{j0}^{-1}(U_0)$. Note that
$U_j$ is affine and $D(a_{s, j})$ is a quasi-compact open of $S_j$,
see Properties, Lemma \ref{properties-lemma-affine-cap-s-open}
for example. Hence we may apply Lemma \ref{lemma-descend-opens} to the opens
$U_j$ and $U_j \cup D(a_{s, j})$ to conclude that
$D(a_{s, j}) \subset U_j$ for some  $j \geq i$.
For such an index $j$ we see that $D(a_{s, j}) \subset S_j$ is an affine open
(because $D(a_{s, j})$ is a standard affine open of the affine open $U_j$)
containing the image $f_j(s)$.

\medskip\noindent
We conclude that for every $s \in S$ there exist
an index $i(s) \in I$, and a global section
$a_s \in \Gamma(S_{i(s)}, \mathcal{O}_{S_{i(s)}})$
such that $D(a_s) \subset S_{i(s)}$ is an affine open
containing $f_i(s)$. Because $S$ is quasi-compact we
may choose a single index $i \in I$ and global sections
$a_1, \ldots, a_m \in \Gamma(S_i, \mathcal{O}_{S_i})$
such that each $D(a_j) \subset S_i$ is affine open
and such that $f_i : S \to S_i$ has image contained
in the union $W_i = \bigcup_{j = 1, \ldots, m} D(a_j)$.
For $i' \geq i$ set $W_{i'} = f_{i'i}^{-1}(W_i)$.
Since $f_i^{-1}(W_i)$ is all of $S$ we see
(by Lemma \ref{lemma-descend-opens} again)
that for a suitable $i' \geq i$ we
have $S_{i'} = W_{i'}$. Thus we may replace $i$ by
$i'$ and assume that $S_i = \bigcup_{j = 1, \ldots, m} D(a_j)$.
This implies that $\mathcal{O}_{S_i}$ is an ample invertible
sheaf on $S_i$ (see Properties, Definition \ref{properties-definition-ample})
and hence that $S_i$ is quasi-affine, see
Properties, Lemma \ref{properties-lemma-quasi-affine-O-ample}.
Hence we win.
\end{proof}

\begin{lemma}
\label{lemma-limit-affine}
Let $I$ be a directed partially ordered set.
Let $(S_i, f_{ii'})$ be an inverse system of
schemes over $I$. Assume
\begin{enumerate}
\item all the morphisms $f_{ii'} : S_i \to S_{i'}$ are affine,
\item all the schemes $S_i$ are quasi-compact and quasi-separated, and
\item the limit $S = \text{lim}_i\ S_i$ is affine.
\end{enumerate}
Then for some $i_0 \in I$ the schemes $S_i$ for $i \geq i_0$
are affine.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-limit-quasi-affine} we may assume that
$S_i$ is quasi-affine for all $i$. Set $R_i = \Gamma(S_i, \mathcal{O}_{S_i})$.
Write $S = \text{Spec}(R)$. We have $R = \text{colim}_i\ R_i$
by Lemma \ref{lemma-descend-section}.
Write $\overline{S_i} = \text{Spec}(R_i)$, so that also
$S = \text{lim}_i\ \overline{S_i}$. Let $Z_i \subset \overline{S_i}$
be the reduced closed subscheme such that
$\overline{S_i} = Z_i \coprod S_i$ (see Schemes,
Definition \ref{schemes-definition-reduced-induced-scheme}).
We have to show that $Z_i$ is empty for some $i$.
Assume $Z_i$ is nonempty for all $i$ to get a contradiction.
Note that $Z_i$ is affine. Hence Lemma \ref{lemma-limit-nonempty} applies
and we conclude that $\text{lim}_i\ Z_i$ is nonempty.
But a point of $\text{lim}\ Z_i$ corresponds to a point of
$S = \text{lim}_i\ S_i$ which is a contradiction.
\end{proof}

\begin{lemma}
\label{lemma-quasi-affine-finite-type-over-Z}
Let $W$ be a quasi-affine scheme of finite type over
$\mathbf{Z}$. Suppose $W \to \text{Spec}(R)$ is an
open immersion into an affine scheme. There exists a
finite type $\mathbf{Z}$-algebra $A \subset R$
which induces an open immersion $W \to \text{Spec}(A)$.
Moreover, $R$ can be written as a filtered colimit
of such algebras.
\end{lemma}

\begin{proof}
Choose an affine open covering $W = \bigcup_{i = 1, \ldots, n} W_i$
such that each $W_i$ is a standard affine open in $\text{Spec}(R)$.
In other words, if we write $W_i = \text{Spec}(R_i)$
then $R_i = R_{f_i}$ for some $f_i \in R$.
Choose finitely many $x_{ij} \in R_i$ which generate
$R_i$ over $\mathbf{Z}$.
Pick an $N \gg 0$ such that each $f_i^Nx_{ij}$ comes from an
element of $R$, say $y_{ij} \in R$.
Set $A$ equal to the $\mathbf{Z}$-algebra generated by
the $f_i$ and the $y_{ij}$ and (optionally) finitely many
additional elements of $R$. Then $A$ works. Details omitted.
\end{proof}

\begin{lemma}
\label{lemma-diagram-localize}
Suppose given a cartesian diagram of rings
$$
\xymatrix{
B \ar[r]_s & R \\
B'\ar[u] \ar[r] & R' \ar[u]_{t}
}
$$
Suppose $h \in B'$ corresponds to $g \in B$
and $f \in R'$ are such that $s(g) = t(f)$.
Then the diagram
$$
\xymatrix{
B_g \ar[r]_-s & R_{s(g)} = R_{t(f)} \\
(B')_h \ar[u] \ar[r] & (R')_f \ar[u]_{t}
}
$$
is cartesian too.
\end{lemma}

\begin{proof}
Note that $B' = \{(b, r') \in B \times R' \mid s(b) = t(r')\}$.
So $h = (g, f) \in B'$. First we show that $(B')_h$ maps
injectively into $B_g \times (R')_f$. Namely, suppose that
$(x, y)/h^n$ maps to zero. This means that
$(g^Nx, f^Ny)$ is zero for some $N$. Which clearly implies
that $x/g^n$ and $y/f^n$ are both zero.
Next, suppose that $x/g^n$ and $y/f^m$ are elements
which map to the same element of $R_{s(g)}$.
This means that $s(g)^N(t(f)^ms(x) - s(g)^nt(y)) = 0$ in $R'$
for some $N \gg 0$. We can rewrite this as
$s(g^{m + N}x) = t(f^{n + N}y)$. Hence we see that the
pair $(x/g^n, y/f^m)$ is the image of the element
$(g^{m + N}x, t(f^{n + N}y)/(g, f)^{n + m + N}$ of
$(B')_h$.
\end{proof}

\begin{lemma}
\label{lemma-diagram}
Suppose given a cartesian diagram of rings
$$
\xymatrix{
B \ar[r]_s & R \\
B'\ar[u] \ar[r] & R' \ar[u]_{t}
}
$$
Let $W' \subset \text{Spec}(R')$ be an open of
the form $W' = D(f_1) \cup \ldots \cup D(f_n)$
such that $t(f_i) = s(g_i)$ for some $g_i \in B$
and $B_{g_i} \cong R_{s(g_i)}$. Then $B' \to R'$
induces an open immersion of $W'$ into $\text{Spec}(B')$.
\end{lemma}

\begin{proof}
Set $h_i = (g_i, f_i) \in B'$.
Lemma \ref{lemma-diagram-localize} above shows that
$(B')_{h_i} \cong (R')_{f_i}$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-approximate}
Let $S$ be a quasi-compact and quasi-separated scheme.
There exist a directed partially ordered set $I$
and an inverse system of schemes $(S_i, f_{ii'})$ over $I$
such that
\begin{enumerate}
\item the transition morphisms $f_{ii'}$ are affine
\item each $S_i$ is of finite type over $\mathbf{Z}$, and
\item $S = \text{lim}_i\ S_i$.
\end{enumerate}
\end{lemma}

\begin{proof}
Choose an affine open covering $S = \bigcup_{j = 1, \ldots, m} U_j$
with $m$ minimal. We will prove the lemma by induction on $m$.
The lemma is obvious when $m = 1$ since any ring is the
directed colimit of its finitely generated $\mathbf{Z}$-subalgebras.

\medskip\noindent
Thus we may assume that $S = U \cup V$ with $U$, $V$ quasi-compact
opens, $U$ affine and such that $V = \text{lim}_i\ V_i$ with
each $V_i$ of finite type over $\mathbf{Z}$. Set $W = U \cap V$.
By Lemma \ref{lemma-descend-opens}
(and after shrinking $I$) we may assume that there exists
an open $W_i \subset V_i$ such that $f_{ij}^{-1}(W_j) = W_i$
and such that $f_i^{-1}(W_i) = W$. Since $W = U \cap V$
is quasi-affine we may assume (after shrinking $I$)
that $W_i$ is quasi-affine for all $i$, see
Lemma \ref{lemma-limit-quasi-affine}.

\medskip\noindent
Write $U = \text{Spec}(B)$. Write $R = \Gamma(W, \mathcal{O}_W)$.
We can find a finite covering $W = \bigcup_{j = 1, \ldots, m} W_j$
such that each $W_j \subset W \subset U$ is a standard affine
open. Say $W_j = \text{Spec}(B_{g_j})$ for some $g_j \in B$.

\medskip\noindent
Write $R_i = \Gamma(W_i, \mathcal{O}_{W_i})$.
By Lemma \ref{lemma-descend-section} we have $R = \text{colim}_i\ R_i$.
Now we have the maps of rings
$$
\xymatrix{
B \ar[r]_s & R \\
& R_i \ar[u]_{t_i}
}
$$
We set $B_i = \{(b, r) \in B \times R_i \mid s(b) = t_i(t)\}$.
We can (after shrinking $I$) assume that the elements
$s(g_j) \in R$ come from $g_{j, i} \in R_i$, i.e., that
$s(g_j) = t_i(g_{j, i})$. Of course we choose the $g_{j, i}$
such that $g_{j, i}$ maps to $g_{j, i'}$ under the transition mappings.
Then, by Lemmas \ref{lemma-limit-affine} and \ref{lemma-descend-opens}
we can assume the corresponding
opens $D(g_{j, i}) \subset W_i$, $j = 1, \ldots, m$
are affine and cover $W_i$.

\medskip\noindent
At this point we may apply Lemma \ref{lemma-diagram}
to conclude that the morphism
$W_i \to \text{Spec}(R_i) \to \text{Spec}(B_i)$
is an open immersion.
By Lemma \ref{lemma-quasi-affine-finite-type-over-Z}
we can write $B_i$ as a directed limit of subalgebras
$A_{i, l} \subset B_i$, $l \in L_i$
of finite type over $\mathbf{Z}$ such that $W_i$ is
identified with an open subscheme of $\text{Spec}(A_{i, l})$
for all $l \in L_i$.
Let $S_{i, l}$ be the scheme obtained by glueing
$V_i$ and $\text{Spec}(A_{i, l})$ along the open $W_i$, see
Schemes, Section \ref{schemes-section-glueing-schemes}.
Note that $S_{i, l}$ is of finite type over $\mathbf{Z}$ since
it has a finite affine open covering whose members are
spectram of finite type $\mathbf{Z}$-algebras.
We define a partial ordering on $J = \coprod_{i \in I} L_i$
by the rule $(i', l') \geq (i, l)$ if and only if
$i' \geq i$ and the map $B_i \to B_{i'}$ sends $A_{i, l}$ into
$A_{i', l'}$. This is exactly the condition needed to
define a morphism $S_{i', l'} \to S_{i, l}$: namely just glue
the transition morphism $V_{i'} \to V_i$ to the morphism
$\text{Spec}(A_{i', l'}) \to \text{Spec}(A_{i, l})$ induced
by the ring map $A_{i, l} \to A_{i', l'}$. We omit the verification
that these morphisms agree agree over $W_{i'}$ as a morphism
into $S_{i, l}$.
It is easy to show that $S$ is the directed limit
of the schemes $S_{i, l}$ as desired.
\end{proof}











\input{chapters}

\bibliography{my}
\bibliographystyle{alpha}

\end{document}
