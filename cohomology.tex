\input{preamble}

% OK, start here.
%
\begin{document}

\title{Cohomology of Sheaves}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this document we work out some topics on cohomology of sheaves.
We work out what happens for sheaves on sites
as well, allthough we will simply duplicate the discussion,
and have sections detailing the constructions in the topological
case and in the case of sites.
Basic references are \cite{SGA4}, \cite{Godement} and \cite{Iversen}.

\section{Topics}
\label{section-topics}

\noindent
Here are some topics that should be discussed in this chapter.
\begin{enumerate}
\item Definition of cohomology of an abelian sheaf.
\item Definition of cohomology of a sheaf of modules and
how it is the same as the cohomology of the underlying abelian sheaf.
\item Hypercohomology.
\item Ext-groups.
\item Ext sheaves.
\item Tor functors.
\item Higher direct images.
\item Derived pullback.
\item Cup-product.
\item Group cohomology.
\item Comparison of group cohomology and cohomology on $\mathcal{T}_G$.
\item Cech cohomology.
\item Cech to cohomology spectral sequence.
\item Leray Spectral sequence.
\item Etc, etc, etc.
\end{enumerate}



\section{Cohomology of sheaves}
\label{section-cohomology-sheaves}

\noindent
Let $X$ be a topological space.
Let $\mathcal{F}$ be a abelian sheaf.
We know that the category of abelian sheaves on $X$ has enough injectives,
see Injectives, Lemma \ref{injectives-lemma-abelian-sheaves-space}.
Hence we can choose an injective resolution
$\mathcal{F}[0] \to \mathcal{I}^\bullet$.
As is customary we define
$$
H^i(X, \mathcal{F}) = H^i(\Gamma(X, \mathcal{I}^\bullet))
$$
to be the {\it $i$th cohomology group of the abelian sheaf $\mathcal{F}$}.

\medskip\noindent
We want to generalize this just a little bit. Namely, suppose that $X$
is a ringed space. (The case of abelian sheaves will be included
by thinking about the case $\mathcal{O}_X = \underline{\mathbf{Z}}_X$.)
By Homology, Remark \ref{homology-remark-big-abelian-category} there exists a
localization functor
$$
j = j_X : K^{+}(\textit{Mod}(\mathcal{O}_X))
\longrightarrow
D^{+}(\textit{Mod}(\mathcal{O}_X)).
$$
To ease notation we are going to write
$$
K^{+}(X) = K^{+}(\textit{Mod}(\mathcal{O}_X))
\quad
\text{and}
\quad
D^{+}(X) = D^{+}(\textit{Mod}(\mathcal{O}_X)).
$$
Given a ring $R$ we similarly write
$$
K^{+}(R) = K^{+}(\text{Mod}(R))
\quad
\text{and}
\quad
D^{+}(R) = D^{+}(\text{Mod}(R))
$$
and we denote $j_R : K^{+}(R) \to D^{+}(R)$ the localization functor.
For any left exact functor $F : \textit{Mod}(\mathcal{O}_X) \to \mathcal{B}$
into any abelian category $\mathcal{B}$ we will denote $RF$ the
right derived functor constructed in
Homology, Section \ref{homology-section-right-derived-functor}
using the localization functor $j$ just described.
Note that we may think of $RF$ as defined on $\textit{Mod}(\mathcal{O}_X)$,
$\text{Comp}^{+}(\textit{Mod}(\mathcal{O}_X))$,
$K^{+}(X)$, or $D^{+}(X)$
depending on the situation. In addition, whenever possible
we actually think of $RF$ as a functor into $D^{+}(\mathcal{B})$, see
Homology, Remark \ref{homology-remark-right-derived-functor}.

\medskip\noindent
In particular, we have
$
\Gamma(X, -) :
\textit{Mod}(\mathcal{O}_X)
\longrightarrow
\text{Mod}(\mathcal{O}_X(X))
$
which gives rise to
$$
R\Gamma(X, -) :
D^{+}(X)
\longrightarrow
D^{+}(\mathcal{O}_X(X))
$$
and $H^i(X, -) = R^i\Gamma(X, -)$. Slightly more generally, for any open
$U \subset X$ we have
$
\Gamma(U, -) :
\textit{Mod}(\mathcal{O}_X)
\longrightarrow
\text{Mod}(\mathcal{O}_X(U))
$
which gives rise to
$$
R\Gamma(U, -) :
D^{+}(X)
\longrightarrow
D^{+}(\mathcal{O}_X(U))
$$
and $H^i(U, -) = R^i\Gamma(U, -)$.
If $f : X \to Y$ is a morphism of ringed spaces, then we have
the functor
$
f_* :
\textit{Mod}(\mathcal{O}_X)
\longrightarrow
\textit{Mod}(\mathcal{O}_Y)
$
which gives rise to
$$
Rf_* :
D^{+}(X)
\longrightarrow
D^{+}(Y)
$$
and $R^if_*$. These are called the
{\it derived pushforward} and the {\it higher direct images} respectively.
Each of the displayed functors above is an exact functor
of derived categories.

\medskip\noindent
{\bf Abuse of notation:} When the functor $Rf_*$, or any other
derived functor, is applied to a sheaf $\mathcal{F}$ on $X$ or a complex
of sheaves it is understood that the localization functor $j_X$ has
been applied first, i.e., that $\mathcal{F}$ has been replaced by an
injective resolution of $\mathcal{F}$. To facilitate this kind of
operation we will say, given an object $\mathcal{I}^\bullet \in D^{+}(X)$,
that a bounded below complex $\mathcal{F}^\bullet$ of
$\textit{Mod}(\mathcal{O}_X)$
{\it represents $\mathcal{I}^\bullet$ in the derived category}
if there exists a quasi-isomorphism
$\mathcal{F}^\bullet \to \mathcal{I}^\bullet$. In the same vein the phrase
``let $\alpha : \mathcal{F}^\bullet \to \mathcal{G}^\bullet$ be
a morphism of $D^{+}(X)$'' is declared to be synonymous to
``let $\alpha : j_X(\mathcal{F}^\bullet) \to j_X(\mathcal{G}^\bullet)$
be a morphism of $D^{+}(X)$''. In other words, it need not be the
case that $\alpha$ is represented by a morphism of complexes. If we have
an actual morphism of complexes we will say so.








\section{Local vanishing}
\label{section-local-vanishing}

\noindent
The following lemma says there is no ambguity in defining the cohomology
of a sheaf $\mathcal{F}$ over an open.

\begin{lemma}
\label{lemma-cohomology-of-open}
Let $X$ be a ringed space.
Let $U \subset X$ be an open subspace.
\begin{enumerate}
\item If $\mathcal{I}$ is an injective $\mathcal{O}_X$-module
then $\mathcal{I}|_U$ is an injective $\mathcal{O}_U$-module.
\item For any sheaf of $\mathcal{O}_X$-modules $\mathcal{F}$ we have
$H^p(U, \mathcal{F}) = H^p(U, \mathcal{F}|_U)$.
\end{enumerate}
\end{lemma}

\begin{proof}
Denote $j : U \to X$ the open immersion.
Recall that the functor $j^{-1}$ of restriction to $U$ is a right adjoint
to the functor $j_!$ of extension by $0$, see
Sheaves, Lemma \ref{sheaves-lemma-j-shriek-modules}.
Moreover, $j_!$ is exact. Hence (1) follows from
Homology, Lemma \ref{homology-lemma-adjoint-preserve-injectives}.

\medskip\noindent
By definition $H^p(U, \mathcal{F}) = H^p(\Gamma(U, \mathcal{I}^\bullet))$
where $\mathcal{F} \to \mathcal{I}^\bullet$ is an injective resolution
in $\textit{Mod}(\mathcal{O}_X)$.
By the above we see that $\mathcal{F}|_U \to \mathcal{I}^\bullet|_U$
is an injective resolution in $\textit{Mod}(\mathcal{O}_U)$.
Hence $H^p(U, \mathcal{F}|_U)$ is equal to
$H^p(\Gamma(U, \mathcal{I}^\bullet|_U))$.
Of course $\Gamma(U, \mathcal{F}) = \Gamma(U, \mathcal{F}|_U)$ for
any sheaf $\mathcal{F}$ on $X$.
Hence the equality
in (2).
\end{proof}

\noindent
Let $X$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
Let $U \subset V \subset X$ be open subsets.
Then there is a canonical {\it restriction mapping}
\begin{equation}
\label{equation-restriction-mapping}
H^n(V, \mathcal{F})
\longrightarrow
H^n(U, \mathcal{F}), \quad
\xi \longmapsto \xi|_U
\end{equation}
functorial in $\mathcal{F}$. Namely, choose any injective
resolution $\mathcal{F} \to \mathcal{I}^\bullet$. The restriction
mappings of the sheaves $\mathcal{I}^p$ give a morphism of complexes
$$
\Gamma(V, \mathcal{I}^\bullet)
\longrightarrow
\Gamma(U, \mathcal{I}^\bullet)
$$
The LHS is a complex representing $R\Gamma(V, \mathcal{F})$
and the RHS is a complex representing $R\Gamma(U, \mathcal{F})$.
We get the map on cohomology groups by applying the functor $H^n$.
As indicated we will use the notation $\xi \mapsto \xi|_U$ to denote this map.
Thus the rule $U \mapsto H^n(U, \mathcal{F})$ is a presheaf of
$\mathcal{O}_X$-modules. This presheaf is customarily denoted
$\underline{H}^n(\mathcal{F})$. We will give another interpretation 
of this presheaf in Lemma \ref{lemma-include}.

\begin{lemma}
\label{lemma-kill-cohomology-class-on-covering}
Let $X$ be a ringed space.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_X$-modules.
Let $U \subset X$ be an open subspace.
Let $n > 0$ and let $\xi \in H^n(U, \mathcal{F})$.
Then there exists an open covering
$U = \bigcup_{i\in I} U_i$ such that $\xi|_{U_i} = 0$ for
all $i \in I$.
\end{lemma}

\begin{proof}
Let $\mathcal{F} \to \mathcal{I}^\bullet$ be an injective resolution.
Then
$$
H^n(U, \mathcal{F}) = 
\frac{\text{Ker}(\mathcal{I}^n(U) \to \mathcal{I}^{n + 1}(U))}
{\text{Im}(\mathcal{I}^{n - 1}(U) \to \mathcal{I}^n(U))}.
$$
Pick an element $\tilde \xi \in \mathcal{I}^n(U)$ representing the
cohomology class in the presentation above. Since $\mathcal{I}^\bullet$
is an injective resolution of $\mathcal{F}$ and $n > 0$ we see that
the complex $\mathcal{I}^\bullet$ is exact in degree $n$. Hence
$\text{Im}(\mathcal{I}^{n - 1} \to \mathcal{I}^n) =
\text{Ker}(\mathcal{I}^n \to \mathcal{I}^{n + 1})$ as sheaves.
Since $\tilde \xi$ is a section of the kernel sheaf over $U$
we conclude there exists an open covering $U = \bigcup_{i \in I} U_i$
such that $\tilde \xi|_{U_i}$ is the image under $d$ of a section
$\xi_i \in \mathcal{I}^{n - 1}(U_i)$. By our definition of the
restriction $\xi|_{U_i}$ as corresponding to the class of
$\tilde \xi|_{U_i}$ we conclude.
\end{proof}

\begin{lemma}
\label{lemma-describe-higher-direct-images}
Let $f : X \to Y$ be a morphism of ringed spaces.
Let $\mathcal{F}$ be a $\mathcal{O}_X$-module.
The sheaves $R^if_*\mathcal{F}$ are the sheaves
associated to the presheaves
$$
V \longmapsto H^i(f^{-1}(V), \mathcal{F})
$$
with restriction mappings as in Equation (\ref{equation-restriction-mapping}).
There is a similar statement for $R^if_*$ applied to a
bounded below complex $\mathcal{F}^\bullet$.
\end{lemma}

\begin{proof}
Let $\mathcal{F} \to \mathcal{I}^\bullet$ be an injective resolution.
Then $R^if_*\mathcal{F}$ is by definition the $i$th cohomology sheaf
of the complex
$$
f_*\mathcal{I}^0 \to f_*\mathcal{I}^1 \to f_*\mathcal{I}^2 \to \ldots
$$
By definition of the abelian category structure on $\mathcal{O}_Y$-modules
this cohomology sheaf is the sheaf associated to the presheaf
$$
V
\longmapsto
\frac{\text{Ker}(f_*\mathcal{I}^i(V) \to f_*\mathcal{I}^{i + 1}(V))}
{\text{Im}(f_*\mathcal{I}^{i - 1}(V) \to f_*\mathcal{I}^n(V))}
$$
and this is obviously equal to
$$
\frac{\text{Ker}(\mathcal{I}^i(f^{-1}(V)) \to \mathcal{I}^{i + 1}(f^{-1}(V)))}
{\text{Im}(\mathcal{I}^{i - 1}(f^{-1}(V)) \to \mathcal{I}^n(f^{-1}(V)))} \\
$$
which is equal to $H^i(f^{-1}(V), \mathcal{F})$
and we win.
\end{proof}






























\section{The Cech complex and Cech cohomology}
\label{section-cech}

\noindent
Let $X$ be a topological space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$ be an open covering,
see Topology, Basic notion (\ref{topology-item-covering}).
As is customary we denote
$U_{i_0\ldots i_p} = U_{i_0} \cap \ldots \cap U_{i_p}$ for the
$(p + 1)$-fold intersection of members of $\mathcal{U}$.
Let $\mathcal{F}$ be an abelian presheaf on $X$.
Set
$$
\check{\mathcal{C}}^p(\mathcal{U}, \mathcal{F})
=
\prod\nolimits_{(i_0, \ldots, i_p) \in I^{p + 1}}
\mathcal{F}(U_{i_0\ldots i_p}).
$$
This is an abelian group. For
$s \in \check{\mathcal{C}}^p(\mathcal{U}, \mathcal{F})$ we denote
$s_{i_0\ldots i_p}$ its value in $\mathcal{F}(U_{i_0\ldots i_p})$.
Note that if $s \in \check{\mathcal{C}}^2(\mathcal{U}, \mathcal{F})$
and $i, j \in I$ then $s_{ij}$ and $s_{ji}$ are both elements
of $\mathcal{F}(U_i \cap U_j)$ but there is no imposed
relation between $s_{ij}$ and $s_{ji}$. In other words, we are {\it not}
working with alternating cochains (these will be defined
in Section \ref{section-alternating-cech}). We define
$$
d : \check{\mathcal{C}}^p(\mathcal{U}, \mathcal{F})
\longrightarrow
\check{\mathcal{C}}^{p + 1}(\mathcal{U}, \mathcal{F})
$$
by the formula
\begin{equation}
\label{equation-d-cech}
d(s)_{i_0\ldots i_{p + 1}}
=
\sum\nolimits_{j = 0}^{p + 1}
(-1)^j
s_{i_0\ldots \hat i_j \ldots i_p}|_{U_{i_0\ldots i_{p + 1}}}
\end{equation}
It is straightforward to see that $d \circ d = 0$. In other words
$\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})$ is a complex.

\begin{definition}
\label{definition-cech-complex}
Let $X$ be a topological space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$ be an open covering.
Let $\mathcal{F}$ be an abelian presheaf on $X$.
The complex $\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})$
is the {\it Cech complex} associated to $\mathcal{F}$ and the
open covering $\mathcal{U}$. Its cohomology groups
$H^i(\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F}))$ are
called the {\it Cech cohomology groups} associated to
$\mathcal{F}$ and the covering $\mathcal{U}$.
They are denoted $\check H^i(\mathcal{U}, \mathcal{F})$.
\end{definition}

\begin{lemma}
\label{lemma-cech-h0}
Let $X$ be a topological space.
Let $\mathcal{F}$ be an abelian presheaf on $X$.
The following are equivalent
\begin{enumerate}
\item $\mathcal{F}$ is an abelian sheaf and
\item for every open covering $\mathcal{U} : U = \bigcup_{i \in I} U_i$
the natural map
$\mathcal{F}(U) \to \check{H}^0(\mathcal{U}, \mathcal{F})$
is bijective.
\end{enumerate}
\end{lemma}

\begin{proof}
This is true since the sheaf condition is exactly that
$\mathcal{F}(U) \to \check{H}^0(\mathcal{U}, \mathcal{F})$
is bijective for every open covering.
\end{proof}






\section{Cech cohomology as a functor on presheaves}
\label{section-cech-functor}

\noindent
Warning: In this section we work almost exclusively with presheaves and
categories of presheaves and the results are completely wrong in the
setting of sheaves and categories of sheaves!

\medskip\noindent
Let $X$ be a ringed space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$ be an open covering.
Let $\mathcal{F}$ be a presheaf of $\mathcal{O}_X$-modules.
We have the Cech complex
$\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})$
of $\mathcal{F}$ just by thinking of $\mathcal{F}$
as a presheaf of abelian groups. However, each term
$\check{\mathcal{C}}^p(\mathcal{U}, \mathcal{F})$ has a natural
structure of a $\mathcal{O}_X(U)$-module and the differential is given by
$\mathcal{O}_X(U)$-module maps. Moreover, it is clear that the
construction
$$
\mathcal{F} \longmapsto \check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})
$$
is functorial in $\mathcal{F}$. In fact, it is a functor
\begin{equation}
\label{equation-cech-functor}
\check{\mathcal{C}}^\bullet(\mathcal{U}, -) :
\textit{PMod}(\mathcal{O}_X)
\longrightarrow
\text{Comp}^{+}(\text{Mod}(\mathcal{O}_X(U)))
\end{equation}
see Homology, Definition \ref{homology-definition-complexes-notation}
for notation. Recall that the category of bounded below complexes
in an abelian category is an abelian category, see
Homology, Lemma \ref{homology-lemma-cat-cochain-abelian}.

\begin{lemma}
\label{lemma-cech-exact-presheaves}
The functor given by Equation (\ref{equation-cech-functor})
is an exact functor (see Homology, Lemma \ref{homology-lemma-exact-functor}).
\end{lemma}

\begin{proof}
For any open $W \subset U$ the functor
$\mathcal{F} \mapsto \mathcal{F}(W)$ is an additive exact functor
from $\text{PMod}(\mathcal{O}_X)$ to $\text{Mod}(\mathcal{O}_X(U))$.
The terms
$\check{\mathcal{C}}^p(\mathcal{U}, \mathcal{F})$
of the complex are products of these exact functors and hence exact.
Moreover a sequence of complexes is exact if and only if the sequence
of terms in a given degree is exact. Hence the lemma follows.
\end{proof}

\begin{lemma}
\label{lemma-cech-cohomology-delta-functor-presheaves}
Let $X$ be a ringed space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$ be an open covering.
The functors $\mathcal{F} \mapsto \check{H}^n(\mathcal{U}, \mathcal{F})$
form a $\delta$-functor from the abelian category of
presheaves of $\mathcal{O}_X$-modules to the category
of $\mathcal{O}_X(U)$-modules (see
Homology, Definition \ref{homology-definition-cohomological-delta-functor}).
\end{lemma}

\begin{proof}
By the previous lemma a short exact sequence of presheaves of
$\mathcal{O}_X$-modules
$0 \to \mathcal{F}_1 \to \mathcal{F}_2 \to \mathcal{F}_3 \to 0$
is turned into a short exact sequence of complexes of
$\mathcal{O}_X(U)$-modules. Hence we can use
Homology, Lemma \ref{homology-lemma-long-exact-sequence-cochain}
to get the boundary maps
$\delta_{\mathcal{F}_1 \to \mathcal{F}_2 \to \mathcal{F}_3} :
\check{H}^n(\mathcal{U}, \mathcal{F}_3) \to 
\check{H}^{n + 1}(\mathcal{U}, \mathcal{F}_1)$
and a corresponding long exact sequence. We omit the verification
that these maps are compatible with maps between short exact
sequences of presheaves.
\end{proof}


\noindent
In the formulation of the following lemma we use the functor $j_{p!}$ of
extension by $0$ for presheaves of modules
relative to an open immersion $j : U \to X$.
See Sheaves, Section \ref{sheaves-section-open-immersions}. For any open
$W \subset X$ and any presheaf $\mathcal{G}$ of $\mathcal{O}_X|_U$-modules
we have
$$
(j_{p!}\mathcal{G})(W) = 
\left\{
\begin{matrix}
\mathcal{G}(W) & \text{if } W \subset U \\
0 & \text{else.}
\end{matrix}
\right.
$$
Moreover, the functor $j_{p!}$ is a left adjoint to the restriction functor
see Sheaves, Lemma \ref{sheaves-lemma-j-shriek-modules}.
In particular we have the following formula
$$
\text{Hom}_{\mathcal{O}_X}(j_{p!}\mathcal{O}_U, \mathcal{F})
=
\text{Hom}_{\mathcal{O}_U}(\mathcal{O}_U, \mathcal{F}|_U)
=
\mathcal{F}(U).
$$
Since the functor $\mathcal{F} \mapsto \mathcal{F}(U)$ is an exact functor
on the category of presheaves we conclude that the presheaf
$j_{p!}\mathcal{O}_U$ is a projective object in the category
$\textit{PMod}(\mathcal{O}_X)$, see
Homology, Lemma \ref{homology-lemma-characterize-projectives}.

\medskip\noindent
Note that if we are given open subsets $U \subset V \subset X$
with associated open immersions $j_U, j_V$, then we have a canonical
map $(j_U)_{p!}\mathcal{O}_U \to (j_V)_{p!}\mathcal{O}_V$. It is the
identity on sections over any open $W \subset U$ and $0$ else.
In terms of the identification
$\text{Hom}_{\mathcal{O}_X}((j_U)_{p!}\mathcal{O}_U, (j_V)_{p!}\mathcal{O}_V) =
(j_V)_{p!}\mathcal{O}_V(U) = \mathcal{O}_V(U)$ it corresponds to
the element $1 \in \mathcal{O}_V(U)$.

\begin{lemma}
\label{lemma-cech-map-into}
Let $X$ be a ringed space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$ be a covering.
Denote $j_{i_0\ldots i_p} : U_{i_0 \ldots i_p} \to X$ the open immersion.
Consider the chain complex $K(\mathcal{U})_\bullet$
of presheaves of $\mathcal{O}_X$-modules
$$
\ldots
\to
\bigoplus_{i_0i_1i_2} (j_{i_0i_1i_2})_{p!}\mathcal{O}_{U_{i_0i_1i_2}}
\to
\bigoplus_{i_0i_1} (j_{i_0i_1})_{p!}\mathcal{O}_{U_{i_0i_1}}
\to
\bigoplus_{i_0} (j_{i_0})_{p!}\mathcal{O}_{U_{i_0}}
\to 0 \to \ldots
$$
where the last nonzero term is placed in degree $0$
and where the map
$$
(j_{i_0\ldots i_{p + 1}})_{p!}\mathcal{O}_{U_{i_0\ldots i_{p + 1}}}
\longrightarrow
(j_{i_0\ldots \hat i_j \ldots i_{p + 1}})_{p!}
\mathcal{O}_{U_{i_0\ldots \hat i_j \ldots i_{p + 1}}}
$$
is given by $(-1)^j$ times the canonical map.
Then there is an isomorphism
$$
\text{Hom}_{\mathcal{O}_X}(K(\mathcal{U})_\bullet, \mathcal{F})
=
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})
$$
functorial in $\mathcal{F} \in \text{Ob}(\textit{PMod}(\mathcal{O}_X))$.
\end{lemma}

\begin{proof}
We saw in the discussion just above the lemma that
$$
\text{Hom}_{\mathcal{O}_X}(
(j_{i_0\ldots i_p})_{p!}\mathcal{O}_{U_{i_0\ldots i_p}},
\mathcal{F})
=
\mathcal{F}(U_{i_0\ldots i_p}).
$$
Hence we see that it is indeed the case that the direct sum
$$
\bigoplus\nolimits_{i_0 \ldots i_p}
(j_{i_0 \ldots i_p})_{p!}\mathcal{O}_{U_{i_0 \ldots i_p}}
$$
represents the functor
$$
\mathcal{F}
\longmapsto
\prod\nolimits_{i_0\ldots i_p} \mathcal{F}(U_{i_0\ldots i_p}).
$$
Hence by Categories, Yoneda Lemma \ref{categories-lemma-yoneda}
we see that there is a complex $K(\mathcal{U})_\bullet$ with terms
as given. It is a simple matter to see that the maps are as given
in the lemma.
\end{proof}

\begin{lemma}
\label{lemma-homology-complex}
Let $X$ be a ringed space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$ be a covering.
Let $\mathcal{O}_{\mathcal{U}} \subset \mathcal{O}_X$
be the image presheaf of the map
$\bigoplus j_{p!}\mathcal{O}_{U_i} \to \mathcal{O}_X$.
The chain complex $K(\mathcal{U})_\bullet$ of presheaves
of Lemma \ref{lemma-cech-map-into} above has homology presheaves
$$
H_i(K(\mathcal{U})_\bullet) =
\left\{
\begin{matrix}
0 & \text{if} & i \not = 0 \\
\mathcal{O}_{\mathcal{U}} & \text{if} & i = 0
\end{matrix}
\right.
$$
\end{lemma}

\begin{proof}
Consider the extended complex $K^{ext}_\bullet$ one gets by putting
$\mathcal{O}_{\mathcal{U}}$ in degree $-1$ with the obvious map
$K(\mathcal{U})_0 =
\bigoplus_{i_0} (j_{i_0})_{p!}\mathcal{O}_{U_{i_0}} \to
\mathcal{O}_{\mathcal{U}}$.
It suffices to show that taking sections of this extended complex over
any open $W \subset X$ leads to an acyclic complex.
In fact, we claim that for every $W \subset X$ the complex
$K^{ext}_\bullet(W)$ is homotopy equivalent to the zero complex.
Write $I = I_1 \sqcup I_2$ where $W \subset U_i$ if and only
if $i \in I_1$.

\medskip\noindent
If $I_1 = \emptyset$, then the complex $K^{ext}_\bullet(W) = 0$ so there is
nothing to prove.

\medskip\noindent
If $I_1 \not = \emptyset$, then
$\mathcal{O}_{\mathcal{U}}(W) = \mathcal{O}_X(W)$
and
$$
K^{ext}_p(W) =
\bigoplus\nolimits_{i_0 \ldots i_p \in I_1} \mathcal{O}_X(W).
$$
This is true because of the simple description of the presheaves
$(j_{i_0 \ldots i_p})_{p!}\mathcal{O}_{U_{i_0 \ldots i_p}}$.
Moreover, the differential of the complex $K^{ext}_\bullet(W)$
is given by
$$
d(s)_{i_0 \ldots i_p} =
\sum\nolimits_{j = 0, \ldots, p + 1} \sum\nolimits_{i \in I_1}
(-1)^j s_{i_0 \ldots i_{j - 1} i i_j \ldots i_p}.
$$
The sum is finite as the element $s$ has finite support.
Fix an element $i_{\text{fix}} \in I_1$. Define a map
$$
h : K^{ext}_p(W) \longrightarrow K^{ext}_{p + 1}(W)
$$
by the rule
$$
h(s)_{i_0 \ldots i_{p + 1}} =
\left\{
\begin{matrix}
0 & \text{if} & i_0 \not = i \\
s_{i_1 \ldots i_{p + 1}} & \text{if} & i_0 = i_{\text{fix}}
\end{matrix}
\right.
$$
We will use the shorthand
$h(s)_{i_0 \ldots i_{p + 1}} = (i_0 = i_{\text{fix}}) s_{i_1 \ldots i_p}$
for this. Then we compute
\begin{eqnarray*}
& & (dh + hd)(s)_{i_0 \ldots i_p} \\
& = &
\sum_j \sum_{i \in I_1} (-1)^j h(s)_{i_0 \ldots i_{j - 1} i i_j \ldots i_p}
+
(i = i_0) d(s)_{i_1 \ldots i_p} \\
& = &
s_{i_0 \ldots i_p} +
\sum_{j \geq 1}\sum_{i \in I_1}
(-1)^j (i_0 = i_{\text{fix}}) s_{i_1 \ldots i_{j - 1} i i_j \ldots i_p}
+
(i_0 = i_{\text{fix}}) d(s)_{i_1 \ldots i_p}
\end{eqnarray*}
which is equal to $s_{i_0 \ldots i_p}$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-cech-cohomology-derived-presheaves}
Let $X$ be a ringed space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$
be an open covering of $U \subset X$.
The Cech cohomology functors $\check{H}^p(\mathcal{U}, -)$
are canonically isomomorphic (as a $\delta$-functor) to
the right derived functors of the functor
$$
\check{H}^0(\mathcal{U}, -) :
\textit{PMod}(\mathcal{O}_X)
\longrightarrow
\text{Mod}(\mathcal{O}_X(U)).
$$
Moreover, there is a functorial quasi-isomorphism
$$
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})
\longrightarrow 
R\check{H}^0(\mathcal{U}, \mathcal{F})
$$
where the right hand side indicates the derived functor
$R\check{H}^0(\mathcal{U}, -) :
\textit{PMod}(\mathcal{O}_X)
\to
D^{+}(\mathcal{O}_X(U))$, see
Homology, Remark \ref{homology-remark-right-derived-functor}.
\end{lemma}

\begin{proof}
Note that the category of presheaves of $\mathcal{O}_X$-modules
has enough injectives, see
Injectives, Proposition \ref{injectives-proposition-presheaves-modules}.
Note that $\check{H}^0(\mathcal{U}, -)$ is a left exact functor
from the category of presheaves of $\mathcal{O}_X$-modules
to the category of $\mathcal{O}_X(U)$-modules.
Hence the derived functor and the right derived fuctor exist,
see Homology, Section \ref{homology-section-right-derived-functor}.

\medskip\noindent
Let $\mathcal{I}$ be a injective presheaf of $\mathcal{O}_X$-modules.
In this case the functor $\text{Hom}_{\mathcal{O}_X}(-, \mathcal{I})$
is exact on $\textit{PMod}(\mathcal{O}_X)$. By
Lemma \ref{lemma-cech-map-into} we have
$$
\text{Hom}_{\mathcal{O}_X}(K(\mathcal{U})_\bullet, \mathcal{I})
=
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{I}).
$$
By Lemma \ref{lemma-homology-complex} we have that $K(\mathcal{U})_\bullet$ is
quasi-isomorphic to $\mathcal{O}_{\mathcal{U}}[0]$. Hence by
the exactness of Hom into $\mathcal{I}$ mentioned above we see
that $\check{H}^i(\mathcal{U}, \mathcal{I}) = 0$ for all
$i > 0$. Thus the $\delta$-functor $(\check{H}^n, \delta)$
(see Lemma \ref{lemma-cech-cohomology-delta-functor-presheaves})
satisfies the assumptions of
Homology, Lemma \ref{homology-lemma-efface-implies-universal},
and hence is a universal $\delta$-functor.

\medskip\noindent
By Homology, Lemma \ref{homology-lemma-higher-derived-functors}
also the sequence $R^i\check{H}^0(\mathcal{U}, -)$
forms a universal $\delta$-functor. By the uniqueness of universal
$\delta$-functors, see
Homology, Lemma \ref{homology-lemma-uniqueness-universal-delta-functor}
we conclude that
$R^i\check{H}^i(\mathcal{U}, -) = \check{H}^i(\mathcal{U}, -)$.
This is enough for most applications
and the reader is suggested to skip the rest of the proof.

\medskip\noindent
Let $\mathcal{F}$ be any presheaf of $\mathcal{O}_X$-modules.
Choose an injective resolution $\mathcal{F} \to \mathcal{I}^\bullet$
in the category $\textit{PMod}(\mathcal{O}_X)$.
Consider the double complex $A^{\bullet, \bullet}$ with terms
$$
A^{p, q} =
\check{\mathcal{C}}^p(\mathcal{U}, \mathcal{I}^q).
$$
Consider the simple complex $sA^\bullet$ associated to this double
complex. There is a map of complexes
$$
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})
\longrightarrow
sA^\bullet
$$
coming from the maps
$\check{\mathcal{C}}^p(\mathcal{U}, \mathcal{F})
\to A^{p, 0} = \check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{I}^0)$
and there is a map of complexes
$$
\check{H}^0(\mathcal{U}, \mathcal{I}^\bullet)
\longrightarrow
sA^\bullet
$$
coming from the maps
$\check{H}^0(\mathcal{U}, \mathcal{I}^q) \to
A^{0, q} = \check{\mathcal{C}}^0(\mathcal{U}, \mathcal{I}^q)$.
Both of these maps are quasi-isomorphisms by an application of
Homology, Lemma \ref{homology-lemma-double-complex-gives-resolution}.
Namely, the columns of the double complex are exact in positive degrees
because the Cech complex as a functor is exact
(Lemma \ref{lemma-cech-exact-presheaves})
and the rows of the double complex are exact in positive degrees
since as we just saw the higher Cech cohomology groups of the injective
presheaves $\mathcal{I}^q$ are zero.
Since quasi-isomorphisms become invertible
in $D^{+}(\mathcal{O}_X(U))$ this gives the last displayed morphism
of the lemma. We omit the verification that this morphism is
functorial.
\end{proof}





\section{Cech cohomology and cohomology}
\label{section-cech-cohomology-cohomology}

\begin{lemma}
\label{lemma-injective-trivial-cech}
Let $X$ be a ringed space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$ be a covering.
Let $\mathcal{I}$ be an injective $\mathcal{O}_X$-module.
Then
$$
\check{H}^p(\mathcal{U}, \mathcal{I}) =
\left\{
\begin{matrix}
\mathcal{I}(U) & \text{if} & p = 0 \\
0 & \text{if} & p > 0
\end{matrix}
\right.
$$
\end{lemma}

\begin{proof}
An injective $\mathcal{O}_X$-module is also injective as an object in
the category $\textit{PMod}(\mathcal{O}_X)$ (for example since
sheafification is an exact left adjoint to the inclusion functor,
using Homology, Lemma \ref{homology-lemma-adjoint-preserve-injectives}).
Hence we can apply Lemma \ref{lemma-cech-cohomology-derived-presheaves}
(or its proof) to see the result.
\end{proof}

\begin{lemma}
\label{lemma-include}
Let $X$ be a ringed space.
Consider the inclusion functor
$i : \textit{Mod}(\mathcal{O}_X) \to \textit{PMod}(\mathcal{O}_X)$.
It is a left exact functor with right derived functors given by
$$
R^pi(\mathcal{F}) = \underline{H}^p(\mathcal{F}) :
U \longmapsto H^p(U, \mathcal{F})
$$
see discussion in Section \ref{section-local-vanishing}.
\end{lemma}

\begin{proof}
It is clear that $i$ is left exact.
Choose an injective resolution $\mathcal{F} \to \mathcal{I}^\bullet$.
By definition $R^pi$ is the $p$th cohomology {\it presheaf}
of the complex $\mathcal{I}^\bullet$. In other words, the
sections of $R^pi(\mathcal{F})$ over an open $U$ are given by
$$
\frac{\text{Ker}(\mathcal{I}^n(U) \to \mathcal{I}^{n + 1}(U))}
{\text{Im}(\mathcal{I}^{n - 1}(U) \to \mathcal{I}^n(U))}.
$$
which is the definition of $H^p(U, \mathcal{F})$.
\end{proof}

\begin{lemma}
\label{lemma-cech-spectral-sequence}
Let $X$ be a ringed space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$ be a covering.
For any sheaf of $\mathcal{O}_X$-modules $\mathcal{F}$ there
is a spectral sequence $(E_r, d_r)_{r \geq 0}$ with
$$
E_2^{p, q} = \check{H}^p(\mathcal{U}, \underline{H}^q(\mathcal{F}))
$$
converging to $H^{p + q}(U, \mathcal{F})$.
This spectral sequence is functorial in $\mathcal{F}$.
\end{lemma}

\begin{proof}
This is a Grothendieck spectral sequence
(see Homology, Lemma \ref{homology-lemma-grothendieck-spectral-sequence})
for the functors
$i :  \textit{Mod}(\mathcal{O}_X) \to \textit{PMod}(\mathcal{O}_X)$
and
$\check{H}^0(\mathcal{U}, - ) : \textit{PMod}(\mathcal{O}_X)
\to \text{Mod}(\mathcal{O}_X(U))$.
Namely, we have $\check{H}^0(\mathcal{U}, i(\mathcal{F})) = \mathcal{F}(U)$
by Lemma \ref{lemma-cech-h0}. We have that $i(\mathcal{I})$ is 
Cech acyclic by Lemma \ref{lemma-injective-trivial-cech}. And we
have that $\check{H}^p(\mathcal{U}, -) = R^p\check{H}^0(\mathcal{U}, -)$
as functors on $\textit{PMod}(\mathcal{O}_X)$
by Lemma \ref{lemma-cech-cohomology-derived-presheaves}.
Putting everything together gives the lemma.
\end{proof}

\begin{lemma}
\label{lemma-ses-cech-h1}
Let $X$ be a ringed space.
Let
$$
0 \to \mathcal{F} \to \mathcal{G} \to \mathcal{H} \to 0
$$
be a short exact sequence of $\mathcal{O}_X$-modules.
Let $U \subset X$ be an open subset.
If there exists a cofinal system of open coverings $\mathcal{U}$
of $U$ such that $\check{H}^1(\mathcal{U}, \mathcal{F}) = 0$,
then the map $\mathcal{G}(U) \to \mathcal{H}(U)$ is
surjective.
\end{lemma}

\begin{proof}
Take an element $s \in \mathcal{H}(U)$. Choose an open covering
$\mathcal{U} : U = \bigcup_{i \in I} U_i$ such that
(a) $\check{H}^1(\mathcal{U}, \mathcal{F}) = 0$ and (b)
$s|_{U_i}$ is the image of a section $s_i \in \mathcal{G}(U_i)$.
Since we can certainly find a covering such that (b) holds
it follows from the assumptions of the lemma that we can find
a covering such that (a) and (b) both hold.
Consider the sections
$$
s_{i_0i_1} = s_{i_1}|_{U_{i_0i_1}} - s_{i_0}|_{U_{i_0i_1}}.
$$
Since $s_i$ lifts $s$ we see that $s_{i_0i_1} \in \mathcal{F}(U_{i_0i_1})$.
By the vanishing of $\check{H}^1(\mathcal{U}, \mathcal{F})$ we can
find sections $t_i \in \mathcal{F}(U_i)$ such that
$$
s_{i_0i_1} = t_{i_1}|_{U_{i_0i_1}} - t_{i_0}|_{U_{i_0i_1}}.
$$
Then clearly the sections $s_i - t_i$ satsify the sheaf condition
and glue to a section of $\mathcal{G}$ over $U$ which maps to $s$.
Hence we win.
\end{proof}

\begin{lemma}
\label{lemma-cech-vanish}
Let $X$ be a ringed space.
Let $\mathcal{F}$ be an $\mathcal{O}_X$-module such that
$\check{H}^p(\mathcal{U}, \mathcal{F}) = 0$ for all $p > 0$ and
any open covering $\mathcal{U} : U = \bigcup_{i \in I} U_i$ of $X$.
Then $H^p(U, \mathcal{F}) = 0$ for all $p > 0$
and any open $U \subset X$.
\end{lemma}

\begin{proof}
Let $\mathcal{F}$ be a sheaf satisfying the assumption of the lemma.
We will indicate this by saying ``$\mathcal{F}$ has vanishing higher
Cech cohomology for any open covering''.
Choose an embedding $\mathcal{F} \to \mathcal{I}$ into an
injective $\mathcal{O}_X$-module.
By Lemma \ref{lemma-injective-trivial-cech} $\mathcal{I}$ has vanishing higher
Cech cohomology for any open covering.
Let $\mathcal{Q} = \mathcal{I}/\mathcal{F}$
so that we have a short exact sequence
$$
0 \to \mathcal{F} \to \mathcal{I} \to \mathcal{Q} \to 0.
$$
By Lemma \ref{lemma-ses-cech-h1} and our assumptions
this sequence is actually exact as a sequence of presheaves!
In particular we have a long exact sequence of Cech cohomology
groups for any open covering $\mathcal{U}$, see
Lemma \ref{lemma-cech-cohomology-delta-functor-presheaves}
for example. This implies that $\mathcal{Q}$ is also an $\mathcal{O}_X$-module
with vanishing higher Cech cohomology for all open coverings.

\medskip\noindent
Next, we look at the long exact cohomology sequence
$$
\xymatrix{
0 \ar[r] &
H^0(U, \mathcal{F}) \ar[r] &
H^0(U, \mathcal{I}) \ar[r] &
H^0(U, \mathcal{Q}) \ar[lld] \\
&
H^1(U, \mathcal{F}) \ar[r] &
H^1(U, \mathcal{I}) \ar[r] &
H^1(U, \mathcal{Q}) \ar[lld] \\
&
\ldots & \ldots & \dots \\
}
$$
for any open $U \subset X$. Since $\mathcal{I}$ is injective we
have $H^n(U, \mathcal{I}) = 0$ for $n > 0$ (see
Homology, Lemma \ref{homology-lemma-higher-derived-functors}).
By the above we see that $H^0(U, \mathcal{I}) \to H^0(U, \mathcal{Q})$
is surjective and hence $H^1(U, \mathcal{F}) = 0$.
Since $\mathcal{F}$ was an arbitrary $\mathcal{O}_X$-module with
vanishing higher Cech cohomology we conclude that also
$H^1(U, \mathcal{Q}) = 0$ since $\mathcal{Q}$ is another of these
sheaves (see above). By the long exact sequence this in turn implies
that $H^2(U, \mathcal{F}) = 0$. And so on and so forth.
\end{proof}

\begin{lemma}
\label{lemma-cech-vanish-basis}
(Variant of Lemma \ref{lemma-cech-vanish}.)
Let $X$ be a ringed space.
Let $\mathcal{B}$ be a basis for the topology on $X$.
Let $\mathcal{F}$ be an $\mathcal{O}_X$-module.
Assume there exists a set of open coverings $\text{Cov}$
with the following properties:
\begin{enumerate}
\item For every $\mathcal{U} \in \text{Cov}$
with $\mathcal{U} : U = \bigcup_{i \in I} U_i$ we have
$U, U_i \in \mathcal{B}$ and every $U_{i_0 \ldots i_p} \in \mathcal{B}$.
\item For every $U \in \mathcal{B}$ the open coverings of $U$
occuring in $\text{Cov}$ is a cofinal system of open coverings
of $U$.
\item For every $\mathcal{U} \in \text{Cov}$ we have
$\check{H}^p(\mathcal{U}, \mathcal{F}) = 0$ for all $p > 0$.
\end{enumerate}
Then $H^p(U, \mathcal{F}) = 0$ for all $p > 0$ and any $U \in \mathcal{B}$.
\end{lemma}

\begin{proof}
Let $\mathcal{F}$ and $\text{Cov}$ be as in the lemma.
We will indicate this by saying ``$\mathcal{F}$ has vanishing higher
Cech cohomology for any $\mathcal{U} \in \text{Cov}$''.
Choose an embedding $\mathcal{F} \to \mathcal{I}$ into an
injective $\mathcal{O}_X$-module.
By Lemma \ref{lemma-injective-trivial-cech} $\mathcal{I}$
has vanishing higher Cech cohomology for any $\mathcal{U} \in \text{Cov}$.
Let $\mathcal{Q} = \mathcal{I}/\mathcal{F}$
so that we have a short exact sequence
$$
0 \to \mathcal{F} \to \mathcal{I} \to \mathcal{Q} \to 0.
$$
By Lemma \ref{lemma-ses-cech-h1} and our assumption (2)
this sequence gives rise to an exact sequence
$$
0 \to \mathcal{F}(U) \to \mathcal{I}(U) \to \mathcal{Q}(U) \to 0.
$$
for every $U \in \mathcal{B}$. Hence for any $\mathcal{U} \in \text{Cov}$
we get a short exact sequence of Cech complexes
$$
0 \to
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F}) \to
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{I}) \to
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{Q}) \to 0
$$
since each term in the Cech complex is made up out of a product of
values over elements of $\mathcal{B}$ by assumption (1).
In particular we have a long exact sequence of Cech cohomology
groups for any open covering $\mathcal{U} \in \text{Cov}$.
This implies that $\mathcal{Q}$ is also an $\mathcal{O}_X$-module
with vanishing higher Cech cohomology for all
$\mathcal{U} \in \text{Cov}$.

\medskip\noindent
Next, we look at the long exact cohomology sequence
$$
\xymatrix{
0 \ar[r] &
H^0(U, \mathcal{F}) \ar[r] &
H^0(U, \mathcal{I}) \ar[r] &
H^0(U, \mathcal{Q}) \ar[lld] \\
&
H^1(U, \mathcal{F}) \ar[r] &
H^1(U, \mathcal{I}) \ar[r] &
H^1(U, \mathcal{Q}) \ar[lld] \\
&
\ldots & \ldots & \dots \\
}
$$
for any $U \in \mathcal{B}$. Since $\mathcal{I}$ is injective we
have $H^n(U, \mathcal{I}) = 0$ for $n > 0$ (see
Homology, Lemma \ref{homology-lemma-higher-derived-functors}).
By the above we see that $H^0(U, \mathcal{I}) \to H^0(U, \mathcal{Q})$
is surjective and hence $H^1(U, \mathcal{F}) = 0$.
Since $\mathcal{F}$ was an arbitrary $\mathcal{O}_X$-module with
vanishing higher Cech cohomology for all $\mathcal{U} \in \text{Cov}$
we conclude that also $H^1(U, \mathcal{Q}) = 0$ since $\mathcal{Q}$ is
another of these sheaves (see above). By the long exact sequence this in
turn implies that $H^2(U, \mathcal{F}) = 0$. And so on and so forth.
\end{proof}

\begin{lemma}
\label{lemma-pushforward-injective}
Let $f : X \to Y$ be a morphism of ringed spaces.
Let $\mathcal{I}$ be an injective $\mathcal{O}_X$-module.
Then
\begin{enumerate}
\item $\check{H}^p(\mathcal{V}, f_*\mathcal{I}) = 0$
for all $p > 0$ and any open covering
$\mathcal{V} : V = \bigcup_{j \in J} V_j$ of $Y$.
\item $H^p(V, f_*\mathcal{I}) = 0$ for all $p > 0$ and
every open $V \subset Y$.
\end{enumerate}
In other words, $f_*\mathcal{I}$ is $\Gamma(U, -)$-acyclic
(see Homology, Definition \ref{homology-definition-F-acyclic})
for any $U \subset X$ open.
\end{lemma}

\begin{proof}
Set $\mathcal{U} : f^{-1}(V) = \bigcup_{j \in J} f^{-1}(V_j)$.
It is an open covering of $X$ and
$$
\check{\mathcal{C}}^\bullet(\mathcal{V}, f_*\mathcal{I}) =
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{I}).
$$
This is true because
$$
f_*\mathcal{I}(V_{j_0 \ldots j_p})
= \mathcal{I}(f^{-1}(V_{j_0 \ldots j_p})) =
\mathcal{I}(f^{-1}(V_{j_0}) \cap \ldots \cap f^{-1}(V_{j_p}))
= \mathcal{I}(U_{j_0 \ldots j_p}).
$$
Thus the first statement of the lemma follows from
Lemma \ref{lemma-injective-trivial-cech}. The second statement
follows from the first and Lemma \ref{lemma-cech-vanish}.
\end{proof}














\section{The Leray spectral sequence}
\label{section-Leray}

\begin{lemma}
\label{lemma-before-Leray}
Let $f : X \to Y$ be a morphism of ringed spaces.
There is a commutative diagram
$$
\xymatrix{
D^{+}(X) \ar[rr]_-{R\Gamma(X, -)} \ar[d]_{Rf_*} & &
D^{+}(\mathcal{O}_X(X)) \ar[d]^{\text{restriction}} \\
D^{+}(Y) \ar[rr]^-{R\Gamma(Y, -)} & &
D^{+}(\mathcal{O}_Y(Y))
}
$$
More generally for any $V \subset Y$ open and $U = f^{-1}(V)$ there
is a commutative diagram
$$
\xymatrix{
D^{+}(X) \ar[rr]_-{R\Gamma(U, -)} \ar[d]_{Rf_*} & &
D^{+}(\mathcal{O}_X(U)) \ar[d]^{\text{restriction}} \\
D^{+}(Y) \ar[rr]^-{R\Gamma(V, -)} & &
D^{+}(\mathcal{O}_Y(V))
}
$$
See also Remark \ref{remark-elucidate-lemma} for more explanation.
\end{lemma}

\begin{proof}
Let
$\Gamma_{res} : \textit{Mod}(\mathcal{O}_X) \to \text{Mod}(\mathcal{O}_Y(Y))$
be the functor which associates to an $\mathcal{O}_X$-module $\mathcal{F}$
the global sections of $\mathcal{F}$ viewed as a $\mathcal{O}_Y(Y)$-module
via the map $f^\sharp : \mathcal{O}_Y(Y) \to \mathcal{O}_X(X)$. Let
$restriction : \text{Mod}(\mathcal{O}_X(X)) \to \text{Mod}(\mathcal{O}_Y(Y))$
be the restriction functor induced by
$f^\sharp : \mathcal{O}_Y(Y) \to \mathcal{O}_X(X)$. Note that $restriction$
is exact so that
its right derived functor is computed by simply applying the restriction
functor, see
Homology, Remark \ref{homology-remark-right-derived-exact-functor}.
It is clear that
$$
\Gamma_{res}
=
restriction \circ \Gamma(X, -)
=
\Gamma(Y, -) \circ f_*
$$
We claim that
Homology, Lemma \ref{homology-lemma-compose-derived-functors}
applies to both compositions. For the first this is clear by our remarks
above. For the second, it follows from
Lemma \ref{lemma-pushforward-injective} which implies that
injective $\mathcal{O}_X$-modules are mapped to $\Gamma(Y, -)$-acyclic
sheaves on $Y$.
\end{proof}

\begin{remark}
\label{remark-elucidate-lemma}
Here is a down-to-earth explanation of the meaning of
Lemma \ref{lemma-before-Leray}. It says that given
$f : X \to Y$ and $\mathcal{F} \in \textit{Mod}(\mathcal{O}_X)$
and given an injective resolution $\mathcal{F} \to \mathcal{I}^\bullet$
we have
$$
\begin{matrix}
R\Gamma(X, \mathcal{F}) & \text{is represented by} &
\Gamma(X, \mathcal{I}^\bullet) \\
Rf_*\mathcal{F} & \text{is represented by} & f_*\mathcal{I}^\bullet \\
R\Gamma(Y, Rf_*\mathcal{F}) & \text{is represented by} &
\Gamma(Y, f_*\mathcal{I}^\bullet)
\end{matrix}
$$
the last fact coming from Leray's acyclicity lemma
(Homology, Lemma \ref{homology-lemma-leray-acyclicity})
and Lemma \ref{lemma-pushforward-injective}.
Finally, it combines this with the trivial observation that
$$
\Gamma(X, \mathcal{I}^\bullet)
=
\Gamma(Y, f_*\mathcal{I}^\bullet).
$$
to arrive at the commutativity of the diagram of the lemma.
\end{remark}

\begin{lemma}
\label{lemma-modules-abelian}
Let $X$ be a ringed space.
Let $\mathcal{F}$ be an $\mathcal{O}_X$-module.
\begin{enumerate}
\item The cohomology groups $H^i(U, \mathcal{F})$ for $U \subset X$ open
of $\mathcal{F}$ computed as an $\mathcal{O}_X$-module, or computed as an
abelian sheaf are identical.
\item Let $f : X \to Y$ be a morphism of ringed spaces.
The higher direct images $R^if_*\mathcal{F}$ of $\mathcal{F}$
computed as an $\mathcal{O}_X$-module, or computed as an abelian sheaf
are identical.
\end{enumerate}
There are similar statements in the case of bounded below
complexes of $\mathcal{O}_X$-modules.
\end{lemma}

\begin{proof}
Consider the morphism of ringed spaces
$(X, \mathcal{O}_X) \to (X, \underline{\mathbf{Z}}_X)$ given
by the identity on the underlying topological space and by
the unique map of sheaves of rings
$\underline{\mathbf{Z}}_X \to \mathcal{O}_X$.
Let $\mathcal{F}$ be an $\mathcal{O}_X$-module.
Denote $\mathcal{F}_{ab}$ the same sheaf seens as an
$\underline{\mathbf{Z}}_X$-module, i.e., seens as a sheaf of
abelian groups. Let
$\mathcal{F} \to \mathcal{I}^\bullet$ be an injective resolution.
By Remark \ref{remark-elucidate-lemma} we see that
$\Gamma(X, \mathcal{I}^\bullet)$ computes both
$R\Gamma(X, \mathcal{F})$ and $R\Gamma(X, \mathcal{F}_{ab})$.
This proves (1).

\medskip\noindent
To prove (2) we use (1) and Lemma \ref{lemma-describe-higher-direct-images}.
The result follows immediately.
\end{proof}

\begin{lemma}
\label{lemma-Leray}
(Leray spectral sequence.)
Let $f : X \to Y$ be a morphism of ringed spaces.
Let $\mathcal{F}^\bullet$ be
a bounded below complex of $\mathcal{O}_X$-modules.
There is a spectral sequence
$$
E_2^{p, q} = H^p(Y, R^qf_*(\mathcal{F}^\bullet))
$$
converging to $H^{p + q}(X, \mathcal{F}^\bullet)$.
\end{lemma}

\begin{proof}
This is just the Grothendieck spectral sequence
Homology, Lemma \ref{homology-lemma-grothendieck-spectral-sequence}
coming from the composition of functors
$\Gamma_{res} = \Gamma(Y, -) \circ f_*$ where $\Gamma_{res}$ is as
in the proof of Lemma \ref{lemma-before-Leray}.
To see that the assumptions of
Homology, Lemma \ref{homology-lemma-grothendieck-spectral-sequence}
are satisfied, see the proof of Lemma \ref{lemma-before-Leray} or
Remark \ref{remark-elucidate-lemma}.
\end{proof}

\begin{remark}
\label{remark-Leray-ss-more-structure}
The Leray spectral sequence, the way we proved it in Lemma \ref{lemma-Leray}
is a spectral sequence of $\Gamma(Y, \mathcal{O}_Y)$-modules. However, it
is quite easy to see that it is in fact a spectral sequence of
$\Gamma(X, \mathcal{O}_X)$-modules. For example $f$ gives rise to
a morphism of ringed spaces
$f' :  (X, \mathcal{O}_X) \to (Y, f_*\mathcal{O}_X)$.
By Lemma \ref{lemma-modules-abelian} the terms $E_r^{p, q}$ of the
Leray spectral sequence for an $\mathcal{O}_X$-module $\mathcal{F}$
and $f$ are identical with those for $\mathcal{F}$ and $f'$
at least for $r \geq 2$. Namely, they both agree with the terms of the Leray
spectral sequence for $\mathcal{F}$ as an abelian sheaf.
And since $(f_*\mathcal{O}_X)(Y) = \mathcal{O}_X(X)$ we see the result.
It is often the case
that the Leray spectral sequence carries additional structure.
\end{remark}

\begin{lemma}
\label{lemma-higher-direct-images-compose}
Let $f : X \to Y$ and $g : Y \to Z$ be morphisms of ringed spaces.
In this case $Rg_* \circ Rf_* = R(g \circ f)_*$ as functors
from $D^{+}(X) \to D^{+}(Z)$.
\end{lemma}

\begin{proof}
We are going to apply
Homology, Lemma \ref{homology-lemma-compose-derived-functors}.
It is clear that $g_* \circ f_* = (g \circ f)_*$, see
Sheaves, Lemma \ref{sheaves-lemma-pushforward-composition}.
It remains to show that $f_*\mathcal{I}$ is $g_*$-acyclic.
This follows from Lemma \ref{lemma-pushforward-injective}
and the description of the
higher direct images $R^ig_*$ in
Lemma \ref{lemma-describe-higher-direct-images}.
\end{proof}

\begin{lemma}
\label{lemma-relative-Leray}
(Relative Leray spectral sequence.)
Let $f : X \to Y$ and $g : Y \to Z$ be morphisms of ringed spaces.
Let $\mathcal{F}$ be an $\mathcal{O}_X$-module.
There is a spectral sequence with
$$
E_2^{p, q} = R^pg_*(R^qf_*\mathcal{F})
$$
converging to $R^{p + q}(g \circ f)_*\mathcal{F}$.
This spectral sequence is functorial in $\mathcal{F}$, and there
is a version for bounded below complexes of $\mathcal{O}_X$-modules.
\end{lemma}

\begin{proof}
This is a Grothendieck spectral sequence for composition of functors
and follows from Lemma \ref{lemma-higher-direct-images-compose} and
Homology, Lemma \ref{homology-lemma-grothendieck-spectral-sequence}.
\end{proof}














\section{Functoriality of cohomology}
\label{section-functoriality}

\begin{lemma}
\label{lemma-functoriality}
Let $f : X \to Y$ be a morphism of ringed spaces.
Let $\mathcal{G}^\bullet$, resp.\ $\mathcal{F}^\bullet$ be
a bounded below complex of $\mathcal{O}_Y$-modules,
resp.\ $\mathcal{O}_X$-modules. Let
$\varphi : \mathcal{G}^\bullet \to f_*\mathcal{F}^\bullet$
be a morphism of complexes. There is a canonical morphism
$$
\mathcal{G}^\bullet
\longrightarrow
Rf_*(\mathcal{F}^\bullet)
$$
in $D^{+}(Y)$. Moreover this construction is functorial in the triple
$(\mathcal{G}^\bullet, \mathcal{F}^\bullet, \varphi)$.
\end{lemma}

\begin{proof}
Choose an injective resolution $\mathcal{F}^\bullet \to \mathcal{I}^\bullet$.
By definition $Rf_*(\mathcal{F}^\bullet)$ is represented by
$f_*\mathcal{I}^\bullet$ in $K^{+}(\mathcal{O}_Y)$.
The composition
$$
\mathcal{G}^\bullet \to f_*\mathcal{F}^\bullet \to f_*\mathcal{I}^\bullet
$$
is a morphism in $K^{+}(Y)$ which turns
into the morphism of the lemma upon applying the
localization functor $j_Y : K^{+}(Y) \to D^{+}(Y)$.
\end{proof}

\noindent
Let $f : X \to Y$ be a morphism of ringed spaces.
Let $\mathcal{G}$ be an $\mathcal{O}_Y$-module and let
$\mathcal{F}$ be an $\mathcal{O}_X$-module. Recall that an
$f$-map $\varphi$ from $\mathcal{G}$ to $\mathcal{F}$ is a map
$\varphi : \mathcal{G} \to f_*\mathcal{F}$, or what is the same
thing, a map $\varphi : f^*\mathcal{G} \to \mathcal{F}$.
See Sheaves, Definition \ref{sheaves-definition-f-map}.
Such an $f$-map gives rise to a morphism of complexes
\begin{equation}
\label{equation-functorial-derived}
\varphi :
R\Gamma(Y, \mathcal{G})
\longrightarrow
R\Gamma(X, \mathcal{F})
\end{equation}
in $D^{+}(\mathcal{O}_Y(Y))$. Namely, we use the morphism
$\mathcal{G} \to Rf_*\mathcal{F}$ in $D^{+}(Y)$ of
Lemma \ref{lemma-functoriality}, and we apply $R\Gamma(Y, -)$.
By Lemma \ref{lemma-before-Leray} we see that
$R\Gamma(X, \mathcal{F}) = R\Gamma(Y, Rf_*\mathcal{F})$
and we get the displayed arrow. We spell this out completely in
Remark \ref{remark-explain-arrow} below.
In particular it gives
rise to maps on cohomology
\begin{equation}
\label{equation-functorial}
\varphi : H^i(Y, \mathcal{G}) \longrightarrow H^i(X, \mathcal{F}).
\end{equation}

\begin{remark}
\label{remark-explain-arrow}
Let $f : X \to Y$ be a morphism of ringed spaces.
Let $\mathcal{G}$ be an $\mathcal{O}_Y$-module.
Let $\mathcal{F}$ be an $\mathcal{O}_X$-module.
Let $\varphi$ be an $f$-map from $\mathcal{G}$ to $\mathcal{F}$.
Choose a resolution $\mathcal{F} \to \mathcal{I}^\bullet$
by a complex of injective $\mathcal{O}_X$-modules.
Choose resolutions $\mathcal{G} \to J^\bullet$ and
$f_*\mathcal{I} \to (\mathcal{J}')^\bullet$ by complexes
of injective $\mathcal{O}_Y$-modules. By
Homology, Lemma \ref{homology-lemma-morphisms-lift}
there exists a map of complexes
$\beta$ such that the diagram
$$
\xymatrix{
\mathcal{G} \ar[d] \ar[r] &
f_*\mathcal{F} \ar[r] &
f_*\mathcal{I}^\bullet \ar[d] \\
\mathcal{J}^\bullet \ar[rr]^\beta & &
(\mathcal{J}')^\bullet
}
$$
commutes up to homotopy. Applying global section functors we see
that we get a diagram
$$
\xymatrix{
 & & \Gamma(Y, f_*\mathcal{I}^\bullet) \ar[d]_{qis} \ar@{=}[r] &
\Gamma(X, \mathcal{I}^\bullet) \\
\Gamma(Y, \mathcal{J}^\bullet) \ar[rr]^\beta & &
\Gamma(Y, (\mathcal{J}')^\bullet) &
}
$$
The complex on the bottom left represents $R\Gamma(Y, \mathcal{G})$
and the complex on the top right represents $R\Gamma(X, \mathcal{F})$.
The vertical arrow is a quasi-isomorphism by
Lemma \ref{lemma-before-Leray} which becomes invertible after
applying the localization functor
$K^{+}(\mathcal{O}_Y(Y)) \to D^{+}(\mathcal{O}_Y(Y))$.
The arrow (\ref{equation-functorial-derived}) is given by the
composition of the horizontal map by the inverse of the vertical map.
\end{remark}
















\section{The alternating Cech complex}
\label{section-alternating-cech}

\noindent
This section compares the Cech complex with the alternating Cech
complex and some related complexes.

\medskip\noindent
Let $X$ be a topological space. Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$
be an open covering. For $p \geq 0$ set
$$
\check{\mathcal{C}}_{alt}^p(\mathcal{U}, \mathcal{F})
=
\left\{
\begin{matrix}
s \in  \check{\mathcal{C}}^p(\mathcal{U}, \mathcal{F})
\text{ such that }
s_{i_0 \ldots i_p} = 0 \text{ if } i_n = i_m \text{ for some } n \not = m\\
\text{ and }
s_{i_0\ldots i_n \ldots i_m \ldots i_p}
=
-s_{i_0\ldots i_m \ldots i_n \ldots i_p}
\text{ in any case.}
\end{matrix}
\right\}
$$
We omit the verification that the differential $d$ of
Equation (\ref{equation-d-cech}) maps
$\check{\mathcal{C}}^p_{alt}(\mathcal{U}, \mathcal{F})$ into 
$\check{\mathcal{C}}^{p + 1}_{alt}(\mathcal{U}, \mathcal{F})$.

\begin{definition}
\label{definition-alternating-cech-complex}
Let $X$ be a topological space. Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$
be an open covering. Let $\mathcal{F}$ be an abelian sheaf on $X$.
The complex $\check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F})$
is the {\it alternating Cech complex} associated to $\mathcal{F}$ and the
open covering $\mathcal{U}$.
\end{definition}

\noindent
Hence there is a canonical morphism of complexes
$$
\check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F})
\longrightarrow
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})
$$
namely the inclusion of the alternating Cech complex into the
usual Cech complex.

\medskip\noindent
Suppose our covering $\mathcal{U} : U = \bigcup_{i \in I} U_i$ comes
equipped with a total ordering $<$ on $I$. In this case, set
$$
\check{\mathcal{C}}_{ord}^p(\mathcal{U}, \mathcal{F})
=
\prod\nolimits_{(i_0, \ldots, i_p) \in I^{p + 1}, i_0 < \ldots < i_p}
\mathcal{F}(U_{i_0\ldots i_p}).
$$
This is an abelian group. For
$s \in \check{\mathcal{C}}_{ord}^p(\mathcal{U}, \mathcal{F})$ we denote
$s_{i_0\ldots i_p}$ its value in $\mathcal{F}(U_{i_0\ldots i_p})$.
We define
$$
d : \check{\mathcal{C}}_{ord}^p(\mathcal{U}, \mathcal{F})
\longrightarrow
\check{\mathcal{C}}_{ord}^{p + 1}(\mathcal{U}, \mathcal{F})
$$
by the formula
$$
d(s)_{i_0\ldots i_{p + 1}}
=
\sum\nolimits_{j = 0}^{p + 1}
(-1)^j
s_{i_0\ldots \hat i_j \ldots i_p}|_{U_{i_0\ldots i_{p + 1}}}
$$
for any $i_0 < \ldots < i_{p + 1}$. Note that this formula is identical
to Equation (\ref{equation-d-cech}).
It is straightforward to see that $d \circ d = 0$. In other words
$\check{\mathcal{C}}_{ord}^\bullet(\mathcal{U}, \mathcal{F})$ is a complex.

\begin{definition}
\label{definition-ordered-cech-complex}
Let $X$ be a topological space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$ be an open covering.
Let $\mathcal{F}$ be an abelian sheaf on $X$.
The complex $\check{\mathcal{C}}_{ord}^\bullet(\mathcal{U}, \mathcal{F})$
is the {\it ordered Cech complex} associated to $\mathcal{F}$, the
open covering $\mathcal{U}$ and the given total ordering on $I$.
\end{definition}

\noindent
This complex is sometimes called the alternating Cech complex.
The reason is that there is an obvious comparison map between
the ordered Cech complex and the alternating Cech complex.
Namely, consider the map
$$
c :
\check{\mathcal{C}}_{ord}^\bullet(\mathcal{U}, \mathcal{F})
\longrightarrow
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})
$$
given by the rule
$$
c(s)_{i_0\ldots i_p} = 
\left\{
\begin{matrix}
0 &
\text{if} &
i_n = i_m \text{ for some } n \not = m\\
\text{sgn}(\sigma) s_{i_{\sigma(0)}\ldots i_{\sigma(p)}} &
\text{if} &
i_{\sigma(0)} < i_{\sigma(1)} < \ldots < i_{\sigma(p)}
\end{matrix}
\right.
$$
Here $\sigma$ denotes a permutation of $\{0, \ldots, p\}$ and
$\text{sgn}(\sigma)$ denotes its sign.

\begin{lemma}
\label{lemma-ordered-alternating}
Let $X$ be a topological space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$ be an open covering.
Assume $I$ comes equipped with a total ordering.
The map $c$ is a morphism of complexes. In fact it induces
an isomorphism
$$
c : \check{\mathcal{C}}_{ord}^\bullet(\mathcal{U}, \mathcal{F})
\to \check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F})
$$
of complexes.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
There is also a map
$$
\pi :
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})
\longrightarrow
\check{\mathcal{C}}_{ord}^\bullet(\mathcal{U}, \mathcal{F})
$$
which is described by the rule
$$
\pi(s)_{i_0\ldots i_p} = s_{i_0\ldots i_p}
$$
whenever $i_0 < i_1 < \ldots < i_p$.

\begin{lemma}
\label{lemma-project-to-ordered}
Let $X$ be a topological space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$ be an open covering.
Assume $I$ comes equipped with a total ordering.
The map $\pi : \check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})
\to \check{\mathcal{C}}_{ord}^\bullet(\mathcal{U}, \mathcal{F})$
is a morphism of complexes. It induces an isomorphism
$$
\pi : \check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F})
\to \check{\mathcal{C}}_{ord}^\bullet(\mathcal{U}, \mathcal{F})
$$
of complexes which is a left inverse to the morphism $c$.
\end{lemma}

\begin{remark}
\label{remark-compared-ordered-complexes}
This means that if we have two total orderings $<_1$ and $<_2$ on
the index set $I$, then we get an isomorphism of complexes
$\tau = \pi_2 \circ c_1 :
\check{\mathcal{C}}_{ord\text{-}1}(\mathcal{U}, \mathcal{F}) \to
\check{\mathcal{C}}_{ord\text{-}2}(\mathcal{U}, \mathcal{F})$.
It is clear that
$$
\tau(s)_{i_0 \ldots i_p} =
\text{sign}(\sigma) s_{i_{\sigma(0)} \ldots i_{\sigma(p)}}
$$
where $i_0 <_1 i_1 <_1 \ldots <_1 i_p$ and
$i_{\sigma(0)} <_2 i_{\sigma(1)} <_2 \ldots <_2 i_{\sigma(p)}$.
This is the sense in which the ordered Cech complex is independent
of the chosen total ordering.
\end{remark}

\begin{lemma}
\label{lemma-alternating-usual}
Let $X$ be a topological space.
Let $\mathcal{U} : U = \bigcup_{i \in I} U_i$ be an open covering.
Assume $I$ comes equipped with a total ordering.
The map $c \circ \pi$ is homotopic to the identity on
$\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})$.
In particular the inclusion map
$\check{\mathcal{C}}_{alt}^\bullet(\mathcal{U}, \mathcal{F}) \to
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})$
is a homotopy equivalence.
\end{lemma}

\begin{proof}
For any multi-index $(i_0, \ldots, i_p) \in I^{p + 1}$ there exists
a unique permutation $\sigma : \{0, \ldots, p\} \to \{0, \ldots, p\}$
such that
$$
i_{\sigma(0)} \leq i_{\sigma(1)} \leq \ldots \leq i_{\sigma(p)}
\quad
\text{and}
\quad
\sigma(j) < \sigma(j + 1)
\quad
\text{if}
\quad
i_{\sigma(j)} = i_{\sigma(j + 1)}.
$$
We denote this permutation $\sigma = \sigma^{i_0 \ldots i_p}$.

\medskip\noindent
For any permutation $\sigma : \{0, \ldots, p\} \to \{0, \ldots, p\}$
and any $a$, $0 \leq a \leq p$ we denote $\sigma_a$
the permutation of $\{0, \ldots, p\}$ such that
$$
\sigma_a(j) =
\left\{
\begin{matrix}
\sigma(j) & \text{if} & 0 \leq j < a, \\
\min\{j' \mid j' > \sigma_a(j - 1), j' \not = \sigma(k), \forall k < a\}
& \text{if} & a \leq j
\end{matrix}
\right.
$$
So if $p = 3$ and $\sigma$, $\tau$ are given by
$$
\begin{matrix}
\text{id} & 0 & 1 & 2 & 3 \\
\sigma & 3 & 2 & 1 & 0
\end{matrix}
\quad \text{and} \quad
\begin{matrix}
\text{id} & 0 & 1 & 2 & 3 \\
\tau & 3 & 0 & 2 & 1
\end{matrix}
$$
then we have
$$
\begin{matrix}
\text{id} & 0 & 1 & 2 & 3 \\
\sigma_0 & 0 & 1 & 2 & 3 \\
\sigma_1 & 3 & 0 & 1 & 2 \\
\sigma_2 & 3 & 2 & 0 & 1 \\
\sigma_3 & 3 & 2 & 1 & 0 \\
\end{matrix}
\quad \text{and} \quad
\begin{matrix}
\text{id} & 0 & 1 & 2 & 3 \\
\tau_0 & 0 & 1 & 2 & 3 \\
\tau_1 & 3 & 0 & 1 & 2 \\
\tau_2 & 3 & 0 & 1 & 2 \\
\tau_3 & 3 & 0 & 2 & 1 \\
\end{matrix}
$$
It is clear that always $\sigma_0 = \text{id}$ and $\sigma_p = \sigma$.

\medskip\noindent
Having introduced this notation we define for
$s \in \check{\mathcal{C}}^{p + 1}(\mathcal{U}, \mathcal{F})$
the element $h(s) \in \check{\mathcal{C}}^p(\mathcal{U}, \mathcal{F})$
to be the element with components
\begin{equation}
\label{equation-first-homotopy}
h(s)_{i_0\ldots i_p} =
\sum\nolimits_{0 \leq a \leq p}
(-1)^a \text{sign}(\sigma_a)
s_{i_{\sigma(0)} \ldots i_{\sigma(a)} i_{\sigma_a(a)} \ldots i_{\sigma_a(p)}}
\end{equation}
where $\sigma = \sigma^{i_0 \ldots i_p}$. Note that the index
$i_{\sigma(a)}$ occurs twice in 
$i_{\sigma(0)} \ldots i_{\sigma(a)} i_{\sigma_a(a)} \ldots i_{\sigma_a(p)}$
once in the first group of $a + 1$ indices and once in the second group
of $p - a + 1$ indices since $\sigma_a(j) = \sigma(a)$ for some
$j \geq a$ by definition of $\sigma_a$. Hence the sum makes sense since each
of the elements
$s_{i_{\sigma(0)} \ldots i_{\sigma(a)} i_{\sigma_a(a)} \ldots i_{\sigma_a(p)}}$
is defined over the open $U_{i_0 \ldots i_p}$.
Note also that for $a = 0$ we get $s_{i_0 \ldots i_p}$ and
for $a = p$ we get
$(-1)^p \text{sign}(\sigma) s_{i_{\sigma(0)} \ldots i_{\sigma(p)}}$.

\medskip\noindent
We claim that
$$
(dh + hd)(s)_{i_0 \ldots i_p} =
s_{i_0 \ldots i_p} -
\text{sign}(\sigma) s_{i_{\sigma(0)} \ldots i_{\sigma(p)}}
$$
where $\sigma = \sigma^{i_0 \ldots i_p}$. We omit the verification
of this claim. (There is a PARI/gp script called first-homotopy.gp
in the stacks-project subdirectory scripts which can be used to check
finitely many instances of this claim.
We wrote this script to make sure the signs are correct.)
Write
$$
\kappa :
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})
\longrightarrow
\check{\mathcal{C}}^\bullet(\mathcal{U}, \mathcal{F})
$$
for the operator given by the rule
$$
\kappa(s)_{i_0 \ldots i_p} =
\text{sign}(\sigma^{i_0 \ldots i_p}) s_{i_{\sigma(0)} \ldots i_{\sigma(p)}}.
$$
The claim above implies that $\kappa$ is a morphism of complexes and that
$\kappa$ is homotopic to the identity map of the Cech complex.
This does not immediately imply the lemma since
the image of the operator $\kappa$ is not the alternating subcomplex.
Namely, the image of $\kappa$ is the ``semi-alternating'' complex
$\check{\mathcal{C}}_{semi\text{-}alt}^p(\mathcal{U}, \mathcal{F})$
where $s$ is a $p$-cochain of this complex if and only if
$$
s_{i_0 \ldots i_p} = \text{sign}(\sigma) s_{i_{\sigma(0)} \ldots i_{\sigma(p)}}
$$
for any $(i_0, \ldots, i_p) \in I^{p + 1}$ with
$\sigma = \sigma^{i_0 \ldots i_p}$.
We introduce yet another variant Cech complex, namely the semi-ordered
Cech complex defined by
$$
\check{\mathcal{C}}_{semi\text{-}ord}^p(\mathcal{U}, \mathcal{F})
=
\prod\nolimits_{i_0 \leq i_1 \leq \ldots \leq i_p}
\mathcal{F}(U_{i_0 \ldots i_p})
$$
It is easy to see that Equation (\ref{equation-d-cech}) also defines
a differential and hence that we get a complex. It is also clear
(analogous to Lemma \ref{lemma-project-to-ordered}) that the projection map
$$
\check{\mathcal{C}}_{semi\text{-}alt}^\bullet(\mathcal{U}, \mathcal{F})
\longrightarrow
\check{\mathcal{C}}_{semi\text{-}ord}^\bullet(\mathcal{U}, \mathcal{F})
$$
is an isomorphism of complexes.

\medskip\noindent
Hence the Lemma follows if we can show that the obvious inclusion map
$$
\check{\mathcal{C}}_{ord}^p(\mathcal{U}, \mathcal{F})
\longrightarrow
\check{\mathcal{C}}_{semi\text{-}ord}^p(\mathcal{U}, \mathcal{F})
$$
is a homotopy equivalence. To see this we use the homotopy
\begin{equation}
\label{equation-second-homotopy}
h(s)_{i_0 \ldots i_p} =
\left\{
\begin{matrix}
0 & \text{if} & i_0 < i_1 < \ldots < i_p \\
(-1)^a s_{i_0 \ldots i_{a - 1} i_a i_a i_{a + 1} \ldots i_p}
& \text{if} & i_0 < i_1 < \ldots < i_{a - 1} < i_a = i_{a + 1}
\end{matrix}
\right.
\end{equation}
We claim that
$$
(dh + hd)(s)_{i_0 \ldots i_p} =
\left\{
\begin{matrix}
0 & \text{if} & i_0 < i_1 < \ldots < i_p \\
s_{i_0 \ldots i_p}
& \text{else} &
\end{matrix}
\right.
$$
We omit the verification. (There is a PARI/gp script called second-homotopy.gp
in the stacks-project subdirectory scripts which can be used to check
finitely many instances of this claim.
We wrote this script to make sure the signs are correct.)
The claim clearly shows that the composition
$$
\check{\mathcal{C}}_{semi\text{-}ord}^\bullet(\mathcal{U}, \mathcal{F})
\longrightarrow
\check{\mathcal{C}}_{ord}^\bullet(\mathcal{U}, \mathcal{F})
\longrightarrow
\check{\mathcal{C}}_{semi\text{-}ord}^\bullet(\mathcal{U}, \mathcal{F})
$$
of the projection with the natural inclusion
is homotopic to the identity map as desired.
\end{proof}









\section{Cech cohomology of complexes}
\label{section-cech-cohomology-of-complexes}

\noindent
In general for sheaves of abelian groups
${\mathcal F}$ and ${\mathcal G}$ on $X$ there is a cupproduct map
$H^i(X, {\mathcal F}) \times H^j(X, {\mathcal G}) \to
H^{i + j}(X, {\mathcal F}\otimes_{\bf Z} {\mathcal G})$. The easiest way
I know how to define it is to compute cohomology using Cech
cocyles and write out the formula for the cup product. See below.
If you are worried about the fact that cohomology may not
equal Cech cohomology, then you can use hypercoverings and still
use the cocycle notation. This also has the advantage that
it works to define the cup product for hypercohomology on any site.

\medskip\noindent
Let ${\mathcal F}^*$ be a bounded below complex of sheaves of abelian
groups on $X$. We can (often) compute ${\bf H}^n(X, {\mathcal F}^*)$
using Cech cocycles. Namely, let ${\mathcal U} = \{U_i\}_{i\in I}$
be an open covering of $X$. Consider the (simple) complex
$s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)$
with degree $n$ term
$$
s^n{\mathcal C}^*({\mathcal U}, {\mathcal F}^*) =
\prod\nolimits_{p + q = n} {\mathcal F}^q(U_{i_0\ldots i_p})
$$
with a typical element denoted $\alpha = \{\alpha_{i_0\ldots i_p}\}$
so that $\alpha_{i_0\ldots i_p} \in {\mathcal F}^{q}(U_{i_0\ldots i_p})$,
in other words the ${\mathcal F}$-degree of $\alpha_{i_0\ldots i_p}$ is $q$.
We indicate this by the formula $\deg_{\mathcal F}(\alpha_{i_0\ldots i_p}) = q$.
The differential of an element $\alpha$ of degree $n$ is
\begin{align*}
d(\alpha)_{i_0\ldots i_{p + 1}}
& =
d_{{\mathcal F}}(\alpha_{i_0\ldots i_{p + 1}})
+
(-1)^{n-p}
\sum\nolimits_{j = 0}^{p + 1}
(-1)^j
\alpha_{i_0\ldots \hat i_j \ldots i_{p + 1}}\cr
& =
d_{{\mathcal F}}(\alpha_{i_0\ldots i_{p + 1}})
+
\sum\nolimits_{j = 0}^{p + 1}
(-1)^{j + n-p}
\alpha_{i_0\ldots \hat i_j \ldots i_{p + 1}}
\end{align*}
where $d_{\mathcal F}$ denotes the differential on the complex ${\mathcal F}$.
An expression such as
$\alpha_{i_0\ldots\hat i_j\ldots i_{p + 1}}$ means the restriction
of $\alpha_{i_0\ldots\hat i_j\ldots i_{p + 1}} \in
{\mathcal F}(U_{i_0\ldots\hat i_j\ldots i_{p + 1}})$ to
$U_{i_0\ldots i_{p + 1}}$.
To check this is a complex, let $\alpha$ be an element of
degree $n$ in $s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)$, so that
$d(\alpha)$ has degree $n + 1$. We compute:
\begin{align*}
d^2(\alpha)_{i_0\ldots i_{p + 2}}
& =
d_{{\mathcal F}}(d(\alpha)_{i_0\ldots i_{p + 2}})
+
(-1)^{(n + 1)-(p + 1)}
\sum\nolimits_{j = 0}^{p + 2}
(-1)^j
d(\alpha)_{i_0\ldots \hat i_j \ldots i_{p + 2}}
\cr
& =
d_{\mathcal F}( d_{{\mathcal F}}(\alpha_{i_0\ldots i_{p + 2}}) )
\cr
& +
d_{\mathcal F}\Big(
(-1)^{n-(p + 1)}
\sum\nolimits_{j = 0}^{p + 2}
(-1)^j
\ \alpha_{i_0\ldots \hat i_j \ldots i_{p + 2}}
\Big)
\cr
& +
(-1)^{(n + 1)-(p + 1)}
\sum\nolimits_{j = 0}^{p + 2}
(-1)^j
d_{{\mathcal F}}(\alpha_{i_0\ldots \hat i_j\ldots i_{p + 2}})
\cr
& +
(-1)^{(n + 1)-(p + 1)}
\sum\nolimits_{j = 0}^{p + 2}
(-1)^{j + n-p}
\sum\nolimits_{j' = 0\ldots j-1}
(-1)^{j'}
\alpha_{i_0\ldots \hat i_{j'}\ldots\hat i_{j} \ldots i_{p + 1}}
\cr
& +
(-1)^{(n + 1)-(p + 1)}
\sum\nolimits_{j = 0}^{p + 2}
(-1)^{j + n-p}
\sum\nolimits_{j' = j + 1\ldots p + 2}
(-1)^{j'-1}
\alpha_{i_0\ldots \hat i_j\ldots\hat i_{j'} \ldots i_{p + 1}}
\end{align*}
which equals zero by the nullity of $d_{\mathcal F}^2$,
a trivial sign change between the second and third terms, and
the usual argument for the last two double Cech terms.

\medskip\noindent
The construction of $s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)$
is functorial in ${\mathcal F}^*$. As well there is a functorial
transformation
$$
\Gamma(X, {\mathcal F}^*)
\longrightarrow
s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)
$$
of complexes defined by the following rule: The section
$s\in \Gamma(X, {\mathcal F}^n)$
is mapped to the element $\alpha = \{\alpha_{i_0\ldots i_p}\}$
with $\alpha_{i_0} = s|_{I_{i_0}}$ and $\alpha_{i_0\ldots i_p} = 0$
for $p>0$.

\medskip\noindent
Refinements. Let ${\mathcal V} = \{ V_j \}_{j\in J}$ be a
refinement of ${\mathcal U}$. This means there is a map $t: J \to I$
such that $V_j \subset U_{t(j)}$ for all $j\in J$. This gives
rise to a functorial transformation
$$
T_t : s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)
\longrightarrow
s{\mathcal C}^*({\mathcal V}, {\mathcal F}^*).
$$
This is defined by the rule
$$
T_t(\alpha)_{j_0\ldots j_p}
=
\alpha_{t(j_0)\ldots t(j_p)}|_{V_{j_0\ldots j_p}}
$$
Given two maps $t, t' : J \to I$ as above the maps
$T_t$ and $T_{t'}$ constructed above are homotopic.
The homotopy is given by
\begin{align*}
h(\alpha)_{j_0\ldots j_p}
& =
(-1)^{n + p}
\sum\nolimits_{a = 0}^{p}
(-1)^a
\alpha_{t(j_0)\ldots t(j_a) t'(j_a) \ldots t'(j_p)}
\end{align*}
for an element $\alpha$ of degree $n$. This works
because of the following computation, again with
$\alpha$ an elemement of degree $n$ (so $d(\alpha)$
has degree $n + 1$ and $h(\alpha)$ has degree $n-1$):
\begin{align*}
& (
d(h(\alpha)) + h(d(\alpha))
)_{j_0\ldots j_p}
\cr
& =
d_{\mathcal F}(h(\alpha)_{j_0\ldots j_p})
+
(-1)^{(n-1)-(p-1)}
\sum\nolimits_{k = 0}^p
(-1)^k
h(\alpha)_{j_0\ldots\hat j_k\ldots j_p}
\cr
& +
(-1)^{n + 1 + p}
\sum\nolimits_{a = 0}^p
(-1)^a
d(\alpha)_{t(j_0)\ldots t(j_a) t'(j_a) \ldots t'(j_p)}
\cr
& =
(-1)^{n + p}
\sum\nolimits_{a = 0}^p
(-1)^a
d_{\mathcal F}(\alpha_{t(j_0)\ldots t(j_a) t'(j_a) \ldots t'(j_p)})
\cr
& +
(-1)^{(n-1)-(p-1)}
\sum\nolimits_{k = 0}^p
(-1)^{k + n + p-1}
\sum\nolimits_{a = 0}^{k-1}
(-1)^a
\alpha_{t(j_0)\ldots t(j_a)t'(j_a)\ldots\hat{t'(j_k)}\ldots t'(j_p)}
\cr
& +
(-1)^{(n-1)-(p-1)}
\sum\nolimits_{k = 0}^p
(-1)^{k + n + p-1}
\sum\nolimits_{a = k + 1}^p
(-1)^{a-1}
\alpha_{t(j_0)\ldots\hat{t(j_k)}\ldots t(j_a)t'(j_a)\ldots t'(j_p)}
\cr
& +
(-1)^{n + 1 + p}
\sum\nolimits_{a = 0}^p
(-1)^a
d_{\mathcal F}(\alpha_{t(j_0)\ldots t(j_a) t'(j_a) \ldots t'(j_p)})
\cr
& +
(-1)^{n + 1 + p}
\sum\nolimits_{a = 0}^p
(-1)^{a + n-p}
\sum\nolimits_{k = 0}^a
(-1)^k
\alpha_{t(j_0)\ldots \hat{t(j_k)}\ldots t(j_a)t'(j_a)\ldots t'(j_p)}
\cr
& +
(-1)^{n + 1 + p}
\sum\nolimits_{a = 0}^p
(-1)^{a + n-p}
\sum\nolimits_{k = a}^p
(-1)^{k + 1}
\alpha_{t(j_0)\ldots t(j_a)t'(j_a)\ldots \hat{t'(j_k)}\ldots t'(j_p)}
\cr
& =
\alpha_{t(j_0)\ldots t(j_p)} - \alpha_{t'(j_0)\ldots t'(j_p)}
=
T_t(\alpha)_{j_0\ldots j_p} - T_{t'}(\alpha)_{j_0\ldots j_p}
\end{align*}
We leave it to the reader to verify the cancellations.
It follows that the induced map
$$
H^*(T_t) :
H^*(s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)) \to
H^*(s{\mathcal C}^*({\mathcal V}, {\mathcal F}^*))
$$
is independend of the choice of $t$. We define
Cech hypercohomology as the limit of the Cech cohomology groups
over all refinements via the maps $H^*(T_t)$.

\medskip\noindent
Let ${\mathcal I}^*$ be a bounded below complex of injectives. Consider
the map $\Gamma(X, {\mathcal I}^*) \to
s{\mathcal C}^*({\mathcal U}, {\mathcal I}^*)$ defined in degree $n$ by
$i \mapsto \alpha = \{\alpha_{i_0\ldots i_p}\}$ with
$\alpha_{i_0} = i|_{U_{i_0}}$ and $\alpha_{i_0\ldots i_p} = 0$
for $p>0$. This is a quasi-isomorphism of complexes of abelian groups
(prove by a spectral sequence argument on the double complex
${\mathcal C}^*({\mathcal U}, {\mathcal I}^*)$).
Suppose ${\mathcal F}^* \to {\mathcal I}^*$ is a quasi-isomorphism
of ${\mathcal F}^*$ into a bounded below complex of injectives.
The hypercohomology ${\bf H}^*(X, {\mathcal F}^*)$ is defined
to be $H^*(\Gamma(X, {\mathcal I}^*))$. Thus
the corresponding map $s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*) \to
s{\mathcal C}^*({\mathcal U}, {\mathcal I}^*)$ induces maps
$H^*(s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)) \to
{\bf H}^*(X, {\mathcal F}^*)$.
In the limit this induces a map of Cech hypercohomology into
the cohomology, which is usually an isomorphism and is always
an isomorphism if we use hypercoverings.

\medskip\noindent
Consider the map $\tau : s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*) \to
s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)$ defined by
$$
\tau(\alpha)_{i_0\ldots i_p} = (-1)^{p(p + 1)/2} \alpha_{i_p\ldots i_0}.
$$
Then we have for an element $\alpha$ of degree $n$ that
\begin{align*}
d(\tau(\alpha))_{i_0\ldots i_{p + 1}}
& =
d_{\mathcal F}(\tau(\alpha)_{i_0\ldots i_{p + 1}})
+
(-1)^{n-p}
\sum\nolimits_{j = 0}^{p + 1}
(-1)^j
\tau(\alpha)_{i_0\ldots \hat i_j\ldots i_{p + 1}}
\cr
& =
(-1)^{(p + 1)(p + 2)/2}
d_{\mathcal F}(\alpha_{i_{p + 1}\ldots i_0}))
+
(-1)^{n-p}
\sum\nolimits_{j = 0}^{p + 1}
(-1)^{j + p(p + 1)/2}
\alpha_{i_{p + 1}\ldots \hat i_j\ldots i_0}
\end{align*}
On the other hand we have
\begin{align*}
\tau(d(\alpha))_{i_0\ldots i_{p + 1}}
& =
(-1)^{(p + 1)(p + 2)/2} d(\alpha)_{i_{p + 1}\ldots i_0}
\cr
& =
(-1)^{(p + 1)(p + 2)/2}
d_{\mathcal F}(\alpha_{i_{p + 1}\ldots i_0})
+
(-1)^{(p + 1)(p + 2)/2 + n-p}
\sum\nolimits_{j = 0}^{p + 1}
(-1)^j
\alpha_{i_{p + 1}\ldots \hat i_{p + 1-j}\ldots i_0}
\cr
& =
(-1)^{(p + 1)(p + 2)/2}
d_{\mathcal F}(\alpha_{i_{p + 1}\ldots i_0})
+
(-1)^{(p + 1)(p + 2)/2 + n-p}
\sum\nolimits_{j = 0}^{p + 1}
(-1)^{j-p-1}
\alpha_{i_{p + 1}\ldots \hat i_j\ldots i_0}
\end{align*}
Thus we conclude that $d(\tau(\alpha)) = \tau(d(\alpha))$
because $p(p + 1)/2 \equiv (p + 1)(p + 2)/2 + p + 1 \bmod 2$. In other words
$\tau$ is an endomorphism of the complex
$s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)$. Note that the diagram
$$
\begin{matrix}
\Gamma(X, {\mathcal F}^*) &
\longrightarrow &
s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*) \cr
\downarrow {\rm id} & & \downarrow \tau \cr
\Gamma(X, {\mathcal F}^*) &
\longrightarrow &
s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*) \cr
\end{matrix}
$$
commutes. In addition $\tau$ is clearly compatible with refinements.
This proves that $\tau$ acts as the identity on Cech hypercohomology
(i.e., in the limit -- provided Cech hypercohomology agrees with
hypercohomology, which is always the case if we use hypercoverings).
To see this use a quasi-isomorphism ${\mathcal F}^* \to {\mathcal I}^*$ of
${\mathcal F}^*$ into a bounded below complex of injectives as before.
We claim that $\tau$ actually is homotopic to the identity on the
simple Cech complex $s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)$.
To prove this, we use as homotopy
$$
h(\alpha)_{i_0\ldots i_p}
=
(-1)^{n + p}
\sum\nolimits_{a = 0}^{p}
(-1)^a
\alpha_{i_0\ldots i_a i_{p-a} \ldots i_0}
$$
for $\alpha$ of degree $n$. As usual we omit writing
$|_{U_{i_0\ldots i_p}}$. This works
because of the following computation, again with
$\alpha$ an elemement of degree $n$ (so $d(\alpha)$
has degree $n + 1$ and $h(\alpha)$ has degree $n-1$):
\begin{align*}
& (
d(h(\alpha)) + h(d(\alpha))
)_{i_0\ldots i_p}
\cr
& =
d_{\mathcal F}(h(\alpha)_{i_0\ldots i_p})
+
(-1)^{(n-1)-(p-1)}
\sum\nolimits_{k = 0}^p
(-1)^k
h(\alpha)_{i_0\ldots\hat i_k\ldots i_p}
\cr
& +
(-1)^{n + 1 + p}
\sum\nolimits_{a = 0}^p
(-1)^a
d(\alpha)_{i_0\ldots i_a i_{p-a} \ldots i_0}
\cr
& =
(-1)^{n + p}
\sum\nolimits_{a = 0}^p
(-1)^a
d_{\mathcal F}(\alpha_{i_0\ldots i_a i_{p-a} \ldots i_0})
\cr
& +
(-1)^{(n-1)-(p-1)}
\sum\nolimits_{k = 0}^p
(-1)^{k + n + p-1}
\sum\nolimits_{a = 0}^{k-1}
(-1)^a
\alpha_{i_0\ldots i_a i_{p-a}\ldots\hat{i_{p-k}}\ldots i_0}
\cr
& +
(-1)^{(n-1)-(p-1)}
\sum\nolimits_{k = 0}^p
(-1)^{k + n + p-1}
\sum\nolimits_{a = k + 1}^p
(-1)^{a-1}
\alpha_{i_0\ldots\hat{i_k}\ldots i_a i_{p-a}\ldots i_0}
\cr
& +
(-1)^{n + 1 + p}
\sum\nolimits_{a = 0}^p
(-1)^a
d_{\mathcal F}(\alpha_{i_0\ldots i_a i_{p-a} \ldots i_0})
\cr
& +
(-1)^{n + 1 + p}
\sum\nolimits_{a = 0}^p
(-1)^{a + n-p}
\sum\nolimits_{k = 0}^a
(-1)^k
\alpha_{i_0\ldots \hat{i_k}\ldots i_a i_{p-a}\ldots i_0}
\cr
& +
(-1)^{n + 1 + p}
\sum\nolimits_{a = 0}^p
(-1)^{a + n-p}
\sum\nolimits_{k = a}^p
(-1)^{k + 1}
\alpha_{i_0\ldots i_a i_{p-a}\ldots \hat{i_{p-k}}\ldots i_0}
\cr
& =
\alpha_{i_0 \ldots i_p} - \alpha_{i_p \ldots i_0}
\end{align*}
We leave it to the reader to verify the cancellations.


\medskip\noindent
Suppose we have two bounded complexes complexes of sheaves
${\mathcal F}^*$ and ${\mathcal G}^*$. We define the complex
$Tot({\mathcal F}^*\otimes_{\bf Z} {\mathcal G}^*)$
to be to complex with terms
$\otimes_{p + q = n} {\mathcal F}^p \otimes {\mathcal G}^q$
and differential according to the rule $d(\alpha \otimes \beta) =
d(\alpha)\otimes \beta + (-1)^{\deg(\alpha)} \alpha \otimes d(\beta)$
when $\alpha$ and $\beta$ are homogenous. We apply the same rule
to define the total complex associated to a tensor product of
complexes of abelian groups (the case when the space is a point).

\medskip\noindent
Suppose that $M^*$ and $N^*$ are two bounded below
complexes of abelian groups. Then if $m$, resp.\ $n$
is a cocycle for $M^*$, resp.\ $N^*$, it is immediate
that $m \otimes n$ is a cocycle for $Tot(M^*\otimes N^*)$.
Hence a cupproduct
$$
H^i(M^*) \times H^j(N^*) \to H^{i + j}(Tot(M^*\otimes N^*)).
$$

\medskip\noindent
So the construction of the cup product in hypercohomology
of complexes rests on a construction of a map of complexes
$$
Tot(s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)
\otimes_{\bf Z}
s{\mathcal C}^*({\mathcal U}, {\mathcal G}^*))
\longrightarrow
s{\mathcal C}^*({\mathcal U}, Tot({\mathcal F}^*\otimes {\mathcal G}^*)), \ 
\alpha \otimes \beta \mapsto \alpha \cup \beta.
$$
This is done by the rule
$$
(\alpha \cup \beta)_{i_0\ldots i_p}
=
\sum\nolimits_{r = 0}^p
(-1)^{r(m-(p-r))}
\alpha_{i_0\ldots i_r} \otimes \beta_{i_r\ldots i_p}.
$$
where $\alpha$ has degree $n$ and $\beta$ has degree $m$.
Note that $\alpha \cup \beta$ has degree $n + m$.
For an explanation of the sign see the paper
``Higher order operations in Deligne cohomology'' by Denninger
who refers to the paper ``cohomologie a support propres'' by Deligne
for a more precise explanation.
To check this is a map of complexes we have to show that
$$
d(\alpha \cup \beta) =
d(\alpha) \cup \beta +
(-1)^{\deg(\alpha)} \alpha \cup d(\beta)
$$
because $d(\alpha \otimes \beta) = d(\alpha)\otimes\beta
+ (-1)^{\deg(\alpha)} \alpha\otimes d(\beta)$ is the formula
for the differential on $Tot(s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)
\otimes_{\bf Z} s{\mathcal C}^*({\mathcal U}, {\mathcal G}^*))$. We compute
first
\begin{align*}
d(\alpha \cup \beta)_{i_0\ldots i_{p + 1}}
& =
d_{{\mathcal F}\otimes {\mathcal G}}
\Big(
(\alpha \cup \beta)_{i_0\ldots i_{p + 1}}
\Big)
+
(-1)^{n + m-p}
\sum\nolimits_{j = 0}^{p + 1}
(-1)^j
(\alpha \cup \beta)_{i_0\ldots\hat i_j\ldots i_{p + 1}}
\cr
& =
\sum\nolimits_{r = 0}^{p + 1}
(-1)^{r(m-(p + 1-r))}
d_{{\mathcal F}\otimes {\mathcal G}}
(
\alpha_{i_0\ldots i_r} \otimes \beta_{i_r\ldots i_{p + 1}}
)
\cr
& +
(-1)^{n + m-p}
\sum\nolimits_{j = 0}^{p + 1}
(-1)^j
\sum\nolimits_{r = 0}^{j-1}
(-1)^{r(m-(p-r))}
\alpha_{i_0\ldots i_r} \otimes \beta_{i_r\ldots\hat i_j\ldots i_{p + 1}}
\cr
& +
(-1)^{n + m-p}
\sum\nolimits_{j = 0}^{p + 1}
(-1)^j
\sum\nolimits_{r = j + 1}^{p + 1}
(-1)^{(r-1)(m-(p + 1-r))}
\alpha_{i_0\ldots\hat i_j\ldots i_r} \otimes \beta_{i_r\ldots i_{p + 1}}
\end{align*}
On the other hand
\begin{align*}
(d(\alpha) \cup \beta)_{i_0\ldots i_{p + 1}}
& =
\sum_{r = 0}^{p + 1}
(-1)^{r(m-(p + 1-r))}
d(\alpha)_{i_0\ldots i_r} \otimes \beta_{i_r\ldots i_{p + 1}}
\cr
& =
\sum_{r = 0}^{p + 1}
(-1)^{r(m-(p + 1-r))}
d_{\mathcal F}(\alpha_{i_0\ldots i_r}) \otimes \beta_{i_r\ldots i_{p + 1}}
\cr
& +
\sum_{r = 0}^{p + 1}
(-1)^{r(m-(p + 1-r))+n-(r-1)}
\sum\nolimits_{j = 0}^{r}
(-1)^j
\alpha_{i_0\ldots\hat{i_j}\ldots i_r} \otimes \beta_{i_r\ldots i_{p + 1}}
\end{align*}
and
\begin{align*}
(-1)^n (\alpha \cup d(\beta))_{i_0\ldots i_{p + 1}}
& =
(-1)^n
\sum_{r = 0}^{p + 1}
(-1)^{r(m + 1-(p + 1-r))}
\alpha_{i_0\ldots i_r} \otimes d(\beta)_{i_r\ldots i_{p + 1}}
\cr
& =
(-1)^n
\sum_{r = 0}^{p + 1}
(-1)^{r(m + 1-(p + 1-r))}
\alpha_{i_0\ldots i_r} \otimes d_{\mathcal G}(\beta_{i_r\ldots i_{p + 1}})
\cr
& +
(-1)^n
\sum_{r = 0}^{p + 1}
(-1)^{r(m + 1-(p + 1-r))+m-(p-r)}
\sum\nolimits_{j = r}^{p + 1}
(-1)^{j-r}
\alpha_{i_0\ldots i_r} \otimes \beta_{i_r\ldots\hat{i_j}\ldots i_{p + 1}}
\end{align*}
Now you can see the desired equality.

\medskip\noindent
Associativity of the cupproduct. Suppose that ${\mathcal F}^*$,
${\mathcal G}^*$ and ${\mathcal H}^*$ are bounded below
complexes of abelian groups on $X$. The obvious map
(without the intervention of signs) is an isomorphism
of complexes
$$
Tot(Tot({\mathcal F}^*\otimes_{\bf Z} {\mathcal G}^*)\otimes_{\bf Z}
{\mathcal H}^*)
\longrightarrow
Tot({\mathcal F}^*\otimes_{\bf Z} Tot({\mathcal G}^*\otimes_{\bf Z}
{\mathcal H}^*)).
$$
Using this map it is easy to verify that
$$
(\alpha \cup \beta) \cup \gamma = \alpha \cup ( \beta \cup \gamma)
$$
namely, if $\alpha$ has degree $a$, $\beta$ has degree $b$ and
$\gamma$ has degree $c$, then
\begin{align*}
((\alpha \cup \beta) \cup \gamma)_{i_0\ldots i_p}
& =
\sum_{r = 0}^p
(-1)^{r(c-(p-r))}
(\alpha\cup\beta)_{i_0\ldots i_r} \otimes \gamma_{i_r\ldots i_p}
\cr
& =
\sum_{r = 0}^p
(-1)^{r(c-(p-r))}
\sum_{s = 0}^r
(-1)^{s(b-(r-s))}
\alpha_{i_0\ldots i_s} \otimes \beta_{i_s\ldots i_r} \otimes
\gamma_{i_r\ldots i_p}
\end{align*}
and
\begin{align*}
(\alpha \cup (\beta \cup \gamma)_{i_0\ldots i_p}
& =
\sum_{s = 0}^p
(-1)^{s(b + c-(p-s))}
\alpha_{i_0\ldots i_s} \otimes (\beta \cup \gamma)_{i_s\ldots i_p}
\cr
& =
\sum_{s = 0}^p
(-1)^{s(b + c-(p-s))}
\sum_{r = s}^p
(-1)^{(r-s)(c-(p-r))}
\alpha_{i_0\ldots i_s} \otimes \beta_{i_s\ldots i_r} \otimes
\gamma_{i_r\ldots i_p}
\end{align*}
and a trivial mod $2$ calculation shows the signs match up.

\medskip\noindent
Finally, we indicate why the cup product preserves
a graded commutative structure, at least on a cohomological level.
For this we use the operator
$\tau$ introduced above. Let ${\mathcal F}^*$ be a bounded below
complexes of abelian groups, and assume we are given
a graded commutative multiplication
$$
\wedge^* : Tot({\mathcal F}^*\otimes {\mathcal F}^*) \to {\mathcal F}^*.
$$
This means the following: For $s$ a local section of
${\mathcal F}^a$, and $t$ a local section of ${\mathcal F}^b$
we have $s \wedge t$ a local section of ${\mathcal F}^{a + b}$.
Graded commutative means we have
$s \wedge t = (-1)^{ab} t \wedge s$. Since $\wedge$ is a map
of complexes we have
$d(s\wedge t) = d(s) \wedge t + (-1)^a s \wedge t$.
The composition
$$
Tot(
s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)
\otimes
s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)
) \longrightarrow
s{\mathcal C}^*({\mathcal U}, Tot({\mathcal F}^*\otimes_{\bf Z}{\mathcal F}^*))
\longrightarrow
s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)
$$
induces a cup product on cohomology
$$
H^n(s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*))
\times
H^m(s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*))
\longrightarrow
H^{n + m}(s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)).
$$
and so in the limit also a product on Cech hypercohomology
and therefore (using hypercoverings if needed) a product
in hypercohomology of ${\mathcal F}^*$. We claim this product
(on cohomology) is graded commutative as well. To prove this
we first consider an element $\alpha$ of degree $n$ in
$s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)$ and an element
$\beta$ of degree $m$ in $s{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)$
and we compute
\begin{align*}
\tau( \alpha \cup \beta )_{i_0\ldots i_p}
& =
(-1)^{p(p + 1)/2}
(\alpha \cup \beta)_{i_p\ldots i_0}
\cr
& =
(-1)^{p(p + 1)/2}
\sum\nolimits_{r = 0}^p
(-1)^{(p-r)(m-r)}
\alpha_{i_p\ldots i_r}\otimes \beta_{i_r\ldots i_0}
\cr
& =
(-1)^{p(p + 1)/2}
\sum\nolimits_{r = 0}^p
(-1)^{(p-r)(m-r) + r(r + 1)/2 + (p-r)(p-r + 1)/2}
\tau(\alpha)_{i_r\ldots i_p}\otimes \tau(\beta)_{i_0\ldots i_r}
\end{align*}
The image of this in $s^{n + m}{\mathcal C}^*({\mathcal U}, {\mathcal F}^*)$
equals
$$
(-1)^{p(p + 1)/2}
\sum\nolimits_{r = 0}^p
(-1)^{(p-r)(m-r) + r(r + 1)/2 + (p-r)(p-r + 1)/2 + (m-r)(n-(p-r))}
\tau(\beta)_{i_0\ldots i_r} \wedge \tau(\alpha)_{i_r\ldots i_p}
$$
because $\wedge$ is graded commutative. But this is the same
as the image of
$$
(-1)^{nm}
(\tau(\beta) \cup \tau(\alpha))_{i_0\ldots i_p}
=
(-1)^{nm}
\sum\nolimits_{r = 0}^p
(-1)^{r(n-(p-r))}
\tau(\beta)_{i_0\ldots i_r} \otimes \tau(\alpha)_{i_r\ldots i_p}
$$
This proves the desired result since we proved earlier that
$\tau$ acts as the identity on cohomology.


\medskip\noindent
Suppose that
$$
0
\to
{\mathcal F}_1^*
\to
{\mathcal F}_2^*
\to
{\mathcal F}_3^*
\to
0
$$
and
$$
0
\leftarrow
{\mathcal G}_1^*
\leftarrow
{\mathcal G}_2^*
\leftarrow
{\mathcal G}_3^*
\leftarrow
0
$$
are short exact sequences of bounded below complexes of abelian
sheaves on $X$. We will use the following convention and notation: we think of
${\mathcal F}_1^q$ as a subsheaf of ${\mathcal F}_2^q$ and we think of
${\mathcal G}_3^q$ as a subsheaf of ${\mathcal G}_2^q$. Hence if $s$ is
a local section of ${\mathcal F}_1^q$ we use $s$ to denote
the corresponding section of ${\mathcal F}_2^q$ as well. Similarly
for local sections of ${\mathcal G}_3^q$. Furthermore,
if $s$ is a local section of ${\mathcal F}_2^q$ then we denote
$\bar s$ its image in ${\mathcal F}_3^q$. Similarly for the
map ${\mathcal G}_2^q \to {\mathcal G}^q_1$. In particular if
$s$ is a local section of ${\mathcal F}_2^q$ and $\bar s = 0$
then $s$ is a local section of ${\mathcal F}_1^q$. Let ${\mathcal H}^*$
be another complex of abelian sheaves, and suppose
we have maps of comlpexes
$$
\gamma_i :
Tot({\mathcal F}_i^* \otimes_{\bf Z} {\mathcal G}_i^*)
\longrightarrow
{\mathcal H}^*
$$
which are compatible with the maps between the complexes. So for
example, for local sections $s$ of ${\mathcal F}_2^q$ and
$t$ pf ${\mathcal G}_3^{q'}$ we have $\gamma_2(s\otimes t)
= \gamma_3(\bar s \otimes t)$ as sections of ${\mathcal H}^{q + q'}$.
In this situation, suppose that ${\mathcal U} = \{ U_i \}_{i\in I}$
is an open covering of $X$. Suppose that $\alpha$, resp.\ 
$\beta$ is an element of $s^n{\mathcal C}^*({\mathcal U}, {\mathcal F}_2^*)$,
resp.\ $s^m{\mathcal C}^*({\mathcal U}, {\mathcal G}_2^*)$ with the
property that
$$
d(\bar \alpha) = 0, \ \hbox{and}\ d(\bar \beta) = 0.
$$
This means that
\begin{enumerate}
\item $\alpha_3 = \bar \alpha$ is a degree $n$ cocycle
in the simple complex $s{\mathcal C}^*({\mathcal U}, {\mathcal F}_3^*)$,
\item $\alpha_1 = d(\alpha)$ is a degree $n + 1$
cocycle in the simple complex
$s{\mathcal C}^*({\mathcal U}, {\mathcal F}_1^*)$,
\item $\beta_1 = \bar \beta$ is a degree $n$ cocycle
in the simple complex
$s{\mathcal C}^*({\mathcal U}, {\mathcal G}_1^*)$, and
\item $\beta_3 = d(\beta)$ is a degree $m + 1$
cocycle in the simple complex
$s{\mathcal C}^*({\mathcal U}, {\mathcal G}_3^*)$.
\end{enumerate}

\noindent
I claim that
$$
\gamma_1( \alpha_1 \cup \beta_1), \ \hbox{and}\ 
\gamma_3( \alpha_3 \cup \beta_3)
$$
represent the same cohology class up to sign.
The reason is simply that we may compute
\begin{align*}
d( \gamma_2(\alpha \cup \beta) )
& =
\gamma_2( d( \alpha \cup \beta) )
\cr
& =
\gamma_2( d(\alpha) \cup \beta + (-1)^n \alpha \cup d(\beta) )
\cr
& =
\gamma_2( \alpha_1 \cup \beta)  + (-1)^n \gamma_2( \alpha \cup \beta_3)
\cr
& =
\gamma_1( \alpha_1 \cup \beta_1) + (-1)^n \gamma_3( \alpha_3 \cup \beta_3)
\end{align*}
So this even tells us that the sign is $(-1)^{n + 1}$.






\input{chapters}

\bibliography{my}
\bibliographystyle{alpha}

\end{document}
