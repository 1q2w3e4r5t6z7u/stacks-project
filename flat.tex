\input{preamble}

% OK, start here.
%
\begin{document}

\title{Flat Descent}

\maketitle

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we discuss the flat topology.

\section{Descent for quasi-coherent sheaves}
\label{section-equivalence}

\noindent
Let me state our goal now so we have a clear idea of what we are
trying to achieve. It is to show that the fibered category $(\text{QCoh}/S)$
(of quasi-coherent sheaves over a scheme $S$) over $\text{Sch}/S$ (the
category of schemes over $S$) is a stack with respect to the flat
topology.  The idea is that we will be able to exploit the fact that
there is a standard equivalence of categories between $\text{QCoh}(U)$ and
$\text{Mod}_A$ where $U = \text{Spec}(A)$, and then use Lemma
\ref{lemma-zariski-flat}.

\begin{lemma}
\label{lemma-zariski-flat}
(\cite{Vis2}, Lemma 4.25)
Let $S$ be a scheme, $\mathcal F$ be a fibered category over the
category $(Sch/S)$.  Suppose the following conditions are satisfied.
\begin{enumerate}
\item $\mathcal F$ is a stack with respect to the Zariski topology.
\item Whenever $V \rightarrow U$ is a flat surjective morphism of affine
$S$-schemes, the functor
$\mathcal F(U) \rightarrow  \mathcal F(V \rightarrow U)$ is an equivalence of
categories.
\end{enumerate}
Then $\mathcal F$ is a stack with respect to the flat (fpqc) topology.	
\end{lemma}
\begin{proof}
FIXME: Add proof.
\end{proof}

\noindent
Note that the fpqc topology stands for "fidelment plat et quasi-compact" which
means faithfully flat and quasi-compact.  This is a finer topology than the
fppf topology which is a finer topology than the etale topology.


\medskip\noindent In the case of $(\text{QCoh}/S)$ over
$(\text{Sch}/S)$ we can easily see that the first condition is
satisfied (i.e in the Zariski topology our definition for
quasi-coherent sheaves is exactly the conditions needed for the
descent datum to be effective).

\medskip\noindent For the second condition, it will be necessary to
define certain notions and to prove certain algebraic results.  We
begin with some definitions.

\begin{definition}
\label{definition-faithfully-flat}
A morphism of schemes $f: X \rightarrow Y$ is faithfully flat if it is flat
and surjective.  Let $B$ be an algebra over $A$, we say that $B$ is
{\it faithfully flat} if the associated morphism of schemes
$\text{Spec} B \rightarrow \text{Spec} A$ is.
\end{definition}

\begin{proposition}
\label{proposition-faithfully-flat}
Let $B$ be an algebra over $A$, the following are equivalent.
\begin{enumerate}
\item $B$ is faithfully flat over $A$.
\item A sequence of $A$-modules $M' \rightarrow M \rightarrow M''$ is exact
if and only if the induced sequence of $B$-modules
$M' \otimes_A B \rightarrow M \otimes_A B \rightarrow M'' \otimes_A B$
is exact.
\item A homomorphism of $A$ modules $M' \rightarrow M$ is injective if and
only if the associated homomorphism of $B$-modules
$M' \otimes_A B \rightarrow M \otimes_A B$ is injective.
\item $B$ is flat over $A$, and if $M$ is a module over $A$ with
$M \otimes_A B = 0$, we have $M = 0$.
\item $B$ is flat over $A$, and $mB \neq B$ for all maximal ideals $m$
of $A$.	
\end{enumerate}
\end{proposition}

\begin{definition}
\label{definition-category-descent-datum}
Let $\mathcal C$ be a site.  Let $\mathcal F$ be a category fibered over
$\mathcal C$.  Let $\mathcal U = \{\sigma_i : U_i \rightarrow U\}$ be a
covering in $\mathcal C$.  An object with {\it descent data}
$(\{\xi_i\}, \{\phi_{ij}\})$ on $\mathcal U$ is a collection of objects
$\xi_i \in \mathcal F(U_i)$, together with isomorphisms
$\phi_{ij}: pr_2^*\xi_j \simeq pr_1^*\xi_i$ in
$\mathcal F(U_i \times_U U_j)$, such that the following cocyle condition
is satisfied:  for any triple of indicies $i, j, k$ we have the equality
$pr_{13}^*\phi_{ik} = pr_{12}^*\phi_{ij} \circ pr_{23}^*\phi_{jk}:
pr_3^*\xi_k \rightarrow pr_1^*\xi_i$.  Where $pr_{ab}$ and $pr_a$
projections onto the $a^{th}$ and $b^{th}$ factor, or the the $a^{th}$
factor respectively.

\medskip\noindent
An arrow between objects with descent data
$\{\alpha_i\}: (\{\xi_i\}, \{\phi_{ij}\}) \rightarrow
(\{\eta_i\}, \{\psi_{ij}\})$ is a collection of arrows
$\alpha_i : \xi_i \rightarrow \eta_i$ in $\mathcal F(U_i)$ with the property
that for each pair of indicies $i, j$ the cocycle condition is satisfied.

\medskip\noindent
There is an obvious way of composing morphisms, which makes the objects with
descent data the objects of a category which we will denote
$\mathcal F(\{U_i \rightarrow U\})$

\medskip\noindent
Specifically in the case of the lemma we are only interested in the case where
$U = \text{Spec}(A)$ is affine.  So it can be covered by one affine scheme
$V = \text{Spec}(B)$.  In this case the above definition reduces to the
following:  $\mathcal F(V \rightarrow U)$ is the category consisting of pairs
$(\xi, \phi)$ where $\xi \in \mathcal F(V)$ and
$\phi: p_1^*\xi  \simeq p_2^*\xi$ is an isomorphism which satisfies the
cocycle condition.
\end{definition}

\noindent
To continue we need to set some conventions.  Let $A$ be a commutative ring,
and denote $\text{Mod}_A$ as the category of modules over $A$.  We also have a
ring
homomorphism $f: A \rightarrow B$.  We define a category
$\text{Mod}_{A\rightarrow B}$ as follows.  Let the objects be pairs $(N, \phi)$
where $N$ is a $B$-module and $\phi:  N \otimes_A B \simeq B \otimes_A N$
is an isomorphism of $B^{\otimes p2}$-modules such that the following cocycle
condition is satisfied:
\begin{eqnarray}
\phi_1: B \otimes_A N \otimes_A B & \rightarrow & B \otimes_A B \otimes_A N,
\nonumber\\
\phi_2: N \otimes_A B \otimes_A B & \rightarrow & B \otimes_A B \otimes_A B,
\nonumber\\
\phi_3: N \otimes_A B \otimes_A B & \rightarrow & B \otimes_A N \otimes_A B,
\nonumber
\end{eqnarray}
where $\phi_1 = \text{id}_B \otimes \phi$, $\phi_3 = \phi \otimes \text{id}_B$,
and
$\phi_2 = \phi_1\phi_3$.

\medskip\noindent
A morphism $\beta:  (N, \phi) \rightarrow (N', \phi')$ is a homomorphism of
$B$-modules $\beta: N \rightarrow N'$ making the following diagram commute:
\begin{center}
\(
\begin{array}{ccc}
N \otimes_A B & \stackrel{\phi}{\longrightarrow} & B \otimes_A N \\
\beta \otimes \text{id}_B \downarrow & & \downarrow \text{id}_B \otimes \beta \\
N' \otimes_A B & \stackrel{\phi'}{\longrightarrow} & B \otimes_A N'
\end{array}
\)
\end{center}

\medskip\noindent
Given a functor $F: \text{Mod}_A \rightarrow \text{Mod}_{A\rightarrow B}$ which
takes an
$A$-module $M$ to the pair $(B\otimes_A M, \phi_M)$ where
$\phi_M: (B\otimes_A M)\otimes_A B \rightarrow B \otimes_A (B \otimes_A M)$
maps $b \otimes m \otimes b'$ to $b \otimes b' \otimes m$ (and satisfies the
cocyle condition).

\begin{theorem}
\label{theorem-flat-descent-rings}
If $B$ is faithfully flat over $A$, the functor
$F: \text{Mod}_A \rightarrow \text{Mod}_{A\rightarrow B}$ as defined above is an
equivalence of categories.
\end{theorem}

\noindent
To prove this we first need the following lemma

\begin{lemma}
\label{lemma-exactness}
Let $M$ be an $A$-module.  Then the following sequence
$$
0 \rightarrow M \stackrel{\alpha_M}{\longrightarrow}
B \otimes_A M \stackrel{(e_1 - e_2)\otimes \text{id}_M}{\longrightarrow}
B^{\otimes 2}\otimes_A M
\stackrel{(e_1-e_2 + e_3)\otimes \text{id}_M}{\longrightarrow}
B^{\otimes 3} \otimes_A M \rightarrow \cdots
$$
is exact.  Where $e_i:  B^{\otimes n} \rightarrow B^{\otimes n + 1}$ is the
map that puts a $1$ into the $i^{th}$ place of the tensor product.
\end{lemma}

\begin{proof}
It is easy to see that $\alpha_M$ is an injective map, and that images of
all of the maps will be contained in the appropriate kernels.  So what we
need to show is that we have reverse containment (i.e. kernels contained
in images) at each step of the sequence.  If there existed a section
$B\otimes_A M \rightarrow M$ then this will be easy (for reasons we will see
soon).  However, there does not always exist such a map.

\medskip\noindent
Luckily we can use the fact that $B$ is flat over $A$, and that a sequence
of $A$-modules is exact if and only if the sequence tensored with $B$ is
exact.  This is fortunate because once we tensor our sequence with $B$ we get
the following sequence (with the same maps as in the statement of the lemma
just with tensored with a $\text{id}_B$ on the left):
$$
0 \rightarrow B \otimes_A M \rightarrow  B^{\otimes 2} \otimes_A M
\rightarrow B^{\otimes 3}\otimes_A M \rightarrow
B^{\otimes 4} \otimes_A M \rightarrow \cdots.
$$

\medskip\noindent
And there is a natural map $B^{\otimes 2} \otimes_A M
\stackrel{mult}{\rightarrow} B \otimes_A M$ which just takes
$b\otimes b' \otimes m$ to the element $bb' \otimes m$.  In other words it
is just the multiplication map $B\otimes_A B \rightarrow B$ composed with the
identity on $M$.

Now, to prove that the sequence is exact at $B^{\otimes 2} \otimes_A M$, we
pick an element $\Sigma b_i \otimes b'_i \otimes m_i$ in the kernel of the
map $\text{id}_B \circ (e_1-e_2) \circ \text{id}_M$.  This means that in
$B^{\otimes_3} \otimes_A M$ we have the following relation:
$\Sigma b_i\otimes b'_i \otimes 1 \otimes m_i =
\Sigma b_i \otimes 1 \otimes b'_i \otimes m_i$.  We then apply the map
$mult \circ \text{id}_B \circ \text{id}_M$ to the equality and get the
$\Sigma b_ib'_i \otimes 1 \otimes m_i = b_i \otimes b'_i \otimes m_i$
in $B^{\otimes 2} \otimes_A M$.  So we are getting
$\text{id}_B \circ \alpha_M (\Sigma b_ib'_i \otimes m_i) =
\Sigma b_i\otimes b'_i \otimes m_i$ which was the element from the kernel
that we chose.  Thus every element in the kernel is also in the image of
the appropriate map hence the sequence is exact there.  The same argument
can be made at each step of the sequence to show that the appropriate
kernels are contained in the appropriate images.  A choice for sections
that work is simply multiplication composed with whatever number of identity
maps are necessary.
\end{proof}

\begin{proof}[Proof of the theorem]
So to prove the theorem we need to first consider the functor
$F: \text{Mod}_A \rightarrow \text{Mod}_{A\rightarrow B}$ which takes an
$A$-module $M$
to the pair $(B\otimes_A M, \phi_M)$ where
$\phi_M: (B\otimes_A M)\otimes_A B \rightarrow B \otimes_A (B \otimes_A M)$
maps $b \otimes m \otimes b'$ to $b \otimes b' \otimes m$.

\medskip\noindent
To show that $F$ is an equivalence of categories, we need to show that there
is a functor $G: \text{Mod}_{A\rightarrow B} \rightarrow \text{Mod}_A$ such
that $GF$ and
$FG$ are isomorphic to the identity.

\medskip\noindent
So let us define a functor $G$ to take pairs $(N, \phi)$ to elements
$GN = \{n \in N | 1\otimes n = \phi(n\otimes 1)\}$ and given a morphism
$\beta:  (N, \phi) \rightarrow (N', \phi')$ in $\text{Mod}_{A\rightarrow B}$ we
get a morphism $\beta_G: GN \rightarrow GN'$.

\medskip\noindent
So first let us check that $GF$ is isomorphic to the identity.  Notice
that
$$
((e_1-e_2)\otimes \text{id}_M)(b \otimes m) =
b \otimes 1 \otimes m - 1 \otimes b \otimes m =
\phi_M(b\otimes m \otimes 1) - 1 \otimes b \otimes m
$$
for all $m$ and $b$.  For simplicity we can rewrite this as
$((e_1 - e_2)\otimes \text{id}_M)(x) = \phi_M(x) - 1\otimes x$ for all
$x \in B \otimes_A M$.  So then by our definition of the functor $G$ we get
that $G(B \otimes_A M, \phi_M) = \text{ker} ((e_1-e_2)\otimes \text{id}_M)$.
However, due
to our lemma, we know that the sequence
$$
0 \rightarrow M \rightarrow^{\alpha_M} B \otimes_A M
\rightarrow B^{\otimes 2}\otimes_A M
\rightarrow B^{\otimes 3} \otimes_A M \rightarrow \cdots
$$
is exact, thus $\text{ker} ((e_1-e_2)\otimes \text{id}_M) = \text{im}(\alpha_M)
\simeq M$.
So $M \simeq G(B \otimes_A M) = GF(M)$ as needed.

\medskip\noindent
Now we will show that $FG$ is isomorphic to the identity.  So we take
$(N, \phi)$ in $\text{Mod}_{A\rightarrow B}$ and we set
$M = G(N, \phi) = \{n \in N | 1 \otimes n = \phi(n \otimes 1)\}$.  Since
$M$ is an $A$-submodule of the $B$-submodule $N$ we get a homomorphism of
$B$-modules $\theta: B \otimes_A M \rightarrow N$ which takes $b\otimes m$
to $bm$.  It is easy to check that this is a morphism in
$\text{Mod}_{A\rightarrow B}$.  So notice that we can also think of $\theta$ as
a
map $F(M) \rightarrow N$, thus we can see that $\theta$ defines a natural
transformation $id \rightarrow FG$.  So to complete the proof we need to
show that $\theta$ is an isomorphism.

\medskip\noindent
First we will need to define some maps $i$ will just be inclusion,
$\iota_M: M \otimes B \rightarrow B \otimes M$ is the map taking
$m \otimes b$ to $b \otimes m$, and
$\alpha,  \beta: N \rightarrow B \otimes_A M$ are defined by
$\alpha (n) = 1 \otimes n$ and $\beta (n) = \phi(n \otimes 1)$.  So by
definition, $M = \text{ker}(\alpha - \beta)$.  We have the following diagram,
where the rows are exact:
\begin{center}
\(
\begin{array}{cccccccc}
0 & \longrightarrow & M \otimes_A B &
\stackrel{i \otimes \text{id}_B}{\longrightarrow} & N \otimes_A B &
\stackrel{(\alpha-\beta)\otimes \text{id}_B}{\longrightarrow }&
B \otimes_A N \otimes_A B \\
  &                              & \downarrow \theta \circ \iota_M &
  &  \downarrow \phi    &                              &
\downarrow \phi_1\\
0 & \longrightarrow & N   & \stackrel{\alpha_N}{\longrightarrow} &
B \otimes_A N & \stackrel{(e_1-e_2)\otimes \text{id}_N}{\longrightarrow} &
B \otimes_A B \otimes_A N
\end{array}
\)
\end{center}

\medskip\noindent
So by showing that the diagram commutes, using the fact that both $\phi$
and $\phi_1$ are  isomorphisms we are able to get that $\theta$ is an
isomorphism.  To show the diagram commutes let us focus on one square at a
time.  For the first square we want
$\phi(i \otimes \text{id}_B)(m\otimes b) = \alpha_M \theta \iota_M (m\otimes
b)$.
We know that $\alpha_M\theta \iota_M(m\otimes b) = 1 \otimes bm$.  So we
just need to show that we get the same thing for
$(\phi(i \otimes \text{id}_B))(m\otimes b)$. We have
\begin{eqnarray*}
(\phi (i \otimes \text{id}_B))(b \otimes m) & = & \phi(m \otimes b) \\
& = & \phi((1\otimes b)(m \otimes 1))\\
& = & (1 \otimes b) \phi (m \otimes 1)\\
& = & (1 \otimes b)(1 \otimes m)\\
& = & 1 \otimes bm
\end{eqnarray*}
as needed.  Now we just need to show the second square commutes.  For the
second square it should be clear that
$\phi_1(\alpha \otimes \text{id}_B) = (e_2 \otimes \text{id}_N) \circ \phi$.
So we just
need to check that
$\phi_1(\beta \otimes \text{id}_B) = (e_1 \otimes \text{id}_N)\circ \phi$.  We
have:
\begin{eqnarray*}
\phi_1(\beta \otimes \text{id}_B)(n\otimes b) & = &
\phi_1(\phi(n\otimes 1) \otimes b) \\
& = & \phi_1 \phi_3(n \otimes 1 \otimes b) \\
& = & \phi_2 (n \otimes 1 \otimes b)\\
& = & (e_1 \otimes \text{id}_N) \phi( n \otimes b)
\end{eqnarray*}

\medskip\noindent
So, by the argument above $\theta$ is an isomorphism and thus
$FG(N, \phi) \simeq (N, \phi)$.	
\end{proof}

\noindent
And now we can restate and sketch the proof  of our desired result

\begin{theorem}
\label{theorem-quasi-coherent-stack}
Let $S$ be a scheme.  The fibered category $(\text{QCoh}/S)$ over $(Sch/S)$ is
stack with respect to the flat (fpqc) topology.
\end{theorem}

\begin{proof}
FIXME: Sketch of proof.

\medskip\noindent
Let me remind you that we just need to check the second condition of the
lemma.  So for a flat and surjective morphism $V \rightarrow U$
(corresponding to a faithfully flat ring homomorphism $f: A \rightarrow B$).
We need to show that there is an equivalence of categories between
$\text{QCoh}(U)$
and $\text{QCoh}(V\rightarrow U)$.  We will do this using the previous theorem
which
states that there is an equivalence of categories between $\text{Mod}_A$ and
$\text{Mod}_{A\rightarrow B}$.

\medskip\noindent
There is a standard equivalence of categories between $\text{QCoh}(U)$ and
$\text{Mod}_A$.
So we just need to show that there is an equivalence of categories between
$\text{QCoh}(V\rightarrow U)$ and $\text{Mod}_{A\rightarrow B}$.  To do this
let us look at
$\mathcal N$ an object in $\text{QCoh}(V)$ which corresponds to an $B$-module
$N$.
Looking at $p_1^* \mathcal N$ and $p_2^* \mathcal N$ in
$V \times_U V = \text{Spec} (B \otimes_A B)$ we get $N \otimes_A B$ and
$B \otimes_A N$ respectively.  So the descent datum
$\psi: p_1^* \mathcal N \simeq p_2^* \mathcal N$ will correspond to the
descent data $\phi: N \otimes_A B \simeq B \otimes_A N$ in
$\text{Mod}_{A \rightarrow B}$.  So $(\mathcal N, \psi)$ is an object of
$\text{QCoh}(V\rightarrow U)$ if and only if $\phi$ satisfies the cocycle
condition,
thus giving us an equivalence of categories between $\text{QCoh}(V\rightarrow
U)$
and $\text{Mod}_{A\rightarrow B}$.  Thus the functor
$\text{QCoh}(U) \rightarrow \text{QCoh}(V\rightarrow U)$ corresponds to the
functor
$\text{Mod}_A \rightarrow \text{Mod}_{A\rightarrow B}$! So since, the later is
an
equivalence we get the equivalence of categories that we need.  Thus
finishing the proof.
\end{proof}

\noindent
FIXME: put in example with descent of projective schemes and put in Galois
descent example.

\input{chapters}

\bibliography{my}
\bibliographystyle{alpha}


\end{document}
