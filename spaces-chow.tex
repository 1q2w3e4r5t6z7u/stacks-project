\input{preamble}

% OK, start here.
%
\begin{document}

\title{Chow Groups of Spaces}

\maketitle

\phantomsection
\label{section-phantom}


\tableofcontents


\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we first discuss Chow groups of algebraic spaces.
Having defined these, we define chern classes of vector bundles as
operators on these chow groups. The strategy will be entirely
the same as the strategy in the case of schemes. Therefore we
urge the reader to take a look at the introduction
(Chow Homology, Section \ref{chow-section-introduction})
of the corresponding chapter for schemes.

\medskip\noindent
Some related papers: \cite{edidin-graham} and \cite{kresch_cycle}.



\section{Setup}
\label{section-setup}

\noindent
We first fix the category of algebraic spaces we will be working with.
Please keep in mind throughout this chapter that
``decent $+$ locally Noetherian'' is the same as
``quasi-separated $+$ locally Noetherian'' according to
Decent Spaces, Lemma
\ref{decent-spaces-lemma-locally-Noetherian-decent-quasi-separated}.

\begin{situation}
\label{situation-setup}
Here $S$ is a scheme and $B$ is an algebraic space over $S$.
We assume $B$ is quasi-separated, locally Noetherian, and
universally catenary (Decent Spaces, Definition
\ref{decent-spaces-definition-universally-catenary}).
Moreover, we assume given a dimension function
$\delta : |B| \longrightarrow \mathbf{Z}$.
We say $X/B$ is {\it good} if $X$ is an algebraic space
over $B$ whose structure morphism $f : X \to B$ is
quasi-separated and locally of finite type.
In this case we define
$$
\delta = \delta_{X/B} : |X| \longrightarrow \mathbf{Z}
$$
as the map sending $x$ to $\delta(f(x))$ plus the transcendence degree
of $x/f(x)$ (Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-dimension-fibre}).
This is a dimension function by
More on Morphisms of Spaces, Lemma
\ref{spaces-more-morphisms-lemma-universally-catenary-dimension-function}.
\end{situation}

\noindent
A special case is when $S = B$ is a scheme and $(S, \delta)$ is as in
Chow Homology, Situation \ref{chow-situation-setup}. Thus $B$ might be
the spectrum of a field (Chow Homology, Example \ref{chow-example-field})
or $B = \Spec(\mathbf{Z})$
(Chow Homology, Example \ref{chow-example-domain-dimension-1}).

\medskip\noindent
Many lemma, proposition, theorems, definitions on algebraic spaces
are easier in the setting of Situation \ref{situation-setup} because
the algebraic spaces we are working with are quasi-separated
(and thus a fortiori decent) and locally Noetherian. We will sprinkle
this chapter with remarks such as the following to point this out.

\begin{remark}
\label{remark-sober}
In Situation \ref{situation-setup} if $X/B$ is good, then
$|X|$ is a sober topological space. See
Properties of Spaces, Lemma \ref{spaces-properties-lemma-quasi-separated-sober}
or Decent Spaces, Proposition \ref{decent-spaces-proposition-reasonable-sober}.
We will use this without further mention
to choose generic points of irreducible closed subsets of $|X|$.
\end{remark}

\begin{remark}
\label{remark-integral}
In Situation \ref{situation-setup} if $X/B$ is good, then
$X$ is integral (Spaces over Fields, Definition
\ref{spaces-over-fields-definition-integral-algebraic-space})
if and only if $X$ is reduced and $|X|$ is irreducible.
Moreover, for any point $\xi \in |X|$ there is a unique integral closed
subspace $Z \subset X$ such that $\xi$ is the generic point
of the closed subset $|Z| \subset |X|$, namely, we can take
$Z$ to be the reduced induced algebraic space structure on
$\overline{\{\xi\}}$ of Properties of Spaces, Definition
\ref{spaces-properties-definition-reduced-induced-space}
and this will be an integral algebraic space by what we just said.
\end{remark}

\noindent
If $B$ is Jacobson and $\delta$ sends closed points to zero, then $\delta$
is the function sending a point to the dimension of its closure.

\begin{lemma}
\label{lemma-delta-is-dimension}
In Situation \ref{situation-setup} assume $B$ is Jacobson
and that $\delta(b) = 0$ for every closed point $b$ of $|B|$.
Let $X/B$ be good. If $Z \subset X$ is an integral closed subspace
with generic point $\xi \in |Z|$, then the following integers are the same:
\begin{enumerate}
\item $\delta(\xi) = \delta_{X/B}(\xi)$,
\item $\dim(|Z|)$,
\item $\text{codim}(\{z\}, |Z|)$ for $z \in |Z|$ closed,
\item the dimension of the local ring of $Z$ at $z$ for
$z \in |Z|$ closed, and
\item $\dim(\mathcal{O}_{Z, \overline{z}})$ for $z \in |Z|$ closed.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $X$, $Z$, $\xi$ be as in the lemma.
Since $X$ is locally of finite type over $B$ we see that $X$ is Jacobson, see
Decent Spaces, Lemma
\ref{decent-spaces-lemma-Jacobson-universally-Jacobson}.
Hence $X_{\text{ft-pts}} \subset |X|$ is the set of closed points
by Decent Spaces, Lemma \ref{decent-spaces-lemma-decent-Jacobson-ft-pts}.
Given a chain $T_0 \supset \ldots \supset T_e$
of irreducible closed subsets of $|Z|$ we have
$T_e \cap X_{\text{ft-pts}}$ nonempty by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-enough-finite-type-points}.
Thus we can always assume such a chain ends
with $T_e = \{z\}$ for some $z \in |Z|$ closed.
It follows that $\dim(Z) = \sup_z \text{codim}(\{z\}, |Z|)$
where $z$ runs over the closed points of $|Z|$.
We have $\text{codim}(\{z\}, Z) = \delta(\xi) - \delta(z)$
by Topology, Lemma \ref{topology-lemma-dimension-function-catenary}.
By Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-finite-type-points-morphism}
the image of $z$ is a finite type point of $B$, i.e.,
a closed point of $|B|$. By
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-jacobson-finite-type-points}
the transcendence degree of $z/b$ is $0$.
We conclude that $\delta(z) = \delta(b) = 0$ by assumption.
Thus we obtain equality
$$
\dim(|Z|) = \text{codim}(\{z\}, Z) = \delta(\xi)
$$
for all $z \in |Z|$ closed. Finally, we have that
$\text{codim}(\{z\}, Z)$ is equal to the dimension of the
local ring of $Z$ at $z$ by
Decent Spaces, Lemma \ref{decent-spaces-lemma-codimension-local-ring}
which in turn is equal to
$\dim(\mathcal{O}_{Z, \overline{z}})$ by
Properties of Spaces, Lemma \ref{spaces-properties-lemma-dimension-local-ring}.
\end{proof}

\noindent
In the situation of the lemma above the value of $\delta$
at the generic point of a closed irreducible subset
is the dimension of the irreducible closed subset.
This motivates the following definition.

\begin{definition}
\label{definition-delta-dimension}
In Situation \ref{situation-setup} for any good $X/B$
and any irreducible closed subset $T \subset |X|$ we define
$$
\dim_\delta(T) = \delta(\xi)
$$
where $\xi \in T$ is the generic point of $T$.
We will call this the {\it $\delta$-dimension of $T$}.
If $T \subset |X|$ is any closed subset, then we define
$\dim_\delta(T)$ as the supremum of the $\delta$-dimensions
of the irreducible components of $T$.
If $Z$ is a closed subspace of $X$, then we set
$\dim_\delta(Z) = \dim_\delta(|Z|)$.
\end{definition}

\noindent
Of course this just means that
$\dim_\delta(T) = \sup \{\delta(t) \mid t \in T\}$.







\section{Cycles}
\label{section-cycles}

\noindent
This is the analogue of Chow Homology, Section \ref{chow-section-cycles}

\medskip\noindent
Since we are not assuming our spaces are quasi-compact we have
to be a little careful when defining cycles. We have to allow
infinite sums because a rational function may have infinitely many
poles for example. In any case, if $X$ is quasi-compact then a
cycle is a finite sum as usual.

\begin{definition}
\label{definition-cycles}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $k \in \mathbf{Z}$.
\begin{enumerate}
\item A {\it cycle on $X$} is a formal sum
$$
\alpha = \sum n_Z [Z]
$$
where the sum is over integral closed subspaces $Z \subset X$,
each $n_Z \in \mathbf{Z}$, and
$\{|Z|; n_Z \not = 0\}$ is a locally finite
collection of subsets of $|X|$
(Topology, Definition \ref{topology-definition-locally-finite}).
\item A {\it $k$-cycle} on $X$ is
a cycle
$$
\alpha = \sum n_Z [Z]
$$
where $n_Z \not = 0 \Rightarrow \dim_\delta(Z) = k$.
\item The abelian group of all $k$-cycles on $X$ is denoted $Z_k(X)$.
\end{enumerate}
\end{definition}

\noindent
In other words, a $k$-cycle on $X$ is a locally finite formal
$\mathbf{Z}$-linear combination of integral closed subspaces
(Remark \ref{remark-integral}) of $\delta$-dimension $k$.
Addition of $k$-cycles $\alpha = \sum n_Z[Z]$ and
$\beta = \sum m_Z[Z]$ is given by
$$
\alpha + \beta = \sum (n_Z + m_Z)[Z],
$$
i.e., by adding the coefficients.




\section{Multiplicities}
\label{section-multiplicities}

\noindent
A section with a few simple results on lengths and multiplicities.

\begin{lemma}
\label{lemma-length}
Let $S$ be a scheme and let $X$ be an algebraic space over $S$.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $x \in |X|$. Let $d \in \{0, 1, 2, \ldots, \infty\}$.
The following are equivalent
\begin{enumerate}
\item
$\text{length}_{\mathcal{O}_{X, \overline{x}}} \mathcal{F}_{\overline{x}} = d$
\item for some \'etale morphism $U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$ we have
$\text{length}_{\mathcal{O}_{U, u}} (\mathcal{F}|_U)_u = d$
\item for any \'etale morphism $U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$ we have
$\text{length}_{\mathcal{O}_{U, u}} (\mathcal{F}|_U)_u = d$
\end{enumerate}
\end{lemma}

\begin{proof}
Let $U \to X$ and $u \in U$ be as in (2) or (3). Then we know that
$\mathcal{O}_{X, \overline{x}}$ is the strict henselization of
$\mathcal{O}_{U, u}$ and that
$$
\mathcal{F}_{\overline{x}} =
(\mathcal{F}|_U)_u \otimes_{\mathcal{O}_{U, u}} \mathcal{O}_{X, \overline{x}}
$$
See Properties of Spaces,
Lemmas \ref{spaces-properties-lemma-describe-etale-local-ring} and
\ref{spaces-properties-lemma-stalk-quasi-coherent}.
Thus the equality of the lengths follows from
Algebra, Lemma \ref{algebra-lemma-pullback-module}
the fact that $\mathcal{O}_{U, u} \to \mathcal{O}_{X, \overline{x}}$
is flat and the fact that
$\mathcal{O}_{X, \overline{x}}/\mathfrak m_u\mathcal{O}_{X, \overline{x}}$
is equal to the residue field of $\mathcal{O}_{X, \overline{x}}$.
These facts about strict henselizations can be found in
More on Algebra, Lemma \ref{more-algebra-lemma-dumb-properties-henselization}.
\end{proof}

\begin{definition}
\label{definition-length-at-x}
Let $S$ be a scheme and let $X$ be an algebraic space over $S$.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $x \in |X|$. Let $d \in \{0, 1, 2, \ldots, \infty\}$.
We say {\it $\mathcal{F}$ has length $d$ at $x$}
if the equivalent conditions of Lemma \ref{lemma-length}
are satisfied.
\end{definition}

\begin{lemma}
\label{lemma-length-closed-immersion}
Let $S$ be a scheme. Let $i : Y \to X$ be a closed immersion of
algebraic spaces over $S$. Let $\mathcal{G}$ be a quasi-coherent
$\mathcal{O}_Y$-module. Let $y \in |Y|$ with image $x \in |X|$.
Let $d \in \{0, 1, 2, \ldots, \infty\}$. The following are
equivalent
\begin{enumerate}
\item $\mathcal{G}$ has length $d$ at $y$, and
\item $i_*\mathcal{G}$ has length $d$ at $x$.
\end{enumerate}
\end{lemma}

\begin{proof}
Choose an \'etale morphism $f : U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$. Set $V = Y \times_X U$.
Denote $g : V \to Y$ and $j : V \to U$ the projections.
Then $j : V \to U$ is a closed immersion and there is a unique
point $v \in V$ mapping to $y \in |Y|$ and $u \in U$
(use Properties of Spaces, Lemma \ref{spaces-properties-lemma-points-cartesian}
and Spaces, Lemma \ref{spaces-lemma-base-change-immersions}).
We have $j_*(\mathcal{G}|_V) = (i_*\mathcal{G})|_U$ as modules
on the scheme $V$ and $j_*$ the ``usual'' pushforward of modules
for the morphism of schemes $j$, see discussion surrounding
Cohomology of Spaces, Equation
(\ref{spaces-cohomology-equation-representable-higher-direct-image}).
In this way we reduce to the case of schemes: if $i : Y \to X$
is a closed immersion of schemes, then
$$
(i_*\mathcal{G})_x = \mathcal{G}_y
$$
as modules over $\mathcal{O}_{X, x}$ where the module structure
on the right hand side is given by the surjection
$i_y^\sharp : \mathcal{O}_{X, x} \to \mathcal{O}_{Y, y}$.
Thus equality by
Algebra, Lemma \ref{algebra-lemma-length-independent}.
\end{proof}

\begin{lemma}
\label{lemma-length-finite}
Let $S$ be a scheme and let $X$ be a
locally Noetherian algebraic space over $S$.
Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module.
Let $x \in |X|$. The following are equivalent
\begin{enumerate}
\item for some \'etale morphism $U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$ we have $u$ is a generic point
of an irreducible component of $\text{Supp}(\mathcal{F}|_U)$,
\item for any \'etale morphism $U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$ we have $u$ is a generic point
of an irreducible component of $\text{Supp}(\mathcal{F}|_U)$,
\item the length of $\mathcal{F}$ at $x$ is finite and nonzero.
\end{enumerate}
If $X$ is decent (equivalently quasi-separated) then these are
also equivalent to
\begin{enumerate}
\item[(4)] $x$ is a generic point of an irreducible component of
$\text{Supp}(\mathcal{F})$.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume $f : U \to X$ is an \'etale morphism with $U$ a scheme
and $u \in U$ maps to $x$. Then $\mathcal{F}|_U = f^*\mathcal{F}$
is a coherent $\mathcal{O}_U$-module on the locally Noetherian
scheme $U$ and in particular $(\mathcal{F}|_U)_u$ is a finite
$\mathcal{O}_{U, u}$-module, see Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-coherent-Noetherian}
and Cohomology of Schemes, Lemma
\ref{coherent-lemma-coherent-Noetherian}.
Recall that the support of $\mathcal{F}|_U$ is a closed subset of $U$
(Morphisms, Lemma \ref{morphisms-lemma-support-finite-type}) and
that the support of $(\mathcal{F}|_U)_u$ is the pullback
of the support of $\mathcal{F}|_U$ by the morphism
$\Spec(\mathcal{O}_{U, u}) \to U$. Thus $u$ is a generic point
of an irreducible component of $\text{Supp}(\mathcal{F}|_U)$
if and only if the support of $(\mathcal{F}|_U)_u$ is equal
to the maximal ideal of $\mathcal{O}_{U, u}$.
Now the equivalence of (1), (2), (3) follows from
by Algebra, Lemma \ref{algebra-lemma-support-point}.

\medskip\noindent
If $X$ is decent we choose an \'etale morphism $f : U \to X$ and a point
$u \in U$ mapping to $x$. The support of $\mathcal{F}$ pulls back to
the support of $\mathcal{F}|_U$, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-support-finite-type}.
Also, specializations $x' \leadsto x$ in $|X|$ lift to specializations
$u' \leadsto u$ in $U$ and any nontrivial specialization $u' \leadsto u$ in $U$
maps to a nontrivial specialization $f(u') \leadsto f(u)$ in $|X|$, see
Decent Spaces, Lemmas
\ref{decent-spaces-lemma-decent-specialization} and
\ref{decent-spaces-lemma-decent-no-specializations-map-to-same-point}.
Using that $|X|$ and $U$ are sober topological spaces
(Decent Spaces, Proposition \ref{decent-spaces-proposition-reasonable-sober}
and
Schemes, Lemma \ref{schemes-lemma-scheme-sober}) we conclude
$x$ is a generic point of the support of $\mathcal{F}$
if and only if $u$ is a generic point of the support of
$\mathcal{F}|_U$. We conclude (4) is equivalent to (1).

\medskip\noindent
The parenthetical statement follows from Decent Spaces, Lemma
\ref{decent-spaces-lemma-locally-Noetherian-decent-quasi-separated}.
\end{proof}

\begin{lemma}
\label{lemma-point-of-max-dimension}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $T \subset |X|$ be a closed subset and $t \in T$.
If $\dim_\delta(T) \leq k$ and $\delta(t) = k$, then
$t$ is a generic point of an irreducible component of $T$.
\end{lemma}

\begin{proof}
We know $t$ is contained in an irreducible component $T' \subset T$.
Let $t' \in T'$ be the generic point. Then
$k \geq \delta(t') \geq \delta(t)$. Since $\delta$ is a dimension
function we see that $t = t'$.
\end{proof}



\section{Cycle associated to a closed subspace}
\label{section-cycle-of-closed-subscheme}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-cycle-of-closed-subscheme}.

\begin{remark}
\label{remark-irreducible-component}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $Y \subset X$ be a closed subspace. By
Remarks \ref{remark-sober} and \ref{remark-integral}
there are $1$-to-$1$ correspondences between
\begin{enumerate}
\item irreducible components $T$ of $|Y|$,
\item generic points of irreducible components of $|Y|$, and
\item integral closed subspaces $Z \subset Y$ with the property that
$|Z|$ is an irreducible component of $|Y|$.
\end{enumerate}
In this chapter we will call $Z$ as in (3) an
{\it irreducible component of $Y$}
and we will call $\xi \in |Z|$ its {\it generic point}.
\end{remark}

\begin{definition}
\label{definition-cycle-associated-to-closed-subscheme}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $Y \subset X$ be a closed subspace.
\begin{enumerate}
\item For an irreducible component $Z \subset Y$ with generic point $\xi$
the length of $\mathcal{O}_Y$ at $\xi$
(Definition \ref{definition-length-at-x}) is called the
{\it multiplicity of $Z$ in $Y$}.
By Lemma \ref{lemma-length-finite} applied to $\mathcal{O}_Y$
on $Y$ this is a positive integer.
\item Assume $\dim_\delta(Y) \leq k$.
The {\it $k$-cycle associated to $Y$} is
$$
[Y]_k = \sum m_{Z, Y}[Z]
$$
where the sum is over the irreducible components $Z$ of $Y$
of $\delta$-dimension $k$ and $m_{Z, Y}$ is the multiplicity
of $Z$ in $Y$.
This is a $k$-cycle by Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-components-locally-finite}.
\end{enumerate}
\end{definition}

\noindent
It is important to note that we only define $[Y]_k$ if the $\delta$-dimension
of $Y$ does not exceed $k$. In other words, by convention, if we write
$[Y]_k$ then this implies that $\dim_\delta(Y) \leq k$.







\section{Cycle associated to a coherent sheaf}
\label{section-cycle-of-coherent-sheaf}

\noindent
This is the analogue of
Chow Homology, Section \ref{chow-section-cycle-of-coherent-sheaf}.

\begin{definition}
\label{definition-cycle-associated-to-coherent-sheaf}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module.
\begin{enumerate}
\item For an integral closed subspace $Z \subset X$ with generic point $\xi$
such that $|Z|$ is an irreducible component of $\text{Supp}(\mathcal{F})$
the length of $\mathcal{F}$ at $\xi$ (Definition \ref{definition-length-at-x})
is called the {\it multiplicity of $Z$ in $\mathcal{F}$}.
By Lemma \ref{lemma-length-finite} this is a positive integer.
\item Assume $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.
The {\it $k$-cycle associated to $\mathcal{F}$} is
$$
[\mathcal{F}]_k = \sum m_{Z, \mathcal{F}}[Z]
$$
where the sum is over the integral closed subspaces $Z \subset X$
corresponding to irreducible components of
$\text{Supp}(\mathcal{F})$ of $\delta$-dimension $k$
and $m_{Z, \mathcal{F}}$ is the multiplicity of $Z$ in $\mathcal{F}$.
This is a $k$-cycle by Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-components-locally-finite}.
\end{enumerate}
\end{definition}

\noindent
It is important to note that we only define $[\mathcal{F}]_k$
if $\mathcal{F}$ is coherent and the $\delta$-dimension
of $\text{Supp}(\mathcal{F})$ does not exceed $k$. In other words,
by convention, if we write $[\mathcal{F}]_k$ then this implies that
$\mathcal{F}$ is coherent on $X$ and
$\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.

\begin{lemma}
\label{lemma-reformulate-coeff-coherent}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module
with $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.
Let $Z$ be an integral closed subspace of $X$ with $\dim_\delta(Z) = k$.
Let $\xi \in |Z|$ be the generic point.
Then the coefficient of $Z$ in $[\mathcal{F}]_k$
is the length of $\mathcal{F}$ at $\xi$.
\end{lemma}

\begin{proof}
Observe that $|Z|$ is an irreducible component of $\text{Supp}(\mathcal{F})$
if and only if $\xi \in \text{Supp}(\mathcal{F})$, see
Lemma \ref{lemma-point-of-max-dimension}.
Moreover, the length of $\mathcal{F}$ at $\xi$ is zero if
$\xi \not \in \text{Supp}(\mathcal{F})$. Combining this
with Definition \ref{definition-cycle-associated-to-coherent-sheaf}
we conclude.
\end{proof}

\begin{lemma}
\label{lemma-cycle-closed-coherent}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $Y \subset X$ be a closed subspace.
If $\dim_\delta(Y) \leq k$, then $[Y]_k = [i_*\mathcal{O}_Y]_k$
where $i : Y \to X$ is the inclusion morphism.
\end{lemma}

\begin{proof}
Let $Z$ be an integral closed subspace of $X$ with $\dim_\delta(Z) = k$.
If $Z \not \subset Y$ the $Z$ has coefficient zero in both
$[Y]_k$ and $[i_*\mathcal{O}_Y]_k$. If $Z \subset Y$, then
the generic point of $Z$ may be viewed as a point $y \in |Y|$
whose image $x \in |X|$. Then the coefficient of $Z$ in
$[Y]_k$ is the length of $\mathcal{O}_Y$ at $y$ and the
coefficient of $Z$ in $[i_*\mathcal{O}_Y]_k$ is the length
of $i_*\mathcal{O}_Y$ at $x$. Thus the equality of the coefficients
follows from Lemma \ref{lemma-length-closed-immersion}.
\end{proof}

\begin{lemma}
\label{lemma-additivity-sheaf-cycle}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $0 \to \mathcal{F} \to \mathcal{G} \to \mathcal{H} \to 0$
be a short exact sequence of coherent $\mathcal{O}_X$-modules.
Assume that the $\delta$-dimension of the supports
of $\mathcal{F}$, $\mathcal{G}$, and $\mathcal{H}$ are $\leq k$.
Then $[\mathcal{G}]_k = [\mathcal{F}]_k + [\mathcal{H}]_k$.
\end{lemma}

\begin{proof}
Let $Z$ be an integral closed subspace of $X$ with $\dim_\delta(Z) = k$.
It suffices to show that the coefficients of
$Z$ in $[\mathcal{G}]_k$, $[\mathcal{F}]_k$, and $[\mathcal{H}]_k$
satisfy the corresponding additivity. By
Lemma \ref{lemma-reformulate-coeff-coherent}
it suffices to show
$$
\text{the length of }\mathcal{G}\text{ at }x =
\text{the length of }\mathcal{F}\text{ at }x +
\text{the length of }\mathcal{H}\text{ at }x
$$
for any $x \in |X|$. Looking at Definition \ref{definition-length-at-x}
this follows immediately from additivity of lengths, see
Algebra, Lemma \ref{algebra-lemma-length-additive}.
\end{proof}





\section{Preparation for proper pushforward}
\label{section-preparation-pushforward}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-preparation-pushforward}.

\begin{lemma}
\label{lemma-proper-image}
In Situation \ref{situation-setup} let $X,Y/B$ be good and let $f : X \to Y$
be a morphism over $B$. If $Z \subset X$ is an integral closed subspace, then
there exists a unique integral closed subspace $Z' \subset Y$ such that there
is a commutative diagram
$$
\xymatrix{
Z \ar[r] \ar[d] & X \ar[d]^f \\
Z' \ar[r] & Y
}
$$
with $Z \to Z'$ dominant. If $f$ is proper, then $Z \to Z'$ is proper
and surjective.
\end{lemma}

\begin{proof}
Let $\xi \in |Z|$ be the generic point. Let $Z' \subset Y$ be the integral
closed subspace whose generic point is $\xi' = f(\xi)$, see
Remark \ref{remark-integral}. Since $\xi \in |f^{-1}(Z')| = |f|^{-1}(|Z'|)$
by Properties of Spaces, Lemma \ref{spaces-properties-lemma-points-cartesian}
and since $Z$ is the reduced with $|Z| = \overline{\{\xi\}}$
we see that $Z \subset f^{-1}(Z')$ as closed subspaces of $X$ (see
Properties of Spaces, Lemma \ref{spaces-properties-lemma-map-into-reduction}).
Thus we obtain our morphism $Z \to Z'$.
This morphism is dominant as the generic point of $Z$
maps to the generic point of $Z'$. Uniqueness of $Z'$ is clear.
If $f$ is proper, then $Z \to Y$ is proper as a composition
of proper morphisms (Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-base-change-proper} and
\ref{spaces-morphisms-lemma-closed-immersion-proper}).
Then we conclude that $Z \to Z'$ is proper by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-universally-closed-permanence}.
Surjectivity then follows as the image of a proper morphism is closed.
\end{proof}

\begin{remark}
\label{remark-residue-field}
In Situation \ref{situation-setup} let $X/B$ be good. Every $x \in |X|$
can be represented by a (unique) monomorphism $\Spec(k) \to X$ where
$k$ is a field, see
Decent Spaces, Lemma \ref{decent-spaces-lemma-decent-points-monomorphism}.
In this chapter we will call $k$ the {\it residue field of} $x$ and we
will denote it $\kappa(x)$. Recall that $X$
has a dense open subscheme $U \subset X$ (Properties of Spaces, Proposition
\ref{spaces-properties-proposition-locally-quasi-separated-open-dense-scheme}).
If $x \in U$, then $\kappa(x)$ agrees with the residue
field of $x$ on $U$ as a scheme.
\end{remark}

\begin{remark}
\label{remark-function-field}
In Situation \ref{situation-setup} let $X/B$ be good. Assume $X$ is integral.
Let $U \subset X$ be a dense open subscheme (existence by
Properties of Spaces, Proposition
\ref{spaces-properties-proposition-locally-quasi-separated-open-dense-scheme}).
Since $X$ is integral, $U$ is an integral scheme.
Hence the function field $R(U)$ of $U$
(Morphisms, Definition \ref{morphisms-definition-function-field})
is defined; it is equal to the residue field of $U$ in its generic point
(Morphisms, Lemma \ref{morphisms-lemma-integral-scheme-rational-functions}).
In this chapter we will call $R(U)$ the {\it function field of $X$}
and we will denote it $R(X)$. Observe that $R(X)$ is equal to the
residue field $\kappa(\xi)$ at the generic point $\xi$ of $X$, see
Remark \ref{remark-residue-field}.
Combining this with Remark \ref{remark-integral}
we find that for any $x \in X$ the residue field
$\kappa(x)$ is the function field of the
unique integral closed subspace $Z \subset X$
whose generic point is $x$.
\end{remark}

\begin{lemma}
\label{lemma-equal-dimension}
In Situation \ref{situation-setup} let $X, Y/B$ be good and let
$f : X \to Y$ be a morphism over $B$.
Assume $X$, $Y$ integral and $\dim_\delta(X) = \dim_\delta(Y)$.
Then either $f$ factors through a proper closed subspace
of $Y$, or $f$ is dominant and the extension of function fields
$R(X) / R(Y)$ is finite.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-proper-image} there is a unique integral closed
subspace $Z \subset Y$ such that $f$ factors through a dominant
morphism $X \to Z$. Then $Z = Y$ if and only if
$\dim_\delta(Z) = \dim_\delta(Y)$. On the other hand, by
our construction of dimension functions (see Situation \ref{situation-setup})
we have $\dim_\delta(X) = \dim_\delta(Z) + r$ where $r$ the
transcendence degree of the extension $R(X)/R(Z)$. Combining this with
Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-finite-degree}
the lemma follows.
\end{proof}

\begin{lemma}
\label{lemma-quasi-compact-locally-finite}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $f$ is quasi-compact, and $\{T_i\}_{i \in I}$ is a locally
finite collection of closed subsets of $|X|$.
Then $\{\overline{|f|(T_i)}\}_{i \in I}$ is a locally finite
collection of closed subsets of $|Y|$.
\end{lemma}

\begin{proof}
Let $V \subset |Y|$ be a quasi-compact open subset.
Then $|f|^{-1}(V) \subset |X|$ is quasi-compact
by Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-quasi-compact-is-quasi-compact}.
Hence the set
$\{i \in I : T_i \cap |f|^{-1}(V) \not = \emptyset \}$
is finite by a simple topological argument which we omit.
Since this is the same as the set
$$
\{i \in I : |f|(T_i) \cap V \not = \emptyset \} =
\{i \in I : \overline{|f|(T_i)} \cap V \not = \emptyset \}
$$
the lemma is proved.
\end{proof}










\section{Proper pushforward}
\label{section-proper-pushforward}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-proper-pushforward}.

\begin{definition}
\label{definition-proper-pushforward}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $f$ is proper.
\begin{enumerate}
\item Let $Z \subset X$ be an integral closed subspace
with $\dim_\delta(Z) = k$. Let $Z' \subset Y$ be the
image of $Z$ as in Lemma \ref{lemma-proper-image}.
We define
$$
f_*[Z] =
\left\{
\begin{matrix}
0 & \text{if} & \dim_\delta(Z')< k, \\
\deg(Z/Z') [Z'] & \text{if} & \dim_\delta(Z') = k.
\end{matrix}
\right.
$$
The degree of $Z$ over $Z'$ is defined and finite if
$\dim_\delta(Z') = \dim_\delta(Z)$ by Lemma \ref{lemma-equal-dimension} and
Spaces over Fields, Definition \ref{spaces-over-fields-definition-degree}.
\item Let $\alpha = \sum n_Z [Z]$ be a $k$-cycle on $X$. The
{\it pushforward} of $\alpha$ as the sum
$$
f_* \alpha = \sum n_Z f_*[Z]
$$
where each $f_*[Z]$ is defined as above. The sum is locally finite
by Lemma \ref{lemma-quasi-compact-locally-finite} above.
\end{enumerate}
\end{definition}

\noindent
By definition the proper pushforward of cycles
$$
f_* : Z_k(X) \longrightarrow Z_k(Y)
$$
is a homomorphism of abelian groups. It turns $X \mapsto Z_k(X)$
into a covariant functor on the category whose object are good
algebraic spaces over $B$ and whose morphisms are proper morphisms
over $B$.

\begin{lemma}
\label{lemma-compose-pushforward}
In Situation \ref{situation-setup} let $X, Y, Z/B$ be good.
Let $f : X \to Y$ and $g : Y \to Z$ be proper morphisms over $B$.
Then $g_* \circ f_* = (g \circ f)_*$ as maps $Z_k(X) \to Z_k(Z)$.
\end{lemma}

\begin{proof}
Let $W \subset X$ be an integral closed subspace of dimension $k$.
Consider the integral closed subspaces
$W' \subset Y$ and $W'' \subset Z$
we get by applying Lemma \ref{lemma-proper-image}
to $f$ and $W$ and then to $g$ and $W'$.
Then $W \to W'$ and $W' \to W''$ are surjective and proper.
We have to show that $g_*(f_*[W]) = (f \circ g)_*[W]$.
If $\dim_\delta(W'') < k$, then both sides are zero.
If $\dim_\delta(W'') = k$, then we see $W \to W'$ and $W' \to W''$
both satisfy the hypotheses of Lemma \ref{lemma-equal-dimension}.
Hence
$$
g_*(f_*[W]) = \deg(W/W')\deg(W'/W'')[W''],
\quad
(f \circ g)_*[W] = \deg(W/W'')[W''].
$$
Then we can apply
Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-degree-composition}
to conclude.
\end{proof}

\begin{lemma}
\label{lemma-cycle-push-sheaf}
In Situation \ref{situation-setup} let $f : X \to Y$ be a proper morphism
good algebraic spaces over $B$.
\begin{enumerate}
\item Let $Z \subset X$ be a closed subspace with $\dim_\delta(Z) \leq k$.
Then
$$
f_*[Z]_k = [f_*{\mathcal O}_Z]_k.
$$
\item Let $\mathcal{F}$ be a coherent sheaf on $X$ such that
$\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$. Then
$$
f_*[\mathcal{F}]_k = [f_*{\mathcal F}]_k.
$$
\end{enumerate}
Note that the statement makes sense since $f_*\mathcal{F}$ and
$f_*\mathcal{O}_Z$ are coherent $\mathcal{O}_Y$-modules by
Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-proper-pushforward-coherent}.
\end{lemma}

\begin{proof}
Part (1) follows from (2) and Lemma \ref{lemma-cycle-closed-coherent}.
Let $\mathcal{F}$ be a coherent sheaf on $X$.
Assume that $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.
By Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-coherent-support-closed}
there exists a closed immersion $i : Z \to X$ and a coherent
$\mathcal{O}_Z$-module $\mathcal{G}$ such that
$i_*\mathcal{G} \cong \mathcal{F}$ and such that the support
of $\mathcal{F}$ is $Z$. Let $Z' \subset Y$ be the scheme theoretic image
of $f|_Z : Z \to Y$, see Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-scheme-theoretic-image}.
Consider the commutative diagram
$$
\xymatrix{
Z \ar[r]_i \ar[d]_{f|_Z} &
X \ar[d]^f \\
Z' \ar[r]^{i'} & Y
}
$$
of algebraic spaces over $B$. Observe that $f|_Z$ is surjective
(follows from Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-quasi-compact-scheme-theoretic-image}
and the fact that $|f|$ is closed) and proper
(follows from Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-base-change-proper},
\ref{spaces-morphisms-lemma-closed-immersion-proper}, and
\ref{spaces-morphisms-lemma-universally-closed-permanence}).
We have $f_*\mathcal{F} = f_*i_*\mathcal{G} = i'_*(f|_Z)_*\mathcal{G}$
by going around the diagram in two ways. Suppose we know the result holds
for closed immersions and for $f|_Z$. Then we see that
$$
f_*[\mathcal{F}]_k = f_*i_*[\mathcal{G}]_k
= (i')_*(f|_Z)_*[\mathcal{G}]_k =
(i')_*[(f|_Z)_*\mathcal{G}]_k =
[(i')_*(f|_Z)_*\mathcal{G}]_k = [f_*\mathcal{F}]_k
$$
as desired. The case of a closed immersion follows from
Lemma \ref{lemma-length-closed-immersion} and the definitions.
Thus we have reduced to the case where
$\dim_\delta(X) \leq k$ and $f : X \to Y$ is proper and surjective.

\medskip\noindent
Assume $\dim_\delta(X) \leq k$ and $f : X \to Y$ is proper and surjective.
For every irreducible component $Z \subset Y$
with generic point $\eta$ there exists a point $\xi \in X$ such
that $f(\xi) = \eta$. Hence $\delta(\eta) \leq \delta(\xi) \leq k$.
Thus we see that in the expressions
$$
f_*[\mathcal{F}]_k = \sum n_Z[Z],
\quad
\text{and}
\quad
[f_*\mathcal{F}]_k = \sum m_Z[Z].
$$
whenever $n_Z \not = 0$, or $m_Z \not = 0$ the integral closed
subspace $Z$ is actually an irreducible component of $Y$ of
$\delta$-dimension $k$ (see Lemma \ref{lemma-point-of-max-dimension}).
Pick such an integral closed subspace $Z \subset Y$ and denote $\eta$
its generic point.
Note that for any $\xi \in X$ with $f(\xi) = \eta$ we have $\delta(\xi) \geq k$
and hence $\xi$ is a generic point of an irreducible component
of $X$ of $\delta$-dimension $k$ as well
(see Lemma \ref{lemma-point-of-max-dimension}).
By Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-finite-in-codim-1}
there exists an open subspace $\eta \in V \subset Y$
such that $f^{-1}(V) \to V$ is finite.
Since $\eta$ is a generic point of an irreducible component of
$|Y|$ we may assume $V$ is an affine scheme, see
Properties of Spaces, Proposition
\ref{spaces-properties-proposition-locally-quasi-separated-open-dense-scheme}.
Replacing $Y$ by $V$ and $X$ by $f^{-1}(V)$ we reduce to the
case where $Y$ is affine, and $f$ is finite.
In particular $X$ and $Y$ are schemes and we reduce to
the corresponding result for schemes, see
Chow Homology, Lemma \ref{chow-lemma-cycle-push-sheaf}
(applied with $S = Y$).
\end{proof}













\section{Preparation for flat pullback}
\label{section-preparation-flat-pullback}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-preparation-flat-pullback}.

\medskip\noindent
Recall that a morphism of algebraic spaces is said to have
relative dimension $r$ if \'etale locally on the source
and the target we get a morphism of schemes which has relative dimension $d$.
The precise definition is equivalent, but in fact slightly different, see
Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-relative-dimension}.

\begin{lemma}
\label{lemma-flat-inverse-image-dimension}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $f$ is flat of relative dimension $r$.
For any closed subset $T \subset |Y|$ we have
$$
\dim_\delta(|f|^{-1}(T)) = \dim_\delta(T) + r.
$$
provided $|f|^{-1}(T)$ is nonempty.
If $Z \subset Y$ is an integral closed subscheme and
$Z' \subset f^{-1}(Z)$ is an irreducible component, then
$Z'$ dominates $Z$ and $\dim_\delta(Z') = \dim_\delta(Z) + r$.
\end{lemma}

\begin{proof}
Since the $\delta$-dimension of a closed subset is the supremum of
the $\delta$-dimensions of the irreducible components, it suffices
to prove the final statement. We may replace $Y$ by the
integral closed subscheme $Z$ and $X$ by $f^{-1}(Z) = Z \times_Y X$.
Hence we may assume $Z = Y$ is integral and $f$ is a flat morphism
of relative dimension $r$. Since $Y$ is locally Noetherian the
morphism $f$ which is locally of finite type,
is actually locally of finite presentation. Hence
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-fppf-open}
applies and we see that $f$ is open.
Let $\xi \in X$ be a generic point of an irreducible component
of $X$. By the openness of $f$ we see that $f(\xi)$ is the
generic point $\eta$ of $Z = Y$. Thus $Z'$ dominates $Z = Y$.
Finally, we see  that $\xi$ and $\eta$ are in the schematic
locus of $X$ and $Y$ by
Properties of Spaces, Proposition
\ref{spaces-properties-proposition-locally-quasi-separated-open-dense-scheme}.
Since $\xi$ is a generic point of $X$ we see that
$\mathcal{O}_{X, \xi} = \mathcal{O}_{X_\eta, \xi}$ has only one
prime ideal and hence has dimension $0$ (we may use usual
local rings as $\xi$ and $\eta$ are in the schematic loci
of $X$ and $Y$). Thus by Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-dimension-fibre-at-a-point}
(and the definition of morphisms of given relative dimension)
we conclude that the transcendence
degree of $\kappa(\xi)$ over $\kappa(\eta)$ is $r$.
In other words, $\delta(\xi) = \delta(\eta) + r$ as desired.
\end{proof}

\noindent
Here is the lemma that we will use to prove that the flat pullback
of a locally finite collection of closed subschemes is locally finite.

\begin{lemma}
\label{lemma-inverse-image-locally-finite}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $\{T_i\}_{i \in I}$ is a locally
finite collection of closed subsets of $|Y|$.
Then $\{|f|^{-1}(T_i)\}_{i \in I}$ is a locally finite
collection of closed subsets of $X$.
\end{lemma}

\begin{proof}
Let $U \subset |X|$ be a quasi-compact open subset.
Since the image $|f|(U) \subset |Y|$ is a quasi-compact subset
there exists a quasi-compact open $V \subset |Y|$ such that
$|f|(U) \subset V$. Note that
$$
\{i \in I : |f|^{-1}(T_i) \cap U \not = \emptyset \}
\subset
\{i \in I : T_i \cap V \not = \emptyset \}.
$$
Since the right hand side is finite by assumption we win.
\end{proof}

















\section{Flat pullback}
\label{section-flat-pullback}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-flat-pullback}.

\medskip\noindent
Let $S$ be a scheme and let $f : X \to Y$ be a morphism of algebraic
spaces over $S$. Let $Z \subset Y$ be a closed subspace.
In this chapter we will sometimes use the terminology
{\it scheme theoretic inverse image} for the inverse image
$f^{-1}(Z)$ of $Z$ constructed in Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-inverse-image-closed-subspace}.
The scheme theoretic inverse image is the fibre product
$$
\xymatrix{
f^{-1}(Z) \ar[r] \ar[d] & X \ar[d] \\
Z \ar[r] & Y
}
$$
If $\mathcal{I} \subset \mathcal{O}_Y$ is the quasi-coherent sheaf of ideals
corresponding to $Z$ in $Y$, then $f^{-1}(\mathcal{I})\mathcal{O}_X$ is the
quasi-coherent sheaf of ideals corresponding to $f^{-1}(Z)$ in $X$.

\begin{definition}
\label{definition-flat-pullback}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $f$ is flat of relative dimension $r$.
\begin{enumerate}
\item Let $Z \subset Y$ be an integral closed subspace of
$\delta$-dimension $k$. We define $f^*[Z]$ to be the
$(k+r)$-cycle on $X$ associated to the scheme theoretic inverse image
$$
f^*[Z] = [f^{-1}(Z)]_{k+r}.
$$
This makes sense since $\dim_\delta(f^{-1}(Z)) = k + r$
by Lemma \ref{lemma-flat-inverse-image-dimension}.
\item Let $\alpha = \sum n_i [Z_i]$ be
a $k$-cycle on $Y$. The {\it flat pullback of $\alpha$ by $f$}
is the sum
$$
f^* \alpha = \sum n_i f^*[Z_i]
$$
where each $f^*[Z_i]$ is defined as above.
The sum is locally finite by Lemma \ref{lemma-inverse-image-locally-finite}.
\item We denote $f^* : Z_k(Y) \to Z_{k + r}(X)$ the map of abelian
groups so obtained.
\end{enumerate}
\end{definition}

\noindent
An open immersion is flat. This is an important though trivial special
case of a flat morphism. If $U \subset X$ is open then sometimes the
pullback by $j : U \to X$ of a cycle is called the {\it restriction} of the
cycle to $U$. Note that in this case the maps
$$
j^* : Z_k(X) \longrightarrow Z_k(U)
$$
are all {\it surjective}. The reason is that given any integral closed
subspace $Z' \subset U$, we can take the closure of $Z$ of $Z'$ in $X$
and think of it as a reduced closed subspace of $X$ (see
Properties of Spaces, Definition
\ref{spaces-properties-definition-reduced-induced-space}).
And clearly $Z \cap U = Z'$, in other words
$j^*[Z] = [Z']$ whence the surjectivity. In fact a little bit more
is true.

\begin{lemma}
\label{lemma-exact-sequence-open}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $U \subset X$ be an open subspace. Let $Y$ be the
reduced closed subspace of $X$ with $|Y| = |X| \setminus |U|$
and denote $i : Y \to X$ the inclusion morphism.
For every $k \in \mathbf{Z}$ the sequence
$$
\xymatrix{
Z_k(Y) \ar[r]^{i_*} & Z_k(X) \ar[r]^{j^*} & Z_k(U) \ar[r] & 0
}
$$
is an exact complex of abelian groups.
\end{lemma}

\begin{proof}
Surjectivity of $j^*$ we saw above.
First assume $X$ is quasi-compact. Then $Z_k(X)$ is a free $\mathbf{Z}$-module
with basis given by the elements $[Z]$ where $Z \subset X$ is integral
closed of $\delta$-dimension $k$. Such a basis element maps
either to the basis element $[Z \cap U]$ of $Z_k(U)$
or to zero if $Z \subset Y$.
Hence the lemma is clear in this case. The general case is similar
and the proof is omitted.
\end{proof}

\begin{lemma}
\label{lemma-compose-flat-pullback}
In Situation \ref{situation-setup} let $X, Y, Z/B$ be good.
Let $f : X \to Y$ and $g : Y \to Z$ be flat morphisms of relative dimensions
$r$ and $s$ over $B$. Then $g \circ f$ is flat of relative dimension
$r + s$ and
$$
f^* \circ g^* = (g \circ f)^*
$$
as maps $Z_k(Z) \to Z_{k + r + s}(X)$.
\end{lemma}

\begin{proof}
The composition is flat of relative dimension $r + s$ by
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-dimension-fibre-at-a-point-additive} and
\ref{spaces-morphisms-lemma-composition-flat}.
Suppose that
\begin{enumerate}
\item $A \subset Z$ is a closed integral subspace of $\delta$-dimension $k$,
\item $A' \subset Y$ is a closed integral subspace of $\delta$-dimension
$k + s$ with $A' \subset g^{-1}(A)$, and
\item $A'' \subset Y$ is a closed integral subspace of $\delta$-dimension
$k + s + r$ with $A'' \subset f^{-1}(W')$.
\end{enumerate}
We have to show that the coefficient $n$ of $[A'']$ in $(g \circ f)^*[A]$
agrees with the coefficient $m$ of $[A'']$ in $f^*(g^*[A])$. We may choose
a commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \ar[r] & W \ar[d] \\
X \ar[r] & Y \ar[r] & Z
}
$$
where $U, V, W$ are schemes, the vertical arrows are \'etale, and
there exist points $u \in U$, $v \in V$, $w \in W$ such that
$u \mapsto v \mapsto w$ and such that $u, v, w$ map to the generic
points of $A'', A', A$. (Details omitted.)
Then we have flat local ring homorphisms
$\mathcal{O}_{W, w} \to \mathcal{O}_{V, v}$,
$\mathcal{O}_{V, v} \to \mathcal{O}_{U, u}$,
and repeatedly using Lemma \ref{lemma-length}
we find
$$
n = \text{length}_{\mathcal{O}_{U, u}}(
\mathcal{O}_{U, u}/\mathfrak m_w\mathcal{O}_{U, u})
$$
and
$$
m =
\text{length}_{\mathcal{O}_{V, v}}(
\mathcal{O}_{V, v}/\mathfrak m_w\mathcal{O}_{V, v})
\text{length}_{\mathcal{O}_{U, u}}(
\mathcal{O}_{U, u}/\mathfrak m_v\mathcal{O}_{U, u})
$$
Hence the equality follows from
Algebra, Lemma \ref{algebra-lemma-pullback-transitive}.
\end{proof}

\begin{lemma}
\label{lemma-pullback-coherent}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a flat morphism of relative dimension $r$.
\begin{enumerate}
\item Let $Z \subset Y$ be a closed subspace with
$\dim_\delta(Z) \leq k$. Then we have
$\dim_\delta(f^{-1}(Z)) \leq k + r$
and $[f^{-1}(Z)]_{k + r} = f^*[Z]_k$ in $Z_{k + r}(X)$.
\item Let $\mathcal{F}$ be a coherent sheaf on $Y$ with
$\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.
Then we have $\dim_\delta(\text{Supp}(f^*\mathcal{F})) \leq k + r$
and
$$
f^*[{\mathcal F}]_k = [f^*{\mathcal F}]_{k+r}
$$
in $Z_{k + r}(X)$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) follows from part (2) by Lemma \ref{lemma-cycle-closed-coherent}
and the fact that $f^*\mathcal{O}_Z = \mathcal{O}_{f^{-1}(Z)}$.

\medskip\noindent
Proof of (2).
As $X$, $Y$ are locally Noetherian we may apply
Cohomology of Spaces, Lemma \ref{spaces-cohomology-lemma-coherent-Noetherian}
to see
that $\mathcal{F}$ is of finite type, hence $f^*\mathcal{F}$ is
of finite type (Modules on Sites, Lemma
\ref{sites-modules-lemma-local-pullback}),
hence $f^*\mathcal{F}$ is coherent
(Cohomology of Spaces, Lemma \ref{spaces-cohomology-lemma-coherent-Noetherian}
again).
Thus the lemma makes sense. Let $W \subset Y$ be an integral closed
subspace of $\delta$-dimension $k$, and let $W' \subset X$ be
an integral closed subspace of dimension $k + r$ mapping into $W$
under $f$. We have to show that the coefficient $n$ of
$[W']$ in $f^*[{\mathcal F}]_k$ agrees with the coefficient
$m$ of $[W']$ in $[f^*{\mathcal F}]_{k+r}$. We may choose
a commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
$$
where $U, V$ are schemes, the vertical arrows are \'etale, and
there exist points $u \in U$, $v \in V$ such that
$u \mapsto v$ and such that $u, v$ map to the generic
points of $W', W$. (Details omitted.)
Consider the stalk $M = (\mathcal{F}|_V)_v$ as an $\mathcal{O}_{V, v}$-module.
(Note that $M$ has finite length by our dimension assumptions, but we
actually do not need to verify this. See Lemma \ref{lemma-length-finite}.)
We have
$(f^*\mathcal{F}|_U)_u = \mathcal{O}_{U, u} \otimes_{\mathcal{O}_{V, v}} M$.
Thus we see that
$$
n = \text{length}_{\mathcal{O}_{U, u}}
(\mathcal{O}_{U, u} \otimes_{\mathcal{O}_{V, v}} M)
\quad
\text{and}
\quad
m = \text{length}_{\mathcal{O}_{V, v}}(M)
\text{length}_{\mathcal{O}_{V, v}}(
\mathcal{O}_{U, u}/\mathfrak m_v \mathcal{O}_{U, u})
$$
Thus the equality follows from
Algebra, Lemma \ref{algebra-lemma-pullback-module}.
\end{proof}









\section{Push and pull}
\label{section-push-pull}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-flat-pullback}.

\medskip\noindent
In this section we verify that proper pushforward and flat pullback
are compatible when this makes sense. By the work we did above this
is a consequence of cohomology and base change.

\begin{lemma}
\label{lemma-flat-pullback-proper-pushforward}
In Situation \ref{situation-setup} let
$$
\xymatrix{
X' \ar[r]_{g'} \ar[d]_{f'} & X \ar[d]^f \\
Y' \ar[r]^g & Y
}
$$
be a fibre product diagram of good algebraic spaces over $B$.
Assume $f : X \to Y$ proper and $g : Y' \to Y$ flat of relative dimension $r$.
Then also $f'$ is proper and $g'$ is flat of relative dimension $r$.
For any $k$-cycle $\alpha$ on $X$ we have
$$
g^*f_*\alpha = f'_*(g')^*\alpha
$$
in $Z_{k + r}(Y')$.
\end{lemma}

\begin{proof}
The assertion that $f'$ is proper follows from
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-base-change-proper}.
The assertion that $g'$ is flat of relative dimension $r$ follows from
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-dimension-fibre-after-base-change}
and \ref{spaces-morphisms-lemma-base-change-flat}.
It suffices to prove the equality of cycles when $\alpha = [W]$
for some integral closed subspace $W \subset X$ of $\delta$-dimension $k$.
Note that in this case we have $\alpha = [\mathcal{O}_W]_k$, see
Lemma \ref{lemma-cycle-closed-coherent}.
By Lemmas \ref{lemma-cycle-push-sheaf} and
\ref{lemma-pullback-coherent} it therefore suffices
to show that $f'_*(g')^*\mathcal{O}_W$ is isomorphic to
$g^*f_*\mathcal{O}_W$. This follows from cohomology and
base change, see Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-flat-base-change-cohomology}.
\end{proof}

\begin{lemma}
\label{lemma-finite-flat}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a finite locally free morphism
of degree $d$ (see
Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-finite-locally-free}).
Then $f$ is both proper and flat of relative dimension $0$, and
$$
f_*f^*\alpha = d\alpha
$$
for every $\alpha \in Z_k(Y)$.
\end{lemma}

\begin{proof}
A finite locally free morphism is flat and finite by
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-finite-flat},
and a finite morphism is proper
by Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-finite-proper}.
We omit showing that a finite
morphism has relative dimension $0$. Thus the formula makes sense.
To prove it, let $Z \subset Y$ be an integral closed subscheme
of $\delta$-dimension $k$. It suffices to prove the formula
for $\alpha = [Z]$. Since the base change of a finite locally free
morphism is finite locally free
(Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-base-change-finite-locally-free})
we see that $f_*f^*\mathcal{O}_Z$ is a finite locally free sheaf of
rank $d$ on $Z$. Thus clearly $f_*f^*\mathcal{O}_Z$ has length $d$
at the generic point of $Z$. Hence
$$
f_*f^*[Z] = f_*f^*[\mathcal{O}_Z]_k =
[f_*f^*\mathcal{O}_Z]_k = d[Z]
$$
where we have used Lemmas \ref{lemma-pullback-coherent} and
\ref{lemma-cycle-push-sheaf}.
\end{proof}










\section{Preparation for principal divisors}
\label{section-preparation-principal-divisors}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-preparation-principal-divisors}.
Some of the material in this section partially overlaps with the
discussion in Spaces over Fields, Section
\ref{spaces-over-fields-section-Weil-divisors}.













\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
