\input{preamble}

% OK, start here.
%
\begin{document}

\title{Chow Groups of Spaces}

\maketitle

\phantomsection
\label{section-phantom}


\tableofcontents


\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we first discuss Chow groups of algebraic spaces.
Having defined these, we define chern classes of vector bundles as
operators on these chow groups. The strategy will be entirely
the same as the strategy in the case of schemes. Therefore we
urge the reader to take a look at the introduction
(Chow Homology, Section \ref{chow-section-introduction})
of the corresponding chapter for schemes.

\medskip\noindent
Some related papers: \cite{edidin-graham} and \cite{kresch_cycle}.



\section{Setup}
\label{section-setup}

\noindent
We first fix the category of algebraic spaces we will be working with.
Please keep in mind throughout this chapter that
``decent $+$ locally Noetherian'' is the same as
``quasi-separated $+$ locally Noetherian'' according to
Decent Spaces, Lemma
\ref{decent-spaces-lemma-locally-Noetherian-decent-quasi-separated}.

\begin{situation}
\label{situation-setup}
Here $S$ is a scheme and $B$ is an algebraic space over $S$.
We assume $B$ is quasi-separated, locally Noetherian, and
universally catenary (Decent Spaces, Definition
\ref{decent-spaces-definition-universally-catenary}).
Moreover, we assume given a dimension function
$\delta : |B| \longrightarrow \mathbf{Z}$.
We say $X/B$ is {\it good} if $X$ is an algebraic space
over $B$ whose structure morphism $f : X \to B$ is
quasi-separated and locally of finite type.
In this case we define
$$
\delta = \delta_{X/B} : |X| \longrightarrow \mathbf{Z}
$$
as the map sending $x$ to $\delta(f(x))$ plus the transcendence degree
of $x/f(x)$ (Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-dimension-fibre}).
This is a dimension function by
More on Morphisms of Spaces, Lemma
\ref{spaces-more-morphisms-lemma-universally-catenary-dimension-function}.
\end{situation}

\noindent
A special case is when $S = B$ is a scheme and $(S, \delta)$ is as in
Chow Homology, Situation \ref{chow-situation-setup}. Thus $B$ might be
the spectrum of a field (Chow Homology, Example \ref{chow-example-field})
or $B = \Spec(\mathbf{Z})$
(Chow Homology, Example \ref{chow-example-domain-dimension-1}).

\medskip\noindent
Many lemma, proposition, theorems, definitions on algebraic spaces
are easier in the setting of Situation \ref{situation-setup} because
the algebraic spaces we are working with are quasi-separated
(and thus a fortiori decent) and locally Noetherian. We will sprinkle
this chapter with remarks such as the following to point this out.

\begin{remark}
\label{remark-sober}
In Situation \ref{situation-setup} if $X/B$ is good, then
$|X|$ is a sober topological space. See
Properties of Spaces, Lemma \ref{spaces-properties-lemma-quasi-separated-sober}
or Decent Spaces, Proposition \ref{decent-spaces-proposition-reasonable-sober}.
We will use this without further mention
to choose generic points of irreducible closed subsets of $|X|$.
\end{remark}

\begin{remark}
\label{remark-integral}
In Situation \ref{situation-setup} if $X/B$ is good, then
$X$ is integral (Spaces over Fields, Definition
\ref{spaces-over-fields-definition-integral-algebraic-space})
if and only if $X$ is reduced and $|X|$ is irreducible.
Moreover, for any point $\xi \in |X|$ there is a unique integral closed
subspace $Z \subset X$ such that $\xi$ is the generic point
of the closed subset $|Z| \subset |X|$, see
Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-decent-irreducible-closed}.
\end{remark}

\noindent
If $B$ is Jacobson and $\delta$ sends closed points to zero, then $\delta$
is the function sending a point to the dimension of its closure.

\begin{lemma}
\label{lemma-delta-is-dimension}
In Situation \ref{situation-setup} assume $B$ is Jacobson
and that $\delta(b) = 0$ for every closed point $b$ of $|B|$.
Let $X/B$ be good. If $Z \subset X$ is an integral closed subspace
with generic point $\xi \in |Z|$, then the following integers are the same:
\begin{enumerate}
\item $\delta(\xi) = \delta_{X/B}(\xi)$,
\item $\dim(|Z|)$,
\item $\text{codim}(\{z\}, |Z|)$ for $z \in |Z|$ closed,
\item the dimension of the local ring of $Z$ at $z$ for
$z \in |Z|$ closed, and
\item $\dim(\mathcal{O}_{Z, \overline{z}})$ for $z \in |Z|$ closed.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $X$, $Z$, $\xi$ be as in the lemma.
Since $X$ is locally of finite type over $B$ we see that $X$ is Jacobson, see
Decent Spaces, Lemma
\ref{decent-spaces-lemma-Jacobson-universally-Jacobson}.
Hence $X_{\text{ft-pts}} \subset |X|$ is the set of closed points
by Decent Spaces, Lemma \ref{decent-spaces-lemma-decent-Jacobson-ft-pts}.
Given a chain $T_0 \supset \ldots \supset T_e$
of irreducible closed subsets of $|Z|$ we have
$T_e \cap X_{\text{ft-pts}}$ nonempty by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-enough-finite-type-points}.
Thus we can always assume such a chain ends
with $T_e = \{z\}$ for some $z \in |Z|$ closed.
It follows that $\dim(Z) = \sup_z \text{codim}(\{z\}, |Z|)$
where $z$ runs over the closed points of $|Z|$.
We have $\text{codim}(\{z\}, Z) = \delta(\xi) - \delta(z)$
by Topology, Lemma \ref{topology-lemma-dimension-function-catenary}.
By Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-finite-type-points-morphism}
the image of $z$ is a finite type point of $B$, i.e.,
a closed point of $|B|$. By
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-jacobson-finite-type-points}
the transcendence degree of $z/b$ is $0$.
We conclude that $\delta(z) = \delta(b) = 0$ by assumption.
Thus we obtain equality
$$
\dim(|Z|) = \text{codim}(\{z\}, Z) = \delta(\xi)
$$
for all $z \in |Z|$ closed. Finally, we have that
$\text{codim}(\{z\}, Z)$ is equal to the dimension of the
local ring of $Z$ at $z$ by
Decent Spaces, Lemma \ref{decent-spaces-lemma-codimension-local-ring}
which in turn is equal to
$\dim(\mathcal{O}_{Z, \overline{z}})$ by
Properties of Spaces, Lemma \ref{spaces-properties-lemma-dimension-local-ring}.
\end{proof}

\noindent
In the situation of the lemma above the value of $\delta$
at the generic point of a closed irreducible subset
is the dimension of the irreducible closed subset.
This motivates the following definition.

\begin{definition}
\label{definition-delta-dimension}
In Situation \ref{situation-setup} for any good $X/B$
and any irreducible closed subset $T \subset |X|$ we define
$$
\dim_\delta(T) = \delta(\xi)
$$
where $\xi \in T$ is the generic point of $T$.
We will call this the {\it $\delta$-dimension of $T$}.
If $T \subset |X|$ is any closed subset, then we define
$\dim_\delta(T)$ as the supremum of the $\delta$-dimensions
of the irreducible components of $T$.
If $Z$ is a closed subspace of $X$, then we set
$\dim_\delta(Z) = \dim_\delta(|Z|)$.
\end{definition}

\noindent
Of course this just means that
$\dim_\delta(T) = \sup \{\delta(t) \mid t \in T\}$.







\section{Cycles}
\label{section-cycles}

\noindent
This is the analogue of Chow Homology, Section \ref{chow-section-cycles}

\medskip\noindent
Since we are not assuming our spaces are quasi-compact we have
to be a little careful when defining cycles. We have to allow
infinite sums because a rational function may have infinitely many
poles for example. In any case, if $X$ is quasi-compact then a
cycle is a finite sum as usual.

\begin{definition}
\label{definition-cycles}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $k \in \mathbf{Z}$.
\begin{enumerate}
\item A {\it cycle on $X$} is a formal sum
$$
\alpha = \sum n_Z [Z]
$$
where the sum is over integral closed subspaces $Z \subset X$,
each $n_Z \in \mathbf{Z}$, and
$\{|Z|; n_Z \not = 0\}$ is a locally finite
collection of subsets of $|X|$
(Topology, Definition \ref{topology-definition-locally-finite}).
\item A {\it $k$-cycle} on $X$ is
a cycle
$$
\alpha = \sum n_Z [Z]
$$
where $n_Z \not = 0 \Rightarrow \dim_\delta(Z) = k$.
\item The abelian group of all $k$-cycles on $X$ is denoted $Z_k(X)$.
\end{enumerate}
\end{definition}

\noindent
In other words, a $k$-cycle on $X$ is a locally finite formal
$\mathbf{Z}$-linear combination of integral closed subspaces
(Remark \ref{remark-integral}) of $\delta$-dimension $k$.
Addition of $k$-cycles $\alpha = \sum n_Z[Z]$ and
$\beta = \sum m_Z[Z]$ is given by
$$
\alpha + \beta = \sum (n_Z + m_Z)[Z],
$$
i.e., by adding the coefficients.




\section{Multiplicities}
\label{section-multiplicities}

\noindent
A section with a few simple results on lengths and multiplicities.

\begin{lemma}
\label{lemma-length}
Let $S$ be a scheme and let $X$ be an algebraic space over $S$.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $x \in |X|$. Let $d \in \{0, 1, 2, \ldots, \infty\}$.
The following are equivalent
\begin{enumerate}
\item
$\text{length}_{\mathcal{O}_{X, \overline{x}}} \mathcal{F}_{\overline{x}} = d$
\item for some \'etale morphism $U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$ we have
$\text{length}_{\mathcal{O}_{U, u}} (\mathcal{F}|_U)_u = d$
\item for any \'etale morphism $U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$ we have
$\text{length}_{\mathcal{O}_{U, u}} (\mathcal{F}|_U)_u = d$
\end{enumerate}
\end{lemma}

\begin{proof}
Let $U \to X$ and $u \in U$ be as in (2) or (3). Then we know that
$\mathcal{O}_{X, \overline{x}}$ is the strict henselization of
$\mathcal{O}_{U, u}$ and that
$$
\mathcal{F}_{\overline{x}} =
(\mathcal{F}|_U)_u \otimes_{\mathcal{O}_{U, u}} \mathcal{O}_{X, \overline{x}}
$$
See Properties of Spaces,
Lemmas \ref{spaces-properties-lemma-describe-etale-local-ring} and
\ref{spaces-properties-lemma-stalk-quasi-coherent}.
Thus the equality of the lengths follows from
Algebra, Lemma \ref{algebra-lemma-pullback-module}
the fact that $\mathcal{O}_{U, u} \to \mathcal{O}_{X, \overline{x}}$
is flat and the fact that
$\mathcal{O}_{X, \overline{x}}/\mathfrak m_u\mathcal{O}_{X, \overline{x}}$
is equal to the residue field of $\mathcal{O}_{X, \overline{x}}$.
These facts about strict henselizations can be found in
More on Algebra, Lemma \ref{more-algebra-lemma-dumb-properties-henselization}.
\end{proof}

\begin{definition}
\label{definition-length-at-x}
Let $S$ be a scheme and let $X$ be an algebraic space over $S$.
Let $\mathcal{F}$ be a quasi-coherent $\mathcal{O}_X$-module.
Let $x \in |X|$. Let $d \in \{0, 1, 2, \ldots, \infty\}$.
We say {\it $\mathcal{F}$ has length $d$ at $x$}
if the equivalent conditions of Lemma \ref{lemma-length}
are satisfied.
\end{definition}

\begin{lemma}
\label{lemma-length-closed-immersion}
Let $S$ be a scheme. Let $i : Y \to X$ be a closed immersion of
algebraic spaces over $S$. Let $\mathcal{G}$ be a quasi-coherent
$\mathcal{O}_Y$-module. Let $y \in |Y|$ with image $x \in |X|$.
Let $d \in \{0, 1, 2, \ldots, \infty\}$. The following are
equivalent
\begin{enumerate}
\item $\mathcal{G}$ has length $d$ at $y$, and
\item $i_*\mathcal{G}$ has length $d$ at $x$.
\end{enumerate}
\end{lemma}

\begin{proof}
Choose an \'etale morphism $f : U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$. Set $V = Y \times_X U$.
Denote $g : V \to Y$ and $j : V \to U$ the projections.
Then $j : V \to U$ is a closed immersion and there is a unique
point $v \in V$ mapping to $y \in |Y|$ and $u \in U$
(use Properties of Spaces, Lemma \ref{spaces-properties-lemma-points-cartesian}
and Spaces, Lemma \ref{spaces-lemma-base-change-immersions}).
We have $j_*(\mathcal{G}|_V) = (i_*\mathcal{G})|_U$ as modules
on the scheme $V$ and $j_*$ the ``usual'' pushforward of modules
for the morphism of schemes $j$, see discussion surrounding
Cohomology of Spaces, Equation
(\ref{spaces-cohomology-equation-representable-higher-direct-image}).
In this way we reduce to the case of schemes: if $i : Y \to X$
is a closed immersion of schemes, then
$$
(i_*\mathcal{G})_x = \mathcal{G}_y
$$
as modules over $\mathcal{O}_{X, x}$ where the module structure
on the right hand side is given by the surjection
$i_y^\sharp : \mathcal{O}_{X, x} \to \mathcal{O}_{Y, y}$.
Thus equality by
Algebra, Lemma \ref{algebra-lemma-length-independent}.
\end{proof}

\begin{lemma}
\label{lemma-length-finite}
Let $S$ be a scheme and let $X$ be a
locally Noetherian algebraic space over $S$.
Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module.
Let $x \in |X|$. The following are equivalent
\begin{enumerate}
\item for some \'etale morphism $U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$ we have $u$ is a generic point
of an irreducible component of $\text{Supp}(\mathcal{F}|_U)$,
\item for any \'etale morphism $U \to X$ with $U$ a scheme
and $u \in U$ mapping to $x$ we have $u$ is a generic point
of an irreducible component of $\text{Supp}(\mathcal{F}|_U)$,
\item the length of $\mathcal{F}$ at $x$ is finite and nonzero.
\end{enumerate}
If $X$ is decent (equivalently quasi-separated) then these are
also equivalent to
\begin{enumerate}
\item[(4)] $x$ is a generic point of an irreducible component of
$\text{Supp}(\mathcal{F})$.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume $f : U \to X$ is an \'etale morphism with $U$ a scheme
and $u \in U$ maps to $x$. Then $\mathcal{F}|_U = f^*\mathcal{F}$
is a coherent $\mathcal{O}_U$-module on the locally Noetherian
scheme $U$ and in particular $(\mathcal{F}|_U)_u$ is a finite
$\mathcal{O}_{U, u}$-module, see Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-coherent-Noetherian}
and Cohomology of Schemes, Lemma
\ref{coherent-lemma-coherent-Noetherian}.
Recall that the support of $\mathcal{F}|_U$ is a closed subset of $U$
(Morphisms, Lemma \ref{morphisms-lemma-support-finite-type}) and
that the support of $(\mathcal{F}|_U)_u$ is the pullback
of the support of $\mathcal{F}|_U$ by the morphism
$\Spec(\mathcal{O}_{U, u}) \to U$. Thus $u$ is a generic point
of an irreducible component of $\text{Supp}(\mathcal{F}|_U)$
if and only if the support of $(\mathcal{F}|_U)_u$ is equal
to the maximal ideal of $\mathcal{O}_{U, u}$.
Now the equivalence of (1), (2), (3) follows from
by Algebra, Lemma \ref{algebra-lemma-support-point}.

\medskip\noindent
If $X$ is decent we choose an \'etale morphism $f : U \to X$ and a point
$u \in U$ mapping to $x$. The support of $\mathcal{F}$ pulls back to
the support of $\mathcal{F}|_U$, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-support-finite-type}.
Also, specializations $x' \leadsto x$ in $|X|$ lift to specializations
$u' \leadsto u$ in $U$ and any nontrivial specialization $u' \leadsto u$ in $U$
maps to a nontrivial specialization $f(u') \leadsto f(u)$ in $|X|$, see
Decent Spaces, Lemmas
\ref{decent-spaces-lemma-decent-specialization} and
\ref{decent-spaces-lemma-decent-no-specializations-map-to-same-point}.
Using that $|X|$ and $U$ are sober topological spaces
(Decent Spaces, Proposition \ref{decent-spaces-proposition-reasonable-sober}
and
Schemes, Lemma \ref{schemes-lemma-scheme-sober}) we conclude
$x$ is a generic point of the support of $\mathcal{F}$
if and only if $u$ is a generic point of the support of
$\mathcal{F}|_U$. We conclude (4) is equivalent to (1).

\medskip\noindent
The parenthetical statement follows from Decent Spaces, Lemma
\ref{decent-spaces-lemma-locally-Noetherian-decent-quasi-separated}.
\end{proof}

\begin{lemma}
\label{lemma-point-of-max-dimension}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $T \subset |X|$ be a closed subset and $t \in T$.
If $\dim_\delta(T) \leq k$ and $\delta(t) = k$, then
$t$ is a generic point of an irreducible component of $T$.
\end{lemma}

\begin{proof}
We know $t$ is contained in an irreducible component $T' \subset T$.
Let $t' \in T'$ be the generic point. Then
$k \geq \delta(t') \geq \delta(t)$. Since $\delta$ is a dimension
function we see that $t = t'$.
\end{proof}



\section{Cycle associated to a closed subspace}
\label{section-cycle-of-closed-subscheme}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-cycle-of-closed-subscheme}.

\begin{remark}
\label{remark-irreducible-component}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $Y \subset X$ be a closed subspace. By
Remarks \ref{remark-sober} and \ref{remark-integral}
there are $1$-to-$1$ correspondences between
\begin{enumerate}
\item irreducible components $T$ of $|Y|$,
\item generic points of irreducible components of $|Y|$, and
\item integral closed subspaces $Z \subset Y$ with the property that
$|Z|$ is an irreducible component of $|Y|$.
\end{enumerate}
In this chapter we will call $Z$ as in (3) an
{\it irreducible component of $Y$}
and we will call $\xi \in |Z|$ its {\it generic point}.
\end{remark}

\begin{definition}
\label{definition-cycle-associated-to-closed-subscheme}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $Y \subset X$ be a closed subspace.
\begin{enumerate}
\item For an irreducible component $Z \subset Y$ with generic point $\xi$
the length of $\mathcal{O}_Y$ at $\xi$
(Definition \ref{definition-length-at-x}) is called the
{\it multiplicity of $Z$ in $Y$}.
By Lemma \ref{lemma-length-finite} applied to $\mathcal{O}_Y$
on $Y$ this is a positive integer.
\item Assume $\dim_\delta(Y) \leq k$.
The {\it $k$-cycle associated to $Y$} is
$$
[Y]_k = \sum m_{Z, Y}[Z]
$$
where the sum is over the irreducible components $Z$ of $Y$
of $\delta$-dimension $k$ and $m_{Z, Y}$ is the multiplicity
of $Z$ in $Y$.
This is a $k$-cycle by Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-components-locally-finite}.
\end{enumerate}
\end{definition}

\noindent
It is important to note that we only define $[Y]_k$ if the $\delta$-dimension
of $Y$ does not exceed $k$. In other words, by convention, if we write
$[Y]_k$ then this implies that $\dim_\delta(Y) \leq k$.







\section{Cycle associated to a coherent sheaf}
\label{section-cycle-of-coherent-sheaf}

\noindent
This is the analogue of
Chow Homology, Section \ref{chow-section-cycle-of-coherent-sheaf}.

\begin{definition}
\label{definition-cycle-associated-to-coherent-sheaf}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module.
\begin{enumerate}
\item For an integral closed subspace $Z \subset X$ with generic point $\xi$
such that $|Z|$ is an irreducible component of $\text{Supp}(\mathcal{F})$
the length of $\mathcal{F}$ at $\xi$ (Definition \ref{definition-length-at-x})
is called the {\it multiplicity of $Z$ in $\mathcal{F}$}.
By Lemma \ref{lemma-length-finite} this is a positive integer.
\item Assume $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.
The {\it $k$-cycle associated to $\mathcal{F}$} is
$$
[\mathcal{F}]_k = \sum m_{Z, \mathcal{F}}[Z]
$$
where the sum is over the integral closed subspaces $Z \subset X$
corresponding to irreducible components of
$\text{Supp}(\mathcal{F})$ of $\delta$-dimension $k$
and $m_{Z, \mathcal{F}}$ is the multiplicity of $Z$ in $\mathcal{F}$.
This is a $k$-cycle by Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-components-locally-finite}.
\end{enumerate}
\end{definition}

\noindent
It is important to note that we only define $[\mathcal{F}]_k$
if $\mathcal{F}$ is coherent and the $\delta$-dimension
of $\text{Supp}(\mathcal{F})$ does not exceed $k$. In other words,
by convention, if we write $[\mathcal{F}]_k$ then this implies that
$\mathcal{F}$ is coherent on $X$ and
$\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.

\begin{lemma}
\label{lemma-reformulate-coeff-coherent}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $\mathcal{F}$ be a coherent $\mathcal{O}_X$-module
with $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.
Let $Z$ be an integral closed subspace of $X$ with $\dim_\delta(Z) = k$.
Let $\xi \in |Z|$ be the generic point.
Then the coefficient of $Z$ in $[\mathcal{F}]_k$
is the length of $\mathcal{F}$ at $\xi$.
\end{lemma}

\begin{proof}
Observe that $|Z|$ is an irreducible component of $\text{Supp}(\mathcal{F})$
if and only if $\xi \in \text{Supp}(\mathcal{F})$, see
Lemma \ref{lemma-point-of-max-dimension}.
Moreover, the length of $\mathcal{F}$ at $\xi$ is zero if
$\xi \not \in \text{Supp}(\mathcal{F})$. Combining this
with Definition \ref{definition-cycle-associated-to-coherent-sheaf}
we conclude.
\end{proof}

\begin{lemma}
\label{lemma-cycle-closed-coherent}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $Y \subset X$ be a closed subspace.
If $\dim_\delta(Y) \leq k$, then $[Y]_k = [i_*\mathcal{O}_Y]_k$
where $i : Y \to X$ is the inclusion morphism.
\end{lemma}

\begin{proof}
Let $Z$ be an integral closed subspace of $X$ with $\dim_\delta(Z) = k$.
If $Z \not \subset Y$ the $Z$ has coefficient zero in both
$[Y]_k$ and $[i_*\mathcal{O}_Y]_k$. If $Z \subset Y$, then
the generic point of $Z$ may be viewed as a point $y \in |Y|$
whose image $x \in |X|$. Then the coefficient of $Z$ in
$[Y]_k$ is the length of $\mathcal{O}_Y$ at $y$ and the
coefficient of $Z$ in $[i_*\mathcal{O}_Y]_k$ is the length
of $i_*\mathcal{O}_Y$ at $x$. Thus the equality of the coefficients
follows from Lemma \ref{lemma-length-closed-immersion}.
\end{proof}

\begin{lemma}
\label{lemma-additivity-sheaf-cycle}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $0 \to \mathcal{F} \to \mathcal{G} \to \mathcal{H} \to 0$
be a short exact sequence of coherent $\mathcal{O}_X$-modules.
Assume that the $\delta$-dimension of the supports
of $\mathcal{F}$, $\mathcal{G}$, and $\mathcal{H}$ are $\leq k$.
Then $[\mathcal{G}]_k = [\mathcal{F}]_k + [\mathcal{H}]_k$.
\end{lemma}

\begin{proof}
Let $Z$ be an integral closed subspace of $X$ with $\dim_\delta(Z) = k$.
It suffices to show that the coefficients of
$Z$ in $[\mathcal{G}]_k$, $[\mathcal{F}]_k$, and $[\mathcal{H}]_k$
satisfy the corresponding additivity. By
Lemma \ref{lemma-reformulate-coeff-coherent}
it suffices to show
$$
\text{the length of }\mathcal{G}\text{ at }x =
\text{the length of }\mathcal{F}\text{ at }x +
\text{the length of }\mathcal{H}\text{ at }x
$$
for any $x \in |X|$. Looking at Definition \ref{definition-length-at-x}
this follows immediately from additivity of lengths, see
Algebra, Lemma \ref{algebra-lemma-length-additive}.
\end{proof}





\section{Preparation for proper pushforward}
\label{section-preparation-pushforward}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-preparation-pushforward}.

\begin{lemma}
\label{lemma-proper-image}
In Situation \ref{situation-setup} let $X,Y/B$ be good and let $f : X \to Y$
be a morphism over $B$. If $Z \subset X$ is an integral closed subspace, then
there exists a unique integral closed subspace $Z' \subset Y$ such that there
is a commutative diagram
$$
\xymatrix{
Z \ar[r] \ar[d] & X \ar[d]^f \\
Z' \ar[r] & Y
}
$$
with $Z \to Z'$ dominant. If $f$ is proper, then $Z \to Z'$ is proper
and surjective.
\end{lemma}

\begin{proof}
Let $\xi \in |Z|$ be the generic point. Let $Z' \subset Y$ be the integral
closed subspace whose generic point is $\xi' = f(\xi)$, see
Remark \ref{remark-integral}. Since $\xi \in |f^{-1}(Z')| = |f|^{-1}(|Z'|)$
by Properties of Spaces, Lemma \ref{spaces-properties-lemma-points-cartesian}
and since $Z$ is the reduced with $|Z| = \overline{\{\xi\}}$
we see that $Z \subset f^{-1}(Z')$ as closed subspaces of $X$ (see
Properties of Spaces, Lemma \ref{spaces-properties-lemma-map-into-reduction}).
Thus we obtain our morphism $Z \to Z'$.
This morphism is dominant as the generic point of $Z$
maps to the generic point of $Z'$. Uniqueness of $Z'$ is clear.
If $f$ is proper, then $Z \to Y$ is proper as a composition
of proper morphisms (Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-base-change-proper} and
\ref{spaces-morphisms-lemma-closed-immersion-proper}).
Then we conclude that $Z \to Z'$ is proper by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-universally-closed-permanence}.
Surjectivity then follows as the image of a proper morphism is closed.
\end{proof}

\begin{remark}
\label{remark-residue-field}
In Situation \ref{situation-setup} let $X/B$ be good. Every $x \in |X|$
can be represented by a (unique) monomorphism $\Spec(k) \to X$ where
$k$ is a field, see
Decent Spaces, Lemma \ref{decent-spaces-lemma-decent-points-monomorphism}.
Then $k$ is the {\it residue field of} $x$ and is denoted $\kappa(x)$.
Recall that $X$ has a dense open subscheme $U \subset X$
(Properties of Spaces, Proposition
\ref{spaces-properties-proposition-locally-quasi-separated-open-dense-scheme}).
If $x \in U$, then $\kappa(x)$ agrees with the residue
field of $x$ on $U$ as a scheme. See Decent Spaces, Section
\ref{decent-spaces-section-residue-fields-henselian-local-rings}.
\end{remark}

\begin{remark}
\label{remark-function-field}
In Situation \ref{situation-setup} let $X/B$ be good. Assume $X$ is integral.
In this case the {\it function field} $R(X)$ of $X$ is defined and
is equal to the residue field of $X$ at its generic point.
See Spaces over Fields, Definition
\ref{spaces-over-fields-definition-function-field}.
Combining this with Remark \ref{remark-integral}
we find that for any $x \in X$ the residue field
$\kappa(x)$ is the function field of the
unique integral closed subspace $Z \subset X$
whose generic point is $x$.
\end{remark}

\begin{lemma}
\label{lemma-equal-dimension}
In Situation \ref{situation-setup} let $X, Y/B$ be good and let
$f : X \to Y$ be a morphism over $B$.
Assume $X$, $Y$ integral and $\dim_\delta(X) = \dim_\delta(Y)$.
Then either $f$ factors through a proper closed subspace
of $Y$, or $f$ is dominant and the extension of function fields
$R(X) / R(Y)$ is finite.
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-proper-image} there is a unique integral closed
subspace $Z \subset Y$ such that $f$ factors through a dominant
morphism $X \to Z$. Then $Z = Y$ if and only if
$\dim_\delta(Z) = \dim_\delta(Y)$. On the other hand, by
our construction of dimension functions (see Situation \ref{situation-setup})
we have $\dim_\delta(X) = \dim_\delta(Z) + r$ where $r$ the
transcendence degree of the extension $R(X)/R(Z)$. Combining this with
Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-finite-degree}
the lemma follows.
\end{proof}

\begin{lemma}
\label{lemma-quasi-compact-locally-finite}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $f$ is quasi-compact, and $\{T_i\}_{i \in I}$ is a locally
finite collection of closed subsets of $|X|$.
Then $\{\overline{|f|(T_i)}\}_{i \in I}$ is a locally finite
collection of closed subsets of $|Y|$.
\end{lemma}

\begin{proof}
Let $V \subset |Y|$ be a quasi-compact open subset.
Then $|f|^{-1}(V) \subset |X|$ is quasi-compact
by Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-quasi-compact-is-quasi-compact}.
Hence the set
$\{i \in I : T_i \cap |f|^{-1}(V) \not = \emptyset \}$
is finite by a simple topological argument which we omit.
Since this is the same as the set
$$
\{i \in I : |f|(T_i) \cap V \not = \emptyset \} =
\{i \in I : \overline{|f|(T_i)} \cap V \not = \emptyset \}
$$
the lemma is proved.
\end{proof}










\section{Proper pushforward}
\label{section-proper-pushforward}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-proper-pushforward}.

\begin{definition}
\label{definition-proper-pushforward}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $f$ is proper.
\begin{enumerate}
\item Let $Z \subset X$ be an integral closed subspace
with $\dim_\delta(Z) = k$. Let $Z' \subset Y$ be the
image of $Z$ as in Lemma \ref{lemma-proper-image}.
We define
$$
f_*[Z] =
\left\{
\begin{matrix}
0 & \text{if} & \dim_\delta(Z')< k, \\
\deg(Z/Z') [Z'] & \text{if} & \dim_\delta(Z') = k.
\end{matrix}
\right.
$$
The degree of $Z$ over $Z'$ is defined and finite if
$\dim_\delta(Z') = \dim_\delta(Z)$ by Lemma \ref{lemma-equal-dimension} and
Spaces over Fields, Definition \ref{spaces-over-fields-definition-degree}.
\item Let $\alpha = \sum n_Z [Z]$ be a $k$-cycle on $X$. The
{\it pushforward} of $\alpha$ as the sum
$$
f_* \alpha = \sum n_Z f_*[Z]
$$
where each $f_*[Z]$ is defined as above. The sum is locally finite
by Lemma \ref{lemma-quasi-compact-locally-finite} above.
\end{enumerate}
\end{definition}

\noindent
By definition the proper pushforward of cycles
$$
f_* : Z_k(X) \longrightarrow Z_k(Y)
$$
is a homomorphism of abelian groups. It turns $X \mapsto Z_k(X)$
into a covariant functor on the category whose object are good
algebraic spaces over $B$ and whose morphisms are proper morphisms
over $B$.

\begin{lemma}
\label{lemma-compose-pushforward}
In Situation \ref{situation-setup} let $X, Y, Z/B$ be good.
Let $f : X \to Y$ and $g : Y \to Z$ be proper morphisms over $B$.
Then $g_* \circ f_* = (g \circ f)_*$ as maps $Z_k(X) \to Z_k(Z)$.
\end{lemma}

\begin{proof}
Let $W \subset X$ be an integral closed subspace of dimension $k$.
Consider the integral closed subspaces
$W' \subset Y$ and $W'' \subset Z$
we get by applying Lemma \ref{lemma-proper-image}
to $f$ and $W$ and then to $g$ and $W'$.
Then $W \to W'$ and $W' \to W''$ are surjective and proper.
We have to show that $g_*(f_*[W]) = (f \circ g)_*[W]$.
If $\dim_\delta(W'') < k$, then both sides are zero.
If $\dim_\delta(W'') = k$, then we see $W \to W'$ and $W' \to W''$
both satisfy the hypotheses of Lemma \ref{lemma-equal-dimension}.
Hence
$$
g_*(f_*[W]) = \deg(W/W')\deg(W'/W'')[W''],
\quad
(f \circ g)_*[W] = \deg(W/W'')[W''].
$$
Then we can apply
Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-degree-composition}
to conclude.
\end{proof}

\begin{lemma}
\label{lemma-cycle-push-sheaf}
In Situation \ref{situation-setup} let $f : X \to Y$ be a proper morphism
good algebraic spaces over $B$.
\begin{enumerate}
\item Let $Z \subset X$ be a closed subspace with $\dim_\delta(Z) \leq k$.
Then
$$
f_*[Z]_k = [f_*{\mathcal O}_Z]_k.
$$
\item Let $\mathcal{F}$ be a coherent sheaf on $X$ such that
$\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$. Then
$$
f_*[\mathcal{F}]_k = [f_*{\mathcal F}]_k.
$$
\end{enumerate}
Note that the statement makes sense since $f_*\mathcal{F}$ and
$f_*\mathcal{O}_Z$ are coherent $\mathcal{O}_Y$-modules by
Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-proper-pushforward-coherent}.
\end{lemma}

\begin{proof}
Part (1) follows from (2) and Lemma \ref{lemma-cycle-closed-coherent}.
Let $\mathcal{F}$ be a coherent sheaf on $X$.
Assume that $\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.
By Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-coherent-support-closed}
there exists a closed immersion $i : Z \to X$ and a coherent
$\mathcal{O}_Z$-module $\mathcal{G}$ such that
$i_*\mathcal{G} \cong \mathcal{F}$ and such that the support
of $\mathcal{F}$ is $Z$. Let $Z' \subset Y$ be the scheme theoretic image
of $f|_Z : Z \to Y$, see Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-scheme-theoretic-image}.
Consider the commutative diagram
$$
\xymatrix{
Z \ar[r]_i \ar[d]_{f|_Z} &
X \ar[d]^f \\
Z' \ar[r]^{i'} & Y
}
$$
of algebraic spaces over $B$. Observe that $f|_Z$ is surjective
(follows from Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-quasi-compact-scheme-theoretic-image}
and the fact that $|f|$ is closed) and proper
(follows from Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-base-change-proper},
\ref{spaces-morphisms-lemma-closed-immersion-proper}, and
\ref{spaces-morphisms-lemma-universally-closed-permanence}).
We have $f_*\mathcal{F} = f_*i_*\mathcal{G} = i'_*(f|_Z)_*\mathcal{G}$
by going around the diagram in two ways. Suppose we know the result holds
for closed immersions and for $f|_Z$. Then we see that
$$
f_*[\mathcal{F}]_k = f_*i_*[\mathcal{G}]_k
= (i')_*(f|_Z)_*[\mathcal{G}]_k =
(i')_*[(f|_Z)_*\mathcal{G}]_k =
[(i')_*(f|_Z)_*\mathcal{G}]_k = [f_*\mathcal{F}]_k
$$
as desired. The case of a closed immersion follows from
Lemma \ref{lemma-length-closed-immersion} and the definitions.
Thus we have reduced to the case where
$\dim_\delta(X) \leq k$ and $f : X \to Y$ is proper and surjective.

\medskip\noindent
Assume $\dim_\delta(X) \leq k$ and $f : X \to Y$ is proper and surjective.
For every irreducible component $Z \subset Y$
with generic point $\eta$ there exists a point $\xi \in X$ such
that $f(\xi) = \eta$. Hence $\delta(\eta) \leq \delta(\xi) \leq k$.
Thus we see that in the expressions
$$
f_*[\mathcal{F}]_k = \sum n_Z[Z],
\quad
\text{and}
\quad
[f_*\mathcal{F}]_k = \sum m_Z[Z].
$$
whenever $n_Z \not = 0$, or $m_Z \not = 0$ the integral closed
subspace $Z$ is actually an irreducible component of $Y$ of
$\delta$-dimension $k$ (see Lemma \ref{lemma-point-of-max-dimension}).
Pick such an integral closed subspace $Z \subset Y$ and denote $\eta$
its generic point.
Note that for any $\xi \in X$ with $f(\xi) = \eta$ we have $\delta(\xi) \geq k$
and hence $\xi$ is a generic point of an irreducible component
of $X$ of $\delta$-dimension $k$ as well
(see Lemma \ref{lemma-point-of-max-dimension}).
By Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-finite-in-codim-1}
there exists an open subspace $\eta \in V \subset Y$
such that $f^{-1}(V) \to V$ is finite.
Since $\eta$ is a generic point of an irreducible component of
$|Y|$ we may assume $V$ is an affine scheme, see
Properties of Spaces, Proposition
\ref{spaces-properties-proposition-locally-quasi-separated-open-dense-scheme}.
Replacing $Y$ by $V$ and $X$ by $f^{-1}(V)$ we reduce to the
case where $Y$ is affine, and $f$ is finite.
In particular $X$ and $Y$ are schemes and we reduce to
the corresponding result for schemes, see
Chow Homology, Lemma \ref{chow-lemma-cycle-push-sheaf}
(applied with $S = Y$).
\end{proof}













\section{Preparation for flat pullback}
\label{section-preparation-flat-pullback}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-preparation-flat-pullback}.

\medskip\noindent
Recall that a morphism of algebraic spaces is said to have
relative dimension $r$ if \'etale locally on the source
and the target we get a morphism of schemes which has relative dimension $d$.
The precise definition is equivalent, but in fact slightly different, see
Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-relative-dimension}.

\begin{lemma}
\label{lemma-flat-inverse-image-dimension}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $f$ is flat of relative dimension $r$.
For any closed subset $T \subset |Y|$ we have
$$
\dim_\delta(|f|^{-1}(T)) = \dim_\delta(T) + r.
$$
provided $|f|^{-1}(T)$ is nonempty.
If $Z \subset Y$ is an integral closed subscheme and
$Z' \subset f^{-1}(Z)$ is an irreducible component, then
$Z'$ dominates $Z$ and $\dim_\delta(Z') = \dim_\delta(Z) + r$.
\end{lemma}

\begin{proof}
Since the $\delta$-dimension of a closed subset is the supremum of
the $\delta$-dimensions of the irreducible components, it suffices
to prove the final statement. We may replace $Y$ by the
integral closed subscheme $Z$ and $X$ by $f^{-1}(Z) = Z \times_Y X$.
Hence we may assume $Z = Y$ is integral and $f$ is a flat morphism
of relative dimension $r$. Since $Y$ is locally Noetherian the
morphism $f$ which is locally of finite type,
is actually locally of finite presentation. Hence
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-fppf-open}
applies and we see that $f$ is open.
Let $\xi \in X$ be a generic point of an irreducible component
of $X$. By the openness of $f$ we see that $f(\xi)$ is the
generic point $\eta$ of $Z = Y$. Thus $Z'$ dominates $Z = Y$.
Finally, we see  that $\xi$ and $\eta$ are in the schematic
locus of $X$ and $Y$ by
Properties of Spaces, Proposition
\ref{spaces-properties-proposition-locally-quasi-separated-open-dense-scheme}.
Since $\xi$ is a generic point of $X$ we see that
$\mathcal{O}_{X, \xi} = \mathcal{O}_{X_\eta, \xi}$ has only one
prime ideal and hence has dimension $0$ (we may use usual
local rings as $\xi$ and $\eta$ are in the schematic loci
of $X$ and $Y$). Thus by Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-dimension-fibre-at-a-point}
(and the definition of morphisms of given relative dimension)
we conclude that the transcendence
degree of $\kappa(\xi)$ over $\kappa(\eta)$ is $r$.
In other words, $\delta(\xi) = \delta(\eta) + r$ as desired.
\end{proof}

\noindent
Here is the lemma that we will use to prove that the flat pullback
of a locally finite collection of closed subschemes is locally finite.

\begin{lemma}
\label{lemma-inverse-image-locally-finite}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $\{T_i\}_{i \in I}$ is a locally
finite collection of closed subsets of $|Y|$.
Then $\{|f|^{-1}(T_i)\}_{i \in I}$ is a locally finite
collection of closed subsets of $X$.
\end{lemma}

\begin{proof}
Let $U \subset |X|$ be a quasi-compact open subset.
Since the image $|f|(U) \subset |Y|$ is a quasi-compact subset
there exists a quasi-compact open $V \subset |Y|$ such that
$|f|(U) \subset V$. Note that
$$
\{i \in I : |f|^{-1}(T_i) \cap U \not = \emptyset \}
\subset
\{i \in I : T_i \cap V \not = \emptyset \}.
$$
Since the right hand side is finite by assumption we win.
\end{proof}

















\section{Flat pullback}
\label{section-flat-pullback}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-flat-pullback}.

\medskip\noindent
Let $S$ be a scheme and let $f : X \to Y$ be a morphism of algebraic
spaces over $S$. Let $Z \subset Y$ be a closed subspace.
In this chapter we will sometimes use the terminology
{\it scheme theoretic inverse image} for the inverse image
$f^{-1}(Z)$ of $Z$ constructed in Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-inverse-image-closed-subspace}.
The scheme theoretic inverse image is the fibre product
$$
\xymatrix{
f^{-1}(Z) \ar[r] \ar[d] & X \ar[d] \\
Z \ar[r] & Y
}
$$
If $\mathcal{I} \subset \mathcal{O}_Y$ is the quasi-coherent sheaf of ideals
corresponding to $Z$ in $Y$, then $f^{-1}(\mathcal{I})\mathcal{O}_X$ is the
quasi-coherent sheaf of ideals corresponding to $f^{-1}(Z)$ in $X$.

\begin{definition}
\label{definition-flat-pullback}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a morphism over $B$.
Assume $f$ is flat of relative dimension $r$.
\begin{enumerate}
\item Let $Z \subset Y$ be an integral closed subspace of
$\delta$-dimension $k$. We define $f^*[Z]$ to be the
$(k+r)$-cycle on $X$ associated to the scheme theoretic inverse image
$$
f^*[Z] = [f^{-1}(Z)]_{k+r}.
$$
This makes sense since $\dim_\delta(f^{-1}(Z)) = k + r$
by Lemma \ref{lemma-flat-inverse-image-dimension}.
\item Let $\alpha = \sum n_i [Z_i]$ be
a $k$-cycle on $Y$. The {\it flat pullback of $\alpha$ by $f$}
is the sum
$$
f^* \alpha = \sum n_i f^*[Z_i]
$$
where each $f^*[Z_i]$ is defined as above.
The sum is locally finite by Lemma \ref{lemma-inverse-image-locally-finite}.
\item We denote $f^* : Z_k(Y) \to Z_{k + r}(X)$ the map of abelian
groups so obtained.
\end{enumerate}
\end{definition}

\noindent
An open immersion is flat. This is an important though trivial special
case of a flat morphism. If $U \subset X$ is open then sometimes the
pullback by $j : U \to X$ of a cycle is called the {\it restriction} of the
cycle to $U$. Note that in this case the maps
$$
j^* : Z_k(X) \longrightarrow Z_k(U)
$$
are all {\it surjective}. The reason is that given any integral closed
subspace $Z' \subset U$, we can take the closure of $Z$ of $Z'$ in $X$
and think of it as a reduced closed subspace of $X$ (see
Properties of Spaces, Definition
\ref{spaces-properties-definition-reduced-induced-space}).
And clearly $Z \cap U = Z'$, in other words
$j^*[Z] = [Z']$ whence the surjectivity. In fact a little bit more
is true.

\begin{lemma}
\label{lemma-exact-sequence-open}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $U \subset X$ be an open subspace. Let $Y$ be the
reduced closed subspace of $X$ with $|Y| = |X| \setminus |U|$
and denote $i : Y \to X$ the inclusion morphism.
For every $k \in \mathbf{Z}$ the sequence
$$
\xymatrix{
Z_k(Y) \ar[r]^{i_*} & Z_k(X) \ar[r]^{j^*} & Z_k(U) \ar[r] & 0
}
$$
is an exact complex of abelian groups.
\end{lemma}

\begin{proof}
Surjectivity of $j^*$ we saw above.
First assume $X$ is quasi-compact. Then $Z_k(X)$ is a free $\mathbf{Z}$-module
with basis given by the elements $[Z]$ where $Z \subset X$ is integral
closed of $\delta$-dimension $k$. Such a basis element maps
either to the basis element $[Z \cap U]$ of $Z_k(U)$
or to zero if $Z \subset Y$.
Hence the lemma is clear in this case. The general case is similar
and the proof is omitted.
\end{proof}

\begin{lemma}
\label{lemma-etale-pullback}
In Situation \ref{situation-setup} let $f : X \to Y$ be an \'etale
morphism of good spaces $X, Y/B$. If $Z \subset Y$ is an integral
closed subspace, then $f^*[Z] = \sum [Z']$ where the sum is over the
irreducible components (Remark \ref{remark-irreducible-component})
of $f^{-1}(Z)$.
\end{lemma}

\begin{proof}
The meaning of the lemma is that the coefficient of $[Z']$ is $1$.
This follows from the fact that $f^{-1}(Z)$ is a reduced algebraic space
because it is \'etale over the integral algebraic space $Z$.
\end{proof}

\begin{lemma}
\label{lemma-compose-flat-pullback}
In Situation \ref{situation-setup} let $X, Y, Z/B$ be good.
Let $f : X \to Y$ and $g : Y \to Z$ be flat morphisms of relative dimensions
$r$ and $s$ over $B$. Then $g \circ f$ is flat of relative dimension
$r + s$ and
$$
f^* \circ g^* = (g \circ f)^*
$$
as maps $Z_k(Z) \to Z_{k + r + s}(X)$.
\end{lemma}

\begin{proof}
The composition is flat of relative dimension $r + s$ by
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-dimension-fibre-at-a-point-additive} and
\ref{spaces-morphisms-lemma-composition-flat}.
Suppose that
\begin{enumerate}
\item $A \subset Z$ is a closed integral subspace of $\delta$-dimension $k$,
\item $A' \subset Y$ is a closed integral subspace of $\delta$-dimension
$k + s$ with $A' \subset g^{-1}(A)$, and
\item $A'' \subset Y$ is a closed integral subspace of $\delta$-dimension
$k + s + r$ with $A'' \subset f^{-1}(W')$.
\end{enumerate}
We have to show that the coefficient $n$ of $[A'']$ in $(g \circ f)^*[A]$
agrees with the coefficient $m$ of $[A'']$ in $f^*(g^*[A])$. We may choose
a commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \ar[r] & W \ar[d] \\
X \ar[r] & Y \ar[r] & Z
}
$$
where $U, V, W$ are schemes, the vertical arrows are \'etale, and
there exist points $u \in U$, $v \in V$, $w \in W$ such that
$u \mapsto v \mapsto w$ and such that $u, v, w$ map to the generic
points of $A'', A', A$. (Details omitted.)
Then we have flat local ring homorphisms
$\mathcal{O}_{W, w} \to \mathcal{O}_{V, v}$,
$\mathcal{O}_{V, v} \to \mathcal{O}_{U, u}$,
and repeatedly using Lemma \ref{lemma-length}
we find
$$
n = \text{length}_{\mathcal{O}_{U, u}}(
\mathcal{O}_{U, u}/\mathfrak m_w\mathcal{O}_{U, u})
$$
and
$$
m =
\text{length}_{\mathcal{O}_{V, v}}(
\mathcal{O}_{V, v}/\mathfrak m_w\mathcal{O}_{V, v})
\text{length}_{\mathcal{O}_{U, u}}(
\mathcal{O}_{U, u}/\mathfrak m_v\mathcal{O}_{U, u})
$$
Hence the equality follows from
Algebra, Lemma \ref{algebra-lemma-pullback-transitive}.
\end{proof}

\begin{lemma}
\label{lemma-pullback-coherent}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a flat morphism of relative dimension $r$.
\begin{enumerate}
\item Let $Z \subset Y$ be a closed subspace with
$\dim_\delta(Z) \leq k$. Then we have
$\dim_\delta(f^{-1}(Z)) \leq k + r$
and $[f^{-1}(Z)]_{k + r} = f^*[Z]_k$ in $Z_{k + r}(X)$.
\item Let $\mathcal{F}$ be a coherent sheaf on $Y$ with
$\dim_\delta(\text{Supp}(\mathcal{F})) \leq k$.
Then we have $\dim_\delta(\text{Supp}(f^*\mathcal{F})) \leq k + r$
and
$$
f^*[{\mathcal F}]_k = [f^*{\mathcal F}]_{k+r}
$$
in $Z_{k + r}(X)$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) follows from part (2) by Lemma \ref{lemma-cycle-closed-coherent}
and the fact that $f^*\mathcal{O}_Z = \mathcal{O}_{f^{-1}(Z)}$.

\medskip\noindent
Proof of (2).
As $X$, $Y$ are locally Noetherian we may apply
Cohomology of Spaces, Lemma \ref{spaces-cohomology-lemma-coherent-Noetherian}
to see
that $\mathcal{F}$ is of finite type, hence $f^*\mathcal{F}$ is
of finite type (Modules on Sites, Lemma
\ref{sites-modules-lemma-local-pullback}),
hence $f^*\mathcal{F}$ is coherent
(Cohomology of Spaces, Lemma \ref{spaces-cohomology-lemma-coherent-Noetherian}
again).
Thus the lemma makes sense. Let $W \subset Y$ be an integral closed
subspace of $\delta$-dimension $k$, and let $W' \subset X$ be
an integral closed subspace of dimension $k + r$ mapping into $W$
under $f$. We have to show that the coefficient $n$ of
$[W']$ in $f^*[{\mathcal F}]_k$ agrees with the coefficient
$m$ of $[W']$ in $[f^*{\mathcal F}]_{k+r}$. We may choose
a commutative diagram
$$
\xymatrix{
U \ar[d] \ar[r] & V \ar[d] \\
X \ar[r] & Y
}
$$
where $U, V$ are schemes, the vertical arrows are \'etale, and
there exist points $u \in U$, $v \in V$ such that
$u \mapsto v$ and such that $u, v$ map to the generic
points of $W', W$. (Details omitted.)
Consider the stalk $M = (\mathcal{F}|_V)_v$ as an $\mathcal{O}_{V, v}$-module.
(Note that $M$ has finite length by our dimension assumptions, but we
actually do not need to verify this. See Lemma \ref{lemma-length-finite}.)
We have
$(f^*\mathcal{F}|_U)_u = \mathcal{O}_{U, u} \otimes_{\mathcal{O}_{V, v}} M$.
Thus we see that
$$
n = \text{length}_{\mathcal{O}_{U, u}}
(\mathcal{O}_{U, u} \otimes_{\mathcal{O}_{V, v}} M)
\quad
\text{and}
\quad
m = \text{length}_{\mathcal{O}_{V, v}}(M)
\text{length}_{\mathcal{O}_{V, v}}(
\mathcal{O}_{U, u}/\mathfrak m_v \mathcal{O}_{U, u})
$$
Thus the equality follows from
Algebra, Lemma \ref{algebra-lemma-pullback-module}.
\end{proof}









\section{Push and pull}
\label{section-push-pull}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-flat-pullback}.

\medskip\noindent
In this section we verify that proper pushforward and flat pullback
are compatible when this makes sense. By the work we did above this
is a consequence of cohomology and base change.

\begin{lemma}
\label{lemma-flat-pullback-proper-pushforward}
In Situation \ref{situation-setup} let
$$
\xymatrix{
X' \ar[r]_{g'} \ar[d]_{f'} & X \ar[d]^f \\
Y' \ar[r]^g & Y
}
$$
be a fibre product diagram of good algebraic spaces over $B$.
Assume $f : X \to Y$ proper and $g : Y' \to Y$ flat of relative dimension $r$.
Then also $f'$ is proper and $g'$ is flat of relative dimension $r$.
For any $k$-cycle $\alpha$ on $X$ we have
$$
g^*f_*\alpha = f'_*(g')^*\alpha
$$
in $Z_{k + r}(Y')$.
\end{lemma}

\begin{proof}
The assertion that $f'$ is proper follows from
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-base-change-proper}.
The assertion that $g'$ is flat of relative dimension $r$ follows from
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-dimension-fibre-after-base-change}
and \ref{spaces-morphisms-lemma-base-change-flat}.
It suffices to prove the equality of cycles when $\alpha = [W]$
for some integral closed subspace $W \subset X$ of $\delta$-dimension $k$.
Note that in this case we have $\alpha = [\mathcal{O}_W]_k$, see
Lemma \ref{lemma-cycle-closed-coherent}.
By Lemmas \ref{lemma-cycle-push-sheaf} and
\ref{lemma-pullback-coherent} it therefore suffices
to show that $f'_*(g')^*\mathcal{O}_W$ is isomorphic to
$g^*f_*\mathcal{O}_W$. This follows from cohomology and
base change, see Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-flat-base-change-cohomology}.
\end{proof}

\begin{lemma}
\label{lemma-finite-flat}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a finite locally free morphism
of degree $d$ (see
Morphisms of Spaces, Definition
\ref{spaces-morphisms-definition-finite-locally-free}).
Then $f$ is both proper and flat of relative dimension $0$, and
$$
f_*f^*\alpha = d\alpha
$$
for every $\alpha \in Z_k(Y)$.
\end{lemma}

\begin{proof}
A finite locally free morphism is flat and finite by
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-finite-flat},
and a finite morphism is proper
by Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-finite-proper}.
We omit showing that a finite
morphism has relative dimension $0$. Thus the formula makes sense.
To prove it, let $Z \subset Y$ be an integral closed subscheme
of $\delta$-dimension $k$. It suffices to prove the formula
for $\alpha = [Z]$. Since the base change of a finite locally free
morphism is finite locally free
(Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-base-change-finite-locally-free})
we see that $f_*f^*\mathcal{O}_Z$ is a finite locally free sheaf of
rank $d$ on $Z$. Thus clearly $f_*f^*\mathcal{O}_Z$ has length $d$
at the generic point of $Z$. Hence
$$
f_*f^*[Z] = f_*f^*[\mathcal{O}_Z]_k =
[f_*f^*\mathcal{O}_Z]_k = d[Z]
$$
where we have used Lemmas \ref{lemma-pullback-coherent} and
\ref{lemma-cycle-push-sheaf}.
\end{proof}










\section{Preparation for principal divisors}
\label{section-preparation-principal-divisors}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-preparation-principal-divisors}.
Some of the material in this section partially overlaps with the
discussion in Spaces over Fields, Section
\ref{spaces-over-fields-section-Weil-divisors}.

\begin{lemma}
\label{lemma-divisor-delta-dimension}
In Situation \ref{situation-setup} let $X/B$ be good. Assume $X$ is
integral.
\begin{enumerate}
\item If $Z \subset X$ is an integral closed subspace, then
the following are equivalent:
\begin{enumerate}
\item $Z$ is a prime divisor,
\item $|Z|$ has codimension $1$ in $|X|$, and
\item $\dim_\delta(Z) = \dim_\delta(X) - 1$.
\end{enumerate}
\item If $Z$ is an irreducible component of an effective Cartier
divisor on $X$, then $\dim_\delta(Z) = \dim_\delta(X) - 1$.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) follows from the definition of a prime divisor
(Spaces over Fields, Definition
\ref{spaces-over-fields-definition-Weil-divisor}),
Decent Spaces, Lemma \ref{decent-spaces-lemma-codimension-local-ring},
and the definition of a dimension function
(Topology, Definition \ref{topology-definition-dimension-function}).

\medskip\noindent
Let $D \subset X$ be an effective Cartier divisor. Let $Z \subset D$
be an irreducible component and let $\xi \in |Z|$ be the generic point.
Choose an \'etale neighbourhood $(U, u) \to (X, \xi)$ where $U = \Spec(A)$
and $D \times_X U$ is cut out by a nonzerodivisor $f \in A$, see
Divisors on Spaces, Lemma
\ref{divisors-lemma-characterize-effective-Cartier-divisor}.
Then $u$ is a generic point of $V(f)$ by
Decent Spaces, Lemma \ref{decent-spaces-lemma-decent-generic-points}.
Hence $\mathcal{O}_{U, u}$ has dimension $1$ by
Krull's Hauptidealsatz (Algebra, Lemma \ref{algebra-lemma-minimal-over-1}).
Thus $\xi$ is a codimension $1$ point on $X$ and $Z$ is a prime
divisor as desired.
\end{proof}












\section{Principal divisors}
\label{section-principal-divisors}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-principal-divisors}.
The following definition is the analogue of
Spaces over Fields, Definition
\ref{spaces-over-fields-definition-principal-divisor}
in our current setup.

\begin{definition}
\label{definition-principal-divisor}
In Situation \ref{situation-setup} let $X/B$ be good. Assume $X$ is
integral with $\dim_\delta(X) = n$.
Let $f \in R(X)^*$. The {\it principal divisor associated to $f$}
is the $(n - 1)$-cycle
$$
\text{div}(f) = \text{div}_X(f) = \sum \text{ord}_Z(f) [Z]
$$
defined in Spaces over Fields, Definition
\ref{spaces-over-fields-definition-principal-divisor}.
This makes sense because prime divisors have $\delta$-dimension $n - 1$ by
Lemma \ref{lemma-divisor-delta-dimension}.
\end{definition}

\noindent
In the situation of the definition for $f, g \in R(X)^*$ we have
$$
\text{div}_X(fg) = \text{div}_X(f) + \text{div}_X(g)
$$
in $Z_{n - 1}(X)$. See Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-div-additive}.
The following lemma will allow us to reduce
statements about principal divisors to the case of schemes.

\begin{lemma}
\label{lemma-etale-pullback-principal-divisor}
In Situation \ref{situation-setup} let $f : X \to Y$ be an \'etale
morphism of good spaces $X, Y/B$. Assume $Y$ is integral.
Let $g \in R(Y)^*$. As cycles on $X$ we have
$$
f^*(\text{div}_Y(g)) =
\sum\nolimits_{X'} (X' \to X)_*\text{div}_{X'}(g \circ f|_{X'})
$$
where the sum is over the irreducible components of $X$
(Remark \ref{remark-irreducible-component}).
\end{lemma}

\begin{proof}
The map $|X| \to |Y|$ is open. The set of irreducible components of $|X|$
is locally finite in $|X|$. We conclude that $f|_{X'} : X' \to Y$
is dominant for every irreducible component $X' \subset X$.
Thus $g \circ f|_{X'}$ is defined (Morphisms of Spaces, Section
\ref{spaces-morphisms-section-rational-maps}), hence
$\text{div}_{X'}(g \circ f|_{X'})$ is defined. Moreover, the
sum is locally finite and we find that the right hand side indeed
is a cycle on $X$. The left hand side is defined by
Definition \ref{definition-flat-pullback}
and the fact that an \'etale morphism is flat of relative dimension $0$.

\medskip\noindent
Since $f$ is \'etale we see that $\delta_X(x) = \delta_y(f(x))$
for all $x \in |X|$. Thus if $\dim_\delta(Y) = n$, then $\dim_\delta(X') = n$
for every irreducible component $X'$ of $X$ (since generic points of $X$
map to the generic point of $Y$, see above). Thus both left
and right hand side are $(n - 1)$-cycles.

\medskip\noindent
Let $Z \subset X$ be an integral closed subspace with $\dim_\delta(Z) = n - 1$.
To prove the equality, we need to show that the coefficients
of $Z$ are the same. Let $Z' \subset Y$ be the integral closed
subspace constructed in Lemma \ref{lemma-proper-image}.
Then $\dim_\delta(Z') = n - 1$ too. Let $\xi \in |Z|$ be the generic point.
Then $\xi' = f(\xi) \in |Z'|$ is the generic point.
Consider the commutative diagram
$$
\xymatrix{
\Spec(\mathcal{O}_{X, \xi}^h) \ar[r] \ar[d] & X \ar[d] \\
\Spec(\mathcal{O}_{Y, \xi'}^h) \ar[r] & Y
}
$$
We have to be slightly careful as the reduced Noetherian local rings
$\mathcal{O}_{X, \xi}^h$ and $\mathcal{O}_{Y, \xi'}^h$ need not be domains.
Thus we work with total rings of fractions $Q(-)$ rather than fraction fields.
By definition, to get the coefficient of $Z'$ in $\text{div}_Y(g)$
we write the image of $g$ in $Q(\mathcal{O}_{Y, \xi'}^h)$
as $a/b$ with $a, b \in \mathcal{O}_{Y, \xi'}^h$ nonzerodivisors
and we take
$$
\text{ord}_{Z'}(g) =
\text{length}_{\mathcal{O}_{Y, \xi'}^h}
(\mathcal{O}_{Y, \xi'}^h/a \mathcal{O}_{Y, \xi'}^h) -
\text{length}_{\mathcal{O}_{Y, \xi'}^h}
(\mathcal{O}_{Y, \xi'}^h/b \mathcal{O}_{Y, \xi'}^h)
$$
Observe that the coefficient of $Z$ in $f^*\text{div}_Y(G)$
is the same integer, see Lemma \ref{lemma-etale-pullback}.
Suppose that $\xi \in X'$. Then we can consider the maps
$$
\mathcal{O}_{Y, \xi'}^h \to
\mathcal{O}_{X, \xi}^h \to
\mathcal{O}_{X', \xi}^h
$$
The first arrow is flat and the second arrow is a surjective
map of reduced local Noetherian rings of dimension $1$.
Therefore both these maps send nonzerodivisors to nonzerodivisors
and we conclude the coefficient of $Z'$ in $\text{div}_{X'}(g \circ f|_{X'})$
is
$$
\text{ord}_Z(g \circ f|_{X'}) =
\text{length}_{\mathcal{O}_{X', \xi}^h}
(\mathcal{O}_{X', \xi}^h/a \mathcal{O}_{X', \xi}^h) -
\text{length}_{\mathcal{O}_{Y, \xi'}^h}
(\mathcal{O}_{X', \xi}^h/b \mathcal{O}_{X', \xi}^h)
$$
by the same prescription as above. Thus it suffices to show
$$
\text{length}_{\mathcal{O}_{Y, \xi'}^h}
(\mathcal{O}_{Y, \xi'}^h/a \mathcal{O}_{Y, \xi'}^h) =
\sum\nolimits_{\xi \in |X'|}
\text{length}_{\mathcal{O}_{X', \xi}^h}
(\mathcal{O}_{X', \xi}^h/a \mathcal{O}_{X', \xi}^h)
$$
First, since the ring map $\mathcal{O}_{Y, \xi'}^h \to
\mathcal{O}_{X, \xi}^h$ is flat and unramified, we have
$$
\text{length}_{\mathcal{O}_{Y, \xi'}^h}
(\mathcal{O}_{Y, \xi'}^h/a \mathcal{O}_{Y, \xi'}^h) =
\text{length}_{\mathcal{O}_{X, \xi}^h}
(\mathcal{O}_{X, \xi}^h/a \mathcal{O}_{X, \xi}^h)
$$
by Algebra, Lemma \ref{algebra-lemma-pullback-module}.
Let $\mathfrak q_1, \ldots, \mathfrak q_t$ be the nonmaximal
primes of $\mathcal{O}_{X, \xi}^h$ and set
$R_j = \mathcal{O}_{X, \xi}^h/\mathfrak q_j$.
For $X'$ as above, denote $J(X') \subset \{1, \ldots, t\}$
the set of indices such that $\mathfrak q_j$ corresponds
to a point of $X'$, i.e., such that under the surjection
$\mathcal{O}_{X, \xi}^h \to \mathcal{O}_{X', \xi}$
the prime $\mathfrak q_j$ corresponds to a prime
of $\mathcal{O}_{X', \xi}$.
By Chow Homology, Lemma \ref{chow-lemma-additivity-divisors-restricted}
we get
$$
\text{length}_{\mathcal{O}_{X, \xi}^h}
(\mathcal{O}_{X, \xi}^h/a \mathcal{O}_{X, \xi}^h) =
\sum\nolimits_j \text{length}_{R_j}(R_j/a R_j)
$$
and
$$
\text{length}_{\mathcal{O}_{X', \xi}^h}
(\mathcal{O}_{X', \xi}^h/a \mathcal{O}_{X', \xi}^h) =
\sum\nolimits_{j \in J(X')} \text{length}_{R_j}(R_j/a R_j)
$$
Thus the result of the lemma holds because
$\{1, \ldots, t\}$ is the disjoint union of the sets $J(X')$:
each point of codimension $0$ on $X$ is a unique $X'$.
\end{proof}







\section{Principal divisors and pushforward}
\label{section-two-fun}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-two-fun}.

\begin{lemma}
\label{lemma-proper-pushforward-alteration}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Assume $X$, $Y$ are integral and $n = \dim_\delta(X) = \dim_\delta(Y)$.
Let $p : X \to Y$ be a dominant proper morphism.
Let $f \in R(X)^*$. Set
$$
g = \text{Nm}_{R(X)/R(Y)}(f).
$$
Then we have
$p_*\text{div}(f) = \text{div}(g)$.
\end{lemma}

\begin{proof}
We are going to deduce this from the case of schemes by \'etale localization.
Let $Z \subset Y$ be an integral closed subspace of $\delta$-dimension
$n - 1$. We want to show that the coefficient of $[Z]$ in
$p_*\text{div}(f)$ and $\text{div}(g)$ are equal. Apply
Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-finite-in-codim-1}
to the morphism $p : X \to Y$ and the generic point $\xi \in |Z|$.
We find that we may replace $Y$ by an open subspace containing $\xi$
and assume that $p : X \to Y$ is finite. Pick an \'etale neighbourhood
$(V, v) \to (Y, \xi)$ where $V$ is an affine scheme.
By Lemma \ref{lemma-etale-pullback} it suffices to prove the equality
of cycles after pulling back to $V$.
Set $U = V \times_Y X$ and consider the commutative diagram
$$
\xymatrix{
U \ar[r]_a \ar[d]_{p'} & X \ar[d]^p \\
V \ar[r]^b & Y
}
$$
Let $V_j \subset V$, $j = 1, \ldots, m$ be the irreducible components
of $V$. For each $i$, let $U_{j, i}$, $i = 1, \ldots, n_j$ be the
irreducible components of $U$ dominating $V_j$. Denote
$p'_{j, i} : U_{j, i} \to V_j$ the restriction of $p' : U \to V$.
By the case of schemes
(Chow Homology, Lemma \ref{chow-lemma-proper-pushforward-alteration})
we see that
$$
p'_{j, i, *}\text{div}_{U_{j, i}}(f_{j, i}) = \text{div}_{V_j}(g_{j, i})
$$
where $f_{j, i}$ is the restriction of $f$ to $U_{j, i}$ and
$g_{j, i}$ is the norm of $f_{j, i}$ along the finite extension
$R(U_{j, i})/R(V_j)$. We have
\begin{align*}
b^* p_*\text{div}_X(f)
& =
p'_* a^* \text{div}_X(f) \\
& =
p'_*\left(\sum\nolimits_{j, i}
(U_{j, i} \to U)_*\text{div}_{U_{j, i}}(f_{j, i})\right) \\
& =
\sum\nolimits_{j, i}
(V_j \to V)_*p'_{j, i, *}\text{div}_{U_{j, i}}(f_{j, i}) \\
& =
\sum\nolimits_j
(V_j \to V)_*\left(\sum\nolimits_i \text{div}_{V_j}(g_{j, i})\right) \\
& =
\sum\nolimits_j (V_j \to V)_*\text{div}_{V_j}(\prod\nolimits_i g_{j, i})
\end{align*}
by Lemmas
\ref{lemma-flat-pullback-proper-pushforward},
\ref{lemma-etale-pullback-principal-divisor}, and
\ref{lemma-compose-pushforward}.
To finish the proof, using Lemma \ref{lemma-etale-pullback-principal-divisor}
again, it suffices to show that
$$
g \circ b|_{V_j} = \prod\nolimits_i g_{j, i}
$$
as elements of the function field of $V_j$. In terms of fields
this is the following statement: let $L/K$ be a finite extension.
Let $M/K$ be a finite separable extension. Write
$M \otimes_K L = \prod M_i$. Then for $t \in L$ with images
$t_i \in M_i$ the image of
$\text{Norm}_{L/K}(t)$ in $M$ is $\prod \text{Norm}_{M_i/M}(t_i)$.
We omit the proof.
\end{proof}







\section{Rational equivalence}
\label{section-rational-equivalence}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-rational-equivalence}.
In this section we define {\it rational equivalence} on $k$-cycles.
We will allow locally finite sums of images of
principal divisors (under closed immersions). This leads to some
pretty strange phenomena (see examples in the chapter on schemes).
However, if we do not allow these then we do not know how to prove that
capping with chern classes of line bundles factors through rational
equivalence.

\begin{definition}
\label{definition-rational-equivalence}
In Situation \ref{situation-setup} let $X/B$ be good.
Let $k \in \mathbf{Z}$.
\begin{enumerate}
\item Given any locally finite collection $\{W_j \subset X\}$
of integral closed subspaces with $\dim_\delta(W_j) = k + 1$,
and any $f_j \in R(W_j)^*$ we may consider
$$
\sum (i_j)_*\text{div}(f_j) \in Z_k(X)
$$
where $i_j : W_j \to X$ is the inclusion morphism.
This makes sense as the morphism
$\coprod i_j : \coprod W_j \to X$ is proper.
\item We say that $\alpha \in Z_k(X)$ is {\it rationally equivalent to zero}
if $\alpha$ is a cycle of the form displayed above.
\item We say $\alpha, \beta \in Z_k(X)$ are
{\it rationally equivalent} and we write $\alpha \sim_{rat} \beta$
if $\alpha - \beta$ is rationally equivalent to zero.
\item We define
$$
A_k(X) = Z_k(X) / \sim_{rat}
$$
to be the {\it Chow group of $k$-cycles on $X$}. This is sometimes called
the {\it Chow group of $k$-cycles modulo rational equivalence on $X$}.
\end{enumerate}
\end{definition}

\noindent
There are many other interesting equivalence relations.
Rational equivalence is the coarsest of them all.
A very simple but important lemma is the following.

\begin{lemma}
\label{lemma-restrict-to-open}
In Situation \ref{situation-setup} let $X$ be good.
Let $U \subset X$ be an open subspace. Let $Y$ be the
reduced closed subspace of $X$ with $|Y| = |X| \setminus |U|$
and denote $i : Y \to X$ the inclusion morphism. Let $k \in \mathbf{Z}$.
Suppose $\alpha, \beta \in Z_k(X)$. If $\alpha|_U \sim_{rat} \beta|_U$
then there exist a cycle $\gamma \in Z_k(Y)$ such that
$$
\alpha \sim_{rat} \beta + i_*\gamma.
$$
In other words, the sequence
$$
\xymatrix{
A_k(Y) \ar[r]^{i_*} & A_k(X) \ar[r]^{j^*} & A_k(U) \ar[r] & 0
}
$$
is an exact complex of abelian groups.
\end{lemma}

\begin{proof}
Let $\{W_j\}_{j \in J}$ be a locally finite collection of integral closed
subspaces of $U$ of $\delta$-dimension $k + 1$, and let $f_j \in R(W_j)^*$
be elements such that $(\alpha - \beta)|_U = \sum (i_j)_*\text{div}(f_j)$
as in the definition. Let $W_j' \subset X$ be the corresponding integral
closed subspace of $X$, i.e., having the same generic point as $W_j$.
Suppose that $V \subset X$ is a quasi-compact open.
Then also $V \cap U$ is quasi-compact open in $U$ as $V$ is Noetherian.
Hence the set $\{j \in J \mid W_j \cap V \not = \emptyset\}
= \{j \in J \mid W'_j \cap V \not = \emptyset\}$
is finite since $\{W_j\}$ is locally finite. In other words we see that
$\{W'_j\}$ is also locally finite. Since $R(W_j) = R(W'_j)$ we see
that
$$
\alpha - \beta - \sum (i'_j)_*\text{div}(f_j)
$$
is a cycle on $X$ whose restriction to $U$ is zero.
The lemma follows by applying Lemma \ref{lemma-exact-sequence-open}.
\end{proof}

\begin{remark}
\label{remark-infinite-sums-rational-equivalences}
In Situation \ref{situation-setup} let $X/B$ be good.
Suppose we have infinite collections $\alpha_i, \beta_i \in Z_k(X)$,
$i \in I$ of $k$-cycles on $X$. Suppose that the supports
of $\alpha_i$ and $\beta_i$ form locally finite collections
of closed subsets of $X$ so that $\sum \alpha_i$
and $\sum \beta_i$ are defined as cycles. Moreover, assume that
$\alpha_i \sim_{rat} \beta_i$ for each $i$. Then it is not
clear that $\sum \alpha_i \sim_{rat} \sum \beta_i$. Namely,
the problem is that the rational equivalences may be
given by locally finite
families $\{W_{i, j}, f_{i, j} \in R(W_{i, j})^*\}_{j \in J_i}$
but the union $\{W_{i, j}\}_{i \in I, j\in J_i}$ may not
be locally finite.

\medskip\noindent
In many cases in practice, one has a locally finite family of closed
subsets $\{T_i\}_{i \in I}$ of $|X|$ such that $\alpha_i, \beta_i$
are supported on $T_i$ and such that $\alpha_i \sim_{rat} \beta_i$
``on'' $T_i$. More precisely, the families
$\{W_{i, j}, f_{i, j} \in R(W_{i, j})^*\}_{j \in J_i}$
consist of integral closed subspaces $W_{i, j}$
with $|W_{i, j}| \subset T_i$. In this case it is true that
$\sum \alpha_i \sim_{rat} \sum \beta_i$ on $X$, simply because
the family $\{W_{i, j}\}_{i \in I, j\in J_i}$ is automatically
locally finite in this case.
\end{remark}











\section{Rational equivalence and push and pull}
\label{section-properties-rational-equivalence}

\noindent
This section is the analogue of
Chow Homology, Section \ref{chow-section-properties-rational-equivalence}.
In this section we show that flat pullback and proper pushforward
commute with rational equivalence.

\begin{lemma}
\label{lemma-prepare-flat-pullback-rational-equivalence}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Assume $Y$ integral with $\dim_\delta(Y) = k$.
Let $f : X \to Y$ be a flat morphism of
relative dimension $r$. Then for $g \in R(Y)^*$ we have
$$
f^*\text{div}_Y(g) =
\sum m_{X', X} (X' \to X)_*\text{div}_{X'}(g \circ f|_{X'})
$$
as $(k + r - 1)$-cycles on $X$ where the sum is over the irreducible
components $X'$ of $X$ and $m_{X', X}$ is the multiplicity of $X'$ in $X$.
\end{lemma}

\begin{proof}
Observe that any irreducible component of $X$ dominates $Y$
(Lemma \ref{lemma-flat-inverse-image-dimension})
and hence the composition $g \circ f|_{X'}$ is defined
(Morphisms of Spaces, Section \ref{morphisms-section-rational-maps}).
We will reduce this to the case of schemes. Choose a scheme $V$ and a
surjective \'etale morphism $V \to Y$. Choose a scheme $U$ and a surjective
\'etale morphism $U \to V \times_Y X$. Picture
$$
\xymatrix{
U \ar[r]_a \ar[d]_h & X \ar[d]^f \\
V \ar[r]^b & Y
}
$$
Since $a$ is surjective and \'etale it follows from
Lemma \ref{lemma-etale-pullback} that it suffices to prove the
equality of cycles after pulling back by $a$.
We can use Lemma \ref{lemma-etale-pullback-principal-divisor} to write
$$
b^*\text{div}_Y(g) = \sum (V' \to V)_*\text{div}_{V'}(g \circ b|_{V'})
$$
where the sum is over the irreducible components $V'$ of $V$.
Using Lemma \ref{lemma-flat-pullback-proper-pushforward} we find
$$
h^*b^*\text{div}_Y(g) =
\sum (V' \times_V U \to U)_*(h')^*\text{div}_{V'}(g \circ b|_{V'})
$$
where $h' : V' \times_V U \to V'$ is the projection.
We may apply the lemma in the case of schemes
(Chow Homology, Lemma \ref{lemma-prepare-flat-pullback-rational-equivalence})
to the morphism $h' : V' \times_V U \to V'$ to see that we have
$$
(h')^*\text{div}_{V'}(g \circ b|_{V'}) =
\sum
m_{U', V' \times_V U}
(U' \to V' \times_V U)_*\text{div}_{U'}(g \circ b|_{V'} \circ h'|_{U'})
$$
where the sum is over the irreducible components $U'$ of $V' \times_V U$.
Each $U'$ occurring in this sum is an irreducible component of $U$
and conversely every irreducible component $U'$ of $U$ is an
irreducible component of $V' \times_V U$
for a unique irreducible component $V' \subset V$.
Given an irreducible component $U' \subset U$,
denote $\overline{a(U')} \subset X$ the ``image'' in $X$
(Lemma \ref{lemma-proper-image}); this
is an irreducible component of $X$ for example by
Lemma \ref{lemma-flat-inverse-image-dimension}.
The muplticity $m_{U', V' \times_V U}$ is equal to
the multiplicity $m_{\overline{a(U')}, X}$.
This follows from the equality $h^*a^*[Y] = b^*f^*[Y]$
(Lemma \ref{lemma-compose-flat-pullback}), the definitions, and
Lemma \ref{lemma-etale-pullback}.
Combining all of what we just said we obtain
$$
a^*f^*\text{div}_Y(g) =
h^*b^*\text{div}_Y(g) =
\sum m_{\overline{a(U')}, X}
(U' \to U)_*\text{div}_{U'}(g \circ (f \circ a)|_{U'})
$$
Next, we analyze what happens with the right hand side of the
formula in the statement of the lemma if we pullback by $a$.
First, we use Lemma \ref{lemma-flat-pullback-proper-pushforward}
to get
$$
a^*\sum m_{X', X} (X' \to X)_*\text{div}_{X'}(g \circ f|_{X'}) =
\sum m_{X', X} (X' \times_X U \to U)_*(a')^*\text{div}_{X'}(g \circ f|_{X'})
$$
where $a' : X' \times_X U \to X'$ is the projection.
By Lemma \ref{lemma-etale-pullback-principal-divisor}
we get
$$
(a')^*\text{div}_{X'}(g \circ f|_{X'}) =
\sum (U' \to X' \times_X U)_*\text{div}_{U'}(g \circ (f \circ a)|_{U'})
$$
where the sum is over the irreducible components $U'$ of $X' \times_X U$.
These $U'$ are irreducible components of $U$ and in fact are exactly the
irreducible components of $U$ such that $\overline{a(U')} = X'$.
Comparing with what we obtained above we conclude.
\end{proof}

\begin{lemma}
\label{lemma-flat-pullback-rational-equivalence}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $f : X \to Y$ be a flat morphism of relative dimension $r$.
Let $\alpha \sim_{rat} \beta$ be rationally equivalent $k$-cycles
on $Y$. Then $f^*\alpha \sim_{rat} f^*\beta$ as $(k + r)$-cycles on $X$.
\end{lemma}

\begin{proof}
What do we have to show? Well, suppose we are given a collection
$$
i_j : W_j \longrightarrow Y
$$
of closed immersions, with each $W_j$ integral of $\delta$-dimension $k + 1$
and rational functions $g_j \in R(W_j)^*$. Moreover, assume that
the collection $\{|i_j|(|W_j|)\}_{j \in J}$ is locally finite in $|Y|$.
Then we have to show that
$$
f^*(\sum i_{j, *}\text{div}(g_j)) = \sum f^*i_{j, *}\text{div}(g_j)
$$
is rationally equivalent to zero on $X$. The sum on the right
makes sense by Lemma \ref{lemma-inverse-image-locally-finite}.

\medskip\noindent
Consider the fibre products
$$
i'_j : W'_j = W_j \times_Y X \longrightarrow X.
$$
and denote $f_j : W'_j \to W_j$ the first projection.
By Lemma \ref{lemma-flat-pullback-proper-pushforward}
we can write the sum above as
$$
\sum i'_{j, *}(f_j^*\text{div}(g_j))
$$
By Lemma \ref{lemma-prepare-flat-pullback-rational-equivalence}
we see that each $f_j^*\text{div}(g_j)$ is rationally equivalent
to zero on $W'_j$. Hence each $i'_{j, *}(f_j^*\text{div}(g_j))$
is rationally equivalent to zero. Then the same is true for
the displayed sum by the discussion in
Remark \ref{remark-infinite-sums-rational-equivalences}.
\end{proof}

\begin{lemma}
\label{lemma-proper-pushforward-rational-equivalence}
In Situation \ref{situation-setup} let $X, Y/B$ be good.
Let $p : X \to Y$ be a proper morphism.
Suppose $\alpha, \beta \in Z_k(X)$ are rationally equivalent.
Then $p_*\alpha$ is rationally equivalent to $p_*\beta$.
\end{lemma}

\begin{proof}
What do we have to show? Well, suppose we are given a collection
$$
i_j : W_j \longrightarrow X
$$
of closed immersions, with each $W_j$ integral of $\delta$-dimension $k + 1$
and rational functions $f_j \in R(W_j)^*$.
Moreover, assume that
the collection $\{i_j(W_j)\}_{j \in J}$ is locally finite on $X$.
Then we have to show that
$$
p_*\left(\sum i_{j, *}\text{div}(f_j)\right)
$$
is rationally equivalent to zero on $X$.

\medskip\noindent
Note that the sum is equal to
$$
\sum p_*i_{j, *}\text{div}(f_j).
$$
Let $W'_j \subset Y$ be the integral closed subspace which is the
image of $p \circ i_j$, see Lemma \ref{lemma-proper-image}.
The collection $\{W'_j\}$ is locally finite
in $Y$ by Lemma \ref{lemma-quasi-compact-locally-finite}.
Hence it suffices to show, for a given $j$, that either
$p_*i_{j, *}\text{div}(f_j) = 0$ or that it
is equal to $i'_{j, *}\text{div}(g_j)$ for some $g_j \in R(W'_j)^*$.

\medskip\noindent
The arguments above therefore reduce us to the case of a since
integral closed subspace $W \subset X$ of $\delta$-dimension $k + 1$.
Let $f \in R(W)^*$. Let $W' = p(W)$ as above.
We get a commutative diagram of morphisms
$$
\xymatrix{
W \ar[r]_i \ar[d]_{p'} & X \ar[d]^p \\
W' \ar[r]^{i'} & Y
}
$$
Note that $p_*i_*\text{div}(f) = i'_*(p')_*\text{div}(f)$ by
Lemma \ref{lemma-compose-pushforward}. As explained above
we have to show that $(p')_*\text{div}(f)$
is the divisor of a rational function on $W'$ or zero.
There are three cases to distinguish.

\medskip\noindent
The case $\dim_\delta(W') < k$. In this case automatically
$(p')_*\text{div}(f) = 0$ and there is nothing to prove.

\medskip\noindent
The case $\dim_\delta(W') = k$. Let us show that $(p')_*\text{div}(f) = 0$
in this case. Since $(p')_*\text{div}(f)$ is a $k$-cycle, we see
that $(p')_*\text{div}(f) = n[W']$ for some $n \in \mathbf{Z}$.
In order to prove that $n = 0$ we may replace $W'$ by
a nonempty open subspace. In particular, we may and
do assume that $W'$ is a scheme. Let $\eta \in W'$ be the generic point.
Let $K = \kappa(\eta) = R(W')$ be the function field.
Consider the base change diagram
$$
\xymatrix{
W_\eta \ar[r] \ar[d]_c & W \ar[d]^{p'} \\
\Spec(K) \ar[r]^\eta & W'
}
$$
Observe that $c$ is proper. Also $|W_\eta|$ has dimension $1$:
use Decent Spaces, Lemma \ref{decent-spaces-lemma-topology-fibre}
to identify $|W_\eta|$ as the subspace of $|W|$ of points mapping to $\eta$
and note that since $\dim_\delta(W) = k + 1$ and $\delta(\eta) = k$
points of $W_\eta$ must have $\delta$-value either $k$ or $k + 1$.
Thus the local rings have dimension $\leq 1$ by
Decent Spaces, Lemma \ref{decent-spaces-lemma-codimension-local-ring}.
By Spaces over Fields, Lemma
\ref{spaces-over-fields-lemma-codim-1-point-in-schematic-locus}
we find that $W_\eta$ is a scheme.
Since $\Spec(K)$ is the limit of the nonempty affine open subschemes of $W'$
we conclude that we may assume that $W$ is a scheme by
Limits of Spaces, Lemma \ref{spaces-limits-lemma-limit-is-scheme}.
Then finally by the case of schemes
(Chow Homology, Lemma \ref{chow-lemma-proper-pushforward-rational-equivalence})
we find that $n = 0$.

\medskip\noindent
The case $\dim_\delta(W') = k + 1$. In this case
Lemma \ref{lemma-proper-pushforward-alteration} applies,
and we see that indeed $p'_*\text{div}(f) = \text{div}(g)$
for some $g \in R(W')^*$ as desired.
\end{proof}














\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
