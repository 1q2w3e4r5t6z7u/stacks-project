\input{preamble}

% OK, start here.
%
\begin{document}

\title{Derived Categories of Spaces}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we discuss derived categories of modules on algebraic spaces.
There do not seem to be good introductory references addressing this topic;
it is covered in the literature by referring to papers dealing with derived
categories of modules on algebraic stacks, for example see
\cite{olsson_sheaves}.



\section{Conventions}
\label{section-conventions}

\noindent
If $\mathcal{A}$ is an abelian category and $M$ is an object
of $\mathcal{A}$ then we also denote $M$ the object of $K(\mathcal{A})$
and/or $D(\mathcal{A})$ corresponding to the complex which has
$M$ in degree $0$ and is zero in all other degrees.

\medskip\noindent
If we have a ring $A$, then $K(A)$ denotes the homotopy category
of complexes of $A$-modules and $D(A)$ the associated derived category.
Similarly, if we have a ringed space $(X, \mathcal{O}_X)$ the symbol
$K(\mathcal{O}_X)$ denotes the homotopy category of complexes of
$\mathcal{O}_X$-modules and $D(\mathcal{O}_X)$ the associated derived
category.








\section{Derived category of quasi-coherent modules}
\label{section-derived-quasi-coherent}

\noindent
Let $S$ be a scheme. In
Derived Categories of Schemes, Lemma
\ref{perfect-lemma-derived-quasi-coherent-small-etale-site}
we proved that the category $D_{QCoh}(\mathcal{O}_S)$ can be defined
in terms of complexes of $\mathcal{O}_S$-modules on the scheme $S$
or by complexes of $\mathcal{O}$-modules on the small \'etale site
of $S$. Hence the following definition is compatible with the definition
in the case of schemes.

\begin{definition}
\label{definition-derived-quasi-coherent}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
The {\it derived category of $\mathcal{O}_X$-modules with
quasi-coherent cohomology sheaves} is denoted
$D_{QCoh}(\mathcal{O}_X)$.
\end{definition}

\noindent
This makes sense by
Properties of Spaces, Lemma
\ref{spaces-properties-lemma-properties-quasi-coherent}
and
Derived Categories, Section \ref{derived-section-triangulated-sub}.
Thus we obtain a canonical functor
\begin{equation}
\label{equation-compare}
D(\textit{QCoh}(\mathcal{O}_X))
\longrightarrow
D_{\textit{QCoh}}(\mathcal{O}_X)
\end{equation}
see Derived Categories, Equation (\ref{derived-equation-compare}).

\medskip\noindent
Observe that a flat morphism $f : Y \to X$ of algebraic spaces
induces an exact functor
$f^* : \textit{Mod}(\mathcal{O}_X) \to \textit{Mod}(\mathcal{O}_Y)$,
see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-flat-morphism-sites}
and
Modules on Sites, Lemma \ref{sites-modules-lemma-flat-pullback-exact}.
In particular $Lf^* : D(\mathcal{O}_X) \to D(\mathcal{O}_Y)$
is computed on any representative complex
(Derived Categories, Lemma \ref{derived-lemma-right-derived-exact-functor}).
We will write $Lf^* = f^*$ when $f$ is flat and we have
$H^i(f^*E) = f^*H^i(E)$ for $E$ in $D(\mathcal{O}_X)$ in this case.
We will use this often when $f$ is \'etale. Of course in the \'etale
case the pullback functor is just the restriction to $Y_{\acute{e}tale}$,
see Properties of Spaces, Equation
(\ref{spaces-properties-equation-restrict-modules}).

\begin{lemma}
\label{lemma-check-quasi-coherence-on-covering}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Let $E$ be an object of $D(\mathcal{O}_X)$. The following are equivalent
\begin{enumerate}
\item $E$ is in $D_{\textit{QCoh}}(\mathcal{O}_X)$,
\item for every \'etale morphism $\varphi : U \to X$ where $U$ is an
affine scheme $\varphi^*E$ is an object of
$D_{\textit{QCoh}}(\mathcal{O}_U)$,
\item for every \'etale morphism $\varphi : U \to X$ where $U$ is a scheme
$\varphi^*E$ is an object of
$D_{\textit{QCoh}}(\mathcal{O}_U)$,
\item there exists a surjective \'etale morphism $\varphi : U \to X$
where $U$ is a scheme such that $\varphi^*E$ is an object of
$D_{\textit{QCoh}}(\mathcal{O}_U)$, and
\item there exists a surjective \'etale morphism of algebraic spaces
$f : Y \to X$ such that $Lf^*E$ is an object of
$D_{\textit{QCoh}}(\mathcal{O}_Y)$.
\end{enumerate}
\end{lemma}

\begin{proof}
This follows immediately from the discussion preceding the lemma and
Properties of Spaces, Lemma
\ref{spaces-properties-lemma-characterize-quasi-coherent}.
\end{proof}

\begin{lemma}
\label{lemma-quasi-coherence-direct-sums}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Then $D_{\textit{QCoh}}(\mathcal{O}_X)$ has direct sums.
\end{lemma}

\begin{proof}
By Injectives, Lemma \ref{injectives-lemma-derived-products}
the derived category $D(\mathcal{O}_X)$ has direct sums and
they are computed by taking termwise direct sums of any representatives.
Thus it is clear that the cohomology sheaf of a direct sum is the
direct sum of the cohomology sheaves as taking direct sums is
an exact functor (in any grothendieck abelian category). The lemma
follows as the direct sum of quasi-coherent sheaves is quasi-coherent, see
Properties of Spaces, Lemma
\ref{spaces-properties-lemma-properties-quasi-coherent}.
\end{proof}

\begin{lemma}
\label{lemma-quasi-coherence-pullback}
Let $S$ be a scheme.
Let $f : Y \to X$ be a morphism of algebraic spaces over $S$.
The functor $Lf^*$ sends $D_{\textit{QCoh}}(\mathcal{O}_X)$
into $D_{\textit{QCoh}}(\mathcal{O}_Y)$.
\end{lemma}

\begin{proof}
Choose a diagram
$$
\xymatrix{
U \ar[d]_a \ar[r]_h & V \ar[d]^b \\
X \ar[r]^f & Y
}
$$
where $U$ and $V$ are schemes, the vertical arrows are \'etale, and
$a$ is surjective. Since $a^* \circ Lf^* = Lh^* \circ b^*$ the result
follows from
Lemma \ref{lemma-check-quasi-coherence-on-covering}
and the case of schemes which is
Derived Categories of Schemes, Lemma
\ref{perfect-lemma-quasi-coherence-pullback}.
\end{proof}

\begin{lemma}
\label{lemma-quasi-coherence-tensor-product}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
For objects $K, L$ of $D_{\textit{QCoh}}(\mathcal{O}_X)$
the derived tensor product $K \otimes^\mathbf{L} L$ is in
$D_{\textit{QCoh}}(\mathcal{O}_X)$.
\end{lemma}

\begin{proof}
Let $\varphi : U \to X$ be a surjective \'etale morphism from a scheme $U$.
Since
$\varphi^*(K \otimes_{\mathcal{O}_X}^\mathbf{L} L) =
\varphi^*K \otimes_{\mathcal{O}_U}^\mathbf{L} \varphi^*L$
we see from
Lemma \ref{lemma-check-quasi-coherence-on-covering}
that this follows from the case of schemes which is
Derived Categories of Schemes, Lemma
\ref{perfect-lemma-quasi-coherence-tensor-product}.
\end{proof}

\noindent
The following lemma will help us to ``compute'' a right derived functor
on an object of $D_{\textit{QCoh}}(\mathcal{O}_X)$.

\begin{lemma}
\label{lemma-nice-K-injective}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$. Let $E$ be an
object of $D_{\textit{QCoh}}(\mathcal{O}_X)$. Then there exists an inverse
system $\mathcal{I}_n^\bullet$ of complexes of $\mathcal{O}_X$-modules
such that
\begin{enumerate}
\item $\mathcal{I} = \lim_n \mathcal{I}_n^\bullet$ represents $E$,
\item $\mathcal{I}_n^\bullet$ is a bounded below complex of injectives,
\item $\tau_{\geq -n}E \to \mathcal{I}_n^\bullet$ is an isomorphism
in $D(\mathcal{O}_X)$,
\item the transition maps
$\mathcal{I}_{n + 1}^\bullet \to \mathcal{I}_n^\bullet$
are termwise split surjections, and
\item $\mathcal{I}^\bullet$ is a K-injective complex of
$\mathcal{O}_X$-modules.
\end{enumerate}
\end{lemma}

\begin{proof}
Denote $\mathcal{H}^i = H^i(E)$ the $i$th cohomology sheaf of $E$.
Let $\mathcal{B}$ be the set of affine objects of $X_{\acute{e}tale}$.
Then $H^p(U, \mathcal{H}^i) = 0$ for all $p > 0$, all $i \in \mathbf{Z}$,
and all $U \in \mathcal{B}$ as $U$ is an affine scheme.
See discussion in
Cohomology of Spaces, Section
\ref{spaces-cohomology-section-higher-direct-image}
and
Cohomology of Schemes, Lemma
\ref{coherent-lemma-quasi-coherent-affine-cohomology-zero}.
Thus the lemma follows from an application of
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-K-injective}.
\end{proof}

\begin{lemma}
\label{lemma-application-nice-K-injective}
Let $S$ be a scheme. Let $X$ be an algebraic space over $S$.
Let $F : \textit{Mod}(\mathcal{O}_X) \to \textit{Ab}$
be a functor and $N \geq 0$ an integer. Assume that
\begin{enumerate}
\item $F$ is left exact,
\item $F$ commutes with countable direct products,
\item $R^pF(\mathcal{F}) = 0$ for all $p \geq N$ and $\mathcal{F}$
quasi-coherent.
\end{enumerate}
Then for $E \in D_{\textit{QCoh}}(\mathcal{O}_X)$ the maps
$R^pF(E) \to R^pF(\tau_{\geq p - N + 1}E)$ are isomorphisms.
\end{lemma}

\begin{proof}
Let $E$ be an object of $D_{\textit{QCoh}}(\mathcal{O}_X)$.
By shifting the complex we see it suffices to prove the assertion
for $p = 0$. Choose $\mathcal{I}^\bullet = \lim \mathcal{I}_n^\bullet$
as in Lemma \ref{lemma-nice-K-injective}.
As $\mathcal{I}^\bullet$ is K-injective $RF(E)$ is represented by
$F(\mathcal{I}^\bullet)$. As $F$ commutes with countable direct
products, and since the maps $\mathcal{I}_n^m \to \mathcal{I}_{n - 1}^m$
are split surjections, we get
$F(\mathcal{I}^\bullet) = \lim F(\mathcal{I}_n^\bullet)$.
The comohomology of
\begin{equation}
\label{equation-system-F}
F(\mathcal{I}_n^{-2}) \to
F(\mathcal{I}_n^{-1}) \to
F(\mathcal{I}_n^0) \to
F(\mathcal{I}_n^1)
\end{equation}
in degree $0$, resp.\ $-1$ is equal to $R^0F(\tau_{\geq -n}E)$,
resp.\ $R^{-1}F(\tau_{\geq -n}E)$ because $\mathcal{I}_n^\bullet$
is a bounded below complex of injectives representing $\tau_{\geq -n}E$.
We have a distinguished triangle
$$
H^{-n}(E)[n] \to \tau_{\geq -n}E \to \tau_{\geq - n + 1}E \to H^{-n}(E)[n + 1]
$$
in $D(\mathcal{O}_X)$. Since $H^{-n}(E)$ is quasi-coherent we have
$$
R^pF(H^{-n}(E)[n]) = R^{p + n}F(H^{-n}(E)) = 0
$$
for $p + n \geq N$ and
$$
R^pF(H^{-n}(E)[n + 1]) = R^{p + n + 1}F(H^{-n}(E)) = 0
$$
for $p + n + 1 \geq N$. We conclude that
$$
R^pF(\tau_{\geq -n}E) \to R^pF(\tau_{\geq - n + 1}E)
$$
is an isomorphism for all $n \gg p$ and an isomorphism for
$n \geq N$ for $p = 0$. Thus
Homology, Lemma \ref{homology-lemma-apply-Mittag-Leffler-again}
applies to the system of sequences (\ref{equation-system-F})
and we conclude that $R^0F(E) = \lim R^0F(\tau_{\geq - n}E)$.
By the above the system $R^0F(\tau_{\geq - n}E)$ is constant starting
with $n = N - 1$ as desired.
\end{proof}









\section{Total direct image}
\label{section-total-direct-image}

\noindent
The following lemma is the analogue of
Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-vanishing-higher-direct-images}.

\begin{lemma}
\label{lemma-quasi-coherence-direct-image}
Let $S$ be a scheme. Let $f : X \to Y$ be a quasi-separated and quasi-compact
morphism of algebraic spaces over $S$.
\begin{enumerate}
\item The functor $Rf_*$ sends $D_{\textit{QCoh}}(\mathcal{O}_X)$
into $D_{\textit{QCoh}}(\mathcal{O}_Y)$.
\item If $Y$ is quasi-compact, there exists an integer $N = N(X, Y, f)$
such that for an object $E$ of $D_{\textit{QCoh}}(\mathcal{O}_X)$
with $H^m(E) = 0$ for $m > 0$ we have
$H^m(Rf_*E) = 0$ for $m > N$.
\item In fact, if $Y$ is quasi-compact we can find $N = N(X, Y, f)$
such that for every morphism of schemes $Y' \to Y$
the same conclusion holds for the functor $R(f')_*$
where $f' : X' \to Y'$ is the base change of $f$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $E$ be an object of $D_{\textit{QCoh}}(\mathcal{O}_X)$.
To prove (1) we have to show that $Rf_*E$ has quasi-coherent
cohomology sheaves. This question is local on $Y$, hence we may
assume $Y$ is quasi-compact. Pick $N = N(X, Y, f)$ as in
Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-vanishing-higher-direct-images}.
Thus $R^pf_*\mathcal{F} = 0$ for all quasi-coherent $\mathcal{O}_X$-modules
$\mathcal{F}$ and all $p \geq N$. In particular, for any affine
object $V$ of $Y_{\acute{e}tale}$ we have $H^p(V \times_Y X, \mathcal{F}) = 0$
for $p \geq N$, see
Cohomology of Spaces, Lemma
\ref{spaces-cohomology-lemma-quasi-coherence-higher-direct-images-application}.

\medskip\noindent
Let $E$ be an object of $D_{\textit{QCoh}}(\mathcal{O}_X)$.
Choose $\mathcal{I}^\bullet = \lim \mathcal{I}_n^\bullet$
as in Lemma \ref{lemma-nice-K-injective}.
As $\mathcal{I}^\bullet$ is K-injective $Rf_*E$ is represented by
$f_*\mathcal{I}^\bullet = \lim f_*\mathcal{I}_n^\bullet$.
Let $V$ be an affine object of $Y_{\acute{e}tale}$. The cohomology
$H^m(f_*\mathcal{I}_n^\bullet(V))$ of
$$
f_*\mathcal{I}_n^{m - 1}(V) \to
f_*\mathcal{I}_n^m(V) \to
f_*\mathcal{I}_n^{m + 1}(V)
$$
is equal to $H^m(V \times_Y X, \tau_{\geq -n}E)$ because
$\mathcal{I}_n^\bullet$ is a bounded below complex of injectives
representing $\tau_{\geq -n}E$. We have a distinguished triangle
$$
H^{-n}(E)[n] \to \tau_{\geq -n}E \to \tau_{\geq - n + 1}E \to H^{-n}(E)[n + 1]
$$
in $D(\mathcal{O}_X)$. Since $H^{-n}(E)$ is quasi-coherent we have
$H^m(V \times_Y X, H^{-n}(E)[n]) = 0$ for $n + m \geq N$ by
our choice of $N$. Similarly, $H^m(V \times_Y X, H^{-n}(E)[n + 1]) = 0$
for $n + m + 1 \geq N$. We conclude that
$$
H^m(f_*\mathcal{I}_n^\bullet(V)) \to H^m(f_*\mathcal{I}_{n - 1}^\bullet(V))
$$
is an isomorphism for all $n \geq N - m$. Thus
Cohomology on Sites, Lemma \ref{sites-cohomology-lemma-inverse-limit-complexes}
applies to show that the $m$th cohomology sheaf of
$\lim f_*\mathcal{I}_n^\bullet$ agrees with the $m$th cohomology
sheaf of $f_*\mathcal{I}_n^\bullet$ for $n \geq N - m$. Since these
cohomology sheaves are quasi-coherent by
Cohomology of Spaces, Lemma \ref{spaces-cohomology-lemma-higher-direct-image}
we get (1).

\medskip\noindent
Finally, we show that (2) and (3) hold with our choice of $N$.
Namely, the stabilization proven above gives that $H^m(Rf_*E)$ is equal
to $H^m(Rf_*(\tau_{\geq -n}E))$ for all $n$ large enough which means we
can work with objects in $D^+(\mathcal{O}_X)$ in order to prove (2) and (3).
In this case we can for example use the spectral sequence
$$
R^pf_*H^q(E) \Rightarrow R^{p + q}f_*E
$$
(Derived Categories, Lemma \ref{derived-lemma-two-ss-complex-functor})
and the vanishing of $R^pf_*H^q(E)$ for $p \geq N$ to conclude.
Some details omitted.
\end{proof}

\begin{lemma}
\label{lemma-quasi-coherence-pushforward-direct-sums}
Let $S$ be a scheme. Let $f : X \to Y$ be a quasi-separated and
quasi-compact morphism of algebraic spaces over $S$. Then
$Rf_* : D_{\textit{QCoh}}(\mathcal{O}_X) \to D_{\textit{QCoh}}(\mathcal{O}_S)$
commutes with direct sums.
\end{lemma}

\begin{proof}
Let $E_i$ be a family of objects of $D_{\textit{QCoh}}(\mathcal{O}_X)$
and set $E = \bigoplus E_i$. We want to show that the map
$$
\bigoplus Rf_*E_i \longrightarrow Rf_*E
$$
is an isomomorphism. We will show it induces an isomorphism on
cohomology sheaves in degree $0$ which will imply the lemma.
Choose an integer $N$ as in Lemma \ref{lemma-quasi-coherence-direct-image}.
Then $R^0f_*E = R^0f_*\tau_{\geq -N}E$ and
$R^0f_*E_i = R^0f_*\tau_{\geq -N}E_i$ by the lemma cited. Observe that
$\tau_{\geq -N}E = \bigoplus \tau_{\geq -N}E_i$.
Thus we may assume all of the $E_i$ have vanishing cohomology
sheaves in degrees $< -N$. Next we use the spectral sequences
$$
R^pf_*H^q(E) \Rightarrow R^{p + q}f_*E
\quad\text{and}\quad
R^pf_*H^q(E_i) \Rightarrow R^{p + q}f_*E_i
$$
(Derived Categories, Lemma \ref{derived-lemma-two-ss-complex-functor})
to reduce to the case of a direct sum of quasi-coherent sheaves.
This case is handled by
Cohomology of Spaces, Lemma \ref{spaces-cohomology-lemma-colimit-cohomology}.
\end{proof}








\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}

