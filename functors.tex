\input{preamble}

% OK, start here.
%
\begin{document}

\title{Functors versus morphisms}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
Let $X$ and $Y$ be schemes. In this chapter circles around the relationship
between functors $\QCoh(\mathcal{O}_Y) \to \QCoh(\mathcal{O}_X)$ and
morphisms of schemes $X \to Y$. More broadly speaking we study the
relationship between $\QCoh(\mathcal{O}_X)$ and $X$ or, if $X$ is Noetherian,
the relationship between $\textit{Coh}(\mathcal{O}_X)$ and $X$.
This relationship was studied in \cite{Gabriel}.







\section{Functors between categories of modules}
\label{section-functors}

\noindent
The following lemma is archetypical of the results in this chapter.

\begin{lemma}
\label{lemma-functor}
Let $A$ and $B$ be rings. Let $F : \text{Mod}_A \to \text{Mod}_B$
be a functor. The following are equivalent
\begin{enumerate}
\item $F$ is isomorphic to the functor $M \mapsto M \otimes_A K$
for some $A \otimes_\mathbf{Z} B$-module $K$,
\item $F$ is right exact and commutes with all direct sums,
\item $F$ commutes with all colimits,
\item $F$ has a right adjoint $G$.
\end{enumerate}
\end{lemma}

\begin{proof}
If (1), then (4) as a right adjoint for $M \mapsto M \otimes_A K$
is $N \mapsto \Hom_B(K, N)$, see
Differential Graded Algebra, Lemma \ref{dga-lemma-tensor-hom-adjunction}.
If (4), then (3) by Categories, Lemma \ref{categories-lemma-adjoint-exact}.
The implication (3) $\Rightarrow$ (2) is immediate from the definitions.

\medskip\noindent
Assume (2). We will prove (1). By the discussion in
Homology, Section \ref{homology-section-functors}
the functor $F$ is additive. Hence $F$ induces
a ring map $A \to \text{End}_B(F(M))$, $a \mapsto F(a \cdot \text{id}_M)$
for every $A$-module $M$. We conclude that $F(M)$ is an
$A \otimes_\mathbf{Z} B$-module functorially in $M$.
Set $K = F(A)$. Define
$$
M \otimes_A K = M \otimes_A F(A) \longrightarrow F(M),
\quad m \otimes k \longmapsto F(\varphi_m)(k)
$$
Here $\varphi_m : A \to M$ sends $a \to am$. The rule
$(m, k) \mapsto F(\varphi_m)(k)$ is $A$-bilinear (and $B$-linear
on the right) as required to obtain the displayed
$A \otimes_\mathbf{Z} B$-linear map.
This construction is functorial in $M$, hence defines a transformation
of functors $- \otimes_A K \to F(-)$ which is an isomorphism when
evaluated on $A$. For every $A$-module $M$ we can choose an exact sequence
$$
\bigoplus\nolimits_{j \in J} A \to
\bigoplus\nolimits_{i \in I} A \to
M \to 0
$$
Using the maps constructed above we find a commutative diagram
$$
\xymatrix{
(\bigoplus\nolimits_{j \in J} A) \otimes_A K \ar[r] \ar[d] &
(\bigoplus\nolimits_{i \in I} A) \otimes_A K \ar[r] \ar[d] &
M \otimes_A K \ar[r] \ar[d] &
0 \\
F(\bigoplus\nolimits_{j \in J} A) \ar[r] &
F(\bigoplus\nolimits_{i \in I} A) \ar[r] &
F(M) \ar[r] &  0
}
$$
The lower row is exact as $F$ is right exact.
The upper row is exact as tensor product with $K$ is right exact.
Since $F$ commutes with direct sums the left two vertical arrows
are bijections. Hence we conclude.
\end{proof}

\begin{example}
\label{example-functor-modules}
Let $R$ be a ring. Let $A$ and $B$ be $R$-algebras. Let $K$ be a
$A \otimes_R B$-module. Then we can consider the functor
\begin{equation}
\label{equation-FM-modules}
F : \text{Mod}_A \longrightarrow \text{Mod}_B,\quad
M \longmapsto M \otimes_A K
\end{equation}
This functor is $R$-linear, right exact,
commutes with arbitrary direct sums, commutes
with all colimits, has a right adjoint (Lemma \ref{lemma-functor}).
\end{example}

\begin{lemma}
\label{lemma-functor-modules}
Let $R$ be a ring. Let $A$ and $B$ be $R$-algebras. There is an
equivalence of categories between
\begin{enumerate}
\item the category of $R$-linear functors
$F : \text{Mod}_A \to \text{Mod}_B$ which
are right exact and commute with arbitrary direct sums, and
\item the category $\text{Mod}_{A \otimes_R B}$.
\end{enumerate}
given by sending $K$ to the functor $F$ in (\ref{equation-FM-modules}).
\end{lemma}

\begin{proof}
Let $F$ be an object of the first category. By
Lemma \ref{lemma-functor} we may assume $F(M) = M \otimes_A K$
functorially in $M$ for some $A \otimes_\mathbf{Z} B$-module $K$.
The $R$-linearity of $F$ immediately implies that the
$A \otimes_\mathbf{Z} B$-module structure on $K$ comes
from a (unique) $A \otimes_R B$-module structure on $K$.
Thus we see that sending $K$ to $F$ as in (\ref{equation-FM-modules})
is essentially surjective.

\medskip\noindent
To prove that our functor is fully faithful, we have to show that
given $A \otimes_R B$-modules $K$ and $K'$ any transformation
$t : F \to F'$ between the corresponding functors, comes from
a unique $\varphi : K \to K'$. Since $K = F(A)$ and $K' = F'(A)$
we can take $\varphi$ to be the value $t_A : F(A) \to F'(A)$
of $t$ at $A$. This maps is $A \otimes_R B$-linear by the
definition of the $A \otimes B$-module structure on $F(A)$
and $F'(A)$ given in the proof of Lemma \ref{lemma-functor}.
\end{proof}

\begin{remark}
\label{remark-composition}
Let $R$ be a ring. Let $A$, $B$, $C$ be $R$-algebras.
Let $F : \text{Mod}_A \to \text{Mod}_B$ and
$F' : \text{Mod}_B \to \text{Mod}_C$ be
$R$-linear, right exact functors which commute with arbitrary direct sums.
If by the equivalence of Lemma \ref{lemma-functor-modules} the object
$K$ in $\text{Mod}_{A \otimes_R B}$ corresponds to $F$ and the object
$K'$ in $\text{Mod}_{B \otimes_R C}$ corresponds to $F'$, then
$K \otimes_B K'$ viewed as an object of
$\text{Mod}_{A \otimes_R C}$ corresponds to $F' \circ F$.
\end{remark}

\begin{remark}
\label{remark-exact-flat}
In the situation of Lemma \ref{lemma-functor-modules}
suppose that $F$ corresponds to $K$. Then
$F$ is exact $\Leftrightarrow$ $K$ is flat over $A$.
\end{remark}

\begin{remark}
\label{remark-finite}
In the situation of Lemma \ref{lemma-functor-modules}
suppose that $F$ corresponds to $K$. Then
$F$ sends finite $A$-modules to finite $B$-modules
$\Leftrightarrow$ $K$ is finite as a $B$-module.
\end{remark}

\begin{remark}
\label{remark-finite-presentation}
In the situation of Lemma \ref{lemma-functor-modules}
suppose that $F$ corresponds to $K$. Then
$F$ sends finitely presented $A$-modules to finitely presented $B$-modules
$\Leftrightarrow$ $K$ is finitely presented as a $B$-module.
\end{remark}

\begin{lemma}
\label{lemma-functor-equivalence}
Let $A$ and $B$ be rings. If
$$
F : \text{Mod}_A \longrightarrow \text{Mod}_B
$$
is an equivalence of categories, then there exists an isomorphism
$A \to B$ of rings and an invertible $B$-module $L$ such that
$F$ is isomorphic to the functor $M \mapsto (M \otimes_A B) \otimes_B L$.
\end{lemma}

\begin{proof}
Since an equivalence commutes with all colimits, we see that
Lemmas \ref{lemma-functor} applies. Let $K$ be the
$A \otimes_\mathbf{Z} B$-module such that $F$ is
isomorphic to the functor $M \mapsto M \otimes_A K$.
Let $K'$ be the $B \otimes_\mathbf{Z} A$-module such that
a quasi-inverse of $F$ is
isomorphic to the functor $N \mapsto N \otimes_B K'$.
By Remark \ref{remark-composition} and
Lemma \ref{lemma-functor-modules} we have an isomorphism
$$
\psi : K \otimes_B K' \longrightarrow A
$$
of $A \otimes_\mathbf{Z} A$-modules.
Similarly, we have an isomorphism
$$
\psi' : K' \otimes_A K \longrightarrow B
$$
of $B \otimes_\mathbf{Z} B$-modules. Choose an element
$\xi = \sum_{i = 1, \ldots, n} x_i \otimes y_i \in K \otimes_B K'$
such that $\psi(\xi) = 1$. Consider the isomorphisms
$$
K \xrightarrow{\psi^{-1} \otimes \text{id}_K}
K \otimes_B K' \otimes_A K \xrightarrow{\text{id}_K \otimes \psi'} K
$$
The composition is an isomorphism and given by
$$
k \longmapsto \sum x_i \psi'(y_i \otimes k)
$$
We conclude this automorphism factors as
$$
K \to B^{\oplus n} \to K
$$
as a map of $B$-modules. It follows that $K$ is finite
projective as a $B$-module.

\medskip\noindent
We claim that $K$ is invertible as a $B$-module. This is equivalent
to asking the rank of $K$ as a $B$-module to have the constant value $1$,
see More on Algebra, Lemma \ref{more-algebra-lemma-invertible} and
Algebra, Lemma \ref{algebra-lemma-finite-projective}.
If not, then there exists a maximal ideal $\mathfrak m \subset B$
such that either (a) $K \otimes_B B/\mathfrak m = 0$ or
(b) there is a surjection $K \to (B/\mathfrak m)^{\oplus 2}$ of
$B$-modules. Case (a) is absurd as $K' \otimes_A K \otimes_B N = N$
for all $B$-modules $N$. Case (b) would imply we get a surjection
$$
A = K \otimes_B K' \longrightarrow (B/\mathfrak m \otimes_B K')^{\oplus 2}
$$
of (right) $A$-modules. This is impossible as the target is an $A$-module
which needs at least two generators: $B/\mathfrak m \otimes_B K'$
is nonzero as the image of the nonzero module $B/\mathfrak m$ under
the quasi-inverse of $F$.

\medskip\noindent
Since $K$ is invertible as a $B$-module we see that $\Hom_B(K, K) = B$.
Since $K = F(A)$ the action of $A$ on $K$ defines a ring isomorphism
$A \to B$. The lemma follows.
\end{proof}

\begin{lemma}
\label{lemma-functor-equivalence-linear}
Let $R$ be a ring. Let $A$ and $B$ be $R$-algebras. If
$$
F : \text{Mod}_A \longrightarrow \text{Mod}_B
$$
is an $R$-linear equivalence of categories, then there exists an isomorphism
$A \to B$ of $R$-algebras and an invertible $B$-module $L$ such that
$F$ is isomorphic to the functor $M \mapsto (M \otimes_A B) \otimes_B L$.
\end{lemma}

\begin{proof}
We get $A \to B$ and $L$ from Lemma \ref{lemma-functor-equivalence}.
To finish the proof, we need to show that the $R$-linearity
of $F$ forces $A \to B$ to be an $R$-algebra map. We omit the details.
\end{proof}

\begin{remark}
\label{remark-monoidal}
Let $A$ and $B$ be rings. Let us endow $\text{Mod}_A$ and $\text{Mod}_B$
with the usual monoidal structure given by tensor products of modules.
Let $F : \text{Mod}_A \to \text{Mod}_B$ be a functor of
monoidal categories, see
Categories, Definition \ref{categories-definition-functor-monoidal-categories}.
Here are some comments:
\begin{enumerate}
\item Since $F(A)$ is a unit (by our definitions) we have $F(A) = B$.
\item We obtain a multiplicative map $\varphi : A \to B$
by sending $a \in A$ to its action on $F(A) = B$.
\item Take $A = B$ and $F(M) = M \otimes_A M$. In this case $\varphi(a) = a^2$.
\item If $F$ is additive, then $\varphi$ is a ring map.
\item Take $A = B = \mathbf{Z}$ and $F(M) = M/\text{torsion}$. Then
$\varphi = \text{id}_\mathbf{Z}$ but $F$ is not the identity functor.
\item If $F$ is right exact and commutes with direct sums,
then $F(M) = M \otimes_{A, \varphi} B$ by Lemma \ref{lemma-functor}.
\end{enumerate}
In other words, ring maps $A \to B$ are in bijection with isomorphism classes
of functors of monoidal categories $\text{Mod}_A \to \text{Mod}_B$
which commute with all colimits.
\end{remark}




\section{Extending functors on categories of modules}
\label{section-functors-extend}

\noindent
For a ring $A$ let us denote $\text{Mod}^{fp}_A$ the category of
finitely presented $A$-modules.

\begin{lemma}
\label{lemma-functor-fp-modules}
Let $A$ and $B$ be rings. Let
$F : \text{Mod}^{fp}_A \to \text{Mod}^{fp}_B$ be a functor.
Then $F$ extends uniquely to a functor
$F' : \text{Mod}_A \to \text{Mod}_B$
which commutes with filtered colimits.
\end{lemma}

\begin{proof}
This follows from
Categories, Lemma \ref{categories-lemma-extend-functor-by-colim}.
To see that the lemma applies observe that
finitely presented $A$-modules are
categorically compact objects of $\text{Mod}_A$ by
Algebra, Lemma \ref{algebra-lemma-characterize-finitely-presented-module-hom}.
Also, every $A$-module is a filtered colimit
of finitely presented $A$-modules by
Algebra, Lemma \ref{algebra-lemma-module-colimit-fp}.
\end{proof}

\begin{remark}
\label{remark-monoidal-extension}
With $A$, $B$, $F$, and $F'$ as in Lemma \ref{lemma-functor-fp-modules}.
Observe that the tensor product of two finitely presented modules is
finitely presented, see Algebra, Lemma \ref{algebra-lemma-tensor-finiteness}.
Thus we may endow $\text{Mod}^{fp}_A$, $\text{Mod}^{fp}_B$,
$\text{Mod}_A$, and $\text{Mod}_B$ with the usual monoidal structure
given by tensor products of modules. In this case, if $F$ is
a functor of monoidal categories, so is $F'$. This follows immediately
from the fact that tensor products of modules commutes with filtered
colimits.
\end{remark}

\begin{lemma}
\label{lemma-functor-fp-modules-exact}
With $A$, $B$, $F$, and $F'$ as in Lemma \ref{lemma-functor-fp-modules}.
\begin{enumerate}
\item If $F$ is additive, then $F'$ is additive and
commutes with arbitrary direct sums, and
\item if $F$ is right exact, then $F'$ is right exact.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume $F$ is additive. To show that $F'$ is additive it suffices to show
that $F'(M) \oplus F'(M') \to F'(M \oplus M')$ is an isomorphism for
any $A$-modules $M$, $M'$, see
Homology, Lemma \ref{homology-lemma-additive-functor}.
Write $M = \colim_i M_i$ and $M' = \colim_j M'_j$ as filtered colimits
of finitely presented $A$-modules $M_i$. Then
$F'(M) = \colim_i F(M_i)$, $F'(M') = \colim_j F(M'_j)$, and
\begin{align*}
F'(M \oplus M')
& =
F'(\colim_{i, j} M_i \oplus M'_j) \\
& =
\colim_{i, j} F(M_i \oplus M'_j) \\
& =
\colim_{i, j} F(M_i) \oplus F(M'_j) \\
& =
F'(M) \oplus F'(M')
\end{align*}
as desired. To show that $F'$ commutes with direct sums, assume
we have $M = \bigoplus_{i \in I} M_i$. Then
$M = \colim_{I' \subset I\text{ finite}} \bigoplus_{i \in I'} M_i$
is a filtered colimit. We obtain
\begin{align*}
F'(M)
& =
\colim_{I' \subset I\text{ finite}}
F'(\bigoplus\nolimits_{i \in I'} M_i) \\
& =
\colim_{I' \subset I\text{ finite}}
\bigoplus\nolimits_{i \in I'} F'(M_i) \\
& =
\bigoplus\nolimits_{i \in I} F'(M_i)
\end{align*}
The second equality holds by the additivity of $F'$ already shown.
This proves (1).

\medskip\noindent
Before we continue the proof a warning:
the categories $\text{Mod}^{fp}_A$ and $\text{Mod}^{fp}_B$
are not abelian in general. But these categories have all finite colimits as
a cokernel of a map of finitely presented modules is finitely presented,
see Algebra, Lemma \ref{algebra-lemma-extension}.
Hence right exactness of the functor $F$
is defined in Categories, Definition \ref{categories-definition-exact}.
On the other hand, the categories $\text{Mod}_A$ and $\text{Mod}_B$
are abelian, and there we use the criterion for right exactness given in
Homology, Lemma \ref{homology-lemma-exact-functor}.

\medskip\noindent
Proof of (2). Assume $F$ is right exact.
Then $F$ commutes with coproducts of pairs, which are
represented by direct sums. Hence $F$ is additive by
Homology, Lemma \ref{homology-lemma-additive-functor}.
Hence so is $F'$ by (1). Let $0 \to K \to L \to M \to 0$
be a short exact sequence of $A$-modules. We have to show that
$$
F'(K) \to F'(L) \to F'(M) \to 0
$$
is exact. Write $M = \colim M_i$ as a filtered colimit of finitely
presented $A$-modules. Pulling back our short exact sequence
we obtain short exact sequences $0 \to K \to L_i \to M_i \to 0$.
Since $F'$ commutes with filtered colimits and since
filtered colimits are exact
(Algebra, Lemma \ref{algebra-lemma-directed-colimit-exact})
it suffices to prove the statement for each of the sequences
$0 \to K \to L_i \to M_i \to 0$, i.e., we may assume $M$
is finitely presented. In this case we write $L = \colim L_i$
as a filtered colimit of finitely presented $A$-modules
with the property that each $L_i$ surjects onto $M$.
We obtain a directed system of short exact sequences
$0 \to \Ker(L_i \to M) \to L_i \to M \to 0$.
Repeating the argument already given, we reduce to the case that both
$L$ and $M$ are finitely presented $A$-modules.
In this case the module $K$ is finite
(Algebra, Lemma \ref{algebra-lemma-extension})
and we can choose a surjection $A^{\oplus n} \to K$.
Denote $\varphi : A^{\oplus n} \to L$ the composition.
Then we have
$$
M = \text{Coeq}(\varphi, 0 : A^{\oplus n} \to L)
$$
Since $F$ commutes with coequalizers we obtain
$$
F(M) = \text{Coeq}(F(\varphi), 0 : F(A^{\oplus n}) \to F(L))
$$
Since $F(\varphi)$ factors through the map
$F(A^{\oplus n}) \to F'(K)$
and since the composition $F'(K) \to F(L) \to F(M)$ is zero
we conclude.
\end{proof}

\begin{remark}
\label{remark-monoidal-extension-exact}
Combining Remarks \ref{remark-monoidal} and \ref{remark-monoidal-extension}
and Lemma \ref{lemma-functor-fp-modules-exact}
we find the following. Given rings $A$ and $B$ the set of ring maps $A \to B$
is in bijection with the set of isomorphism classes
of functors of monoidal categories $\text{Mod}^{fp}_A \to \text{Mod}^{fp}_B$
which are right exact.
\end{remark}

\begin{lemma}
\label{lemma-functor-fp-modules-left-exact}
With $A$, $B$, $F$, and $F'$ as in Lemma \ref{lemma-functor-fp-modules}.
Assume $A$ is a coherent ring
(Algebra, Definition \ref{algebra-definition-coherent}).
If $F$ is left exact, then $F'$ is left exact.
\end{lemma}

\begin{proof}
Since $A$ is coherent, the category $\text{Mod}^{fp}_A$ is abelian
(by Algebra, Lemmas \ref{algebra-lemma-coherent-ring} and
\ref{algebra-lemma-coherent}). Hence all finite limits exist in
$\text{Mod}^{fp}_A$ and
Categories, Definition \ref{categories-definition-exact}
applies.

\medskip\noindent
Assume $F$ is left exact. Then $F$ commutes with products of pairs, which are
represented by direct sums. Hence $F$ is additive by
Homology, Lemma \ref{homology-lemma-additive-functor}.
Let $0 \to K \to L \to M \to 0$
be a short exact sequence of $A$-modules. We have to show that
$$
0 \to F'(K) \to F'(L) \to F'(M)
$$
is exact, see Homology, Lemma \ref{homology-lemma-exact-functor}.
By exactly the same arguments as given in the proof of
Lemma \ref{lemma-functor-fp-modules-left-exact}
we reduce to the case where both $M$ and $L$ are of finite
presentation. However, then $K$ is of finite presentation too.
Thus we have to show that
$0 \to F(K) \to F(L) \to F(M)$ is exact
which follows from the left exactness of $F$
(via Homology, Lemma \ref{homology-lemma-additive-functor}
applied to $F$ viewed as a functor into $\text{Mod}_B$).
\end{proof}

\noindent
For a ring $A$ let us denote $\text{Mod}^{fg}_A$ the category of
finitely generated $A$-modules (AKA finite $A$-modules).

\begin{lemma}
\label{lemma-functor-finite-modules}
Let $A$ and $B$ be Noetherian rings. Let
$F : \text{Mod}^{fg}_A \to \text{Mod}^{fg}_B$ be a functor.
Then $F$ extends uniquely to a functor $F' : \text{Mod}_A \to \text{Mod}_B$
which commutes with filtered colimits. If $F$ is additive, then
$F'$ is additive and commutes with arbitrary direct sums.
If $F$ is exact, left exact, or right exact, so is $F'$.
\end{lemma}

\begin{proof}
See Lemmas \ref{lemma-functor-fp-modules-exact} and
\ref{lemma-functor-fp-modules-left-exact}.
Also, use the finite $A$-modules are finitely presented $A$-modules,
see Algebra, Lemma
\ref{algebra-lemma-Noetherian-finite-type-is-finite-presentation},
and use that Noetherian rings are coherent, see
Algebra, Lemma \ref{algebra-lemma-Noetherian-coherent}.
\end{proof}









\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}

