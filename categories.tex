\input{preamble} 


% OK, start here.
%
\begin{document}

\title{Categories}

%\begin{abstract}
%\end{abstract}

\maketitle

\tableofcontents
\section{Introduction}
\label{section-introduction}

\noindent
Categories were first introduced in \cite{GenEqui}.
The category of categories (which is a proper class)
is a $2$-category. Similarly, the category of stacks
forms a $2$-category. If you already know
about categories, but not about $2$-categories you
should read \ref{section-formal-cat-cat} as
an introduction to the formal definitions later on.

\section{Definitions}
\label{section-definition-categories}

\noindent
We recall the definitions, partly to fix notation.

\begin{definition}
\label{definition-category}
A {\it category} $\mathcal{C}$ consists of the following data:
\begin{enumerate}
\item A set of objects $\text{Ob}(\mathcal{C})$.
\item For each pair $x,y \in \text{Ob}(\mathcal{C})$ a set of morphisms
$\text{Mor}_\mathcal{C}(x,y)$.
\item For each triple $x,y,z\in \text{Ob}(\mathcal{C})$ a composition
map $ \text{Mor}_\mathcal{C}(y,z) \times \text{Mor}_\mathcal{C}(x,y) 
\to \text{Mor}_\mathcal{C}(x,z) $, denoted $(\phi, \psi) \mapsto 
\phi \circ \psi$.
\end{enumerate}
These data are to satisfy the following rules:
\begin{enumerate}
\item For every element $x\in \text{Ob}(\mathcal{C})$ there exists a
morphism $\text{id}_x\in \text{Mor}_\mathcal{C}(x,x)$ such that 
$\text{id}_x \circ \phi = \phi$ and $\psi \circ \text{id}_x = \psi $ whenever
these compositions make sense.
\item Composition is transitive $(\phi \circ \psi) \circ \chi =
\phi \circ ( \psi \circ \chi)$ whenever these compositions make sense.
\end{enumerate}
\end{definition}

\noindent
It is customary to require all the morphism sets
$\text{Mor}_{\mathcal{C}}(x,y)$ to be disjoint.
In this way a morphism $\phi: x \to y$ has a unique {\it source} $x$
and a unique {\it target} $y$. This is not strictly necessary,
allthough care has to be taken in formulating condition (2) above
if it is not the case. It is convenient and we will often assume
this is the case. In this case we say that $\phi$ and $\psi$ are
{\it composable} if the source of $\phi$ is equal to the 
target of $\psi$, in which case $\phi \circ \psi$ is defined.
An equivalent definition would be to define a category
as a quintuple $(\text{Ob}, \text{Arrows}, s, t, \circ)$
consisting of a set of objects, a set of morphisms (arrows),
source, target and composition subject to a long list of axioms.
We will occasionally use this point of view.

\begin{remark}
\label{remark-big-categories}
Big categories. In some texts a category is allowed to have a proper
class of objects. We will allow this as well in these notes but only
in the following list of cases (to be updated as we go along).
In particular, when we say: ``Let $\mathcal{C}$ be a category''
then it is understood that $\text{Ob}(\mathcal{C})$ is a set.
\begin{enumerate}
\item The category $\textit{Sets}$ of sets.
\item The category of abelian groups.
\item The category $\textit{Groups}$ of groups.
\item Given a group $G$ the category $G\textit{-Sets}$ of
sets with a left $G$-action.
\item Given a ring $R$ the category of $R$-modules.
\item Given a field $k$ the category of vector spaces over $k$.
\item The category of rings.
\item The category of schemes.
\item The category $\textit{Top}$ of topological spaces.
\item Given a topological space $X$ the category
$\textit{PSh}(X)$ of presheaves of sets over $X$.
\item Given a topological space $X$ the category
$\textit{Sh}(X)$ of sheaves of sets over $X$.
\item Given a topological space $X$ the category
$\textit{PAb}(X)$ of presheaves of abelian groups over $X$.
\item Given a topological space $X$ the category
$\textit{Ab}(X)$ of sheaves of abelian groups over $X$.
\item Given a small category $\mathcal{C}$ the category of functors
from $\mathcal{C}$ to $\textit{Sets}$.
\item Given a category $\mathcal{C}$ the category of presheaves of sets
over $\mathcal{C}$.
\item Given a site $\mathcal{C}$ the category of sheaves
of sets over $\mathcal{C}$.
\end{enumerate}
One of the reason to enumerate these here is to try and avoid 
working with something like the ``collection'' of ``big'' categories
which would be like working with the collection of all classes
which I think definitively is a meta-mathematical object.
\end{remark}

\begin{remark}
\label{remark-unique-indentity}
It follows directly from the definition any two identity morphisms
of and object $x$ of $\mathcal{A}$ are the same. Thus we may and will
speak of {\it the} identity morphism $\text{id}_x$ of $x$.
\end{remark}

\begin{definition}
\label{definition-isomorphism}
A morphism $\phi : x \to y$ is an {\it isomorphism} of the category
$\mathcal{C}$ if there exists a morphism $\psi : y \to x$
such that $\phi \circ \psi = \text{id}_y$ and
$\psi \circ \phi = \text{id}_x$.
\end{definition}

\noindent
An isomorphism $\phi$ is also sometimes called an {\it invertible}
morphism, and the morphism $\psi$ of the definition is called the
{\it inverse} and denoted $\phi^{-1}$. It is unique if it exists. Note that
given an object $x$ of a category $\mathcal{A}$ the set of invertible
elements $\text{Aut}_{\mathcal{A}}(x)$
of $\text{Mor}_{\mathcal{A}}(x,x)$ forms a group under composition. 
This group is called the {\it automorphism} group of $x$ in $\mathcal{A}$.

\begin{definition} 
\label{definition-groupoid}
A {\it groupoid} is a category where every morphism is an isomorphism.
\end{definition}

\begin{example}
\label{example-group-groupoid}
A group $G$ gives rise to a groupoid with a single object $x$
and morphisms $\text{Mor}(x,x) = G$, with the composition rule
given by the group law in $G$. Every groupoid with a single
object is of this form.
\end{example}

\begin{example}
\label{example-set-groupoid}
A set $C$ gives rise to a groupoid $\mathcal{C}$ defined as follows:
As objects we take $\text{Ob}(\mathcal{C}) := C$ and for morphsms
we take $\text{Mor}(x,y)$ empty if $x\neq y$ and equal to
$\{\text{id}_x\}$ if $x=y$.
\end{example}

\begin{definition}
\label{definition-functor}
A {\it functor} $F : \mathcal{A} \to \mathcal{B}$
between two categories $\mathcal{A}, \mathcal{B}$ is given by the
following data:
\begin{enumerate}
\item A map $F : \text{Ob}(\mathcal{A}) \to \text{Ob}(\mathcal{B})$.
\item For every $x,y \in \text{Ob}(\mathcal{A})$ a map
$F : \text{Mor}_\mathcal{A}(x,y) \to \text{Mor}_\mathcal{B}(F(x), F(y))$,
denoted $\phi \mapsto F(\phi)$.
\end{enumerate}
These data should be compatible with composition and identity morphisms
in the following manner: $F(\phi \circ \psi) =
F(\phi) \circ F(\psi)$ for a composable pair $(\phi, \psi)$ of
morphisms of $\mathcal{A}$ and $F(\text{id}_x) = \text{id}_{F(x)}$.
\end{definition}

\noindent
Note that every category $\mathcal{A}$ has an
{\it identity} functor $\text{id}_\mathcal{A}$.
In addition, given a functor $G : \mathcal{B} \to \mathcal{C}$
and a functor $F : \mathcal{A} \to \mathcal{B}$ there is
a {\it composition} functor $G \circ F : \mathcal{A} \to \mathcal{C}$
defined in an obvious manner.

\begin{definition}
\label{definition-faithfull}
Let $F : \mathcal{A} \to \mathcal{B}$ be a functor.
\begin{enumerate}
\item We say $F$ is {\it faithfull} if 
for any objects $x,y$ of $\text{Ob}(\mathcal{A})$ the map
$F : \text{Mor}_\mathcal{A}(x,y) \to \text{Mor}_\mathcal{B}(F(x), F(y))$
is injective.
\item If these maps are all bijective then $F$ is called
{\it fully faithfull}.
\item
The functor $F$ is called {\it essentially surjective} if for any 
object $y \in \text{Ob}(\mathcal{B})$ there exists an object
$x \in \text{Ob}(\mathcal{A})$ such that $F(x)$ is isomorphic to $y$ in
$\mathcal{B}$.
\end{enumerate}
\end{definition}

\begin{definition}
\label{definition-subcategory}
A {\it subcategory} of a category $\mathcal{B}$ is
a category $\mathcal{A}$ whose objects and arrows
form subsets of the objects and arrows
of $\mathcal{A}$ and such that source, target
and composition in $\mathcal{A}$ agree with those
of $\mathcal{B}$. We say $\mathcal{A}$ is a
{\it full subcategory} of $\mathcal{B}$ if $\text{Mor}_{\mathcal{A}}(x,y)
= \text{Mor}_{\mathcal{B}}(x,y)$ for all $x,y \in \text{Ob}(\mathcal{A})$.
\end{definition}

\noindent
If $\mathcal{A} \subset \mathcal{B}$ is a subcategory then the
identity map is a functor from $\mathcal{A}$ to $\mathcal{B}$.
Furthermore a subcategory $\mathcal{A} \subset \mathcal{B}$
is full if and only if the inclusion functor is fully faithfull.
Note that given a category $\mathcal{B}$ the set of full subcategories
of $\mathcal{B}$ is the same as the set of subsets of
$\text{Ob}(\mathcal{B})$.

\begin{remark} 
\label{remark-functor-into-sets}
Suppose that $\mathcal{A}$ is a category.
A functor $F$ from $\mathcal{A}$ to $\textit{Sets}$
is a mathematical object (i.e., it is a set, see
Sets \autoref{sets-section-sets-everything})
even though the category of sets is ``big''.
Namely, the range of $F$ on objects will be 
a set $F(\text{Ob}(\mathcal{A}))$ and then we 
may think of $F$ as a functor between 
$\mathcal{A}$ and the full subcategory
of the category of sets whose
objects are elements of $F(\text{Ob}(\mathcal{A}))$.
\end{remark}

\begin{example}
\label{example-group-homorphism-functor}
A homomorphism $p\colon G\to H$ of groups gives rise to a functor
between the associated groupoids in Example \ref{example-group-groupoid}. It is
faithful (resp.\ fully faithful) if and only if $p$ is injective (resp.\ an
isomorphism).
\end{example}

\begin{example}
\label{example-category-over-X}
Given a category $\mathcal{C}$ and an object $X\in \text{Ob}(\mathcal{C})$
we define the {\it category of objects over $X$},
denoted $\mathcal{C}/X$ as follows.
The objects of $\mathcal{C}/X$ are morphisms $Y\to X$ for
some $Y\in \text{Ob}(\mathcal{C})$. Morphisms between objects
$Y\to X$ and $Y'\to X$ are morphisms $Y\to Y'$ in $\mathcal{C}$ that
make the obvious diagram commute.  Note that there is a functor
$p_X\colon \mathcal{C}/X\to \mathcal{C}$ which simply forgets the
morphism.  Moreover given a morphism $f\colon X'\to X$ in
$\mathcal{C}$ there is an induced functor 
$F\colon \mathcal{C}/X' \to \mathcal{C}/X$ obtained by composition with $f$,
and $p_X\circ F = p_{X'}$.
\end{example}

\begin{example}
\label{example-category-under-X}
Given a category $\mathcal{C}$ and an object $X\in \text{Ob}(\mathcal{C})$
we define the {\it category of objects under $X$},
denoted $X/\mathcal{C}$ as follows.
The objects of $X/\mathcal{C}$ are morphisms $X\to Y$ for
some $Y\in \text{Ob}(\mathcal{C})$. Morphisms between objects
$X\to Y$ and $X\to Y'$ are morphisms $Y\to Y'$ in $\mathcal{C}$ that
make the obvious diagram commute.  Note that there is a functor
$p_X\colon X/\mathcal{C}\to \mathcal{C}$ which simply forgets the
morphism.  Moreover given a morphism $f\colon X'\to X$ in
$\mathcal{C}$ there is an induced functor 
$F\colon X/\mathcal{C} \to X'/\mathcal{C}$
obtained by composition with $f$,
and $p_{X'}\circ F = p_X$.
\end{example}




\begin{definition}
Let $F, G : \mathcal{A} \to \mathcal{B}$ be functors.
A {\it transformation}, or a {\it morphism} of functors
$t : F \to G$, is a collection $\{t_x\}_{x\in \text{Ob}(\mathcal{A})}$
such that
\begin{enumerate}
\item $t_x : F(x) \to G(x)$ is a morphism in the category $\mathcal{B}$, and
\item for every morphism $\phi : x \to y$ of $\mathcal{A}$ the following
diagram is commutative
$$
\xymatrix{
F(x) \ar[r]^{t_x} \ar[d]_{F(\phi)} & G(x) \ar[d]^{G(\phi)} \\
F(y) \ar[r]^{t_y} & G(y) }
$$
\end{enumerate}
\end{definition}

\noindent
Sometimes we use the diagram
$$
\xymatrix{
\mathcal{A}
\rtwocell^F_{G}{t}
&
\mathcal{B}
}
$$
to indicate that $t$ is a morphism from $F$ to $G$.

\medskip\noindent
Note that every functor $F$ comes with the {\it identity} transformation
$\text{id}_F : F \to F$. In addition, given a morphism of
functors $t : F \to G$ and a morphism of functors $s : E \to F$
then the {\it composition} $t \circ s$ is defined by the rule
$$
(t \circ s)_x = t_x \circ s_x : E(x) \to G(x)
$$
for $x \in \text{Ob}(\mathcal{A})$.
It is easy to verify that this is indeed a morphism of functors
from $E$ to $G$.
In this way, given categories 
$\mathcal{A}$ and $\mathcal{B}$ we obtain a new category,
namely the category of functors between $\mathcal{A}$ and
$\mathcal{B}$.

\begin{remark}
This is one instance where the same thing does not hold if
$\mathcal{A}$ is a ``big'' category. For example consider
functors $\textit{Sets} \to \textit{Sets}$. As we have currently
defined it such a functor is a class and not a set. In other
words, it is given by a formula in set theory (with some variables
equal to specified sets)! It is not a good idea to try to consider
all possible formulae of set theory as part of the definition of 
a mathematical object. The same problem presents itself when
considering sheaves on the category of schemes for example.
We will come back to this point later.
\end{remark}

\begin{definition}
\label{definiton-equivalence-categories}
An {\it equivalence of categories}
$F : \mathcal{A} \to \mathcal{B}$ is a functor such that there
exists a functor $G : \mathcal{B} \to \mathcal{A}$ such that
the compositions $F \circ G$ and $G \circ F$ are isomorphic to the
identity functors $\text{id}_\mathcal{B}$,
respectively $\text{id}_\mathcal{A}$.
\end{definition}

\begin{lemma}
A functor is an equivalence of categories if and only if it is both fully
faithful and essentially surjective.
\end{lemma}

\begin{proof} FIXME. \end{proof}

\begin{definition}
\label{definition-product-category}
Let $\mathcal{A}$, $\mathcal{B}$ be categories.
We define the {\it product category} to be the category
$\mathcal{A}\times \mathcal{B}$ to be the category with
objects
$\text{Ob}(\mathcal{A}\times \mathcal{B}) =
\text{Ob}(\mathcal{A}) \times \text{Ob}(\mathcal{B})$
and 
$$
\text{Mor}_{\mathcal{A}\times \mathcal{B}}((x,y), (x',y'))
:=
\text{Mor}_{\mathcal{A}}(x, x')\times
\text{Mor}_{\mathcal{B}}(y, y').
$$
Composition is defined componentwise.
\end{definition}


\section{Opposite Categories and the Yoneda Lemma}
\label{section-opposite}

\begin{definition}
\label{definition-opposite}
Given a category $\mathcal{C}$ the {\it opposite category}
$\mathcal{C}^{\text{opp}}$ is the category with the same objects
as $\mathcal{C}$ but all morphisms reversed.
\end{definition}

\noindent
In other
words $\text{Mor}_{\mathcal{C}^{\text{opp}}}(x,y) =
\text{Mor}_{\mathcal{C}}(y,x)$. Composition in $\mathcal{C}^{\text{opp}}$
is the same as in $\mathcal{C}$ except backwards: if $\phi : y \to z$ and
$\psi : x \to y$ in $\mathcal{C}^{\text{opp}}$ then
$\phi \circ^{\text{opp}} \psi := \psi \circ \phi$.

\begin{definition}
A {\it contravariant} functor $F\colon
\mathcal{C}\to \mathcal{S}$ is a functor $\mathcal{C}^{\text{opp}}\to
\mathcal{S}$.
\end{definition}

\noindent
Concretely, a contravariant functor $F$ is given
by a map $F : \text{Ob}(\mathcal{C}) \to 
\text{Ob}(\mathcal{S})$ and for ever morphism
$\psi : x \to y$ in $\mathcal{C}$ a morphism
$F(\psi) : F(y) \to F(x)$. These should satisfy the property
that, given another morphism
$\phi : y \to z$, we have $F(\phi \circ \psi)
= F(\psi) \circ F(\phi)$ as morphisms $F(z) \to F(x)$.
(Note the reverse of order.)

\begin{example}
\label{example-hom-functor}
Functor of points.
For any $U\in \text{Ob}(\mathcal{C})$ there is a contravariant
functor 
$$
\begin{matrix}
h_U & : & \mathcal{C} 
&
\longrightarrow
&
\text{Sets} \\
&&
X
&
\longmapsto
&
\text{Mor}_{\mathcal{C}}(X,U) 
\end{matrix}
$$
which takes an object $X$ to the set
$\text{Mor}_{\mathcal{C}}(X,U)$.
Given a morphism $f\colon X\to Y$ the corresponding map
$h_U(f)\colon
\text{Mor}_{\mathcal{C}}(Y,U)\to \text{Mor}_{\mathcal{C}}(X,U)$ takes
$\phi$ to $\phi\circ f$. We will always denote
this functor $h_U : \mathcal{C}^{\text{opp}} \to \text{Sets}$.
If $\mathcal{C}$ is the category of schemes this functor is
sometimes referred to as the
\emph{functor of points} of $U$.
\end{example}

\noindent
Note that given a morphism $\phi : U \to V$ in $\mathcal{C}$ we get a
corresponding natural transformation of functors
$h(\phi) : h_U \to h_V$ defined simply by composing with the morphism
$U \to V$. It is trivial to see that this turns
composition of morphisms in $\mathcal{C}$ into composition of
transformations of functors. In other words we get a functor
$$
h :
\mathcal{C}
\longrightarrow
\text{Fun}(\mathcal{C}^{\text{opp}}, \textit{Sets})
$$
Note that the target is a ``big'' category, see
Remark \ref{remark-big-categories}. On the other hand,
$h$ is an actual mathematical object (i.e.\ a set), compare Remark
\ref{remark-functor-into-sets}.

\begin{lemma}
\label{lemma-yoneda}
Yoneda lemma.
Let $U,V \in \text{Ob}(\mathcal{C})$.
Given any morphism of functors $s : h_U \to h_V$
there is a unique morphism $\phi : U \to V$
such that $h(\phi) = s$. In other words the
functor $h$ is fully faithfull. More generally,
given any contravariant functor $F$ and any object
$U$ of $\mathcal{C}$ we have a natrual bijection
$$
\text{Mor}_{\text{Fun}(\mathcal{C}^{opp}, \textit{Sets})}(h_U, F)
\longrightarrow
F(U),\ 
s \longmapsto s_U(\text{id}_U).
$$
\end{lemma}

\begin{proof}
Just take $\phi = s_U(\text{id}_U) \in \text{Mor}_{\mathcal{C}}(U,V)$.
\end{proof}

\begin{definition}
\label{definition-representable-functor}
A contravariant functor $F : \mathcal{C}\to \text{Sets}$ is said
to be {\it representable} if it is isomorphic to the functor of
points $h_U$ for some object $U$ of $\mathcal{C}$.
\end{definition}

\noindent
Choose an object $U$ of $\mathcal{C}$ and an isomorphism $s : h_U \to F$.
The Yoneda lemma garantees that the pair $(U, s)$ 
is unique up to unique isomorphism. The object
$U$ is called an object {\it representing} $F$.

\section{Fibre products}
\label{section-fibre-products}

\begin{definition}
\label{definition-fibre-products}
Let $x,y,z\in \text{Ob}(\mathcal{C})$,
$f\in \text{Mor}_{\mathcal{C}}(x,y)$
and $g\in \text{Mor}_{\mathcal C}(z,y)$.
A {\it fibre product} of $f$ and $g$ is
an object $x\times_y z\in \text{Ob}(\mathcal{C})$
together with morphisms 
$p\in \text{Mor}_{\mathcal C}(x\times_y z,x)$ and 
$q\in\text{Mor}_{\mathcal C}(x\times_y z,z)$ making the diagram
$$
\xymatrix{
x\times_y z \ar[r]^{q} \ar[d]_{p}
&
z \ar[d]^{g}
\\
x \ar[r]^{f}
&
y
}
$$
commute, and such that the following universal property holds: for
any $w\in \text{Ob}(\mathcal{C})$ and morphisms 
$\alpha \in \text{Mor}_{\mathcal C}(w,x)$ and 
$\beta \in \text{Mor}_{\mathcal{C}}(w,z)$ with
$f \circ \alpha= g\circ \beta$
there is a unique
$\gamma\in \text{Mor}_{\mathcal C}(w,x\times_z y)$ making
the diagram
$$
\xymatrix{
w \ar[rrrd]^\beta \ar@{-->}[rrd]_\gamma \ar[rrdd]_\alpha
&
&
\\
&
&
x\times_y z \ar[d]_{p} \ar[r]_{q}
&
z \ar[d]^{g}
\\
&
&
x \ar[r]^{f}
&
z
}
$$
commute.
\end{definition}

\noindent
If a fibre product exists it is unique up to unique
isomorphism. This follows from the Yoneda lemma as
the definition requires $x\times_yz$ to be an object
of $\mathcal{C}$ such that
$$
h_{x\times_y z}(w) = h_x(w) \times_{h_y(w)} h_z(w)
$$
functorially in $w$. In other words the fibre product $x\times_yz$
is an object representing the functor
$w \mapsto h_x(w) \times_{h_y(w)} h_z(w)$.

\begin{definition}
\label{definition-has-fibre-products}
We say the category $\mathcal{C}$ {\it has fibre products} if
the fibre product exists for any $f\in \text{Mor}_{\mathcal C}(x,z)$
and $g\in \text{Mor}_{\mathcal C}(y,z)$.
\end{definition}

\begin{definition}
\label{definition-representable-morphism}
A morphism $f : x \to y$ of a category $\mathcal{C}$ is said to be
{\it representable}, if and only if for every morphism $z \to y$
in $\mathcal{C}$ the fibre product $z\times_y x$ exists.
\end{definition}

\begin{lemma}
\label{lemma-composition-representable}
Let $\mathcal{C}$ be a category.
Let $f : x \to y$, and $g : y \to z$ be representable.
Then $g \circ f ; x \to z$ is representable.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-base-change-representable}
Let $\mathcal{C}$ be a category.
Let $f : x \to y$ be representable.
Let $y' \to y$ be a morphism of $\mathcal{C}$.
Then the morphism $x' := x \times_y y' \to y'$ is representable also.
\end{lemma}

\begin{proof}
Let $z \to y'$ be a morphism. The fibre product
$x' \times_{y'} z$ is supposed to represent the
functor
\begin{eqnarray*}
w & \mapsto & h_{x'}(w)\times_{h_{y'}(w)} h_z(w) \\
& = & (h_x(w) \times_{h_y(w)} h_{y'}(w)) \times_{h_{y'}(w)} h_z(w) \\
& = & h_n(w) \times_{h_y(w)} h_z(w)
\end{eqnarray*}
which is representable by assumption.
\end{proof}

\section{Examples of fibre products}
\label{section-example-fibre-products}

\noindent
In this section we list examples of fibre products and
we describe them.

\medskip\noindent 
As a really trivial first example we observe 
that the category of sets has fibred products and hence every
morphism is representable. Namely, if $f : X \to Y$
and $g : Z \to Y$ are maps of sets then we define
$X\times_Y Z$ as the subset of $X\times Z$ consisting
of pairs $(x,z)$ such that $f(x) = g(z)$. The morphisms
$p : X\times_Y Z \to X$ and $q : X\times_U Z \to Z$ are
the projection maps $(x,z) \mapsto x$, and $(x,z) \mapsto z$.
Finally, if $\alpha : W \to X$ and $\beta : W \to Z$ 
are morphisms such that $f \circ \alpha = g \circ \beta$
then the map $W \to X\times Y$, $w\mapsto (\alpha(w), \beta(w))$
obviously ends up in $X\times_YZ$ as desired.

\medskip\noindent
In many categories whose objects are sets endowed with certain types of
algebraic structures the fibre product of the underlying sets also
provides the fibre product in the category. For example, suppose
that $X$, $Y$ and $Z$ above are groups and that $f$, $g$ are
homomorphisms of groups. Then the set-theoretic fibre product
$X\times_Y Z$ inherets the structure of a group, simply by
defining the product of two pairs by the formula
$(x,z) \cdot (x',z') = (xx', zz')$. Here we list those categories
for which a similar reasoning works.
\begin{enumerate}
\item The category $\textit{Groups}$ of groups.
\item The category $G\textit{-Sets}$ of sets
endowed with a left $G$-action for some fixed group $G$.
\item The category of rings.
\item The category of $R$-modules given a ring $R$.
\end{enumerate}

\section{Push outs}
\label{section-pushouts}

\noindent
The dual notion to fibre products is that of push outs.

\begin{definition}
\label{definition-pushouts}
Let $x,y,z\in \text{Ob}(\mathcal{C})$,
$f\in \text{Mor}_{\mathcal{C}}(y, x)$
and $g\in \text{Mor}_{\mathcal C}(y, z)$.
A {\it push out} of $f$ and $g$ is
an object $x\amalg_y z\in \text{Ob}(\mathcal{C})$
together with morphisms 
$p\in \text{Mor}_{\mathcal C}(x, x\amalg_y z)$ and 
$q\in\text{Mor}_{\mathcal C}(z, x\amalg_y z)$ making the diagram
$$
\xymatrix{
y \ar[r]^{g} \ar[d]_{f}
&
z \ar[d]^{q}
\\
x \ar[r]^{p}
&
x\amalg_y z
}
$$
commute, and such that the following universal property holds:
For any $w\in \text{Ob}(\mathcal{C})$ and morphisms 
$\alpha \in \text{Mor}_{\mathcal C}(x, w)$ and 
$\beta \in \text{Mor}_{\mathcal{C}}(z, w)$ with
$\alpha \circ f = \beta \circ g$ there is a unique
$\gamma\in \text{Mor}_{\mathcal C}(x\amalg_z y, w)$ making
the diagram
$$
\xymatrix{
y \ar[r]^{g} \ar[d]_{f}
&
z \ar[d]^{q} \ar[rrdd]^\beta
&
&
\\
x \ar[r]^{p} \ar[rrrd]^\alpha
&
x\amalg_y z  \ar@{-->}[rrd]^\gamma
&
&
\\
&&&
w
}
$$
commute.
\end{definition}

\noindent
It is possible and straightforward to prove the uniqueness of the triple
$(x\amalg_y z, p, q)$ up to unique isomorphism (if it exists) by direct
arguments. Another possibility is to think of the coproduct as the
product in the opposite category, thereby getting this uniqueness for
free from the discussion in Section \ref{section-fibre-products}.

\section{Equalizers}
\label{section-equalizers}

\begin{definition}
\label{definition-equalizers}
Suppose that $X$, $Y$ are objects of a category $\mathcal{C}$
and that $a, b : X \to Y$ are morphisms. We say a morphism
$e : Z \to X$ is an {\it equalizer} for the pair $(a,b)$ if
$a \circ e = b \circ e$ and if $(Z,e)$ satisfies the following
universal property: For every morphism $t : W \to X$
in $\mathcal{C}$ such that $a \circ t = b \circ t$ there exists
a unique morphism $s : W \to Z$ such that $t = e \circ s$.
\end{definition}

\noindent
As in the case of the fibre product above, equalizers when
they exist are unique up to unique isomorphsm. There is a
straightforward generalization of this definition to the
case where we have more than $2$ morphisms.

\section{Coequalizers}
\label{section-coequalizers}

\begin{definition}
\label{definition-coequalizers}
Suppose that $X$, $Y$ are objects of a category $\mathcal{C}$
and that $a, b : X \to Y$ are morphisms. We say a morphism
$c : Y \to Z$ is a {\it coequalizer} for the pair $(a,b)$ if
$c \circ a = c \circ b$ and if $(Z,c)$ satisfies the following
universal property: For every morphism $t : Y \to W$
in $\mathcal{C}$ such that $t \circ a = t \circ b$ there exists
a unique morphism $s : Z \to W$ such that $t = s \circ c$.
\end{definition}

\noindent
As in the case of the push outs above, coequalizers when
they exist are unique up to unique isomorphsm, and this follows
from the uniqueness of equalizers upon considering the opposite
category. There is a straightforward generalization of this definition
to the case where we have more than $2$ morphisms.

\section{Initial and final objects}
\label{label-initial-final}

\begin{definition}
\label{definition-initial-final}
Let $\mathcal{C}$ be a category.
\begin{enumerate}
\item An object $x$ of the category $\mathcal{C}$ is called
an {\it initial} object if for every object $y$ of $\mathcal{C}$
there is exactly one morphism $x \to y$.
\item An object $x$ of the category $\mathcal{C}$ is called
a {\it final} object if for every object $y$ of $\mathcal{C}$
there is exactly one morphism $y \to x$.
\end{enumerate}
\end{definition}

\noindent
In the category of sets the empty set $\emptyset$ is an
initial object, and in fact the only initial object.
Also, any {\it singleton}, i.e., a set with one element,
is a final object (so it is not unique).

\section{Limits and colimits}
\label{section-limits}

\noindent
Let $\mathcal{C}$ be a category. A {\it diagram} in $\mathcal{C}$ is
simply a functor $M : \mathcal{I} \to \mathcal{C}$. We say that
$I$ is the {\it index category} or that $M$ is an $\mathcal{I}$-diagram.
We will use the notation $M_i$ to denote the image of the object
$i$ of $\mathcal{I}$. Hence for $\phi : i \to i'$ a morphism
in $\mathcal{I}$ we have $M(\phi) : M_i \to M_{i'}$.

\begin{definition}
\label{definition-limit}
A {\it limit} of the $\mathcal{I}$-diagram $M$ in the category
$\mathcal{C}$ is given by an object $\lim_I M$ in $\mathcal{C}$
together with morphisms $p_i : \lim_I M \to M_i$ such that
\begin{enumerate}
\item for $\phi : i \to i'$ a morphism
in $\mathcal{I}$ we have $p_{i'} =  M(\phi) \circ p_i$, and
\item for any object $W$ in $\mathcal{C}$ and any family of
morphisms $q_i : W \to M_i$ such that for all $\phi : i \to i'$
in $\mathcal{I}$ we have $q_{i'} = M(\phi) \circ q_i$ there 
exists a unique morphism $q : W \to \lim_I M$ such that
$q_i = p_i \circ q$ for every object $i$ of $\mathcal{I}$.
\end{enumerate}
\end{definition}

\noindent
Limits $(\lim_I M, (p_i)_{i\in \text{Ob}(\mathcal{I})})$ are
(if they exist)
unique up to unique isomorphism by the uniqueness requirement
in the definition. Equalizers and fibred products are examples
of limits. The limit over the empty diagram is a final object
of $\mathcal{C}$.
In the category of sets all limits exist.
The dual notion is that of colimits.

\begin{definition}
\label{definition-colimit}
A {\it colimit} of the $\mathcal{I}$-diagram $M$ in the category
$\mathcal{C}$ is given by an object $\text{colim}_I M$ in $\mathcal{C}$
together with morphisms $s_i : M_i \to \text{colim}_I M$ such that
\begin{enumerate}
\item for $\phi : i \to i'$ a morphism
in $\mathcal{I}$ we have $s_{i} = s_{i'} \circ M(\phi)$, and
\item for any object $W$ in $\mathcal{C}$ and any family of
morphisms $t_i : M_i \to W$ such that for all $\phi : i \to i'$
in $\mathcal{I}$ we have $t_{i} = t_{i'} \circ M(\phi)$ there 
exists a unique morphism $t : \text{colim}_I M \to W$ such that
$t_i = t \circ s_i$ for every object $i$ of $\mathcal{I}$.
\end{enumerate}
\end{definition}

\noindent
Push outs and coequalizers are examples of colimits.
The colimit over an empty diagram is an initial object 
of $\mathcal{C}$. In the category of sets all colimits exist.

\begin{remark}
\label{remark-diagram-small}
The index category of a (co)limit will never allowed to have
a proper class of objects. In this project it means that
it cannot be one of the categories listed in
Remark \ref{remark-big-categories}
\end{remark}

\begin{remark}
\label{remark-limit-colim}
We often write $\lim_i M_i$ and $\text{colim}_i M_i$,
of $\lim_{i\in \mathcal{I}} M_i$ and $\text{colim}_{i\in \mathcal{I}} M_i$
instead of the versions indexed by $\mathcal{I}$.
Using this notation, and using the description of
limits and colimits of sets in Section \ref{section-limit-sets}
below, we can say the following. 
Let $\mathcal{I} \to \mathcal{C}$ be a diagram.
\begin{enumerate}
\item The object $\lim_i M_i$ if it
exists satisfies the following property
$$
\text{Mor}_{\mathcal{C}}(W, \lim\nolimits_i M_i)
=
\lim\nolimits_i \text{Mor}_{\mathcal{C}}(W, M_i)
$$
\item The object $\text{colim}_i M_i$ if it
exists satisfies the following property
$$
\text{Mor}_{\mathcal{C}}(\text{colim}_i M_i, W)
=
\lim\nolimits_{i\in \mathcal{I}^\text{opp}} \text{Mor}_{\mathcal{C}}(M_i, W)
$$
Note that this is a limit over the opposite category.
\end{enumerate}
By the Yoneda lemma (and its dual) this formula completely determines the
limit, respectively the colimit.
\end{remark}

\noindent
As an application of the notions of limits and colimits
we define products and coproducts.

\begin{definition}
\label{definition-product}
Suppose that $I$ is a set, and suppose given for every $i \in I$ an
object $M_i$ of the category $\mathcal{C}$. A {\it product}
$\prod_{i\in I} M_i$ is by definition $\lim_{\mathcal{I}} M$ 
(if it exists)
where $\mathcal{I}$ is the category having only identities as
morphisms and having the elements of $I$ as objects.
\end{definition}

\noindent
An important special case is where $I = \emptyset$ in which case the
product is a final object of the category.
The morphisms $p_i : \prod M_i \to M_i$ are called the
{\it projection morphisms}.

\begin{definition}
\label{definition-coproduct}
Suppose that $I$ is a set, and suppose given for every $i \in I$ an
object $M_i$ of the category $\mathcal{C}$. A {\it coproduct}
$\coprod_{i\in I} M_i$ is by definition $\text{colim}_{\mathcal{I}} M$
(if it exists) where $\mathcal{I}$ is the category having only
identities as morphisms and having the elements of $I$ as objects.
\end{definition}

\noindent
An important special case is where $I = \emptyset$ in which case the
product is an initial object of the category.
Note that the coproduct comes equipped with morphisms
$M_i \to \coprod M_i$ (that do not seem to have a good
name in the literature).

\begin{lemma}
\label{lemma-functorial-colimit}
Suppose that $M : \mathcal{I} \to \mathcal{C}$,
and $N : \mathcal{J} \to \mathcal{C}$ are diagrams
whose colimits exist. Suppose that
$H : \mathcal{I} \to \mathcal{J}$ is 
a functor, and suppose that $t : M \to N \circ H$
is a transformation of functors. 
Then there is a unique morphism
$$
\theta :
\text{colim}_{\mathcal{I}} M
\longrightarrow
\text{colim}_{\mathcal{J}} N
$$
such that all the diagrams
$$
\xymatrix{
M_i \ar[d]_{t_{H(i)}} \ar[r]
&
\text{colim}_{\mathcal{I}} M \ar[d]^{\theta}
\\
N_{H(i)} \ar[r]
&
\text{colim}_{\mathcal{I}} N
}
$$
commute.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-functorial-limit}
Suppose that $M : \mathcal{I} \to \mathcal{C}$,
and $N : \mathcal{J} \to \mathcal{C}$ are diagrams
whose limits exist. Suppose that
$H : \mathcal{I} \to \mathcal{J}$ is 
a functor, and suppose that $t : N \circ H \to M$
is a transformation of functors. 
Then there is a unique morphism
$$
\theta :
\text{lim}_{\mathcal{J}} N
\longrightarrow
\text{lim}_{\mathcal{I}} M
$$
such that all the diagrams
$$
\xymatrix{
\text{lim}_{\mathcal{J}} N \ar[d]^{\theta} \ar[r]
&
N_{H(i)} \ar[d]_{t_{H(i)}}
\\
\text{lim}_{\mathcal{I}} M \ar[r]
&
M_i
}
$$
commute.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}


\begin{lemma}
\label{lemma-colimits-commute}
Let $\mathcal{I}$, $\mathcal{J}$ be index categories.
Let $M : \mathcal{I} \times \mathcal{J} \to \mathcal{C}$ be a functor.
We have
$$
\text{colim}_i\ \text{colim}_j\ M_{i,j}
=
\text{colim}_{i,j}\ M_{i,j}
=
\text{colim}_j\ \text{colim}_i\ M_{i,j}
$$
provided all the indicated colimits exist. Similar for limits.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-limits-products-equalizers}
Let $M : \mathcal{I} \to \mathcal{C}$ be a diagram.
Write $I = \text{Ob}(\mathcal{I})$ and $A = \text{Arrow}(\mathcal{I})$.
Denote $s,t : A \to I$ the source and target maps.
Suppose that $\prod_{i \in I} M_i$ and $\prod_{a \in A} M_{t(a)}$
exist. Suppose that the equalizer of 
$$
\xymatrix{
\prod_{i \in I} M_i
\ar@<1ex>[r]^\phi \ar@<-1ex>[r]_\psi
&
\prod_{a \in A} M_{t(a)}
}
$$
exists, where the morphisms are determined by their components
as follows: $p_a \circ \psi = a \circ p_{s(a)}$
and $p_a \circ \phi = p_{t(a)}$. Then this equalizer is the
limit of the diagram.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-finite-limits-exist}
Let $\mathcal{C}$ be a category.
The following are equivalent:
\begin{enumerate}
\item Finite limits exist in $\mathcal{C}$.
\item Finite products and equalizers exist.
\item The category has a final object and fibred products exist.
\end{enumerate}
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-limits-products-equalizers}
above we see that (2) implies (1).
If $a, b : A \to B$ are morphisms of $\mathcal{C}$, then the
equalizer of $a, b$ is
$$
(A \times_{a, B, b} A)\times_{(pr_1, pr_2), A \times A, \Delta} A.
$$
Thus (3) implies (2). And (1) implies (3) because a final object
is an empty limit and a fibre product is a limit as well.
\end{proof}

\begin{lemma}
\label{lemma-colimits-coproducts-coequalizers}
Let $M : \mathcal{I} \to \mathcal{C}$ be a diagram.
Write $I = \text{Ob}(\mathcal{I})$ and $A = \text{Arrow}(\mathcal{I})$.
Denote $s,t : A \to I$ the source and target maps.
Suppose that $\coprod_{i \in I} M_i$ and $\coprod_{a \in A} M_{s(a)}$
exist. Suppose that the coequalizer of 
$$
\xymatrix{
\coprod_{a \in A} M_{s(a)}
\ar@<1ex>[r]^\phi \ar@<-1ex>[r]_\psi
&
\coprod_{i \in I} M_{i}
}
$$
exists, where the morphisms are determined by their components
as follows: The component $M_{s(a)}$ maps via $\psi$
to the component $M_{t(a)}$ via the morphism $a$.
The component $M_{s(a)}$ maps via $\phi$ to the component
$M_{s(a)}$ by the identity morphism. Then this coequalizer is the
colimit of the diagram.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-colimits-exist}
Let $\mathcal{C}$ be a category.
Finite colimits exist in $\mathcal{C}$ if and
only if finite coproducts and coequalizers exist.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}


\begin{lemma}
\label{lemma-limit-final-subcategory}
Let $\mathcal{I}$ be a category.
Let $\mathcal{I}'$ be a subcategory of $\mathcal{I}$, see
Definition \ref{definition-subcategory}.
Assume that
\begin{enumerate}
\item for every $x \in \text{Ob}(\mathcal{I})$
there exists a $x' \in \text{Ob}(\mathcal{I}')$ and
a morphism $x' \to x$ in $\mathcal{I}$,
\item for any $x \in \text{Ob}(\mathcal{I})$,
$x' , x'' \in \text{Ob}(\mathcal{I}')$
and morphisms $x' \to x$, $x'' \to x$ in $\mathcal{I}$
there exists $n \geq 0$ and a commutative diagram
$$
\xymatrix{
x' \ar[r] \ar[rrrd] & x_1 \ar[rrd] & x_2 \ar[rd] \ar[l] \ar[r] & \ldots \ar[r]
& x_{2n - 1} \ar[ld] & x_{2n} \ar[lld] \ar[l] \ar[r] & x'' \ar[llld] \\
& & & x & & & 
}
$$
where all the horizontal morphisms are in $\mathcal{I}'$,
and the vertical arrows in $\mathcal{I}$.
\end{enumerate}
Then for every diagram $M : \mathcal{I} \to \mathcal{C}$
the limit $\text{lim}_\mathcal{I} M$ exists if and only
if $\text{lim}_{\mathcal{I}'} M$ exists and if so these limits
agree.
\end{lemma}

\begin{proof}
Omitted. But see Section \ref{section-limit-sets}
for the type of diagram in the setting of limits of sets.
\end{proof}

\begin{definition}
\label{definition-category-connected}
We say that a category $\mathcal{I}$ is {\it connected}
if the equivalence relation generated by
$x \sim y \Leftrightarrow \text{Mor}_\mathcal{I}(x, y) \not = \emptyset$
has exactly one equivalence class.
\end{definition}

\begin{lemma}
\label{lemma-connected-limit-over-X}
Let $\mathcal{C}$ be a category.
Let $X$ be an object of $\mathcal{C}$.
Let $M : \mathcal{I} \to \mathcal{C}/X$ be a diagram
in the category of objects over $X$.
If the diagram category $\mathcal{I}$ is connected,
then, if the limit of $M$ exists in $\mathcal{C}/X$,
the limit of the composition 
$\mathcal{I} \to \mathcal{C}/X \to \mathcal{C}$
exists and is the same.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}



\section{Limits and colimits in the category of sets}
\label{section-limit-sets}

\noindent
Not only do limits and colimits exist in $\textit{Sets}$
but they are also easy to describe. Namely, let $M : \mathcal{I}
\to \textit{Sets}$, $i \mapsto M_i$ be a diagram of sets.
Denote $I = \text{Ob}(\mathcal{I})$.
The limit is described as
$$
\lim\nolimits_{\mathcal{I}} M
=
\{
(m_i)_{i\in I} \in \prod\nolimits_{i\in I} M_i
\mid
\forall \phi : i \to i' \text{ in }\mathcal{I},\ 
M(\phi)(m_i) = m_{i'}
\}.
$$
On the other hand, the colimit is
$$
\text{colim}_{\mathcal{I}} M
=
(\coprod\nolimits_{i\in I} M_i)/\sim
$$
where the equivalence relation $\sim$ is the equivalence relation
generated by setting $m_i \sim m_{i'}$ if $m_i \in M_i$,
$m_{i'} \in M_{i'}$ and $M(\phi)(m_i) = m_{i'}$ for some
$\phi : i \to i'$. In other words, $m_i \in M_i$
and $m_{i'} \in M_{i'}$ are equivalent if there is a
chain of morphisms in $\mathcal{I}$
$$
\xymatrix{
&
i_1 \ar[ld] \ar[rd]
&
&
i_3 \ar[ld]
&
&
i_{2n-1} \ar[rd]
&
\\
i = i_0 
&
&
i_2
&
&
\ldots
&
&
i_{2n} = i'
}
$$
and elements $m_{i_j} \in M_{i_j}$ mapping to each other under
the maps $M_{i_{2k-1}} \to M_{i_{2k-2}}$ and $M_{i_{2k-1}}
\to M_{i_{2k}}$ induced from the maps in $\mathcal{I}$ above.

\medskip\noindent
This is not a very pleasant type of object to work with.
But there is a type of diagram that allows for a much simpler
description of the colimit.

\begin{definition}
\label{definition-directed}
We say that a diagram $M : \mathcal{I} \to \mathcal{C}$ is {\it directed}
if the following conditions hold:
\begin{enumerate}
\item the category $\mathcal{C}$ has at least one object,
\item for every pair of objects $x, y$ 
there exists an object $z$ and morphisms $x \to z$,
$y \to z$, and
\item for every pair of objects $x, y$ and every pair of
morphisms $a, b : x \to y$ there exists a morphism
$c : y \to z$ such that $M(c \circ a) = M(c \circ b)$.
\end{enumerate}
We say that an index category $\mathcal{I}$ is {\it directed} if
$\text{id} : \mathcal{I} \to \mathcal{I}$ is directed (in other words
you erase the $M$ in part (3) above.)
\end{definition}

\noindent
It is an easy observation that any diagram whose index category is
directed is directed. Now suppose that $M : \mathcal{I} \to
\textit{Sets}$ is a {\it directed} diagram. In this case we may
describe the equivalence relation in the formula
$$
\text{colim}_{\mathcal{I}} M
=
(\coprod\nolimits_{i\in I} M_i)/\sim
$$
simply as follows
$$
m_i \sim m_{i'} 
\Leftrightarrow
\exists i'', \phi : i \to i'', \phi': i' \to i'',\ 
M(\phi)(m_i) = M(\phi')(m_{i'}).
$$

\begin{lemma}
\label{lemma-directed-commutes}
Let $\mathcal{I}$ and $\mathcal{J}$ be index categories,
and assume that $\mathcal{I}$ is directed and $\mathcal{J}$
is finite. Let
$M : \mathcal{J} \times \mathcal{I} \to \textit{Sets}$,
$(i,j) \mapsto M_{i,j}$ be a diagram of diagrams of sets.
In this case
$$
\text{colim}_i\ \text{lim}_j\ M_{i,j} 
=
\text{lim}_j\ \text{colim}_i\ M_{i,j}. 
$$
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
In stead of giving the easy proof we give a counter example to
the case where $\mathcal{J}$ is infinite. Namely, let
$\mathcal{I}$ consist of $\mathbf{N} = \{1,2,3,\ldots\}$
with a unique morphism $i \to i'$ whenever $i \leq i'$.
Let $\mathcal{J}$ consist of the discrete category
$\mathbf{N} = \{1,2,3,\ldots\}$ (only morphisms are identities).
Let $M_{i,j} = \{1,2,\ldots,i\}$ with obvious inclusion maps
$M_{i,j} \to M_{i',j}$ when $i \leq i'$. In this case
$\text{colim}_i M_{i,j} = \mathbf{N}$ and hence
$$
\text{lim}_j\ \text{colim}_i\ M_{i,j}
=
\prod\nolimits_j \mathbf{N}
=
\mathbf{N}^\mathbf{N}
$$
On the other hand $\text{lim}_j M_{i,j} = \prod\nolimits_j M_{i,j}$ and
hence
$$
\text{colim}_i\ \text{lim}_j\ M_{i,j}
=
\bigcup\nolimits_i \{1,2, \ldots, i\}^{\mathbf{N}}
$$
which is smaller than the other limit.

\section{Limits and colimits over partially ordered sets}
\label{section-posets-limits}

\noindent
Let $(I, \geq)$ be a partially ordered set.
Let $\mathcal{C}$ be a category.

\begin{definition}
\label{definition-system-over-poset}
\begin{enumerate}
\item A {\it system over $I$ in $\mathcal{C}$} is given by 
objects $M_i$ of $\mathcal{C}$ and for every $i \leq i'$ a
morphism $f_{ii'} : M_i \to M_{i'}$ such that $f_{ii}
= \text{id}$ and such that $f_{ii''} = f_{i'i''} \circ f_{i i'}$
whenever $i \leq i' \leq i''$.
\item An {\it inverse system over $I$ in $\mathcal{C}$},
sometimes called a {\it projective system over $I$ in $\mathcal{C}$}
is given by objects $M_i$ of $\mathcal{C}$ and for every $i \geq i'$ a
morphism $f_{ii'} : M_i \to M_{i'}$ such that $f_{ii}
= \text{id}$ and such that $f_{ii''} = f_{i'i''} \circ f_{i i'}$
whenever $i \geq i' \geq i''$. (Note reversal of inequalities.)
\end{enumerate}
\end{definition}

\noindent
In other words a system over $I$ is just a diagram $M : \mathcal{I}
\to \mathcal{C}$ where $\mathcal{I}$ is the category with
objects $I$ and a unique arrow $i \to i'$ if and only
$i \leq i'$. The limit (reps.\ colimit) of the system
$(M_i, f_{ii'})$ is just the limit (resp.\ colimit)
of the corresponding diagram. The maps $f_{ii'}$ are sometimes
called the {\it transition maps}.
It is customary to call the system
$(M_i, f_{ii'})$ a {\it directed system} if the partially
ordered set $I$ is {\it directed}: $I$ is nonempty and
for all $i_1,i_2 \in I$ there exists $i\in I$ such that
$i_1 \leq i$ and $i_2 \leq i$.
And in this case the colimit is sometimes (unfortunately)
called the ``direct limit''. We will not use this last
terminology.

\section{Exact functors}
\label{section-exact-functor}

\noindent
A {\it finite} (co)limit is a (co)limit whose diagram category is finite.
(Finitely many objects and finitely many morphisms.)

\begin{definition}
\label{definition-exact}
Let $F : \mathcal{A} \to \mathcal{B}$ be a functor.
\begin{enumerate}
\item Suppose all finite limits exist in $\mathcal{A}$.
We say $F$ is {\it left exact} if it commutes
with all finite limits.
\item Suppose all finite colimits exist in $\mathcal{A}$.
We say $F$ is {\it right exact} if it commutes
with all finite colimits.
\item We say $F$ is {\it exact} if it is both left and right
exact.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-characterize-left-exact}
Let $F : \mathcal{A} \to \mathcal{B}$ be a functor.
Suppose all finite limits exist in $\mathcal{A}$,
see Lemma \ref{lemma-finite-limits-exist}.
The following are equivalent:
\begin{enumerate}
\item $F$ is left exact,
\item $F$ commutes with finite products and equalizers, and
\item $F$ transforms a final object of $\mathcal{A}$
into a final object of $\mathcal{B}$, and commutes with fibre products.
\end{enumerate}
\end{lemma}

\begin{proof}
Lemma \ref{lemma-limits-products-equalizers} shows that (2) implies (1). 
Suppose (3) holds. The fibre product over the final object is the product. 
If $a, b : A \to B$ are morphisms of $\mathcal{A}$, then the
equalizer of $a, b$ is
$$
(A \times_{a, B, b} A)\times_{(pr_1, pr_2), A \times A, \Delta} A.
$$
Thus (3) implies (2). Finally (1) implies (3) because
the empty limit is a final object, and fibre products are limits.
\end{proof}


\section{Adjoint functors}
\label{section-adjoint}

\begin{definition}
\label{definition-adjoint}
Let $\mathcal{C}$, $\mathcal{D}$ be categories.
Let $u : \mathcal{C} \to \mathcal{D}$ and
$v : \mathcal{D} \to \mathcal{C}$ be functors.
We say that $u$ is a {\it left adjoint} of $v$
if there are bijections
$$
\text{Mor}_{\mathcal{D}}(u(X), Y)
\longrightarrow
\text{Mor}_{\mathcal{C}}(X, v(Y))
$$
functorial in $X \in \text{Ob}(\mathcal{C})$, and
$Y \in \text{Ob}(\mathcal{D})$.
\end{definition}

\noindent
In other words, this means that there is an isomorphism
of functors $\mathcal{C}^{\text{opp}} \times \mathcal{D}
\to \textit{Sets}$ from $\text{Mor}_{\mathcal{D}}(u(-), -)$
to $\text{Mor}_{\mathcal{C}}(-, v(-))$.

\begin{lemma}
\label{lemma-adjoint-exact}
Let $u,v$ be adjoint as in Definition \ref{definition-adjoint}.
\begin{enumerate}
\item Suppose that $M : \mathcal{I} \to \mathcal{C}$ is a diagram,
and suppose that $\text{colim}_{\mathcal{I}} M$ exists in
$\mathcal{C}$. Then $u(\text{colim}_{\mathcal{I}} M) =
\text{colim}_{\mathcal{I}} u \circ M$. In other words,
$u$ commutes with (representable) colimits.
\item Suppose that $M : \mathcal{I} \to \mathcal{D}$ is a diagram,
and suppose that $\lim_{\mathcal{I}} M$ exists in
$\mathcal{D}$. Then $v(\lim_{\mathcal{I}} M) =
\lim_{\mathcal{I}} v \circ M$. In other words $v$ commutes
with representable limits.
\end{enumerate}
\end{lemma}

\begin{proof}
A morphism from a colimit into an object is the same as a compatible
system of morphisms from the constitutents of the limit into the
object, see Remark \ref{remark-limit-colim}. So
$$
\begin{matrix}
\text{Mor}_{\mathcal{D}}(u(\text{colim}_{i \in \mathcal{I}} M_i), Y)
&
=
&
\text{Mor}_{\mathcal{C}}(\text{colim}_{i \in \mathcal{I}} M_i, v(Y))
\\
&
=
&
\lim_{i \in \mathcal{I}^{\text{opp}}} \text{Mor}_{\mathcal{C}}(M_i, v(Y))
\\
&
=
&
\lim_{i \in \mathcal{I}^{\text{opp}}} \text{Mor}_{\mathcal{D}}(u(M_i), Y)
\end{matrix}
$$
proves that $u(\text{colim}_{i \in \mathcal{I}} M_i)$ is
the colimit we are looking for.
A similar argument works for the other statement.
\end{proof}

\begin{lemma}
\label{lemma-exact-adjoint}
Let $u,v$ be adjoint as in Definition \ref{definition-adjoint}.
\begin{enumerate}
\item If $\mathcal{C}$ has finite colimits, then $u$ is right exact.
\item If $\mathcal{D}$ has finite limits, then $v$ is left exact.
\end{enumerate}
\end{lemma}

\begin{proof}
Obvious from the defintions and Lemma \ref{lemma-adjoint-exact}.
\end{proof}


\section{Monomorphisms and Epimorphisms}
\label{section-mono-epi}

\begin{definition}
\label{definition-mono-epi}
Let $\mathcal{C}$ be a category, and let $f : X \to Y$ be
a morphism of $\mathcal{C}$.
\begin{enumerate}
\item We say that $f$ is a {\it monomorphism} if for every object
$W$ and every pair of morphisms $a, b : W \to X$ such that
$f \circ a = f \circ b$ we have $a = b$.
\item We say that $f$ is an {\it epimorphism} if for every object
$W$ and every pair of morphisms $a, b : Y \to W$ such that
$a \circ f = b \circ f$ we have $a = b$.
\end{enumerate}
\end{definition}

\begin{example}
\label{example-mono-epi-sets}
In the category of sets the monomorphisms correspond to injective
maps and the epimorphisms correspond to surjective maps.
\end{example}



\section{Formal properties}
\label{section-formal-cat-cat}

\noindent
In this section we discuss some formal properties of the
$2$-category of categories. This will lead us to the definition
of a (strict) $2$-category later.

\medskip\noindent
Let us denote $\text{Ob}(\textit{Cat})$ the class of all categories.
For every pair of categories
$\mathcal{A}, \mathcal{B} \in \text{Ob}(\textit{Cat})$
we have the category of functors
$$
\text{Fun}(\mathcal{A}, \mathcal{B})
$$
Composition of transformation of functors 
such as
$$
\xymatrixcolsep{5pc}
\xymatrix{
\mathcal{A}
\ruppertwocell^F{t}
\ar[r]_(.3){F'}
\rlowertwocell_{F''}{t'}
&
\mathcal{B}
}
\text{ composes to }
\xymatrix{
\mathcal{A}
\rtwocell^F_{F''}{\ \ t \circ t'}
&
\mathcal{B}
}
$$
is called {\it vertical} composition. We will use the usual
symbol $\circ$ for this. Next, we will define {\it horizontal}
composition. In order to do this we explain a bit more 
of the structure at hand.

\medskip\noindent
Namely for every triple
of categories $\mathcal{A}$, $\mathcal{B}$, and $\mathcal{C}$
there is a composition law
$$
\circ : \text{Ob}(\text{Fun}(\mathcal{B}, \mathcal{C}))
\times 
\text{Ob}(\text{Fun}(\mathcal{A}, \mathcal{B}))
\longrightarrow
\text{Ob}(\text{Fun}(\mathcal{A}, \mathcal{C}))
$$
coming from composition of functors. This composition law
is associative, and identity functors act as units. In other
words -- forgetting about transformations of functors --
we see that $\textit{Cat}$ forms a category. How does
this structure interact with the morphisms between functors?

\medskip\noindent
Well, given $t : F \to F'$ a transformation of
functors $F, F' : \mathcal{A} \to \mathcal{B}$ and
a functor
$G : \mathcal{B} \to \mathcal{C}$ we can define
a transformation of functors
$G\circ F \to G \circ F'$. We will denote this
transformation ${}_Gt$. It is given by the formula
${}_Gt_x = G(t_x) : G(F(x)) \to G(F'(x))$
for all $x \in \mathcal{A}$. 
In this way composition
with $G$ becomes a functor
$$
\text{Fun}(\mathcal{A}, \mathcal{B})
\longrightarrow
\text{Fun}(\mathcal{A}, \mathcal{C}).
$$
To see this you just have to check that
${}_G(\text{id}_F) = \text{id}_{G \circ F}$ and that
${}_G(t_1 \circ t_2) = {}_Gt_1 \circ {}_Gt_2$.
Of course we also have that ${}_{\text{id}_{\mathcal{A}}}t = t$.

\medskip\noindent
Similarly, given $s : G \to G'$ a transformation of
functors $G, G' : \mathcal{B} \to \mathcal{C}$ and
$F : \mathcal{A} \to \mathcal{B}$ a functor we can define
$s_F$ to be the transformation of functors
$G\circ F \to G' \circ F$ given by
$(s_F)_x = s_{F(x)} : G(F(x)) \to G'(F(x))$
for all $x \in \mathcal{A}$. In this way
composition with $F$ becomes a functor
$$
\text{Fun}(\mathcal{B}, \mathcal{C})
\longrightarrow
\text{Fun}(\mathcal{A}, \mathcal{C}).
$$
To see this you just have to check that
$(\text{id}_G)_F = \text{id}_{G\circ F}$ and that
$(s_1 \circ s_2)_F = s_{1,F} \circ s_{2,F}$.
Of course we also have that $s_{\text{id}_{\mathcal{B}}} = s$.

\medskip\noindent
These constructions satisfy the additional properties
$$
{}_{G_1}({}_{G_2}t) = {}_{G_1\circ G_2}t,\ 
(s_{F_1})_{F_2} = s_{F_1 \circ F_2}, \text{ and }
{}_H(s_F) = ({}_Hs)_F
$$
whenever these make sense.
Finally, given functors $F, F' : \mathcal{A} \to \mathcal{B}$,
and $G, G' : \mathcal{B} \to \mathcal{C}$ and transformations
$t : F \to F'$, and $s : G \to G'$ the following
diagram is commutative
$$
\xymatrix{
G \circ F \ar[r]^{{}_Gt} \ar[d]_{s_F}
&
G \circ F' \ar[d]^{s_{F'}} \\
G' \circ F \ar[r]_{{}_{G'}t}
&
G' \circ F'
}
$$
in other words ${}_{G'}t \circ s_F =  s_{F'}\circ {}_Gt$.
To prove this we just consider what happens on
any object $x \in \text{Ob}(\mathcal{A})$:
$$
\xymatrix{
G(F(x)) \ar[r]^{G(t_{x})} \ar[d]_{s_{F(x)}}
&
G(F'(x)) \ar[d]^{s_{F'(x)}} \\
G'(F(x)) \ar[r]_{G'(t_{x})}
&
G'(F'(x))
}
$$
which is commutative because $s$ is a transformation
of functors. This compatibility relation allows us
to define horizontal composition.

\begin{definition}
\label{definition-horizontal-composition}
Given a diagram as in the left hand side of:
$$
\xymatrixcolsep{4pc}
\xymatrix{
\mathcal{A}
\rtwocell^F_{F'}{t}
&
\mathcal{B}
\rtwocell^G_{G'}{s}
&
\mathcal{C}
} 
\text{ gives }
\xymatrix{
\mathcal{A}
\rtwocell^{G \circ F} _{G' \circ F'}{\ \ t \star s}
&
\mathcal{C}
}
$$
we define the {\it horizontal} composition $t \star s$ to be the
transformation of functors ${}_{G'}t \circ s_F =  s_{F'}\circ {}_Gt$.
\end{definition}

\noindent
Now we see that we may recover our previously constructed
transformations ${}_Gt$ and $s_F$ as
$ {}_Gt = \text{id}_G \star t $ and $ s_F = s \star \text{id}_F $.
Furthermore, all of the rules we found above are consequences of
the properties stated in the lemma that follows.

\begin{lemma}
\label{lemma-properties-2-cat-cats}
The horizontal and vertical compositions have the following
properties
\begin{enumerate}
\item $\circ$ and $\star$ are associative,
\item the identity transformations $\text{id}_F$ 
are units for $\circ$,
\item the identity transformations of the identity functors
$\text{id}_{\text{id}_{\mathcal{A}}}$
are units for $\star$ and $\circ$, and
\item given a diagram
$$
\xymatrixcolsep{5pc}
\xymatrix{
\mathcal{A}
\ruppertwocell^F{t}
\ar[r]_(.3){F'}
\rlowertwocell_{F''}{t'}
&
\mathcal{B}
\ruppertwocell^G{s}
\ar[r]_(.3){G'}
\rlowertwocell_{G''}{s'}
&
\mathcal{C}
}
$$
we have $ (t' \circ t) \star (s' \circ s) = (t' \star s') \circ
(s' \star s)$.
\end{enumerate}
\end{lemma}

\begin{proof}
The last statement turns using our previous notation into the following
equation
$$
s'_{F''}
\circ
{}_{G'}t' 
\circ
s_{F'}
\circ
{}_Gt 
=
(s' \circ s)_{F''}
\circ
{}_G(t' \circ t).
$$
According to our result above applied to the middle composition
we may rewrite the left hand side as
$
s'_{F''}
\circ
s_{F''} 
\circ
{}_Gt'
\circ
{}_Gt 
$
which is easily shown to be equal to the right hand side.
\end{proof}

\noindent
Another way of formulating condition (4) of the lemma is
that composition of functors and horzinontal composition
of transformation of functors gives rise to a functor
$$
(\circ, \star) :
\text{Fun}(\mathcal{B}, \mathcal{C})
\times 
\text{Fun}(\mathcal{A}, \mathcal{B})
\longrightarrow
\text{Fun}(\mathcal{A}, \mathcal{C})
$$
whose source is the product category,
see Definition \ref{definition-product-category}.

\section{2-categories}
\label{section-2-categories}

\noindent
We will give a definition of (strict) $2$-categories as they appear
in the setting of stacks. Before you read this take a look at
Section \ref{section-formal-cat-cat} and Example
\ref{example-2-1-category-of-categories}. Basically, you take this example
and you write out all the rules satisfied by the objects, $1$-morphisms
and $2$-morphisms in that example.

\begin{definition}
\label{definition-2-category}
A {\it (strict) $2$-category} $\mathcal{C}$ consists of the following data
\begin{enumerate}
\item A set of objects $\text{Ob}(\mathcal{C})$.
\item For each pair $x,y \in \text{Ob}(\mathcal{C})$
a category $\text{Mor}_\mathcal{C}(x,y)$. The objects of
$\text{Mor}_\mathcal{C}(x,y)$ will be called {\it $1$-morphisms}
and denoted $F : x \to y$. The morphisms between these $1$-morphisms
will be called {\it $2$-morphisms} and denoted $t : F' \to F$.
The composition of $2$-morphisms in $\text{Mor}_\mathcal{C}(x,y)$
will be called {\it vertical} composition and will be
denoted $t \circ t'$ for $t : F' \to F$ and $t' : F'' \to F'$.
\item For each triple $x,y,z\in \text{Ob}(\mathcal{C})$ a
functor
$$
(\circ, \star) : 
\text{Mor}_\mathcal{C}(y,z) \times \text{Mor}_\mathcal{C}(x,y) 
\longrightarrow
\text{Mor}_\mathcal{C}(x,z).
$$
The image of the pair of $1$-morphisms $(F,G)$ on the left hand side
will be called the {\it composition} of $F$ and $G$, and denoted
$F\circ G$. The image of the pair of $2$-morphisms $(t,s)$ will
be called the {\it horizontal} composition and denoted $t \star s$.
\end{enumerate}
These data are to satisfy the following rules:
\begin{enumerate}
\item The set of objects together with the set of $1$-morphisms endowed
with composition of $1$-morphisms forms a category.
\item Horizontal composition of $2$-morphisms is associative.
\item The identity $2$-morphism $\text{id}_{\text{id}_x}$
of the identity $1$-morphism $\text{id}_x$ is a unit for
horizontal composition.
\end{enumerate}
\end{definition}

\noindent
This is obviously not a very pleasant type of object to work with.
On the other hand, there are lots of examples where it is quite clear
how you work with it. The only example we have sofar is that of
the $2$-category whose objects are a given collection of categories,
$1$-morphisms are functors between these categories,
and $2$-morphisms are natural transformations of functors, see
Section \ref{section-formal-cat-cat}.
As far as this text is concerned
all $2$-categories occuring in this document are sub $2$-categories
of this example. Some $2$-categories have the property that all $2$-morphisms
are isomorphisms. These will play an important role in the following,
and they are easier to work with.

\begin{definition}
\label{definition-2-1-category}
A {\it (strict) $(2,1)$-category} is a $2$-category in which all
$2$-morphisms are isomorphisms.
\end{definition}

\begin{example}
\label{example-2-1-category-of-categories}
The $2$-category $\textit{Cat}$,
see Remark \ref{remark-big-2-categories}, can be turned into a
$(2,1)$-category by only allowing isomorphisms of functors
as $2$-morphisms. In fact, more generally any $2$-category
can be turned into a $(2,1)$-category by restricting
the $2$-morphisms to all be isomorphisms. We will use the turn of phrase
``the $(2,1)$-category of XYZ'' to mean the $(2,1)$-category
so obtained from the $2$-category of XYZ. For example,
the $(2,1)$-category of groupoids means the
$2$-category whose objects are groupoids, whose
$1$-morphisms are functors and whose $2$-morphisms are
isomorphisms of functors.
\end{example}

\noindent
The notion of equivalence of categories that we defined in Section
\ref{section-definition-categories} extends to the more general setting of
$2$-categories as follows.

\begin{definition}
\label{definition-equivalence}
Two objects $x,y$ of a $2$-category are {\it equivalent} if there exist 
$1$-morphisms $F : x \to y$ and $G : y \to x$ such that $F \circ G$ is 
$2$-isomorphic to $\text{id}_y$ and $G \circ F$ is $2$-isomorphic to 
$\text{id}_x$.
\end{definition}

\begin{remark} 
\label{remark-big-2-categories}
Big $2$-categories.
In many texts a $2$-category is allowed to have a class of
objects (but hopefully a ``class of classes'' is not allowed).
We will allow these ``big'' $2$-categories as well, but only
in the following list of cases (to be updated as we go along):
\begin{enumerate}
\item The $2$-category of categories $\textit{Cat}$.
\item The $(2,1)$-category of categories $\textit{Cat}$.
\item The $2$-category of groupoids $\textit{Groupoids}$.
\item The $(2,1)$-category of groupoids $\textit{Groupoids}$.
\item The $2$-category of fibred categories over a fixed category.
\item The $(2,1)$-category of fibred categories over a fixed category.
\end{enumerate}
Note that in each case the class of objects of the $2$-category
$\mathcal{C}$ is a proper case, but for all objects $x,y \in \text{Ob}(C)$
the category $\text{Mor}_{\mathcal{C}}(x, y)$ is ``small''.
\end{remark}

\begin{remark}
\label{remark-other-2-categories}
There are variants of the construction of
\ref{example-2-1-category-of-categories} above
where we look at the $2$-category of groupoids,
or categories fibred in groupoids over a fixed
category, or stacks. And so on.
\end{remark}

\begin{remarks}
\label{remarks-functor-into-2-category}
(1) A functor from an ordinary category into a $2$-category will ignore the
$2$-morphisms unless mentioned otherwise. In other words, it will be a 
``usual'' functor into the category formed out of 2-category by forgetting
all the 2-morphisms.

\medskip\noindent
(2) Another notion of a functor from a category $\mathcal{A}$ into a
2-category $\mathcal{C}$ would be to say that it is given by a map
$F : \text{Ob}(\mathcal{A}) \to \text{Ob}(\mathcal{C})$ together with a
family of maps 
$F : \text{Mor}_{\mathcal{A}}(x,y) \to \text{Mor}_{\mathcal{C}}(F(x),F(y))$
such that for every composable pair of morphisms $f,g$ of $\mathcal{A}$
the morphisms $F(g \circ f)$ and $F(g) \circ F(f)$ are 2-isomorphic. This is
not a very good notion, since for example it does not require $F(\text{id}_x)$
to be isomorphic to $\text{id}_{F(x)}$. Even if you do then
there may be a problem: see the conditions in (3) below.

\medskip\noindent
(3) A better notion is the following. A weak functor (or a pseudo-functor)
from a category $\mathcal{A}$ into a 2-category $\mathcal{C}$ is given by 
\begin{enumerate}
\item a map $F : \text{Ob}(\mathcal{A}) \to \text{Ob}(\mathcal{C})$,
\item for every pair $x,y\in \text{Ob}(\mathcal{A})$ a map
$F : \text{Mor}_{\mathcal{A}}(x,y) \to  \text{Mor}_{\mathcal{C}}(F(x),F(y))$,
\item for every $x\in \text{ob}(C)$ a $2$-morphism
$\alpha_x : \text{id}_x \to F(\text{id}_{x})$, and
\item for every pair of composable morphisms $f,g$ of $\mathcal{A}$ a 
$2$-morphism $\alpha_{f,g} : F(g \circ f) \to F(g) \circ F(f)$.
\end{enumerate}
Now these data are subject to the following conditions:
(with notations as in Definition \ref{definition-2-category})
\begin{enumerate}
\item for any morphism $f : x \to y$ in $\mathcal{A}$ the morphism
$\alpha_{f,\text{id}_y} : F(f) \to F(f) \circ F(\text{id}_y)$
equals the composition of $F(f) \circ \text{id}_{F(y)} = F(f)$ with
$F(f)(\alpha_y)$, and similary for $\alpha_{\text{id}_x,f}$ and
$\alpha_x$, and
\item for any triple of composable morphisms $f,g,h$ the
compositions $F(h)(\alpha_{f,g}) \circ \alpha_{g\circ f, h}$ and
$F(f)(\alpha_{g,h}) \circ \alpha_{g,f\circ h}$ should be equal.
\end{enumerate}
Again this is not a very workable notion, but it does sometimes come up.
There is a theorem that says that any pseudo-functor is isomorphic to
a functor. FIXME: Add more as needed.
\end{remarks}

\section{2-fibre products}
\label{section-2-fibre-products}

\noindent
In this section we introduce $2$-fibre products. Suppose that $\mathcal{C}$
is a 2-category. We say that a diagram
$$
\xymatrix{
w \ar[r] \ar[d] & y \ar[d] \\
x \ar[r] & z }
$$
2-commutes if the two 1-morphisms $w \to y \to z$ and $w \to x \to z$ are
2-isomorphic. In a 2-category it is more natural to ask for 2-commutativity 
of diagrams than for actually commuting diagrams. (Indeed, some may say that
we should not work with strict 2-categories at all, and in a ``weak''
2-category the notion of a commutative diagram of 1-morphisms does not even
make sense.) Correspondingly the notion of a fibre product has to be adjusted.

\medskip\noindent
Let $\mathcal{C}$ be a $2$-category. Let $x,y,z\in \text{Ob}(\mathcal{C})$ and
$f\in \text{Mor}_{\mathcal{C}}(x,z)$ and $g\in \text{Mor}_{\mathcal C}(y,z)$.
In order to define the 2-fibre product of $f$ and $g$ we are going to look at
2-commutative diagrams
$$
\xymatrix{
&w \ar[r]^{a} \ar[d]_{b} & x \ar[d]^{f} \\
&y \ar[r]^{g} & z. }
$$
Now in the case of categories, the fibre product is a final object in the
category of such diagrams. Correspondingly a 2-fibre product is a final object
in a 2-category (see definition below). The 2-category we will consider is
the 2-category of 2-commutative diagrams defined as follows:
\begin{enumerate}
\item Objects are quadruples $(w,a,b,\phi)$ as above where $\phi$
is a 2-morphism $\phi : f \circ a \to g \circ b$, 
\item 1-morphisms from $(w,a,b,\phi)$ to $(w',a',b',\phi')$
are given by $(k : w \to w', \alpha : a' \to a \circ k,
\beta : b \circ k \to b')$ such that $\phi'$ equals 
$$
\xymatrix{
f \circ a' \ar[r]^{f(\alpha)} &
f \circ a \circ k \ar[r]^{k(\phi)} &
g \circ b \circ k \ar[r]^{g(\beta)} &
g \circ b'. }
$$
\item a 2-morphism between $(k_i, \alpha_i, \beta_i)$, $i=1,2$ is given
by a 2-morphism $\delta : k_1 \to k_2$ such that 
$$
\xymatrix{
a' \ar[rd]_{\alpha_2} \ar[r]^{\alpha_1} & 
a \circ k_1 \ar[d]^{a(\delta)} &
&
b \circ k_1 \ar[r]^{\beta_1} \ar[d]_{b(\delta)} &
b'
\\
&
a \circ k_2 &
&
b \circ k_2 \ar[ru]_{\beta_2}
&
}
$$
commute.
\end{enumerate}

\begin{definition}
\label{definition-final-object-2-category}
A final object of a 2-category $\mathcal{C}$ is an object $x$ such that
(1) for every $y \in \text{Ob}(\mathcal{C})$ there is a morphism $y \to x$,
and (2) every two morphisms $y \to x$ are isomorphic by a unique 2-morphism.
\end{definition}

\begin{definition}
\label{definition-2-fibre-products}
Let $\mathcal{C}$ be a $2$-category.
Let $x,y,z\in \text{Ob}(\mathcal{C})$ and $f\in \text{Mor}_{\mathcal{C}}(x,z)$
and $g\in \text{Mor}_{\mathcal C}(y,z)$. A 2-fibre product of $f$ and $g$ is
a final object in the category of 2-commutative diagrams described above. If
a 2-fibre product exists we
will denote it $x\times_z y\in \text{Ob}(\mathcal{C})$, and denote the
required morphisms $p\in \text{Mor}_{\mathcal C}(x\times_z y,x)$ and 
$q\in \text{Mor}_{\mathcal C}(x\times_z y,y)$ making the diagram
$$
\xymatrix{
&x\times_y z \ar[r]^{p} \ar[d]_{q} & x \ar[d]^{f} \\
&y \ar[r]^{g} & z }
$$
2-commute and we will denote the given 2-morphism exhibiting this by
$\psi : f \circ p \to g \circ q$.
\end{definition}

\noindent
Thus the following universal property holds: for any
$w\in \text{Ob}(\mathcal{C})$ and morphisms 
$a \in \text{Mor}_{\mathcal C}(w,x)$ and 
$b \in \text{Mor}_{\mathcal{C}}(w,y)$ with a given 2-morphism
$\phi : f \circ a \to g\circ b$
there is a $\gamma \in \text{Mor}_{\mathcal C}(w,x\times_z y)$
making the diagram
$$
\xymatrix{
w\ar[rrrd]^a \ar@{-->}[rrd]_\gamma \ar[rrdd]_b &&\\
&&x\times_y z \ar[r]_{p} \ar[d]_{q} & x \ar[d]^{f} \\
&&y \ar[r]^{g} & z }
$$
2-commute such that for suitable choices of $q \circ \gamma \to b$
and $a \to p \circ \gamma$ the composition
$$
\xymatrix{
f \circ a \ar[r] &
f \circ p \circ \gamma \ar[r]^{\gamma(\psi)} &
g \circ q \circ \gamma \ar[r] &
g\circ b }
$$
equals $\phi$. Of course the exact properties are finer than this. All of the
cases of 2-fibre products that we will need later on come from the following
example of 2-fibre products in the 2-category of categories.

\begin{example}
\label{example-2-fibre-product-categories}
In this example we switch notations and we let $\mathcal{A}$, $\mathcal{B}$,
and $\mathcal{C}$ be categories and we let $F : \mathcal{A} \to \mathcal{C}$
and $G : \mathcal{B} \to \mathcal{C}$ be functors. In this case the 2-fibre
product $\mathcal{A}\times_\mathcal{C} \mathcal{B}$ exists and is given by
the following:
\begin{enumerate}
\item an object of $\mathcal{A}\times_\mathcal{C} \mathcal{B}$ is a triple
$(A,B,f)$, where $A\in \text{Ob}(\mathcal{A})$, $B\in \text{Ob}(\mathcal{B})$,
and $f : F(A) \to G(B)$ is an isomorphism in $\mathcal{C}$,
\item a morphism $(A,B,f) \to (A',B', f')$ is given by a pair $(a,b)$, where
$a : A \to A'$ is a morphism in $\mathcal{A}$, and $b : B \to B'$ is a
morphism in $\mathcal{B}$ such that the diagram 
$$
\xymatrix{
F(A) \ar[r]^f \ar[d]^{F(a)} & G(B) \ar[d]^{G(b)} \\
F(A') \ar[r]^{f'} & G(B')
}
$$
is commutative.
\end{enumerate}
The functors $p : \mathcal{A}\times_\mathcal{C}\mathcal{B} \to \mathcal{A}$
and $q : \mathcal{A}\times_\mathcal{C}\mathcal{B} \to \mathcal{B}$ are the
forgetfull functors in this case. The transformation $\psi : F \circ p \to
G \circ q$ is given on the object $\xi = (A,B,f)$ by
$\psi_\xi = f : F(p(\xi)) = F(A) \to G(B) = G(q(\xi))$.

\medskip\noindent
Let us check the universal property: let $\mathcal{W}$ be a category, let
$X : \mathcal{W} \to \mathcal{A}$ and $Y : \mathcal{W} \to \mathcal{B}$ be
functors, and let $t : F \circ X \to G \circ Y$ be an isomorphism of functors.
The desired functor $\gamma : \mathcal{W} \to
\mathcal{A}\times_\mathcal{C}\mathcal{B}$
is given by $W \mapsto (X(W), Y(W), t_W)$. What else could it be? 
(A meta-argument for uniqueness.) FIXME: write this out.

\medskip\noindent
Note that the functor $\gamma$ constructed above actually has the property
that $p \circ \gamma = X$ and $q \circ \gamma = Y$. In general this need not
be the case.
\end{example}

\section{Categories fibred in groupoids}
\label{section-fibred-groupoids}

\noindent
In this section we explain how to think about categories in groupoids
and we see how they are basically the same as functors in groupoids.

\medskip\noindent
In this section we have a functor $p : \mathcal{S} \to \mathcal{C}$.
We think of $\mathcal{S}$ as being on top and of $\mathcal{C}$ as being
at the bottom.

\medskip\noindent
Analogously to the fibre of a map of spaces, we have the notion of a 
fibre category. The fibre category over an object 
$U\in \text{Ob}(\mathcal{C})$ is the category $\mathcal{S}_U$ with 
objects
$$
\text{Ob}(\mathcal{S}_U) = \{x\in \text{Ob}(\mathcal{S}) :
p(x)=U\}
$$
and morphisms 
$$
\text{Mor}_{\mathcal{S}_U}(x,y) = \{ \phi \in \text{Mor}_\mathcal{S}(x,y) :
p(\phi) = \text{id}_U\}.
$$

\medskip\noindent
In order to discuss the notion of ``category fibred in groupoids'' we
temporarily introduce the notion of lifting.
A {\it lift} of an object $U \in \text{Ob}(\mathcal{C})$ is an object 
$x\in \text{Ob}(\mathcal{S})$ such that $p(x)=U$, i.e., 
$x\in \text{Ob}(\mathcal{S}_U)$.  
Similarly, a {\it lift} of a morphism $f : V \to U$ in $\mathcal{C}$ is a 
morphism $\phi : y \to x$ in $\mathcal{S}$ such that $p(\phi)=f$.

\begin{definition}
\label{definition-fibred-groupoids}
We say that $\mathcal{S}$ is fibred in groupoids over $\mathcal{C}$ if
the following two conditions hold:
\begin{enumerate}
\item For every morphism $f : V \to U$ in $\mathcal{C}$ and every
lift $x$ of $U$ there is a lift $\phi : y \to x$ of $f$ with
target $x$.
\item For every pair of morphisms $ \phi : y \to x$ and $ \psi : z \to x$
and any morphism $ f : p(z) \to p(y)$ such that $ p(\phi) \circ f = 
p(\psi)$ there exists a unique lift $ \chi : z \to y$ of $f$ such that
$\phi \circ \chi = \psi$.
\end{enumerate}
\end{definition}

\noindent
Condition (2) phrased differently says that 
applying the functor $p$ gives a bijection between the sets 
of dotted arrows in the following commutative diagram below:
$$
\xymatrix{
y \ar[r] & x & p(y) \ar[r] & p(x) \\
z \ar@{-->}[u] \ar[ru] & & p(z) \ar@{-->}[u]\ar[ru] & \\
}
$$

\medskip\noindent
Another way to think about the second condition is the following.
Suppose that $g : W \to V$ and $f : V \to U$ are morphisms in $\mathcal{C}$. 
Let $x \in \text{Ob}(\mathcal{S}_U)$. By the first condition we can lift
$f$ to $ \phi : y \to x$ and then we can lift $g$ to $\psi : z \to y$.
Instead of doing this two step process we can directly lift $g \circ f$ to
$\gamma : z' \to x$. This gives the solid arrows in the diagram below.
$$
\xymatrix{
z' \ar@{-->}[d]\ar[rrd]^\gamma & & \\
z \ar@{-->}[u]\ar[r]^\psi & y \ar[r]^\phi & x \\
W \ar[r]^g & V \ar[r]^f & U \\
}
$$
Applying the second condition to the arrows $\phi \circ \phi$, $\gamma$
and $\text{id}_W$ we conclude that there is a unique morphism 
$\chi : z \to z'$ in $\mathcal{S}_W$ such that 
$\gamma \circ \chi = \phi \circ \psi$. Similarly there is a unique morphism
$z' \to z$. The uniqueness implies that the morphisms $z' \to z$ and
$z\to z'$ are mutually inverse, in other words isomorphisms.

\begin{example}
\label{example-group-homomorphism-fibreedingroupoids}
A homomorphism of groups $p : G \to H$ gives rise to a functor 
$p\colon \mathcal{S}\to\mathcal{C}$ as in Example 
\ref{example-group-homorphism-functor}. This functor
$p\colon \mathcal{S}\to\mathcal{C}$ is fibred in groupoids if and only if 
$p$ is surjective.  The fibre category $\mathcal{S}_{U}$ over the (unique)
object $U\in \text{Ob}(\mathcal{C})$ is the category associated to the
kernel of $p$ as in Example \ref{example-group-groupoid}.
\end{example}

\noindent
Suppose that for every $f : V \to U$ and $x\in \text{Ob}(\mathcal{S}_U)$
as in the first condition we choose a lift
$f^\ast x \to x$ of $f$; this is possible by the axiom of choice. For
every morphism $\phi : x \to x'$ in $\mathcal{S}_U$ there is a unique
morphism $f^\ast \phi : f^\ast x \to f^\ast x'$ in $\mathcal{S}_V$
such that
$$
\xymatrix{
f^\ast x \ar[r]^{f^\ast \phi} \ar[d] & f^\ast x' \ar[d] \\
x \ar[r]^{\phi} & x' }
$$
commutes. Again uniqueness of this arrow guarantees that $f^\ast$ is a
functor $ f^\ast : \mathcal{S}_U \to \mathcal{S}_V$. 

\begin{lemma}
\label{lemma-fibred-groupoids}
If $p : \mathcal{S} \to \mathcal{C}$ is a category fibred in groupoids then
all fibre categories are groupoids. Choose functors $f^\ast$ as above.
Then for any pair of composable
morphisms $f : V \to U$, $g : U\to W$ there is a unique isomorphism of 
functors $\mathcal{S}_W \to \mathcal{S}_V$ 
$$
t : g^\ast f^\ast \to (g \circ f)^\ast 
$$ 
such that for every $y\in \text{Ob}(\mathcal{S}_W)$ the following
diagram commutes
\begin{equation}
\xymatrix{
f^\ast g^\ast y \ar[r] \ar[d]_{t_y} & g^\ast y \ar[d] \\
(f\circ g)^\ast y \ar[r] & y
}\label{eq:lemma-fibred-groupoids-commutes}
\end{equation}
\end{lemma}

\begin{proof} 
To show all fibre categories $\mathcal{S}_U$ for $U \in \text{Ob}(\mathcal{C})$
are groupoids, we must exhibit for every $f : y \to x$ in $\mathcal{S}_U$ an
inverse morphism.  The diagram on the left (in $\mathcal{S}_U$) is mapped by
$p$ to the diagram on the right:
$$
\xymatrix{
y \ar[r]^f & x & U \ar[r]^{id_U} & U \\
x \ar@{-->}[u] \ar[ru]_{id_x} & & U \ar@{-->}[u]\ar[ru]_{id_U} & \\
}
$$
Since only $id_U$ makes the diagram on the right commute, there is a unique
$g : x \to y$ making the diagram on the left commute, so $fg = id_x$.  By a
similar argument there is a unique $h : y \to x$ so that $gh = id_y$.  Then
$fgh = f : y \to x$.  We have $fg = id_x$, so $h=f$.

\medskip\noindent
Now let $y\in \text{Ob}(\mathcal S_W)$ and consider the diagram
\begin{equation}\label{eq:lemma-fibred-groupoids-commutes2}
\xymatrix{
f^\ast g^\ast y \ar@{-->}[d]_{t_y} \ar[r] & g^\ast y \ar[r] & y \\
(g\circ f)^\ast y \ar[rru] & &
}
\xymatrix{
V\ar@{-->}[d]_{\text{id}_V} \ar[r]^f & U \ar[r]^g & W \\
V \ar[rru]_{g\circ f} & &
}
\end{equation}
The morphism $t_y \colon f^\ast g^\ast y \to (g\circ f)^\ast y$ is the
unique lift of of $\text{id}_V$ making
\ref{eq:lemma-fibred-groupoids-commutes2} (resp.\ 
\ref{eq:lemma-fibred-groupoids-commutes}) commute.  If $\phi\colon
y'\to y$ is a morphism in $\mathcal S_W$ the compositions $(f^\ast
g^\ast \phi) \circ t_y$ and $((g\circ f)^\ast \phi)\circ t_{y'}$ are
both lifts of $\text{id}_V$, so are equal making $t$ is a
transformation of functors.  Essentially the same construction applies
to give the inverse transformation $t^{-1}$, so $t$ is an isomorphism.
\end{proof}

\noindent
Conversely, given $p : \mathcal{S} \to \mathcal{C}$, we can ask: if the fibre
category $\mathcal{S}_U$ is a groupoid for all $U \in \text{Ob}(\mathcal{C})$,
must $\mathcal{S}$ be fibred in groupoids over $\mathcal{C}$? We can see the
answer is no as follows. Start with a category fibred in groupoids
$p : \mathcal{S} \to \mathcal{C}$. Altering the morphisms in $\mathcal{S}$
which do not map to the identity morphism on some object does not alter the 
categories $\mathcal{S}_U$. Hence we can violate the existence and uniqueness
conditions on lifts. One example is the functor from Example 
\ref{example-group-homomorphism-fibreedingroupoids} when $G \to H$ is not
surjective. Here is another example.

\begin{example}
Let $ \text{Ob}(\mathcal{C}) = \{A,B,T\}$ and 
$\text{Mor}_\mathcal{C}(A,B) = \{f\}$, $\text{Mor}_\mathcal{C}(B,T) = \{g\}$,
$\text{Mor}_\mathcal{C}(A,T) = \{h\} = \{gf\},$ plus the identity morphism for 
each object. See the diagram below for a picture of this category. Now let 
$\text{Ob}(\mathcal{S}) = \{A',B',T'\}$ and 
$\text{Mor}_\mathcal{S}(A',B') = \emptyset$,  
$\text{Mor}_\mathcal{S}(B',T') = \{g'\}$,  
$\text{Mor}_\mathcal{S}(A',T') = \{h'\},$ plus the identity morphisms. The 
functor $p : \mathcal{S} \to \mathcal{C}$ is obvious. Then for every 
$U \in \text{Ob}(\mathcal{C})$, $\mathcal{S}_U$ is the category with one 
object and the identity morphism on that object, so a groupoid, but the 
morphism $f: A \to B$ cannot be lifted. Similarly, if we declare 
$\text{Mor}_\mathcal{S}(A',B') = \{f'_1, f'_2\}$ and 
$ \text{Mor}_\mathcal{S}(A',T') = \{h'\} = \{g'f'_1 \} = \{g'f'_2\}$, then 
the fibre categories are the same and $f: A \to B$ in the diagram below has 
two lifts. 
$$
\xymatrix{
B' \ar[r]^{g'} & T' &  & B \ar[r]^g & T & \\
A' \ar@{-->}[u]^{??} \ar[ru]_{h'} & & \ar@{}[u]^{above} &
A \ar[u]^f \ar[ru]_{gf = h} & \\
}
$$ 
\end{example}

\noindent
Later we would like to make assertions such as ``any category fibred in
groupoids over $\mathcal{C}$ is equivalent to a split one'', or
``any category fibred in groupoids whose fibre categories are setlike
is equivalent to a category fibred in sets''. The notion of equivalence
depends on the $2$-category we are working with. To make sure
that everybody knows what we are talking about we define the
$2$-category of categories over $\mathcal{C}$.

\begin{definition}
\label{definition-categories-over-C}
The $2$-category of categories over $\mathcal{C}$ is defined
as follows. Its objects will be functors 
$p : \mathcal{S} \to \mathcal{C}$ (belonging to
some set, see Sets, \autoref{sets-section-reflection-principle}). Its 
$1$-morphisms will be functors $G : \mathcal{S} \to \mathcal{S}'$
such that $p' \circ G = p$, and its $2$-morphisms $t : G \to H$
will be morphisms of functors such that $p'(t_x) = \text{id}_{p(x)}$
for all $x \in \text{Ob}(\mathcal{S})$.
\end{definition}

\noindent
The $2$-category of categories fibred in groupoids over $\mathcal{C}$
is the full sub-$2$-category of this $2$-category whose objects
are categories fibred in groupoids.

\begin{lemma}
\label{lemma-equivalence-fibred-categories}
Let $p\colon \mathcal{S}\to \mathcal{C}$ and 
$p'\colon \mathcal{S'}\to \mathcal{C}$ be categories fibred in groupoids, and
suppose that $G\colon \mathcal{S}\to \mathcal {S}'$ is a functor over 
$\mathcal{C}$.  Then $G$ is fully faithful (resp.\ an equivalence) if and only
if for each $U\in\text{Ob}(\mathcal{C})$ the induced functor 
$G_U\colon \mathcal{S}_U\to \mathcal{S}'_U$ is fully faithful (resp.\ an
equivalence).
\end{lemma}

\begin{proof}
Clearly if $G$ is fully faithful (resp.\ an equivalence) then so is $G_U$. So
suppose that $G_U$ is fully faithful for all $U\in\text{Ob}(\mathcal C)$. To
show that $G$ is fully faithful we have to show for any objects
$x,y\in\text{Ob}(\mathcal{S})$ that $G$ induces a bijection between
$\text{Mor}_{\mathcal{S}}(x,y)$ and $\text{Mor}_{\mathcal{S}'}(G(x),G(y))$. 
To this end let $\phi'\colon G(x)\to G(y)$ and set $U=p(x)$ and $V=p(y)$.
As $\mathcal{S}$ is fibred in groupoids there is a lift $z\to y$ of 
$p'(\phi')$ in $\mathcal{S}$, and any morphisms $x\to y$ factors uniquely
as $x\to z\to y$, where the map $x\to z$ lifts $\text{id}_U$, as in the
following diagram
$$
\xymatrix{
x \ar@{-->}[d] \ar[rd]  \\
z \ar[r]^\psi \ar[d] & y \ar[d] \\
U \ar[r]^{p'(\phi')} &V}
$$ 
Now in $\mathcal{S}'$,  $G(\psi)\colon G(z)\to G(y)$ is the pullback of
$G(y)$, so any morphism $G(x)\to G(y)$ factors uniquely
as $G(x)\to G(z)\to G(y)$, where again the map
$G(x)\to G(z)$ lifts $\text{id}_U$.  Since $G_U$
induces a bijection between $\text{Mor}_{\mathcal{S}_U}(x,z)$ and
$\text{Mor}_{\mathcal{S}'_U}(G(x),G(z))$ we get that
$G$ induces a bijection between $\text{Mor}_{\mathcal{S}}(x,y)$
and $\text{Mor }_{\mathcal{S}'}(G(x),G(y))$, hence $G$
is fully faithful.

\medskip\noindent
Finally suppose for all $G_U$ is an equivalence for all $U$, so it is
fully faithful and essentially surjective.  We have seen this implies $G$ is
fully faithful, and thus to prove it is an equivalence we have to prove that
it is essentially surjective.  This is clear, for if $z'\in
\text{Ob}(\mathcal{S}')$ then $z'\in \text{Ob}(\mathcal{S}'_U)$ where
$U=p'(z')$.  Since $G_U$ is essentially surjective we know that
$z'$ is isomorphic, in $\mathcal{S}'_U$, to an object of the form
$G_U(z)$ for some $z\in \text{Ob}(\mathcal{S}_U)$.  But morphisms
in $\mathcal{S}'_U$ are morphisms in $\mathcal{S}'$ and hence $z'$ is
isomorphic to $G(z)$ in $\mathcal{S}'$.
\end{proof}

\begin{lemma}
\label{lemma-2-product-categories-over-C} The 2-category of categories
over $\mathcal{C}$ has 2-fibre products. Suppose that
$f : \mathcal{X} \to \mathcal{S}$ and
$g : \mathcal{Y} \to \mathcal{S}$ are morphisms of categories over
$\mathcal{C}$. An explicit 2-fibre product
$\mathcal{X} \times_\mathcal{S}\mathcal{Y}$ is given by the following
description
\begin{enumerate}
\item an object of $\mathcal{X}\times_\mathcal{S} \mathcal{Y}$ is a quadruple
$(U,x,y,f)$, where $U \in \text{Ob}(\mathcal{C})$,
$x\in \text{Ob}(\mathcal{X}_U)$, $y\in \text{Ob}(\mathcal{Y}_U)$,
and $f : F(x) \to G(y)$ is an isomorphism in $\mathcal{S}_U$,
\item a morphism $(U,x,y,f) \to (U',x',y', f')$ is given by a pair $(a,b)$,
where $a : x \to x'$ is a morphism in $\mathcal{X}$, and $b : y \to y'$ is a
morphism in $\mathcal{Y}$ such that (1) $a$ and $b$ induced the same
morphism $U \to U'$, and (2) the diagram 
$$
\xymatrix{
F(A) \ar[r]^f \ar[d]^{F(a)} & G(B) \ar[d]^{G(b)} \\
F(A') \ar[r]^{f'} & G(B')
}
$$
is commutative.
\end{enumerate}
The functors $p : \mathcal{X}\times_\mathcal{S}\mathcal{Y} \to \mathcal{X}$
and $q : \mathcal{X}\times_\mathcal{S}\mathcal{Y} \to \mathcal{Y}$ are the
forgetfull functors in this case. The transformation $\psi : F \circ p \to
G \circ q$ is given on the object $\xi = (U,x,y,f)$ by
$\psi_\xi = f : F(p(\xi)) = F(x) \to G(y) = G(q(\xi))$.
\end{lemma}

\begin{proof}
Let us check the universal property: let $p_W : \mathcal{W}\to \mathcal{C}$
be a category over $\mathcal{C}$, let $X : \mathcal{W} \to \mathcal{X}$ and
$Y : \mathcal{W} \to \mathcal{Y}$ be functors over $\mathcal{C}$, and let
$t : F \circ X \to G \circ Y$ be an isomorphism of functors.
The desired functor
$\gamma : \mathcal{W} \to \mathcal{A}\times_\mathcal{C}\mathcal{B}$
is given by $W \mapsto (p_W(W), X(W), Y(W), t_W)$. What else could it be? 
(A meta-argument for uniqueness.) FIXME: write this out.
\end{proof}

\begin{lemma}
\label{lemma-2-product-fibred-categories}
In the situation of the lemma above, if $\mathcal{X}$, $\mathcal{Y}$ and 
$\mathcal{S}$ are fibred in groupoids over $\mathcal{C}$, then so is
$\mathcal{X}\times_\mathcal{S}\mathcal{Y}$. In particular the 2-category
of categories fibred in groupoids over $\mathcal{C}$ has 2-fibre products
(and they are described as above).
\end{lemma}

\begin{proof} 
FIXME.
\end{proof}

\section{Categories fibred in sets}
\label{section-fibred-in-sets}

\noindent
Let us call a category setlike if it is a groupoid where every object
has exactly one automorphism: the identity. If $C$ is a set with an 
equivalence relation $\sim$, then we can make a setlike category
$\mathcal{C}$ as follows: $\text{Ob}(\mathcal{C}) = C$ and 
$\text{Mor}_\mathcal{C}(x,y) = \emptyset$ unless $x \sim y$ in which
case we set $\text{Mor}_\mathcal{C}(x,y) = \{1\}$. Transitivity of
$\sim$ means that we can compose morphisms. Conversely any setlike
category defines an equivalence relation on its objects (isomorphism)
such that you recover the category (up to unique isomorphism -- not
equivalence) from the procedure just described. This is why these categories
are sometimes simply called equivalence relations.

\medskip\noindent
A category is called discrete if the only morphisms are the identity 
morphisms. Sometimes discrete categories are called sets (reasons as above).
Discrete categories are setlike. For any setlike category $\mathcal{C}$
there is a canonical procedure to make a discrete category equivalent to it,
namely one replaces $\text{Ob}(\mathcal{C})$ by the set of isomorphism
classes, and adds identity morphisms.

\begin{definition}
\label{definition-category-fibred-sets}
A category fibred in groupoids $p : \mathcal{S} \to \mathcal{C}$ is said
to be a category fibred in sets if all fibre categories are discrete.
\end{definition}

\noindent
We discuss briefly the relationship between categories fibred in sets
and presheaves (see Sites, Definition \ref{sites-definition-presheaf}).
Suppose that $p :
\mathcal{S} \to \mathcal{C}$ is fibred in sets. Let $f : V \to U$
be a morphism in $\mathcal{C}$ and let $x \in \text{Ob}(\mathcal{S}_U)$.
Then there is exactly one choice for the object $f^\ast x$. Thus we see that
$(f \circ g)^\ast x = g^\ast(f^\ast x)$ for $f,g$ as in Lemma
\ref{lemma-fibred-groupoids}. It follows that we may think of the
assigments $U \mapsto \text{Ob}(\mathcal{S}_U)$ and $f \mapsto f^\ast$
as a presheaf on $\mathcal{C}$.

\medskip\noindent
Conversely, given a presheaf of sets
$F : \mathcal{C}^{\text{opp}} \to \text{Sets}$
we can construct a category $\mathcal{S}_F$ fibred in sets
over $\mathcal{C}$ by taking as fibre category $\mathcal{S}_{F,U}$ 
the discrete category whose underlying set is $F(U)$. This is explained
more generally, and in more detail in Example \ref{example-functor-groupoids}
below. Also, here is an important example.

\begin{example}
\label{example-fibred-category-from-functor-of-points}
In this example $F = h_X = \text{Mor}(-,X)$ for some
$X \in \text{Ob}(\mathcal{C})$ (see Example \ref{example-hom-functor}).
In other words, $F$ is a representable presheaf.
Since $\mathcal{S}_{F,U}$ is the discrete category whose objects are the
morphisms from $U$ into $X$ it follows that
$\mathcal{S}_F\to \mathcal{C}$ is the functor denoted
$\mathcal{C}/X \to \mathcal{C}$ from
Example \ref{example-category-over-X}.
FIXME. Improve formulation.
\end{example}

\noindent
For this reason it is tempting to define a ``representable'' object in the
2-category of categories fibred in groupoids to be a category fibred in
sets whose associated presheaf is representable. However, this is would not
be a good definition since we prefer to have a notion wich is invariant under
equivalences. Thus we consider first which categories in groupoids are
equivalent to categories fibred in sets.

\begin{lemma}
\label{lemma-setlike-fibres}
Suppose that $p : \mathcal{S} \to \mathcal{C}$ is a category fibred in
groupoids all of whose fibre categories $\mathcal{S}_U$ are setlike. 
Then there exists a category fibred in sets $p' : \mathcal{S}' \to
\mathcal{C}$ and an equivalence
$\text{can}:\mathcal{S} \to \mathcal{S}'$ of categories over $\mathcal{C}$.
The 1-morphism $\mathcal{S}\to\mathcal{S}'$ is unique up to a unique
2-morphism. It further has the property that
$$
\text{Ob}(\mathcal{S}_U) \longrightarrow \text{Ob}(\mathcal{S}'_U) 
$$
(induced by $\text{can}$) identifies the RHS with ismorphism classes of the
LHS for all $U \in \text{Ob}(\mathcal{C})$. The 1-morphism
$\mathcal{S}\to\mathcal{S}'$ is unique up to a unique 2-morphism. 

\medskip\noindent
Conversely, any category fibred in groupoids over $\mathcal{C}$ which
is equivalent (as a category over $\mathcal{C}$) to a category fibred 
in sets, has setlike fibre categories.
\end{lemma}

\begin{proof}
An object of the category $\mathcal{S}'$ will be a pair $(U, \xi)$, where
$U \in \text{Ob}(\mathcal{C})$ and $\xi$ is an isomorphism class of objects
of $\mathcal{S}_U$. A morphism $(U,\xi) \to (V , \psi)$ is given by a 
morphism $x \to y$, where $x \in \xi$ and $y \in \psi$. Here we identify
two morphisms $x \to y$ and $x' \to y'$ if they induce the same morphism
$U \to V$, and if for some choices of isomorphisms $x \to x'$ in
$\mathcal{S}_U$ and $y \to y'$ in $\mathcal{S}_V$ the compositions
$x \to x' \to y'$ and $x \to y \to y'$ agree. By construction there are
surjective maps on objects and morphisms from $\mathcal{S} \to
\mathcal{S}'$. We define composition of morphisms in $\mathcal{S}'$ to
be the unique law that turns $\mathcal{S} \to \mathcal{S}'$ into a functor.
FIXME: check this is well-defined. 

\medskip\noindent
By construction the rule $(U,\xi) \mapsto U$ is a functor. FIXME: check this
and the other properties.
\end{proof}

\noindent
With this lemma in hand it is easy to recognize those categories over
$\mathcal{C}$ which are equivalent to a category fibred in sets. Thus we
now make the following definition.

\begin{definition}
\label{definition-representable-fibred-category}
A category fibred in groupoids $p : \mathcal{S} \to \mathcal{C}$ is
called representable, if the following conditions are satisfied:
\begin{enumerate}
\item all fibre categories $\mathcal{S}_U$ are setlike, and
\item the presheaf $U \mapsto \text{Ob}(\mathcal{S}_U)/\cong$ is 
representable.
\end{enumerate}
\end{definition}

\noindent
In this case, by Lemma \ref{lemma-setlike-fibres} the category 
$\mathcal{S}'$ is isomorphic to $\mathcal{C}/X$ over $\mathcal{C}$.
As usual, by the Yoneda lemma the pair $(X,j)$, where $j$ is the
equivalence $j : \mathcal{S} \to \mathcal{C}/X$ is uniquely determined
up to isomorphism.

\begin{lemma}
\label{lemma-2-product-categories-fibred-sets}
The 2-category of categories fibred in sets over $\mathcal{C}$
has 2-fibre products. More precisely, the 2-fibre product described in 
Lemma \ref{lemma-2-product-categories-over-C} returns a category fibred in
sets if one starts out with such. A similar result holds for categories
fibred in groupoids all of whose fibre categories are setlike.
\end{lemma}

\begin{proof}
FIXME.
\end{proof}

\section{Presheaves of groupoids}
\label{section-presheaves-groupoids}

\noindent
In this section we compare the notion of categories fibred in groupoids
with the closely related notion of a ``presheaf of groupoids''. The basic
construction is explained in the following example.

\begin{example}
\label{example-functor-groupoids}
Suppose that $F : \mathcal{C} \to \text{Groupoids}$ is a contravariant functor
to the category of groupoids, see Remarks \ref{remark-functor-into-sets} and
\ref{remarks-functor-into-2-category}.
For $f : V \to U$ in $\mathcal{C}$ we will
suggestively write $F(f) = f^\ast$ for the functor from $F(U)$ to $F(V)$. 
From this we can construct a category fibred in groupoids over $\mathcal{C}$ 
as follows. Define 
$$
\text{Ob}(\mathcal{S}) =
\{(U,x) \mid U\in \text{Ob}(\mathcal{C}), x\in \text{Ob}(F(U)\}.
$$ 
For $(U,x), (V,y) \in \text{Ob}(\mathcal{S})$ we define
$$
\text{Mor}_\mathcal{S}((V,y),(U,x)) = 
\{ (f, \phi) \mid f\in \text{Mor}_\mathcal{C}(V,U), 
\phi \in \text{Mor}_{F(V)}(y, f^\ast x)\}.
$$
In order to define composition we use that $g^\ast \circ f^\ast = 
(f \circ g)^\ast$ for a pair of composable morphisms of $\mathcal{C}$
(by definition of a functor into a $2$-category).
Namely, we define the composition of $\psi : z \to g^\ast y$ and 
$ \phi : y \to f^\ast x$ to be $ g^\ast(\phi) \circ \psi$. It is clear
what the functor $p : \mathcal{S} \to \mathcal{C}$ is. The condition
that $F(U)$ is a groupoid for every $U$ guarantees that $\mathcal{S}$ is
fibred in groupoids over $\mathcal{C}$. Lifts of morphisms exist: given 
$f: V \to U$ in $\mathcal{C}$ and $(U,x)$ a lift of $U$, then 
$(f, id_{f^\ast x}): (V, {f^\ast x}) \to (U,x)$ is a lift of $f$. 
Uniqueness means $h$ in the diagram on the left determines $(h,\nu)$ on 
the right:
$$
\xymatrix{
V \ar[r]^f & U & (V,y) \ar[r]^{(f, \phi)} & (U,x) \\
W \ar@{-->}[u]^h \ar[ru]_g & &
(W,z) \ar@{-->}[u]^{(h,\nu)} \ar[ru]_{(g, \psi)} & \\
}
$$
Then $\nu = (h^\ast \phi)^{-1} \circ \psi $ and the uniqueness of inverses
guarantees this is the only lift making the diagram commute.

\noindent
We will write $\mathcal{S}_F \to \mathcal{C}$ for the resulting functor
if we want to indicate the dependence on $F$. Because we can think of 
objects of $\mathcal{S}_F$ as pairs $(U,x)$, we sometimes say $\mathcal{S}_F$ 
is a {\it split} category fibred in groupoids.
\end{example}

\begin{lemma} 
\label{lemma-fibred-strict}
Let $ p : \mathcal{S} \to \mathcal{C}$ be a category fibred in groupoids.
There exists a functor $F : \mathcal{C} \to \text{Groupoids}$ such that 
$\mathcal{S}$ is equivalent to $\mathcal{S}_F$ over $\mathcal{C}$. In other 
words, every category fibred in groupoids is equivalent to a split one.
\end{lemma}

\begin{proof} 
We construct a new category $\mathcal{S}'$ as follows. First we choose 
pullback functors $g^\ast : \mathcal{S}_V \to \mathcal{S}_{V'}$ for any 
morphism $g : V' \to V$ of $\mathcal{C}$. (We can do this since 
$\mathcal{S}$, $\mathcal{C}$ are sets. FIXME: We can do this proof without
choosing these as well.) The objects of $\mathcal{S}'$ 
are pairs $(x,f)$ consisting of a morphism $f : V \to U$ of $\mathcal{C}$
and an object $x$ of $\mathcal{S}$ over $U$, i.e., 
$x\in \text{Ob}(\mathcal{S}_U)$. The functor 
$p' : \mathcal{S}' \to \mathcal{C}$ will map the pair $(x,f)$ to the source 
of the morphism $f$, in other words $p'(x,f:V\to U) = V$. A morphism 
$\varphi : (x_1,f_1: V_1 \to U_1) \to (x_2, f_2 : V_2 \to U_2)$ is given by a 
pair $(\varphi,g)$ consisting of a morphism $g : V_1 \to V_2$ and a morphism 
$\varphi : f_1^\ast x_1 \to f_2^\ast x_2$ with $p(\varphi) = g$. It is no 
problem to define the composition law: $(\varphi,g) \circ (\psi,h) = 
(\varphi \circ \psi, g\circ h)$ for any pair of composable morphisms. 
There is a natural functor $\mathcal{S} \to \mathcal{S}'$ which simply maps
$x$ over $U$ to the pair $(x, \text{id}_x)$.

\medskip\noindent
FIXME. We need to check that $p'$ makes $\mathcal{S}'$ into a category
fibred in groupoids over $\mathcal{C}$, and we need to check that 
$\mathcal{S} \to \mathcal{S}'$ is an equivalence of categories over 
$\mathcal{C}$ (hopefully the lemma above helps!). 

\medskip\noindent
Finally, we can define pullback functors on $\mathcal{S}'$ 
by setting $g^\ast(x,f) = (x, f \circ g)$ on objects if $g : V' \to V$ and
$f : V \to U$. On morphisms $(\varphi,\text{id}_V) : (x_1, f_1) \to (x_2,f_2)$
between morphisms in $\mathcal{S}'_V$ we set $g^\ast(\varphi,\text{id}_V) =
(g^\ast\varphi, \text{id}_{V'})$ where we use the unique identifications
$g^\ast f_i^\ast x_i = (f_i \circ g)^\ast x_i$ from Lemma 
\ref{lemma-fibred-groupoids} to think of $g^\ast\varphi$ as a morphism from
$(f_1 \circ g)^\ast x_1$ to $(f_2 \circ g)^\ast x_2$. Clearly, these pullback
functors $g^\ast$ have the property that
$g_1^\ast \circ g_2^\ast = (g_2\circ g_1)^\ast$, in other words $\mathcal{S}'$
is split as desired.
\end{proof}

\begin{proof}[Alternate proof]
We define a contravariant functor $F$ from $\mathcal{C}$ to the
category of groupoids as follows: for $U\in \text{Ob}(\mathcal{C})$
set $F(U) = \text{Mor}(\mathcal{S}/U,\mathcal{S})$ to be the set of
base preserving natural transformations.  If $f\colon U\to V$ the
induced functor $\mathcal{S}/U\to \mathcal{S}/V$ induces the
morphism $F(f)\colon F(V)\to F(U)$.  Clearly $F$ is a functor, and
we will see below that it is a functor into groupoids.  Let
$\mathcal{S}'$ be the associated category fibred in groupoids from Example
\ref{example-functor-groupoids}.

\medskip\noindent
There is an obvious functor $G\colon \mathcal{S}'\to \mathcal{S}$
over $\mathcal{C}$ given by taking the pair $(U,x)$, where
$U\in\text{Ob}(\mathcal{C})$ and $x\in F(U)$, to
$x(U\stackrel{\text{id}_U}{\to} U) \in \mathcal{S}$.  Now Lemma
\ref{lemma-yoneda-2category} implies that for each $U$,
$$
G_U\colon \mathcal{S}'_U = F(U)= 
\text{Mor}(\mathcal{C}/U,\mathcal{S}) \to \mathcal{S}_U
$$
is an equivalence, and thus $G$ equivalence between $\mathcal{S}$ and
$\mathcal{S}'$ by Lemma \ref{lemma-equivalence-fibred-categories}.
\end{proof}

\begin{lemma}
\label{lemma-yoneda-2category}
Let $\mathcal{S}\to \mathcal{C}$ be fibred in groupoids.  Then for any
$U\in \text{Ob}(\mathcal{C})$ the functor
$$
G\colon \text{Mor}(\mathcal{C}/U,\mathcal{S}) \to \mathcal{S}_U
$$
given by $G(x) = x(U\stackrel{\text{id}_U}{\to} U)$ is an equivalence.
\end{lemma}

\noindent
FIXME: Do we have notation for base preserving transformations already?
Say what $G$ does on arrows.

\begin{proof}
We define a functor $H\colon \mathcal{S}_U \to
\text{Mor}(\mathcal{C}/U,\mathcal{S})$ as follows.  Given $x\in
\text{Ob}(\mathcal{S}_U)$ and $f\colon X\to U$ set $H(x)(f) = f^*x$.
(FIXME: say what this does on arrows and prove this gives an
equivalence).
\end{proof}
 
\noindent {\bf Biographical notes:} Parts of this have been taken from
Vistoli's notes \cite{Vis2}.

\input{chapters}

\bibliographystyle{alpha}
\bibliography{my}

\end{document}
