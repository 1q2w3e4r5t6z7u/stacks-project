\input{preamble}

% OK, start here.
%
\begin{document}

\title{Modules on Sites}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this document we work out basic notions of sheaves of modules on
ringed topoi or ringed sites. We first work out some basic facts on
abelian sheaves. After this we introduce ringed sites and ringed topoi.
We work through some of the very basic notions on (pre)sheaves of
$\mathcal{O}$-modules, analogous to the material on (pre)sheaves of
$\mathcal{O}$-modules in the chapter on sheaves on spaces.
Having done this, we duplicate much of the discussion in the chapter on
sheaves of modules (see Modules, Section \ref{modules-section-introduction}).
Basic references are \cite{FAC}, \cite{EGA} and \cite{SGA4}.






\section{Abelian presheaves}
\label{section-abelian-pre-sheaves}

\noindent
Let $\mathcal{C}$ be a category.
Abelian presheaves were introduced in
Sites, Sections \ref{sites-section-presheaves}
and \ref{sites-section-sheaves} and discussed a bit more
in Sites, Section \ref{sites-section-sheaves-algebraic-structures}.
We will follow the convention of this last reference, in that we think
of an abelian presheaf as a presheaf of sets endowed with addition rules
on all sets of sections compatible with the restriction mappings.
Recall that the category of abelian presheaves on $\mathcal{C}$
is denoted $\textit{PAb}(\mathcal{C})$.

\medskip\noindent
The category $\textit{PAb}(\mathcal{C})$ is abelian as defined in
Homology, Definition \ref{homology-definition-abelian-category}.
Given a map of presheaves $\varphi : \mathcal{G}_1 \to \mathcal{G}_2$
the kernel of $\varphi$ is the abelian presheaf
$U \mapsto \text{Ker}(\mathcal{G}_1(U) \to \mathcal{G}_2(U))$ and
the cokernel of $\varphi$ is the presheaf
$U \mapsto \text{Coker}(\mathcal{G}_1(U) \to \mathcal{G}_2(U))$.
Since the category of abelian groups is abelian it follows that
$\text{Coim} = \text{Im}$ because this holds over each $U$.
A sequence of abelian presheaves
$$
\mathcal{G}_1 \longrightarrow
\mathcal{G}_2 \longrightarrow
\mathcal{G}_3
$$
is exact if and only if
$\mathcal{G}_1(U) \to \mathcal{G}_2(U) \to \mathcal{G}_3(U)$
is an exact sequence of abelian groups for all $U \in \text{Ob}(\mathcal{C})$.
We leave the verifications to the reader.

\begin{lemma}
\label{lemma-limits-colimits-abelian-presheaves}
Let $\mathcal{C}$ be a category.
\begin{enumerate}
\item All limits and colimits exist in $\textit{PAb}(\mathcal{C})$.
\item All limits and colimits commute with taking sections over objects of
$\mathcal{C}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $\mathcal{I} \to \textit{PAb}(\mathcal{C})$, $i \mapsto \mathcal{F}_i$
be a diagram. We can simply define abelian presheaves
$L$ and $C$ by the rules
$$
L : U \longmapsto \text{lim}_i\ \mathcal{F}_i(U)
$$
and
$$
C : U \longmapsto \text{colim}_i\ \mathcal{F}_i(U).
$$
It is clear that there are maps of abelian presheaves $L \to \mathcal{F}_i$
and $\mathcal{F}_i \to C$, by using the corresponding maps on groups of
sections over each $U$. It is straightforward to check that $L$ and $C$ endowed
with these maps are the limit and colimit of the diagram in
$\textit{PAb}(\mathcal{C})$. This proves (1) and (2). Details omitted.
\end{proof}


\section{Abelian sheaves}
\label{section-abelian-sheaves}

\noindent
Let $\mathcal{C}$ be a site.
The category of abelian sheaves on $\mathcal{C}$ is denoted
$\textit{Ab}(\mathcal{C})$. It is the full subcategory of
$\textit{PAb}(\mathcal{C})$ consisting of those abelian presheaves
whose underlying presheaves of sets are sheaves.
Properties ($\alpha$) -- ($\zeta$) of
Sites, Section \ref{sites-section-sheaves-algebraic-structures}
hold, see
Sites,
Proposition \ref{sites-proposition-functoriality-algebraic-structures-topoi}.
In particular the inclusion functor
$\textit{Ab}(\mathcal{C}) \to \textit{PAb}(\mathcal{C})$
has a left adjoint, namely the sheafification functor
$\mathcal{G} \mapsto \mathcal{G}^\#$.

\medskip\noindent
We suggest the reader prove the lemma on a piece of scratch paper rather
than reading the proof.

\begin{lemma}
\label{lemma-abelian-abelian}
Let $\mathcal{C}$ be a site. Let $\varphi : \mathcal{F} \to \mathcal{G}$
be a morphism of abelian sheaves on $\mathcal{C}$.
\begin{enumerate}
\item The category $\textit{Ab}(\mathcal{C})$ is an abelian category.
\item The kernel $\text{Ker}(\varphi)$ of $\varphi$ is the same as the
kernel of $\varphi$ as a morphism of presheaves.
\item The morphism $\varphi$ is injective
(Homology, Definition \ref{homology-definition-injective-surjective})
if and only if $\varphi$ is injective as a map of presheaves
(Sites, Definition \ref{sites-definition-presheaves-injective-surjective}),
if and only if $\varphi$ is injective as a map of sheaves
(Sites, Definition \ref{sites-definition-sheaves-injective-surjective}).
\item The cokernel $\text{Coker}(\varphi)$ of $\varphi$ is the sheafification
of the cokernel of $\varphi$ as a morphism of presheaves.
\item The morphism $\varphi$ is surjective
(Homology, Definition \ref{homology-definition-injective-surjective})
if and only if $\varphi$ is surjective as a map of sheaves
(Sites, Definition \ref{sites-definition-sheaves-injective-surjective}).
\item A complex of abelian sheaves
$$
\mathcal{F} \to \mathcal{G} \to \mathcal{H}
$$
is exact at $\mathcal{G}$ if and only if for all
$U \in \text{Ob}(\mathcal{C})$ and all $s \in \mathcal{G}(U)$
mapping to zero in $\mathcal{H}(U)$ there exists a covering
$\{U_i \to U\}_{i \in I}$ in $\mathcal{C}$ such that each
$s|_{U_i}$ is in the image of $\mathcal{F}(U_i) \to \mathcal{G}(U_i)$.
\end{enumerate}
\end{lemma}

\begin{proof}
We claim that Homology, Lemma \ref{homology-lemma-adjoint-get-abelian}
applies to the categories $\mathcal{A} = \textit{Ab}(\mathcal{C})$
and $\mathcal{B} = \textit{PAb}(\mathcal{C})$, and the functors
$a : \mathcal{A} \to \mathcal{B}$ (inclusion),  and
$b : \mathcal{B} \to \mathcal{A}$ (sheafification).
Let us check the assumptions of
Homology, Lemma \ref{homology-lemma-adjoint-get-abelian}.
Assumption (1) is that $\mathcal{A}$, $\mathcal{B}$ are additive categories,
$a$, $b$ are additive functors, and $a$ is right adjoint to $b$.
The first two statements are clear and adjointness is
Sites, Section \ref{sites-section-sheaves-algebraic-structures} ($\epsilon$).
Assumption (2) says that $\textit{PAb}(\mathcal{C})$ is abelian
which we saw in Section \ref{section-abelian-pre-sheaves} and
that sheafification is left exact, which is
Sites, Section \ref{sites-section-sheaves-algebraic-structures} ($\zeta$).
The final assumption is that $ba \cong \text{id}_{\mathcal{A}}$ which is
Sites, Section \ref{sites-section-sheaves-algebraic-structures} ($\delta$).
Hence Homology, Lemma \ref{homology-lemma-adjoint-get-abelian}
applies and we conclude that $\textit{Ab}(\mathcal{C})$ is abelian.

\medskip\noindent
In the proof of Homology, Lemma \ref{homology-lemma-adjoint-get-abelian}
it is shown that $\text{Ker}(\varphi)$ and $\text{Coker}(\varphi)$
are equal to the sheafification of the kernel and cokernel of $\varphi$
as a morphism of abelian presheaves. This proves (4). Since the kernel
is a equalizer (i.e., a limit) and since sheafifcation commutes with
finite limits, we conclude that (2) holds.

\medskip\noindent
Statement (2) implies (3). Statement (4) implies (5) by our description
of sheafification. The characterization of exactness in (6) follows from
(2) and (5), and the fact that the sequence is exact if and only if
$\text{Im}(\mathcal{F} \to \mathcal{G}) =
\text{Ker}(\mathcal{G} \to \mathcal{H})$.
\end{proof}

\noindent
Another way to say part (6) of the lemma is that a
sequence of abelian sheaves
$$
\mathcal{F}_1 \longrightarrow
\mathcal{F}_2 \longrightarrow
\mathcal{F}_3
$$
is exact if and only if the sheafification of
$U \mapsto \mathcal{F}_2(U)/\mathcal{F}_1(U)$ is equal to the
kernel of $\mathcal{F}_2 \to \mathcal{F}_3$.

\begin{lemma}
\label{lemma-limits-colimits-abelian-sheaves}
Let $\mathcal{C}$ be a site.
\begin{enumerate}
\item All limits and colimits exist in $\textit{Ab}(\mathcal{C})$.
\item Limits are the same as the corresponding limits of abelian presheaves
over $\mathcal{C}$ (i.e., commute with taking sections over objects of
$\mathcal{C}$).
\item Finite direct sums are the same as the correponding finite direct sums
in the category of abelian pre-sheaves over $\mathcal{C}$.
\item A colimit is the sheafification of the corresponding colimit in
the category of abelian presheaves.
\end{enumerate}
\end{lemma}

\begin{proof}
By Lemma \ref{lemma-limits-colimits-abelian-presheaves} limits and colimits
of abelian presheaves exist, and are described by taking limits and colimits
on the level of sections over objects.

\medskip\noindent
Let $\mathcal{I} \to \textit{Ab}(\mathcal{C})$, $i \mapsto \mathcal{F}_i$
be a diagram. Let $\text{lim}_i \mathcal{F}_i$ be the limit of the diagram
as an abelian presheaf. By Sites, Lemma \ref{sites-lemma-limit-sheaf}
this is an abelian sheaf. Then it is quite easy to see that
$\text{lim}_i \mathcal{F}_i$ is the limit of the diagram in
$\textit{Ab}(\mathcal{C})$. This proves limits exist and (2) holds.

\medskip\noindent
By Categories, Lemma \ref{categories-lemma-adjoint-exact}, and because
sheafification is left adjoint to the inclusion functor we see that
$\text{colim}_i\ \mathcal{F}$ exists and is the sheafification of the colimit
in $\textit{PAb}(\mathcal{C})$. This proves colimits exist and (4) holds.

\medskip\noindent
Finite direct sums are the same thing as finite products in any abelian
category. Hence (3) follows from (2).
\end{proof}







\section{Free abelian presheaves}
\label{section-free-abelian-presheaf}

\noindent
In order to prepare notation for the following definition, let us agree
to denote the free abelian group on a set $S$ as\footnote{In other chapters
the notation $\mathbf{Z}[S]$ sometimes indicates the polynomial ring over
$\mathbf{Z}$ on $S$.}
$\mathbf{Z}[S] = \bigoplus_{s \in S} \mathbf{Z}$. It is characterized
by the property
$$
\text{Mor}_{\textit{Ab}}(\mathbf{Z}[S], A)
=
\text{Mor}_{\textit{Sets}}(S, A)
$$
In other words the construction $S \mapsto \mathbf{Z}[S]$ is a left adjoint
to the forgetful functor $\textit{Ab} \to \textit{Sets}$.

\begin{definition}
\label{definition-free-abelian-presheaf-on}
Let $\mathcal{C}$ be a category. Let $\mathcal{G}$ be a presheaf of sets.
The {\it free abelian presheaf} $\mathbf{Z}_{\mathcal{G}}$ on $\mathcal{G}$
is the abelian presheaf defined by the rule
$$
U \longmapsto \mathbf{Z}[\mathcal{G}(U)].
$$
In the special case $\mathcal{G} = h_X$ of a representable presheaf
associated to an object $X$ of $\mathcal{C}$
we use the notation $\mathbf{Z}_X = \mathbf{Z}_{h_X}$. In other words
$$
\mathbf{Z}_X(U) = \mathbf{Z}[\text{Mor}_{\mathcal{C}}(U, X)].
$$
\end{definition}

\noindent
This construction is clearly functorial in the presheaf $\mathcal{G}$.
In fact it is adjoint to the forgetful functor
$\textit{PAb}(\mathcal{C}) \to \textit{PSh}(\mathcal{C})$.
Here is the precise statement.

\begin{lemma}
\label{lemma-obvious-adjointness}
Let $\mathcal{C}$ be a category.
Let $\mathcal{G}$, $\mathcal{F}$ be a presheaves of sets.
Let $\mathcal{A}$ be an abelian presheaf.
Let $U$ be an object of $\mathcal{C}$. Then
we have
\begin{align*}
\text{Mor}_{\textit{PSh}(\mathcal{C})}(h_U, \mathcal{F})
& =
\mathcal{F}(U), \\
\text{Mor}_{\textit{PAb}(\mathcal{C})}(\mathbf{Z}_{\mathcal{G}}, \mathcal{A})
& =
\text{Mor}_{\textit{PSh}(\mathcal{C})}(\mathcal{G}, \mathcal{A}), \\
\text{Mor}_{\textit{PAb}(\mathcal{C})}(\mathbf{Z}_U, \mathcal{A})
& =
\mathcal{A}(U).
\end{align*}
All of these equalities are functorial.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-coproduct-sum-free-abelian-presheaf}
Let $\mathcal{C}$ be a category.
Let $I$ be a set. For each $i \in I$ let
$\mathcal{G}_i$ be a presheaf of sets.
Then
$$
\mathbf{Z}_{\coprod_i \mathcal{G}_i}
=
\bigoplus\nolimits_{i \in I} \mathbf{Z}_{\mathcal{G}_i}
$$
in $\textit{PAb}(\mathcal{C})$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}



\section{Free abelian sheaves}
\label{section-free-abelian-sheaf}

\noindent
Here is the notion of a free abelian sheaf on a sheaf of sets.

\begin{definition}
\label{definition-free-abelian-sheaf-on}
Let $\mathcal{C}$ be a site. Let $\mathcal{G}$ be a presheaf of sets.
The {\it free abelian sheaf} $\mathbf{Z}_{\mathcal{G}}^\#$
on $\mathcal{G}$ is the abelian sheaf $\mathbf{Z}_{\mathcal{G}}^\#$
which is the sheafification of the abelian presheaf on $\mathcal{G}$.
In the special case $\mathcal{G} = h_X$ of a representable presheaf
associated to an object $X$ of $\mathcal{C}$
we use the notation $\mathbf{Z}_X^\#$.
\end{definition}

\noindent
This construction is clearly functorial in the presheaf $\mathcal{G}$.
In fact it provides an adjoint to the forgetful functor
$\textit{Ab}(\mathcal{C}) \to \textit{Sh}(\mathcal{C})$.
Here is the precise statement.

\begin{lemma}
\label{lemma-obvious-adjointness-sheaves}
Let $\mathcal{C}$ be a site.
Let $\mathcal{G}$, $\mathcal{F}$ be a sheaves of sets.
Let $\mathcal{A}$ be an abelian sheaf.
Let $U$ be an object of $\mathcal{C}$. Then
we have
\begin{align*}
\text{Mor}_{\textit{Sh}(\mathcal{C})}(h_U^\#, \mathcal{F})
& =
\mathcal{F}(U), \\
\text{Mor}_{\textit{Ab}(\mathcal{C})}(\mathbf{Z}_{\mathcal{G}}^\#,
\mathcal{A})
& =
\text{Mor}_{\textit{Sh}(\mathcal{C})}(\mathcal{G}, \mathcal{A}), \\
\text{Mor}_{\textit{Ab}(\mathcal{C})}(\mathbf{Z}_U^\#, \mathcal{A})
& =
\mathcal{A}(U).
\end{align*}
All of these equalities are functorial.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-may-sheafify-before-abelianize}
Let $\mathcal{C}$ be a site.
Let $\mathcal{G}$ be a presheaf of sets.
Then $\mathbf{Z}_{\mathcal{G}}^\# = (\mathbf{Z}_{\mathcal{G}^\#})^\#$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}








\section{Ringed topoi}
\label{section-ringed-topoi}

\noindent
In this chapter we mainly work with sheaves of modules on a ringed site.
Hence we need to define this notion.

\begin{definition}
\label{definition-ringed-site}
Ringed sites.
\begin{enumerate}
\item A {\it ringed site} is a pair $(\mathcal{C}, \mathcal{O})$
where $\mathcal{C}$ is a site and $\mathcal{O}$ is a sheaf of rings
on $\mathcal{C}$. The sheaf $\mathcal{O}$ is called the
{\it structure sheaf} of the ringed site.
\item Let $(\mathcal{C}, \mathcal{O})$, $(\mathcal{C}', \mathcal{O}')$ be ringed
sites. A {\it morphism of ringed sites}
$$
(f, f^\sharp) :
(\mathcal{C}, \mathcal{O})
\longrightarrow
(\mathcal{C}', \mathcal{O}')
$$
is given by a morphism of sites $f : \mathcal{C} \to \mathcal{C}'$
(see Sites, Definition \ref{sites-definition-morphism-sites})
together with a map of sheaves of rings
$f^\sharp : f^{-1}\mathcal{O}' \to \mathcal{O}$, which by adjunction
is the same thing as a map of sheaves of rings
$f^\sharp : \mathcal{O}' \to f_*\mathcal{O}$.
\item Let
$(f, f^\sharp) :
(\mathcal{C}_1, \mathcal{O}_1) \to (\mathcal{C}_2, \mathcal{O}_2)$ and
$(g, g^\sharp) :
(\mathcal{C}_2, \mathcal{O}_2) \to (\mathcal{C}_3, \mathcal{O}_3)$
be morphisms of ringed sites. Then we define
the {\it composition of morphisms of ringed sites}
by the rule
$$
(g, g^\sharp) \circ (f, f^\sharp) = (g \circ f, f^\sharp \circ g^\sharp).
$$
Here we use composition of morphisms of sites defined in
Sites, Definition \ref{sites-definition-composition-morphisms-sites}
and $f^\sharp \circ g^\sharp$ indicates the morphism of sheaves of
rings
$$
\mathcal{O}_3 \xrightarrow{g^\sharp} g_*\mathcal{O}_2
\xrightarrow{g_*f^\sharp} g_*f_*\mathcal{O}_1 = (g \circ f)_*\mathcal{O}_1
$$
\end{enumerate}
\end{definition}

\noindent
A ringed topos and a morphism of ringed topoi are defined similarly.
Namely, a ringed topos is just a ringed site, except that the notion of
a morphism of ringed topoi is different from the notion of a morphism
of ringed sites.

\begin{definition}
\label{definition-ringed-topos}
Ringed topoi.
\begin{enumerate}
\item A {\it ringed topos} is a pair
$(\textit{Sh}(\mathcal{C}), \mathcal{O})$
where $\mathcal{C}$ is a site and $\mathcal{O}$ is a sheaf of rings
on $\mathcal{C}$. The sheaf $\mathcal{O}$ is called the
{\it structure sheaf} of the ringed site.
\item Let $(\textit{Sh}(\mathcal{C}), \mathcal{O})$,
$(\textit{Sh}(\mathcal{C}'), \mathcal{O}')$ be ringed topoi.
A {\it morphism of ringed topoi}
$$
(f, f^\sharp) :
(\textit{Sh}(\mathcal{C}), \mathcal{O})
\longrightarrow
(\textit{Sh}(\mathcal{C}'), \mathcal{O}')
$$
is given by a morphism of topoi $f : \mathcal{C} \to \mathcal{C}'$
(see Sites, Definition \ref{sites-definition-topos})
together with a map of sheaves of rings
$f^\sharp : f^{-1}\mathcal{O}' \to \mathcal{O}$, which by adjunction
is the same thing as a map of sheaves of rings
$f^\sharp : \mathcal{O}' \to f_*\mathcal{O}$.
\item Let
$(f, f^\sharp) :
(\textit{Sh}(\mathcal{C}_1), \mathcal{O}_1)
\to (\textit{Sh}(\mathcal{C}_2), \mathcal{O}_2)$ and
$(g, g^\sharp) :
(\textit{Sh}(\mathcal{C}_2), \mathcal{O}_2) \to
(\textit{Sh}(\mathcal{C}_3), \mathcal{O}_3)$
be morphisms of ringed topoi. Then we define
the {\it composition of morphisms of ringed topoi}
by the rule
$$
(g, g^\sharp) \circ (f, f^\sharp) = (g \circ f, f^\sharp \circ g^\sharp).
$$
Here we use composition of morphisms of topoi defined in
Sites, Definition \ref{sites-definition-topos}
and $f^\sharp \circ g^\sharp$ indicates the morphism of sheaves of
rings
$$
\mathcal{O}_3 \xrightarrow{g^\sharp} g_*\mathcal{O}_2
\xrightarrow{g_*f^\sharp} g_*f_*\mathcal{O}_1 = (g \circ f)_*\mathcal{O}_1
$$
\end{enumerate}
\end{definition}

\noindent
Every morphism of ringed topoi is the composition of an equivalence
of ringed topoi with a morphism of ringed topoi associated to a morpism
of ringed sites. Here is the precise statement.

\begin{lemma}
\label{lemma-morphism-ringed-topoi-comes-from-morphism-ringed-sites}
Let $(f, f^\sharp) :
(\textit{Sh}(\mathcal{C}), \mathcal{O}_{\mathcal{C}})
\to (\textit{Sh}(\mathcal{D}), \mathcal{O}_{\mathcal{D}})$
be a morphism of ringed topoi. There exists a factorization
$$
\xymatrix{
(\textit{Sh}(\mathcal{C}), \mathcal{O}_{\mathcal{C}})
\ar[rr]_{(f, f^\sharp)}
\ar[rd]_{(g, g^\sharp)}
& &
(\textit{Sh}(\mathcal{D}), \mathcal{O}_{\mathcal{D}}) \\
& (\textit{Sh}(\mathcal{C}'), \mathcal{O}_{\mathcal{C}'})
\ar[ru]_{(h, h^\sharp)}
& }
$$
where
\begin{enumerate}
\item $g : \textit{Sh}(\mathcal{C}) \to \textit{Sh}(\mathcal{C}')$
is an equivalence of topoi induced by a cocontinuous functor
$v : \mathcal{C} \to \mathcal{C}'$ as in
Sites, Lemma \ref{sites-lemma-equivalence},
\item $\mathcal{O}_{\mathcal{C}'} = g_*\mathcal{O}_{\mathcal{C}}$
and $g^\sharp$ is the obvious map, and
\item $(h, h^\sharp)$ is a morphism of ringed sites.
\end{enumerate}
\end{lemma}

\begin{proof}
This follows from
Sites, Lemma \ref{sites-lemma-morphism-topoi-comes-from-morphism-sites}.
You just have to carry along the sheaves of rings. Some details omitted.
\end{proof}









\section{Presheaves of $\mathcal{O}$-modules}
\label{section-presheaves-modules}

\noindent
Let $\mathcal{C}$ be a category.
Let $\mathcal{O}$ be a presheaf of rings on $\mathcal{C}$.
At this point we have not yet defined a presheaf of $\mathcal{O}$-modules.
Thus we do so right now.

\begin{definition}
\label{definition-presheaf-modules}
Let $\mathcal{C}$ be a category, and
let $\mathcal{O}$ be a presheaf of rings on $\mathcal{C}$.
\begin{enumerate}
\item A {\it presheaf of $\mathcal{O}$-modules}
is given by an abelian presheaf $\mathcal{F}$ together with a
map of presheaves of sets
$$
\mathcal{O} \times \mathcal{F} \longrightarrow \mathcal{F}
$$
such that for every object $U$ of $\mathcal{C}$ the map
$\mathcal{O}(U) \times \mathcal{F}(U) \to \mathcal{F}(U)$
defines the structure of an $\mathcal{O}(U)$-module
structure on the abelian group $\mathcal{F}(U)$.
\item A {\it morphism $\varphi : \mathcal{F} \to \mathcal{G}$
of presheaves of $\mathcal{O}$-modules} is a morphism of abelian presheaves
$\varphi : \mathcal{F} \to \mathcal{G}$ such that
the diagram
$$
\xymatrix{
\mathcal{O} \times \mathcal{F} \ar[r] \ar[d]_{\text{id}\times \varphi} &
\mathcal{F} \ar[d]^{\varphi} \\
\mathcal{O} \times \mathcal{G} \ar[r] &
\mathcal{G}
}
$$
commutes.
\item The set of $\mathcal{O}$-module morphisms as above is
denoted $\text{Hom}_{\mathcal{O}}(\mathcal{F}, \mathcal{G})$.
\item The category of presheaves of $\mathcal{O}$-modules is denoted
$\textit{PMod}(\mathcal{O})$.
\end{enumerate}
\end{definition}

\noindent
Suppose that $\mathcal{O}_1 \to \mathcal{O}_2$ is a
morphism of presheaves of rings on the category $\mathcal{C}$. In this case,
if $\mathcal{F}$ is a presheaf of $\mathcal{O}_2$-modules
then we can think of $\mathcal{F}$ as a presheaf of
$\mathcal{O}_1$-modules by using the composition
$$
\mathcal{O}_1 \times \mathcal{F}
\to
\mathcal{O}_2 \times \mathcal{F}
\to
\mathcal{F}.
$$
We sometimes denote this by $\mathcal{F}_{\mathcal{O}_1}$
to indicate the restriction of rings. We call this
the {\it restriction of $\mathcal{F}$}. We obtain the
restriction functor
$$
\textit{PMod}(\mathcal{O}_2)
\longrightarrow
\textit{PMod}(\mathcal{O}_1)
$$

\medskip\noindent
On the other hand, given a presheaf of $\mathcal{O}_1$-modules
$\mathcal{G}$
we can construct a presheaf of $\mathcal{O}_2$-modules
$\mathcal{O}_2 \otimes_{p, \mathcal{O}_1} \mathcal{G}$
by the rule
$$
U \longmapsto
\left(\mathcal{O}_2 \otimes_{p, \mathcal{O}_1} \mathcal{G}\right)(U)
=
\mathcal{O}_2(U) \otimes_{\mathcal{O}_1(U)} \mathcal{G}(U)
$$
where $U \in \text{Ob}(\mathcal{C})$, with obvious restriction mappings.
The index $p$ stands for ``presheaf'' and not ``point''.
This presheaf is called the tensor product presheaf. We obtain
the {\it change of rings} functor
$$
\textit{PMod}(\mathcal{O}_1)
\longrightarrow
\textit{PMod}(\mathcal{O}_2)
$$

\begin{lemma}
\label{lemma-adjointness-tensor-restrict-presheaves}
With $\mathcal{C}$, $\mathcal{O}_1 \to \mathcal{O}_2$, $\mathcal{F}$ and
$\mathcal{G}$ as above there exists a canonical bijection
$$
\text{Hom}_{\mathcal{O}_1}(\mathcal{G}, \mathcal{F}_{\mathcal{O}_1})
=
\text{Hom}_{\mathcal{O}_2}(
\mathcal{O}_2 \otimes_{p, \mathcal{O}_1} \mathcal{G},
\mathcal{F}
)
$$
In other words, the restriction and change of rings functors defined
above are adjoint to each other.
\end{lemma}

\begin{proof}
This follows from the fact that for a ring map
$A \to B$ the restriction functor and the change
of ring functor are adjoint to each other.
\end{proof}


\section{Sheaves of $\mathcal{O}$-modules}
\label{section-sheaves-modules}

\begin{definition}
\label{definition-sheaf-modules}
Let $\mathcal{C}$ be a site.
Let $\mathcal{O}$ be a sheaf of rings on $\mathcal{C}$.
\begin{enumerate}
\item A {\it sheaf of $\mathcal{O}$-modules} is a presheaf
of $\mathcal{O}$-modules $\mathcal{F}$,
see Definition \ref{definition-presheaf-modules},
such that the underlying presheaf of abelian groups $\mathcal{F}$
is a sheaf.
\item A {\it morphism of sheaves of $\mathcal{O}$-modules}
is a morphism of presheaves of $\mathcal{O}$-modules.
\item Given sheaves of $\mathcal{O}$-modules
$\mathcal{F}$ and $\mathcal{G}$ we denote
$\text{Hom}_{\mathcal{O}}(\mathcal{F}, \mathcal{G})$
the set of morphism of sheaves of $\mathcal{O}$-modules.
\item The category of sheaves of $\mathcal{O}$-modules
is denoted $\textit{Mod}(\mathcal{O})$.
\end{enumerate}
\end{definition}

\noindent
This definition kind of makes sense even if $\mathcal{O}$ is just a
presheaf of rings, allthough we do not know any examples where
this is useful, and we will avoid using the terminology
``sheaves of $\mathcal{O}$-modules''
in case $\mathcal{O}$ is not a sheaf of rings.



\section{Sheafification of presheaves of $\mathcal{O}$-modules}
\label{section-sheafification-presheaves-modules}

\begin{lemma}
\label{lemma-sheafification-presheaf-modules}
Let $\mathcal{C}$ be a site.
Let $\mathcal{O}$ be a presheaf of rings on $\mathcal{C}$
Let $\mathcal{F}$ be a presheaf $\mathcal{O}$-modules.
Let $\mathcal{O}^\#$ be the sheafification of $\mathcal{O}$ as a presheaf
of rings, see Sites, Section \ref{sites-section-sheaves-algebraic-structures}.
Let $\mathcal{F}^\#$ be the sheafification of $\mathcal{F}$
as a presheaf of abelian groups. There exists a map of
sheaves of sets
$$
\mathcal{O}^\# \times \mathcal{F}^\#
\longrightarrow
\mathcal{F}^\#
$$
which makes the diagram
$$
\xymatrix{
\mathcal{O} \times \mathcal{F} \ar[r] \ar[d] &
\mathcal{F} \ar[d] \\
\mathcal{O}^\# \times \mathcal{F}^\# \ar[r] &
\mathcal{F}^\#
}
$$
commute and which makes $\mathcal{F}^\#$ into a sheaf
of $\mathcal{O}^\#$-modules. In addition, if $\mathcal{G}$
is a sheaf of $\mathcal{O}^\#$-modules, then any morphism
of presheaves of $\mathcal{O}$-modules $\mathcal{F} \to \mathcal{G}$
(into the restriction of $\mathcal{G}$ to a $\mathcal{O}$-module)
factors uniquely as $\mathcal{F} \to \mathcal{F}^\# \to \mathcal{G}$
where $\mathcal{F}^\# \to \mathcal{G}$ is a morphism of
$\mathcal{O}^\#$-modules.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
This actually means that the functor
$i : \textit{Mod}(\mathcal{O}^\#) \to \textit{PMod}(\mathcal{O})$
(combining restriction and including sheaves into presheaves)
and the sheafification functor of the lemma
${}^\# : \textit{PMod}(\mathcal{O}) \to \textit{Mod}(\mathcal{O}^\#)$
are adjoint. In a formula
$$
\text{Mor}_{\textit{PMod}(\mathcal{O})}(\mathcal{F}, i\mathcal{G})
=
\text{Mor}_{\textit{Mod}(\mathcal{O}^\#)}(\mathcal{F}^\#, \mathcal{G})
$$
An important case happens when $\mathcal{O}$ is already a sheaf of
rings. In this case the formula reads
$$
\text{Mor}_{\textit{PMod}(\mathcal{O})}(\mathcal{F}, i\mathcal{G})
=
\text{Mor}_{\textit{Mod}(\mathcal{O})}(\mathcal{F}^\#, \mathcal{G})
$$
because $\mathcal{O} = \mathcal{O}^\#$ in this case.

\medskip\noindent
Let $\mathcal{C}$ be a site.
Let $\mathcal{O}_1 \to \mathcal{O}_2$ be
a morphism of sheaves of rings on $\mathcal{C}$.
In Section \ref{section-presheaves-modules}
we defined a restriction functor
and a change of rings functor on presheaves of modules
associated to this situation.

\medskip\noindent
If $\mathcal{F}$ is a sheaf of $\mathcal{O}_2$-modules
then the restriction $\mathcal{F}_{\mathcal{O}_1}$
of $\mathcal{F}$ is clearly a sheaf
of $\mathcal{O}_1$-modules. We obtain the restriction functor
$$
\textit{Mod}(\mathcal{O}_2)
\longrightarrow
\textit{Mod}(\mathcal{O}_1)
$$

\medskip\noindent
On the other hand, given a sheaf of $\mathcal{O}_1$-modules
$\mathcal{G}$ the presheaf of $\mathcal{O}_2$-modules
$\mathcal{O}_2 \otimes_{p, \mathcal{O}_1} \mathcal{G}$
is in general not a sheaf. Hence we define the
{\it tensor product sheaf}
$\mathcal{O}_2 \otimes_{\mathcal{O}_1} \mathcal{G}$
by the formula
$$
\mathcal{O}_2 \otimes_{\mathcal{O}_1} \mathcal{G}
=
(\mathcal{O}_2 \otimes_{p, \mathcal{O}_1} \mathcal{G})^\#
$$
as the sheafification of our construction for presheaves.
We obtain the {\it change of rings} functor
$$
\textit{Mod}(\mathcal{O}_1)
\longrightarrow
\textit{Mod}(\mathcal{O}_2)
$$

\begin{lemma}
\label{lemma-adjointness-tensor-restrict}
With $X$, $\mathcal{O}_1$, $\mathcal{O}_2$, $\mathcal{F}$ and
$\mathcal{G}$ as above there exists a canonical bijection
$$
\text{Hom}_{\mathcal{O}_1}(\mathcal{G}, \mathcal{F}_{\mathcal{O}_1})
=
\text{Hom}_{\mathcal{O}_2}(
\mathcal{O}_2 \otimes_{\mathcal{O}_1} \mathcal{G},
\mathcal{F}
)
$$
In other words, the restriction and change of rings functors
are adjoint to each other.
\end{lemma}

\begin{proof}
This follows from
Lemma \ref{lemma-adjointness-tensor-restrict-presheaves}
and the fact that
$\text{Hom}_{\mathcal{O}_2}(
\mathcal{O}_2 \otimes_{\mathcal{O}_1} \mathcal{G},
\mathcal{F}
)
=
\text{Hom}_{\mathcal{O}_2}(
\mathcal{O}_2 \otimes_{p, \mathcal{O}_1} \mathcal{G},
\mathcal{F}
)$
because $\mathcal{F}$ is a sheaf.
\end{proof}




\section{Morphisms of topoi and sheaves of $\mathcal{O}$-modules}
\label{section-sheaves-modules-functorial} 

\noindent
All of this material is completely straightforward.
We formulate everything in the case of morphisms of topoi,
but of course the results also hold in the case of morphisms of sites.

\begin{lemma}
\label{lemma-pushforward-module}
Let $\mathcal{C}$, $\mathcal{D}$ be sites.
Let $f : \textit{Sh}(\mathcal{C}) \to \textit{Sh}(\mathcal{D})$
be a morphism of topoi.
Let $\mathcal{O}$ be a sheaf of rings on $\mathcal{C}$.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}$-modules.
There is a natural map of sheaves of sets
$$
f_*\mathcal{O} \times f_*\mathcal{F}
\longrightarrow
f_*\mathcal{F}
$$
which turns $f_*\mathcal{F}$ into a sheaf of $f_*\mathcal{O}$-modules.
This construction is functorial in $\mathcal{F}$.
\end{lemma}

\begin{proof}
Denote $\mu : \mathcal{O} \times \mathcal{F} \to \mathcal{F}$ the
multiplication map. Recall that $f_*$ (on sheaves of sets) is left exact
and hence commutes with products. Hence $f_*\mu$ is a map as
indicated. This proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-pullback-module}
Let $\mathcal{C}$, $\mathcal{D}$ be sites.
Let $f : \textit{Sh}(\mathcal{C}) \to \textit{Sh}(\mathcal{D})$
be a morphism of topoi.
Let $\mathcal{O}$ be a sheaf of rings on $\mathcal{D}$.
Let $\mathcal{G}$ be a sheaf of $\mathcal{O}$-modules.
There is a natural map of sheaves of sets
$$
f^{-1}\mathcal{O} \times f^{-1}\mathcal{G}
\longrightarrow
f^{-1}\mathcal{G}
$$
which turns $f^{-1}\mathcal{G}$ into a sheaf of $f^{-1}\mathcal{O}$-modules.
This construction is functorial in $\mathcal{G}$.
\end{lemma}

\begin{proof}
Denote $\mu : \mathcal{O} \times \mathcal{G} \to \mathcal{G}$ the
multiplication map. Recall that $f^{-1}$ (on sheaves of sets) is exact
and hence commutes with products. Hence $f^{-1}\mu$ is a map as
indicated. This proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-adjoint-push-pull-modules}
Let $\mathcal{C}$, $\mathcal{D}$ be sites.
Let $f : \textit{Sh}(\mathcal{C}) \to \textit{Sh}(\mathcal{D})$
be a morphism of topoi.
Let $\mathcal{O}$ be a sheaf of rings on $\mathcal{D}$.
Let $\mathcal{G}$ be a sheaf of $\mathcal{O}$-modules.
Let $\mathcal{F}$ be a sheaf of $f^{-1}\mathcal{O}$-modules.
Then
$$
\text{Mor}_{\textit{Mod}(f^{-1}\mathcal{O})}(f^{-1}\mathcal{G}, \mathcal{F})
=
\text{Mor}_{\textit{Mod}(\mathcal{O})}(\mathcal{G}, f_*\mathcal{F}).
$$
Here we use
Lemmas \ref{lemma-pullback-module}
and \ref{lemma-pushforward-module}, and we think of
$f_*\mathcal{F}$ as an $\mathcal{O}$-module by restriction via
$\mathcal{O} \to f_*f^{-1}\mathcal{O}$.
\end{lemma}

\begin{proof}
First we note that we have
$$
\text{Mor}_{\textit{Ab}(\mathcal{C})}(f^{-1}\mathcal{G}, \mathcal{F})
=
\text{Mor}_{\textit{Ab}(\mathcal{D})}(\mathcal{G}, f_*\mathcal{F}).
$$
by Sites,
Proposition \ref{sites-proposition-functoriality-algebraic-structures-topoi}.
Suppose that $\alpha : f^{-1}\mathcal{G} \to \mathcal{F}$ and
$\beta : \mathcal{G} \to f_*\mathcal{F}$ are morphisms of abelian
sheaves which correspond via the formula above. We have to show that
$\alpha$ is $f^{-1}\mathcal{O}$-linear if and only if $\beta$
is $\mathcal{O}$-linear. For example, suppose $\alpha$ is
$f^{-1}\mathcal{O}$-linear, then clearly $f_*\alpha$ is
$f_*f^{-1}\mathcal{O}$-linear, and hence (as restriction is a functor)
is $\mathcal{O}$-linear. Hence it suffices to prove that the
adjunction map $\mathcal{G} \to f_*f^{-1}\mathcal{G}$ is
$\mathcal{O}$-linear. Using that both $f_*$ and $f^{-1}$ commute
with products (on sheaves of sets) this comes down to showing that
$$
\xymatrix{
\mathcal{O} \times \mathcal{G} \ar[r] \ar[d] &
f_*f^{-1}(\mathcal{O} \times \mathcal{G}) \ar[d] \\
\mathcal{G} \ar[r] & f_*f^{-1}\mathcal{G}
}
$$
is commutative. This holds because the adjunction mapping
$\text{id}_{\textit{Sh}(\mathcal{D})} \to f_*f^{-1}$ is a
transformation of functors. We omit the proof of the implication
$\beta$ linear $\Rightarrow$ $\alpha$ linear.
\end{proof}

\begin{lemma}
\label{lemma-adjoint-pull-push-modules}
Let $\mathcal{C}$, $\mathcal{D}$ be sites.
Let $f : \textit{Sh}(\mathcal{C}) \to \textit{Sh}(\mathcal{D})$
be a morphism of topoi.
Let $\mathcal{O}$ be a sheaf of rings on $\mathcal{C}$.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}$-modules.
Let $\mathcal{G}$ be a sheaf of $f_*\mathcal{O}$-modules.
Then
$$
\text{Mor}_{\textit{Mod}(\mathcal{O})}(
\mathcal{O} \otimes_{f^{-1}f_*\mathcal{O}} f^{-1}\mathcal{G}, \mathcal{F})
=
\text{Mor}_{\textit{Mod}(f_*\mathcal{O})}(\mathcal{G}, f_*\mathcal{F}).
$$
Here we use
Lemmas \ref{lemma-pullback-module}
and \ref{lemma-pushforward-module}, and we use
the canonical map $f^{-1}f_*\mathcal{O} \to \mathcal{O}$
in the definition of the tensor product.
\end{lemma}

\begin{proof}
Note that we have
$$
\text{Mor}_{\textit{Mod}(\mathcal{O})}(
\mathcal{O} \otimes_{f^{-1}f_*\mathcal{O}} f^{-1}\mathcal{G}, \mathcal{F})
=
\text{Mor}_{\textit{Mod}(f^{-1}f_*\mathcal{O})}(
f^{-1}\mathcal{G}, \mathcal{F}_{f^{-1}f_*\mathcal{O}})
$$
by Lemma \ref{lemma-adjointness-tensor-restrict}. Hence the result follows
from Lemma \ref{lemma-adjoint-push-pull-modules}.
\end{proof}






\section{Morphisms of ringed topoi and $\mathcal{O}$-modules}
\label{section-functoriality-modules}

\noindent
We have now introduced enough notation so that we are able to
define the pullback and pushforward of modules along a morphism
of ringed topoi.

\begin{definition}
\label{definition-pushforward}
Let
$(f, f^\sharp) :
(\textit{Sh}(\mathcal{C}), \mathcal{O}_{\mathcal{C}})
\to
(\textit{Sh}(\mathcal{D}), \mathcal{O}_{\mathcal{D}})$
be a morphism of ringed topoi or ringed sites.
\begin{enumerate}
\item Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_{\mathcal{C}}$-modules.
We define the {\it pushforward} of $\mathcal{F}$ as the
sheaf of $\mathcal{O}_{\mathcal{D}}$-modules which as a sheaf
of abelian groups equals $f_*\mathcal{F}$ and with
module structure given by the restriction
via $f^\sharp : \mathcal{O}_{\mathcal{D}} \to f_*\mathcal{O}_{\mathcal{C}}$
of the module structure
$$
f_*\mathcal{O}_{\mathcal{C}} \times f_*\mathcal{F}
\longrightarrow
f_*\mathcal{F}
$$
from Lemma \ref{lemma-pushforward-module}.
\item Let $\mathcal{G}$ be a sheaf of $\mathcal{O}_{\mathcal{D}}$-modules.
We define the {\it pullback} $f^*\mathcal{G}$ to be the
sheaf of $\mathcal{O}_{\mathcal{C}}$-modules defined by the formula
$$
f^*\mathcal{F}
=
\mathcal{O}_{\mathcal{C}} \otimes_{f^{-1}\mathcal{O}_{\mathcal{D}}}
f^{-1}\mathcal{F}
$$
where the ring map
$f^{-1}\mathcal{O}_{\mathcal{D}} \to \mathcal{O}_{\mathcal{C}}$
is $f^\sharp$, and where the  module
structure is given by Lemma \ref{lemma-pullback-module}.
\end{enumerate}
\end{definition}

\noindent
Thus we have defined functors
\begin{eqnarray*}
f_* : \textit{Mod}(\mathcal{O}_{\mathcal{C}})
& \longrightarrow &
\textit{Mod}(\mathcal{O}_{\mathcal{D}}) \\
f^* : \textit{Mod}(\mathcal{O}_{\mathcal{D}})
& \longrightarrow &
\textit{Mod}(\mathcal{O}_{\mathcal{C}})
\end{eqnarray*}
The final result on these functors is that they are indeed
adjoint as expected.

\begin{lemma}
\label{lemma-adjoint-pullback-pushforward-modules}
Let
$(f, f^\sharp) :
(\textit{Sh}(\mathcal{C}), \mathcal{O}_{\mathcal{C}})
\to
(\textit{Sh}(\mathcal{D}), \mathcal{O}_{\mathcal{D}})$
be a morphism of ringed topoi or ringed sites.
Let $\mathcal{F}$ be a sheaf of $\mathcal{O}_{\mathcal{C}}$-modules.
Let $\mathcal{G}$ be a sheaf of $\mathcal{O}_{\mathcal{D}}$-modules.
There is a canonical bijection
$$
\text{Hom}_{\mathcal{O}_{\mathcal{C}}}(f^*\mathcal{G}, \mathcal{F})
=
\text{Hom}_{\mathcal{O}_{\mathcal{D}}}(\mathcal{G}, f_*\mathcal{F}).
$$
In other words: the functor $f^*$ is the left adjoint to
$f_*$.
\end{lemma}

\begin{proof}
This follows from the work we did before:
\begin{eqnarray*}
\text{Hom}_{\mathcal{O}_{\mathcal{C}}}(f^*\mathcal{G}, \mathcal{F})
& = &
\text{Mor}_{\textit{Mod}(\mathcal{O}_{\mathcal{C}})}(
\mathcal{O}_{\mathcal{C}}
\otimes_{f^{-1}\mathcal{O}_{\mathcal{D}}} f^{-1}\mathcal{G},
\mathcal{F}) \\
& = &
\text{Mor}_{\textit{Mod}(f^{-1}\mathcal{O}_{\mathcal{D}})}(
f^{-1}\mathcal{G}, \mathcal{F}_{f^{-1}\mathcal{O}_{\mathcal{D}}}) \\
& = &
\text{Hom}_{\mathcal{O}_{\mathcal{D}}}(\mathcal{G}, f_*\mathcal{F}).
\end{eqnarray*}
Here we use Lemmas \ref{lemma-adjointness-tensor-restrict}
and \ref{lemma-adjoint-push-pull-modules}.
\end{proof}

\begin{lemma}
\label{lemma-push-pull-composition-modules}
$(f, f^\sharp) :
(\textit{Sh}(\mathcal{C}_1), \mathcal{O}_1)
\to (\textit{Sh}(\mathcal{C}_2), \mathcal{O}_2)$ and
$(g, g^\sharp) :
(\textit{Sh}(\mathcal{C}_2), \mathcal{O}_2) \to
(\textit{Sh}(\mathcal{C}_3), \mathcal{O}_3)$
be morphisms of ringed topoi.
There are canonical isomorphisms of functors
$(g \circ f)_* \cong g_* \circ f_*$ and
$(g \circ f)^* \cong f^* \circ g^*$.
\end{lemma}

\begin{proof}
This is clear from the definitions.
\end{proof}





\section{The abelian category of sheaves of modules}
\label{section-kernels}

\noindent
Let $(\textit{Sh}(\mathcal{C}), \mathcal{O})$ be a ringed topos.
Let $\mathcal{F}$, $\mathcal{G}$ be sheaves of $\mathcal{O}$-modules, see
Sheaves, Definition \ref{sheaves-definition-sheaf-modules}.
Let $\varphi, \psi : \mathcal{F} \to \mathcal{G}$
be morphisms of sheaves of $\mathcal{O}_X$-modules.
We define $\varphi + \psi : \mathcal{F} \to \mathcal{G}$
to be the sum of $\varphi$ and $\psi$ as morphisms of abelian sheaves.
This is clearly again a map of $\mathcal{O}$-modules.
It is also clear that composition of maps of
$\mathcal{O}$-modules is bilinear with respect to this
addition. Thus $\textit{Mod}(\mathcal{O})$ is a pre-additive
category, see Homology, Definition \ref{homology-definition-preadditive}.

\medskip\noindent
We will denote $0$ the sheaf of $\mathcal{O}$-modules
which has constant value $\{0\}$ for all objects $U$ of $\mathcal{C}$.
Clearly this is both a final and an initial object of
$\textit{Mod}(\mathcal{O})$. Given a morphism
of $\mathcal{O}$-modules $\varphi : \mathcal{F} \to \mathcal{G}$
the following are equivalent:
(a) $\varphi$ is zero, (b) $\varphi$ factors through $0$,
(c) $\varphi$ is zero on sections over each opject $U$.

\medskip\noindent
Moreover, given a pair
$\mathcal{F}$, $\mathcal{G}$ of sheaves of $\mathcal{O}$-modules
we may define the direct sum as
$$
\mathcal{F} \oplus \mathcal{G} = \mathcal{F} \times \mathcal{G}
$$
with obvious maps $(i, j, p, q)$ as in Homology, Definition
\ref{homology-definition-direct-sum}. Thus $\textit{Mod}(\mathcal{O})$
is an additive category, see
Homology, Definition \ref{homology-definition-additive-category}.

\medskip\noindent
Let $\varphi : \mathcal{F} \to \mathcal{G}$ be a morphism
of $\mathcal{O}$-modules. We may define $\text{Ker}(\varphi)$
to be the kernel of $\varphi$ as a map of abelian sheaves.
By Section \ref{section-abelian-sheaves} this is the
subsheaf of $\mathcal{F}$ with sections
$$
\text{Ker}(\varphi)(U) =
\{ s \in \mathcal{F}(U) \mid \varphi(s) = 0 \text{ in } \mathcal{G}(U)\}
$$
for all objects $U$ of $\mathcal{C}$. It is easy to see that this is indeed
a kernel in the category of $\mathcal{O}$-modules. In other words,
a morphism $\alpha : \mathcal{H} \to \mathcal{F}$ factors
through $\text{Ker}(\varphi)$ if and only if $\varphi \circ \alpha = 0$.

\medskip\noindent
Similarly, we define $\text{Coker}(\varphi)$ as the cokernel of
$\varphi$ as a map of abelian sheaves. There is a unique
multiplication map
$$
\mathcal{O} \times \text{Coker}(\varphi) \longrightarrow \text{Coker}(\varphi)
$$
such that the map $\mathcal{G} \to \text{Coker}(\varphi)$ becomes a
morphism of $\mathcal{O}$-modules (verification omitted).
The map $\mathcal{G} \to \text{Coker}(\varphi)$ is surjective
(as a map of sheaves of sets, see Section \ref{section-abelian-sheaves}).
To show that $\text{Coker}(\varphi)$ is a cokernel in
$\textit{Mod}(\mathcal{O})$, note that if
$\beta : \mathcal{G} \to \mathcal{H}$ is a morphism of $\mathcal{O}$-modules
such that $\beta \circ \varphi$ is zero, then you get for every
object $U$ of $\mathcal{C}$ a map induced by $\beta$ from
$\mathcal{G}(U)/\varphi(\mathcal{F}(U))$ into $\mathcal{H}(U)$.
By the universal property of sheafification (see
Sheaves, Lemma \ref{sheaves-lemma-sheafification-presheaf-modules})
we obtain a canonical map $\text{Coker}(\varphi) \to \mathcal{H}$
such that the original $\beta$ is equal to the composition
$\mathcal{G} \to \text{Coker}(\varphi) \to \mathcal{H}$.
The morphism $\text{Coker}(\varphi) \to \mathcal{H}$ is unique
because of the surjectivity mentioned above.

\begin{lemma}
\label{lemma-abelian}
Let $(\textit{Sh}(\mathcal{C}), \mathcal{O})$ be a ringed topos.
The category $\textit{Mod}(\mathcal{O})$ is an abelian category.
The forgetful functor
$\textit{Mod}(\mathcal{O}) \to \textit{Ab}(\mathcal{C})$
is exact, hence kernels, cokernels and exactness of
$\mathcal{O}$-modules, correspond to the corresponding notions
for abelian sheaves.
\end{lemma}

\begin{proof}
Above we have seen that $\textit{Mod}(\mathcal{O})$ is an additive
category, with kernels and cokernels
and that $\textit{Mod}(\mathcal{O}) \to \textit{Ab}(\mathcal{C})$
preserves kernels and cokernels.
By Homology, Definition \ref{homology-definition-abelian-category}
we have to show that image and coimage agree. This is clear
because it is true in $\textit{Ab}(\mathcal{C})$. The lemma follows.
\end{proof}

\begin{lemma}
\label{lemma-limits-colimits}
Let $(\textit{Sh}(\mathcal{C}), \mathcal{O})$ be a ringed topos.
All limits and colimits exist in $\textit{Mod}(\mathcal{O})$, and
the forgetful functor
$\textit{Mod}(\mathcal{O}) \to \textit{Ab}(\mathcal{C})$
commutes with them.
\end{lemma}

\begin{proof}
Let $\mathcal{I} \to \textit{Mod}(\mathcal{C})$, $i \mapsto \mathcal{F}_i$
be a diagram. Let $\text{lim}_i\ \mathcal{F}_i$ be the limit of the diagram
in $\textit{Ab}(\mathcal{C})$. By the description of this limit in
Lemma \ref{lemma-limits-colimits-abelian-sheaves} we see immediately that
there exists a multiplication
$$
\mathcal{O} \times \text{lim}_i\ \mathcal{F}_i
\longrightarrow
\text{lim}_i\ \mathcal{F}_i
$$
which turns $\text{lim}_i\ \mathcal{F}_i$ into a sheaf of
$\mathcal{O}$-modules. It is easy to see that this is the
limit of the diagram in $\textit{Mod}(\mathcal{C})$. Let
$\text{colim}_i\ \mathcal{F}_i$ be the colimit of the diagram
in $\textit{PAb}(\mathcal{C})$. By the description of this colimit
in the proof of Lemma \ref{lemma-limits-colimits-abelian-presheaves}
we see immediately that there exists a multiplication
$$
\mathcal{O} \times \text{colim}_i\ \mathcal{F}_i
\longrightarrow
\text{colim}_i\ \mathcal{F}_i
$$
which turns $\text{colim}_i\ \mathcal{F}_i$ into a presheaf of
$\mathcal{O}$-modules. Applying sheafification we get a
sheaf of $\mathcal{O}$-modules $(\text{colim}_i\ \mathcal{F}_i)^\#$,
see Lemma \ref{lemma-sheafification-presheaf-modules}.
It is easy to see that $(\text{colim}_i\ \mathcal{F}_i)^\#$
is the colimit of the diagram in $\textit{Mod}(\mathcal{C})$, and
by Lemma \ref{lemma-limits-colimits-abelian-sheaves}
forgetting the $\mathcal{O}$-module structure is
the colimit in $\textit{Ab}(\mathcal{C})$.
\end{proof}

\noindent
The existence of limits and colimits allows us to consider exactness
properties of functors defined on the category of $\mathcal{O}$-modules
in terms of limits and colimits, as in
Categories, Section \ref{categories-section-exact-functor}.
See Homology, Lemma \ref{homology-lemma-exact-functor} for a description of
exactness properties in terms of short exact sequences.

\begin{lemma}
\label{lemma-exactness-pushforward-pullback}
Let $f : (\textit{Sh}(\mathcal{C}), \mathcal{O}_{\mathcal{C}})
\to (\textit{Sh}(\mathcal{D}), \mathcal{O}_{\mathcal{D}})$
be a morphism of ringed topoi.
\begin{enumerate}
\item The functor $f_*$ is left exact. In fact it commutes with
all limits.
\item The functor $f^*$ is right exact. In fact it commutes
with all colimits.
\end{enumerate}
\end{lemma}

\begin{proof}
This is true because $(f^*, f_*)$ is an adjoint pair
of functors, see
Lemma \ref{lemma-adjoint-pullback-pushforward-modules}.
See Categories, Section \ref{categories-section-adjoint}.
\end{proof}








\section{Free modules}
\label{section-free}

\begin{definition}
\label{definition-free}
Let $(\textit{Sh}(\mathcal{C}), \mathcal{O})$ be a ringed topos.
A {\it free $\mathcal{O}$-module} is any sheaf of $\mathcal{O}$-modules
of the form $\bigoplus_{i \in I} \mathcal{O}$.
A free module is called {\it finite free} if the index set $I$ can
be chosen to be finite.
\end{definition}

\noindent
Note that for any set $I$ this direct sum exists
(Lemma \ref{lemma-limits-colimits})
and is the sheafification of the presheaf
$U \mapsto \bigoplus_{i \in I} \mathcal{O}(U)$.





\section{Localization}
\label{section-localization}

\noindent








\section{Quasi-coherent modules}
\label{section-quasi-coherent}

\noindent
In this section we introduce an abstract notion of
quasi-coherent $\mathcal{O}$-module. This notion is very
useful in algebraic geometry, since quasi-coherent modules
on the big fppf site $(\textit{Sch}/S)_{fppf}$ of a scheme for example,
have a good description (and correspond to quasi-coherent sheaves on $S$).
However, we warn the reader that
in the general setting of ringed sites/topoi/spaces
this notion is not well behaved at all. The caterory of
quasi-coherent sheaves is not abelian in general, infinite
direct sums of quasi-coherent sheaves aren't quasi-coherent, etc, etc.

\begin{definition}
\label{definition-quasi-coherent}
Let $(\mathcal{C}, \mathcal{O})$ be a ringed site.
A sheaf of $\mathcal{O}$-modules $\mathcal{F}$ is called
{\it quasi-coherent} if for every object $U$ of $\mathcal{C}$
there exists a covering $\{U_i \to U\}_{i \in I}$ such
that each restriction
$$
\mathcal{F}|_{\mathcal{C}/U_i}
$$
is isomorphic to a cokernel of a map between free
$\mathcal{O}|_{\mathcal{C}/U_i}$-modules.
\end{definition}

\noindent
In other words, for every $i \in I$ there exist sets $J$, $K$
and an exact sequence
$$
\bigoplus\nolimits_{k \in K} \mathcal{O}
\longrightarrow
\bigoplus\nolimits_{k \in K} \mathcal{O}
\longrightarrow
\mathcal{F}|_U
\longrightarrow
0
$$










\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
