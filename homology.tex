\input{preamble}

% OK, start here.
%
\begin{document}

\title{Homological Algebra}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
Basic homological algebra will be explained in this document.
We add as needed in the other parts, since there is clearly
an infinite amount of this stuff around.
A reference is \cite{Maclane}.

\section{Basic notions}
\label{section-topology-basic}

\noindent
The following notions are considered basic and will not be defined,
and or proved. This does not mean they are all necessarily easy or
well known.

\begin{enumerate}
\item Nothing yet.
\end{enumerate}


\section{Abelian categories}
\label{section-abelian-categories}

\noindent
An abelian category will be a category satisfying
just enough axioms so the snake lemma holds.

\begin{definition}
\label{definition-preadditive}
A category $\mathcal{A}$ is called {\it preadditive} if each
morphism set $\text{Mor}_{\mathcal{A}}(x, y)$ is endowed
with the structure of an abelian group such that the
compositions
$$
\text{Mor}(x, y) \times \text{Mor}(y, z)
\longrightarrow
\text{Mor}(x, z)
$$
are bilinear. A functor $F : \mathcal{A} \to \mathcal{B}$ of
preadditive categories is called {\it additive} if and only
if $F : \text{Mor}(x, y) \to \text{Mor}(F(x), F(y))$
is a homomorphism of abelian groups for all
$x, y \in \text{Ob}(\mathcal{A})$.
\end{definition}

\noindent
In particular for every $x, y$ there exists at least
one morphism $x \to y$, namely the zero map.

\begin{lemma}
\label{lemma-preadditive-zero}
Let $\mathcal{A}$ be a preadditive category.
Let $x$ be an object of $\mathcal{A}$.
The following are equivalent
\begin{enumerate}
\item $x$ is an initial object,
\item $x$ is a final object, and
\item $\text{id}_x = 0$ in $\text{Mor}_{\mathcal{A}}(x, x)$.
\end{enumerate}
Furthermore, if such an object $0$ exists, then a morphism
$\alpha : x \to y$ factors through $0$ if and only if $\alpha = 0$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-zero-object}
In a preadditive category $\mathcal{A}$ we call
{\it zero object}, and we denote it $0$
any final and initial object as in Lemma \ref{lemma-preadditive-zero} above.
\end{definition}

\begin{lemma}
\label{lemma-preadditive-direct-sum}
Let $\mathcal{A}$ be a preadditive category.
Let $x, y \in \text{Ob}(\mathcal{A})$.
If the product $x \times y$ exists, then so does
the coproduct $x \coprod y$.
If the coproduct $x \coprod y$ exists, then so does
the product $x \times y$. In this case
also $x \coprod y \cong x \times y$.
\end{lemma}

\begin{proof}
Suppose that $z = x \times y$ with projections
$p : z \to x$ and $q : z \to y$. Denote $i : x \to z$
the morphism corresponding to $(1, 0)$. Denote $j : y \to z$
the morphism corresponding to $(0, 1)$. Thus we have the
commutative diagram
$$
\xymatrix{
x \ar[rr]^1 \ar[rd]^i & & x \\
& z \ar[ru]^p \ar[rd]^q & \\
y \ar[rr]^1 \ar[ru]^j & & y
}
$$
where the diagonal compositions are zero. It follows that
$i \circ p + j \circ q : z \to z$ is the identity since
it is a morphism which upon composing with $p$ gives $p$
and upon composing with $q$ gives $q$.
Suppose given morphisms $a : x \to w$ and $b : y \to w$.
Then we can form the map $a \circ p + b \circ q : z \to w$.
In this way we get a bijection $\text{Mor}(z, w)
= \text{Mor}(x, w) \times \text{Mor}(y, w)$ which
show that $z = x \coprod y$.

\medskip\noindent
We leave it to the reader to construct the morphisms
$p, q$ given a coproduct $x \coprod y$ instead of a
product.
\end{proof}

\begin{definition}
\label{definition-direct-sum}
Given a pair of objects $x, y$
in a preadditive category $\mathcal{A}$ we call
{\it direct sum}, and we denote it $x \oplus y$ the
product $x \times y$ endowed with the morphisms
$i, j, p, q$ as in Lemma \ref{lemma-preadditive-direct-sum} above.
\end{definition}

\begin{remark}
\label{remark-direct-sum}
Note that the proof of Lemma \ref{lemma-preadditive-direct-sum}
shows that given $p$ and $q$ the morphisms $i$, $j$ are uniquely
determined by the rules $p \circ i = \text{id}_x$,
$q \circ j = \text{id}_y$, $p \circ j = 0$, $q \circ i = 0$.
Moreover, we automatically have
$i \circ p + j \circ q = \text{id}_{x \oplus y}$.
Similarly, given $i$, $j$ the morphisms $p$ and $q$ are uniquely determined.
Finally, given objects $x, y, z$ and morphisms
$i : x \to z$, $j : y \to z$, $p : z \to x$ and
$q : z \to y$ such that $p \circ i = \text{id}_x$,
$q \circ j = \text{id}_y$, $p \circ j = 0$, $q \circ i = 0$
and $i \circ p + j \circ q = \text{id}_{z}$, then $z$
is the direct sum of $x$ and $y$ with the four morphisms
equal to $i, j, p, q$.
\end{remark}

\begin{lemma}
\label{lemma-additive-additive}
Let $\mathcal{A}$, $\mathcal{B}$ be preadditive categories.
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor.
Then $F$ transforms direct sums to direct sums and zero to zero.
\end{lemma}

\begin{proof}
Suppose $F$ is additive. A direct sum $z$
of $x$ and $y$ is characterized by having morphisms
$i : x \to z$, $j : y \to z$, $p : z \to x$ and
$q : z \to y$ such that $p \circ i = \text{id}_x$,
$q \circ j = \text{id}_y$, $p \circ j = 0$, $q \circ i = 0$
and $i \circ p + j \circ q = \text{id}_{z}$, according
to Remark \ref{remark-direct-sum}. Clearly $F(x), F(y), F(z)$
and the morphisms $F(i), F(j), F(p), F(q)$ satisfy exactly the
same relations (by additivity) and we see that $F(z)$ is
a direct sum of $F(x)$ and $F(y)$.
\end{proof}

\begin{definition}
\label{definition-additive-category}
A category $\mathcal{A}$ is called {\it additive}
if it is preadditive and finite products exist, in other
words it has a zero object and direct sums.
\end{definition}

\noindent
Namely the empty product is a finite product and
if it exists, then it is a final object.

\begin{definition}
\label{definition-kernel}
Let $\mathcal{A}$ be a preadditive category.
Let $f : x \to y$ be a morphism.
\begin{enumerate}
\item A {\it kernel} of $f$ is a morphism
$i : z \to x$ such that (a) $f \circ i = 0$ and (b)
for any $i' : z' \to x$ such that $f \circ i' = 0$ there
exists a unique morphism $g : z' \to z$ such that
$i' = i \circ g$.
\item If the kernel of $f$ exists, then we denote
this $\text{Ker}(f) \to x$.
\item A {\it cokernel} of $f$ is a morphism
$p : y \to z$ such that (a) $p \circ f = 0$ and (b)
for any $p' : y \to z'$ such that $p' \circ f = 0$ there
exists a unique morphism $g : z \to z'$ such that
$p' = g \circ p$.
\item If a cokernel of $f$ exists we denote this
$y \to \text{Coker}(f)$.
\item If a kernel of $f$ exists, then a {\it coimage
of $f$} is a cokernel for the morphism $\text{Ker}(f) \to x$.
\item If a kernel and coimage exist then we denote this
$x \to \text{Coim}(f)$.
\item If a cokernel of $f$ exists, then the {\it image of
$f$} is a kernel of the morphism $y \to \text{Coker}(f)$.
\item If a cokernel and image of $f$ exist then we denote
this $\text{Im}(f) \to y$.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-coim-im-map}
Let $f : x \to y$ be a morphism in a preadditive category
such that the kernel, cokernel, image and coimage all exist.
Then $f$ can be factored uniquely as
$x \to \text{Coim}(f) \to \text{Im}(f) \to y$.
\end{lemma}

\begin{proof}
There is a canonical morphism $\text{Coim}(f) \to y$
because $\text{Ker}(f) \to x \to y$ is zero.
The composition $\text{Coim}(f) \to y \to \text{Coker}(f)$
is zero, because it is the unique morphism which gives
rise to the morphism $x \to y \to \text{Coker}(f)$ which
is zero. Hence $\text{Coim}(f) \to y$ factors uniquely through
$\text{Im}(f) \to y$, which gives us the desired map.
\end{proof}

\begin{example}
\label{example-not-abelian}
Let $k$ be a field.
Consider the category
of filtered vector spaces over $k$.
(See Definition \ref{definition-filtered}.)
Consider the filtered vector spaces $(V, F)$ and $(W, F)$ with
$V = W = k$ and
$$
F^iV
=
\left\{
\begin{matrix}
V & \text{if} & i < 0 \\
0 & \text{if} & i \geq 0
\end{matrix}
\right.
\text{ and }
F^iW
=
\left\{
\begin{matrix}
W & \text{if} & i \leq 0 \\
0 & \text{if} & i > 0
\end{matrix}
\right.
$$
The map $f : V \to W$ corresponding to $\text{id}_k$ on the underlying
vector spaces has trivial kernel and cokernel but is not
an isomorphism. Note also that $\text{Coim}(f) = V$ and $\text{Im}(f) = W$.
This means that the category of filtered vector spaces over $k$
is not abelian.
\end{example}

\begin{definition}
\label{definition-abelian-category}
A category $\mathcal{A}$ is {\it abelian} if
it is additive, if all kernels and cokernels exist,
and if the natural map $\text{Coim}(f) \to \text{Im}(f)$
is an isomorphism for all morphisms $f$ of
$\mathcal{A}$.
\end{definition}

\begin{lemma}
\label{lemma-abelian-opposite}
Let $\mathcal{A}$ be a preadditive category.
The additions on sets of morphisms make
$\mathcal{A}^{opp}$ into a preadditive category.
Furthermore, $\mathcal{A}$ is additive if and only if $\mathcal{A}^{opp}$
is additive, and
$\mathcal{A}$ is abelian if and only if $\mathcal{A}^{opp}$ is abelian.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-injective-surjective}
Let $f : x \to y$ be a morphism in an abelian category.
\begin{enumerate}
\item We say $f$ is {\it injective} if $\text{Ker}(f) = 0$.
\item We say $f$ is {\it surjective} if $\text{Coker}(f) = 0$.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-characterize-injective}
Let $f : x \to y$ be a morphism in an abelian category. Then
\begin{enumerate}
\item $f$ is injective if and only if $f$ is a monomorphism, and
\item $f$ is surjective if and only if $f$ is an epimorphism.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
In an abelian category, if $K \subset M$ is a subobject,
then we denote
$$
M/K = \text{Coker}(K \to M).
$$

\begin{lemma}
\label{lemma-colimit-abelian-category}
Let $\mathcal{A}$ be an abelian category.
All finite limits and finite colimits exist in $\mathcal{A}$.
\end{lemma}

\begin{proof}
To show that finite limits exist it suffices to show
that finite products and equalizers exist, see
Categories, Lemma \ref{categories-lemma-finite-limits-exist}.
Finite products exist
by definition and the equalizer of $a, b : x \to y$ is
the kernel of $a - b$. The argument for finite colimits
is similar but dual to this.
\end{proof}

\begin{example}
\label{example-fibre-product-pushouts}
Let $\mathcal{A}$ be an abelian category.
Pushouts and fibre products in $\mathcal{A}$ have the following
simple descriptions:
\begin{enumerate}
\item If $a : x \to y$, $b : z \to y$ are morphisms in $\mathcal{A}$, then
we have the fibre product:
$x \times_y z = \text{Ker}((a, -b) : x \oplus z \to y)$.
\item If $a : y \to x$, $b : y \to z$ are morphisms in $\mathcal{A}$, then
we have the pushout:
$x \amalg_y z = \text{Coker}((a, -b) : y \to x \oplus z)$.
\end{enumerate}
\end{example}

\begin{definition}
\label{definition-exact}
Let $\mathcal{A}$ be an additive category.
We say a sequence of morphisms
$$
\ldots \to x \to y \to z \to \ldots
$$
in $\mathcal{A}$
is a {\it complex} if the composition of any two (drawn)
arrows is zero. If $\mathcal{A}$ is abelian then
we say a sequence as above is {\it exact at $y$} if
$\text{Im}(x \to y) = \text{Ker}(y \to z)$. We say it is {\it exact}
if it is exact at every object. A {\it short exact sequence}
is an exact complex of the form
$$
0 \to A  \to B \to C \to 0.
$$
\end{definition}

\noindent
In the following lemma we asssume the reader knows what it means
for a sequence of abelian groups to be exact.

\begin{lemma}
\label{lemma-check-exactness}
Let $\mathcal{A}$ be an abelian category.
Let $0 \to M_1 \to M_2 \to M_3 \to 0$ be a complex of $\mathcal{A}$.
\begin{enumerate}
\item $M_1 \to M_2 \to M_3 \to 0$ is exact if and only if
$$
0 \to \text{Hom}_\mathcal{A}(M_3, N) \to
\text{Hom}_\mathcal{A}(M_2, N) \to \text{Hom}_\mathcal{A}(M_1, N)
$$
is an exact sequence of abelian groups for all objects $N$ of
$\mathcal{A}$, and
\item $0 \to M_1 \to M_2 \to M_3$ is exact if and only if
$$
0 \to \text{Hom}_\mathcal{A}(N, M_1) \to \text{Hom}_\mathcal{A}(N, M_2) \to
\text{Hom}_\mathcal{A}(N, M_1)
$$
is an exact sequence of abelian groups for all objects $N$ of $\mathcal{A}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted. Hint: See
Algebra, Lemma \ref{algebra-lemma-hom-exact}.
\end{proof}

\begin{definition}
\label{definition-ses-split}
Let $\mathcal{A}$ be an abelian category.
Let $i : A \to B$ and $q : B \to C$ be morphisms
of $\mathcal{A}$ such that
$0 \to A \to B \to C \to 0$ is a short
exact sequence. We say the short exact
sequence is {\it split} if there exist
morphisms $j : C \to B$ and $p : B \to A$ such
that $(B, i, j, p, q)$ is the direct sum of $A$ and $C$.
\end{definition}

\begin{lemma}
\label{lemma-ses-split}
Let $\mathcal{A}$ be an abelian category.
Let $0 \to A \to B \to C \to 0$
be a short exact sequence.
\begin{enumerate}
\item Given a morphism $s : C \to B$ left inverse to
$B \to C$, there exists a unique $\pi : B \to A$
such that $(s, \pi)$ splits the short exact sequence
as in Definition \ref{definition-ses-split}.
\item Given a morphism $\pi : B \to A$ right inverse to
$A \to B$, there exists a unique $s : C \to B$
such that $(s, \pi)$ splits the short exact sequence
as in Definition \ref{definition-ses-split}.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-epimorphism-universal-abelian-category}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item If $x \to y$ is surjective, then for every $z \to y$ the
projection $z \times_y z \to z$ is surjective.
\item If $x \to y$ is injective, then for every $x \to z$ the
morpism $z \to z \amalg_x y$ is injective.
\end{enumerate}
\end{lemma}

\begin{proof}
We prove (1). Assume $a : x \to y$ surjective and $b : z \to y$ arbitrary.
Let $c : z \to t$ be a morphism of $\mathcal{A}$ such that
$z \times_y z \to z \to t$ is zero. Note that
$$
0 \to x \times_y z \to x \oplus z \to y \to 0
$$
is a short exact sequence, use
Example \ref{example-fibre-product-pushouts}
and the fact that $a$ is surjective.
Consider the map $\tilde c = (0, c) : x \oplus z \to t$.
By assumption the composition
$x \times_y z \to x \oplus z \to t$ is zero hence we
see that $\tilde c$ can be factored as
$x \oplus z \to y \to t$ for some morphism $c' : y \to t$, see
Lemma \ref{lemma-check-exactness}.
This means that $c = c' \circ b$ and that $0 = c' \circ a$.
As $a$ is surjective we conclude that $c' = 0$, hence $c = 0$ as desired.

\medskip\noindent
The proof of (2) is dual to the proof of (1) and is omitted.
\end{proof}

\begin{lemma}
\label{lemma-snake}
Let $\mathcal{A}$ be an abelian category.
Suppose given a commutative diagram
$$
\xymatrix{
& x \ar[r] \ar[d]^\alpha &
y \ar[r] \ar[d]^\beta &
z \ar[r] \ar[d]^\gamma &
0 \\
0 \ar[r] & u \ar[r] & v \ar[r] & w
}
$$
with exact rows, then there is a canonical exact sequence
$$
\text{Ker}(\alpha) \to \text{Ker}(\beta) \to \text{Ker}(\gamma)
\to
\text{Coker}(\alpha) \to \text{Coker}(\beta) \to \text{Coker}(\gamma)
$$
Moreover, if $x \to y$ is injective, then the first map is
injective, and if $v \to w$ is surjective, then the last
map is surjective.
\end{lemma}

\begin{proof}
Omitted. Let us sketch the construction of the map
$\delta : \text{Ker}(\gamma) \to \text{Coker}(\alpha)$ is.
Let $T \in \text{Ob}(\mathcal{A})$. Consider
a morphism $a : T \to z$ with $\gamma \circ a = 0$.
In other words $a$ maps $T$ into $\text{Ker}(\gamma)$.
We have to construct $\delta \circ a : T \to \text{Coker}(\alpha)$.
Because $y \to z$ is surjective, the fibre product
$T' = T\times_z y$ surjects onto $T$, see
Lemma \ref{lemma-epimorphism-universal-abelian-category}.
Denote $a' : T' \to y$ the second projection. Consider
the morphism $\beta \circ a' : T' \to v$.
Composing this morphism with $v \to w$ gives the
same morphism as the composition $T' \to T \to z \to w$
in other words, it gives the zero morphism.
Because $u \to v$ is the kernel of $v \to w$ we conclude
that $a'$ factors through a morphism $a'' : T' \to u$.
Note that the kernel $T''$ of $T' \to T$ maps to
zero under the composition $T' \to y \to z$, and
hence maps into $\text{Im}(x \to y)$. Thus
$a''|_{T''} : T'' \to u$ maps into the image
of $\alpha$. We conclude that there exists a
factorization
$$
\xymatrix{
T' \ar[rr]_-{a''} \ar[d]_{\text{pr}_1} & &
u \ar[d] \\
T \ar[rr]^-{\delta \circ a} & &
\text{Coker}(\alpha)
}
$$
which gives the desired map $\delta \circ a : T \to \text{Coker}(\alpha)$.
\end{proof}

\begin{lemma}
\label{lemma-four-lemma}
Let $\mathcal{A}$ be an abelian category. Let
$$
\xymatrix{
w \ar[r] \ar[d]^\alpha & x \ar[r] \ar[d]^\beta & y \ar[r] \ar[d]^\gamma &
z \ar[d]^\delta \\
w' \ar[r] & x' \ar[r] & y' \ar[r] & z'
}
$$
be a commutative diagram with exact rows.
\begin{enumerate}
\item If $\alpha, \gamma$ are surjective and $\delta$ is injective, then
$\beta$ is surjective.
\item If $\beta, \delta$ are injective and $\alpha$ is surjective, then
$\gamma$ is injective.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume $\alpha, \gamma$ are surjective and $\delta$ is injective.
We may replace $w'$ by $\text{Im}(w' \to x')$, i.e., we may assume
that $w' \to x'$ is injective.
We may replace $z$ by $\text{Im}(y \to z)$, i.e., we may assume that
$y \to z$ is surjective. Then we may apply
Lemma \ref{lemma-snake}
to
$$
\xymatrix{
& \text{Ker}(y \to z) \ar[r] \ar[d] & y \ar[r] \ar[d] & z \ar[r] \ar[d] & 0 \\
0 \ar[r] & \text{Ker}(y' \to z') \ar[r] & y' \ar[r] & z'
}
$$
to conclude that $\text{Ker}(y \to z) \to \text{Ker}(y' \to z')$ is
surjective. Finally, we apply
Lemma \ref{lemma-snake}
to
$$
\xymatrix{
& w \ar[r] \ar[d] & x \ar[r] \ar[d] & \text{Ker}(y \to z) \ar[r] \ar[d] & 0 \\
0 \ar[r] & w' \ar[r] & x' \ar[r] & \text{Ker}(y' \to z')
}
$$
to conclude that $x \to x'$ is surjective. This proves (1). The proof
of (2) is dual to this.
\end{proof}

\begin{lemma}
\label{lemma-five-lemma}
Let $\mathcal{A}$ be an abelian category. Let
$$
\xymatrix{
v \ar[r] \ar[d]^\alpha &
w \ar[r] \ar[d]^\beta &
x \ar[r] \ar[d]^\gamma &
y \ar[r] \ar[d]^\delta &
z \ar[d]^\epsilon \\
v' \ar[r] & w' \ar[r] & x' \ar[r] & y' \ar[r] & z'
}
$$
be a commutative diagram with exact rows. If $\beta, \delta$
are isomorphisms, $\epsilon$ is injective, and $\alpha$ is surjective
then $\gamma$ is an isomorphism.
\end{lemma}

\begin{proof}
Immediate consequence of
Lemma \ref{lemma-four-lemma}.
\end{proof}








\section{Extensions}
\label{section-extensions}

\begin{definition}
\label{definition-extension}
Let $\mathcal{A}$ be an abelian category.
Let $A, C \in \text{Ob}(\mathcal{A})$.
An {\it extension $E$ of $B$ by $A$} is a short
exact sequence
$$
0 \to A \to E \to B \to 0.
$$
\end{definition}

\noindent
By abuse of language we often omit mention of the
morphisms $A \to E$ and $E \to B$, allthough they are
definitively part of the structure of an extension.

\begin{definition}
\label{definition-ext-group}
Let $\mathcal{A}$ be an abelian category.
Let $A, C \in \text{Ob}(\mathcal{A})$.
The set of isomorphism classes of extensions
of $B$ by $A$ is denoted
$$
\text{Ext}_\mathcal{A}(B, A).
$$
This is called the {\it $\text{Ext}$-group}.
\end{definition}

\noindent
This definition works, because by our conventions
$\mathcal{A}$ is a set, and hence
$\text{Ext}_\mathcal{A}(B, A)$ is a set.
In any of the cases of ``big'' abelian categories
listed in Categories, Remark \ref{categories-remark-big-categories}.
one can check by hand that $\text{Ext}_\mathcal{A}(B, A)$
is a set as well. Also, we will see later that this is
always the case when $\mathcal{A}$ has either enough projectives
or enough injectives. Insert future reference here.

\medskip\noindent
Actually we can turn $\text{Ext}_\mathcal{A}(-, -)$ into a
functor
$$
\mathcal{A}^{opp} \times \mathcal{A} \longrightarrow \textit{Sets}, \ 
(A, B) \longmapsto \text{Ext}_\mathcal{A}(A, B)
$$
as follows:
\begin{enumerate}
\item Given a morphism $B' \to B$ and an extension
$E$ of $B$ by $A$ we define $E' = E \times_B B'$
so that we have the following commutative diagram
of short exact sequences
$$
\xymatrix{
0 \ar[r] & A \ar[r] \ar[d] & E' \ar[r] \ar[d] & B' \ar[r] \ar[d] & 0 \\
0 \ar[r] & A \ar[r] & E \ar[r] & B \ar[r] & 0
}
$$
The extension $E'$ is called the {\it pullback of $E$ via
$B' \to B$}.
\item Given a morphism $A \to A'$ and an extension
$E$ of $B$ by $A$ we define $E' = A' \coprod_A E$
so that we have the following commutative diagram
of short exact sequences
$$
\xymatrix{
0 \ar[r] & A \ar[r] \ar[d] & E \ar[r] \ar[d] & B \ar[r] \ar[d] & 0 \\
0 \ar[r] & A' \ar[r] & E' \ar[r] & B \ar[r] & 0
}
$$
The extension $E'$ is called the {\it pushout of $E$ via
$A \to A'$}.
\end{enumerate}
To see that this defines a functor as indicated above
there are several things to verify. First of all
functoriality in the variable $B$ requires that
$(E \times_B B') \times_{B'} B'' = E \times_B B''$
which is a general property of fibre products.
Dually one deals with functoriality in the
variable $A$. Finally, given $A \to A'$ and
$B' \to B$ we have to show that
$$
A' \coprod\nolimits_A (E \times_B B')
\cong
(A' \coprod\nolimits_A E)\times_B B'
$$
as extensions of $B'$ by $A'$. Recall that $A' \coprod_A E$
is a quotient of $A' \oplus E$.
Thus the right hand side is a quotient of
$A' \oplus E \times_B B'$, and it is straightforward to see that
the kernel is exactly what you need in order to
get the left hand side.

\medskip\noindent
Note that if $E_1$ and $E_2$ are extensions of
$B$ by $A$, then $E_1\oplus E_2$ is an extension
of $B \oplus B$ by $A\oplus A$. We pull back by
the diagonal map $B \to B \oplus B$ and we push
out by the sum map $A \oplus A \to A$ to get
an extension $E_1 + E_2$ of $B$ by $A$.
$$
\xymatrix{
0 \ar[r] &
A \oplus A \ar[r] \ar[d]^{\sum} &
E_1 \oplus E_2 \ar[r] \ar[d] &
B \oplus B \ar[r] \ar[d] &
0 \\
0 \ar[r] &
A \ar[r] &
E' \ar[r] &
B \oplus B \ar[r] &
0\\
0 \ar[r] &
A \ar[r] \ar[u] &
E_1 + E_2 \ar[r] \ar[u] &
B \ar[r] \ar[u]^{\Delta} &
0
}
$$
The extension $E_1 + E_2$ is called the {\it Baer sum} of the
given extensions.

\begin{lemma}
\label{lemma-baer-sum}
The construction $(E_1, E_2) \mapsto E_1 + E_2$
above defines a commutative group
law on $\text{Ext}_\mathcal{A}(B, A)$ which is
functorial in both variables.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-six-term-sequence-ext}
Let $\mathcal{A}$ be an abelian category.
Let $0 \to M_1 \to M_2 \to M_3 \to 0$ be a short exact sequence
in $\mathcal{A}$.
\begin{enumerate}
\item There is a canonical six term exact sequence of abelian groups
$$
\xymatrix{
0 \ar[r] &
\text{Hom}_\mathcal{A}(M_3, N) \ar[r] &
\text{Hom}_\mathcal{A}(M_2, N) \ar[r] &
\text{Hom}_\mathcal{A}(M_1, N) \ar[lld] \\
& \text{Ext}_\mathcal{A}(M_3, N) \ar[r] &
\text{Ext}_\mathcal{A}(M_2, N) \ar[r] &
\text{Ext}_\mathcal{A}(M_1, N)
}
$$
for all objects $N$ of $\mathcal{A}$, and
\item there is a canonical six term exact sequence of abelian groups
$$
\xymatrix{
0 \ar[r] &
\text{Hom}_\mathcal{A}(N, M_1) \ar[r] &
\text{Hom}_\mathcal{A}(N, M_2) \ar[r] &
\text{Hom}_\mathcal{A}(N, M_1) \ar[lld] \\
& \text{Ext}_\mathcal{A}(N, M_1) \ar[r] &
\text{Ext}_\mathcal{A}(N, M_2) \ar[r] &
\text{Ext}_\mathcal{A}(N, M_1)
}
$$
for all objects $N$ of $\mathcal{A}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted. Hint: The boundary maps are defined by using either push out
or pull back of the given short exact sequence.
\end{proof}






\section{Additive functors}
\label{section-functors}

\noindent
Recall that we defined, in
Categories, Definition \ref{categories-definition-exact}
the notion of a ``right exact'', ``left exact'' and
``exact'' functor in the setting of a functor between
categories that have finite (co)limits. Thus this
applies in particular to functors between abelian
categories.

\begin{lemma}
\label{lemma-exact-functor}
Let $\mathcal{A}$ and $\mathcal{B}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$ be a functor.
\begin{enumerate}
\item If $F$ is either left or right exact, then it is additive.
\item If $F$ is additive then it is left exact if and only if
for every short exact sequence
$0 \to A \to B \to C \to 0$
the sequence $0 \to F(A) \to F(B) \to F(C)$
is exact.
\item If $F$ is additive then it is right exact if and only if
for every short exact sequence
$0 \to A \to B \to C \to 0$
the sequence $F(A) \to F(B) \to F(C) \to 0$
is exact.
\item If $F$ is additive then it is exact if and only if
for every short exact sequence
$0 \to A \to B \to C \to 0$
the sequence $0 \to F(A) \to F(B) \to F(C) \to 0$
is exact.
\end{enumerate}
\end{lemma}

\begin{proof}
Let us first note that if $F$ commutes with the empty limit or
the empty colimits, then $F(0) = 0$. In particular $F$ applied
to the zero morphism is zero. We will use this below without mention.

\medskip\noindent
Moreover, suppose that $F$ commutes with finite limits.
Then $F(A \times A) = F(A) \times F(A)$ with
projections $F(p)$ and $F(q)$. Hence
$F(A \oplus A) = F(A) \oplus F(A)$ with all
four morphisms $F(i), F(j), F(p), F(q)$ equal to their
counterparts in $\mathcal{B}$ as they satisfy the same
relations, see Remark \ref{remark-direct-sum}.
Then $f = F(p + q)$ is a morphism $f : F(A) \oplus F(A) \to F(A)$
such that $f \circ F(i) = F(p \circ i + q \circ i) = F(\text{id}_A)
= \text{id}_{F(A)}$. And similarly $f \circ F(j) = \text{id}_A$.
We conclude that $F(p + q) = F(p) + F(q)$. For
any pair of morphisms $a, b : B \to A$ the map
$g = F(i \circ a + j \circ b) : F(B) \to F(A) \oplus F(A)$
is a morphism such that $F(p) \circ g =
F(p \circ (i \circ a + j \circ b)) = F(a)$ and similarly
$F(q) \circ g = F(b)$. Hence $g = F(i) \circ F(a) + F(j) \circ F(b)$.
The sum of $a$ and $b$ is the composition
$$
\xymatrix{
B \ar[rr]^-{i \circ a + j \circ b} & &
A \oplus A \ar[r]^-{p + q} & A.
}
$$
Applying $F$ we get
$$
\xymatrix{
F(B) \ar[rrr]^-{F(i) \circ F(a) + F(j) \circ F(b)} & & &
F(A) \oplus F(A) \ar[rr]^-{F(p) + F(q)} & &
A.
}
$$
where we used the expressions for $f$ and $g$ obtained above.
Hence $F$ is additive.\footnote{I'm sure there is an infinitely
slicker proof of this.}

\medskip\noindent
Denote $f : B \to C$ a map from $B$ to $C$.
Exactness of $0 \to A \to B \to C$ just means that
$A = \text{Ker}(f)$. Clearly the kernel of $f$ is
the equalizer of the two maps $f$ and $0$ from $B$ to $C$.
Hence if $F$ commutes with limits, then $F(\text{Ker}(f))
= \text{Ker}(F(f))$ which exactly means that
$0 \to F(A) \to F(B) \to F(C)$ is exact.

\medskip\noindent
Conversely, suppose that $F$ is additive and
transforms any short exact sequence $0 \to A \to B \to C$ into
an exact sequence $0 \to F(A) \to F(B) \to F(C)$.
Because it is additive it commutes with direct sums
and hence finite products in $\mathcal{A}$. To show
it commutes with finite limits it therefore
suffices to show that it commutes with
equalizers. But equalizers in an abelian category
are the same as the kernel of the difference map,
hence it suffices to show that $F$ commutes with
taking kernels. Let $f : A \to B$ be a morphism.
Factor $f$ as $A \to I \to B$ with $f' : A \to I$ surjective
and $i : I \to B$ injective. (This is possible by the
definition of an abelian category.) Then it is
clear that $\text{Ker}(f) = \text{Ker}(f')$. Also
$0 \to \text{Ker}(f') \to A \to I \to 0$
and
$0 \to I \to B \to B/I \to 0$
are short exact. By the condition imposed on $F$
we see that
$0 \to F(\text{Ker}(f')) \to F(A) \to F(I)$
and
$0 \to F(I) \to F(B) \to F(B/I)$
are exact. Hence it is also the case that
$F(\text{Ker}(f'))$ is the kernel of the map
$F(A) \to F(B)$, and we win.

\medskip\noindent
The proof of (3) is similar to the proof of (2).
Statement (4) is a combination of (2) and (3).
\end{proof}

\begin{lemma}
\label{lemma-exact-functor-ext}
Let $\mathcal{A}$ and $\mathcal{B}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$ be an exact functor.
For every pair of objects $A, B$ of $\mathcal{A}$ the
functor $F$ induces an abelian group homomorphism
$$
\text{Ext}_\mathcal{A}(B, A)
\longrightarrow
\text{Ext}_\mathcal{B}(F(B), F(A))
$$
which maps the extension $E$ to $F(E)$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
The following lemma is used in the proof that the category of abelian
sheaves on a site is abelian, where the functor $b$ is sheafification.

\begin{lemma}
\label{lemma-adjoint-get-abelian}
Let $a : \mathcal{A} \to \mathcal{B}$ and $b : \mathcal{B} \to \mathcal{A}$
be functors. Assume that
\begin{enumerate}
\item $\mathcal{A}$, $\mathcal{B}$ are additive categories,
$a$, $b$ are additive functors, and $a$ is right adjoint to $b$,
\item $\mathcal{B}$ is abelian and $b$ is left exact, and
\item $ba \cong \text{id}_{\mathcal{A}}$.
\end{enumerate}
Then $\mathcal{A}$ is abelian.
\end{lemma}

\begin{proof}
As $\mathcal{B}$ is abelian we see that all finite limits and colimits
exist in $\mathcal{B}$ by Lemma \ref{lemma-colimit-abelian-category}.
Since $b$ is a left adjoint we see that $b$ is also right exact
and hence exact, see
Categories, Lemma \ref{categories-lemma-exact-adjoint}.
Let $\varphi : B_1 \to B_2$ be a morphism of $\mathcal{B}$.
In particular, if $K = \text{Ker}(B_1 \to B_2)$, then $K$ is
the equalizer of $0$ and $\varphi$ and hence
$bK$ is the equalizer of $0$ and $b\varphi$, hence
$bK$ is the kernel of $b\varphi$. Similarly, if
$Q = \text{Coker}(B_1 \to B_2)$, then $Q$ is
the coequalizer of $0$ and $\varphi$ and hence
$bQ$ is the coequalizer of $0$ and $b\varphi$, hence
$bQ$ is the cokernel of $b\varphi$. Thus we see that every morphism
of the form $b\varphi$ in $\mathcal{A}$ has a kernel and a cokernel.
However, since $ba \cong \text{id}$ we see that every morphism of
$\mathcal{A}$ is of this form, and we conclude that kernels and
cokernels exist in $\mathcal{A}$. In fact, the argument shows that
if $\psi : A_1 \to A_2$ is a morphism then
$$
\text{Ker}(\psi) = b\text{Ker}(a\psi),
\quad\text{and}\quad
\text{Coker}(\psi) = b\text{Coker}(a\psi).
$$
Now we still have to show that $\text{Coim}(\psi)= \text{Im}(\psi)$.
We do this as follows.
First note that since $\mathcal{A}$ has kernels and cokernels it
has all finite limits and colimits (see proof of
Lemma \ref{lemma-colimit-abelian-category}).
Hence we see by Categories, Lemma \ref{categories-lemma-exact-adjoint}
that $a$ is left exact and
hence transforms kernels (=equalizers) into kernels.
\begin{align*}
\text{Coim}(\psi)
& =
\text{Coker}(\text{Ker}(\psi) \to A_1)
& \text{by definition} \\
& =
b\text{Coker}(a(\text{Ker}(\psi) \to A_1))
& \text{by formula above} \\
& =
b\text{Coker}(\text{Ker}(a\psi) \to aA_1))
& a\text{ preserves kernels} \\
& =
b\text{Coim}(a\psi)
& \text{by definition} \\
& = 
b\text{Im}(a\psi)
& \mathcal{B}\text{ is abelian} \\
& = 
b\text{Ker}(aA_2 \to \text{Coker}(a\psi))
& \text{by definition} \\
& =
\text{Ker}(baA_2 \to b\text{Coker}(a\psi))
& b\text{ preserves kernels} \\
& =
\text{Ker}(A_2 \to b\text{Coker}(a\psi))
& ba = \text{id}_{\mathcal{A}} \\
& =
\text{Ker}(A_2 \to \text{Coker}(\psi))
& \text{by formula above} \\
& = 
\text{Im}(\psi)
& \text{by definition}
\end{align*}
Thus the lemma holds.
\end{proof}







\section{Serre subcategories}
\label{section-serre-subcategories}

\noindent
In \cite[Chapter I, Section 1]{Serre_homotopie_classes}
a notion of a ``class'' of abelian groups is defined.
This notion has been extended to abelian categories by many authors
(in slightly different ways). We will use the following variant
which is virtually identical to Serre's original definition.

\begin{definition}
\label{definition-serre-subcategory}
Let $\mathcal{A}$ be an abelian category.
A {\it Serre subcategory} of $\mathcal{A}$ is a
nonempty full subcategory $\mathcal{C}$ of $\mathcal{A}$,
such that given an exact sequence
$$
A \to B \to C
$$
with $A, C \in \text{Ob}(\mathcal{C})$, then also
$B \in \text{Ob}(\mathcal{C})$.
\end{definition}

\begin{lemma}
\label{lemma-characterize-serre-subcategory}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{C}$ be a subcategory of $\mathcal{A}$.
Then $\mathcal{C}$ is a Serre subcategory if and only if
the following conditions are satisfied:
\begin{enumerate}
\item $0 \in \text{Ob}(\mathcal{C})$,
\item $\mathcal{C}$ is a full subcategory of $\mathcal{A}$,
\item if $C \in \text{Ob}(\mathcal{C})$ and $A \in \mathcal{A}$
is isomorphic to a subobject or a quotient object of $C$, then also
$A \in \text{Ob}(\mathcal{C})$,
\item if $A \in \mathcal{A}$ is an extension of objects of $\mathcal{C}$
then also $A \in \text{Ob}(\mathcal{C})$.
\end{enumerate}
Moreover, a Serre subcategory is an abelian category such that
the inclusion functor is exact.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-kernel-exact-functor}
Let $\mathcal{A}$, $\mathcal{B}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$ be an exact functor.
Then the full subcategory of objects $C$ of $\mathcal{A}$
such that $F(C) = 0$ forms a Serre subcategory of $\mathcal{A}$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-kernel-category}
Let $\mathcal{A}$, $\mathcal{B}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$ be an exact functor.
Then the full subcategory of objects $C$ of $\mathcal{A}$
such that $F(C) = 0$ is called the {\it kernel of the functor $F$},
and is sometimes denoted $\text{Ker}(F)$.
\end{definition}

\begin{lemma}
\label{lemma-serre-subcategory-is-kernel}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{C} \subset \mathcal{A}$ be a Serre subcategory.
There exists an abelian category $\mathcal{A}/\mathcal{C}$
and an exact functor
$$
F : \mathcal{A} \longrightarrow \mathcal{A}/\mathcal{C}
$$
which is essentially surjective and whose kernel is $\mathcal{C}$.
The category $\mathcal{A}/\mathcal{C}$ and the functor $F$ are
characterized by the following universal property: For any exact
functor $G : \mathcal{A} \to \mathcal{B}$ such that
$\mathcal{C} \subset \text{Ker}(G)$ there exists a factorization
$G = H \circ F$ for some functor $H : \mathcal{A}/\mathcal{C}
\to \mathcal{B}$.
\end{lemma}

\begin{proof}
Omitted. Hint: Take
$\text{Ob}(\mathcal{A}/\mathcal{C}) = \text{Ob}(\mathcal{A})$ and
$$
\text{Mor}_{\mathcal{A}/\mathcal{C}}(X, Y) =
\left\{(X', i, f) \mid
\begin{matrix}
i : X' \to X, f : X' \to Y \text{ morphisms of }\mathcal{A} \\
\text{with } \text{Ker}(i), \text{Coker}(i) \in \text{Ob}(\mathcal{C})
\end{matrix}
\right\}/\sim
$$
with a (fairly) obvious equivalence relation $\sim$ and a
suitable composition law.
Note that there are no set theoretical issues in the construction
of $\mathcal{A}/\mathcal{C}$ since all categories we use
are ``small'' if not mentioned otherwise.
\end{proof}




\section{K-groups}
\label{section-K-groups}

\begin{definition}
\label{definition-K-zero}
Let $\mathcal{A}$ be an abelian category.
We denote $K_0(\mathcal{A})$ the
{\it zeroth $K$-group of $\mathcal{A}$}.
It is the abelian group constructed as follows.
Take the free abelian group
on the objects on $\mathcal{A}$
and for every short exact sequence
$0 \to A \to B \to C \to 0$
impose the relation $[B] - [A] - [C] = 0$.
\end{definition}

\noindent
Another way to say this is that there is a presentation
$$
\bigoplus_{A \to B \to C\text{ ses}}
\mathbf{Z}[A \to B \to C]
\longrightarrow
\bigoplus_{A \in \text{Ob}(\mathcal{A})}
\mathbf{Z}[A]
\longrightarrow
K_0(\mathcal{A})
\longrightarrow
0
$$
with $[A \to B \to C] \mapsto [B] - [A] - [C]$ of $K_0(\mathcal{A})$.
The short exact sequence $0 \to 0 \to 0 \to 0 \to 0$
leads to the relation $[0] = 0$ in $K_0(\mathcal{A})$.
There are no set-theoretical issues as all of our categories
are ``small'' if not mentioned otherwise.
Some examples of $K$-groups for categories of modules
over rings where computed in
Algebra, Section \ref{algebra-section-K-groups}.

\begin{lemma}
\label{lemma-exact-functor-K-groups}
Let $F : \mathcal{A} \to \mathcal{B}$ be an exact functor between
abelian categories. Then $F$ induces a homomorphism of $K$-groups
$K_0(F) : K_0(\mathcal{A}) \to K_0(\mathcal{B})$ by simply setting
$K_0(F)([A]) = [F(A)]$.
\end{lemma}

\begin{proof}
Proves itself.
\end{proof}

\noindent
Suppose we are given an object $M$ of an abelian category $\mathcal{A}$
and a complex of the form
\begin{equation}
\label{equation-cyclic-complex}
\xymatrix{
\ldots \ar[r] &
M \ar[r]^\varphi &
M \ar[r]^\psi &
M \ar[r]^\varphi &
M \ar[r] & \ldots
}
\end{equation}
In this situation we define
$$
H^0(M, \varphi, \psi) = \text{Ker}(\psi)/\text{Im}(\varphi)
,\quad\text{and}\quad
H^1(M, \varphi, \psi) = \text{Ker}(\varphi)/\text{Im}(\psi).
$$

\begin{lemma}
\label{lemma-serre-subcategory-K-groups}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{C} \subset \mathcal{A}$ be a Serre subcategory and
set $\mathcal{B} = \mathcal{A}/\mathcal{C}$.
\begin{enumerate}
\item The exact functors $\mathcal{C} \to \mathcal{A}$ and
$\mathcal{A} \to \mathcal{B}$ induce an exact sequence
$$
K_0(\mathcal{C}) \to
K_0(\mathcal{A}) \to
K_0(\mathcal{B}) \to
0
$$
of $K$-groups, and
\item the kernel of $K_0(\mathcal{C}) \to K_0(\mathcal{A})$ is equal
to the collection of elements of the form
$$
[H^0(M, \varphi, \psi)] - [H^1(M, \varphi, \psi)]
$$
where $(M, \varphi, \psi)$ is a complex as in (\ref{equation-cyclic-complex})
with the property that it becomes exact in $\mathcal{B}$; in other words
that $H^0(M, \varphi, \psi)$ and $H^1(M, \varphi, \psi)$ are
objects of $\mathcal{C}$.
\end{enumerate}
\end{lemma}

\begin{proof}
We omit the proof of (1). The proof of (2) is in a sense completely
combinatorial. First we remark that any class of the type
$[H^0(M, \varphi, \psi)] - [H^1(M, \varphi, \psi)]$ is zero
in $K_0(\mathcal{A})$ by the following calculation
\begin{align*}
0 & = [M] - [M] \\
& =  [\text{Ker}(\varphi)] + [\text{Im}(\varphi)]
- [\text{Ker}(\psi)] - [\text{Im}(\psi)] \\
& =
[\text{Ker}(\varphi)/\text{Im}(\psi)] -
[\text{Ker}(\psi)/\text{Im}(\varphi)] \\
& = [H^1(M, \varphi, \psi)] - [H^0(M, \varphi, \psi)]
\end{align*}
as desired. Hence it suffices to show that any element in the kernel
of $K_0(\mathcal{C}) \to K_0(\mathcal{A})$ is of this form.

\medskip\noindent
Any element $x$ in $K_0(\mathcal{C})$ can be represented as the
difference $x = [P] - [Q]$ of two objects of $\mathcal{C}$ (fun exercise).
Suppose that this element maps to zero in $K_0(\mathcal{A})$.
This means that there exist
\begin{enumerate}
\item a finite set $I = I^{+} \coprod I^{-}$,
\item for each $i \in I$ a short exact sequence
$$
0 \to A_i \to B_i \to C_i \to 0
$$
in the abelian category $\mathcal{A}$
\end{enumerate}
such that
$$
[P] - [Q] =
\sum\nolimits_{i \in I^{+}} ([B_i] - [A_i] - [C_i])
-
\sum\nolimits_{i \in I^{-}} ([B_i] - [A_i] - [C_i])
$$
in the free abelian group on the objects of $\mathcal{A}$.
We can rewrite this as
$$
[P]
+ \sum\nolimits_{i \in I^{+}} ([A_i] + [C_i])
+ \sum\nolimits_{i \in I^{-}} [B_i]
=
[Q]
+ \sum\nolimits_{i \in I^{-}} ([A_i] + [C_i])
+ \sum\nolimits_{i \in I^{+}} [B_i].
$$
Since the right and left hand side should contain the same objects
of $\mathcal{A}$ counted with multiplicity, this means there should be
a bijection $\tau$ between the terms which occur above. Set
$$
T^{+} =
\{p\}\ \coprod\ \{a, c\}\times I^{+}\ \coprod\ \{b\}\times I^{-}
$$
and
$$
T^{-} =
\{q\}\ \coprod\ \{a, c\}\times I^{-}\ \coprod\ \{b\}\times I^{+}.
$$
Set $T = T^{+} \coprod T^{-} = \{p, q\} \coprod \{a, b, c\} \times I$.
For $t \in T$ define
$$
O(t)
=
\left\{
\begin{matrix}
P & \text{if} & t = p \\
Q & \text{if} & t = q \\
A_i & \text{if} & t = (a, i) \\
B_i & \text{if} & t = (b, i) \\
C_i & \text{if} & t = (c, i)
\end{matrix}
\right.
$$
Hence we can view $\tau : T^{+} \to T^{-}$ as a bijection
such that $O(t) = O(\tau(t))$ for all $t \in T^{+}$.
Let $t^{-}_0 = \tau(p)$ and let $t^{+}_0 \in T^{+}$ be the 
unique element such that $\tau(t^{+}_0) = q$.
Consider the object
$$
M^{+} = \bigoplus\nolimits_{t \in T^{+}} O(t)
$$
By using $\tau$ we see that it is equal to the object
$$
M^{-} = \bigoplus\nolimits_{t \in T^{-}} O(t)
$$
Consider the map
$$
\varphi : M^{+} \longrightarrow M^{-}
$$
which on the summand $O(t) = A_i$ corresponding to $t = (a, i)$, $i \in I^{+}$
uses the map $A_i \to B_i$ into the summand $O((b, i)) = B_i$ of $M^{-}$
and on the summand $O(t) = B_i$ corresponding to $(b, i)$, $i \in I^{-}$
uses the map $B_i \to C_i$ into the summand $O((c, i)) = C_i$ of $M^{-}$.
The map is zero on the summands corresponding to $p$
and $(c, i)$, $i \in I^{+}$.
Similarly, consider the map
$$
\psi : M^{-} \longrightarrow M^{+}
$$
which on the summand $O(t) = A_i$ corresponding to $t = (a, i)$, $i \in I^{-}$
uses the map $A_i \to B_i$ into the summand $O((b, i)) = B_i$ of $M^{+}$
and on the summand $O(t) = B_i$ corresponding to $(b, i)$, $i \in I^{+}$
uses the map $B_i \to C_i$ into the summand $O((c, i)) = C_i$ of $M^{+}$.
The map is zero on the summands corresponding to $q$ and
$(c, i)$, $i \in I^{-}$.

\medskip\noindent
Note that the kernel of $\varphi$ is equal to the direct sum of the
summand $P$ and the summands $O((c, i)) = C_i$, $i \in I^{+}$ and
the subobjects $A_i$ inside the summands $O((b, i)) = B_i$, $i \in I^{-}$.
The image of $\psi$ is equal to the direct sum of the
summands $O((c, i)) = C_i$, $i \in I^{+}$ and
the subobjects $A_i$ inside the summands $O((b, i)) = B_i$, $i \in I^{-}$.
In other words we see that
$$
P \cong \text{Ker}(\varphi)/\text{Im}(\psi).
$$
In exactly the same way we see that
$$
Q \cong \text{Ker}(\psi)/\text{Im}(\varphi).
$$
Since as we remarked above the existence of the bijection
$\tau$ shows that $M^{+} = M^{-}$ we see that the lemma follows.
\end{proof}





\section{Cohomological delta-functors}
\label{section-cohomological-delta-functor}

\begin{definition}
\label{definition-cohomological-delta-functor}
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
A {\it cohomological $\delta$-functor} or simply a
{\it $\delta$-functor} from $\mathcal{A}$
to $\mathcal{B}$ is given by the following data:
\begin{enumerate}
\item a collection $F^n : \mathcal{A} \to \mathcal{B}$, $n \geq 0$ of additive
functors, and
\item for every short exact sequence $0 \to A \to B \to C \to 0$
of $\mathcal{A}$
a collection $\delta_{A \to B \to C} : F^n(C) \to F^{n + 1}(A)$, $n \geq 0$
of morphisms of $\mathcal{B}$.
\end{enumerate}
These data are assumed to satisfy the following axioms
\begin{enumerate}
\item for every short exact sequence as above the sequence
$$
\xymatrix{
0 \ar[r] &
F^0(A) \ar[r] &
F^0(B) \ar[r] &
F^0(C) \ar[lld]^{\delta_{A \to B \to C}} \\
 &
F^1(A) \ar[r] &
F^1(B) \ar[r] &
F^1(C) \ar[lld]^{\delta_{A \to B \to C}} \\
 &
F^2(A) \ar[r] &
F^2(B) \ar[r] &
\ldots
}
$$
is exact, and
\item for every morphism $(A \to B \to C) \to (A' \to B' \to C')$
of short exact sequences of $\mathcal{A}$ the diagrams
$$
\xymatrix{
F^n(C) \ar[d] \ar[rr]_{\delta_{A \to B \to C}} & & F^{n + 1}(A) \ar[d] \\
F^n(C') \ar[rr]^{\delta_{A' \to B' \to C'}} & & F^{n + 1}(A')
}
$$
are commutative.
\end{enumerate}
\end{definition}

\noindent
Note that this in particular implies that $F^0$ is left exact.

\begin{definition}
\label{definition-morphism-delta-functors}
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $(F^n, \delta_F)$ and $(G^n, \delta_G)$ be $\delta$-functors
from $\mathcal{A}$ to $\mathcal{B}$. A {\it morphism of $\delta$-functors
from $F$ to $G$} is a collection of
transformation of functors $t^n : F^n \to G^n$, $n \geq 0$ such
that for every short exact sequence $0 \to A \to B \to C \to 0$
of $\mathcal{A}$ the diagrams
$$
\xymatrix{
F^n(C) \ar[d]_{t^n} \ar[rr]_{\delta_{F, A \to B \to C}} &
& F^{n + 1}(A) \ar[d]^{t^{n + 1}} \\
G^n(C) \ar[rr]^{\delta_{G, A \to B \to C}} & & G^{n + 1}(A)
}
$$
are commutative.
\end{definition}

\begin{definition}
\label{definition-universal-delta-functor}
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $F = (F^n, \delta_F)$ be a $\delta$-functor
from $\mathcal{A}$ to $\mathcal{B}$.
We say $F$ is a {\it universal $\delta$-functor} if an only
if for every $\delta$-functor $G = (G^n, \delta_G)$ and any
morphism of functors $t : F^0 \to G^0$ there exists
a unique morphism of $\delta$-functors $\{t^n\}_{n \geq 0} : F \to G$
such that $t = t^0$.
\end{definition}

\begin{lemma}
\label{lemma-efface-implies-universal}
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $F = (F^n, \delta_F)$ be a $\delta$-functor
from $\mathcal{A}$ to $\mathcal{B}$.
Suppose that for every $n > 0$ and any $A \in \text{Ob}(\mathcal{A})$
there exists an injective morphism $u : A \to B$ (depending on $A$ and $n$)
such that $F^n(u) : F^n(A) \to F^n(B)$ is zero. Then $F$ is a universal
$\delta$-functor.
\end{lemma}

\begin{proof}
Let $G = (G^n, \delta_G)$ be a $\delta$-functor
from $\mathcal{A}$ to $\mathcal{B}$ and let $t : F^0 \to G^0$
be a morphism of functors. We have to show there exists
a unique morphism of $\delta$-functors $\{t^n\}_{n \geq 0} : F \to G$
such that $t = t^0$. We construct $t^n$ by induction on $n$.
For $n = 0$ we set $t^0 = t$.
Suppose we have already constructed a unique sequence of
transformation of functors $t^i$ for $i \leq n$ compatible with
the maps $\delta$ in degrees $\leq n$.

\medskip\noindent
Let $A \in \text{Ob}(\mathcal{A})$. By assumption we may choose
a embedding $u : A \to B$ such that $F^{n + 1}(u) = 0$.
Let $C = B/u(A)$. The long exact cohomology sequence for
the short exact sequence $0 \to A \to B \to C \to 0$ and the
$\delta$-functor $F$ gives that
$F^{n + 1}(A) = \text{Coker}(F^n(B) \to F^n(C))$ by our choice of $u$.
Since we have already defined $t^n$ we can set
$$
t^{n + 1}_A : F^{n + 1}(A) \to G^{n + 1}(A)
$$
equal to the unique map such that
$$
\xymatrix{
\text{Coker}(F^n(B) \to F^n(C)) \ar[r]_{t^n}
\ar[d]_{\delta_{F, A \to B \to C}} &
\text{Coker}(G^n(B) \to G^n(C))
\ar[d]^{\delta_{G, A \to B \to C}} \\
F^{n + 1}(A) \ar[r]^{t^{n + 1}_A} &
G^{n + 1}(A)
}
$$
commutes. This is clearly uniquely determined by the requirements
imposed. We omit the verification that this defines a transformation
of functors.
\end{proof}

\begin{lemma}
\label{lemma-uniqueness-universal-delta-functor}
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$ be a functor.
If there exists a universal $\delta$-functor
$(F^n, \delta_F)$ from $\mathcal{A}$ to $\mathcal{B}$
with $F^0 = F$, then it is determined up to unique isomorphism
of $\delta$-functors.
\end{lemma}

\begin{proof}
Immediate from the definitions.
\end{proof}







\section{Complexes}
\label{section-complexes}

\noindent
Of course the notions of a chain complex and a cochain complex
are dual and you only have to read one of the two parts of
this section. So pick the one you like. (Actually, this doesn't
quite work right since the conventions on numbering things
are not adapted to an easy transition between chain and cochain
complexes.)

\medskip\noindent
A {\it chain complex $A_\bullet$} in an additive category $\mathcal{A}$
is a complex
$$
\ldots \to
A_{n + 1} \xrightarrow{d_{n + 1}}
A_n \xrightarrow{d_n}
A_{n - 1} \to
\ldots
$$
of $\mathcal{A}$. In other words, we are given an object $A_i$ of
$\mathcal{A}$ for all $i \in \mathbf{Z}$ and for
all $i \in \mathbf{Z}$ a morphism $d_i : A_i \to A_{i - 1}$ such that
$d_{i - 1} \circ d_i = 0$ for all $i$. A {\it morphism of chain
complexes $f : A_\bullet \to B_\bullet$} is given by a
family of morphisms $f_i : A_i \to B_i$ such that all
the diagrams
$$
\xymatrix{
A_i \ar[r]_{d_i} \ar[d]_{f_i} & A_{i - 1} \ar[d]^{f_{i - 1}} \\
B_i \ar[r]^{d_i} & B_{i - 1}
}
$$
commute. The {\it category of chain complexes of $\mathcal{A}$}
is denoted $\text{Ch}(\mathcal{A})$. The full subcategory consisting
of objects of the form
$$
\ldots \to A_2 \to A_1 \to A_0 \to 0 \to 0 \to \ldots
$$
is denoted $\text{Ch}_{\geq 0}(\mathcal{A})$.
In other words, a chain complex $A_\bullet$ belongs to
$\text{Ch}_{\geq 0}(\mathcal{A})$ if and only if
$A_i = 0$ for all $i < 0$.
A {\it homotopy $h$} between a pair of morphisms
of chain complexes $f, g : A_\bullet \to B_\bullet$ is
is a collection of morphisms $h_i : A_i \to B_{i + 1}$
such that we have
$$
f_i - g_i = d_{i + 1} \circ h_i + h_{i - 1} \circ d_i
$$
for all $i$. Clearly, the notions of chain complex, morphism of
chain complexes, and homotopies between morphisms of chain complexes
makes sense even in a preadditive category.

\begin{lemma}
\label{lemma-compose-homotopy}
Let $\mathcal{A}$ be an additive category.
Let $f, g : B_\bullet \to C_\bullet$ be morphisms
of chain complexes. Suppose given morphisms of chain
complexes $a : A_\bullet \to B_\bullet$, and
$c : C_\bullet \to D_\bullet$.
If $\{h_i : B_i \to C_{i + 1}\}$ defines a homotopy
between $f$ and $g$, then $\{c_{i + 1} \circ h_i \circ a_i\}$
defines a homotopy between $c \circ f \circ a$ and
$c \circ g \circ a$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
In particular this means that it makes sense to define
the category of chain complexes with maps up to homotopy.
We'll return to this later.

\begin{definition}
\label{definition-homotopy-equivalent}
Let $\mathcal{A}$ be an additive category.
We say a morphism $a : A_\bullet \to B_\bullet$
is a {\it homotopy equivalence} if there exists
a morphism $b : B_\bullet \to A_\bullet$
such that there exists a homotopy between
$a \circ b$ and $\text{id}_A$
and there exists a homotopy between $b \circ a$ and $\text{id}_B$.
If there exists such a morphism between $A_\bullet$ and $B_\bullet$, then
we say that $A_\bullet$ and $B_\bullet$ are {\it homotopy equivalent}.
\end{definition}

\noindent
In other words, two complexes are homotopy equivalent if they become
isomorphic in the category of complexes up to homotopy.

\begin{lemma}
\label{lemma-cat-chain-abelian}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item The category of chain complexes in $\mathcal{A}$ is
abelian.
\item A morphism of complexes
$f : A_\bullet \to B_\bullet$ is injective
if and only if each $f_n : A_n \to B_n$ is injective.
\item A morphism of complexes
$f : A_\bullet \to B_\bullet$ is surjective
if and only if each $f_n : A_n \to B_n$ is surjective.
\item A sequence of chain complexes
$$
A_\bullet \xrightarrow{f} B_\bullet \xrightarrow{g} C_\bullet
$$
is exact at $B_\bullet$ if and only if each sequence
$$
A_i \xrightarrow{f_i} B_i \xrightarrow{g_i} C_i
$$
is exact at $B_i$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
For any $i \in \mathbf{Z}$ the $i$th {\it homology group}
of a chain complex $A_\bullet$ in an abelian category is defined by
the following formula
$$
H_i(A_\bullet) = \text{Ker}(d_i)/\text{Im}(d_{i + 1}).
$$
If $f : A_\bullet \to B_\bullet$ is a morphism of chain
complexes of $\mathcal{A}$ then we get an induced
morphism $H_i(f) : H_i(A_\bullet) \to H_i(B_\bullet)$
because clearly
$f_i(\text{Ker}(d_i : A_i \to A_{i - 1})) \subset
\text{Ker}(d_i : B_i \to B_{i - 1})$, and similarly
for $\text{Im}(d_{i + 1})$.
Thus we obtain a functor
$$
H_i : \text{Ch}(\mathcal{A}) \longrightarrow \mathcal{A}.
$$

\begin{definition}
\label{definition-quasi-isomorphism}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item A morphism of chain complexes $f : A_\bullet \to B_\bullet$
is called a {\it quasi-isomorphism} if the induced
maps $H_i(f) : H_i(A_\bullet) \to H_i(B_\bullet)$
is an isomorphism for all $i \in \mathbf{Z}$.
\item A chain complex $A_\bullet$ is called
{\it acyclic} if all of its homology objects
$H_i(A_\bullet)$ are zero.
\end{enumerate}
\end{definition}


\begin{lemma}
\label{lemma-map-homology-homotopy}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item If the maps $f, g : A_\bullet \to B_\bullet$ are
homotopic, then the induced maps $H_i(f)$ and $H_i(g)$
are equal.
\item If the map $f : A_\bullet \to B_\bullet$ is a homotopy
equivalence, then $f$ is a quisi-isomorphism.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-long-exact-sequence-chain}
Let $\mathcal{A}$ be an abelian category.
Suppose that
$$
0 \to
A_\bullet \to
B_\bullet \to
C_\bullet \to
0
$$
is a short exact sequence of chain complexes of $\mathcal{A}$.
Then there is a canonical long exact homology sequence
$$
\xymatrix{
\ldots & \ldots & \dots \ar[lld] \\
H_i(A_\bullet) \ar[r] & H_i(B_\bullet) \ar[r] & H_i(C_\bullet) \ar[lld] \\
H_{i - 1}(A_\bullet) \ar[r] &
H_{i - 1}(B_\bullet) \ar[r] &
H_{i - 1}(C_\bullet) \ar[lld] \\
\ldots & \ldots & \dots \\
}
$$
\end{lemma}

\begin{proof}
Omitted. The maps come from the Snake Lemma \ref{lemma-snake}
applied to the diagrams
$$
\xymatrix{
&
A_i/\text{Im}(d_{A, i + 1}) \ar[r] \ar[d]^{d_{A, i}} &
B_i/\text{Im}(d_{B, i + 1}) \ar[r] \ar[d]^{d_{B, i}} &
C_i/\text{Im}(d_{C, i + 1}) \ar[r] \ar[d]^{d_{C, i}} &
0 \\
0 \ar[r] &
\text{Ker}(d_{A, i - 1}) \ar[r] &
\text{Ker}(d_{B, i - 1}) \ar[r] &
\text{Ker}(d_{C, i - 1}) &
}
$$
\end{proof}

\noindent
A {\it cochain complex $A^\bullet$} in an additive category $\mathcal{A}$
is a complex
$$
\ldots \to
A^{n - 1} \xrightarrow{d^{n - 1}}
A^n \xrightarrow{d^n}
A^{n + 1} \to
\ldots
$$
of $\mathcal{A}$. In other words, we are given an object $A^i$ of
$\mathcal{A}$ for all $i \in \mathbf{Z}$ and for
all $i \in \mathbf{Z}$ a morphism $d^i : A^i \to A^{i + 1}$ such that
$d^{i + 1} \circ d^i = 0$ for all $i$. A {\it morphism of cochain
complexes $f : A^\bullet \to B^\bullet$} is given by a
family of morphisms $f^i : A^i \to B^i$ such that all
the diagrams
$$
\xymatrix{
A^i \ar[r]_{d^i} \ar[d]_{f^i} & A^{i + 1} \ar[d]^{f^{i + 1}} \\
B^i \ar[r]^{d^i} & B^{i + 1}
}
$$
commute. The {\it category of cochain complexes of $\mathcal{A}$}
is denoted $\text{CoCh}(\mathcal{A})$. The full subcategory consisting
of objects of the form
$$
\ldots \to 0 \to 0 \to A^0 \to A^1 \to A^2 \to \ldots
$$
is denoted $\text{CoCh}_{\geq 0}(\mathcal{A})$.
In other words, a cochain complex $A^\bullet$ belongs to the subcategory
$\text{CoCh}_{\geq 0}(\mathcal{A})$ if and only if
$A^i = 0$ for all $i < 0$.
A {\it homotopy $h$} between a pair of morphisms
of cochain complexes $f, g : A^\bullet \to B^\bullet$ is
is a collection of morphisms $h^i : A^i \to B^{i - 1}$
such that we have
$$
f^i - g^i = d^{i - 1} \circ h^i + h^{i + 1} \circ d^i
$$
for all $i$. Clearly, the notions of cochain complex, morphism of
cochain complexes, and homotopies between morphisms of cochain complexes
makes sense even in a preadditive category.

\begin{lemma}
\label{lemma-compose-homotopy-cochain}
Let $\mathcal{A}$ be an additive category.
Let $f, g : B^\bullet \to C^\bullet$ be morphisms
of cochain complexes. Suppose given morphisms of cochain
complexes $a : A^\bullet \to B^\bullet$, and
$c : C^\bullet \to D^\bullet$.
If $\{h^i : B^i \to C^{i - 1}\}$ defines a homotopy
between $f$ and $g$, then $\{c^{i - 1} \circ h^i \circ a^i\}$
defines a homotopy between $c \circ f \circ a$ and
$c \circ g \circ a$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
In particular this means that it makes sense to define
the category of cochain complexes with maps up to homotopy.
We'll return to this later.

\begin{definition}
\label{definition-homotopy-equivalent-cochain}
Let $\mathcal{A}$ be an additive category.
We say a morphism $a : A^\bullet \to B^\bullet$
is a {\it homotopy equivalence} if there exists
a morphism $b : B^\bullet \to A^\bullet$
such that there exists a homotopy between
$a \circ b$ and $\text{id}_A$
and there exists a homotopy between $b \circ a$ and $\text{id}_B$.
If there exists such a morphism between $A^\bullet$ and $B^\bullet$, then
we say that $A^\bullet$ and $B^\bullet$ are {\it homotopy equivalent}.
\end{definition}

\noindent
In other words, two complexes are homotopy equivalent if they become
isomorphic in the category of complexes up to homotopy.

\begin{lemma}
\label{lemma-cat-cochain-abelian}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item The category of cochain complexes in $\mathcal{A}$ is
abelian.
\item A morphism of cochain complexes
$f : A^\bullet \to B^\bullet$ is injective
if and only if each $f^n : A^n \to B^n$ is injective.
\item A morphism of cochain complexes
$f : A^\bullet \to B^\bullet$ is surjective
if and only if each $f^n : A^n \to B^n$ is surjective.
\item A sequence of cochain complexes
$$
A^\bullet \xrightarrow{f} B^\bullet \xrightarrow{g} C^\bullet
$$
is exact at $B^\bullet$ if and only if each sequence
$$
A^i \xrightarrow{f^i} B^i \xrightarrow{g^i} C^i
$$
is exact at $B^i$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
For any $i \in \mathbf{Z}$ the $i$th {\it cohomology group}
of a cochain complex $A^\bullet$ is defined by
the following formula
$$
H^i(A^\bullet) = \text{Ker}(d^i)/\text{Im}(d^{i - 1}).
$$
If $f : A^\bullet \to B^\bullet$ is a morphism of cochain
complexes of $\mathcal{A}$ then we get an induced
morphism $H^i(f) : H^i(A^\bullet) \to H^i(B^\bullet)$
because clearly
$f^i(\text{Ker}(d^i : A^i \to A^{i + 1})) \subset
\text{Ker}(d^i : B^i \to B^{i + 1})$, and similarly
for $\text{Im}(d^{i - 1})$.
Thus we obtain a functor
$$
H^i : \text{CoCh}(\mathcal{A}) \longrightarrow \mathcal{A}.
$$

\begin{definition}
\label{definition-quasi-isomorphism-cochain}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item A morphism of cochain complexes $f : A^\bullet \to B^\bullet$
of $\mathcal{A}$ is called a {\it quasi-isomorphism} if the induced
maps $H^i(f) : H^i(A^\bullet) \to H^i(B^\bullet)$
is an isomorphism for all $i \in \mathbf{Z}$.
\item A cochain complex $A^\bullet$ is called
{\it acyclic} if all of its cohomology objects
$H^i(A^\bullet)$ are zero.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-map-cohomology-homotopy-cochain}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item If the maps $f, g : A^\bullet \to B^\bullet$ are
homotopic, then the induced maps $H^i(f)$ and $H^i(g)$
are equal.
\item If $f : A^\bullet \to B^\bullet$ is a homotopy equivalence,
then $f$ is a quasi-isomorphism.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-long-exact-sequence-cochain}
Let $\mathcal{A}$ be an abelian category.
Suppose that
$$
0 \to
A^\bullet \to
B^\bullet \to
C^\bullet \to
0
$$
is a short exact sequence of chain complexes of $\mathcal{A}$.
Then there is a canonical long exact homology sequence
$$
\xymatrix{
\ldots & \ldots & \dots \ar[lld] \\
H^i(A^\bullet) \ar[r] &
H^i(B^\bullet) \ar[r] &
H^i(C^\bullet) \ar[lld] \\
H^{i + 1}(A^\bullet) \ar[r] &
H^{i + 1}(B^\bullet) \ar[r] &
H^{i + 1}(C^\bullet) \ar[lld] \\
\ldots & \ldots & \dots \\
}
$$
\end{lemma}

\begin{proof}
Omitted. The maps come from the Snake Lemma \ref{lemma-snake}
applied to the diagrams
$$
\xymatrix{
&
A^i/\text{Im}(d_A^{i - 1}) \ar[r] \ar[d]^{d_A^i} &
B^i/\text{Im}(d_B^{i - 1}) \ar[r] \ar[d]^{d_B^i} &
C^i/\text{Im}(d_C^{i - 1}) \ar[r] \ar[d]^{d_C^i} &
0 \\
0 \ar[r] &
\text{Ker}(d_A^{i + 1}) \ar[r] &
\text{Ker}(d_B^{i + 1}) \ar[r] &
\text{Ker}(d_C^{i + 1}) &
}
$$
\end{proof}






\section{Truncation of complexes}
\label{section-truncations}

\noindent
Let $\mathcal{A}$ be an abelian category.
Let $A_\bullet$ be a chain complex. There
are two ways to truncate or filter the complex $A_\bullet$.
\begin{enumerate}
\item The ``stupid'' filtration is the filtration by
the subcomplexes $\sigma_{\leq n} A_\bullet$ defined
by the rule $(\sigma_{\leq n} A_\bullet)_i = 0$ if
$i > n$ and $(\sigma_{\leq n} A_\bullet)_i = A_i$ if
$i \leq n$. In a picture
$$
\xymatrix{
\sigma_{\leq n}A_\bullet \ar[d]  &
\ldots \ar[r] &
0 \ar[r] \ar[d] &
A_n \ar[r] \ar[d] &
A_{n - 1} \ar[r] \ar[d] &
\ldots \\
A_\bullet  &
\ldots \ar[r] &
A_{n + 1} \ar[r] &
A_n \ar[r] &
A_{n - 1} \ar[r] &
\ldots
}
$$
Note that this filtration has the property that
$\sigma_{\leq n}A_\bullet / \sigma_{\leq n - 1}A_\bullet
= A_n[-n]$.
\item The {\it canonical} filtration by $\tau_{\geq n}A_\bullet$
which is best defined by a picture, namely
$$
\xymatrix{
\tau_{\geq n}A_\bullet \ar[d]  &
\ldots \ar[r] &
A_{n + 1} \ar[r] \ar[d] &
\text{Ker}(d_n) \ar[r] \ar[d] &
0 \ar[r] \ar[d] &
\ldots \\
A_\bullet  &
\ldots \ar[r] &
A_{n + 1} \ar[r] &
A_n \ar[r] &
A_{n - 1} \ar[r] &
\ldots
}
$$
Note that these complexes have the property that
$$
H_i(\tau_{\geq n}A_\bullet) =
\left\{
\begin{matrix}
H_i(A_\bullet) & \text{if} & i \geq n \\
0 & \text{if} & i < n
\end{matrix}
\right.
$$
\end{enumerate}

\medskip\noindent
Let $\mathcal{A}$ be an abelian category.
Let $A^\bullet$ be a cochain complex. There
are two ways to truncate or filter the complex $A^\bullet$.
\begin{enumerate}
\item The ``stupid'' filtration is the filtration by
the subcomplexes $\sigma_{\geq n} A^\bullet$ defined
by the rule $(\sigma_{\geq n} A^\bullet)_i = 0$ if
$i < n$ and $(\sigma_{\geq n} A^\bullet)_i = A_i$ if
$i \geq n$. In a picture
$$
\xymatrix{
\sigma_{\geq n}A^\bullet \ar[d]  &
\ldots \ar[r] &
0 \ar[r] \ar[d] &
A^n \ar[r] \ar[d] &
A^{n + 1} \ar[r] \ar[d] &
\ldots \\
A^\bullet  &
\ldots \ar[r] &
A^{n - 1} \ar[r] &
A^n \ar[r] &
A^{n + 1} \ar[r] &
\ldots
}
$$
Note that this filtration has the property that
$\sigma_{\geq n}A^\bullet / \sigma_{\geq n + 1}A^\bullet
= A^n[-n]$.
\item The {\it canonical} filtration by $\tau_{\leq n}A^\bullet$
which is best defined by a picture, namely
$$
\xymatrix{
\tau_{\leq n}A^\bullet \ar[d]  &
\ldots \ar[r] &
A^{n - 1} \ar[r] \ar[d] &
\text{Ker}(d^n) \ar[r] \ar[d] &
0 \ar[r] \ar[d] &
\ldots \\
A^\bullet  &
\ldots \ar[r] &
A^{n - 1} \ar[r] &
A^n \ar[r] &
A^{n + 1} \ar[r] &
\ldots
}
$$
Note that these complexes have the property that
$$
H^i(\tau_{\leq n}A^\bullet) =
\left\{
\begin{matrix}
H^i(A^\bullet) & \text{if} & i \geq n \\
0 & \text{if} & i < n
\end{matrix}
\right.
$$
\end{enumerate}


















\section{Homotopy and the shift functor}
\label{section-homotopy-shift}

\noindent
It is an annoying feature that signs and indices
have to be part of any discussion of homological
algebra\footnote{I am sure you think that my conventions
are wrong. If so and if you feel strongly about it
then drop me an email with an explanation.}.

\begin{definition}
\label{definition-shift}
Let $\mathcal{A}$ be an additive category.
Let $A_\bullet$ be a chain complex
with boundary maps $d_{A, n} : A_n \to A_{n - 1}$.
For any $k \in \mathbf{Z}$ we define the
{\it $k$-shifted chain complex $A[k]_\bullet$}
as follows:
\begin{enumerate}
\item we set $A[k]_n = A_{n + k}$, and
\item we set $d_{A[k], n} : A[k]_n \to A[k]_{n - 1}$
equal to $d_{A[k], n} = (-1)^k d_{A, n + k}$.
\end{enumerate}
If $f : A_\bullet \to B_\bullet$ is a morphism of
chain complexes, then we let
$f[k] : A[k]_\bullet \to B[k]_\bullet$ be the
morphism of chain complexes with
$f[k]_n = f_{k + n}$.
\end{definition}

\noindent
Of course this means we have functors
$[k] : \text{Ch}(\mathcal{A}) \to \text{Ch}(\mathcal{A})$
which mutually commute (on the nose, without
any intervening isomorphisms of functors),
such that $A[k][l]_\bullet = A[k + l]_\bullet$ and
with $[0] = \text{id}_{\text{Ch}(\mathcal{A})}$.

\begin{definition}
\label{definition-homology-shift}
Let $\mathcal{A}$ be an abelian category.
Let $A_\bullet$ be a chain complex
with boundary maps $d_{A, n} : A_n \to A_{n - 1}$.
For any $k \in \mathbf{Z}$ we identify
{\it $H_{i + k}(A_\bullet) \rightarrow H_i(A[k]_\bullet)$}
via the identification
$A_{i + k} = A[k]_i$.
\end{definition}

\noindent
This identification is functorial in $A_\bullet$.
Note that since no signs are involved in this
definition we actually get a compatible system
of identifications of all the homology
objects $H_{i - k}(A[k]_\bullet)$, which are
further compatible with the identifications
$A[k][l]_\bullet = A[k + l]_\bullet$ and
with $[0] = \text{id}_{\text{Ch}(\mathcal{A})}$.

\medskip\noindent
Let $\mathcal{A}$ be an additive category.
Suppose that $A_\bullet$ and $B_\bullet$ are
chain complexes, $a, b : A_\bullet \to B_\bullet$ are
morphsms of chain complexes, and $\{h_i : A_i \to B_{i + 1}\}$
is a homotopy between $a$ and $b$. Recall that this means
that
$a_i - b_i = d_{i + 1} \circ h_i + h_{i - 1} \circ d_i$.
What if $a = b$? Then we obtain the formula
$0 = d_{i + 1} \circ h_i + h_{i - 1} \circ d_i$,
in other words, $ - d_{i + 1} \circ h_i = h_{i - 1} \circ d_i$.
By definition above this means the collection $\{h_i\}$
above defines a morphism of chain complexes
$$
A_\bullet \longrightarrow B[1]_\bullet.
$$
Such a thing is the same as a morphism $A[-1]_\bullet \to B_\bullet$
by our remarks above. This proves the following lemma.

\begin{lemma}
\label{lemma-homotopy-shift}
Let $\mathcal{A}$ be an additive category.
Suppose that $A_\bullet$ and $B_\bullet$ are
chain complexes. Given any morphism of chain
complexes $a : A_\bullet \to B_\bullet$ there
is a bijection between the set of homotopies
from $a$ to $a$ and
$\text{Mor}_{\text{Ch}(\mathcal{A})}(A_\bullet, B[1]_\bullet)$.
More generally, the set of homotopies between
$a$ and $b$ is either empty or a principal homogenous
space under the group
$\text{Mor}_{\text{Ch}(\mathcal{A})}(A_\bullet, B[1]_\bullet)$.
\end{lemma}

\begin{proof}
See above.
\end{proof}

\begin{lemma}
\label{lemma-ses-termwise-split}
Let $\mathcal{A}$ be an abelian category.
Let
$$
0 \to A_\bullet \to B_\bullet \to C_\bullet \to 0
$$
be a sort exact sequence of complexes.
Suppose that $\{s_n : C_n \to B_n\}$ is a family
of morphisms which split the short exact sequences
$0 \to A_n \to B_n \to C_n \to 0$. Let
$\pi_n : B_n \to A_n$ be the associated
projections, see Lemma \ref{lemma-ses-split}.
Then the family of morphisms
$$
\pi_{n - 1} \circ d_{B, n} \circ s_n
:
C_n \to A_{n - 1}
$$
define a morphism of complexes $\delta(s) : C_\bullet \to A[-1]_\bullet$.
\end{lemma}

\begin{proof}
Denote $i : A_\bullet \to B_\bullet$ and $q : B_\bullet \to C_\bullet$
the maps of complexes in the short exact sequence. Then
$i_{n - 1} \circ \pi_{n - 1} \circ d_{B, n} \circ s_n =
d_{B, n} \circ s_n - s_{n - 1} \circ d_{C, n}$. Hence
$i_{n - 2} \circ d_{A, n - 1} \circ \pi_{n - 1} \circ d_{B, n} \circ s_n =
d_{B, n - 1} \circ (d_{B, n} \circ s_n - s_{n - 1} \circ d_{C, n}) =
- d_{B, n - 1} \circ s_{n - 1} \circ d_{C, n}$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-ses-termwise-split-long}
Notation and assumptions as in Lemma \ref{lemma-ses-termwise-split} above.
The morphism of complexes $\delta(s) : C_\bullet \to A[-1]_\bullet$
induces the maps
$$
H_i(\delta(s)) :
H_i(C_\bullet) \longrightarrow H_i(A[-1]_\bullet) = H_{i - 1}(A_\bullet)
$$
which occur in the long exact homology sequence associated
to the short exact sequence of chain complexes by
Lemma \ref{lemma-long-exact-sequence-chain}.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-ses-termwise-split-homotopy}
Notation and assumptions as in Lemma \ref{lemma-ses-termwise-split} above.
Suppose $\{s'_n : C_n \to B_n\}$ is a second choice of splittings.
Write $s'_n = s_n + \pi_n \circ h_n$ for some unique
morphisms $h_n : C_n \to A_n$. The family of maps
$\{h_n : C_n \to A[-1]_{n + 1}\}$ is a homotopy between
the associated morphisms
$\delta(s), \delta(s') : C_\bullet \to A[-1]_\bullet$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}



\begin{definition}
\label{definition-shift-cochain}
Let $\mathcal{A}$ be an additive category.
Let $A^\bullet$ be a cochain complex
with boundary maps $d_A^n : A^n \to A^{n - 1}$.
For any $k \in \mathbf{Z}$ we define the
{\it $k$-shifted cochain complex $A[k]^\bullet$}
as follows:
\begin{enumerate}
\item we set $A[k]^n = A^{n + k}$, and
\item we set $d_{A[k]}^n : A[k]^n \to A[k]^{n - 1}$
equal to $d_{A[k]}^n = (-1)^k d_A^{n + k}$.
\end{enumerate}
If $f : A^\bullet \to B^\bullet$ is a morphism of
cochain complexes, then we let
$f[k] : A[k]^\bullet \to B[k]^\bullet$ be the
morphism of cochain complexes with
$f[k]^n = f^{k + n}$.
\end{definition}

\noindent
Of course this means we have functors
$[k] : \text{CoCh}(\mathcal{A}) \to \text{CoCh}(\mathcal{A})$
which mutually commute (on the nose, without
any intervening isomorphisms of functors) and
such that $A[k][l]^\bullet = A[k + l]^\bullet$ and
with $[0] = \text{id}_{\text{CoCh}(\mathcal{A})}$.

\begin{definition}
\label{definition-comology-shift}
Let $\mathcal{A}$ be an abelian category.
Let $A^\bullet$ be a cochain complex
with boundary maps $d_A^n : A^n \to A^{n + 1}$.
For any $k \in \mathbf{Z}$ we identify
{\it $H^{i + k}(A^\bullet) \longrightarrow H^i(A[k]^\bullet)$}
via the identification $A^{i + k} = A[k]^i$.
\end{definition}

\noindent
This identification is functorial in $A^\bullet$.
Note that since no signs are involved in this
definition we actually get a compatible system
of identifications of all the homology
objects $H^{i - k}(A[k]^\bullet)$, which are
further compatible with the identifications
$A[k][l]^\bullet = A[k + l]^\bullet$ and
with $[0] = \text{id}_{\text{CoCh}(\mathcal{A})}$.

\medskip\noindent
Let $\mathcal{A}$ be an additive category.
Suppose that $A^\bullet$ and $B^\bullet$ are
cochain complexes, $a, b : A^\bullet \to B^\bullet$ are
morphsms of cochain complexes, and $\{h^i : A^i \to B^{i - 1}\}$
is a homotopy between $a$ and $b$. Recall that this means
that
$a^i - b^i = d^{i - 1} \circ h^i + h^{i + 1} \circ d^i$.
What if $a = b$? Then we obtain the formula
$0 = d^{i - 1} \circ h^i + h^{i + 1} \circ d^i$,
in other words, $ - d^{i - 1} \circ h^i = h^{i + 1} \circ d^i$.
By definition above this means the collection $\{h^i\}$
above defines a morphism of cochain complexes
$$
A^\bullet \longrightarrow B[-1]^\bullet.
$$
Such a thing is the same as a morphism $A[1]^\bullet \to B^\bullet$
by our remarks above. This proves the following lemma.

\begin{lemma}
\label{lemma-homotopy-shift-cochain}
Let $\mathcal{A}$ be an additive category.
Suppose that $A^\bullet$ and $B^\bullet$ are
cochain complexes. Given any morphism of cochain
complexes $a : A^\bullet \to B^\bullet$ there
is a bijection between the set of homotopies
from $a$ to $a$ and
$\text{Mor}_{\text{CoCh}(\mathcal{A})}(A^\bullet, B[-1]^\bullet)$.
More generally, the set of homotopies between
$a$ and $b$ is either empty or a principal homogenous
space under the group
$\text{Mor}_{\text{CoCh}(\mathcal{A})}(A^\bullet, B[-1]^\bullet)$.
\end{lemma}

\begin{proof}
See above.
\end{proof}

\begin{lemma}
\label{lemma-ses-termwise-split-cochain}
Let $\mathcal{A}$ be an additive category.
Let
$$
0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0
$$
be a complex (!) of complexes.
Suppose that we are given splittings $B^n = A^n \oplus C^n$
compatible with the maps in the displayed sequence.
Let $s^n : C^n \to B^n$ and $\pi^n : B^n \to A^n$ be the
corresponding maps. Then the family of morphisms
$$
\pi^{n + 1} \circ d_B^n \circ s^n
:
C^n \to A^{n + 1}
$$
define a morphism of complexes $\delta : C^\bullet \to A[1]^\bullet$.
\end{lemma}

\begin{proof}
Denote $i : A^\bullet \to B^\bullet$ and $q : B^\bullet \to C^\bullet$
the maps of complexes in the short exact sequence. Then
$i^{n + 1} \circ \pi^{n + 1} \circ d_B^n \circ s^n =
d_B^n \circ s^n - s^{n + 1} \circ d_C^n$. Hence
$i^{n + 2} \circ d_A^{n + 1} \circ \pi^{n + 1} \circ d_B^n \circ s^n =
d_B^{n + 1} \circ (d_B^n \circ s^n - s^{n + 1} \circ d_C^n) =
- d_B^{n + 1} \circ s^{n + 1} \circ d_C^n$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-ses-termwise-split-long-cochain}
Notation and assumptions as in
Lemma \ref{lemma-ses-termwise-split-cochain} above.
Assume in addition that $\mathcal{A}$ is abelian.
The morphism of complexes $\delta : C^\bullet \to A[1]^\bullet$
induces the maps
$$
H^i(\delta) :
H^i(C^\bullet) \longrightarrow H^i(A[1]^\bullet) = H^{i + 1}(A^\bullet)
$$
which occur in the long exact homology sequence associated
to the short exact sequence of cochain complexes by
Lemma \ref{lemma-long-exact-sequence-cochain}.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-ses-termwise-split-homotopy-cochain}
Notation and assumptions as in
Lemma \ref{lemma-ses-termwise-split-cochain} above.
Suppose $\{t^n : C^n \to B^n\}$ is a second choice of splittings.
Write $t^n = s^n + \pi^n \circ h^n$ for some unique
morphisms $h^n : C^n \to A^n$. The family of maps
$\{h^n : C^n \to A[1]^{n - 1}\}$ is a homotopy between
the associated morphisms
$\delta(s), \delta(t) : C^\bullet \to A[1]^\bullet$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}












\section{Spectral sequences}
\label{section-spectral-sequence}

\noindent
A nice discussion of spectral sequences may be found in
\cite{Eisenbud}. See also \cite{McCleary}, \cite{Lang}, etc.

\begin{definition}
\label{definition-spectral-sequence}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item A {\it spectral sequence in $\mathcal{A}$} is given by a
system $(E_r, d_r)_{r \geq 1}$ where each $E_r$ is an object
of $\mathcal{A}$, each $d_r : E_r \to E_r$ is a morphism such
that $d_r \circ d_r = 0$ and $E_{r + 1} = \text{Ker}(d_r)/\text{Im}(d_r)$
for $r \geq 1$.
\item A {\it morphism of spectral sequences}
$f : (E_r, d_r)_{r \geq 1} \to (E'_r, d'_r)_{r \geq 1}$ is
given by a family of morphisms $f_r : E_r \to E'_r$ such that
$f_r \circ d_r = d'_r \circ f_r$ and such that $f_{r + 1}$
is the morphism induced by $f_r$ via the identifications
$E_{r + 1} = \text{Ker}(d_r)/\text{Im}(d_r)$
and
$E'_{r + 1} = \text{Ker}(d'_r)/\text{Im}(d'_r)$.
\end{enumerate}
\end{definition}

\noindent
We will sometimes loosen this definition somewhat and allow $E_{r + 1}$
to be an object with a given isomorphism
$E_{r + 1} \to \text{Ker}(d_r)/\text{Im}(d_r)$.
In addition we sometimes have a system $(E_r, d_r)_{r \geq r_0}$
for some $r_0$ satsifying the properties of the definition above
for indices $\geq r$. We will also call this a spectral sequence since by
a simple renumbering it falls under the definition anyway.
In fact, sometimes it makes sense to allow $r_0 = 0$ or even $r_0 = -1$
due to conventions in the literature.

\medskip\noindent
Given a spectral sequence $(E_r, d_r)_{r \geq 1}$ we define
$$
0 = B_1 \subset B_2 \subset \ldots \subset B_r \subset \ldots
\subset Z_r \subset \ldots \subset Z_2 \subset Z_1 = E_1
$$
by the following simple procedure. Set $B_2 = \text{Im}(d_1)$
and $Z_2 = \text{Ker}(d_1)$. Then it is clear that
$d_2 : Z_2/B_2 \to Z_2/B_2$. Hence we can define $B_3$ as the unique
subobject of $E_1$ containing $B_2$ such that $B_3/B_2$ is the image
of $d_2$. Similarly we can define $Z_3$ as the unique subobject of
$E_1$ containing $B_2$ such that $Z_3/B_2$ is the kernel of $d_2$.
And so on and so forth. In particular we have
$$
E_r = Z_r/B_r
$$
for all $r \geq 1$. I case the spectral sequence starts at $r = r_0$
then we can similarly construct $B_i$, $Z_i$ as subobjects in $E_{r_0}$.

\begin{definition}
\label{definition-limit-spectral-sequence}
Let $\mathcal{A}$ be an abelian category.
Let $(E_r, d_r)_{r \geq 1}$ be a spectral sequence.
\begin{enumerate}
\item If the subobjects $Z_{\infty} = \bigcap Z_r$
and $B_{\infty} = \bigcup B_r$ of $E_1$ exist then we define
the {\it limit} of the spectral sequence to be the object
$$
E_{\infty} = Z_{\infty}/B_{\infty}.
$$
\item We say that the spectral sequence {\it collapses at $E_r$}, or
{\it degenerates at $E_r$} if the differentials $d_r, d_{r + 1}, \ldots$ are
all zero.
\end{enumerate}
\end{definition}

\noindent
Note that if the spectral sequence collapses at $E_r$, then
we have $E_r = E_{r + 1} = \ldots = E_{\infty}$ (and the limit
exists of course). Also, almost any abelian category we will encounter
has countable sums and intersections.











\section{The spectral sequence of an exact couple}
\label{section-exact-couple}

\begin{definition}
\label{definition-exact-couple}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item An {\it exact couple} is a datum $(A, E, \alpha, f, g)$ where
$A$, $E$ are objects of $\mathcal{A}$ and $\alpha$, $f$, $g$
are morphisms as in the following diagram
$$
\xymatrix{
A \ar[rr]_{\alpha} & & A \ar[ld]^g \\
& E \ar[lu]^f &
}
$$
with the property that the kernel of each arrow is the image
of its predecessor. So $\text{Ker}(\alpha) = \text{Im}(f)$,
$\text{Ker}(f) = \text{Im}(g)$, and $\text{Ker}(g) = \text{Im}(\alpha)$.
\item A {\it morphism of exact couples}
$t : (A, E, \alpha, f, g) \to (A', E', \alpha', f', g')$
is given by morphisms $t_A : A \to A'$ and
$t_E : E \to E'$ such that
$\alpha' \circ t_A = t_A \circ \alpha$, 
$f' \circ t_E = t_A \circ f$, and
$g' \circ t_A = t_E \circ g$.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-derived-exact-couple}
Let $\mathcal{A}$ be an abelian category.
Let $(A, E, \alpha, f, g)$ be an exact couple.
Set
\begin{enumerate}
\item $d = g \circ f : E \to E$ so that $d \circ d = 0$,
\item $E' = \text{Ker}(d)/\text{Im}(d)$,
\item $A' = \text{Im}(\alpha)$,
\item $\alpha' : A' \to A'$ induced by $\alpha$,
\item $f' : E' \to A'$ induced by $f$,
\item $g' : A' \to E'$ induced by ``$g \circ \alpha^{-1}$''.
\end{enumerate}
Then we have
\begin{enumerate}
\item $\text{Ker}(d) = f^{-1}(\text{ker}(g)) = f^{-1}(\text{Im}(\alpha))$,
\item $\text{Im}(d) = g(\text{Im}(f)) = g(\text{Ker}(\alpha))$,
\item $(A', E', \alpha', f', g')$ is an exact couple.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
Hence it is clear that given an exact couple $(A, E, \alpha, f, g)$
we get a spectral sequence by setting $E_1 = E$, $d_1 = d$,
$E_2 = E'$, $d_2 = d' = g' \circ f'$, $E_3 = E''$, $d_3 = d'' = g'' \circ f''$,
and so on.

\begin{definition}
\label{definition-spectral-sequence-associated-exact-couple}
Let $\mathcal{A}$ be an abelian category.
Let $(A, E, \alpha, f, g)$ be an exact couple.
The {\it spectral sequence associated to the exact couple}
is the spectral sequence $(E_r, d_r)_{r \geq 1}$ with
$E_1 = E$, $d_1 = d$, $E_2 = E'$, $d_2 = d' = g' \circ f'$,
$E_3 = E''$, $d_3 = d'' = g'' \circ f''$,
and so on.
\end{definition}

\begin{lemma}
\label{lemma-spectral-sequence-associated-exact-couple}
Let $\mathcal{A}$ be an abelian category.
Let $(A, E, \alpha, f, g)$ be an exact couple.
Let $(E_r, d_r)_{r \geq 1}$ be the spectral sequence
associated to the exact couple.
In this case we have
$$
0 = B_1 \subset \ldots \subset
B_{r + 1} = g(\text{ker}(\alpha^r))
\subset \ldots \subset
Z_{r + 1} = f^{-1}(\text{Im}(\alpha^r))
\subset \ldots \subset Z_1 = E
$$
and the map $d_{r + 1} : E_{r + 1} \to E_{r + 1}$
is described by the following rule:
For any (test) object $T$ of $\mathcal{A}$ and any elements
$x : T \to Z_{r + 1}$ and $y : T \to A$ such that
$f \circ x = \alpha^r \circ y$ we have
$$
d_r \circ \overline{x} = \overline{g \circ y}
$$
where $\overline{x} : T \to E_{r + 1}$ is the
induced morphism.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
Note that in the situation of the lemma we obviously have
$$
B_\infty = g\left(\bigcup\nolimits_r \text{Ker}(\alpha^r)\right)
\subset
Z_\infty = f^{-1}\left(\bigcap\nolimits_r \text{Im}(\alpha^r)\right)
$$
provided this exist and in this case $E_\infty = Z_\infty / B_\infty$.






\section{Differential objects and spectral sequences}
\label{section-differential-object}

\begin{definition}
\label{definition-differential-object}
Let $\mathcal{A}$ be an abelian category.
A {\it differential object} of $\mathcal{A}$
is a pair $(A, d)$ consisting of an
object $A$ of $\mathcal{A}$
endowed with a selfmap $d$ such that $d \circ d = 0$.
A {\it morphism of differential objects} $(A, d) \to (B, d)$
is given by a morphism $\alpha : A \to B$ such that
$d \circ \alpha = \alpha \circ d$.
\end{definition}

\begin{lemma}
\label{lemma-differential-objects-abelian}
Let $\mathcal{A}$ be an abelian category.
The category of differential objects of $\mathcal{A}$ is abelian.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-differential-object-homology}
For a differential object $(A, d)$ we denote
$$
H(A, d) = \text{Ker}(d)/\text{Im}(d)
$$
its {\it homology}.
\end{definition}

\begin{lemma}
\label{lemma-differential-objects-ses}
Let $\mathcal{A}$ be an abelian category.
Let $0 \to (A, d) \to (B, d) \to (C, d) \to 0$ be a short exact sequence
of differential objects. Then we get an exact homology sequence
$$
\ldots \to H(C, d) \to H(A, d) \to H(B, d) \to H(C, d) \to \ldots
$$
\end{lemma}

\begin{proof}
Apply Lemma \ref{lemma-long-exact-sequence-cochain}
to the short exact sequence of complexes
$$
\begin{matrix}
0 & \to & A & \to & B & \to & C & \to & 0 \\
& & \downarrow & & \downarrow & & \downarrow \\
0 & \to & A & \to & B & \to & C & \to & 0 \\
& & \downarrow & & \downarrow & & \downarrow \\
0 & \to & A & \to & B & \to & C & \to & 0
\end{matrix}
$$
\end{proof}

\noindent
We come to an important example of a spectral sequence.
Let $\mathcal{A}$ be an abelian category.
Let $(A, d)$ be a differential object of $\mathcal{A}$.
Let $\alpha : (A, d) \to (A, d)$ be an endomorphism of this differential
object. If we assume $\alpha$ injective, then we get a short exact sequence
$$
0 \to (A, d) \to (A, d) \to (A/\alpha A, d) \to 0
$$
of differential objects. By the
Lemma \ref{lemma-differential-objects-ses} we get an exact couple
$$
\xymatrix{
H(A, d) \ar[rr]_{\overline{\alpha}} & & H(A, d) \ar[ld]^g \\
& H(A/\alpha A, d) \ar[lu]^f &
}
$$
where $g$ is the canonical map and $f$ is the map defined in the snake lemma.
Thus we get an associated spectral sequence!
Since in this case we have $E_1 = H(A/\alpha A, d)$ we
see that it makes sense to define $E_0 = A/\alpha A$
and $d_0 = d$. In other words, we start the spectral sequence
with $r = 0$. According to our conventions in
Section \ref{section-spectral-sequence} we define a sequence of subobjects
$$
0 = B_0 \subset \ldots \subset B_r \subset \ldots
\subset Z_r \subset \ldots \subset Z_0 = E_0
$$
with the property that $E_r = Z_r/B_r$. Namely we have
for $r \geq 1$ that
\begin{enumerate}
\item $B_r$ is the image of $(\alpha^{r - 1})^{-1}(d A)$
under the natural map $A \to A/\alpha A$,
\item $Z_r$ is the image of $d^{-1}(\alpha^r A)$
under the natural map $A \to A/\alpha A$, and
\item $d_r : E_r \to E_r$ is given as follows: given an element $z \in Z_r$
choose an element $y \in A$ such that $d(z) = \alpha^r(y)$. Then
$d_r(z + B_r + \alpha A) = y + B_r + \alpha A$.
\end{enumerate}
Warning: It is not necessarily the case that
$\alpha A \subset (\alpha^{r - 1})^{-1}(dA)$, nor
$\alpha A \subset d^{-1}(\alpha^r A)$. It is true that
$(\alpha^{r - 1})^{-1}(dA) \subset d^{-1}(\alpha^r A)$.
We have
$$
E_r
=
\frac{d^{-1}(\alpha^r A) + \alpha A}{(\alpha^{r - 1})^{-1}(dA) + \alpha A}.
$$
It is not hard to verify directly that (1) -- (3) give a spectral sequence.

\begin{definition}
\label{definition-differential-object-selfmap}
Let $\mathcal{A}$ be an abelian category.
Let $(A, d)$ be a differential object of $\mathcal{A}$.
Let $\alpha : A \to A$ be an injective selfmap of $A$ which
commutes with $d$. The {\it spectral sequence associated to
$(A, d, \alpha)$} is the spectral sequence
$(E_r, d_r)_{r \geq 0}$ described above.
\end{definition}








\section{Filtrations}
\label{section-filtrations}

\noindent
A nice reference for this material is \cite[Section 1]{HodgeII}.
(Note that our conventions regarding abelian categories are different.)

\begin{definition}
\label{definition-filtered}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item A {\it decreasing filtration} $F$ on an object $A$
is a family $(F^nA)_{n \in \mathbf{Z}}$ of subobjects of $A$ such that
$$
A \supset \ldots \supset F^nA \supset F^{n + 1}A \supset \ldots \supset 0
$$
\item A {\it filtered object of $\mathcal{A}$} is
pair $(A, F)$ consisting of an object $A$ of $\mathcal{A}$
and a decreasing filtration $F$ on $A$.
\item A {\it morphism $(A, F) \to (B, F)$ of filtered objects}
is given by a morphism $\varphi : A \to B$ of $\mathcal{A}$
such that $\varphi(F^iA) \subset F^iB$ for all $i \in \mathbf{Z}$.
\item The category of filtered objects is denoted $\text{Fil}(\mathcal{A})$.
\item Given a filtered object $(A, F)$ and a subobject $X \subset A$ the
{\it induced filtration} on $X$ is the filtration with $F^nX = X \cap F^nA$.
\item Given a filtered object $(A, F)$ and a surjection
$\pi : A \to Y$ the {\it quotient filtration} is the filtration with
$F^nY = \pi(F^nA)$.
\item A filtration $F$ on an object $A$ is said to be {\it finite}
if there exist $n, m$ such that $F^nA = A$ and $F^mA = 0$.
\item  The filtration on a filtered object $(A, F)$ is said to be
{\it separated} if $\bigcap_i F^iA = 0$ and
{\it exhaustive} if $\bigcup F^iA = A$.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-filtered}
Let $\mathcal{A}$ be an abelian category.
The category of filtered objects $\text{Fil}(\mathcal{A})$
has the following properties:
\begin{enumerate}
\item It is an additive category.
\item It has a zero object.
\item It has kernels and cokernels, images and coimages.
\item In general it is not an abelian category.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted. Hints: The kernel of a morphism $f : A \to B$ of filtered
objects is $\text{Ker}(f)$ with filtration
$F^i\text{Ker}(f) = \text{Ker}(f) \cap F^iA$.
The cokernel of a morphism $f : A \to B$ of filtered
objects is $\text{Coker}(f)$ with filtration
$F^i\text{Coker}(f) = \text{Im}(F^iB \to \text{Coker}(f))$.
See Example \ref{example-not-abelian} for the last statement.
\end{proof}

\begin{definition}
\label{definition-strict}
Let $\mathcal{A}$ be an abelian category.
A morphism $f : A \to B$ of filtered objects of $\mathcal{A}$ is
said to be {\it strict} if $f(F^iA) = f(A) \cap F^iB$ for
all $i \in \mathbf{Z}$.
\end{definition}

\noindent
This also equivalent to requiring that $f^{-1}(F^iB) = F^iA + \text{Ker}(f)$
for all $i \in \mathbf{Z}$. We will characterize strict morphisms in
Lemma \ref{lemma-characterize-strict} below.

\begin{lemma}
\label{lemma-induced-and-quotient-strict}
Let $\mathcal{A}$ be an abelian category.
Let $(A, F)$, $(B, F)$ be filtered objects.
Let $u : A \to B$ be a morphism of filtered objects.
If $u$ is injective then $u$ is strict if and only if the filtration
on $A$ is the induced filtration.
If $u$ is surjective then $u$ is strict if and only if the filtration
on $B$ is the quotient filtration.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-graded}
Let $\mathcal{A}$ be an abelian category.
A {\it graded object of $\mathcal{A}$} is
pair $(A, k)$ consisting of an object $A$ of $\mathcal{A}$
and a direct sum decomposition
$$
A = \bigoplus\nolimits_{i \in \mathbf{Z}} k^iA
$$
by subobjects indexed by $\mathbf{Z}$.
A {\it morphism $(A, k) \to (B, k)$ of graded objects}
is given by a morphism $\varphi : A \to B$ of $\mathcal{A}$
such that $\varphi(k^iA) \subset k^iB$ for all $i \in \mathbf{Z}$.
The category of graded objects is denoted $\text{Gr}(\mathcal{A})$.
\end{definition}

\noindent
With our definitions an abelian category does not necessarily have
all (countable) direct sums. Of course the definition above still
makes sense, but may be a little misleading in case $\mathcal{A}$
does not have infinite direct sums. For example, if
$\mathcal{A} = \text{Vect}_k$ is the category of finite dimensional vector
spaces over a field $k$, then $\text{Gr}(\text{Vect}_k)$ is the category
of finite dimensional vector spaces with a given gradation,
and not the category of graded vector spaces all of whose graded
pieces are finite dimensional.

\begin{lemma}
\label{lemma-graded}
Let $\mathcal{A}$ be an abelian category.
The category of graded objects $\text{Gr}(\mathcal{A})$
is abelian.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
There is a canonical functor
$$
\text{gr} :
\text{Fil}(\mathcal{A})
\longrightarrow
\text{Gr}(\mathcal{A}), \ \ 
(A, F)
\mapsto
\text{gr}(A) =
\bigoplus\nolimits_{i \in \mathbf{Z}} F^iA/F^{i + 1}A.
$$
We sometimes denote $\text{gr}^i_F(A)$ the object
$F^iA/F^{i + 1}A = k^i\text{gr}(A)$.

\begin{lemma}
\label{lemma-characterize-strict}
Let $\mathcal{A}$ be an abelian category.
Let $f : A \to B$ be a morphism of filtered objects of $\mathcal{A}$.
The following are equivalent
\begin{enumerate}
\item $f$ is strict,
\item the canonical morphism $\text{Coim}(f) \to \text{Im}(f)$
(see Lemma \ref{lemma-coim-im-map}) is an isomorphism.
\end{enumerate}
If the filtrations on $A$ and $B$ are finite then these conditions
are also equivalent to
\begin{enumerate}
\item[(3)] the sequence
$\text{gr}(\text{Ker}(f)) \to \text{gr}(A) \to \text{gr}(B)$
is exact,
\item[(4)] the sequence $\text{gr}(A) \to \text{gr}(B) \to
\text{gr}(\text{Coker}(f))$ is exact, and
\item[(5)] the sequence
$$
0 \to
\text{gr}(\text{Ker}(f)) \to
\text{gr}(A) \to
\text{gr}(B) \to
\text{gr}(\text{Coker}(f)) \to 0
$$
is exact.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-filtered-complex}
Let $\mathcal{A}$ be an abelian category. Let $A \to B \to C$ be a complex
of filtered objects of $\mathcal{A}$. Assume $\alpha : A \to B$ and
$\beta : B \to C$ are strict morphisms of filtered objects. Then
$\text{gr}(\text{Ker}(\beta)/\text{Im}(\alpha)) =
\text{Ker}(\text{gr}(\beta))/\text{Im}(\text{gr}(\alpha)))$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
The following lemma says that subobjects of a filtered object have a well
defined filtration independent of a choice of writing the object as a
cokernel.

\begin{lemma}
\label{lemma-filtration-subobject}
Let $\mathcal{A}$ be an abelian category.
Let $(A, F)$ be a filtered object of $\mathcal{A}$.
Let $X \subset Y \subset A$ be subobjects of $A$.
On the object
$$
Y/X = \text{Ker}(A/X \to A/Y)
$$
the quotient filtration coming from the induced filtration on $Y$ and the
induced filtration coming from the quotient filtration on $A/X$ agree.
Any of the morphisms $X \to Y$, $X \to A$, $Y \to A$, $Y \to A/X$,
$Y \to Y/X$, $Y/X \to A/X$ are strict (with induced/quotient filtrations).
\end{lemma}

\begin{proof}
Omitted.
\end{proof}












\section{The spectral sequence of a filtered differential object}
\label{section-filtered-differential}

\begin{definition}
\label{definition-filtered-differential}
Let $\mathcal{A}$ be an abelian category.
A {\it filtered differential object} $(K, F, d)$ is a filtered object
$(K, F)$ of $\mathcal{A}$ endowed with an endomorphism
$d : (K, F) \to (K, F)$ whose square is zero: $d \circ d = 0$.
\end{definition}

\noindent
Let $\mathcal{A}$ be an abelian category.
Let $(K, F, d)$ be a filtered differential object of $\mathcal{A}$.
Note that each $F^nK$ is a differential object by itself.
Assume $\mathcal{A}$ has countable direct sums.
In this case set $A = \bigoplus F^nK$ and endow it with a differential
$d$ by using $d$ on each summand. Consider the map
$$
\alpha : A \to A
$$
which maps the summand $F^nA$ into the summand
$F^{n - 1}A$. This is clearly an injective morphism of differential
modules $\alpha : (A, d) \to (A, d)$. Hence, by
Definition \ref{definition-differential-object-selfmap}
we get a spectral sequence.
We will call this {\it the spectral sequence associated to
the filtered differential object $(K, F, d)$}.

\medskip\noindent
Let us figure out the terms of this spectral sequence.
First, note that $A/\alpha A = \text{gr}(K)$
endowed with its differential $d = \text{gr}(d)$. Hence we see that
$$
E_0 = \text{gr}(K), \quad d_0 = \text{gr}(d).
$$
Hence the homology of the graded differential object $\text{gr}(K)$
is the next term:
$$
E_1 = H(\text{gr}(K), \text{gr}(d)).
$$
In addition we see that $E_0$ is a graded object of $\mathcal{A}$
and that $d_0$ is compatible with the grading. Hence clearly $E_1$
is a graded object as well. But it turns out that the differential
$d_1$ does not preserve this grading; instead it shifts the degree by $1$.

\medskip\noindent
To work this out precisely, we define
$$
Z_r^p =
\frac{F^pK \cap d^{-1}(F^{p + r}K) + F^{p + 1}K}{F^{p + 1}K}
$$
and
$$
B_r^p =
\frac{F^pK \cap d(F^{p - r + 1}K) + F^{p + 1}K}{F^{p + 1}K}.
$$
This notation, allthough quite natural, seems to be different from the
notation in most places in the literature. Perhaps it does not matter,
since the literature does not seem to have a consistent choice of notation
either. With these choices we see that $B_r \subset E_0$,
resp.\ $Z_r \subset E_0$ (as defined in
Section \ref{section-differential-object}) is equal to
$\bigoplus_p B_r^p$, resp.\ $\bigoplus_p Z_r^p$.
Hence if we define
$$
E_r^p = Z_r^p/B_r^p
$$
for $r \geq 0$ and $p \in \mathbf{Z}$, then we have $E_r = \bigoplus_p E_r^p$.
We can define a differential $d_r^p : E_r^p \to E_r^{p + r}$
by the rule
$$
z + F^{p + 1}K
\longmapsto
dz + F^{p + r + 1}K
$$
where $z \in F^pK \cap d^{-1}(F^{p + r}K)$.

\begin{lemma}
\label{lemma-spectral-sequence-filtered-differential}
Let $\mathcal{A}$ be an abelian category.
Let $(K, F, d)$ be a filtered differential object of $\mathcal{A}$.
Assume $\mathcal{A}$ has countable direct sums.
The spectral sequence $(E_r, d_r)_{r \geq 0}$
associated to $(K, F, d)$ has terms
$$
E_r = \bigoplus\nolimits_{p \in \mathbf{Z}} E_r^p,
\quad
d_r = \bigoplus\nolimits_{p \in \mathbf{Z}} d_r^p.
$$
Furthermore, we have
$E_0^p = \text{gr}^p K$, $d_0 = \text{gr}(d)$,
and $E_1^p = H(\text{gr}^p(K), d)$.
\end{lemma}

\begin{proof}
Follows from the discussion above.
\end{proof}

\begin{lemma}
\label{lemma-spectral-sequence-filtered-differential-d1}
Let $\mathcal{A}$ be an abelian category.
Let $(K, F, d)$ be a filtered differential object of $\mathcal{A}$.
Assume $\mathcal{A}$ has countable direct sums.
The spectral sequence $(E_r, d_r)_{r \geq 0}$
associated to $(K, F, d)$ has
$$
d_1^p :
E_1^p = H(\text{gr}^p(K))
\longrightarrow
E_1^{p + 1} = H(\text{gr}^{p + 1}(K))
$$
equal to the boundary map in homology associated to the short
exact sequence of differential objects
$$
0 \to \text{gr}^{p + 1}(K) \to F^pK/F^{p + 2}K \to \text{gr}^{p + 1}(K) \to 0.
$$
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-filtration-cohomology-filtered-differential}
Let $\mathcal{A}$ be an abelian category.
Let $(K, F, d)$ be a filtered differential object of $\mathcal{A}$.
The {\it induced filtration} on $H(K, d)$ is the filtration defined
by $F^pH(K, d) = \text{Im}(H(F^pK, d) \to H(K, d))$.
\end{definition}

\begin{lemma}
\label{lemma-compute-filtered-cohomology}
Let $\mathcal{A}$ be an abelian category.
Let $(K, F, d)$ be a filtered differential object of $\mathcal{A}$.
The associated graded $\text{gr}(H(K))$ of the cohomology of
$K$ is a graded subquotient of the graded object
$E_\infty = \bigoplus E_\infty^p$.
\end{lemma}

\begin{proof}
Recall that $E_\infty = Z_\infty/B_\infty$ by definition, with
$B_\infty = \bigcup B_r$ and $Z_\infty = \bigcap Z_r$. Hence
$E_\infty = \bigoplus E_\infty^p$ with $E_\infty^p = Z_\infty^p/B_\infty^p$
with $B_\infty^p = \bigcup B_r^p$ and $Z_\infty^p = \bigcap Z_r^p$. Thus
$$
E_\infty^p =
\frac{\bigcap_r (F^pK \cap d^{-1}(F^{p + r}K) + F^{p + 1}K)}
{\bigcup_r (F^pK \cap d(F^{p - r + 1}K) + F^{p + 1}K)}.
$$
On the other hand, we have
$$
\text{gr}^p H(K) =
\frac{\text{Ker}(d) \cap F^pK + F^{p + 1}K}
{\text{Im}(d) \cap F^pK + F^{p + 1}K}
$$
The result follows since
\begin{equation}
\label{equation-on-top}
\text{Ker}(d) \cap F^pK + F^{p + 1}K
\subset
\bigcup\nolimits_r \left(F^pK \cap d^{-1}(F^{p + r}K) + F^{p + 1}K\right)
\end{equation}
and
\begin{equation}
\label{equation-at-bottom}
\bigcap\nolimits_r \left(F^pK \cap d(F^{p - r + 1}K) + F^{p + 1}K\right)
\subset
\text{Im}(d) \cap F^pK + F^{p + 1}K.
\end{equation}
\end{proof}

\begin{definition}
\label{definition-filtered-differential-ss-converges}
Let $\mathcal{A}$ be an abelian category.
Let $(K, F, d)$ be a filtered differential object of $\mathcal{A}$.
We say the spectral sequence associated to $(K, F, d)$
{\it converges} if $\text{gr}(H(K)) = E_{\infty}$ via
Lemma \ref{lemma-compute-filtered-cohomology}.
In this case we also say that $(E_r, d_r)_{r \geq 0}$ {\it abuts to}
or {\it converges to} $H(K)$.
\end{definition}

\noindent
In the literature one finds more refined notions distinguishing between
``weakly converging'', ``abutting'' and ``converging''. Namely, one can
require the filtration on $H(K)$ to be either ``arbitrary'', or
``exhaustive and separated'', or ``exhaustive and complete'' in addition
to the condition that $\text{gr}(H(K)) = E_\infty$. We try to avoid introducing
this notation by simply adding the relevant information in the statements
of the results.

\begin{lemma}
\label{lemma-filtered-differential-ss-converges}
Let $\mathcal{A}$ be an abelian category.
Let $(K, F, d)$ be a filtered differential object of $\mathcal{A}$.
The associated spectral sequence converges if and only if for every
$p \in \mathbf{Z}$ we have equality in equations
(\ref{equation-at-bottom}) and (\ref{equation-on-top}).
\end{lemma}

\begin{proof}
Immediate from the discussions above.
\end{proof}














\section{The spectral sequence of a filtered complex}
\label{section-filtered-complex}

\begin{definition}
\label{definition-filtered-complex}
Let $\mathcal{A}$ be an abelian category.
A {\it filtered complex $K^\bullet$ of $\mathcal{A}$}
is a complex of $\text{Fil}(\mathcal{A})$ (see
Definition \ref{definition-filtered}).
\end{definition}

\noindent
We will denote the filtration on the objects by $F$. Thus
$F^pK^n$ denotes the $p$th step in the filtration of the $n$th term of the
complex. Note that each $F^pK^\bullet$ is a complex of $\mathcal{A}$.
Hence we could also have defined a filtered complex as a filtered object
in the (abelian) category of complexes of $\mathcal{A}$.
In particular $\text{gr} K^\bullet$ is a graded object of the
category of complexes of $\mathcal{A}$.

\medskip\noindent
Let us denote $d$ the differential of $K$. Forgetting the grading
we can think of $\bigoplus K^n$ as a filtered differential object of
$\mathcal{A}$. Hence according to Section \ref{section-filtered-differential}
we obtain a spectral sequence $(E_r, d_r)_{r \geq 0}$.
In this section we work out the terms
of this spectral sequence, and we endow the terms of this spectral seqeunce
with additional structure coming from the grading of $K$.

\medskip\noindent
First we point out that $E_0^p = \text{gr}^p K^\bullet$ is a
complex and hence is graded. Thus $E_0$ is bigraded in a natural
way. It is customary to use the bigrading
$$
E_0 = \bigoplus_{p, q} E_0^{p, q},
\quad
E_0^{p, q} = \text{gr}^p K^{p + q}
$$
The idea is that $p + q$ should be thought of as the {\it total degree} of
the (co)homology classes. Also, $p$ is called the {\it filtration degree},
and $q$ is called the {\it complementary degree}.
The differential $d_0$ is compatible with this
bigrading in the following way
$$
d_0  = \bigoplus d_0^{p, q},
\quad
d_0^{p, q} : E_0^{p, q} \to E_0^{p, q + 1}.
$$
Namely, $d_0^p$ is just the differential on the complex
$\text{gr}^p K^\bullet$ (which occurs as $\text{gr}^pE_0$ just shifted
a bit).

\medskip\noindent
To go further we identify the objects $B_r^p$ and $Z_r^p$ introduced
in Section \ref{section-filtered-differential} as graded objects and
we work out the corresponding decompositions of the differentials.
We do this in a completely straightforward manner, but again we warn
the reader that our notation is not the same as notation found
elsewhere. We define
$$
Z_r^{p, q} =
\frac{F^pK^{p + q} \cap d^{-1}(F^{p + r}K^{p + q + 1}) + F^{p + 1}K^{p + q}}
{F^{p + 1}K^{p + q}}
$$
and
$$
B_r^{p, q} =
\frac{F^pK^{p + q} \cap d(F^{p - r + 1}K^{p + q - 1}) + F^{p + 1}K^{p + q}}
{F^{p + 1}K^{p + q}}.
$$
and of course $E_r^{p, q} = Z_r^{p, q}/B_r^{p, q}$.
With these definitions it is completely clear that
$Z_r^p = \bigoplus_q Z_r^{p, q}$,
$B_r^p = \bigoplus_q B_r^{p, q}$, and
$E_r^p = \bigoplus_q E_r^{p, q}$. Moreover,
$$
0 \subset \ldots \subset B_r^{p, q} \subset
\ldots
\subset Z_r^{p, q} \subset \ldots \subset E_0^{p, q}
$$
and hence it makes sense to define $Z_\infty^{p, q} = \bigcap_r Z_r^{p, q}$
and $B_\infty^{p, q} = \bigcup_r B_r^{p, q}$ and
$E_\infty^{p, q} = Z_\infty^{p, q}/B_\infty^{p, q}$.
Also, the map $d_r^p$ decomposes as the direct sum of the maps
$$
d_r^{p, q} : E_r^{p, q} \longrightarrow E_r^{p + r, q - r + 1},
\quad
z + F^{p + 1}K^{p + q}
\mapsto
dz + F^{p + r + 1}K^{p + q + 1}
$$
where $z \in F^pK^{p + q} \cap d^{-1}(F^{p + r}K^{p + q + 1})$.

\begin{lemma}
\label{lemma-spectral-sequence-filtered-complex}
Let $\mathcal{A}$ be an abelian category.
Let $(K^\bullet, F)$ be a filtered complex of $\mathcal{A}$.
Assume $\mathcal{A}$ has countable direct sums.
The spectral sequence $(E_r, d_r)_{r \geq 0}$
associated to $(K^\bullet, F)$ has bigraded terms
$$
E_r = \bigoplus E_r^{p, q},
\quad
d_r = \bigoplus d_r^{p, q}.
$$
with $d_r$ of bidegree $(r, - r + 1)$.
Furthermore, we have
$E_0^{p, q} = \text{gr}^p(K^{p + q})$,
$d_0^{p, q} = \text{gr}^p(d^{p + q})$,
and $E_1^{p, q} = H^{p + q}(\text{gr}^p(K^\bullet))$.
\end{lemma}

\begin{proof}
Follows from the discussion above.
\end{proof}

\begin{lemma}
\label{lemma-spectral-sequence-filtered-complex-d1}
Let $\mathcal{A}$ be an abelian category.
Let $(K^\bullet, F)$ be a filtered complex of $\mathcal{A}$.
Assume $\mathcal{A}$ has countable direct sums.
Let $(E_r, d_r)_{r \geq 0}$ be the spectral sequence
associated to $(K^\bullet, F)$.
\begin{enumerate}
\item The map
$$
d_1^{p, q} : 
E_1^{p, q} = H^{p + q}(\text{gr}^p(K^\bullet))
\longrightarrow
E_1^{p + 1, q} = H^{p + q + 1}(\text{gr}^{p + 1}(K^\bullet))
$$
is equal to the boundary map in cohomology associated to the short
exact sequence of complexes
$$
0 \to \text{gr}^{p + 1}(K^\bullet) \to
F^pK^\bullet/F^{p + 2}K^\bullet \to \text{gr}^{p + 1}(K^\bullet) \to 0.
$$
\item Assume that $d(F^pK) \subset F^{p + 1}K$ for all $p \in \mathbf{Z}$.
Then $d$ induces the zero differential on $\text{gr}^p(K^\bullet)$
and hence
$E_1^{p, q} = \text{gr}^p(K^\bullet)^{p + q}$.
Furthermore, in this case
$$
d_1^{p, q} :
E_1^{p, q} = \text{gr}^p(K^\bullet)^{p + q}
\longrightarrow
E_1^{p, q} = \text{gr}^{p + 1}(K^\bullet)^{p + q + 1}
$$
is the morphism induced by $d$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted. But compare
Lemma \ref{lemma-spectral-sequence-filtered-differential-d1}.
\end{proof}

\begin{lemma}
\label{lemma-spectral-sequence-filtered-complex-functorial}
Let $\mathcal{A}$ be an abelian category.
Let $\alpha : (K^\bullet, F) \to (L^\bullet, F)$ be a morphism of
filtered complexes of $\mathcal{A}$. Assume $\mathcal{A}$ has
countable direct sums. Let $(E_r(K), d_r)_{r \geq 0}$, resp.\ 
$(E_r(L), d_r)_{r \geq 0}$ be the spectral sequence associated
to $(K^\bullet, F)$, resp.\ $(L^\bullet, F)$.
The morphism $\alpha$ induces a canonical morphism of spectral
sequences $\{\alpha_r : E_r(K) \to E_r(L)\}_{r \geq 0}$ compatible
with the bigradings.
\end{lemma}

\begin{proof}
Obvious from the explicit representation of the terms of the
spectral sequences.
\end{proof}

\begin{definition}
\label{definition-filtration-cohomology-filtered-complex}
Let $\mathcal{A}$ be an abelian category.
Let $(K^\bullet, F)$ be a filtered complex of $\mathcal{A}$.
The {\it induced filtration} on $H^n(K^\bullet)$ is the filtration defined
by $F^pH^n(K^\bullet) = \text{Im}(H^n(F^pK^\bullet) \to H^n(K^\bullet))$.
\end{definition}

\begin{lemma}
\label{lemma-compute-cohomology-filtered-complex}
Let $\mathcal{A}$ be an abelian category.
Let $(K^\bullet, F)$ be a filtered complex of $\mathcal{A}$.
The associated graded $\text{gr}(H^n(K^\bullet))$ of the cohomology of
$K^\bullet$ is a graded subquotient of the graded object
$\bigoplus_{p + q = n} E_\infty^{p, q}$.
\end{lemma}

\begin{proof}
Let $q = n - p$. As in the proof of
Lemma \ref{lemma-compute-filtered-cohomology} we see that
$$
E_\infty^{p, q} =
\frac{\bigcap_r (F^pK^{n} \cap d^{-1}(F^{p + r}K^{n + 1})
+ F^{p + 1}K^{n})}
{\bigcup_r (F^pK^{n} \cap d(F^{p - r + 1}K^{n - 1})
+ F^{p + 1}K^{n})}.
$$
On the other hand, we have
\begin{equation}
\label{equation-filtration-cohomology}
\text{gr}^p H^{n}(K) =
\frac{\text{Ker}(d) \cap F^pK^{n} + F^{p + 1}K^{n}}
{\text{Im}(d) \cap F^pK^{n} + F^{p + 1}K^{n}}
\end{equation}
The result follows since
\begin{equation}
\label{equation-on-top-bigraded}
\text{Ker}(d) \cap F^pK^{n} + F^{p + 1}K^{n}
\subset
\bigcup\nolimits_r
\left(
F^pK^{n} \cap d^{-1}(F^{p + r}K^{n + 1}) + F^{p + 1}K^{n}
\right)
\end{equation}
and
\begin{equation}
\label{equation-at-bottom-bigraded}
\bigcap\nolimits_r
\left(
F^pK^{n} \cap d(F^{p - r + 1}K^{n - 1}) + F^{p + 1}K^{n}
\right)
\subset
\text{Im}(d) \cap F^pK^{n} + F^{p + 1}K^{n}.
\end{equation}
\end{proof}

\begin{definition}
\label{definition-filtered-complex-ss-converges}
Let $\mathcal{A}$ be an abelian category.
Let $(K^\bullet, F)$ be a filtered complex of $\mathcal{A}$.
We say the spectral sequence associated to $(K^\bullet, F)$
{\it converges} if
$\text{gr} H^n(K^\bullet) = \bigoplus_{p + q = n} E_{\infty}^{p, q}$
for every $n \in \mathbf{Z}$.
\end{definition}

\noindent
This is often symbolized by the notation
$E_r^{p, q} \Rightarrow H^{p + q}(K^\bullet)$.
Please read the remarks following
Definition \ref{definition-filtered-differential-ss-converges}.

\begin{lemma}
\label{lemma-filtered-complex-ss-converges}
Let $\mathcal{A}$ be an abelian category.
Let $(K^\bullet, F)$ be a filtered complex of $\mathcal{A}$.
The associated spectral sequence converges if and only if for every
$p, q \in \mathbf{Z}$ we have equality in equations
(\ref{equation-at-bottom-bigraded}) and (\ref{equation-on-top-bigraded}).
\end{lemma}

\begin{proof}
Immediate from the discussions above.
\end{proof}

\begin{lemma}
\label{lemma-biregular-ss-converges}
Let $\mathcal{A}$ be an abelian category.
Let $(K^\bullet, F)$ be a filtered complex of $\mathcal{A}$.
Assume that the filtration on each $K^n$ is finite
(see Definition \ref{definition-filtered}).
Then
\begin{enumerate}
\item the filtration on each $H^n(K^\bullet)$ is finite, and
\item the spectral sequence associated to $(K^\bullet, F)$ converges.
\end{enumerate}
\end{lemma}

\begin{proof}
Part (1) is clear from Equation (\ref{equation-filtration-cohomology}).
We will use Lemma \ref{lemma-filtered-complex-ss-converges} to prove
part (2). Fix $p, n \in \mathbf{Z}$. Look at the left hand side of
Equation (\ref{equation-at-bottom-bigraded}). The expression is
equal to the right hand side since $F^mK^{n - 1} = 0$ for
$m \ll 0$. Similarly, use $F^mK^{n + 1} = K^{n + 1}$ for
$m \gg 0$ to prove equality in Equation (\ref{equation-on-top-bigraded}).
\end{proof}

























\section{The spectral sequences associated to a double complex}
\label{section-double-complex}

\begin{definition}
\label{definition-double-complex}
Let $\mathcal{A}$ be an additive category.
A {\it double complex} in $\mathcal{A}$ is given
by a system $(\{A^{p, q}, d_1^{p, q}, d_2^{p, q}\}_{p, q\in \mathbf{Z}})$,
where each $A^{p, q}$ is an object of $\mathcal{A}$ and
$d_1^{p, q} : A^{p, q} \to A^{p + 1, q}$ and
$d_2^{p, q} : A^{p, q} \to A^{p, q + 1}$ are morphisms of $\mathcal{A}$
such that the following rules hold:
\begin{enumerate}
\item $d_1^{p + 1, q} \circ d_1^{p, q} = 0$
\item $d_2^{p, q + 1} \circ d_2^{p, q} = 0$
\item $d_1^{p, q + 1} \circ d_2^{p, q} = d_2^{p + 1, q} \circ d_1^{p, q}$
\end{enumerate}
for all $p, q \in \mathbf{Z}$.
\end{definition}

\noindent
This is just the cochain version of the definition.
It says that each $A^{p, \bullet}$ is a cochain complex
and that each $d_1^{p, \bullet}$ is a morphism of complexes
$A^{p, \bullet} \to A^{p + 1, \bullet}$ such that
$d_1^{p + 1, \bullet} \circ d_1^{p, \bullet} = 0$ as morphisms
of complexes. In other words a double complex can be seen as
a complex of complexes. So in the diagram
$$
\xymatrix{
\ldots &
\ldots &
\ldots &
\ldots \\
\ldots \ar[r] &
A^{p, q + 1} \ar[r]^{d_1^{p, q + 1}} \ar[u] &
A^{p + 1, q + 1} \ar[r] \ar[u] &
\ldots \\
\ldots \ar[r] &
A^{p, q} \ar[r]^{d_1^{p, q}} \ar[u]^{d_2^{p, q}} &
A^{p + 1, q} \ar[r] \ar[u]_{d_2^{p + 1, q}} &
\ldots \\
\ldots &
\ldots \ar[u] &
\ldots \ar[u] &
\ldots
}
$$
any square commutes.
Warning: In the literature one encouters a different definition
where a ``bicomplex'' or  a ``double complex'' has the property that
the squares in the diagram anti-commute.

\medskip\noindent
It is customary to denote $H^p_{I}(K^{\bullet, \bullet})$
the complex with terms $\text{Ker}(d_1^{p, q})/\text{Im}(d_1^{p - 1, q})$
(varying $q$) and differential induced by $d_2$.
Then $H^q_{II}(H^p_{I}(K^{\bullet, \bullet}))$ denotes its cohomology in
degree $q$. It is also customary to denote $H^q_{II}(K^{\bullet, \bullet})$
the complex with terms $\text{Ker}(d_2^{p, q})/\text{Im}(d_2^{p, q - 1})$
(varying $p$) and differential induced by $d_1$.
Then $H^p_{I}(H^q_{II}(K^{\bullet, \bullet}))$ denotes its cohomology in
degree $q$.

\begin{definition}
\label{definition-associated-simple-complex}
Let $\mathcal{A}$ be an additive category.
Let $A^{\bullet, \bullet}$ be a double complex.
The {\it associated simple complex $sA^\bullet$}, also
sometimes called the {\it associated total complex} is
given by
$$
sA^n = \bigoplus\nolimits_{n = p + q} A^{p, q}
$$
(if it exists) with differential
$$
d_{sA}^n = \sum\nolimits_{n = p + q} (d_1^{p, q} + (-1)^p d_2^{p, q})
$$
\end{definition}

\noindent
If countable direct sums exist in $\mathcal{A}$ or if for each $n$ at most
finitely many $A^{p, n - p}$ are nonzero, then $sA^\bullet$ exists. Note that
the definition is {\it not} symmetric in the indices $(p, q)$.

\medskip\noindent
There are two natural filtrations on the simple complex $sA^\bullet$
associated to the double complex $A^{\bullet, \bullet}$. Namely, we
define
$$
F_I^p(sA^n) = \bigoplus\nolimits_{i + j = n,\ i \geq p} A^{i, j}
\quad
\text{and}
\quad
F_{II}^p(sA^n) = \bigoplus\nolimits_{i + j = n,\ j \geq p} A^{i, j}.
$$
It is immediately verified that $(sA^\bullet, F_I)$ and
$(sA^\bullet, F_{II})$ are filtered complexes.
By Section \ref{section-filtered-complex}
we obtain two spectral sequences. It is customary to
denote $({}'E_r, {}'d_r)_{r \geq 0}$ the spectral sequence associated
to the filtration $F_I$ and to denote $({}''E_r, {}''d_r)_{r \geq 0}$
the spectral sequence associated to the filtration $F_{II}$.
Here is a description of these spectral sequences.

\begin{lemma}
\label{lemma-ss-double-complex}
Let $\mathcal{A}$ be an abelian category.
Let $K^{\bullet, \bullet}$ be a double complex.
The spectral sequences associated to $K^{\bullet, \bullet}$
have the following terms:
\begin{enumerate}
\item ${}'E_0^{p, q} = K^{p, q}$ with
${}'d_0^{p, q} = (-1)^p d_2^{p, q} : K^{p, q} \to K^{p, q + 1}$,
\item ${}''E_0^{p, q} = K^{q, p}$ with
${}''d_0^{p, q} = d_1^{q, p} : K^{q, p} \to K^{q + 1, p}$,
\item ${}'E_1^{p, q} = H^q(K^{p, \bullet})$ with
${}'d_1^{p, q} = H^q(d_1^{p, \bullet})$,
\item ${}''E_1^{p, q} = H^q(K^{\bullet, p})$ with
${}''d_1^{p, q} = (-1)^q H^q(d_2^{\bullet, p})$,
\item ${}'E_2^{p, q} = H^p_{I}(H^q_{II}(K^{\bullet, \bullet}))$,
\item ${}''E_2^{p, q} = H^p_{II}(H^q_{I}(K^{\bullet, \bullet}))$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
These spectral sequences define two filtrations on $H^n(sK^\bullet)$.
We will denote these $F_I$ and $F_{II}$.

\begin{definition}
\label{definition-ss-double-complex-converge}
Let $\mathcal{A}$ be an abelian category.
Let $K^{\bullet, \bullet}$ be a double complex.
We say the spectral sequence $({}'E_r, {}'d_r)_{r \geq 0}$
{\it converges} if Definition \ref{definition-filtered-complex-ss-converges}
applies. In other words, for all $n$
$$
\text{gr}_{F_I}(H^n(sK^\bullet)) = \oplus_{p + q = n} {}'E_\infty^{p, q}
$$
via the canonical comparison of
Lemma \ref{lemma-compute-cohomology-filtered-complex}.
Similarly we say the spectral sequence $({}''E_r, {}''d_r)_{r \geq 0}$
{\it converges} if Definition \ref{definition-filtered-complex-ss-converges}
applies. In other words for all $n$
$$
\text{gr}_{F_{II}}(H^n(sK^\bullet)) = \oplus_{p + q = n} {}''E_\infty^{p, q}
$$
via the canonical comparison of
Lemma \ref{lemma-compute-cohomology-filtered-complex}.
\end{definition}

\noindent
Same caveats as those following
Definition \ref{definition-filtered-differential-ss-converges}.

\begin{lemma}
\label{lemma-first-quadrant-ss}
(First quadrant spectral sequence.)
Let $\mathcal{A}$ be an abelian category.
Let $K^{\bullet, \bullet}$ be a double complex.
Assume that for some $i \ll 0$ we have
$K^{p, q} = 0$ whenever either $p < i$ or $q < i$.
Then
\begin{enumerate}
\item the filtrations $F_I$, $F_{II}$ on each $H^n(K^\bullet)$ are finite,
\item the spectral sequence $({}'E_r, {}'d_r)_{r \geq 0}$ converges, and
\item the spectral sequence $({}''E_r, {}''d_r)_{r \geq 0}$ converges.
\end{enumerate}
\end{lemma}

\begin{proof}
Follows immediately from Lemma \ref{lemma-biregular-ss-converges}.
\end{proof}

\noindent
Here is our first application of spectral sequences.

\begin{lemma}
\label{lemma-double-complex-gives-resolution}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a complex.
Let $A^{\bullet, \bullet}$ be a double complex.
Let $\alpha^p : K^p \to A^{p, 0}$ be morphisms.
Assume that
\begin{enumerate}
\item There exists a $i \ll 0$ such that
$K^p = A^{p, q} = 0$ for all $p < i$ and all $q$.
\item We have $A^{p, q} = 0$ if $q < 0$.
\item The morphisms $\alpha^p$ give rise to a morphism
of complexes $\alpha : K^\bullet \to A^{\bullet, 0}$.
\item The complex $A^{p, \bullet}$ is exact in all degrees
$q \not = 0$ and the morphism $K^p \to A^{p, 0}$ induces
an isomorphism $K^p \to \text{Ker}(d_2^{p, 0})$.
\end{enumerate}
Then $\alpha$ induces a quasi-isomorphism
$$
K^\bullet \longrightarrow sA^\bullet
$$
of complexes.
Moreover, there is a variant of this lemma involving the second
variable $q$ instead of $p$.
\end{lemma}

\begin{proof}
The map is simply the map given by the morphisms
$K^n \to A^{n, 0} \to sA^n$, which are easily seen to define
a morphism of complexes.
Consider the spectral sequence $({}'E_r, {}'d_r)_{r \geq 0}$
associated to the double complex $A^{\bullet, \bullet}$.
By Lemma \ref{lemma-first-quadrant-ss} this spectral sequence converges
and the induced filtration on $H^n(sA^\bullet)$ is finite for each $n$.
By Lemma \ref{lemma-ss-double-complex} and assumption (4) we have
${}'E_1^{p, q} = 0$ unless $q = 0$ and $'E_1^{p, 0} = K^p$
with differential ${}'d_1^{p, 0}$ identified with $d_K^p$.
Hence ${}'E_2^{p, 0} = H^p(K^\bullet)$ and zero otherwise.
This clearly implies $d_2^{p, q} = d_3^{p, q} = \ldots = 0$
for degree reasons. Hence we conclude that $H^n(sA^\bullet) = H^n(K^\bullet)$.
We omit the verification that this identification is given by the
morphism of complexes $K^\bullet \to sA^\bullet$ introduced above.
\end{proof}








\section{Injectives}
\label{section-injectives}

\begin{definition}
\label{definition-injective}
Let $\mathcal{A}$ be an abelian category.
An object $J \in \text{Ob}(\mathcal{A})$ is
called {\it injective} if for every injection
$A \hookrightarrow B$ and every morphism
$A \to J$ there exists a morphism $B \to J$ making
the following diagram commute
$$
\xymatrix{
A \ar[r] \ar[d] & B \ar@{-->}[ld] \\
J &
}
$$
\end{definition}

\noindent
Here is the obligatory characterization of injective objects.

\begin{lemma}
\label{lemma-characterize-injectives}
Let $\mathcal{A}$ be an abelian category.
Let $I$ be an object of $\mathcal{A}$.
The following are equivalent:
\begin{enumerate}
\item The object $I$ is injective.
\item The functor $B \mapsto \text{Hom}_{\mathcal{A}}(B, I)$
is exact.
\item Any short exact sequence
$$
0 \to I \to A \to B \to 0
$$
in $\mathcal{A}$ is split.
\item We have $\text{Ext}_{\mathcal{A}}(B, I) = 0$ for
all $B \in \text{Ob}(\mathcal{A})$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-product-injectives}
Let $\mathcal{A}$ be an abelian category.
Suppose $I_\omega$, $\omega \in \Omega$ is a set of injective
objects of $\mathcal{A}$. If $\prod_{\omega \in \Omega} I_\omega$
exists then it is injective.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-enough-injectives}
Let $\mathcal{A}$ be an abelian category.
We say $\mathcal{A}$ has {\it enough injectives}
if every object $A$ has an injective morphism
$A \to J$ into an injective object $J$.
\end{definition}

\begin{definition}
\label{definition-functorial-injective-embedding}
Let $\mathcal{A}$ be an abelian category.
We say that $\mathcal{A}$ has {\it functorial injective embeddings}
if there exists a functor
$$
J : \mathcal{A} \longrightarrow \text{Arrows}(\mathcal{A})
$$
such that
\begin{enumerate}
\item $s \circ J = \text{id}_{\mathcal{A}}$,
\item for any object $A \in \text{Ob}(\mathcal{A})$
the morphism $J(A)$ is injective, and
\item for any object $A \in \text{Ob}(\mathcal{A})$
the object $t(J(A))$ is an injective object of $\mathcal{A}$.
\end{enumerate}
We will denote such a functor by
$A \mapsto (A \to J(A))$.
\end{definition}





\section{Projectives}
\label{section-projectives}

\begin{definition}
\label{definition-projective}
Let $\mathcal{A}$ be an abelian category.
An object $P \in \text{Ob}(\mathcal{A})$ is
called {\it projective} if for every surjection
$A \rightarrow B$ and every morphism
$P \to B$ there exists a morphism $P \to A$ making
the following diagram commute
$$
\xymatrix{
A \ar[r] & B \\
P \ar@{-->}[u] \ar[ru] &
}
$$
\end{definition}

\noindent
Here is the obligatory characterization of projective objects.

\begin{lemma}
\label{lemma-characterize-projectives}
Let $\mathcal{A}$ be an abelian category.
Let $P$ be an object of $\mathcal{A}$.
The following are equivalent:
\begin{enumerate}
\item The object $P$ is projective.
\item The functor $B \mapsto \text{Hom}_{\mathcal{A}}(P, B)$
is exact.
\item Any short exact sequence
$$
0 \to A \to B \to P \to 0
$$
in $\mathcal{A}$ is split.
\item We have $\text{Ext}_{\mathcal{A}}(P, A) = 0$ for
all $A \in \text{Ob}(\mathcal{A})$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-coproduct-projectives}
Let $\mathcal{A}$ be an abelian category.
Suppose $P_\omega$, $\omega \in \Omega$ is a set of projective
objects of $\mathcal{A}$. If $\text{coprod}_{\omega \in \Omega} P_\omega$
exists then it is projective.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-enough-projectives}
Let $\mathcal{A}$ be an abelian category.
We say $\mathcal{A}$ has {\it enough projectives}
if every object $A$ has an surjective morphism
$P \to A$ from an projective object $P$ onto it.
\end{definition}

\begin{definition}
\label{definition-functorial-projective-surjections}
Let $\mathcal{A}$ be an abelian category.
We say that $\mathcal{A}$ has {\it functorial projective surjections}
if there exists a functor
$$
P : \mathcal{A} \longrightarrow \text{Arrows}(\mathcal{A})
$$
such that
\begin{enumerate}
\item $t \circ J = \text{id}_{\mathcal{A}}$,
\item for any object $A \in \text{Ob}(\mathcal{A})$
the morphism $P(A)$ is surjective, and
\item for any object $A \in \text{Ob}(\mathcal{A})$
the object $s(P(A))$ is an projective object of $\mathcal{A}$.
\end{enumerate}
We will denote such a functor by
$A \mapsto (P(A) \to A)$.
\end{definition}





\section{Injective resolutions}
\label{section-injective-resolutions}

\noindent
In this section we prove some lemmas regarding the existence
of injective resolutions in categories having enough injectives.
In this section we will consider only cochain complexes, and we will
often simply call these complexes.
In fact we rename some of the notions defined earlier as follows.

\begin{definition}
\label{definition-complexes-notation}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item We set $\text{Comp}(\mathcal{A}) = \text{CoCh}(\mathcal{A})$
be the {\it category of (cochain) complexes}.
\item A complex $K^\bullet$ is said to be
{\it bounded below} if $K^n = 0$ for all $n \ll 0$.
\item We let $\text{Comp}^{+}(\mathcal{A})$ be the full subcategory
of $\text{Comp}(\mathcal{A})$ whose objects are the complexes
which are bounded below.
\item We let $K(\mathcal{A})$ be the category with the same objects
as $\text{Comp}(\mathcal{A})$ but as morphisms homotopy classes of
maps of complexes (see Lemma \ref{lemma-compose-homotopy-cochain}).
\item We let $K^{+}(\mathcal{A})$ be the full subcategory of
$K(\mathcal{A})$ whose objects are bounded below complexes
of $\mathcal{A}$.
\end{enumerate}
\end{definition}

\noindent
Given an object $A$ of $\mathcal{A}$ we get a complex
$$
A[0] = ( \ldots \to 0 \to A \to 0 \to \ldots )
$$
where $A$ is placed in degree zero. Hence a natural functor
$\mathcal{A} \to \text{Comp}(\mathcal{A})$, $A \mapsto A[0]$.
Sofar we have defined categories and functors
$$
\mathcal{A} \to \text{Comp}(\mathcal{A}) \to K(\mathcal{A})
$$
and
$$
\mathcal{A} \to \text{Comp}^{+}(\mathcal{A}) \to K^{+}(\mathcal{A})
$$

\begin{definition}
\label{definition-injective-resolution}
Let $\mathcal{A}$ be an abelian category.
Let $A \in \text{Ob}(\mathcal{A})$.
An {\it injective resolution of $A$} is a complex
$I^\bullet$ together with a map $A \to I^0$ such
that:
\begin{enumerate}
\item We have $I^n = 0$ for $n < 0$.
\item Each $I^n$ is an injective object of $\mathcal{A}$.
\item The map $A \to I^0$ is an isomorphism onto $\text{Ker}(d^0)$.
\item We have $H^i(I^\bullet) = 0$ for $i > 0$.
\end{enumerate}
Hence $A[0] \to I^\bullet$ is a quasi-isomorphism.
In other words the complex
$$
\ldots \to 0 \to A \to I^0 \to I^1 \to \ldots
$$
is acyclic.
Let $K^\bullet$ be a complex in $\mathcal{A}$.
An {\it injective resolution of $K^\bullet$} is a complex
$I^\bullet$ together with a map $\alpha : K^\bullet \to I^\bullet$
of complexes such that
\begin{enumerate}
\item We have $I^n = 0$ for $n \ll 0$, i.e., $I^\bullet$ is bounded below.
\item Each $I^n$ is an injective object of $\mathcal{A}$.
\item The map $\alpha : K^\bullet \to I^\bullet$ is a
quasi-isomorphism.
\end{enumerate}
\end{definition}

\noindent
In other words an injective resolution $K^\bullet \to I^\bullet$
gives rise to a diagram
$$
\xymatrix{
\ldots \ar[r] & K^{n - 1} \ar[d] \ar[r] & K^n \ar[d] \ar[r] &
K^{n + 1} \ar[d] \ar[r] & \ldots \\
\ldots \ar[r] & I^{n - 1} \ar[r] & I^n \ar[r] & I^{n + 1} \ar[r] & \ldots
}
$$
which induces an isomorphism on cohomology objects in each degree.
An injective resolution of an object $A$ of $\mathcal{A}$
is almost the same thing as an injective resolution of
the complex $A[0]$.

\begin{lemma}
\label{lemma-cohomology-bounded-below}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a complex of $\mathcal{A}$.
\begin{enumerate}
\item If $K^\bullet$ has an injective resolution then
$H^n(K^\bullet) = 0$ for $n \ll 0$.
\item If $H^n(K^\bullet) = 0$ for all $n \ll 0$ then there
exists a quasi-isomorphism $K^\bullet \to L^\bullet$
with $L^\bullet$ bounded below.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted. For the second statement use
$L^\bullet = K^\bullet / \tau_{\leq n}K^\bullet$ for
some $n \ll 0$. See Section \ref{section-truncations} for
the definition of the truncation $\tau_{\leq n}$.
\end{proof}

\begin{lemma}
\label{lemma-injective-resolutions-exist}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
\begin{enumerate}
\item Any object of $\mathcal{A}$ has an injective resolution.
\item If $H^n(K^\bullet) = 0$ for all $n \ll 0$ then
$K^\bullet$ has an injective resolution.
\item If $K^\bullet$ is bounded below then there exists
an injective resolution $\alpha : K^\bullet \to I^\bullet$
such that each $\alpha^n : K^n \to I^n$ is injective.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). First choose an injection $A \to I^0$ of $A$ into an
injective object of $\mathcal{A}$. Next, choose an injection
$I_0/A \to I^1$ into an injective object of $\mathcal{A}$.
Denote $d^0$ the induced map $I^0 \to I^1$.
Next, choose an injection $I^1/\text{Im}(d^0) \to I^2$ into
an injective object of $\mathcal{A}$. Denote $d^1$ the induced
map $I^1 \to I^2$. And so on.

\medskip\noindent
By Lemma \ref{lemma-cohomology-bounded-below} part (2) follows from part (3).

\medskip\noindent
Proof of (3). Consider the following induction hypothesis
$IH_n$: There are $I^j$, $j \leq n$ injective objects almost
all zero, maps $d^j : I^j \to I^{j + 1}$ for $j < n$
and injective maps $\alpha^j : K^j \to I^j$ for $j \leq n$
such that the diagram
$$
\xymatrix{
\ldots \ar[r] & K^{n - 1} \ar[d]^\alpha \ar[r] &
K^n \ar[d]^\alpha \ar[r] &
K^{n + 1} \ar[r] & \ldots \\
\ldots \ar[r] & I^{n - 1} \ar[r] & I^n &  &
}
$$
is commutative, such that $d^j \circ d^{j - 1} = 0$ for $j < n$
and such that $\alpha$ induces isomorphisms
$H^j(K^\bullet) \to \text{Ker}(d^j)/\text{Im}(d^{j - 1})$
for $j < n$. Note that this implies
\begin{equation}
\label{equation-star}
\alpha(\text{Im}(d^{n - 1}))
\subset
\alpha(\text{Ker}(d^n)) \cap d^{n - 1}(I^{n - 1})
\end{equation}
and
\begin{equation}
\label{equation-star-star}
\alpha(\text{Im}(d^{n - 1}))
\subset
\alpha(K^n) \cap d^{n - 1}(I^{n - 1}).
\end{equation}
If these inclusions are not equalities, then choose an injection
$K^n/\text{Im}(d^{n - 1}) \to I$ into an injective object $I$.
Denote $\alpha' : K^n \to I$ the induced map.
Replace $I^n$ by $\tilde I^n = I^n \oplus I$. Use the
map $(d^{n - 1}, 0) : I^{n - 1} \to I^n \oplus I$ and use
the map $(\alpha^n , \alpha') : K^n \to I^n \oplus I$.
It is easy to see that after these replacements we have
equality in Equations (\ref{equation-star}) and (\ref{equation-star-star}).
Once this is the
case consider the diagram
$$
\xymatrix{
K^n/\text{Ker}(d^n) \ar[r] \ar[d] & K^{n + 1} \\
I^n/(d^{n - 1}(L^{n - 1}) + \alpha(\text{Ker}(d^n))) &
}
$$
Both the horizontal and the vertical arrows are injective.
Hence the push-out $M$ of this diagram contains both
$K^{n + 1}$ and $I^n/(d^{n - 1}(L^{n - 1}) + \alpha(\text{Ker}(d^n)))$
as subobjects. Choose an injection $M \to I^{n + 1}$.
By construction we get $d^n : I^n \to I^{n + 1}$
and an injective map $\alpha^{n + 1} : K^{n + 1} \to I^{n + 1}$.
The equality in Equation (\ref{equation-star}) and the construction of
$d^{n + 1}$ garantee that $\alpha : H^n(K^\bullet) \to
\text{Ker}(d^n)/\text{Im}(d^{n - 1})$ is an isomorphism.
In other words $IH_{n + 1}$ holds.

\medskip\noindent
We finish the proof of (3) by the following observations.
First we note that $IH_n$ is true for all $n << 0$ since
we can just take $I_j = 0$ for $j \leq n$ in this case.
Next, we note that in the proof of $IH_n \Rightarrow IH_{n + 1}$
we only modified the object $I^n$, the map $d^{n - 1}$ and
the map $\alpha^n$. Hence we see that proceding by induction
we produce a definite complex $I^\bullet$ which is bounded below
and consists of injective objects, and a termwise
injective quasi-isomorphism $\alpha : K^\bullet \to I^\bullet$ as desired.
\end{proof}

\noindent
The following lemma can be used to replace an morphism of complexes
by a morphism where in each degree the map is the injection of a
direct summand.

\begin{lemma}
\label{lemma-make-injective}
Let $\mathcal{A}$ be an additive category.
Let $\alpha : K^\bullet \to L^\bullet$ be a morphism
of complexes of $\mathcal{A}$.
There exists a factorization
$$
\xymatrix{
K^\bullet \ar[r]^{\tilde \alpha} \ar@/_1pc/[rr]_\alpha &
\tilde L^\bullet \ar[r]^\pi &
L^\bullet
}
$$
such that
\begin{enumerate}
\item $\tilde \alpha$ is a termwise split injection (see
Definition \ref{definition-split-ses}),
\item there is a map of complexes $s : L^\bullet \to \tilde L^\bullet$
such that $\pi \circ s = \text{id}_{L^\bullet}$ and such that
$s \circ \pi$ is homotopic to $\text{id}_{\tilde L^\bullet}$.
\end{enumerate}
\end{lemma}

\begin{proof}
We set
$$
\tilde L^n = L^n \oplus K^n \oplus K^{n + 1}
$$
and we define
$$
d^n_{\tilde L} =
\left(
\begin{matrix}
d^n_L & 0 & 0 \\
0 & d^n_K & \text{id}_{K^{n + 1}} \\
0 & 0 & -d^{n + 1}_K
\end{matrix}
\right)
$$
Moreover, we set
$$
\tilde \alpha =
\left(
\begin{matrix}
\alpha \\
\text{id}_{K^n} \\
0
\end{matrix}
\right)
$$
which is clearly a split injection. It is also clear that it defines a morphism
of complexes. We define
$$
\pi =
\left(
\begin{matrix}
\text{id}_{L^n} &
0 &
0
\end{matrix}
\right)
$$
so that clearly $\pi \circ \tilde \alpha = \alpha$. We set
$$
s =
\left(
\begin{matrix}
\text{id}_{L^n} \\
0 \\
0
\end{matrix}
\right)
$$
so that $\pi \circ s = \text{id}_{L^\bullet}$. Finally,
let $h^n : \tilde L^n \to \tilde L^{n - 1}$ be the map
which maps the summand $K^n$ of $L^n$ via the identity morphism
to the summand $K^n$ of $L^{n - 1}$. Then it is a trivial matter
(see computations in remark below) to prove that
$$
\text{id}_{\tilde L^\bullet} - s \circ \pi
=
d \circ h + h \circ d
$$
which finishes the proof of the lemma.
\end{proof}

\begin{remark}
\label{remark-compute-modules}
To see the last displayed equality in the proof above we can argue
with elements as follows. We have
$s\pi(l, k, k^{+}) = (l, 0, 0)$.
Hence the morphism of the left hand side maps
$(l, k, k^{+})$ to $(0, k, k^{+})$.
On the other hand $h(l, k, k^{+}) = (0, 0, k)$ and
$d(l, k, k^{+}) = (dl, dk + k^{+}, -dk^{+})$.
Hence $(dh + hd)(l, k, k^{+}) =
d(0, 0, k) + h(dl, dk + k^{+}, -dk^{+}) =
(0, k, -dk) + (0, 0, dk + k^{+}) = (0, k, k^{+})$
as desired.
\end{remark}

\begin{lemma}
\label{lemma-morphisms-lift}
Let $\mathcal{A}$ be an abelian category.
Consider a solid diagram
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_\gamma & L^\bullet \ar@{-->}[dl]^\beta \\
I^\bullet
}
$$
where $I^\bullet$ is bounded below and consists of injective
objects, and $\alpha$ is a quasi-isomorphism.
\begin{enumerate}
\item There exists a map of complexes $\beta$ making the diagram
commute up to homotopy.
\item If $\alpha$ is injective in every degree
then we can find a $\beta$ which makes the diagram commute.
\end{enumerate}
\end{lemma}

\begin{proof}
We first show that (2) implies (1). Namely, let
$\tilde \alpha : K \to \tilde L^\bullet$, $\pi$, $s$ be as in
Lemma \ref{lemma-make-injective}. Since $\tilde \alpha$ is injective
by (2) there exists a morphism $\tilde \beta : \tilde L^\bullet \to I^\bullet$
such that $\gamma = \tilde \beta \circ \tilde \alpha$. Set
$\beta = \tilde \beta \circ s$. Then we have
$$
\beta \circ \alpha
=
\tilde \beta \circ s \circ \pi \circ \tilde \alpha
\sim
\tilde \beta \circ \tilde \alpha
=
\gamma
$$
as desired.

\medskip\noindent
Assume that $\alpha : K^\bullet \to L^\bullet$ is injective.
Suppose we have already defined $\beta$ in all degrees
$\leq n - 1$ compatible with differentials and such that
$\gamma^j = \beta^j \circ \alpha^j$ for all $j \leq n - 1$.
Consider the commutative solid diagram
$$
\xymatrix{
K^{n - 1} \ar[r] \ar@/_2pc/[dd]_\gamma \ar[d]^\alpha &
K^n \ar@/^2pc/[dd]^\gamma \ar[d]^\alpha \\
L^{n - 1} \ar[r] \ar[d]^\beta &
L^n \ar@{-->}[d] \\
I^{n - 1} \ar[r] &
I^n
}
$$
Thus we see that the dotted arrow is prescribed on the subobjects
$\alpha(K^n)$ and $d^{n - 1}(L^{n - 1})$. Moreover, these two arrows
agree on $\alpha(d^{n - 1}(K^{n - 1}))$. Hence if
\begin{equation}
\label{equation-qis}
\alpha(d^{n - 1}(K^{n - 1}))
=
\alpha(K^n) \cap d^{n - 1}(L^{n - 1})
\end{equation}
then these morphisms glue to a morphism
$\alpha(K^n) + d^{n - 1}(L^{n - 1}) \to I^n$ and, using the injectivity
of $I^n$, we can extend this to a morphism from all of $L^n$ into $I^n$.
After this by induction we get the morphism $\beta$ for all $n$ simlutaneously
(note that we can set $\beta^n = 0$ for all $n \ll 0$ since $I^\bullet$
is bounded below -- in this way starting the induction).

\medskip\noindent
It remains to prove the equality (\ref{equation-qis}).
The reader is encouraged to argue this for themselves with a suitable
diagram chase. Nonetheless here is our argument.
Note that the inclusion
$\alpha(d^{n - 1}(K^{n - 1})) \subset \alpha(K^n) \cap d^{n - 1}(L^{n - 1})$
is obvious. Take an object $T$ of $\mathcal{A}$ and a morphism
$x : T \to L^n$ whose image is contained in the subobject
$\alpha(K^n) \cap d^{n - 1}(L^{n - 1})$.
Since $\alpha$ is injective we see that $x = \alpha \circ x'$ for
some $x' : T \to K^n$. Moreover, since $x$ lies in $d^{n - 1}(L^{n - 1})$
we see that $d^n \circ x = 0$. Hence using injectivity of $\alpha$ again
we see that $d^n \circ x' = 0$. Thus $x'$ gives a morphism
$[x'] : T \to H^n(K^\bullet)$. On the other hand the corresponding
map $[x] : T \to H^n(L^\bullet)$ induced by $x$ is zero by assumption.
Since $\alpha$ is a quasi-isomorphism we conclude that $[x'] = 0$.
This of course means exactly that the image of $x'$ is
contained in $d^{n - 1}(K^{n - 1})$ and we win.
\end{proof}

\begin{lemma}
\label{lemma-acyclic-is-zero}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be an acyclic complex.
Let $I^\bullet$ be bounded below and consisting of injective objects.
Any morphism $K^\bullet \to I^\bullet$ is homotopic to zero.
\end{lemma}

\begin{proof}
Let $\alpha : K^\bullet \to I^\bullet$ be a morphism of
complexes. Assume that $\alpha^j = 0$ for $j < n$.
We will show that there exists a morphism $h : K^{n + 1} \to I^n$
such that $\alpha^n = h \circ d$. Thus $\alpha$ will be homotopic
to the morphism of complexes $\beta$ defined by
$$
\beta^j =
\left\{
\begin{matrix}
0 & \text{if} & j \leq n \\
\alpha^{n + 1} - d \circ h & \text{if} & j = n + 1 \\
\alpha^j & \text{if} & j > n + 1
\end{matrix}
\right.
$$
This will clearly prove the lemma (by induction).
To prove the existence of $h$ note that
$\alpha^n|_{d^{n - 1}(K^{n - 1})} = 0$ since
$\alpha^{n - 1} = 0$. Since $K^\bullet$ is acyclic we
have $d^{n - 1}(K^{n - 1}) = \text{Ker}(K^n \to K^{n + 1})$.
Hence we can think of $\alpha^n$ as a map into $I^n$ defined
on the subobject $\text{Im}(K^n \to K^{n + 1})$ of $K^{n + 1}$.
By injectivity of the object $I^n$ we can extend this to
a map $h : K^{n + 1} \to I^n$ as desired.
\end{proof}

\begin{lemma}
\label{lemma-morphisms-equal-up-to-homotopy}
Let $\mathcal{A}$ be an abelian category.
Consider a solid diagram
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_\gamma & L^\bullet \ar@{-->}[dl]^{\beta_i} \\
I^\bullet
}
$$
where $I^\bullet$ is bounded below and consists of injective
objects, and $\alpha$ is a quasi-isomorphism.
Any two morphisms $\beta_1, \beta_2$ making the diagram commute
up to homotopy are homotopic.
\end{lemma}

\begin{proof}
Let $\tilde \alpha : K \to \tilde L^\bullet$, $\pi$, $s$ be as in
Lemma \ref{lemma-make-injective}. If we can show that $\beta_1 \circ\pi$
is homotopic to $\beta_2 \circ \pi$, then we deduce that
$\beta_1 \sim \beta_2$ because $\pi \circ s$ is the identity.
Hence we may assume $\alpha^n : K^n \to L^n$ is the
inclusion of a direct summand for all $n$. Thus we get a
short exact sequence of complexes
$$
0 \to K^\bullet \to L^\bullet \to M^\bullet \to 0
$$
which is termwise split and such that $M^\bullet$ is acyclic.
We choose splittings $L^n = K^n \oplus M^n$, so we have
$\beta_i^n : K^n \oplus M^n \to I^n$ and $\gamma^n : K^n \to I^n$.
In this case the condition on $\beta_i$ is that there are morphisms
$h_i^n : K^n \to I^{n - 1}$ such that
$$
\gamma^n - \beta_i^n|_{K^n} = d \circ h_i^n + h_i^{n + 1} \circ d
$$
Thus we see that
$$
\beta_1^n|_{K^n} - \beta_2^n|_{K^n}
=
d \circ (h_1^n - h_2^n) + (h_1^{n + 1} - h_2^{n + 1}) \circ d
$$
Consider the map $h^n : K^n \oplus M^n \to I^{n - 1}$ which
equals $h_1^n - h_2^n$ on the first summand and zero on the second.
Then we see that
$$
\beta_1^n - \beta_2^n
-
(d \circ h^n + h^{n + 1}) \circ d)
$$
is a morphism of complexes $L^\bullet \to I^\bullet$
which is identically zero on the subcomplex $K^\bullet$.
Hence it factors as $L^\bullet \to M^\bullet \to I^\bullet$.
Thus the result of the lemma follows from Lemma \ref{lemma-acyclic-is-zero}.
\end{proof}

\begin{lemma}
\label{lemma-injective-resolution-ses}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
For any short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
of $\text{Comp}^{+}(\mathcal{A})$ there exists a
commutative diagram in $\text{Comp}^{+}(\mathcal{A})$
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I_1^\bullet \ar[r] &
I_2^\bullet \ar[r] &
I_3^\bullet \ar[r] &
0
}
$$
where the vertical arrows are injective resolutions and
the rows are short exact sequences of complexes.
In fact, given any quasi-isomorphism $A^\bullet \to I^\bullet$
we may assume $I_1^\bullet = I^\bullet$.
\end{lemma}

\begin{proof}
Step 1. Choose an injective resolution $A^\bullet \to I^\bullet$ (see
Lemma \ref{lemma-injective-resolutions-exist}) or use the given one.
Recall that $\text{Comp}^{+}(\mathcal{A})$ is an
abelian category, see Lemma \ref{lemma-cat-cochain-abelian}.
Hence we may form the pushout along
the injective map $A^\bullet \to I^\bullet$ to get
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I^\bullet \ar[r] &
E^\bullet \ar[r] &
C^\bullet \ar[r] &
0
}
$$
Note that the lower short exact sequence is termwise split, see
Lemma \ref{lemma-characterize-injectives}. Hence it suffices to
prove the lemma when
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$ is
termwise split.

\medskip\noindent
Step 2. Choose splittings. In other words, write
$B^n = A^n \oplus C^n$. Denote $\delta : C^\bullet \to A^\bullet[1]$
the morphism as in Lemma \ref{lemma-ses-termwise-split-cochain}. Choose
injective resolutions $f_1 : A^\bullet \to I_1^\bullet$
and $f_3 : C^\bullet \to I_3^\bullet$. (If $A^\bullet$ is a complex of
injectives, then use $I_1^\bullet = A^\bullet$.)
We may assume $f_3$ is injective in
every degree. By Lemma \ref{lemma-morphisms-lift} we may find
a morphism $\delta' : I_3^\bullet \to I_1^\bullet[1]$ such
that $\delta' \circ f_3 = f_1[1] \circ \delta$ (equality of
morphisms of complexes). Set $I_2^n = I_1^n \oplus I_3^n$.
Define
$$
d_{I_2}^n =
\left(
\begin{matrix}
d_{I_1}^n & (\delta')^n \\
0 & d_{I_3}^n
\end{matrix}
\right)
$$
and define the maps $B^n \to I_2^n$ to be given as the
sum of the maps $A^n \to I_1^n$ and $C^n \to I_3^n$.
Everything is clear.
\end{proof}
















\section{The derived category}
\label{section-derived-category}

\noindent
The above material suggests the following definition.

\begin{definition}
\label{definition-derived-category}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
The {\it derived category (bounded below version)} of $\mathcal{A}$
is the category $D^{+}(\mathcal{A})$ whose
\begin{enumerate}
\item objects are bounded below complexes of injectives, and
\item morphisms are morphisms of complexes up to homotopy.
\end{enumerate}
\end{definition}

\noindent
There is another construction of the derived category which is
more general. Namely $\mathcal{A}$ can be an arbitrary abelian
category. The idea is that one takes the category
$K^{+}(\mathcal{A})$, see Definition \ref{definition-complexes-notation},
and inverts all quasi-isomorphisms. This can be done for the category
$K(\mathcal{A})$ of
unbounded complexes as well. This we will discuss elsewhere
(insert future reference here). It is true that the constructions
agree, i.e., give equivalent categories, when $\mathcal{A}$ has enough
injectives, see (insert future reference here).
Moreover, the derived category (with either construction) comes equipped
with the additional structure of a triangulated category,
see Section \ref{section-triangulated-categories} for the definition.
For the category $D^{+}(\mathcal{A})$ we define this structure in
Section \ref{section-derived-triangulated}.

\medskip\noindent
To formulate some first properties of the derived category we remark that
since homotopic maps induce the same maps on cohomology there is a
sequence of functors
$$
H^n : K(\mathcal{A}) \longrightarrow \mathcal{A}
$$
Moreover, we have defined the derived category
$D^{+}(\mathcal{A})$ as a full subcategory
of $K^{+}(\mathcal{A}) \subset K(\mathcal{A})$. Hence we also get functors
$$
H^n : D^{+}(\mathcal{A}) \longrightarrow \mathcal{A}
$$
by restricting the above $H^n$.

\begin{definition}
\label{definition-localization-functor}
Let $\mathcal{A}$ be an abelian category with enough injectives.
A {\it localization functor}\footnote{This is likely nonstandard terminology.}
is a functor
$$
j : K^{+}(\mathcal{A}) \longrightarrow D^{+}(\mathcal{A})
$$
and for every $K^\bullet \in \text{Ob}(K^{+}(\mathcal{A}))$ a
morphism of complexes $i_K : K^\bullet \to j(K^\bullet)$
with the following properties:
\begin{enumerate}
\item For every $K^\bullet$ the morphism $i_K : K^\bullet \to j(K^\bullet)$
is a quasi-isomorphism.
\item For every morphism $\alpha : K^\bullet \to L^\bullet$ of
$K^{+}(\mathcal{A})$ we have $j(\alpha) \circ i_K = i_L \circ \alpha$.
\item There are canonical isomorphisms $H^n \circ j = H^n$.
\item Given a morphism of complexes $\alpha : K^\bullet \to L^\bullet$
then $j(\alpha)$ is invertible if and only if $\alpha$ is a
quasi-isomorphism.
\item For any $K^\bullet$ we have $j(K^\bullet) \cong 0$ if and only
if $K^\bullet$ is acyclic.
\end{enumerate}
\end{definition}

\noindent
The conditions above are not logically independent.

\begin{lemma}
\label{lemma-into-derived-category}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
Then a localization functor $j$ exists and is 
unique up to unique isomorphism of functors.
\end{lemma}

\begin{proof}
Consider the set of all objects $K^\bullet$ of $K^{+}(\mathcal{A})$.
(Recall that by our conventions any category has a set of
objects unless mentioned otherwise.)
By Lemma \ref{lemma-injective-resolutions-exist} every object
has an injective resolution.
By the axiom of choice we can choose for each $K^\bullet$
an injective resolution $i_K : K^\bullet \to j(K^\bullet)$.

\medskip\noindent
Next, consider the set of all morphisms
$\alpha : K^\bullet \to L^\bullet$
of $K^{+}(\mathcal{A})$ (we represent each one by a
particular choice of representative).
For each of these consider the diagram
$$
\xymatrix{
K^\bullet \ar[d] \ar[r]_\alpha & L^\bullet \ar[d] \\
j(K^\bullet) \ar@{-->}[r] & j(L^\bullet)
}
$$
By Lemma \ref{lemma-morphisms-lift} there exists a dotted arrow
making the diagram commute up to homotopy (i.e., commute in
$K^{+}(\mathcal{A})$). We choose one (using the axiom of choice)
and denote it
$j(\alpha) : j(K^\bullet) \to j(L^\bullet)$.

\medskip\noindent
To verify that $j$ is a functor we have to show that
$j(\beta) \circ j(\alpha) = j(\beta \circ \alpha)$
whenever given morphisms $\alpha : K^\bullet \to L^\bullet$
and $\beta : L^\bullet \to M^\bullet$ in $K^{+}(\mathcal{A})$.
For this note that both
$j(\beta) \circ j(\alpha)$ and $j(\beta \circ \alpha)$
make the following diagram commute up
to homotopy
$$
\xymatrix{
K^\bullet \ar[d] \ar[r]_{\beta \circ \alpha} & M^\bullet \ar[d] \\
j(K^\bullet) \ar[r] & j(M^\bullet)
}
$$
Hence it follows from Lemma \ref{lemma-morphisms-equal-up-to-homotopy}
that they are equal up
to homotopy, i.e., equal as morphisms in $D^{+}(\mathcal{A})$.

\medskip\noindent
Properties (1), (2) hold by construction.
The isomorphism $H^n = H^n \circ j$ comes from the
quasi-isomorphisms $K^\bullet \to j(K^\bullet)$ which
are compatible with morphisms. Also, part (5) follows from part (4).

\medskip\noindent
Let us prove (4). It is clear that if $j(\alpha)$ is invertible,
then $\alpha$ is a quasi-isomorphism, by property (3).
Suppose that $\alpha$ is a quasi-isomorphism. Then we apply
Lemma \ref{lemma-morphisms-lift} to get the dotted arrow
in the following diagram
$$
\xymatrix{
K^\bullet \ar[d] \ar[r]_\alpha & L^\bullet \ar[d] \\
j(K^\bullet) & j(L^\bullet) \ar@{-->}[l]
}
$$
and we use Lemma \ref{lemma-morphisms-equal-up-to-homotopy} to see that
it is an inverse to
$j(\alpha)$. This finishes the proof of the lemma.
\end{proof}

\begin{remark}
\label{remark-big-localization}
Suppose that $\mathcal{A}$ is a ``big'' abelian category with enough injectives
such as the category of abelian groups. In this case we have to be slightly
more carefull in constructing our localization functor since we cannot use
the axiom of choice with a quantifier ranging over a class. But note that
the proof of the lemma does show that any two localization functors are
canonically isomorphic. Namely, given quasi-isomorphisms
$i : K^\bullet \to I^\bullet$ and $i' : K^\bullet \to J^\bullet$ of
a bounded below complex $K^\bullet$ into bounded below complexes of injectives
there exists a unique(!) morphism $a : I^\bullet \to J^\bullet$
in $D^{+}(\mathcal{A})$ such that $i' = i \circ a$ as morphisms in
$D^{+}(\mathcal{A})$. Hence the only issue is existence, and we will see how
to deal with this in the next section.
\end{remark}

\begin{remark}
\label{remark-failure}
Allthough the derived category $D^{+}(\mathcal{A})$ is an additive category,
it is not an abelian category itself (in most cases). It does have a zero
object but no kernels and cokernels in general. Hence it not possible to define
the notion of a short exact sequence in $D^{+}(\mathcal{A})$. The solution to
this conundrum is to add additional structure to the category
$D^{+}(\mathcal{A})$, namely a set of ``distinguished triangles''.
See Definition \ref{definition-derived-triangulated} below.
The result is the notion of a triangulated category which is an
additive category, endowed with translation functors $[n]$
and a set of triangles subject to a list of axioms.
See \cite{Verdier} and Section \ref{section-triangulated-categories}.
One reason for introducing trianglulated categories is to be able to speak
about exact functors between derived categories (especially derived
functors).
\end{remark}





\section{Functorial injective resolutions}
\label{section-functorial-injective-resolutions}

\noindent
In this section we redo the construction of the localization functor
$K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ in case the
category $\mathcal{A}$ has functorial injective embeddings.
There are two reasons for this: First of all the proof is easier.
Second, the proof also works if $\mathcal{A}$ is a ``big'' abelian
category. See Remark \ref{remark-big-abelian-category} below.

\medskip\noindent
Let $\mathcal{A}$ be an abelian category.
Consider the category $\text{InjRes}(\mathcal{A})$
of arrows $\alpha : K^\bullet \to I^\bullet$
where $K^\bullet$ is a bounded below complex of $\mathcal{A}$,
$I^\bullet$ is a bounded below complex of injectives of $\mathcal{A}$
and $\alpha$ is a quasi-isomorphism. In other words, $\alpha$ is
an injective resolution and $K^\bullet$ is bounded below.
There is an obvious functor
$$
s : \text{InjRes}(\mathcal{A}) \longrightarrow \text{Comp}^{+}(\mathcal{A})
$$
defined by $(\alpha : K^\bullet \to I^\bullet) \mapsto K^\bullet$.
If $\mathcal{A}$ has enough injectives, then there is also
a functor
$$
t : \text{InjRes}(\mathcal{A}) \longrightarrow D^{+}(\mathcal{A})
$$
defined by $(\alpha : K^\bullet \to I^\bullet) \mapsto I^\bullet$.

\begin{lemma}
\label{lemma-functorial-injective-resolutions}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has functorial injective embeddings.
Then there exists a functor
$inj : \text{Comp}^{+}(\mathcal{A}) \to \text{InjRes}(\mathcal{A})$
such that $s \circ j = \text{id}$. Moreover, the composition
$t \circ inj : \text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
factors through $\text{Comp}^{+}(\mathcal{A}) \to K^{+}(\mathcal{A})$
to give a functor
$$
j = \overline{t \circ inj} :
K^{+}(\mathcal{A})
\longrightarrow
D^{+}(\mathcal{A})
$$
which is a localization functor, see
Definition \ref{definition-localization-functor}.
\end{lemma}

\begin{proof}
Let $A \mapsto (A \to J(A))$ be a functorial injective embedding,
see Definition \ref{definition-functorial-injective-embedding}.
We first note that we may assume $J(0) = 0$. Namely, if not then
for any object $A$ we have $0 \to A \to 0$ which gives
a direct sum decomposition $J(A) = J(0) \oplus \text{Ker}(J(A) \to J(0))$.
Note that the functorial morphism $A \to J(A)$ has to map
into the second summand. Hence we can replace our functor
by $J'(A) = \text{Ker}(J(A) \to J(0))$ if needed.

\medskip\noindent
Let $K^\bullet$ be a bounded below complex of $\mathcal{A}$.
Say $K^p = 0$ if $p < B$.
We are going to construct a double complex $I^{\bullet, \bullet}$
of injectives, together with a map $\alpha : K^\bullet \to I^{\bullet, 0}$
to which we will apply Lemma \ref{lemma-double-complex-gives-resolution}.
First we set $I^{p, q} = 0$ whenever $q < 0$.
Next, we set $I^{p, 0} = J(K^p)$ and $\alpha^p : K^p \to I^{p, 0}$
the functorial embedding. Since $J$ is a functor we see that
$I^{\bullet, 0}$ is a complex and that $\alpha$ is a
morphism of complexes. Each $\alpha^p$ is injective. And
$I^{p, 0} = 0$ for $p < B$ because $J(0) = 0$. Next, we set
$I^{p, 1} = J(\text{Coker}(K^p \to I^{p, 0}))$. Again by functoriality
we see that $I^{\bullet, 1}$ is a complex. And again we get
that $I^{p, 1} = 0$ for $p < B$. It is also clear that
$K^p$ maps isomorphically onto $\text{Ker}(I^{p, 0} \to I^{p, 1})$.
As our third step we take $I^{p, 2} = J(\text{Coker}(I^{p, 0} \to I^{p, 1}))$.
And so on and so forth.

\medskip\noindent
At this point we can apply Lemma \ref{lemma-double-complex-gives-resolution}
to get that the map
$$
\alpha : K^\bullet \to sI^\bullet
$$
is a quasi-isomorphism. To prove we get a functor $inj$ it
rests to show that the construction above
is functorial. This verification is omitted.

\medskip\noindent
Suppose we have a functor $inj$ such that $s \circ inj = \text{id}$.
Set $j = t \circ inj$. Hence we will use the notation
$K^\bullet \mapsto inj(K^\bullet) = (K^\bullet \to j(K^\bullet))$
(similarly to
Definition \ref{definition-functorial-injective-embedding}).
Suppose $\alpha , \beta : K^\bullet \to L^\bullet$ are two homotopic
maps of bounded below complexes of maps. Consider the maps
$inj(\alpha), inj(\beta)$ in the category $\text{InjRes}(\mathcal{A})$.
They induce a commutative diagram
$$
\xymatrix{
K^\bullet
\ar@<1ex>[r]^-{\alpha} \ar@<-1ex>[r]_-{\beta}
\ar[d] &
L^\bullet \ar[d] \\
j(K)^\bullet
\ar@<1ex>[r]^-{j(\alpha)} \ar@<-1ex>[r]_-{j(\beta)}
&
j(L)^\bullet
}
$$
Since the vertical arrows are quasi-isomorphisms, and $\alpha$ and $\beta$
are homotopic we see that
the morphisms $j(\alpha)$ and $j(\beta)$ are homotopic
by Lemma \ref{lemma-morphisms-equal-up-to-homotopy}. Hence
simply taking the $j$ of the class of a morphism up to
homotopy gives a well-defined class of morphisms between
$j(K^\bullet)$ and $j(L^\bullet)$. (Note that we are not
making any choices here.) The other statements of
Lemma \ref{lemma-morphisms-equal-up-to-homotopy}
are proved in exactly the same way as their corresponding proofs
in that lemma.
\end{proof}

\begin{remark}
\label{remark-big-abelian-category}
Let $\text{Mod}(\mathcal{O}_X)$ be the category of $\mathcal{O}_X$-modules
on a ringed space $(X, \mathcal{O}_X)$ (or more generally on a
ringed site). We will see later that $\text{Mod}(\mathcal{O}_X)$ has enough
injectives and in fact functorial injective embeddings, see
Injectives, Theorem \ref{injectives-theorem-sheaves-modules-injectives}.
Note that the proof of Lemma \ref{lemma-into-derived-category} does
not apply to $\text{Mod}(\mathcal{O}_X)$. But the proof of
Lemma \ref{lemma-functorial-injective-resolutions} does apply
to $\text{Mod}(\mathcal{O}_X)$. Thus we obtain
$$
j : K^{+}(\text{Mod}(\mathcal{O}_X))
\longrightarrow
D^{+}(\text{Mod}(\mathcal{O}_X))
$$
which is a localization functor. This argument works for
\begin{enumerate}
\item The category $\text{Mod}(R)$ of $R$-modules over a ring $R$.
\item The category $\textit{PMod}(\mathcal{O})$ of presheaves of
$\mathcal{O}$-modules on a site endowed with a presheaf of rings.
\item The category $\textit{Mod}(\mathcal{O})$ of presheaves of
$\mathcal{O}$-modules on a ringed site.
\item Add more here as needed.
\end{enumerate}
\end{remark}













\section{Triangulated categories}
\label{section-triangulated-categories}

\noindent
Some references are \cite{Verdier} and \cite{Neeman}.


\subsection{Triangulated Categories: Definitions}
\label{subsection-triangulated-definitions}

\noindent
In this section we collect most of the definitions concerning triangulated
and pre-triangulated categories.

\begin{definition}
\label{definition-triangle}
Let $\mathcal{D}$ be an additive category.
Let $[n] : \mathcal{D} \to \mathcal{D}$, $E \mapsto E[n]$
be a collection of additive functors indexed by $n \in \mathbf{Z}$ such that
$[n] \circ [m] = [n + m]$  and $[0] = \text{id}$ (equality as functors).
In this situation
we call {\it triangle} a sixtuple $(X, Y, Z, f, g, h)$
where $X, Y, Z \in \text{Ob}(\mathcal{D})$ and
$f : X \to Y$, $g : Y \to Z$ and $h : Z \to X[1]$ are morphisms
of $\mathcal{D}$.
A {\it morphism of triangles}
$(X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')$
is given by morphisms $a : X \to X'$, $b : Y \to Y'$ and $c : Z \to Z'$
of $\mathcal{D}$ such that
$b \circ f = f' \circ a$, $c  \circ g = g' \circ b$ and
$a[1] \circ h = h' \circ c$.
\end{definition}

\noindent
A morphism of triangles is visualized by the following
commutative diagram
$$
\xymatrix{
X \ar[r] \ar[d]^a &
Y \ar[r] \ar[d]^b &
Z \ar[r] \ar[d]^c &
X[1] \ar[d]^{a[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
Here is the definition of a triangulated category as given in
Verdier's thesis.

\begin{definition}
\label{definition-triangulated-category}
A {\it triangulated category} consists of a triple
$(\mathcal{D}, \{[n]\}_{n\in \mathbf{Z}}, \mathcal{T})$
where
\begin{enumerate}
\item $\mathcal{D}$ is an additive category,
\item $[n] : \mathcal{D} \to \mathcal{D}$, $E \mapsto E[n]$
be a collection of additive functors indexed by $n \in \mathbf{Z}$ such that
$[n] \circ [m] = [n + m]$ and $[0] = \text{id}$ (equality as functors), and
\item $\mathcal{T}$ is a set of triangles called the
{\it distinguished triangles}
\end{enumerate}
subject to the following conditions
\begin{enumerate}
\item[TR1] Any triangle isomorphic to a distinguished triangle is
a distinguished triangle. Any triangle of the form
$(X, X, 0, \text{id}, 0, 0)$ is distinguished.
For any morphism $f : X \to Y$ of $\mathcal{D}$ there exists a
distinguished triangle of the form $(X, Y, Z, f, g, h)$.
\item[TR2] The triangle $(X, Y, Z, f, g, h)$ is distinguished
if and only if the triangle $(Y, Z, X[1], g, h, -f[1])$ is.
\item[TR3] Given a solid commutative square
$$
\xymatrix{
X \ar[r] \ar[d]^a &
Y \ar[r] \ar[d]^b &
Z \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{a[1]} \\
X' \ar[r] &
Y' \ar[r] &
Z' \ar[r] &
X'[1]
}
$$
whose rows are distinguished triangles there exists a morphism
$c : Z \to Z'$ such that $(a, b, c)$ is a morphism of triangles.
\item[TR4] Given objects $X$, $Y$, $Z$ of $\mathcal{D}$, and morphisms
$f : X \to Y$, $g : Y \to Z$, and distinguished triangles
$(X, Y, Q_1, f, p_1, d_1)$,
$(X, Z, Q_2, g \circ f, p_2, d_2)$,
and
$(Y, Z, Q_3, g, p_3, d_3)$,
there exist
morphisms $a : Q_1 \to Q_2$ and $b : Q_2 \to Q_3$ such
that
\begin{enumerate}
\item $(Q_1, Q_2, Q_3, a, b, p_1[1] \circ d_3)$ is a
distinguished triangle,
\item the triple $(\text{id}_X, g, a)$ is
a morphism of triangles
$(X, Y, Q_1, f, p_1, d_1) \to (X, Z, Q_2, g \circ f, p_2, d_2)$, and
\item the triple $(f, \text{id}_Z, b)$ is a morphism of triangles
$(X, Z, Q_2, g \circ f, p_2, d_2) \to (Y, Z, Q_3, g, p_3, d_3)$.
\end{enumerate}
\end{enumerate}
We will call $(\mathcal{D}, [\ ], \mathcal{T})$ a
{\it pre-triangulated category} if TR1, TR2 and TR3 hold.
\end{definition}

\noindent
The explanation of TR4 is that if you think of $Q_1$ as
$Y/X$, $Q_2$ as $Z/X$ and $Q_3$ as $Z/Y$, then TR4(a) expresses
the isomorphism $(Z/X)/(Y/Z) \cong Z/Y$ and TR(b) and TR(c)
express that we can compare the triangles $X \to Y \to Q_1 \to X[1]$
etc with morphisms of triangles. For a more precise reformuation
of this idea see the proof of Lemma \ref{lemma-two-split-injections}.

\medskip\noindent
The sign in TR2 means that if $(X, Y, Z, f, g, h)$ is a distinguished triangle
then in the long sequence
\begin{equation}
\label{equation-rotate}
\ldots \to
Z[-1] \xrightarrow{-h[-1]}
X \xrightarrow{f}
Y \xrightarrow{g}
Z \xrightarrow{h}
X[1] \xrightarrow{-f[1]}
Y[1] \xrightarrow{-g[1]}
Z[1] \to \ldots
\end{equation}
each four term sequence gives a distinguished triangle.

\medskip\noindent
As usual we abuse notation and we simply speak of a (pre-)triangulated
category $\mathcal{D}$ without explicitly introducing notation for the
additional data. The notion of a pre-triangulated category is
useful in finding statements equivalent to TR4.

\medskip\noindent
We have the following definition of a triangulated functor.

\begin{definition}
\label{definition-exact-functor-triangulated-categories}
Let $\mathcal{D}$, $\mathcal{D}'$ be pre-triangulated
categories. An {\it exact functor}, or a {\it triangulated functor}
from $\mathcal{D}$ to $\mathcal{D}'$ is a functor
$F : \mathcal{D} \to \mathcal{D}'$ together
with given functorial isomorphisms $\xi_X : F(X[1]) \to F(X)[1]$
such that for every distinguished triangle
$(X, Y, Z, f, g, h)$ of $\mathcal{D}$ the triangle
$(F(X), F(Y), F(Z), F(f), F(g), \xi_X \circ F(h))$
is a distinguished triangle of $\mathcal{D}'$.
\end{definition}

\noindent
When we say two triangulated categories are equivalent we mean that
they are equivalent in the $2$-category of triangulated categories.
A $2$-morphism $a : (F, \xi) \to (F', \xi')$ in this $2$-category is
simply a transformation of functors $a : F \to F'$ which is compatible
with $\xi$ and $\xi'$, i.e.,
$$
\xymatrix{
F \circ [1] \ar[r]_\xi \ar[d]_{a \star 1} & [1] \circ F \ar[d]^{1 \star a} \\
F' \circ [1] \ar[r]^{\xi'} & [1] \circ F'
}
$$
commutes.

\begin{definition}
\label{definition-triangulated-subcategory}
Let $(\mathcal{D}, [\ ], \mathcal{T})$ be a pre-triangulated category.
A {\it pre-triangulated subcategory}\footnote{This definition may be
nonstandard. An alternative would be to further require that $\mathcal{T}'$
is the intersection of the set of triangles in $\mathcal{D}'$ with
$\mathcal{T}$. If $\mathcal{D}'$ is a full subcategory, then this holds,
so $\mathcal{T}'$ can be dropped from the notation.} is a pair
$(\mathcal{D}', \mathcal{T}')$ such that
\begin{enumerate}
\item $\mathcal{D}'$ is an additive subcategory of $\mathcal{D}$
which is preserved under $[1]$ and $[-1]$,
\item $\mathcal{T}' \subset \mathcal{T}$ is a subset such that for every
$(X, Y, Z, f, g, h) \in \mathcal{T}'$ we have
$X, Y, Z \in \text{Ob}(\mathcal{D}')$ and
$f, g, h \in \text{Arrows}(\mathcal{D}')$, and
\item $(\mathcal{D}', [\ ], \mathcal{T}')$ is a pre-triangulated
category.
\end{enumerate}
If $\mathcal{D}$ is a triangulated category, then we say
$(\mathcal{D}', \mathcal{T}')$ is a {\it triangulated subcategory} if
it is a pre-triangulated subcategory and
$(\mathcal{D}', [\ ], \mathcal{T}')$ is a triangulated category.
\end{definition}

\noindent
In this situation the inclusion functor
$\mathcal{D}' \to \mathcal{D}$ is an exact functor
with $\xi_X : X[1] \to X[1]$ given by the identity on $X[1]$.

\medskip\noindent
We will see in
Lemma \ref{lemma-composition-zero}
that for a distinguished triangle $(X, Y, Z, f, g, h)$
in a pre-triangulated category the composition $g \circ f : X \to Z$ is zero.
Thus the sequence (\ref{equation-rotate}) is a complex.
A homological functor is one that turns this complex into a long
exact sequence.

\begin{definition}
\label{definition-homological}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $\mathcal{A}$ be an abelian category.
An additive functor $H : \mathcal{D} \to \mathcal{A}$ is called
{\it homological} if for every distinguished triangle
$(X, Y, Z, f, g, h)$ the sequence
$$
H(X) \to H(Y) \to H(Z)
$$
is exact in the abelian category $\mathcal{A}$. An additive functor
$H : \mathcal{D}^{opp} \to \mathcal{A}$ is called {\it cohomological}
if the corresponding functor $\mathcal{D} \to \mathcal{A}^{opp}$ is
homological.
\end{definition}

\noindent
If $H : \mathcal{D} \to \mathcal{A}$ is a homological functor
we often write $H^n(X) = H(X[n])$ so that $H(X) = H^0(X)$.
Our discussion of TR2 above implies that says that a distinguished triangle
$(X, Y, Z, f, g, h)$ determines a long exact sequence
\begin{equation}
\label{equation-long-exact-cohomology-sequence}
\xymatrix{
H^{-1}(Z) \ar[r]^{h[-1]} &
H^0(X) \ar[r]^f &
H^0(Y) \ar[r]^g &
H^0(Z) \ar[r]^h &
H^1(X)
}
\end{equation}
This will be called the {\it long exact sequence} associated to the
distinguished triangle and the homological functor. As indicated
we will not use any signs for the morphisms in the long exact
sequence. This has the side effect that maps in the long exact sequence
associated to the rotation (TR2) of a distinguished triangle differ
from the maps in the sequence above by some signs.

\begin{definition}
\label{definition-delta-functor}
Let $\mathcal{A}$ be an abelian category.
Let $\mathcal{D}$ be a triangulated category.
A {\it $\delta$-functor from $\mathcal{A}$ to $\mathcal{D}$} is
given by a functor $G : \mathcal{A} \to \mathcal{D}$ and
a rule which assigns to every short exact sequence
$$
0 \to A \xrightarrow{a} B \xrightarrow{b} C \to 0
$$
a morphism $\delta = \delta_{A \to B \to C} : G(C) \to G(A)[1]$
such that
\begin{enumerate}
\item the triangle
$(G(A), G(B), G(C), G(a), G(b), \delta_{A \to B \to C})$
is a distinguished triangle of $\mathcal{D}$
for any short exact sequence as above, and
\item for every morphism $(A \to B \to C) \to (A' \to B' \to C')$
of short exact sequences the diagram
$$
\xymatrix{
G(C) \ar[d] \ar[rr]_{\delta_{A \to B \to C}} & &
G(A)[1] \ar[d] \\
G(C') \ar[rr]^{\delta_{A' \to B' \to C'}} & &
G(A')[1]
}
$$
is commutative.
\end{enumerate}
In this situation we call
$(G(A), G(B), G(C), G(a), G(b), \delta_{A \to B \to C})$
the {\it image of the short exact sequence under the
given $\delta$-functor}.
\end{definition}

\noindent
Note how a $\delta$-functor comes equipped with additional structure.
Strictly speaking it does not make sense to say that a given
functor $\mathcal{A} \to \mathcal{D}$ is a $\delta$-functor, but we
will often do so anyway.












\subsection{Triangulated categories: Elementary results}
\label{subsection-elementary-results}

\noindent
Most of the results in this section are proved for pre-triangulated categories
and a fortiori hold in any triangulated category.

\begin{lemma}
\label{lemma-composition-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
Then $g \circ f = 0$,
$h \circ g = 0$ and $f[1] \circ h = 0$.
\end{lemma}

\begin{proof}
By TR1 we know $(X, X, 0, 1, 0, 0)$ is a distinguished triangle.
Apply TR3 to
$$
\xymatrix{
X \ar[r] \ar[d]^1 &
X \ar[r] \ar[d]^f &
0 \ar[r] \ar@{-->}[d] &
X[1] \ar[d]^{1[1]} \\
X \ar[r]^f &
Y \ar[r]^g &
Z \ar[r]^h &
X[1]
}
$$
Of course the dotted arrow is the zero map. Hence the commutativity of
the diagram implies that $g \circ f = 0$. For the other cases
rotate the triangle, i.e., apply TR2.
\end{proof}

\begin{lemma}
\label{lemma-representable-homological}
Let $\mathcal{D}$ be a pre-triangulated category.
For any object $W$ of $\mathcal{D}$ the functor
$\text{Hom}_{\mathcal{D}}(W, -)$ is homological, and the functor
$\text{Hom}_{\mathcal{D}}(-, W)$ is cohomological.
\end{lemma}

\begin{proof}
Consider a distinguished triangle $(X, Y, Z, f, g, h)$.
We have already seen that $g \circ f = 0$, see
Lemma \ref{lemma-composition-zero}.
Suppose $a : W \to Y$ is a morphism such that $g \circ a = 0$.
Then we get a commutative diagram
$$
\xymatrix{
W \ar[r]_1 \ar@{..>}[d]^b &
W \ar[r] \ar[d]^a &
0 \ar[r] \ar[d]^0 &
W[1] \ar@{..>}[d]^{b[1]} \\
X \ar[r] & Y \ar[r] & Z \ar[r] & X[1]
}
$$
Both rows are distinguished triangles (use TR1 for the top row).
Hence we can fill the dotted arrow $b$ (first rotate using TR2,
then apply TR3, and then rotate back). This proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-third-isomorphism-triangle}
Let $\mathcal{D}$ be a pre-triangulated category.
Let
$$
(a, b, c) : (X, Y, Z, f, g, h) \to (X', Y', Z', f', g', h')
$$
be a morphism of distinguished triangles. If two among $a, b, c$
are isomorphisms so is the third.
\end{lemma}

\begin{proof}
Assume that $a$ and $c$ are isomorphisms.
For any object $W$ of $\mathcal{D}$ write
$H_W( - ) = \text{Hom}_{\mathcal{D}}(W, -)$.
Then we get a commutative diagram of abelian groups
$$
\xymatrix{
H_W(Z[-1]) \ar[r] \ar[d] &
H_W(X) \ar[r] \ar[d] &
H_W(Y) \ar[r] \ar[d] &
H_W(Z) \ar[r] \ar[d] &
H_W(X[1]) \ar[d] \\
H_W(Z'[-1]) \ar[r] &
H_W(X') \ar[r] &
H_W(Y') \ar[r] &
H_W(Z') \ar[r] &
H_W(X'[1])
}
$$
By assumption the right two and left two vertical arrows are bijective.
As $H_W$ is homological by
Lemma \ref{lemma-representable-homological}
and the five lemma
(Lemma \ref{lemma-five-lemma})
it follows that the middle vertical arrow is an isomorphism.
Hence by Yoneda's lemma, see
Categories, Lemma \ref{categories-lemma-yoneda}
we see that $b$ is an isomorphism.
This implies the other cases by rotating (using TR2).
\end{proof}

\begin{lemma}
\label{lemma-third-map-square-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let
$$
(0, b, 0), (0, b', 0) : (X, Y, Z, f, g, h) \to (X, Y, Z, f, g, h)
$$
be endomorphisms of a distinguished triangle. Then $bb' = 0$.
\end{lemma}

\begin{proof}
Picture
$$
\xymatrix{
X \ar[r] \ar[d]^0 &
Y \ar[r] \ar[d]^{b, b'} \ar@{..>}[ld]^\alpha &
Z \ar[r] \ar[d]^0 \ar@{..>}[ld]^\beta &
X[1] \ar[d]^0 \\
X \ar[r] & Y \ar[r] & Z \ar[r] & X[1]
}
$$
Applying
Lemma \ref{lemma-third-isomorphism-triangle}
we find dotted arrows $\alpha$ and $\beta$ such that
$b' = f \circ \alpha$ and $b = \beta \circ g$. Then
$bb' = \beta \circ g \circ f \circ \alpha = 0$
as $g \circ f = 0$ by
Lemma \ref{lemma-composition-zero}.
\end{proof}

\begin{lemma}
\label{lemma-third-map-idempotent}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
If
$$
\xymatrix{
Z \ar[r]_f \ar[d]_c & X[1] \ar[d]^{a[1]} \\
Z \ar[r]^f & X[1]
}
$$
is commutative and $a^2 = a$, $c^2 = c$, then there exists a
morphism $b : Y \to Y$ with $b^2 = b$ such that
$(a, b, c)$ is an endomorphism of the triangle $(X, Y, Z, f, g, h)$.
\end{lemma}

\begin{proof}
By TR3 there exists a morphism $b'$ such that
$(a, b', c)$ is an endormorphism of $(X, Y, Z, f, g, h)$.
Then $(0, (b')^2 - b', 0)$ is also an endomorphism. By
Lemma \ref{lemma-third-map-square-zero}
we see that $(b')^2 - b'$ has square zero.
Set $b = b' - (2b' - 1)((b')^2 - b') = 3(b')^2 - 2(b')^3$.
A computation shows that $(a, b, c)$ is an endomorphism and
that $b^2 - b = (4(b')^2 - 4b' - 3)((b')^2 - b')^2 = 0$.
\end{proof}

\begin{lemma}
\label{lemma-cone-triangle-unique-isomorphism}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
There exists a distinguished triangle $(X, Y, Z, f, g, h)$ which
is unique up to (nonunique) isomorphism of triangles.
More precisely, given a second such distinguished triangle
$(X, Y, Z', f, g', h')$ there exists an isomorphism
$$
(1, 1, c) : (X, Y, Z, f, g, h) \longrightarrow (X, Y, Z', f, g', h')
$$
\end{lemma}

\begin{proof}
Existence by TR1. Uniqueness up to isomorphism by TR3 and
Lemma \ref{lemma-third-isomorphism-triangle}.
\end{proof}

\begin{lemma}
\label{lemma-third-object-zero}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item $f$ is an isomorphism,
\item $(X, Y, 0, f, 0, 0)$ is a distinguished triangle, and
\item for any distinguished triangle $(X, Y, Z, f, g, h)$ we have $Z = 0$.
\end{enumerate}
\end{lemma}

\begin{proof}
Immediate from
Lemma \ref{lemma-cone-triangle-unique-isomorphism}
and TR1.
\end{proof}

\begin{lemma}
\label{lemma-direct-sum-triangles}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ be triangles.
The following are equivalent
\begin{enumerate}
\item $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')$
is a distinguished triangle,
\item both $(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$ are
distinguished triangles.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (2). By TR1 we may choose a distinguished triangle
$(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$.
By TR3 we can find morphisms of distinguished triangles
$(X, Y, Z, f, g, h) \to
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$
and
$(X', Y', Z', f', g', h') \to
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'')$.
Taking the direct sum of these morphisms
we obtain a morphism of triangles
$$
\xymatrix{
(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')
\ar[d]^{(1, 1, c)} \\
(X \oplus X', Y \oplus Y', Q, f \oplus f', g'', h'').
}
$$
Let $W$ be any object in $\mathcal{D}$ and apply the functor
$H_W = \text{Hom}_{\mathcal{D}}(W, -)$ to this diagram.
By
Lemma \ref{lemma-representable-homological}
(applied three times)
we deduce that $H_W(c) : H_W(Z \oplus Z') \to H_W(Q)$
is an isomorphism. Hence $c$ is an isomorphism and we conclude that
(1) holds.

\medskip\noindent
Assume (1). We will show that $(X, Y, Z, f, g, h)$ is a distinguished
triangle. Let $W$ be any object in $\mathcal{D}$ and set
$H_W = \text{Hom}_{\mathcal{D}}(W, -)$. By
Lemma \ref{lemma-representable-homological}
we see that $H_W(X) \to H_W(Y) \to H_W(Z) \to H_W(Z[1])$ is exact as
it is a direct summand of the exact sequence associated to the distinguished
triangle $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h')$. Using TR1 let
$(X, Y, Q, f, g'', h'')$ be a distinguished triangle. By TR3 there exists
a morphism of distinguished triangles
 $(X \oplus X', Y \oplus Y', Z \oplus Z',
f \oplus f', g \oplus g', h \oplus h') \to (X, Y, Q, f, g'', h'')$.
Composing this with the inclusion map we get a morphism of triangles
$$
(1, 1, c) :
(X, Y, Z, f, g, h)
\longrightarrow
(X, Y, Q, f, g'', h'')
$$
Applying $H_W$ and using the above we once again see that
$H_W(c) : H_W(Z) \to H_W(Q)$ is an isomorphism and we conclude that
$c$ is an isomorphism. Hence we win.
\end{proof}

\begin{lemma}
\label{lemma-split}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle.
\begin{enumerate}
\item If $h = 0$, then there exists a left inverse $s : Z \to Y$ to $g$.
\item For any left inverse $s : Z \to Y$ of $g$ the map
$f \oplus s : X \oplus Z \to Y$ is an isomorphism.
\item For any objects $X', Z'$ of $\mathcal{D}$ the triangle
$(X', X' \oplus Z', Z', (1, 0), (0, 1), 0)$ is distinguished.
\end{enumerate}
\end{lemma}

\begin{proof}
To see (1) use that
$\text{Hom}_{\mathcal{D}}(Z, Y) \to \text{Hom}_{\mathcal{D}}(Z, Z) \to
\text{Hom}_{\mathcal{D}}(Z, X[1])$
is exact by
Lemma \ref{lemma-representable-homological}.
By the same token, if $s$ is as in (2), then $h = 0$ and the sequence
$$
0 \to \text{Hom}_{\mathcal{D}}(W, X) \to \text{Hom}_{\mathcal{D}}(W, Y)
\to \text{Hom}_{\mathcal{D}}(W, Z) \to 0
$$
is split exact (split by $s : Z \to Y$). Hence by Yoneda's lemma we
see that $X \oplus Z \to Y$ is an isomorphism. The last assertion follows
from TR1 and
Lemma \ref{lemma-direct-sum-triangles}.
\end{proof}

\begin{lemma}
\label{lemma-when-split}
Let $\mathcal{D}$ be a pre-triangulated category.
Let $f : X \to Y$ be a morphism of $\mathcal{D}$.
The following are equivalent
\begin{enumerate}
\item $f$ has a kernel,
\item $f$ has a cokernel,
\item $f$ is isomorphic to a map $K \oplus Z \to Z \oplus Q$
induced by $\text{id}_Z$.
\end{enumerate}
\end{lemma}

\begin{proof}
Any morphism isomorphic to a map of the form
$X' \oplus Z \to Z \oplus Y'$ has both a kernel and a cokernel.
Hence (3) $\Rightarrow$ (1), (2).
Next we prove (1) $\Rightarrow$ (3).
Suppose first that $f : X \to Y$ is a monomorphism, i.e., its kernel is zero.
By TR1 there exists a distinguished triangle $(X, Y, Z, f, g, h)$
and by
Lemma \ref{lemma-representable-homological}
we see that $h = 0$. Then
Lemma \ref{lemma-split}
implies that $Y = X \oplus Z$, i.e., we see that (3) holds.
Next, assume $f$ has a kernel $K$. As $K \to X$ is a monomorphism we
conclude $X = K \oplus X'$ and $f|_{X'} : X' \to Y$ is a monomorphism.
Hence $Y = X' \oplus Y'$ and we win.
The implication (2) $\Rightarrow$ (3) is dual to this.
\end{proof}

\begin{lemma}
\label{lemma-projectors-have-images}
Let $\mathcal{D}$ be an additive category which has countable products
and has kernels of maps which have a left inverse. Then $\mathcal{D}$
has kernels of idempotents.
\end{lemma}

\begin{proof}
Let $\mathcal{D}$ be an additive category. Let $X$ be an object of
$\mathcal{D}$ and let $e : X \to X$ be an idempotent. Then
functor
$$
W \longmapsto \text{Ker}(
\text{Mor}_{\mathcal{D}}(W, X)
\xrightarrow{e}
\text{Mor}_{\mathcal{D}}(W, X)
)
$$
if representable if and only if $e$ has a kernel. Note that for any
abelian group $A$ and idempotent endomorphism $e : A \to A$ we have
$$
\text{Ker}(e : A \to A)
= \text{Ker}(\Phi :
\prod\nolimits_{n \in \mathbf{N}} A
\to
\prod\nolimits_{n \in \mathbf{N}} A
)
$$
where
$$
\Phi(a_1, a_2, a_3, \ldots) = (ea_1 + (1 - e)a_2, ea_2 + (1 - e)a_3, \ldots)
$$
Moreover, $\Phi$ has the left inverse
$$
\Psi(a_1, a_2, a_3, \ldots) =
(a_1, (1 - e)a_1 + ea_2, (1 - e)a_2 + ea_3, \ldots).
$$
Hence if $\mathcal{D}$ has countable products and kernels of maps which
have a left inverse, then we see that kernel of $e$ exists.
\end{proof}

\begin{lemma}
\label{lemma-projectors-have-images-triangulated}
Let $\mathcal{D}$ be a pre-triangulated category.
If $\mathcal{D}$ has countable products, then $\mathcal{D}$
has kernels of idempotents.
If $\mathcal{D}$ has countable coproducts, then $\mathcal{D}$
has kernels of idempotents.
\end{lemma}

\begin{proof}
Assume $\mathcal{D}$ has countable products. Then it suffices to
check that morphisms which have a left inverse have kernels.
Any morphism which has a left inverse is an epimorphism, hence
has a kernel by
Lemma \ref{lemma-when-split}.
The second statement is dual to the first.
\end{proof}

\noindent
The following lemma makes it slightly easier to prove that a
pre-triangulated category is triangulated.

\begin{lemma}
\label{lemma-easier-axiom-four}
Let $\mathcal{D}$ be a pre-triangulated category.
In order to prove TR4 it suffices to show that given
any pair of composable morphisms
$f : X \to Y$ and $g : Y \to Z$ there exist
\begin{enumerate}
\item isomorphisms $i : X' \to X$, $j : Y' \to Y$ and
$k : Z' \to Z$, and then setting $f' = j^{-1}fi : X' \to Y'$ and
$g' = k^{-1}gj : Y' \to Z'$ there exist
\item distinguished triangles
$(X', Y', Q_1, f', p_1, d_1)$,
$(X', Z', Q_2, g' \circ f', p_2, d_2)$
and
$(Y', Z', Q_3, g', p_3, d_3)$,
such that the assertion of TR4 holds.
\end{enumerate}
\end{lemma}

\begin{proof}
The replacement of $X, Y, Z$ by $X', Y', Z'$ is harmless by our
definition of distinguished triangles and their isomorphisms.
The lemma follows from the fact that the distinguished triangles
$(X', Y', Q_1, f', p_1, d_1)$,
$(X', Z', Q_2, g' \circ f', p_2, d_2)$
and
$(Y', Z', Q_3, g', p_3, d_3)$
are unique up to isomorphism by
Lemma \ref{lemma-cone-triangle-unique-isomorphism}.
\end{proof}










\section{Cones and termwise split sequences}
\label{section-cones}

\noindent
Let $\mathcal{A}$ be an additive category, and let
$K(\mathcal{A})$ denote the category of complexes of
$\mathcal{A}$ with morphisms given by morphisms of
complexes up to homotopy. In this section we show that
there is a natural structure of a triangulated category on
$K(\mathcal{A})$. Note that the shift functors
$[n]$ on complexes, see Definition \ref{definition-shift-cochain},
give rise to functors $[n] : K(\mathcal{A}) \to K(\mathcal{A})$
such that $[n] \circ [m] = [n + m]$ and $[0] = \text{id}$.

\begin{definition}
\label{definition-cone}
Let $\mathcal{A}$ be an additive category.
Let $f : K^\bullet \to L^\bullet$ be a morphism of
complexes of $\mathcal{A}$. The {\it cone} of $f$
is the complex $C(f)^\bullet$ given by
$C(f)^n = L^n \oplus K^{n + 1}$ and
differential
$$
d_{C(f)}^n =
\left(
\begin{matrix}
d^n_L & f^{n + 1} \\
0 & -d_K^{n + 1}
\end{matrix}
\right)
$$
It comes equipped with canonical morphisms of complexes
$i : L^\bullet \to C(f)^\bullet$ and $p : C(f)^\bullet \to K^\bullet[1]$
induced by the obvious maps $L^n \to C(f)^n \to K^{n + 1}$.
\end{definition}

\noindent
In other words $(K, L, C(f), f, i, p)$ forms a triangle:
$$
K^\bullet \to L^\bullet \to C(f)^\bullet \to K^\bullet[1]
$$
The formation of this triangle is
functorial in the following sense.

\begin{lemma}
\label{lemma-functorial-cone}
Suppose that
$$
\xymatrix{
K_1^\bullet \ar[r]_{f_1} \ar[d]_a & L_1^\bullet \ar[d]^b \\
K_2^\bullet \ar[r]^{f_2} & L_2^\bullet
}
$$
is a diagram of morphisms of complexes which is commutative
up to homotopy. Then there exists a morphism
$c : C(f_1)^\bullet \to C(f_2)^\bullet$ which gives rise to
a morphism of triangles
$(a, b, c) : (K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_1, i_1, p_1)
\to
(K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_2, i_2, p_2)$
of $K(\mathcal{A})$.
\end{lemma}

\begin{proof}
Let $h^n : K_1^n \to L_2^{n - 1}$ be a family of morphisms such that
$f_2 \circ a - b \circ f_1 = d \circ h + h \circ d$.
Define $c^n$ by the matrix
$$
c^n =
\left(
\begin{matrix}
a^n & h^{n + 1} \\
0 & b^n
\end{matrix}
\right) :
L_1^n \oplus K_1^{n + 1} \to L_2^n \oplus K_2^{n + 1}
$$
A matrix computation show that $c$ is a morphism of complexes.
It is trivial that $c \circ i_1 = i_2 \circ b$, and it is
trivial also to check that $p_2 \circ c = a \circ p_1$.
\end{proof}

\noindent
Note that the morphism $c : C(f_1)^\bullet \to C(f_2)^\bullet$
constructed in the
proof of Lemma \ref{lemma-functorial-cone} in general depends on the
chosen homotopy $h$ between $f_2 \circ a$ and $b \circ f_1$.

\begin{definition}
\label{definition-termwise-split-map}
Let $\mathcal{A}$ be an additive category.
A {\it termwise split injection $\alpha : A^\bullet \to B^\bullet$}
is a morphism of complexes such that each $A^n \to B^n$
is isomorphic to the inclusion of a direct summand.
A {\it termwise split surjection $\beta : B^\bullet \to C^\bullet$}
is a morphism of complexes such that each $B^n \to C^n$
is isomorphic to the projection onto a direct summand.
\end{definition}

\begin{lemma}
\label{lemma-make-commute-map}
Let $\mathcal{A}$ be an additive category.
Let
$$
\xymatrix{
A^\bullet \ar[r]_f \ar[d]_a & B^\bullet \ar[d]^b \\
C^\bullet \ar[r]^g & D^\bullet
}
$$
be a diagram of morphisms of complexes commuting up to homotopy.
If $f$ is a split injection, then $b$ is homotopic to a
morphism which makes the diagram commute.
If $g$ is a split surjection, then $a$ is homotopic to a
morphism which makes the diagram commute.
\end{lemma}

\begin{proof}
Let $h^n : A^n \to D^{n - 1}$ be a collection of morphisms
such that $bf - ga = dh + hd$. Let
Suppose that $\pi^n : B^n \to A^n$
are morphisms splitting the morphisms $f^n$.
Take $b' = b + dh\pi + h\pi d$.
Suppose $s^n : D^n \to C^n$ are morphisms splitting the morphisms
$g^n : C^n \to D^n$. Take $a' = a + dsh + shd$.
Computations omitted.
\end{proof}

\begin{definition}
\label{definition-split-ses}
Let $\mathcal{A}$ be an additive category.
A {\it termwise split sequence of complexes of $\mathcal{A}$}
is a complex of complexes
$$
0 \to
A^\bullet \xrightarrow{\alpha}
B^\bullet \xrightarrow{\beta}
C^\bullet \to 0
$$
together with given direct sum decompositions
$B^n = A^n \oplus C^n$
compatible with $\alpha^n$ and $\beta^n$.
We often write $s^n : C^n \to B^n$ and $\pi^n : B^n \to A^n$
for the maps induced by the direct sum decompositions.
According to Lemma \ref{lemma-ses-termwise-split-cochain}
we get an associated morphism of complexes
$$
\delta : C^\bullet \longrightarrow A^\bullet[1]
$$
which in degree $n$ is the map $\pi^{n + 1} \circ d_C^n \circ s^n$.
In other words
$(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
forms a triangle
$$
A^\bullet \to B^\bullet \to C^\bullet \to A^\bullet[1]
$$
This will be the {\it triangle associated to the termwise
split sequence of complexes}.
\end{definition}

\begin{lemma}
\label{lemma-make-commute}
Let $\mathcal{A}$ be an additive category.
Let $0 \to A_i^\bullet \to B_i^\bullet \to C_i^\bullet \to 0$, $i = 1, 2$
be termwise split exact sequences. Suppose that
$a : A_1^\bullet \to A_2^\bullet$,
$b : B_1^\bullet \to B_2^\bullet$, and
$c : C_1^\bullet \to C_2^\bullet$ are morphisms of complexes
such that
$$
\xymatrix{
A_1^\bullet \ar[d]_a \ar[r] &
B_1^\bullet \ar[r] \ar[d]_b &
C_1^\bullet \ar[d]_c \\
A_2^\bullet \ar[r] & B_2^\bullet \ar[r] & C_2^\bullet
}
$$
commutes in $K(\mathcal{A})$. Then there exists a morphism
$b' : B_1^\bullet \to B_2^\bullet$
which is homotopic to $b$ such that the diagram above commutes
in the category of complexes.
\end{lemma}

\begin{proof}
Let $f^n : A_1^n \to B_2^{n - 1}$ be a collection of morphisms
such that $b \circ \alpha_1 - \alpha_2 \circ a =
d  \circ f + f \circ d$. Let
$g^n : B_1^n \to C_2^{n - 1}$ be a collection of morphisms
such that $c \circ \beta_1 - \beta_2 \circ b =
d  \circ g + g \circ d$. Suppose that
$\pi^n : B_1^n \to A_1^n$ (resp.\ $s^n : C_2^n \to B_2^n$)
are the morphisms splitting the morphisms $\alpha_1^n$
(resp.\ $\beta_2^n$). Set $h^n = - f^n \circ \pi^n + s^{n - 1} \circ g^n$.
Take $b' = b + d \circ h + h \circ d$. Computation omitted.
\end{proof}

\begin{lemma}
\label{lemma-third-isomorphism}
Let $\mathcal{A}$ be an additive category.
Let $f_1 : K_1^\bullet \to L_1^\bullet$ and
$f_2 : K_2^\bullet \to L_2^\bullet$ be morphisms of complexes.
Let $(a, b, c) : (K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_1, i_1, p_1)
\to  (K_1^\bullet, L_1^\bullet, C(f_1)^\bullet, f_2, i_2, p_2)$
be any morphism of triangles of $K(\mathcal{A})$.
If $a$ and $b$ are homotopy equivalences then so is $c$.
\end{lemma}

\begin{proof}
Let $a^{-1} : K_2^\bullet \to K_1^\bullet$ be a morphism of complexes which
is inverse to $a$ in $K(\mathcal{A})$.
Let $b^{-1} : L_2^\bullet \to L_1^\bullet$ be a morphism of complexes which
is inverse to $b$ in $K(\mathcal{A})$.
Let $c' : C(f_2)^\bullet \to C(f_1)^\bullet$
be the morphism from Lemma \ref{lemma-functorial-cone} applied
to $f_1 \circ a^{-1} = b^{-1} \circ f_2$. If we can show that
$c \circ c'$ and $c' \circ c$ are isomorphisms in $K(\mathcal{A})$
then we win. Hence it suffices to prove the following: Given
a morphism of triangles
$(1, 1, c) : (K^\bullet, L^\bullet, C(f)^\bullet, f, i, p)$
the morphism $c$ is an isomorphism in $K(\mathcal{A})$.
By assumption the two squares in the diagram
$$
\xymatrix{
L^\bullet \ar[r] \ar[d]_1 &
C(f)^\bullet \ar[r] \ar[d]_c &
K^\bullet[1] \ar[d]_1 \\
L^\bullet \ar[r] &
C(f)^\bullet \ar[r] &
K^\bullet[1]
}
$$
commute up to homotopy. By construction of $C(f)^\bullet$ the rows
form termwise split sequences of complexes.
By Lemma \ref{lemma-make-commute} we may replace $c$ by
a morphism homotopic to $c$ such that the diagram commutes in the
category of complexes. In this case each $c^n$ is an isomorphism
(because an upper triangular matrix with $1$'s on the diagonal is invertible).
\end{proof}

\noindent
Hence if $a$ and $b$ are homotopy equivalences then
the resulting morphism of triangles is an isomorphism of triangles
in $K(\mathcal{A})$.
It turns out that the collection of triangles of $K(\mathcal{A})$
given by cones and the collection of triangles of $K(\mathcal{A})$
given by termwise split sequences of complexes are the same
up to isomorphisms, at least up to sign!

\begin{lemma}
\label{lemma-the-same-up-to-isomorphisms}
Let $\mathcal{A}$ be an additive category.
\begin{enumerate}
\item Given a termwise split sequence of complexes
$(\alpha : A^\bullet \to B^\bullet,
\beta : B^\bullet \to C^\bullet, s^n, \pi^n)$
there exists a homotopy equivalence $C(\alpha)^\bullet \to C^\bullet$
such that the diagram
$$
\xymatrix{
A^\bullet \ar[r] \ar[d] & B^\bullet \ar[d] \ar[r] &
C(\alpha)^\bullet \ar[r]_{-p} \ar[d] & A^\bullet[1] \ar[d] \\
A^\bullet \ar[r] & B^\bullet \ar[r] &
C^\bullet \ar[r]^\delta & A^\bullet[1]
}
$$
defines an isomorphism of triangles in $K(\mathcal{A})$.
\item Given a morphism of complexes $f : K^\bullet \to L^\bullet$
there exists an isomorphism of triangles
$$
\xymatrix{
K^\bullet \ar[r] \ar[d] & \tilde L^\bullet \ar[d] \ar[r] &
M^\bullet \ar[r]_{\delta} \ar[d] & K^\bullet[1] \ar[d] \\
K^\bullet \ar[r] & L^\bullet \ar[r] &
C(f)^\bullet \ar[r]^{-p} & K^\bullet[1]
}
$$
where the upper triangle is the triangle associated to a
termwise split exact sequence $K^\bullet \to \tilde L^\bullet \to M^\bullet$.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). We have $C(\alpha)^n = B^n \oplus A^{n + 1}$
and we simply define $C(\alpha)^n \to C^n$ via the projection
onto $B^n$ followed by $\beta^n$. This defines
a morphism of complexes because the compositions
$A^{n + 1} \to B^{n + 1} \to B^n \to C^n$ are zero.
To get a homotopy inverse we take
$C^\bullet \to C(\alpha)^\bullet$ given by
$(s^n , -\delta^n)$ in degree $n$. This is a morphism of complexes
because the morphism $\delta^n$ can be characterized as the
unique morphism $C^n \to A^{n + 1}$ such that
$d \circ s^n - s^{n + 1} \circ d = \alpha \circ \delta^n$,
see proof of Lemma \ref{lemma-ses-termwise-split-cochain}. The composition
$C^\bullet \to C(f)^\bullet \to C^\bullet$ is the identity.
The composition $C(f)^\bullet \to C^\bullet \to C(f)^\bullet$
is equal to the morphism
$$
\left(
\begin{matrix}
s^n \circ \beta^n & 0 \\
-\delta^n \circ \beta^n & 0
\end{matrix}
\right)
$$
To see that this is homotopic to the identity map
use the homotopy $h^n : C(\alpha)^n \to C(\alpha)^{n - 1})$
given by the matrix
$$
\left(
\begin{matrix}
0 & 0 \\
\pi^n & 0
\end{matrix}
\right) : C(\alpha)^n = B^n \oplus A^{n + 1} \to
B^{n - 1} \oplus A^n = C(\alpha)^{n - 1}
$$
It is trivial to verify that
$$
\left(
\begin{matrix}
1 & 0 \\
0 & 1
\end{matrix}
\right)
-
\left(
\begin{matrix}
s^n &
-\delta^n
\end{matrix}
\right)
\left(
\begin{matrix}
\beta^n \\
0
\end{matrix}
\right)
=
\left(
\begin{matrix}
d & \alpha^{n + 1} \\
0 & -d
\end{matrix}
\right)
\left(
\begin{matrix}
0 & 0 \\
\pi^n & 0
\end{matrix}
\right)
+
\left(
\begin{matrix}
0 & 0 \\
\pi^{n + 1} & 0
\end{matrix}
\right)
\left(
\begin{matrix}
d & \alpha^{n + 1} \\
0 & -d
\end{matrix}
\right)
$$
To finish the proof of (1) we have to show that the morphisms
$-p : C(\alpha)^\bullet \to A^\bullet[1]$ (see
Definition \ref{definition-cone})
and  $C(\alpha)^\bullet \to C^\bullet \to A^\bullet[1]$ agree up
to homotopy. This is clear from the above. Namely, we can use the homotopy
inverse $(s, -\delta) : C^\bullet \to C(\alpha)^\bullet$
and check instead that the two maps
$C^\bullet \to A^\bullet[1]$ agree. And note that
$p \circ (s, -\delta) = -\delta$ as desired.

\medskip\noindent
Proof of (2). We let $\tilde f : K^\bullet \to \tilde L^\bullet$,
$s : L^\bullet \to \tilde L^\bullet$
and $\pi : L^\bullet \to L^\bullet$ be as in
Lemma \ref{lemma-make-injective}. By Lemmas \ref{lemma-functorial-cone}
and \ref{lemma-third-isomorphism}
the triangles $(K^\bullet, L^\bullet, C(f), i, p)$ and
$(K^\bullet, \tilde L^\bullet, C(\tilde f), \tilde i, \tilde p)$
are isomorphic. Note that we can compose isomorphisms of
triangles. Thus we may replace $L^\bullet$ by
$\tilde L^\bullet$ and $f$ by $\tilde f$. In other words
we may assume that $f$ is a termwise split injection.
In this case the result follows from part (1).
\end{proof}


\begin{lemma}
\label{lemma-sequence-maps-split}
Let $\mathcal{A}$ be an additive category.
Let $A_1^\bullet \to A_2^\bullet \to \ldots \to A_n^\bullet$
be a sequence of composable morphisms of complexes.
There exists a commutative diagram
$$
\xymatrix{
A_1^\bullet \ar[r] &
A_2^\bullet \ar[r] &
\ldots \ar[r] &
A_n^\bullet \\
B_1^\bullet \ar[r] \ar[u] &
B_2^\bullet \ar[r] \ar[u] &
\ldots \ar[r] &
B_n^\bullet \ar[u]
}
$$
such that each morphism $B_i^\bullet \to B_{i + 1}^\bullet$
is a split injection and each $B_i^\bullet \to A_i^\bullet$
is a homotopy equivalence.
\end{lemma}

\begin{proof}
The case $n = 1$ is without content.
Lemma \ref{lemma-make-injective} is the case $n = 2$.
Suppose we have constructed the diagram
except for $B_n$. Applying Lemma \ref{lemma-make-injective} to
the composition $B_{n - 1} \to A_{n - 1} \to A_n$.
The result is a factorization $B_{n - 1} \to \tilde B_n \to A_n$
as desired.
\end{proof}


\begin{lemma}
\label{lemma-rotate-triangle}
Let $\mathcal{A}$ be an additive category. Let
$(\alpha : A^\bullet \to B^\bullet, \beta : B^\bullet \to C^\bullet, s^n,
\pi^n)$ be a termwise split sequence of complexes.
Let $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
be the associated triangle.
Then the triangle
$(C^\bullet[-1], A^\bullet, B^\bullet, \delta[-1], \alpha, \beta)$
is isomorphic to the triangle
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, p)$.
\end{lemma}

\begin{proof}
We write $B^n = A^n \oplus C^n$ and we identify $\alpha^n$ and $\beta^n$
with the natural inclusion and projection maps. By construction of $\delta$ we
have
$$
d_B^n =
\left(
\begin{matrix}
d_A^n & \delta^n \\
0 & d_C^n
\end{matrix}
\right)
$$
On the other hand the cone of $\delta[-1] : C^\bullet[-1] \to A^\bullet$
is given as $C(\delta[-1])^n = A^n \oplus C^n$ with differential identical
with the matrix above! Whence the lemma.
\end{proof}

\begin{lemma}
\label{lemma-rotate-cone}
Let $\mathcal{A}$ be an additive category.
Let $f : K^\bullet \to L^\bullet$ be a morphism of complexes.
The triangle $(L^\bullet, C(f)^\bullet, K^\bullet[1], i, p, f[1])$ is
the triangle associated to the termwise split sequence
$$
0 \to L^\bullet \to C(f)^\bullet \to K^\bullet[1] \to 0
$$
coming from the definition of the cone of $f$.
\end{lemma}

\begin{proof}
Immediate from the definitions.
\end{proof}







\section{The homotopy category as a triangulated category}
\label{section-homotopy-triangulated}

\noindent
Since we want our boundary maps in long exact sequences of cohomology
to be given by the maps in the snake lemma without signs we define
distinguished triangles as follows.

\begin{definition}
\label{definition-distinguished-triangle}
Let $\mathcal{A}$ be an additive category.
A triangle $(X, Y, Z, f, g, h)$ of $K(\mathcal{A})$ is
called a {\it distinguished triangle of $K(\mathcal{A})$}
if it is isomorphic to the triangle associated to
a termwise split exact sequence of complexes, see Definition
\ref{definition-split-ses}.
Same definition for $K^{+}(\mathcal{A})$.
\end{definition}

\noindent
Note that according to Lemma \ref{lemma-the-same-up-to-isomorphisms}
a triangle of the form $(K^\bullet, L^\bullet, C(f)^\bullet, f, i, -p)$
is a distinguished triangle.
This does indeed lead to a triangulated category, see
Proposition \ref{lemma-the-same-up-to-isomorphisms}.
Before we can prove the proposition we need one more lemma
in order to be able to prove TR4.

\begin{lemma}
\label{lemma-two-split-injections}
Let $\mathcal{A}$ be an additive category. Suppose that
$\alpha : A^\bullet \to B^\bullet$ and $\beta : B^\bullet \to C^\bullet$
are split injections of complexes. Then there exist distinguished triangles
$(A^\bullet, B^\bullet, Q_1^\bullet, \alpha, p_1, d_1)$,
$(A^\bullet, C^\bullet, Q_2^\bullet, \beta \circ \alpha, p_2, d_2)$
and
$(B^\bullet, C^\bullet, Q_3^\bullet, \beta, p_3, d_3)$
for which TR4 holds.
\end{lemma}

\begin{proof}
Say $\pi_1^n : B^n \to A^n$, and $\pi_3^n : C^n \to B^n$ are the splittings.
Then also $A^\bullet \to C^\bullet$ is a split injection with splittings
$\pi_2^n = \pi_1^n \circ \pi_3^n$. Let us write $Q_1^\bullet$, $Q_2^\bullet$
and $Q_3^\bullet$ for the ``quotient'' complexes. In other words,
$Q_1^n = \text{Ker}(\pi_1^n)$, $Q_3^n = \text{Ker}(\pi_3^n)$ and
$Q_2^n = \text{Ker}(\pi_2^n)$. Note that the kernels exist. Then
$B^n = A^n \oplus Q_1^n$ and $C_n = B^n \oplus Q_3^n$, where we think of $A^n$
as a subobject of $B^n$ and so on. This implies
$C^n = A^n \oplus Q_1^n \oplus Q_3^n$. Note that
$\pi_2^n = \pi_1^n \circ \pi_3^n$ is zero on both $Q_1^n$ and $Q_3^n$. Hence
$Q_2^n = Q_1^n \oplus Q_3^n$. Consider the commutative diagram
$$
\begin{matrix}
0 & \to & A^\bullet & \to & B^\bullet & \to & Q_1^\bullet & \to & 0 \\
  &     & \downarrow&     & \downarrow&     & \downarrow  & \\
0 & \to & A^\bullet & \to & C^\bullet & \to & Q_2^\bullet & \to & 0 \\
  &     & \downarrow&     & \downarrow&     & \downarrow  & \\
0 & \to & B^\bullet & \to & C^\bullet & \to & Q_3^\bullet & \to & 0
\end{matrix}
$$
The rows of this diagram are termwise split exact sequences, and
hence determine distinguished triangles by
definition. Moreover downward arrows in the diagram above
are compatible with the chosen splittings and hence
define morphisms of triangles
$$
(A^\bullet \to B^\bullet \to Q_1^\bullet \to A^\bullet[1])
\longrightarrow
(A^\bullet \to C^\bullet \to Q_2^\bullet \to A^\bullet[1])
$$
and
$$
(A^\bullet \to C^\bullet \to Q_2^\bullet \to A^\bullet[1])
\longrightarrow
(B^\bullet \to C^\bullet \to Q_3^\bullet \to B^\bullet[1])
$$
by our specific choice of the splitting of the middle row
in the large displayed diagram above.
Note that the splittings $Q_3^n \to C^n$
of the bottom split sequence in the diagram provides a splitting
for the split sequence
$0 \to Q_1^\bullet \to Q_2^\bullet \to Q_3^\bullet \to 0$
upon composing with $C^n \to Q_2^n$. It follows easily from this
that the morphism $\delta : Q_3^\bullet \to Q_1^\bullet[1]$
in the corresponding distinguished triangle
$$
(Q_1^\bullet \to Q_2^\bullet \to Q_3^\bullet \to Q_1^\bullet[1])
$$
is equal to the composition $Q_3^\bullet \to B^\bullet[1] \to Q_1^\bullet[1]$.
Hence we get a structure as in the conclusion of axiom TR4.
\end{proof}

\begin{proposition}
\label{proposition-homotopy-category-triangulated}
Let $\mathcal{A}$ be an additive category.
The category $K(\mathcal{A})$ of complexes up to
homotopy with its natural translation functors
and distinguished triangles as defined above
is a triangulated category. Same statement for
$K^{+}(\mathcal{A})$.
\end{proposition}

\begin{proof}
Proof of TR1. By definition every triangle isomorphic to a distinguished
one is distinguished. Also, any triangle $(A^\bullet, A^\bullet, 0, 1, 0, 0)$
is distinguished since $0 \to A^\bullet \to A^\bullet \to 0 \to 0$ is
a termwise split sequence of complexes. Finally, given any morphism of
complexes $f : K^\bullet \to L^\bullet$ the triangle
$(K, L, C(f), f, i, -p)$ is distinguished by
Lemma \ref{lemma-the-same-up-to-isomorphisms}.

\medskip\noindent
Proof of TR2. Let $(X, Y, Z, f, g, h)$ be a triangle.
Assume $(Y, Z, X[1], g, h, -f[1])$ is distinguished.
Then there exists a termwise split sequence of complexes
$A^\bullet \to B^\bullet \to C^\bullet$ such that the associated
triangle $(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
is isomorphic to $(Y, Z, X[1], g, h, -f[1])$. Rotating back we see
that $(X, Y, Z, f, g, h)$ is isomorphic to
$(C^\bullet[-1], A^\bullet, B^\bullet, -\delta[-1], \alpha, \beta)$.
It follows from Lemma \ref{lemma-rotate-triangle} that the triangle
$(C^\bullet[-1], A^\bullet, B^\bullet, \delta[-1], \alpha, \beta)$
is isomorphic to
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, p)$.
Precomposing the previous isomorphism of triangles with $-1$ on $Y$
it follows that $(X, Y, Z, f, g, h)$ is isomorphic to
$(C^\bullet[-1], A^\bullet, C(\delta[-1])^\bullet, \delta[-1], i, -p)$.
Hence it is distinguished by
Lemma \ref{lemma-the-same-up-to-isomorphisms}.
On the other hand, suppose that $(X, Y, Z, f, g, h)$ is distinguished.
By Lemma \ref{lemma-the-same-up-to-isomorphisms} this means that it is
isomorphic to a triangle of the form
$(K^\bullet, L^\bullet, C(f), f, i, -p)$ for some morphism of
complexes $f$. Then the rotated triangle $(Y, Z, X[1], g, h, -f[1])$ is
isomorphic to $(L^\bullet, C(f), K^\bullet[1], i, -p, -f[1])$ which is
isomorphic to the triangle $(L^\bullet, C(f), K^\bullet[1], i, p, f[1])$.
By Lemma \ref{lemma-rotate-cone} this triangle is distinguished.
Hence $(Y, Z, X[1], g, h, -f[1])$ is distinguished as desired.

\medskip\noindent
Proof of TR3. Let
$(X, Y, Z, f, g, h)$ and $(X', Y', Z', f', g', h')$
be distinguished triangles of $K(\mathcal{A})$
and let $a : X \to X'$ and $b : Y \to Y'$ be morphisms
such that $f' \circ a = b \circ f$. By Lemma \ref{lemma-functorial-cone}
we may assume that
$(X, Y, Z, f, g, h) = (X, Y, C(f), f, i, p)$ and
$(X', Y', Z', f', g', h') = (X', Y', C(f'), f', i', p')$.
At this point we simply apply Lemma \ref{lemma-functorial-cone}
to the commutative diagram given by $f, f', a, b$.

\medskip\noindent
Proof of TR4. At this point we know that $K(\mathcal{A})$
is a pre-triangulated category. Hence we can use
Lemma \ref{lemma-easier-axiom-four}. Let $A^\bullet \to B^\bullet$
and $B^\bullet \to C^\bullet$ be composable morphisms of
$K(\mathcal{A})$. By Lemma \ref{lemma-sequence-maps-split} we may assume that
$A^\bullet \to B^\bullet$ and $B^\bullet \to C^\bullet$
are split injective morphisms. In this case the result follows
from Lemma \ref{lemma-two-split-injections}.

\medskip\noindent
For the proof of the stament on $K^{+}(\mathcal{A})$, note that
the cone construction applied to a morphism of bounded below
complexes produces a bounded below complex. Similarly, given a termwise
split sequence of complexes such that two out of the three complexes
are bounded below then the third one is as well. In this way
we see that the arguments for the case of $K(\mathcal{A})$ apply
to $K^{+}(\mathcal{A})$ as well. Details omitted.
\end{proof}









\section{The derived category as a triangulated category}
\label{section-derived-triangulated}

\noindent
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
Denote $\mathcal{I} \subset \mathcal{A}$ the full subcategory consisting
of all injective objects of $\mathcal{A}$. Note that $\mathcal{I}$
is an additive category. Hence the derived category
$D^{+}(\mathcal{A}) = K^{+}(\mathcal{I})$ is the
homotopy category of bounded below complexes in an additive category.
Thus Definition \ref{definition-distinguished-triangle}
gives a notion of a distinguished triangle. By
Proposition \ref{proposition-homotopy-category-triangulated}
we see $D^{+}(\mathcal{A})$ a triangulated category.
Note that any short exact sequence
$0 \to I^\bullet \to B^\bullet \to C^\bullet \to 0$
of complexes of $\mathcal{A}$ with $I^\bullet$ a complex of injectives
is termwise split (see Lemma \ref{lemma-characterize-injectives}).

\begin{definition}
\label{definition-derived-triangulated}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
The structure of a triangulated category on
the derived category $D^{+}(\mathcal{A})$ is the one where
a {\it distinguished triangle in the derived category}
$D^{+}(\mathcal{A})$ is any triangle of $D^{+}(\mathcal{A})$
isomorphic to the triangle associated to a short exact sequence
of complexes of injectives (see Definition \ref{definition-split-ses}).
\end{definition}

\noindent
This makes sense by the discussion above.
Next we would like to show that a resolution
functor $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
is compatible with the given structures of triangulated
categories.

\begin{lemma}
\label{lemma-j-is-exact}
Let $\mathcal{A}$ be an abelian category.
Any localization functor
$j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
(see Definition \ref{definition-localization-functor})
is exact.
\end{lemma}

\begin{proof}
Denote $i_{K^\bullet} : K^\bullet \to j(K^\bullet)$ the
canonical maps of Definition \ref{definition-localization-functor}.
First we discuss the existence of the functorial isomorphism
$j(K^\bullet[1]) \to j(K^\bullet)[1]$.
Consider the diagram
$$
\xymatrix{
K^\bullet[1] \ar[d]^{i_{K^\bullet[1]}} \ar@{=}[r] &
K^\bullet[1] \ar[d]^{i_{K^\bullet}[1]} \\
j(K^\bullet[1]) \ar@{-->}[r] & j(K^\bullet)[1]
}
$$
By Lemmas \ref{lemma-morphisms-lift}
and \ref{lemma-morphisms-equal-up-to-homotopy}
there exists a unique dotted arrow in $D^{+}(\mathcal{A})$
making the diagram commute in $K^{+}(\mathcal{A})$.
We omit the verification that this gives a functorial isomorphism.
(Hint: use Lemma \ref{lemma-morphisms-equal-up-to-homotopy} again.)

\medskip\noindent
Let $(X, Y, Z, f, g, h)$ be a distinguished triangle of $K^{+}(\mathcal{A})$.
We have to show that $(j(X), j(Y), j(Z), j(f), j(g), j(h))$ is
a distinguished triangle of $D^{+}(\mathcal{A})$. To see this, since
$j$ is a functor, we may replace $(X, Y, Z, f, g, h)$ by any triangle
isomorphic to it and prove it for that triangle. Hence we may and do
assume that $(X, Y, Z, f, g, h)$ is the distinguished triangle
associated to a termwise split sequence of complexes
$$
0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0.
$$
Choose splittings $(s^n, \pi^n)$ and denote
$\delta : C^\bullet \to A^\bullet[1]$ the associated
morphism. Set
$$
J^n = j(A)^n \oplus j(C)^n
$$
and define a differential by the matrix
$$
d_J^n =
\left(
\begin{matrix}
d_{I_1}^n & j(\delta)^n \\
0 & d_{I_2}^n
\end{matrix}
\right).
\text{ Also, note that: }
d_B^n =
\left(
\begin{matrix}
d_{A}^n & \delta^n \\
0 & d_{B}^n
\end{matrix}
\right)
$$
Thus we get a morphism of termwise split
sequences of complexes
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r]_\alpha \ar[d] &
B^\bullet \ar[r]_\beta \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
j(A^\bullet) \ar[r]^a &
J^\bullet \ar[r]^b &
j(C^\bullet) \ar[r] &
0
}
$$
where the middle vertical arrow is compatible with the
splittings of both the top row and the bottom row.
Since the left and right vertical arrows are quasi-isomorphisms
also the middle vertical arrow is a quasi-isomorphism.
Hence we see that $J^\bullet \cong j(B^\bullet)$ in a manner which
identifies $a$ with $j(\alpha)$
and $b$ with $j(\beta)$.
The lower short exact sequence of the diagram implies that the
triangle
$(j(A^\bullet), J^\bullet, j(C^\bullet), a, b, j(\delta))$
is distinguished in $D^{+}(\mathcal{A})$. By definition of
a triangulated category and using the isomorphism
$J^\bullet \to j(B^\bullet)$ above we deduce that
the triangle
$$
(j(A^\bullet), j(B^\bullet), j(C^\bullet), j(\alpha), j(\beta), j(\delta))
$$
is distinguished as desired. Some details omitted.
\end{proof}

\noindent
Here is another type of exact functor.

\begin{lemma}
\label{lemma-additive-exact-homotopy-category}
Let $\mathcal{A}$, $\mathcal{B}$ be additive categories.
Let $F : \mathcal{A} \to \mathcal{B}$ be an additive functor.
The induced functors
$$
F : K(\mathcal{A}) \longrightarrow K(\mathcal{B}),
\text{ and }
F : K^{+}(\mathcal{A}) \longrightarrow K^{+}(\mathcal{B})
$$
are exact functors of triangulated categories.
\end{lemma}

\begin{proof}
Suppose $A^\bullet \to B^\bullet \to C^\bullet$
is a termwise split sequence of complexes of $\mathcal{A}$ with splittings
$(s^n, \pi^n)$ and associated morphism $\delta : C^\bullet \to A^\bullet[1]$,
see Definition \ref{definition-split-ses}. Then
$F(A^\bullet) \to F(B^\bullet) \to F(C^\bullet)$
is a termwise split sequence of complexes with splittings
$(F(s^n), \pi^n)$ and associated morphism
$F(\delta) : F(C^\bullet) \to F(A^\bullet)[1]$.
Thus $F$ transforms distinguished triangles into distinguished triangles.
\end{proof}

\begin{lemma}
\label{lemma-composition-exact}
Let $\mathcal{D}, \mathcal{D}', \mathcal{D}''$ be triangulated categories.
Let $F : \mathcal{D} \to \mathcal{D}'$ and
$F' : \mathcal{D}' \to \mathcal{D}''$ be exact functors.
Then $F' \circ F$ is an exact functor.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}











\section{The canonical delta-functor}
\label{section-canonical-delta-functor}

\noindent
The derived category should be the receptacle for the universal
cohomology functor. Hence in particular a short exact sequence
in the abelian category $\mathcal{A}$ should lead to a triangle
in the derived category. In order to state the result we use
the notion of a $\delta$-functor from an abelian category
into a triangulated category, see
Definition \ref{definition-delta-functor}.

\begin{lemma}
\label{lemma-exact-compose-delta-functor}
Let $\mathcal{D}$ be a triangulated category.
Let $\mathcal{A}$ be an abelian category.
Let $G : \mathcal{A} \to \mathcal{D}$ be a $\delta$-functor.
\begin{enumerate}
\item Let $\mathcal{D}'$ be a triangulated category.
Let $F : \mathcal{D} \to \mathcal{D}'$ be an exact functor.
Then the composition $F \circ G$ is a $\delta$-functor as well.
\item Let $\mathcal{A}'$ be an abelian category. Hence
$H : \mathcal{A}' \to \mathcal{A}$ be an exact functor.
Hence $G \circ H$ is a $\delta$-functor as well.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
Let $\mathcal{A}$ be an abelian category with enough injectives.
Consider the functors
$$
\mathcal{A} \to \text{Comp}^{+}(\mathcal{A})
\to K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})
$$
where the final arrow is a localization functor.
The two categories $\mathcal{A}$,
$\text{Comp}^{+}(\mathcal{A})$ are abelian
(see Lemma \ref{lemma-cat-cochain-abelian}) and the functor
between them is exact. The last two are trianglulated and the
functor between them is exact (see Lemma \ref{lemma-j-is-exact}).

\medskip\noindent
Consider the functor
$\text{Comp}^{+}(\mathcal{A}) \to K^{+}(\mathcal{A})$.
This functor is not a $\delta$-functor in general.
The easiest way to see this is to consider a nonsplit
short exact sequence $0 \to A \to B \to C \to 0$
of objects of $\mathcal{A}$. Since
$\text{Hom}_{K^{+}(\mathcal{A})}(C[0], A[1]) = 0$
we see that any distinguished triangle arising from
this short exact sequence would look like
$(A[0], B[0], C[0], a, b, 0)$. But the existence of such a
distinguished triangle in $K^{+}(\mathcal{A})$ implies
that the extension is split (left as exercise). A contradiction.

\medskip\noindent
It turns out that the functor
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ is a
$\delta$-functor. In order to see this we have to define
the morphisms $\delta$ associated to a short exact sequence
$$
0 \to A^\bullet \xrightarrow{a} B^\bullet \xrightarrow{b} C^\bullet \to 0
$$
of bounded below complexes in the abelian category $\mathcal{A}$.
Consider the cone $C(a)^\bullet$ of the morphism $a$.
We have $C(a)^n = B^n \oplus A^{n + 1}$ and we define
$(\tilde b)^n : C(a)^n \to C^n$ via the projection to $B^n$ followed
by $b ^n$. Hence a morphism of complexes
$$
\tilde b : C(a)^\bullet \longrightarrow C^\bullet.
$$
It is clear that $\tilde b \circ i = b$ where $i$ is as in
Definition \ref{definition-cone}.
Note that the kernel of $\tilde b$ is identified with
the cone of $\text{id}_{A^\bullet}$ which is acyclic.
Hence we see that $\tilde b$ is a quasi-isomorphism.
According to Lemma \ref{lemma-the-same-up-to-isomorphisms} the triangle
$$
(A, B, C(a), a, i, -p)
$$
is a distinguished triangle in $K^{+}(\mathcal{A})$.
As $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ is
exact (see Lemma \ref{lemma-j-is-exact}) we see that
$(j(A), j(B), j(C(a)), j(a), j(i), -j(p))$ is a distinguished
triangle in $D^{+}(\mathcal{A})$. Since $\tilde b$ is a quasi-isomorphism
we see that $j(\tilde b)$ is an isomorphism in $D^{+}(\mathcal{A})$.
Hence we deduce that
$$
(j(A), j(B), j(C), j(a), j(b), -j(p) \circ j(\tilde b)^{-1})
$$
is a distinguished triangle of $D^{+}(\mathcal{A})$.
This suggests the following lemma.

\begin{lemma}
\label{lemma-canonical-delta-functor}
Let $\mathcal{A}$ be an abelian category.
Let $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ be
a localization functor. The functor
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
defined using $j$ has the natural structure of a $\delta$-functor, with
$$
\delta_{A^\bullet \to B^\bullet \to C^\bullet} = -j(p) \circ j(\tilde b)^{-1}
$$
as explained above.
\end{lemma}

\begin{proof}
We have already seen that this choice leads to a distinguished
triangle whenever given a short exact sequence of complexes.
We have to show that given a commutative diagram
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r]_a \ar[d]_f &
B^\bullet \ar[r]_b \ar[d]_g &
C^\bullet \ar[r] \ar[d]_h &
0 \\
0 \ar[r] &
(A')^\bullet \ar[r]^{a'} &
(B')^\bullet \ar[r]^{b'} &
(C')^\bullet \ar[r] &
0
}
$$
we get the desired commutative diagram of
Definition \ref{definition-delta-functor} (2).
By Lemma \ref{lemma-functorial-cone}
the pair $(f, g)$ induces a canonical morphism
$c : C(a)^\bullet \to C(a')^\bullet$. It is a simple computation
to show that $\tilde b' \circ c = h \circ \tilde b$ and
$f[1] \circ p = p' \circ c$. From this the result follows directly.
\end{proof}

\begin{lemma}
\label{lemma-compare-triangles-ses}
Let $\mathcal{A}$ be an abelian category.
Let $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ be
a localization functor.
Let
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
D^\bullet \ar[r] &
E^\bullet \ar[r] &
F^\bullet \ar[r] &
0
}
$$
be a commutative diagram of morphisms of complexes
such that the rows are short exact sequences of complexes, and
the vertical arrows are quasi-isomorphisms.
The $\delta$-functor of Lemma \ref{lemma-canonical-delta-functor} above
maps the to short exact sequences
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
and
$0 \to D^\bullet \to E^\bullet \to F^\bullet \to 0$
to isomorphic distinguished triangles.
\end{lemma}

\begin{proof}
Trivial from the fact that $j$ transforms quasi-isomorphisms
into isomorphisms and that the associated distinguished
triangles are functorial.
\end{proof}

\begin{lemma}
\label{lemma-compare-trianigles-split-case}
Let $\mathcal{A}$ be an abelian category.
Let $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ be
a localization functor.
Let
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] &
B^\bullet \ar[r] &
C^\bullet \ar[r] &
0
}
$$
be a short exact sequences of complexes. Assume this short exact sequence
is termwise split. Let
$(A^\bullet, B^\bullet, C^\bullet, \alpha, \beta, \delta)$
be the distinguished triangle of $K^{+}(\mathcal{A})$
associated to the sequence. The $\delta$-functor of
Lemma \ref{lemma-canonical-delta-functor} above
maps the short exact sequences
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
to the distinguished triangle
$$
(j(A^\bullet), j(B^\bullet), j(C^\bullet), j(\alpha), j(\beta), j(\delta)).
$$
\end{lemma}

\begin{proof}
First note that the statement makes sense because by
Lemma \ref{lemma-j-is-exact} the functor $j$ is exact.
Then the result follows from
Lemma \ref{lemma-the-same-up-to-isomorphisms}
which gives an isomorphism between the two triangles.
\end{proof}

\begin{lemma}
\label{lemma-ses-injective-ses}
Let $\mathcal{A}$ be an abelian category.
Let $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ be
a localization functor.
Let
$$
\xymatrix{
0 \ar[r] &
A^\bullet \ar[r] \ar[d] &
B^\bullet \ar[r] \ar[d] &
C^\bullet \ar[r] \ar[d] &
0 \\
0 \ar[r] &
I_1^\bullet \ar[r] &
I_2^\bullet \ar[r] &
I_3^\bullet \ar[r] &
0
}
$$
be a commutative diagram of morphisms of complexes
such that the rows are short exact sequences of complexes, and
the vertical arrows are injective resolutions
(see Lemma \ref{lemma-injective-resolution-ses}).
The $\delta$-functor of Lemma \ref{lemma-canonical-delta-functor} above
maps the short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
to the distinguished triangle of $D^{+}(\mathcal{A})$
associated to the short exact sequence
$0 \to I_1^\bullet \to I_2^\bullet \to I_3^\bullet \to 0$
(see Definition \ref{definition-derived-triangulated}).
\end{lemma}

\begin{proof}
Combine Lemmas \ref{lemma-compare-triangles-ses}
and \ref{lemma-compare-trianigles-split-case}.
\end{proof}







\section{Right derived functors}
\label{section-right-derived-functor}

\noindent
At this point we can use the material above to define the right derived
functors of a left exact functor between an abelian category having
enough injectives and a general abelian category.

\begin{definition}
\label{definition-right-derived-functor}
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$ be a left exact functor.
Assume $\mathcal{A}$ has enough injectives.
The {\it right derived functor $RF$} of $F$ is the functor
$$
RF : D^{+}(\mathcal{A}) \longrightarrow K^{+}(\mathcal{B})
$$
defined by $RF(I^\bullet) = F(I^\bullet)$ for any bounded
below complex of injectives.
Let $j : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ be
a localization functor. We also denote $RF$ any of the arrows
labeled $RF$ in the following commutative diagram
$$
\xymatrix{
\mathcal{A} \ar[r] \ar[rrrd]_{RF} &
\text{Comp}^{+}(\mathcal{A}) \ar[r] \ar[rrd]^{RF} &
K^{+}(\mathcal{A}) \ar[r]_j \ar[rd]^{RF} &
D^{+}(\mathcal{A}) \ar[d]^{RF} \\
& & & K^{+}(\mathcal{B})
}
$$
\end{definition}

\noindent
It is clear that we can use this definition even if $F$ is just additive
and $\mathcal{B}$ is just an additive category. However in this generality
the construction does not give the correct notion of a derived functor.
The following is a more important remark.

\begin{remark}
\label{remark-right-derived-functor}
If $\mathcal{B}$ has enough injectives as well and if
$j : K^{+}(\mathcal{B}) \to D^{+}(\mathcal{B})$ is a localization functor
for $\mathcal{B}$, then often the functors $j \circ RF$ are denoted
$RF$ and called the right derived functors of $F$ as well.
\end{remark}

\noindent
It actually often makes more sense to do this since many results about
derived functors are proved using spectral sequences, double complexes
and whatnot which often given quasi-isomorphisms between certain complexes
and hence naturally isomorphisms in the derived category but not in the
category $K^{+}(\mathcal{B})$.

\begin{lemma}
\label{lemma-right-derived-properties}
With assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
\begin{enumerate}
\item The functor $RF$ is an exact functor
$D^{+}(\mathcal{A}) \to K^{+}(\mathcal{B})$.
\item The functor $RF$ is an exact functor
$K^{+}(\mathcal{A}) \to K^{+}(\mathcal{B})$.
\item The functor $RF$ is a $\delta$-functor
$\text{Comp}^{+}(\mathcal{A}) \to K^{+}(\mathcal{B})$.
\item The functor $RF$ is a $\delta$-functor
$\mathcal{A} \to K^{+}(\mathcal{B})$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $\mathcal{I} \subset \mathcal{A}$ be the full subcategory of $\mathcal{A}$
consisting of injective objects. Recall that
$D^{+}(\mathcal{A}) = K^{+}(\mathcal{I})$ as a triangulated category.
Hence the first statement follows from
Lemma \ref{lemma-additive-exact-homotopy-category}, since
$RF = F$ on $D^{+}(\mathcal{A}) = K^{+}(\mathcal{I})$.
The second statement follows since
$j$ is exact (see Lemma \ref{lemma-j-is-exact}) and the compositions of exact
functors is exact (see Lemma \ref{lemma-composition-exact}).
The third statement follows since
$\text{Comp}^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ is a $\delta$-functor
(see Lemma \ref{lemma-canonical-delta-functor})
and Lemma \ref{lemma-exact-compose-delta-functor}.
Finally, the last assertion follows since
$\mathcal{A} \to \text{Comp}^{+}(\mathcal{A})$
transforms short exact sequences into short exact sequences.
\end{proof}

\begin{definition}
\label{definition-higher-derived-functors}
With assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
Let $i \in \mathbf{Z}$.
The {\it $i$th right derived functor $R^iF$ of $F$} is the functor
$H^i \circ RF$ with target $\mathcal{B}$ and source
any of the categories $\mathcal{A}$, $\text{Comp}^{+}(\mathcal{A})$,
$K^{+}(\mathcal{A})$ and $D^{+}(\mathcal{A})$.
\end{definition}

\begin{lemma}
\label{lemma-higher-derived-functors}
With assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
\begin{enumerate}
\item For any short exact sequence
$0 \to A^\bullet \to B^\bullet \to C^\bullet \to 0$
of complexes in $\text{Comp}^{+}(\mathcal{A})$ there
is an associated long exact sequence
$$
\ldots \to 
R^{i - 1}F(C^\bullet) \to
R^iF(A^\bullet) \to
R^iF(B^\bullet) \to
R^iF(C^\bullet) \to
R^{i + 1}F(A^\bullet) \to \ldots
$$
\item The functors $R^iF : \mathcal{A} \to \mathcal{B}$
are zero for $i < 0$. Also $R^0F = F : \mathcal{A} \to \mathcal{B}$.
\item We have $R^iF(I) = 0$ for $i > 0$ and $I$ injective.
\item The sequence $(R^iF, \delta)$ forms a universal $\delta$-functor
(see Definition \ref{definition-universal-delta-functor})
from $\mathcal{A}$ to $\mathcal{B}$.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{definition}
\label{definition-F-acyclic}
With assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
An object $A$ of $\mathcal{A}$ is called {\it $F$-acyclic}
if $R^iF(A) = 0$ for all $i > 0$.
\end{definition}

\begin{lemma}
\label{lemma-F-acyclic-ses}
With assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
Let $0 \to A \to B \to C \to 0$ be a short exact sequence
of $\mathcal{A}$.
\begin{enumerate}
\item If $A$ and $C$ are $F$-acyclic then so is $B$.
\item If $A$ and $B$ are $F$-acyclic then so is $C$.
\item If $B$ and $C$ are $F$-acyclic and $F(B) \to F(C)$ is surjective
then $A$ is $F$-acyclic.
\end{enumerate}
In each of the three cases
$$
0 \to F(A) \to F(B) \to F(C) \to 0
$$
is a short exact sequence of $\mathcal{B}$.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-leray-acyclicity}
(Leray's acyclicity lemma)
With assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
Let $A^\bullet$ be a bounded below complex of
$F$-acyclic objects. The canonical map
$$
F(A^\bullet) \longrightarrow RF(A^\bullet)
$$
is a quasi-isomorphism.
\end{lemma}

\begin{proof}
The canonical map comes by applying $F$ to the canonical map
$A^\bullet \to j(A^\bullet)$ of the localization functor.
Let $C^\bullet$ be the cone of $A^\bullet \to j(A^\bullet)$.
It is clear that $C^\bullet$ is a bounded below complex of
$F$-acyclic objects which is acyclic as a complex (i.e., quasi-isomorphic
to zero). Since $F(C^\bullet)$ is the cone of
$F(A^\bullet) \to RF(A^\bullet)$ we see there is a distinguished
triangle $(F(A^\bullet), RF(A^\bullet), F(C^\bullet), a, b, c)$
in $K^{+}(\mathcal{B})$. Hence it suffices to show that $F(C^\bullet)$
is an acyclic complex. In other words, it suffices to prove the lemma
in case $A^\bullet$ is a bounded below acyclic complex of $F$-acyclic objects.

\medskip\noindent
Suppose $A^\bullet$ looks like this
$$
0 \to A^n \to A^{n + 1} \to A^{n + 2} \to \ldots
$$
Set
$Z^m = \text{Im}(A^{m - 1} \to A^m) = \text{Ker}(A^m \to A^{m + 1})$.
Note that $Z^n = 0$ is $F$-acyclic. Then $A^n \cong Z^{n + 1}$
is $F$-acyclic. Then $0 \to Z^{n + 1} \to A^{n + 1} \to Z^{n + 2} \to 0$
is short exact. By Lemma \ref{lemma-F-acyclic-ses} we conclude that
$Z^{n + 2}$ is $F$-acyclic and 
$0 \to F(Z^{n + 1}) \to F(A^{n + 1}) \to F(Z^{n + 2}) \to 0$ is exact.
By induction on $m$ we see that $Z^m$ is $F$-acyclic for
all $m$ and each of the sequences
$$
0 \to F(Z^m) \to F(A^m) \to F(Z^{m + 1}) \to 0
$$
is short exact. Hence we see that $F(A^\bullet)$ is exact as desired.
\end{proof}

\begin{remark}
\label{remark-right-derived-exact-functor}
Assumptions and notations as in
Definition \ref{definition-right-derived-functor}.
Suppose that $F$ is actually an exact functor.
In this case, for any injective resolution $I^\bullet$ of any object $A$
we see that $F(I^\bullet)$ is exact in positive degrees.
Hence we see that any object $A$ is $F$-acyclic.
In other words the functors $R^pF$ are all zero.
Hence by Lemma \ref{lemma-leray-acyclicity} the
value of the derived functor $RF$ on $A^\bullet$ is
(canonically) quasi-isomorphic to $F(A^\bullet)$
for any bounded below complex $A^\bullet$ of $\mathcal{A}$.
In other words, the canonical transformation
$F \to RF$ as functors $K^{+}(\mathcal{A}) \to K^{+}(\mathcal{B})$
is a quasi-isomorphism on every object in this case.
If we postcompose with a localization functor of $\mathcal{B}$
then we see that this transformation becomes an isomorphism of functors.
\end{remark}





\section{Cartan-Eilenberg resolutions}
\label{section-cartan-eilenberg}

\begin{definition}
\label{definition-cartan-eilenberg}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a bounded below complex.
A {\it Cartan-Eilenberg resolution} of $K^\bullet$
is given by a double complex $I^{\bullet, \bullet}$
and a morphism of complexes $\epsilon : K^\bullet \to I^{\bullet, 0}$
with the following properties:
\begin{enumerate}
\item There exists a $i \ll 0$ such that $I^{p, q} = 0$ for all $p < i$
and all $q$.
\item We have $I^{p, q} = 0$ if $q < 0$.
\item The complex $I^{p, \bullet}$ is an injective resolution of $K^p$.
\item The complex $\text{Ker}(d_1^{p, \bullet})$ is an injective resolution
of $\text{Ker}(d_K^p)$.
\item The complex $\text{Im}(d_1^{p, \bullet})$ is an injective resolution
of $\text{Im}(d_K^p)$.
\item The complex $H^p_{I}(I^{\bullet, \bullet})$ is an injective resolution
of $H^p(K^\bullet)$.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-cartan-eilenberg}
Let $\mathcal{A}$ be an abelian category.
Let $K^\bullet$ be a bounded below complex.
There exists a Cartan-Eilenberg resolution of $K^\bullet$.
\end{lemma}

\begin{proof}
Suppose that $K^p = 0$ for $p < n$. Decompose $K^\bullet$ into
short exact sequences as follows: Set $Z^p = \text{Ker}(d^p)$,
$B^p = \text{Im}(d^{p - 1})$, $H^p = Z^p/B^p$, and consider
$$
\begin{matrix}
0 \to Z^n \to K^n \to B^{n + 1} \to 0 \\
0 \to B^{n + 1} \to Z^{n + 1} \to H^{n + 1} \to 0 \\
0 \to Z^{n + 1} \to K^{n + 1} \to B^{n + 2} \to 0 \\
0 \to B^{n + 2} \to Z^{n + 2} \to H^{n + 2} \to 0 \\
\ldots
\end{matrix}
$$
Set $I^{p, q} = 0$ for $p < n$. Inductively we choose
injective resolutions as follows:
\begin{enumerate}
\item Choose an injective resolution $Z^n \to J_Z^{n, \bullet}$.
\item Using Lemma \ref{lemma-injective-resolution-ses} choose injective
resolutions $K^n \to I^{n, \bullet}$, $B^{n + 1} \to J_B^{n + 1, \bullet}$,
and an exact sequence of complexes
$0 \to J_Z^{n, \bullet} \to I^{n, \bullet} \to J_B^{n + 1, \bullet} \to 0$
compatible with the short exact sequence
$0 \to Z^n \to K^n \to B^{n + 1} \to 0$.
\item Using Lemma \ref{lemma-injective-resolution-ses} choose injective
resolutions $Z^{n + 1} \to J_Z^{n + 1, \bullet}$,
$H^{n + 1} \to J_H^{n + 1, \bullet}$,
and an exact sequence of complexes
$0 \to J_B^{n + 1, \bullet} \to J_Z^{n + 1, \bullet}
\to J_H^{n + 1, \bullet} \to 0$
compatible with the short exact sequence
$0 \to B^{n + 1} \to Z^{n + 1} \to H^{n + 1} \to 0$.
\item Etc.
\end{enumerate}
Taking as maps $d_1^\bullet : I^{p, \bullet} \to I^{p + 1, \bullet}$
the compositions
$I^{p, \bullet} \to J_B^{p + 1, \bullet} \to
J_Z^{p + 1, \bullet} \to I^{p + 1, \bullet}$ everything is clear.
\end{proof}

\begin{lemma}
\label{lemma-two-ss-complex-functor}
Notations and assumptions as in
Definition \ref{definition-right-derived-functor}.
Let $K^\bullet$ be a bounded below complex of $\mathcal{A}$.
Let $I^{\bullet, \bullet}$ be a Cartan-Eilenberg resolution
for $K^\bullet$. The spectral sequences
$({}'E_r, {}'d_r)_{r \geq 0}$ and $({}''E_r, {}''d_r)_{r \geq 0}$
associated to the double complex $F(I^{\bullet, \bullet})$
satisfy the relations
$$
{}'E_2^{p, q} = H^p(R^qF(K^\bullet))\footnote{This notation sucks!
It really means the $p$th cohomology group of the complex with
terms $R^qF(K^n)$. Not the $p$th cohomology of the $q$th derived
functor of $F$ applied to $K^\bullet$...}
\quad
\text{and}
\quad
{}''E_2^{p, q} = R^pF(H^q(K^\bullet))
$$
Moreover, these spectral sequences converge to $R^{p + q}F(K^\bullet)$
and the associated induced filtrations on $R^{p + q}F(K^\bullet)$ are finite.
\end{lemma}

\begin{proof}
This is immediate from the definition of a Cartan-Eilenberg resolution
and Lemmas \ref{lemma-ss-double-complex} and \ref{lemma-first-quadrant-ss}.
\end{proof}

\begin{remark}
\label{remark-functorial-ss}
The spectral sequences of Lemma \ref{lemma-two-ss-complex-functor}
are functorial in the complex $K^\bullet$. This follows from functoriality
properties of Cartan-Eilenberg resolutions. On the other hand, they are
both examples of a more general spectral sequence which may be associated
to a filtered complex of $\mathcal{A}$. The functoriality will follow from
its construction. We will return to this in the section on the filtered
derived category, see Remark \ref{remark-final-functorial}.
\end{remark}





\section{Composition of right derived functors}
\label{section-composition-right-derived-functors}

\noindent
The statement of the following lemma is slightly clumsy (for the moment)
since we are not mapping into the derived category of $\mathcal{C}$.
If we compose with a localization functor into the derived category
of $\mathcal{C}$ (see Remark \ref{remark-right-derived-functor})
then $t$ becomes an isomorphism of functors.

\begin{lemma}
\label{lemma-compose-derived-functors}
Let $\mathcal{A}, \mathcal{B}, \mathcal{C}$ be abelian categories.
Let $F : \mathcal{A} \to \mathcal{B}$
and $G : \mathcal{B} \to \mathcal{C}$ be left exact functors.
Let $j_{\mathcal{A}} : K^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$ and
$j_{\mathcal{B}} : K^{+}(\mathcal{B}) \to D^{+}(\mathcal{B})$ be
localization functors. If $F(I)$ is $G$-acyclic for each injective object $I$
of $\mathcal{A}$, then we have a transformation of functors
$$
t : R(G \circ F) \longrightarrow RG \circ RF
$$
which is an quasi-isomorphism for every complex.
\end{lemma}

\begin{proof}
Let $A^\bullet$ be a bounded below complex of $\mathcal{A}$.
The map $t$ is just the canonical map
$$
G(F(j_{\mathcal{A}}(A^\bullet)))
\longrightarrow
G(j_{\mathcal{B}}(F(j_{\mathcal{A}}(A^\bullet)))).
$$
Under the hypotheses of the lemma we may apply
Leray's acyclicty lemma (Lemma \ref{lemma-leray-acyclicity})
to see that this is a quasi-isomorphism.
\end{proof}

\begin{lemma}
\label{lemma-grothendieck-spectral-sequence}
(Grothendieck spectral sequence.)
With assumptions as in Lemma \ref{lemma-compose-derived-functors}.
Let $A$ be an object of $\mathcal{A}$.
There exists a spectral sequence $(E_r^{p, q}, d_r^{p, q})_{r \geq 0}$
associated to a filtered complex with
$$
E_2^{p, q} = R^pG(R^qF(A))
$$
converging to $R^{p + q}(G \circ F)(A)$. Moreover, the induced filtration
on each $R^n(G \circ F)(A)$ is finite.
\end{lemma}

\begin{proof}
Choose an injective resolution $A \to I^\bullet$.
Choose a Cartan-Eilenberg resolution
$F(I^\bullet) \to I^{\bullet, \bullet}$
using Lemma \ref{lemma-cartan-eilenberg}.
Apply Lemma \ref{lemma-two-ss-complex-functor}
(use the second spectral sequence).
Details omitted.
\end{proof}











\section{The filtered derived category}
\label{section-filtered-derived}

\noindent
A reference for this section is \cite[I, Chapter V]{cotangent}.
The goal is to understand the derived category $DF^{+}(\mathcal{A})$
of bounded below complexes of finitely filtered objects.
We are less general than the discussion in Illusie in that we
assume the abelian category $\mathcal{A}$ to have enough injectives.
We will slightly generalize Illusie's discussion by allowing our
filtered complexes to have infinitely many nonzero $\text{gr}^p(K^\bullet)$
(but retaining the requirement that each term has a finite filtration).
The rational for this generalization is that it is not essentially
harder and it allows us to apply the discussion to the spectral sequences of
Lemma \ref{lemma-two-ss-complex-functor}, see also
Remark \ref{remark-functorial-ss}.

\medskip\noindent
Note that some of this discussion can more generally be done in any
``exact category'' with enough injectives. Compare \cite{Buhler}, \cite{Keller}.

\begin{definition}
\label{definition-filtered-complexes-notation}
Let $\mathcal{A}$ be an abelian category.
\begin{enumerate}
\item Let $\alpha : K^\bullet \to L^\bullet$ be a morphism of
complexes of $\text{Fil}(\mathcal{A})$. We say that
$\alpha$ is a {\it filtered quasi-isomorphism} if
for each $p \in \mathbf{Z}$ the morphism
$\text{gr}^p(K^\bullet) \to \text{gr}^p(L^\bullet)$ is
a quasi-isomorphism.
\item We denote $\text{Fil}^f(\mathcal{A})$ the full subcategory
of $\text{Fil}(\mathcal{A})$ whose objects consist of
those $A \in \text{Ob}(\text{Fil}(\mathcal{A}))$
whose filtration is finite (see Definition \ref{definition-filtered}).
\item We say an object $I$ of $\text{Fil}^f(\mathcal{A})$
is {\it filtered injective} if each $\text{gr}^p(I)$ is
an injective object of $\mathcal{A}$.
\item Let $K^\bullet$ be a complex of $\text{Fil}^f(\mathcal{A})$.
We say that $K^\bullet$ is {\it filtered acyclic} if
for each $p \in \mathbf{Z}$ the complex $\text{gr}^p(K^\bullet)$ is
acyclic.
\item We denote $\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$ the
{\it category of bounded below complexes of finite filtered objects}
whose objects are bounded below complexes
$K^\bullet$ of $\text{Fil}^f(\mathcal{A})$.
\item We let $KF^{+}(\mathcal{A})$ be the category with the same objects
as $\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$
but as morphisms homotopy classes of
maps of complexes (see Lemma \ref{lemma-compose-homotopy-cochain}).
This is a triangulated category, see
Proposition \ref{proposition-homotopy-category-triangulated}.
\item Assume $\mathcal{A}$ has enough injectives.
By analogy with Definition \ref{definition-derived-category}
the {\it filtered derived category (bounded below version)} of $\mathcal{A}$
is the category $DF^{+}(\mathcal{A})$ whose
\begin{enumerate}
\item objects are bounded below complexes of filtered injective objects
of $\text{Fil}^f(\mathcal{A})$, and
\item morphisms are morphisms of complexes of $\text{Fil}^f(\mathcal{A})$
up to homotopy.
\end{enumerate}
This is a triangulated category, because the category of filtered
injective objects of $\text{Fil}^f(\mathcal{A})$ is additive.
In other words, using
Proposition \ref{proposition-homotopy-category-triangulated}
once again.
\end{enumerate}
\end{definition}

\noindent
Hence there are functors $\text{gr}^p$ fitting
into a commutative diagram
$$
\xymatrix{
\text{Fil}^f(\mathcal{A}) \ar[r] \ar[d]_{\text{gr}^p} &
\text{Comp}^{+}(\text{Fil}^f(\mathcal{A})) \ar[r] \ar[d]_{\text{gr}^p} &
KF^{+}(\mathcal{A}) \ar[d]_{\text{gr}^p} &
DF^{+}(\mathcal{A}) \ar[d]_{\text{gr}^p} \\
\mathcal{A} \ar[r] &
\text{Comp}^{+}(\mathcal{A}) \ar[r] &
K^{+}(\mathcal{A}) &
D^{+}(\mathcal{A})
}
$$
There is a similar diagram corresponding to the forgetful
functor $\text{Fil}^f(\mathcal{A}) \to \mathcal{A}$.
Note that the functors $KF^{+}(\mathcal{A}) \to K^{+}(\mathcal{A})$
and $DF^{+}(\mathcal{A}) \to D^{+}(\mathcal{A})$
are exact functors of triangulated categories,
see Lemma \ref{lemma-additive-exact-homotopy-category}.
We will fill in the ``missing'' horizontal arrows in a moment.

\medskip\noindent
In Exercises, Section \ref{exercises-section-filtered-derived}
we provide the correct statements regarding the uniqueness and
existence of injective resolutions in the filtered sense.
Briefly, assume the abelian category $\mathcal{A}$ has enough injectives.
An {\it filtered injective resolution} of an object $K^\bullet$
of $\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$
is given by a filtered quasi-isomorphism
$$
K^\bullet \longrightarrow I^\bullet
$$
into an object $I^\bullet$ of $\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$
all of whose terms are filtered injective. The first result is that such
an injective resolution always exists.
See Exercise \ref{exercises-exercise-injective-resolution-complex}.
The second result is that given a solid diagram
$$
\xymatrix{
K^\bullet \ar[r]_\alpha \ar[d]_\gamma & L^\bullet \ar@{-->}[dl]^\beta \\
I^\bullet
}
$$
of complexes of $\text{Fil}^f(\mathcal{A})$, with $K^\bullet$, $L^\bullet$
and $I^\bullet$ are bounded below, each $I^n$ a filtered injective object,
and $\alpha$ a filtered quasi-isomorphism there is a dotted arrow, then there
exists a dotted arrow making the diagram commute up to homotopy.
See Exercise \ref{exercises-exercise-morphisms-lift}.
And finally the third result is that any two dotted arrows in the diagram
above making the diagram commute up to homotopy differ by a homotopy.
See Exercise \ref{exercises-exercise-morphisms-equal-up-to-homotopy}.
This in particular implies that given
$K^\bullet, I^\bullet \in \text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$,
$K^\bullet$ filtered acyclic, $I^\bullet$ consisting of injectives,
then $\text{Hom}_{KF^{+}(\mathcal{A})}(K^\bullet, I^\bullet) = 0$.

\begin{lemma}
\label{lemma-filtered-localization-functor}
Let $\mathcal{A}$ be an abelian category.
Assume $\mathcal{A}$ has enough injectives.
There exists a {\it localization functor}
$$
j : KF^{+}(\mathcal{A}) \longrightarrow DF^{+}(\mathcal{A})
$$
together with for each $K^\bullet \in \text{Ob}(KF^{+}(\mathcal{A}))$
a morphism $i_K : K^\bullet \to j(K^\bullet)$ with the following properties.
\begin{enumerate}
\item For every $K^\bullet \in \text{Ob}(KF^{+}(\mathcal{A}))$ the morphism
$i_K : K^\bullet \to j(K^\bullet)$
is a filtered quasi-isomorphism.
\item For every morphism $\alpha : K^\bullet \to L^\bullet$ of
$KF^{+}(\mathcal{A})$ we have $j(\alpha) \circ i_K = i_L \circ \alpha$.
\item Given a morphism of complexes $\alpha : K^\bullet \to L^\bullet$
then $j(\alpha)$ is invertible if and only if $\alpha$ is a
filtered quasi-isomorphism.
\item For any $K^\bullet$ we have $j(K^\bullet) \cong 0$ if and only
if $K^\bullet$ is filtered acyclic.
\end{enumerate}
Furthermore, $j$ is an exact functor of triangulated categories,
and the diagrams
$$
\xymatrix{
KF^{+}(\mathcal{A}) \ar[d]_{\text{gr}^p} \ar[r]_j &
DF^{+}(\mathcal{A}) \ar[d]_{\text{gr}^p} \\
K^{+}(\mathcal{A}) \ar[r]^j &
D^{+}(\mathcal{A})
}
\quad
\xymatrix{
KF^{+}(\mathcal{A}) \ar[d]^{\text{forget }F} \ar[r]_j &
DF^{+}(\mathcal{A}) \ar[d]^{\text{forget }F} \\
K^{+}(\mathcal{A}) \ar[r]^j &
D^{+}(\mathcal{A})
}
$$
are commutative up to a canonical isomorphisms of functors.
\end{lemma}

\begin{proof}
Omitted. Hint: Argue exactly as in the proof of
Lemma \ref{lemma-into-derived-category}
using the results discussed above the lemma.
For the last statement argue as in the proof of
Lemma \ref{lemma-canonical-delta-functor}.
\end{proof}

\begin{remark}
\label{remark-filtered-localization-big}
We claim this result only if $\mathcal{A}$ is a category in our sense,
namely if it has a set of objects. However, suppose given a big abelian
category $\mathcal{A}$ with enough injectives, such as
$\text{Mod}(\mathcal{O}_X)$ for example. Then for any given set of objects
$\{A_i\}_{i\in I}$ there is an abelian subcategory
$\mathcal{A}' \subset \mathcal{A}$ containing all of them
and having enough injectives, see
Sets, Lemma \ref{sets-lemma-abelian-injectives}.
Thus we may use the lemma above for $\mathcal{A}'$.
This essentially means that if we use a set worth of diagrams, etc 
then we will never run into trouble using the lemma.
\end{remark}

\noindent
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $T : \mathcal{A} \to \mathcal{B}$ be a left exact functor.
(We cannot use the letter $F$ for the functor since this would
conflict too much with our use of the letter $F$ to indicate
filtrations.)
Assume $\mathcal{A}$ has enough injectives.
At this point we can redo the discussion of 
Section \ref{section-right-derived-functor} to define the
{\it right filtered derived functors}
\begin{equation}
\label{equation-filtered-derived-functor}
RT : DF^{+}(\mathcal{A}) \longrightarrow KF^{+}(\mathcal{B})
\end{equation}
of our functor $T$. Namely, given a bounded below complex $I^\bullet$
consisting of filtered injective objects we set
$RT(I^\bullet) = T(I^\bullet)$ as a complex, with filtration
$F^p(RT(I^\bullet)) := T(F^p(I^\bullet))$. Note that by
Exercise \ref{exercises-exercise-split-injective} every term
\begin{equation}
\label{equation-decompose}
I^n \cong \bigoplus\nolimits_{p \in \mathbf{Z}} \text{gr}^p(I^n)
\end{equation}
compatible with filtrations. Hence it is clear that
$\text{gr}^p(T(I^\bullet)) = T(\text{gr}^p(I^\bullet))$.
This implies that
\begin{equation}
\label{equation-commute-gr}
\text{gr}^p \circ RT \cong RT \circ \text{gr}^p
\end{equation}
and
\begin{equation}
\label{equation-commute-forget}
(\text{forget }F) \circ RT \cong RT \circ (\text{forget }F)
\end{equation}
as functors $DF^{+}(\mathcal{A}) \to K^{+}(\mathcal{B})$.
Here the functor $RT$ on the left hand side is the one from
Definition \ref{definition-right-derived-functor}.
As in Remark \ref{remark-right-derived-functor} we point out that it
is customary (and useful) to think of the filtered derived functor
as a functor $DF^{+}(\mathcal{A}) \to DF^{+}(\mathcal{B})$
by postcomposing by a localization functor
$j : KF^{+}(\mathcal{B}) \to DF^{+}(\mathcal{B})$ as in
Lemma \ref{lemma-filtered-localization-functor}
in those cases where $\mathcal{B}$ has enough injectives.

\medskip\noindent
Precomposing with a localization functor $j$ for $\mathcal{A}$
we also get derived functors
$$
RT : \text{Fil}^f(\mathcal{A}) \to KF^{+}(\mathcal{B}),
\quad
RT : \text{Comp}^{+}(\text{Fil}^f(\mathcal{A})) \to KF^{+}(\mathcal{B}),
$$
and finally
$$
RT : KF^{+}(\mathcal{A}) \to KF^{+}(\mathcal{B}).
$$
Note that since $\text{Fil}^f(\mathcal{A})$, and
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$ are no longer
abelian it does not make sense to say that $RT$ restricts to
a $\delta$-functor on them. (As mentioned before this can be
repaired by thinking of these categories as exact categories and
formulating the notion of a $\delta$-functor from an exact category
into a triangulated category.)
But it does make sense, and it is true
by construction, that $RT$ is an exact functor of triangulated
categories on the categories $DF^{+}(\mathcal{A})$ and
$KF^{+}(\mathcal{A})$.

\medskip\noindent
Actually, this is somewhat besides the point since we are going
to use the filtered derived functor mainly to prove things about
the actual right derived functors of $T$. In fact, mainly we will
use the following lemma.

\begin{lemma}
\label{lemma-ss-filtered-derived}
Let $\mathcal{A}, \mathcal{B}$ be abelian categories.
Let $T : \mathcal{A} \to \mathcal{B}$ be a left exact functor.
Assume $\mathcal{A}$ has enough injectives.
Let $(K^\bullet, F)$ be an object of
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$.
There exists a spectral sequence $(E_r^{p, q}, d_r)_{r\geq 0}$
which is the spectral sequence
associated to an object of
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{B}))$
with
$$
E_1^{p, q} = R^{p + q}T(\text{gr}^p(K^\bullet))
$$
which converges to $R^{p + q}T(K^\bullet)$ inducing a finite
filtration on each $R^nT(K^\bullet)$. Moreover the construction
of this spectral sequence is functorial in the object
$K^\bullet$ of $\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$.
In fact the terms $(E_r, d_r)$ for $r \geq 2$ do not depend
on any choices.
\end{lemma}

\begin{proof}
Instead of quoting the abstract constructions above we
show how the existence of filtered injective resolutions gives
rise to this spectral sequence.
Choose a filtered injective resolution $K^\bullet \to I^\bullet$.
Consider the complex $RT(K^\bullet) = T(I^\bullet)$, filtered as
in the definition of $RT$, see
Equation (\ref{equation-filtered-derived-functor}).
Thus we can consider the spectral sequence
$(E_r, d_r)_{r \geq 0}$ associated to
this as a filtered complex in $\mathcal{B}$, see
Section \ref{section-filtered-complex}.
By Lemma \ref{lemma-spectral-sequence-filtered-complex}
we have $E_1^{p, q} = H^{p + q}(\text{gr}^p(T(I^\bullet)))$.
By Equation (\ref{equation-decompose}) we have
$E_1^{p, q} = H^{p + q}(T(\text{gr}^p(I^\bullet)))$, and
by definition of a filtered injective resolution the
map $\text{gr}^p(K^\bullet) \to \text{gr}^p(I^\bullet)$
is an injective resolution. Hence
$E_1^{p, q} = R^{p + q}T(\text{gr}^p(K^\bullet))$.

\medskip\noindent
On the other hand, each $I^n$ has a finite filtration and hence
each $T(I^n)$ has a finite filtration. Thus we may apply
Lemma \ref{lemma-biregular-ss-converges} to conclude that the
spectral sequence converges to $H^n(T(I^\bullet)) = R^nT(K^\bullet)$
moreover inducing finite filtrations on each of the terms.

\medskip\noindent
Suppose that $K^\bullet \to L^\bullet$ is a morphism of
$\text{Comp}^{+}(\text{Fil}^f(\mathcal{A}))$. By our results above,
for example Lemma \ref{lemma-filtered-localization-functor}, there
exists a commutative diagram
$$
\xymatrix{
K^\bullet \ar[r] \ar[d] & L^\bullet \ar[d] \\
I^\bullet \ar[r] & J^\bullet
}
$$
where the vertical arrows are filtered injective resolutions.
Hence we get a morphism of filtered complexes
$T(I^\bullet) \to T(J^\bullet)$ which gives rise to the
morphism of spectral sequences, see
Lemma \ref{lemma-spectral-sequence-filtered-complex-functorial}.
The last statement follows from this easily.
\end{proof}

\begin{remark}
\label{remark-final-functorial}
As promised in Remark \ref{remark-functorial-ss} we discuss the
connection of the lemma
above with the constructions using Cartan-Eilenberg resolutions.
Namely, assume the notations of Lemma \ref{lemma-two-ss-complex-functor}.
In particular $K^\bullet$ is a bounded below complex of
$\mathcal{A}$ and $T : \mathcal{A} \to \mathcal{B}$ is a
left exact functor. We give an alternative construction of the
spectral sequences ${}'E$ and ${}''E$ 

\medskip\noindent
First spectral sequence. Consider the ``stupid'' filtration
on $K^\bullet$
obtained by setting $F^p(K^\bullet) = \sigma_{\geq p}(K^\bullet)$,
see Section \ref{section-truncations}.
Note that this stupid in the sense that
$d(F^p(K^\bullet)) \subset F^{p + 1}(K^\bullet)$, compare
Lemma \ref{lemma-spectral-sequence-filtered-complex-d1}.
Note that $\text{gr}^p(K^\bullet) = K^p[p]$ with this filtration.
According to the above there is a spectral sequence
with $E_1$ term $E_1^{p, q} = R^{p + q}T(K^p[p])$.
Then the $E_2$ term is clearly $E_2^{p, q} = H^p(R^{p + q}T(K^\bullet))$
as in the spectral sequence ${}'E_r$.

\medskip\noindent
Second spectral sequence. Consider the filtration on the complex $K^\bullet$
obtained by setting $F^p(K^\bullet) = \tau_{\leq -p}(K^\bullet)$,
see Section \ref{section-truncations}. The minus sign is necessary
to get a decreasing filtration. Note that
$\text{gr}^p(K^\bullet)$ is quasi-isomorphic to $H^{-p}(K^\bullet)[-p]$
with this filtration. According to the above there is a spectral sequence
with $E_1$ term
$$
E_1^{p, q}
= R^{p + q}T(H^{-p}(K^\bullet)[-p])
= R^{2p + q}T(H^{-p}(K^\bullet)) = {}''E_2^{i, j}
$$
with $i = 2p + q$ and $j = -p$. (This looks unnatural, but note that we
could just have well developped the whole theory of filtered complexes
using increasing filtrations, with the end result that this then looks
natural, but the other one doesn't.) We leave it to the reader to see
that the differentials match up.

\medskip\noindent
Actually, given a Cartan-Eilenberg resolution
$K^\bullet \to I^{\bullet, \bullet}$ the induced morphism
$K^\bullet \to sI^\bullet$ into the associated simple complex
will be a filtered injective resolution for either filtration
using suitable filtrations on $sI^\bullet$. This can be used
to match up the spectral sequences exactly.
\end{remark}






















\section{Injectives and adjoint functors}
\label{section-adjoint}

\noindent
Here are some lemmas on adjoint functors and their relationship with
injectives. See also Lemma \ref{lemma-adjoint-get-abelian}.

\begin{lemma}
\label{lemma-adjoint-preserve-injectives}
Let $\mathcal{A}$ and $\mathcal{B}$ be abelian categories.
Let $u : \mathcal{A} \to \mathcal{B}$ and
$v : \mathcal{B} \to \mathcal{A}$ be additive functors.
\begin{enumerate}
\item $u$ is right adjoint to $v$, and
\item $v$ transforms injective maps into injective maps.
\end{enumerate}
Then $u$ transforms injectives into injectives.
\end{lemma}

\begin{proof}
Let $I$ be an injective object of $\mathcal{A}$.
Let $\varphi : N \to M$ be an injective map in $\mathcal{B}$ and let
$\alpha : N \to uI$ be a morphism.
By adjointness we get a morphism $\alpha : vN \to I$ and
by assumption $v\varphi : vN \to vM$ is injective.
Hence as $I$ is an injective object we get a morphism
$\beta : vM \to I$ extending $\alpha$. By adjointness
again this corresponds to a morphism $\beta : M \to uI$ as
desired.
\end{proof}

\begin{remark}
\label{remark-need-left-exactness}
Let $\mathcal{A}$, $\mathcal{B}$, $u : \mathcal{A} \to \mathcal{B}$ and
$v : \mathcal{B} \to \mathcal{A}$ be as in
Lemma \ref{lemma-adjoint-preserve-injectives}.
In the presence of assumption (1) assumption (2) is equivalent to requiring
that $v$ is exact. Moreover, condition (2) is necessary. Here is an example.
Let $A \to B$ be a ring map.
Let $u : \text{Mod}_B \to \text{Mod}_A$ be $u(N) = N_A$
and let $v : \text{Mod}_A \to \text{Mod}_B$ be
$v(M) = M \otimes_A B$. Then $u$ is right adjoint to $v$, and $u$ is
exact and $v$ is right exact, but $v$ does not transform injective maps into
injective maps in general (i.e., $v$ is not left exact).
Moreover, it is {\bf not} the case that $u$ transforms injective
$B$-modules into injective $A$-modules. For example, if
$A = \mathbf{Z}$ and $B = \mathbf{Z}/p\mathbf{Z}$, then
the injective $B$-module $\mathbf{Z}/p\mathbf{Z}$ is not
an injective $\mathbf{Z}$-module. In fact, the lemma applies to this
example if and only if the ring map $A \to B$ is flat.
\end{remark}

\begin{lemma}
\label{lemma-adjoint-enough-injectives}
Let $\mathcal{A}$ and $\mathcal{B}$ be abelian categories.
Let $u : \mathcal{A} \to \mathcal{B}$ and
$v : \mathcal{B} \to \mathcal{A}$ be additive functors.
Assume
\begin{enumerate}
\item $u$ is right adjoint to $v$,
\item $v$ transforms injective maps into injective maps,
\item $\mathcal{A}$ has enough injectives, and
\item $vB = 0$ implies $B = 0$ for any $B \in \text{Ob}(\mathcal{B})$.
\end{enumerate}
Then $\mathcal{B}$ has enough injectives.
\end{lemma}

\begin{proof}
Pick $B \in \text{Ob}(\mathcal{B})$.
Pick an injection $vB \to I$ for $I$
an injective object of $\mathcal{A}$.
According to Lemma \ref{lemma-adjoint-preserve-injectives}
and the assumptions the corresponding map
$B \to uI$ is the injection of $B$ into an injective object.
\end{proof}

\begin{remark}
\label{remark-faithfulness-needed}
Let $\mathcal{A}$, $\mathcal{B}$, $u : \mathcal{A} \to \mathcal{B}$ and
$v : \mathcal{B} \to \mathcal{A}$ be as
In Lemma \ref{lemma-adjoint-enough-injectives}.
In the presence of conditions (1) and (2) condition (4) is equivalent
to $v$ being faithful. Moreover, condition (4) is needed.
An example is to consider the
case where the functors $u$ and $v$ are both the zero functor.
\end{remark}

\begin{lemma}
\label{lemma-adjoint-functorial-injectives}
Let $\mathcal{A}$ and $\mathcal{B}$ be abelian categories.
Let $u : \mathcal{A} \to \mathcal{B}$ and
$v : \mathcal{B} \to \mathcal{A}$ be additive functors.
Assume
\begin{enumerate}
\item $u$ is right adjoint to $v$,
\item $v$ transforms injective maps into injective maps,
\item $\mathcal{A}$ has enough injectives,
\item $vB = 0$ implies $B = 0$ for any $B \in \text{Ob}(\mathcal{B})$, and
\item $\mathcal{A}$ has functorial injective hulls.
\end{enumerate}
Then $\mathcal{B}$ has functorial injective hulls.
\end{lemma}

\begin{proof}
Let $A \mapsto (A \to J(A))$ be a functorial
injective hull on $\mathcal{A}$. Then
$B \mapsto (B \to uJ(vB))$ is a functorial
injective hull on $\mathcal{B}$. Compare with the
proof of Lemma \ref{lemma-adjoint-enough-injectives}.
\end{proof}











\section{Inverse systems}
\label{section-inverse-systems}

\noindent
Let $\mathcal{C}$ be a category.
In Categories, Section \ref{categories-section-posets-limits}
we defined the notion of an inverse system over a partially ordered set
(with values in the category $\mathcal{C}$).
If the partially ordered set is $\mathbf{N} = \{1, 2, 3, \ldots\}$
with the usual ordering such an inverse system over $\mathbf{N}$
is often simply called an {\it inverse system}. It consists quite simply
of a pair $(M_i, f_{ii'})$ where each $M_i$, $i \in \mathbf{N}$
is an object of $\mathcal{C}$, and for each $i > i'$, $i, i' \in \mathbf{N}$
a morphism $f_{ii'} : M_i \to M_{i'}$ such that moreover
$f_{i'i''} \circ f_{ii'} = f_{ii''}$ whenever this makes sense.
It is clear that in fact it suffices to give the morphisms
$M_2 \to M_1$, $M_3 \to M_2$, and so on. Hence an inverse system
is frequently pictured as follows
$$
M_1 \xleftarrow{\varphi_2} M_2 \xleftarrow{\varphi_3} M_3 \leftarrow \ldots
$$
Moreover, we often omit the transition maps $\varphi_i$ from the notation
and we simply say ``let $(M_i)$ be an inverse system''.

\medskip\noindent
The collection of all inverse systems with values in
$\mathcal{C}$ forms a category with the obvious notion of morphism.

\begin{lemma}
\label{lemma-inverse-systems-abelian}
Let $\mathcal{C}$ be a category.
\begin{enumerate}
\item If $\mathcal{C}$ is an additive category, then the category
of inverse systems with values in $\mathcal{C}$ is an additive cateogry.
\item If $\mathcal{C}$ is an abelian category, then the category
of inverse systems with values in $\mathcal{C}$ is an abelian cateogry.
A sequence $(K_i) \to (L_i) \to (M_i)$ of inverse systems
is exact if and only if each $K_i \to L_i \to N_i$ is exact.
\end{enumerate}
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\noindent
The limit (see Categories, Section \ref{categories-section-posets-limits})
of such an inverse system is denoted $\text{lim}\ M_i$, or $\text{lim}_i\ M_i$.
If $\mathcal{C}$ is the category of abelian groups (or sets), then the limit
always exists and in fact can be described as follows
$$
\text{lim}_i\ M_i
=
\{(x_i) \in \prod M_i \mid \varphi_i(x_i) = x_{i - 1},\ i = 2, 3, \ldots\}
$$
see Categories, Section \ref{categories-section-limit-sets}.
However, given a short exact sequence
$$
0 \to (A_i) \to (B_i) \to (C_i) \to 0
$$
of inverse systems of abelian groups it is not always the case
that the associated system of limits is exact. In order to discuss
this further we introduce the following notion.

\begin{definition}
\label{definition-Mittag-Leffler}
Let $\mathcal{C}$ be an abelian category.
We say the inverse system $(A_i)$
satisfies the {\it Mittag-Leffler condition}, or for short
is {\it ML}, if for every $i$ there exists a $c = c(i) \geq i$
such that
$$
\text{Im}(A_k \to A_i) = \text{Im}(A_c \to A_i)
$$
for all $k \geq c$.
\end{definition}

\noindent
It turns out that the Mittag-Leffler condition is good enough to ensure
that the $\text{lim}$-functor is exact, provided one works within
the abelian category of abelian groups, or abelian sheaves, etc.
It is shown in a paper by A.\ Neeman (see \cite{Neeman-Counterexample})
that this condition is not strong enough in a general abelian
category (where limits of inverse systems exist).

\begin{lemma}
\label{lemma-Mittag-Leffler}
Let
$$
0 \to (A_i) \to (B_i) \to (C_i) \to 0
$$
be a short exact sequence of inverse systems of abelian groups.
\begin{enumerate}
\item In any case the sequence
$$
0 \to \text{lim}_i\ A_i \to \text{lim}_i\ B_i \to \text{lim}_i\ C_i
$$
is exact.
\item If $(B_i)$ is ML, then also $(C_i)$ is ML.
\item If $(A_i)$ is ML, then
$$
0 \to \text{lim}_i\ A_i \to \text{lim}_i\ B_i \to \text{lim}_i\ C_i \to 0
$$
is exact.
\end{enumerate}
\end{lemma}

\begin{proof}
Nice exercise. See
Algebra, Lemma \ref{algebra-lemma-Mittag-Leffler} for part (3).
\end{proof}





\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
