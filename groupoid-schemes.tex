\input{preamble}

% OK, start here.
%
\begin{document}

\title{Groupoid schemes}


\maketitle

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
This chapter is devoted to generalities concering groupoid schemes.
See for example the beautiful paper \cite{K-M} by Keel and Mori.








\section{Equivalence relations}
\label{section-equivalence-relations}

\noindent
Given a(n equivalence) relation $R$ on a set $A$ we denote
$A/R$ the set of equivalence classes.

\begin{definition}
\label{definition-equivalence-relation}
Let $S$ be a scheme. Let $U$ be a scheme over $S$.
\begin{enumerate}
\item A {\it relation} on $U$ over $S$ is any morphism
of schemes $j : R \to U \times_S U$. In this case we set
$t = \text{pr}_0 \circ j$ and $s = \text{pr}_1 \circ j$.
\item A {\it pre-equivalence relation} is a relation
$j : R \to U\times_SU$ such that the image of
$j(T) : R(T) \to U(T) \times U(T)$ is an equivalence relation for
all $T/S$.
\item We say a morphism $R \to U \times_S U$ is
an {\it equivalence relation on $U$ over $S$}
if and only if for every $T/S$ the $T$-valued
points of $R$ define an equivalence relation
on the set of $T$-valued points of $U$.
(So it is a pre-equivalence relation such that $j(T)$
is injective for all $T$.)
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-pre-equivalence-equivalence-relation-points}
Let $j : R \to U\times_S U$ be a relation.
Consider the relation on points of the scheme $U$ defined by
the rule
$$
x \sim y
\Leftrightarrow
\exists\ r \in R :
t(r) = x,
s(r) = y.
$$
If $j$ is a pre-equivalence relation then this is an
equivalence relation.
\end{lemma}

\begin{proof}
Suppose that $x \sim y$ and $y \sim z$.
Pick $r \in R$ with $t(r) = x$, $s(r) = y$ and
pick $r' \in R$ with $t(r') = y$, $s(r') = z$.
Pick a field $K$ fitting into the following commutative
diagram
$$
\xymatrix{
\kappa(r) \ar[r] & K \\
\kappa(y) \ar[u] \ar[r] & \kappa(r') \ar[u]
}
$$
Denote $x_K, y_K, z_K : \text{Spec}(K) \to U$
the morphisms
$$
\begin{matrix}
\text{Spec}(K) \to \text{Spec}(\kappa(r))
\to 
\text{Spec}(\kappa(x)) \to U \\
\text{Spec}(K) \to \text{Spec}(\kappa(r))
\to
\text{Spec}(\kappa(y)) \to U \\
\text{Spec}(K) \to \text{Spec}(\kappa(r'))
\to
\text{Spec}(\kappa(z)) \to U
\end{matrix}
$$
By construction $(x_K, y_K) \in j(R(K))$ and
$(y_K, z_K) \in j(R(K))$. Since $j$ is a pre-equivalence relation
we see that also $(x_K, z_K) \in j(R(K))$.
This clearly implies that $x \sim z$.

\medskip\noindent
The proof that $\sim$ is reflexive and symmetric is omitted.
\end{proof}











\section{Groupoids}
\label{section-groupoids}

\noindent
Recall that a groupoid is a category in which every morphism
is an isomorphism, see
Categories, Definition \ref{categories-definition-groupoid}.
Hence a groupoid has a set of objects $\text{Ob}$,
a set of arrows $\text{Arrows}$, a {\it source} and {\it target}
map $s, t : \text{Arrows} \to \text{Ob}$,
an {\it identity} $e : \text{Ob} \to \text{Arrows}$,
and  a {\it composition law}
$c : \text{Arrows} \times_{s, \text{Ob}, t} \text{Arrows}
\to \text{Arrows}$.
These maps satisfy exactly the following axioms
\begin{enumerate}
\item $s \circ e = t \circ e = \text{id}$ as maps $\text{Ob} \to \text{Ob}$,
\item $c \circ (1, c) = c \circ (c, 1)$ as maps
$\text{Arrows} \times_{s, \text{Ob}, t}
\text{Arrows} \times_{s, \text{Ob}, t}
\text{Arrows} \to \text{Arrows}$,
\item $c \circ (1, e \circ s) = c \circ (e \circ t, 1) = 1$
as maps $\text{Arrows} \to \text{Arrows}$,
\item there exists a map $i : \text{Arrows} \to \text{Arrows}$
called the {\it inverse} such that $s \circ i = t$, $t \circ i = s$ and
$c \circ (1, i) = e \circ t$ and
$c \circ (i, 1) = e \circ s$.
\end{enumerate}
If this is the case the map $i$ is uniquely determined and
is a bijection.

\begin{definition}
\label{definition-groupoid}
Let $S$ be a scheme.
A {\it groupoid scheme over $S$}, or simply a
{\it groupoid over $S$} is a
sixtuple $(U, R, s, t, c, e)$ where
$U$ and $R$ are schemes over $S$,
$s, t : R \to U$, $c : R \times_{s, U, t} R \to R$,
$e : U \to R$ are morphisms
of schemes over $S$ such that for any scheme
$T$ over $S$ the sixtuple
$$
(U(T), R(T), s, t, c, e)
$$
is a groupoid category in the sense described above.
\end{definition}

\noindent
Note that this implies in particular, via the Yoneda lemma,
that there is a unique morphism of schemes
$i : R \to R$ over $S$ such that for every scheme $T$ over $S$
the induced map $i : R(T) \to R(T)$ is the inverse of
the groupoid category. Note that $i$ is an isomorphism.
Moreover, given a groupoid scheme over $S$ we denote
$$
j = (t, s) : R \longrightarrow U \times_S U
$$
which is compatible with our conventions in Section
\ref{section-equivalence-relations} above.

\begin{lemma}
\label{lemma-groupoid-pre-equivalence}
Given a groupoid scheme $(U, R, s, t, c, e)$ over $S$
the morphism $j : R \to U\times_S U$ is a pre-equivalence
relation.
\end{lemma}

\begin{proof}
Omitted.
This is a nice exercise in the definitions.
\end{proof}

\begin{lemma}
\label{lemma-equivalence-groupoid}
Given an equivalence relation $j : R \to U$ over $S$
there is a unique way to extend it to a groupoid
$(U, R, s, t, c, e)$ over $S$.
\end{lemma}

\begin{proof}
Omitted.
This is a nice exercise in the definitions.
\end{proof}
























\input{chapters}

\bibliography{my}
\bibliographystyle{alpha}

\end{document}
