\input{preamble}

% OK, start here.
%
\begin{document}

\title{Morphisms of Algebraic Stacks}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we introduce some types of morphisms of algebraic stacks.
A reference in the case of quasi-separated algebraic stacks with representable
diagonal is \cite{LM-B}.

\medskip\noindent
The goal is to extend the definition of each of the types of morphisms of
algebraic spaces to morphisms of algebraic stacks. Each case is slightly
different and it seems best to treat them all separately.

\medskip\noindent
For morphisms of algebraic stacks which are representable
by algebraic spaces we have already defined a large number of types of
morphisms, see
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
For each corresponding case in this chapter
we have to make sure the definition in the general
case is compatible with the definition given there.




\section{Conventions and abuse of language}
\label{section-conventions}

\noindent
We continue to use the conventions and the abuse of language
introduced in
Properties of Stacks, Section \ref{stacks-properties-section-conventions}.




\section{Properties of diagonals}
\label{section-diagonals}

\noindent
The diagonal of an algebraic stack is closely related to the
$\mathit{Isom}$-sheaves, see
Algebraic Stacks, Lemma \ref{algebraic-lemma-representable-diagonal}.
By the second defining property of an algebraic stack these
$\mathit{Isom}$-sheaves are always algebraic spaces.

\begin{lemma}
\label{lemma-isom-locally-finite-type}
Let $\mathcal{X}$ be an algebraic stack.
Let $T$ be a scheme and let $x, y$ be objects of the fibre category of
$\mathcal{X}$ over $T$. Then the morphism
$\textit{Isom}_{\mathcal{X}}(x, y) \to T$ is locally of finite type.
\end{lemma}

\begin{proof}
By
Algebraic Stacks, Lemma \ref{algebraic-lemma-stack-presentation}
we may assume that $\mathcal{X} = [U/R]$ for some smooth
groupoid in algebraic spaces.
By
Descent of Spaces,
Lemma \ref{spaces-descent-lemma-descending-property-locally-finite-type}
it suffices to check the property fppf locally on $T$.
Thus we may assume that $x, y$ come from morphisms
$x', y' : T \to U$. By
Groupoids in Spaces,
Lemma \ref{spaces-groupoids-lemma-quotient-stack-morphisms}
we see that in this case
$\textit{Isom}_{\mathcal{X}}(x, y) = T \times_{(y', x'), U \times_S U} R$.
Hence it suffices to prove that $R \to U \times_S U$ is
locally of finite type. This follows from the fact that the composition
$s : R \to U \times_S U \to U$ is smooth (hence locally of finite type, see
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-smooth-locally-finite-presentation} and
\ref{spaces-morphisms-lemma-finite-presentation-finite-type})
and
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-permanence-finite-type}.
\end{proof}

\begin{lemma}
\label{lemma-isom-pseudo-torsor-aut}
Let $\mathcal{X}$ be an algebraic stack.
Let $T$ be a scheme and let $x, y$ be objects of the fibre category of
$\mathcal{X}$ over $T$. Then
\begin{enumerate}
\item $\textit{Isom}_{\mathcal{X}}(y, y)$ is a group algebraic space
over $T$, and
\item $\textit{Isom}_{\mathcal{X}}(x, y)$ is a pseudo torsor for
$\textit{Isom}_{\mathcal{X}}(y, y)$ over $T$.
\end{enumerate}
\end{lemma}

\begin{proof}
See
Groupoids in Spaces,
Definitions \ref{spaces-groupoids-definition-group-space} and
\ref{spaces-groupoids-definition-pseudo-torsor}.
The lemma follows immediately from the fact that $\mathcal{X}$ is a
stack in groupoids.
\end{proof}

\noindent
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
The {\it diagonal of $f$} is the morphism
$$
\Delta_f :
\mathcal{X}
\longrightarrow
\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}
$$
Here are two properties that every diagonal morphism has.

\begin{lemma}
\label{lemma-properties-diagonal}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
Then
\begin{enumerate}
\item $\Delta_f$ is representable by algebraic spaces,
and
\item $\Delta_f$ is locally of finite type.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $T$ be a scheme and let
$a : T \to \mathcal{X} \times_{\mathcal{Y}} \mathcal{X}$
be a morphism. By definition of the fibre product and the
$2$-Yoneda lemma the morphism $a$ is given by a triple
$a = (x, x', \alpha)$ where $x, x'$ are objects of $\mathcal{X}$
over $T$, and $\alpha : f(x) \to f(x')$ is a morphism in the fibre
category of $\mathcal{Y}$ over $T$. By definition of an algebraic
stack the sheaves $\mathit{Isom}_{\mathcal{X}}(x, x')$ and
$\mathit{Isom}_{\mathcal{Y}}(f(x), f(x'))$ are algebraic spaces
over $T$. In this language $\alpha$ defines a section of the morphism
$\mathit{Isom}_{\mathcal{X}}(x, x') \to T$. A $T'$-valued point of
$\mathcal{X} \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}, a} T$
for $T' \to T$ a scheme over $T$ is the same thing as an isomorphism
$x|_{T'} \to x'|_{T'}$ whose image under $f$ is $\alpha|_{T'}$.
Thus we see that
\begin{equation}
\label{equation-diagonal}
\vcenter{
\xymatrix{
\mathcal{X} \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}, a} T
\ar[d] \ar[r] &
\mathit{Isom}_{\mathcal{X}}(x, x') \ar[d] \\
T\ar[r]^-\alpha &
\mathit{Isom}_{\mathcal{Y}}(f(x), f(x'))
}
}
\end{equation}
is a fibre square of sheaves over $T$. In particular we see that
$\mathcal{X} \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}, a} T$
is an algebraic space which proves part (1) of the lemma.

\medskip\noindent
To prove the second statement we have to show that the left
vertical arrow of Diagram (\ref{equation-diagonal}) is locally
of finite type. By
Lemma \ref{lemma-isom-locally-finite-type}
the algebraic space $\mathit{Isom}_{\mathcal{X}}(x, x')$ and
is locally of finite type over $T$. Hence the right vertical arrow of
Diagram (\ref{equation-diagonal}) is locally of finite type, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-permanence-finite-type}.
We conclude by
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-base-change-finite-type}.
\end{proof}

\begin{lemma}
\label{lemma-properties-diagonal-representable}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
which is representable by algebraic spaces. Then
\begin{enumerate}
\item $\Delta_f$ is representable
(by schemes),
\item $\Delta_f$ is locally of finite type,
\item $\Delta_f$ is a monomorphism,
\item $\Delta_f$ is separated, and
\item $\Delta_f$ is locally quasi-finite.
\end{enumerate}
\end{lemma}

\begin{proof}
We have already seen in
Lemma \ref{lemma-properties-diagonal}
that $\Delta_f$ is representable by algebraic
spaces. Hence the statements (2) -- (5) make sense, see
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
Also
Lemma \ref{lemma-properties-diagonal}
garantees (2) holds.
Let $T \to \mathcal{X} \times_{\mathcal{Y}} \mathcal{X}$ be a morphism
and contemplate Diagram (\ref{equation-diagonal}). By
Algebraic Stacks, Lemma
\ref{algebraic-lemma-criterion-map-representable-spaces-fibred-in-groupoids}
the right vertical arrow is injective as a map of sheaves, i.e., a
monomorphism of algebraic spaces. Hence also the morphism
$T \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}} \mathcal{X} \to T$
is a monomorphism. Thus (3) holds. We already know that
$T \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}} \mathcal{X} \to T$
is locally of finite type. Thus
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-monomorphism-loc-finite-type-loc-quasi-finite}
allows us to conclude that
$T \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}} \mathcal{X} \to T$
is locally quasi-finite and separated. This proves (4) and (5).
Finally,
Morphisms of Spaces, Proposition
\ref{spaces-morphisms-proposition-locally-quasi-finite-separated-over-scheme}
implies that
$T \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}} \mathcal{X}$
is a scheme which proves (1).
\end{proof}

\begin{lemma}
\label{lemma-base-change-diagonal}
Let
$$
\xymatrix{
\mathcal{U} \ar[d] \ar[r] & \mathcal{V} \ar[d] \\
\mathcal{X} \ar[r] & \mathcal{Y}
}
$$
be a $2$-fibre product. Then the diagram
$$
\xymatrix{
\mathcal{U} \ar[d] \ar[r] &
\mathcal{U} \times_{\mathcal{V}} \mathcal{U} \ar[d] \\
\mathcal{X} \ar[r] &
\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}
}
$$
is $2$-cartesian.
\end{lemma}

\begin{proof}
This is a purely category theoretic statement, valid for $2$-fibre products
of categories over categories and $2$-fibre product in the $2$-category of
categories. Explititly, it follows from the following chain of equivalences:
\begin{align*}
\mathcal{X} \times_{(\mathcal{X} \times_{\mathcal{Y}} \mathcal{X})}
(\mathcal{U} \times_{\mathcal{V}} \mathcal{U})
& =
\mathcal{X} \times_{(\mathcal{X} \times_{\mathcal{Y}} \mathcal{X})}
((\mathcal{X} \times_{\mathcal{Y}} \mathcal{V})
\times_{\mathcal{V}} (\mathcal{X} \times_{\mathcal{Y}} \mathcal{V})) \\
& =
\mathcal{X} \times_{(\mathcal{X} \times_{\mathcal{Y}} \mathcal{X})}
(\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}
\times_{\mathcal{Y}} \mathcal{V}) \\
& =
\mathcal{X} \times_{\mathcal{Y}} \mathcal{V} = \mathcal{U}
\end{align*}
see
Categories, Lemmas \ref{categories-lemma-associativity-2-fibre-product} and
\ref{categories-lemma-2-fibre-product-erase-factor}.
\end{proof}

\begin{lemma}
\label{lemma-representable-separated-diagonal-closed}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
representable by algebraic spaces. Then the following are equivalent
\begin{enumerate}
\item $f$ is separated,
\item $\Delta_f$ is a closed immersion,
\item $\Delta_f$ is proper, or
\item $\Delta_f$ is universally closed.
\end{enumerate}
\end{lemma}

\begin{proof}
The statements
``$f$ is separated'',
``$\Delta_f$ is a closed immersion'',
``$\Delta_f$ is universally closed'', and
``$\Delta_f$ is proper''
refer to the notions defined in
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
Choose a scheme $V$ and a surjective smooth morphism $V \to \mathcal{Y}$.
Set $U = \mathcal{X} \times_{\mathcal{Y}} V$ which is an algebraic
space by assumption, and the morphism $U \to \mathcal{X}$ is surjective
and smooth. By
Lemma \ref{lemma-base-change-diagonal}
and
Properties of Stacks,
Lemma \ref{stacks-properties-lemma-check-property-covering}
we see that for any property $P$ (as in that lemma) we have:
$\Delta_f$ has $P$ if and only if $\Delta_{U/V} : U \to  U \times_V U$ has $P$.
Hence the equivalence of (2), (3) and (4) follows from
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-separated-diagonal-proper}
applied to $U \to V$.
Moreover, if (1) holds, then $U \to V$ is separated and we see that
$\Delta_{U/V}$ is a closed immersion, i.e., (2) holds.
Finally, assume (2) holds. Let $T$ be a scheme, and $a : T \to \mathcal{Y}$
a morphism. Set $T' = \mathcal{X} \times_{\mathcal{Y}} T$. To prove
(1) we have to show that the morphism of algebraic spaces $T' \to T$
is separated. Using
Lemma \ref{lemma-base-change-diagonal}
once more we see that $\Delta_{T'/T}$ is the base change of
$\Delta_f$. Hence our assumption (2) implies that $\Delta_{T'/T}$
is a closed immersion, hence $T' \to T$ is separated as desired.
\end{proof}

\begin{lemma}
\label{lemma-representable-quasi-separated-diagonal-quasi-compact}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
representable by algebraic spaces. Then the following are equivalent
\begin{enumerate}
\item $f$ is quasi-separated,
\item $\Delta_f$ is quasi-compact, or
\item $\Delta_f$ is finite type.
\end{enumerate}
\end{lemma}

\begin{proof}
The statements
``$f$ is quasi-separated'',
``$\Delta_f$ is quasi-compact'', and
``$\Delta_f$ is finite type''
refer to the notions defined in
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
Note that (2) and (3) are equivalent in view of the fact that
$\Delta_f$ is locally of finite type by
Lemma \ref{lemma-properties-diagonal-representable}
(and
Algebraic Stacks, Lemma
\ref{algebraic-lemma-representable-transformations-property-implication}).
Choose a scheme $V$ and a surjective smooth morphism $V \to \mathcal{Y}$.
Set $U = \mathcal{X} \times_{\mathcal{Y}} V$ which is an algebraic
space by assumption, and the morphism $U \to \mathcal{X}$ is surjective
and smooth. By
Lemma \ref{lemma-base-change-diagonal}
and
Properties of Stacks,
Lemma \ref{stacks-properties-lemma-check-property-covering}
we see that we have: $\Delta_f$ is quasi-compact if and only if
$\Delta_{U/V} : U \to  U \times_V U$ is quasi-compact.
If (1) holds, then $U \to V$ is quasi-separated and we see that
$\Delta_{U/V}$ is quasi-compact, i.e., (2) holds.
Assume (2) holds. Let $T$ be a scheme, and $a : T \to \mathcal{Y}$
a morphism. Set $T' = \mathcal{X} \times_{\mathcal{Y}} T$. To prove
(1) we have to show that the morphism of algebraic spaces $T' \to T$
is quasi-separated. Using
Lemma \ref{lemma-base-change-diagonal}
once more we see that $\Delta_{T'/T}$ is the base change of
$\Delta_f$. Hence our assumption (2) implies that $\Delta_{T'/T}$
is quasi-compact, hence $T' \to T$ is quasi-separated as desired.
\end{proof}

\begin{lemma}
\label{lemma-representable-locally-separated-diagonal-immersion}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
representable by algebraic spaces. Then the following are equivalent
\begin{enumerate}
\item $f$ is locally separated, and
\item $\Delta_f$ is an immersion.
\end{enumerate}
\end{lemma}

\begin{proof}
The statements ``$f$ is quasi-separated'', and ``$\Delta_f$ is an immersion''
refer to the notions defined in
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
Proof omitted. Hint: Argue as in the proofs of
Lemmas \ref{lemma-representable-separated-diagonal-closed} and
\ref{lemma-representable-quasi-separated-diagonal-quasi-compact}.
\end{proof}






\section{Separation axioms}
\label{section-separated}

\noindent
Let $\mathcal{X} = [U/R]$ be a presentation of an algebraic stack.
Then the properties of the diagonal of $\mathcal{X}$ over $S$, are
the properties of the morphism $j : R \to U \times_S U$. For example,
if $\mathcal{X} = [S/G]$ for some smooth group $G$ in algebraic spaces
over $S$ then $j$ is the structure morphism $G \to U$. Hence the diagonal
is not automatically separated itself (contrary to what happens in the
case of schemes and algebraic spaces). To say that $[S/G]$ is quasi-separated
over $S$ should certainly imply that $G \to S$ is quasi-compact, but we
hesitate to say that $[S/G]$ is quasi-separated over $S$ without also
requiring the morphism $G \to S$ to be quasi-separated. In other words,
requiring the diagonal morphism to be quasi-compact does not really agree
with our intuition for a ``quasi-separated algebraic stack'', and we should
also require the diagonal itself to be quasi-separated.

\medskip\noindent
What about ``separated algebraic stacks''? We have seen in
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-separated-diagonal-proper}
that an algebraic space is separated if and only if the diagonal is proper.
This is the condition that is usually used to define separated algebraic
stacks too. In the example $[S/G] \to S$ above this means that $G \to S$
is a proper group scheme. This means algebraic stacks of the form
$[\text{Spec}(k)/E]$ are proper over $k$ where $E$ is an elliptic curve
over $k$ (insert future reference here). In certain situations it may be
more natural to assume the diagonal is finite.

\begin{definition}
\label{definition-separated}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
\begin{enumerate}
\item We say $f$ is {\it DM} if $\Delta_f$ is unramified\footnote{The
letters DM stand for Deligne-Mumford. If $f$ is DM then given any scheme
$T$ and any morphism $T \to \mathcal{Y}$ the fibre product
$\mathcal{X}_T = \mathcal{X} \times_{\mathcal{Y}} T$
is an algebraic stack over $T$ whose diagonal is unramified.
This implies that $\mathcal{X}_T$ has an unramified
diagonal, which implies that $\mathcal{X}_T$
is a Deligne-Mumford stack by (insert future reference here).
In other words a DM morphism is one whose ``fibres'' are Deligne-Mumford
stacks. This hopefully at least motivates the terminology.}.
\item We say $f$ is {\it quasi-DM} if $\Delta_f$ is
locally quasi-finite\footnote{A word about this terminology
is in order. If $f$ is quasi-DM, then the ``fibres'' $\mathcal{X}_T$ of
$\mathcal{X} \to \mathcal{Y}$ are quasi-DM. It will turn out that an
algebraic stack $\mathcal{X}$ is quasi-DM exactly if there exists a
scheme $U$ and a surjective flat morphism $U \to \mathcal{X}$ of finite
presentation which is locally quasi-finite, see (insert future
reference here). Note the similarity to being Deligne-Mumford, which
is defined in terms of having an \'etale covering by a scheme.}.
\item We say $f$ is {\it quasi-separated} if $\Delta_f$
is quasi-compact and quasi-separated.
\item We say $f$ is {\it separated} if $\Delta_f$ is proper.
\end{enumerate}
\end{definition}

\noindent
In this definition we are using that $\Delta_f$ is representable by algebraic
spaces and we are using
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}
to make sense out of imposing conditions on $\Delta_f$.
We note that these definitions do not conflict with the already
existing notions if $f$ is representable by algebraic spaces, see
Lemmas \ref{lemma-representable-quasi-separated-diagonal-quasi-compact} and
\ref{lemma-representable-separated-diagonal-closed}.
There is an interesting way to characterize these conditions by looking
at higher diagonals, see
Lemma \ref{lemma-definition-separated}.

\begin{definition}
\label{definition-absolute-separated}
Let $\mathcal{X}$ be an algebraic stack over the base scheme $S$.
\begin{enumerate}
\item We say $\mathcal{X}$ is {\it quasi-DM over $S$}
if the structure morphism $\mathcal{X} \to S$ is quasi-DM.
\item We say $\mathcal{X}$ is {\it quasi-separated over $S$} if
the structure morphism $\mathcal{X} \to S$ is quasi-separated.
\item We say $\mathcal{X}$ is {\it separated over $S$}
if the structure morphism $\mathcal{X} \to S$ is separated.
\item We say $\mathcal{X}$ is {\it quasi-DM}
if $\mathcal{X}$, viewed as an algebraic stack over $\text{Spec}(\mathbf{Z})$,
is quasi-DM over $\text{Spec}(\mathbf{Z})$.
\item We say $\mathcal{X}$ is {\it quasi-separated} if $\mathcal{X}$, viewed
as an algebraic stack over $\text{Spec}(\mathbf{Z})$, is quasi-separated over
$\text{Spec}(\mathbf{Z})$.
\item We say $\mathcal{X}$ is {\it separated} if $\mathcal{X}$, viewed
as an algebraic stack over $\text{Spec}(\mathbf{Z})$ see
Algebraic Stacks, Definition \ref{algebraic-definition-viewed-as},
is separated over $\text{Spec}(\mathbf{Z})$.
\end{enumerate}
\end{definition}

\noindent
Thus in each case we have an absolute notion and a notion relative to
our given base scheme (mention of which is usually surpressed by our
abuse of notation introduced in
Properties of Stacks, Section \ref{stacks-properties-section-conventions}).
We spend some time proving some standard results on these notions.

\begin{lemma}
\label{lemma-trivial-implications}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
If $f$ is separated then $f$ is quasi-separated.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-base-change-separated}
All of the separation axioms listed in
Definition \ref{definition-separated}
are stable under base change.
\end{lemma}

\begin{proof}
Let $f : \mathcal{X} \to \mathcal{Y}$ and
$\mathcal{Y}' \to \mathcal{Y}$ be morphisms of algebraic stacks.
Let $f' : \mathcal{Y}' \times_{\mathcal{Y}} \mathcal{X} \to \mathcal{Y}'$
be the base change of $f$ by $\mathcal{Y}' \to \mathcal{Y}$.
Then $\Delta_{f'}$ is the base change of $\Delta_f$ by the morphism
$\mathcal{X}' \times_{\mathcal{Y}'} \mathcal{X}' \to
\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}$, see
Lemma \ref{lemma-base-change-diagonal}.
By the results of
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}
each of the properties of the diagonal used in
Definition \ref{definition-separated}
is stable under base change. Hence the lemma is true.
\end{proof}

\begin{lemma}
\label{lemma-change-of-base-separated}
The separation axioms (1), (2), and (3) of
Definition \ref{definition-absolute-separated}
are stable under change of base scheme, see
Algebraic Stacks, Definition \ref{algebraic-definition-change-of-base}.
\end{lemma}

\begin{proof}
Omitted. Hint: Use
Lemma \ref{lemma-base-change-separated}.
\end{proof}

\begin{lemma}
\label{lemma-fibre-product-after-map}
Let $f : \mathcal{X} \to \mathcal{Z}$, $g : \mathcal{Y} \to \mathcal{Z}$
and $\mathcal{Z} \to \mathcal{T}$ be morphisms of algebraic stacks.
Consider the induced morphism
$i : \mathcal{X} \times_{\mathcal{Z}} \mathcal{Y} \to
\mathcal{X} \times_{\mathcal{T}} \mathcal{Y}$.
Then
\begin{enumerate}
\item $i$ is representable by algebraic spaces and locally of finite type,
\item if $\Delta_{\mathcal{Z}/\mathcal{T}}$ is quasi-separated, then
$i$ is quasi-separated,
\item if $\Delta_{\mathcal{Z}/\mathcal{T}}$ is separated, then
$i$ is separated,
\item if $\mathcal{Z} \to \mathcal{T}$ is quasi-DM,
then $i$ is locally quasi-finite,
\item if $\mathcal{Z} \to \mathcal{T}$ is quasi-separated, then
$i$ is quasi-compact and quasi-separated, and
\item if $\mathcal{Z} \to \mathcal{T}$ is separated, then $i$ is proper.
\end{enumerate}
\end{lemma}

\begin{proof}
The following diagram
$$
\xymatrix{
\mathcal{X} \times_\mathcal{Z} \mathcal{Y} \ar[r]_i \ar[d] &
\mathcal{X} \times_\mathcal{T} \mathcal{Y} \ar[d] \\
\mathcal{Z} \ar[r]^-{\Delta_{\mathcal{Z}/\mathcal{T}}} \ar[r] &
\mathcal{Z} \times_\mathcal{T} \mathcal{Z}
}
$$
is a $2$-fibre product diagram, see
Categories, Lemma \ref{categories-lemma-fibre-product-after-map}.
Hence $i$ is the base change of the
diagonal morphism $\Delta_{\mathcal{Z}/\mathcal{T}}$. Thus the lemma follows
from
Lemma \ref{lemma-properties-diagonal},
and the material in
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
\end{proof}

\begin{lemma}
\label{lemma-semi-diagonal}
Let $\mathcal{T}$ be an algebraic stack. Let $g : \mathcal{X} \to \mathcal{Y}$
be a morphism of algebraic stacks over $\mathcal{T}$. Consider the graph
$i : \mathcal{X} \to \mathcal{X} \times_\mathcal{T} \mathcal{Y}$ of $g$. Then
\begin{enumerate}
\item $i$ is representable by algebraic spaces and locally of finite type,
\item if $\mathcal{Y} \to \mathcal{T}$ is quasi-DM, then $i$ is locally
quasi-finite,
\item if $\mathcal{Y} \to \mathcal{T}$ is quasi-separated, then $i$ is
quasi-compact and quasi-separated, and
\item if $\mathcal{Y} \to \mathcal{T}$ is separated, then $i$ is proper.
\end{enumerate}
\end{lemma}

\begin{proof}
This is a special case of Lemma \ref{lemma-fibre-product-after-map}
applied to the morphism
$\mathcal{X} = \mathcal{X} \times_\mathcal{Y} \mathcal{Y} \to
\mathcal{X}\times_\mathcal{T} \mathcal{Y}$.
\end{proof}

\begin{lemma}
\label{lemma-section-immersion}
Let $f : \mathcal{X} \to \mathcal{T}$ be a morphism of algebraic stacks.
Let $s : \mathcal{T} \to \mathcal{X}$ be a morphism such that
$f \circ s$ is $2$-isomorphic to $\text{id}_\mathcal{T}$. Then
\begin{enumerate}
\item $s$ is representable by algebraic spaces and locally of finite type,
\item if $f$ is quasi-DM, then $i$ is locally quasi-finite,
\item if $f$ is quasi-separated, then
$i$ is quasi-compact and quasi-separated, and
\item if $f$ is separated, then $i$ is proper.
\end{enumerate}
\end{lemma}

\begin{proof}
This is a special case of Lemma \ref{lemma-semi-diagonal} applied to
$g = s$ and $\mathcal{Y} = \mathcal{T}$ in which case
$i : \mathcal{T} \to \mathcal{T} \times_\mathcal{T} \mathcal{X}$
is $2$-isomorphic to $s$.
\end{proof}

\begin{lemma}
\label{lemma-composition-separated}
All of the separation axioms listed in
Defintion \ref{definition-separated}
are stable under composition of morphisms.
\end{lemma}

\begin{proof}
Let $f : \mathcal{X} \to \mathcal{Y}$ and
$g : \mathcal{Y} \to \mathcal{Z}$ be morphisms of algebraic stacks
to which the axiom in question applies.
The diagonal $\Delta_{\mathcal{X}/\mathcal{Z}}$ is the composition
$$
\mathcal{X} \longrightarrow
\mathcal{X} \times_\mathcal{Y} \mathcal{X} \longrightarrow
\mathcal{X} \times_\mathcal{Z} \mathcal{X}.
$$
Our separation axiom is defined by requiring the diagonal
to have some property $\mathcal{P}$. By
Lemma \ref{lemma-fibre-product-after-map}
above we see that the second arrow also has this property.
Hence the lemma follows since the composition of
morphisms which are representable by algebraic spaces with property
$\mathcal{P}$ also is a morphism with property $\mathcal{P}$, see
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
\end{proof}

\begin{lemma}
\label{lemma-separated-over-separated}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
over the base scheme $S$.
\begin{enumerate}
\item If $\mathcal{Y}$ is quasi-DM over $S$ and $f$ is quasi-DM,
then $\mathcal{X}$ is quasi-DM over $S$.
\item If $\mathcal{Y}$ is quasi-separated over $S$ and $f$ is quasi-separated,
then $\mathcal{X}$ is quasi-separated over $S$.
\item If $\mathcal{Y}$ is separated over $S$ and $f$ is separated,
then $\mathcal{X}$ is separated over $S$.
\item If $\mathcal{Y}$ is quasi-DM and $f$ is quasi-DM,
then $\mathcal{X}$ is quasi-DM.
\item If $\mathcal{Y}$ is quasi-separated and $f$ is quasi-separated,
then $\mathcal{X}$ is quasi-separated.
\item If $\mathcal{Y}$ is separated and $f$ is separated,
then $\mathcal{X}$ is separated.
\end{enumerate}
\end{lemma}

\begin{proof}
Parts (1), (2), and (3) follow immediately from 
Lemma \ref{lemma-composition-separated}
and
Definition \ref{definition-absolute-separated}.
For (4), (5), and (6) think of $\mathcal{X}$ and $\mathcal{Y}$ as
algebraic stacks over $\text{Spec}(\mathbf{Z})$ and apply
Lemma \ref{lemma-composition-separated}.
Details omitted.
\end{proof}

\noindent
The following lemma is a bit different to the analogue for algebraic
spaces. To compare take a look at
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-compose-after-separated}.

\begin{lemma}
\label{lemma-compose-after-separated}
Let $f : \mathcal{X} \to \mathcal{Y}$ and
$g : \mathcal{Y} \to \mathcal{Z}$ be morphisms of algebraic stacks.
\begin{enumerate}
\item If $g \circ f$ is quasi-DM then so is $f$.
\item If $g \circ f$ is quasi-separated and
$\Delta_g$ is quasi-separated, then $f$ is quasi-separated.
\item If $g \circ f$ is separated and $\Delta_g$ is separated, then
$f$ is separated.
\end{enumerate}
\end{lemma}

\begin{proof}
The three proofs are exactly the same.
Proof of (1). Assume $g \circ f$ is quasi-DM. Consider the factorization
$$
\mathcal{X} \to
\mathcal{X} \times_\mathcal{Y} \mathcal{X} \to
\mathcal{X} \times_\mathcal{Z} \mathcal{X}
$$
of the diagonal morphism of $g \circ f$. Both morphisms are
representable by algebraic spaces, see
Lemmas \ref{lemma-properties-diagonal} and
\ref{lemma-fibre-product-after-map}.
Hence for any scheme $T$ and morphism
$T \to \mathcal{X} \times_\mathcal{Y} \mathcal{X}$
we get morphisms of algebraic spaces
$$
A = \mathcal{X} \times_{(\mathcal{X} \times_{\mathcal{Z}} \mathcal{X})} T
\longrightarrow
B = (\mathcal{X} \times_\mathcal{Y} \mathcal{X})
\times_{(\mathcal{X} \times_{\mathcal{Z}} \mathcal{X})} T
\longrightarrow
T.
$$
The composition $A \to T$ is locally quasi-finite as we have assumed
that $g \circ f$ is quasi-DM. Hence (1) follows on applying
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-permanence-quasi-finite}.

\medskip\noindent
Proof of (2). Assume $g \circ f$ is quasi-separated and $\Delta_g$ is
quasi-separated. Consider the factorization
$$
\mathcal{X} \to
\mathcal{X} \times_\mathcal{Y} \mathcal{X} \to
\mathcal{X} \times_\mathcal{Z} \mathcal{X}
$$
of the diagonal morphism of $g \circ f$. Both morphisms are
representable by algebraic spaces and the second one is quasi-separated, see
Lemmas \ref{lemma-properties-diagonal} and
\ref{lemma-fibre-product-after-map}.
Hence for any scheme $T$ and morphism
$T \to \mathcal{X} \times_\mathcal{Y} \mathcal{X}$
we get morphisms of algebraic spaces
$$
A = \mathcal{X} \times_{(\mathcal{X} \times_{\mathcal{Z}} \mathcal{X})} T
\longrightarrow
B = (\mathcal{X} \times_\mathcal{Y} \mathcal{X})
\times_{(\mathcal{X} \times_{\mathcal{Z}} \mathcal{X})} T
\longrightarrow
T
$$
such that $B \to T$ is quasi-separated.
The composition $A \to T$ is quasi-compact and quasi-separated
as we have assumed that $g \circ f$ is quasi-separated.
Hence $A \to B$ is quasi-separated by
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-compose-after-separated}.
And $A \to B$ is quasi-compact by
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-quasi-compact-permanence}.
Thus $f$ is quasi-separated.

\medskip\noindent
Proof of (3). Assume $g \circ f$ is separated and $\Delta_g$ is
separated. Consider the factorization
$$
\mathcal{X} \to
\mathcal{X} \times_\mathcal{Y} \mathcal{X} \to
\mathcal{X} \times_\mathcal{Z} \mathcal{X}
$$
of the diagonal morphism of $g \circ f$. Both morphisms are
representable by algebraic spaces and the second one is separated, see
Lemmas \ref{lemma-properties-diagonal} and
\ref{lemma-fibre-product-after-map}.
Hence for any scheme $T$ and morphism
$T \to \mathcal{X} \times_\mathcal{Y} \mathcal{X}$
we get morphisms of algebraic spaces
$$
A = \mathcal{X} \times_{(\mathcal{X} \times_{\mathcal{Z}} \mathcal{X})} T
\longrightarrow
B = (\mathcal{X} \times_\mathcal{Y} \mathcal{X})
\times_{(\mathcal{X} \times_{\mathcal{Z}} \mathcal{X})} T
\longrightarrow
T
$$
such that $B \to T$ is separated.
The composition $A \to T$ is proper as we have assumed that
$g \circ f$ is quasi-separated. Hence $A \to B$ is proper by
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-universally-closed-permanence}
which means that $f$ is separated.
\end{proof}

\begin{lemma}
\label{lemma-separated-implies-morphism-separated}
Let $\mathcal{X}$ be an algebraic stack over the base scheme $S$.
\begin{enumerate}
\item We have the following equivalence:
$\mathcal{X}$ is quasi-DM $\Leftrightarrow$
$\mathcal{X}$ is quasi-DM over $S$.
\item If $\mathcal{X}$ is quasi-separated, then
$\mathcal{X}$ is quasi-separated over $S$.
\item If $\mathcal{X}$ is separated, then
$\mathcal{X}$ is separated over $S$.
\end{enumerate}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
over the base scheme $S$.
\begin{enumerate}
\item[(4)] If $\mathcal{X}$ is quasi-DM over $S$, then $f$ is quasi-DM.
\item[(5)] If $\mathcal{X}$ is quasi-separated over $S$ and
$\Delta_{\mathcal{Y}/S}$ is quasi-separated, then $f$ is quasi-separated.
\item[(6)] If $\mathcal{X}$ is separated over $S$ and
$\Delta_{\mathcal{Y}/S}$ is separated, then $f$ is separated.
\end{enumerate}
\end{lemma}

\begin{proof}
Parts (4), (5), and (6) follow immediately from
Lemma \ref{lemma-compose-after-separated}
and
Spaces, Definition \ref{spaces-definition-separated}.
To prove (2) aend (3) think of $X$ and $Y$ as algebraic stacks over
$\text{Spec}(\mathbf{Z})$ and apply
Lemma \ref{lemma-compose-after-separated}.
Similarly, to prove (1), think of $\mathcal{X}$ as an algebraic
stack over $\text{Spec}(\mathbf{Z})$ consider the
morphisms
$$
\mathcal{X} \longrightarrow
\mathcal{X} \times_S \mathcal{X} \longrightarrow
\mathcal{X} \times_{\text{Spec}(\mathbf{Z})} \mathcal{X}
$$
Both arrows are representable by algebraic spaces.
The second arrow is locally quasi-finite as the base change of
$\Delta_{S/\mathbf{Z}}$. Hence the composition is locally
quasi-finite if and only if the first arrow is locally quasi-finite, see
Morphisms of Spaces,
Lemmas \ref{spaces-morphisms-lemma-composition-quasi-finite} and
\ref{spaces-morphisms-lemma-permanence-quasi-finite}.
Some details omitted.
\end{proof}

















\section{Inertia stacks}
\label{section-inertia}

\begin{lemma}
\label{lemma-inertia}
Let $\mathcal{X}$ be an algebraic stack. Then the inertia stack
$\mathcal{I}_{\mathcal{X}}$ is an algebraic stack as well.
The morphism
$$
\mathcal{I}_{\mathcal{X}} \longrightarrow \mathcal{X}
$$
is representable by algebraic spaces and locally of finite type.
More generally, let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism
of algebraic stacks. Then the morphism
$$
\mathcal{I}_{\mathcal{X}/\mathcal{Y}} \longrightarrow \mathcal{X}
$$
is representable by algebraic spaces and locally of finite type.
\end{lemma}

\begin{proof}
The (relative) inertia stack of a stack in groupoids is defined in
Stacks, Section \ref{stacks-section-the-inertia-stack}.
By
Categories, Lemma \ref{categories-lemma-intertia-fibred-category}
there are equivalences
$$
\mathcal{I}_{\mathcal{X}} \to
\mathcal{X} \times_{\Delta, \mathcal{X} \times_S \mathcal{X}, \Delta}
\mathcal{X}
\quad\text{and}\quad
\mathcal{I}_{\mathcal{X}/\mathcal{Y}} \to
\mathcal{X}
\times_{\Delta, \mathcal{X} \times_{\mathcal{Y}} \mathcal{X}, \Delta}
\mathcal{X}
$$
which shows that the inertia stacks are algebraic stacks.
Let $T \to \mathcal{X}$ be a morphism given by
the object $x$ of the fibre category of $\mathcal{X}$ over $T$.
Then we get a $2$-fibre product square
$$
\xymatrix{
\mathit{Isom}_{\mathcal{X}}(x, x) \ar[d] \ar[r] &
\mathcal{I}_{\mathcal{X}} \ar[d] \\
T \ar[r]^x & \mathcal{X}
}
$$
This follows immediately from the definition of $\mathcal{I}_{\mathcal{X}}$.
Since $\mathit{Isom}_{\mathcal{X}}(x, x)$ is always an algebraic space
locally of finite type over $T$ (see
Lemma \ref{lemma-isom-locally-finite-type})
we conclude that $\mathcal{I}_{\mathcal{X}} \to \mathcal{X}$ is representable
by algebraic spaces and locally of finite type. Finally, for
the relative inertia we get
$$
\vcenter{
\xymatrix{
\mathit{Isom}_{\mathcal{X}}(x, x) \ar[d] &
K \ar[l] \ar[d] \ar[r] &
\mathcal{I}_{\mathcal{X}/\mathcal{Y}} \ar[d] \\
\mathit{Isom}_{\mathcal{Y}}(f(x), f(x)) &
T \ar[l]_-e \ar[r]^x & \mathcal{X}
}
}
$$
with both squares $2$-fibre products. This follows from
Categories, Lemma \ref{categories-lemma-relative-inertia-as-fibre-product}.
The left vertical arrow is a morphism of algebraic spaces locally of finite
type over $T$, and hence is locally of finite type, see
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-permanence-finite-type}.
Thus $K$ is an algebraic space and $K \to T$ is locally of finite type.
This proves the assertion on the relative inertia.
\end{proof}

\begin{remark}
\label{remark-inertia-is-group-in-spaces}
Let $\mathcal{X}$ be an algebraic stack. In
Properties of Stacks, Remark \ref{stacks-properties-remark-representable-over}
we have seen that the $2$-category of morphisms
$\mathcal{X}' \to \mathcal{X}$ representable by algebraic spaces
with target $\mathcal{X}$ forms a category.
In this category the inertia stack of $\mathcal{X}$ is
a {\it group object}. Recall that an object of $\mathcal{I}_{\mathcal{X}}$
is just a pair $(x, \alpha)$ where $x$ is an object of $\mathcal{X}$
and $\alpha$ is an automorphism of $x$ in the fibre category of $\mathcal{X}$
that $x$ lives in. The composition
$$
c :
\mathcal{I}_{\mathcal{X}} \times_{\mathcal{X}} \mathcal{I}_{\mathcal{X}}
\longrightarrow
\mathcal{I}_{\mathcal{X}}
$$
is given by the rule on objects
$$
((x, \alpha), (x', \alpha'), \beta) \mapsto
(x, \alpha \circ \beta^{-1} \circ \alpha' \circ \beta)
$$
which makes sense as $\beta : x \to x'$ is an isomorphism in the fibre
category by our definition of fibre products. The neutral element
$e : \mathcal{X} \to \mathcal{I}_{\mathcal{X}}$ is given by the
functor $x \mapsto (x, \text{id}_x)$. We omit the proof that the
axioms of a group object hold.
There is a variant of this remark for relative inertia stacks.
\end{remark}









\section{Higher diagonals}
\label{section-higher-diagonals}

\noindent
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
In this situation it makes sense to consider not only the diagonal
$$
\Delta_f : \mathcal{X} \to \mathcal{X} \times_{\mathcal{Y}} \mathcal{X}
$$
but also the diagonal of the diagonal, i.e., the morphism
$$
\Delta_{\Delta_f} :
\mathcal{X}
\longrightarrow
\mathcal{X} \times_{(\mathcal{X} \times_{\mathcal{Y}} \mathcal{X})} \mathcal{X}
$$
Because of this we sometimes use the following terminology. We denote
$\Delta_{f, 0} = f$ the {\it zeroth diagonal},
we denote $\Delta_{f, 1} = \Delta_f$ the {\it first diagonal}, and
we denote $\Delta_{f, 2} = \Delta_{\Delta_f}$ the {\it second diagonal}.
Note that $\Delta_{f, 1}$ is representable by algebraic spaces and locally of
finite type, see
Lemma \ref{lemma-properties-diagonal}.
Hence $\Delta_{f, 2}$ is representable, a monomorphism, locally of finite type,
separated, and locally quasi-finite, see
Lemma \ref{lemma-properties-diagonal-representable}.

\medskip\noindent
We can describe the second diagonal using the relative inertia stack.
Namely, the fibre product
$\mathcal{X}
\times_{(\mathcal{X} \times_{\mathcal{Y}} \mathcal{X})} \mathcal{X}$
is equivalent to the relative inertia stack
$\mathcal{I}_{\mathcal{X}/\mathcal{Y}}$ by
Categories, Lemma \ref{categories-lemma-intertia-fibred-category}.
Moreover, via this identification the second diagonal becomes the
{\it neutral section}
$$
e : \mathcal{X} \to \mathcal{I}_{\mathcal{X}/\mathcal{Y}}
$$
of the relative inertia stack. Moreover, recall from the proof of
Lemma \ref{lemma-inertia}
that given a morphism $x : T \to \mathcal{X}$ the fibre product
$T \times_{x, \mathcal{X}} \mathcal{I}_{\mathcal{X}/\mathcal{Y}}$
is given as the {\it kernel} $K$ of the homomorphism of group algebraic spaces
$$
\mathit{Isom}_{\mathcal{X}}(x, x)
\longrightarrow
\mathit{Isom}_{\mathcal{Y}}(f(x), f(x))
$$
over $T$. The morphism $e$ corresponds to the neutral section
$e : T \to K$ in this situation.

\begin{lemma}
\label{lemma-second-diagonal}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
Then $f$ is representable by algebraic spaces if and only if
the second diagonal is an isomorphism.
\end{lemma}

\begin{proof}
Namely, $f$ is representable by algebraic spaces if and only if $f$ is
faithful, see
Algebraic Stacks,
Lemma \ref{algebraic-lemma-characterize-representable-by-algebraic-spaces}.
On the other hand, $f$ is faithful if and only if for every object $x$
of $\mathcal{X}$ over a scheme $T$ the functor $f$ induces an injection
$\mathit{Isom}_{\mathcal{X}}(x, x) \to
\mathit{Isom}_{\mathcal{Y}}(f(x), f(x))$,
which happens if and only if the kernel $K$ is trivial, which happens if and
only if $e : T \to K$ is an isomorphism for every $x : T \to \mathcal{X}$.
Since $K = T \times_{x, \mathcal{X}} \mathcal{I}_{\mathcal{X}/\mathcal{Y}}$
as discussed above, this proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-first-diagonal-separated-second-diagonal-closed}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
Then
\begin{enumerate}
\item $\Delta_{f, 1}$ separated $\Leftrightarrow$
$\Delta_{f, 2}$ closed immersion $\Leftrightarrow$
$\Delta_{f, 2}$ proper $\Leftrightarrow$
$\Delta_{f, 2}$ universally closed,
\item $\Delta_{f, 1}$ quasi-separated $\Leftrightarrow$
$\Delta_{f, 2}$ finite type $\Leftrightarrow$ $\Delta_{f, 2}$ quasi-compact,
and
\item $\Delta_{f, 1}$ locally separated $\Leftrightarrow$
$\Delta_{f, 2}$ immersion.
\end{enumerate}
\end{lemma}

\begin{proof}
Follows from
Lemmas \ref{lemma-representable-separated-diagonal-closed},
\ref{lemma-representable-quasi-separated-diagonal-quasi-compact}, and
\ref{lemma-representable-locally-separated-diagonal-immersion}
applied to $\Delta_{f, 1}$.
\end{proof}

\noindent
The following lemma is kind of cute and it may suggest a generalization
of these conditions to higher algebraic stacks.

\begin{lemma}
\label{lemma-definition-separated}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
Then
\begin{enumerate}
\item $f$ is separated if and only if $\Delta_{f, 1}$ and $\Delta_{f, 2}$
are universally closed, and
\item $f$ is quasi-separated if and only if $\Delta_{f, 1}$ and $\Delta_{f, 2}$
are quasi-compact.
\item $f$ is quasi-DM if and only if $\Delta_{f, 1}$ and $\Delta_{f, 2}$
are locally quasi-finite.
\item $f$ is DM if and only if $\Delta_{f, 1}$ and $\Delta_{f, 2}$
are unramified.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). Assume that $\Delta_{f, 2}$ and $\Delta_{f, 1}$ are
universally closed. Then $\Delta_{f, 1}$ is separated and universally
closed by
Lemma \ref{lemma-first-diagonal-separated-second-diagonal-closed}.
By
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-universally-closed-quasi-compact}
and
Algebraic Stacks,
Lemma \ref{algebraic-lemma-representable-transformations-property-implication}
we see that $\Delta_{f, 1}$ is quasi-compact.
Hence it is quasi-compact, separated, universally closed and locally of
finite type (by
Lemma \ref{lemma-properties-diagonal})
so proper. This proves ``$\Leftarrow$'' of (1).
The proof of the implication in the other direction is omitted.

\medskip\noindent
Proof of (2). This follows immediately from
Lemma \ref{lemma-first-diagonal-separated-second-diagonal-closed}.

\medskip\noindent
Proof of (3). This follows from the fact that $\Delta_{f, 2}$ is always locally
quasi-finite by
Lemma \ref{lemma-properties-diagonal-representable}
applied to $\Delta_f = \Delta_{f, 1}$.

\medskip\noindent
Proof of (4). This follows from the fact that $\Delta_{f, 2}$ is always
unramified as
Lemma \ref{lemma-properties-diagonal-representable}
applied to $\Delta_f = \Delta_{f, 1}$ shows that
$\Delta_{f, 2}$ is locally of finite type and a monomorphism.
See
More on Morphisms of Spaces,
Lemma \ref{spaces-more-morphisms-lemma-universally-injective-unramified}.
\end{proof}










\section{Quasi-compact morphisms}
\label{section-quasi-compact}

\noindent
Let $f$ be a morphism of algebraic stacks which is representable by
algebraic spaces. In
Properties of Spaces,
Section \ref{stacks-properties-section-properties-morphisms}
we have defined what it means for $f$ to be quasi-compact.
Here is another characterization.

\begin{lemma}
\label{lemma-characterize-representable-quasi-compact}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
which is representable by algebraic spaces. The following are equivalent:
\begin{enumerate}
\item $f$ is quasi-compact, and
\item for every quasi-compact algebraic stack $\mathcal{Z}$
and any morphism $\mathcal{Z} \to \mathcal{Y}$ the algebraic stack
$\mathcal{Z} \times_\mathcal{Y} \mathcal{X}$ is quasi-compact.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (1), and let $\mathcal{Z} \to \mathcal{Y}$
be a morphism of algebraic stacks with $\mathcal{Z}$ quasi-compact. By
Properties of Stacks,
Lemma \ref{stacks-properties-lemma-quasi-compact-stack}
there exists a quasi-compact scheme $U$ and a surjective smooth
morphism $U \to \mathcal{Z}$. Since $f$ is representable by algebraic
spaces and quasi-compact we see by definition that
$U \times_\mathcal{Y} \mathcal{X}$ is an algebraic space, and that
$U \times_\mathcal{Y} \mathcal{X} \to U$ is quasi-compact.
Hence $U \times_Y X$ is a quasi-compact algebraic space.
The morphism
$U \times_\mathcal{Y} \mathcal{X} \to
\mathcal{Z} \times_\mathcal{Y} \mathcal{X}$
is smooth and surjective (as the base change of the smooth
and surjective morphism $U \to \mathcal{Z}$).
Hence $\mathcal{Z} \times_\mathcal{Y} \mathcal{X}$
is quasi-compact by another application of
Properties of Stacks,
Lemma \ref{stacks-properties-lemma-quasi-compact-stack}

\medskip\noindent
Assume (2). Let $Z \to \mathcal{Y}$ be a morphism, where $Z$ is a scheme.
We have to show that the morphism of algebraic spaces
$p : Z \times_\mathcal{Y} \mathcal{X} \to Z$ is quasi-compact.
Let $U \subset Z$ be affine open. Then
$p^{-1}(U) = U \times_\mathcal{Y} \mathcal{Z}$
and the algebraic space $U \times_\mathcal{Y} \mathcal{Z}$
is quasi-compact by assumption (2). Hence $p$ is quasi-compact, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-quasi-compact-local}.
\end{proof}

\noindent
This motivates the following definition.

\begin{definition}
\label{definition-quasi-compact}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
We say $f$ is {\it quasi-compact} if for every quasi-compact
algebraic stack $\mathcal{Z}$ and morphism $\mathcal{Z} \to \mathcal{Y}$
the fibre product $\mathcal{Z} \times_\mathcal{Y} \mathcal{X}$
is quasi-compact.
\end{definition}

\noindent
By
Lemma \ref{lemma-characterize-representable-quasi-compact}
above this agrees with the already existing notion
for morphisms of algebraic stacks representable by algebraic spaces.
In particular this notion agrees with the notions already defined
for morphisms between algebraic stacks and schemes.

\begin{lemma}
\label{lemma-base-change-quasi-compact}
The base change of a quasi-compact morphism of algebraic stacks
by any morphism of algebraic stacks is quasi-compact.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-composition-quasi-compact}
The composition of a pair of quasi-compact morphisms of algebraic stacks
is quasi-compact.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-surjection-from-quasi-compact}
Let
$$
\xymatrix{
\mathcal{X} \ar[rr]_f \ar[rd]_p & &
\mathcal{Y} \ar[dl]^q \\
& \mathcal{Z}
}
$$
be a $2$-commutative diagram of morphisms of algebraic stacks.
If $f$ is surjective and $p$ is quasi-compact, then $q$ is quasi-compact.
\end{lemma}

\begin{proof}
Let $\mathcal{T}$ be a quasi-compact algebraic stack, and let
$\mathcal{T} \to \mathcal{Z}$ be a morphism. By
Properties of Stacks,
Lemma \ref{stacks-properties-lemma-base-change-surjective}
the morphism
$\mathcal{T} \times_{\mathcal{Z}} \mathcal{X} \to
\mathcal{T} \times_{\mathcal{Z}} \mathcal{Y}$
is surjective and by assumption
$\mathcal{T} \times_{\mathcal{Z}} \mathcal{X}$
is quasi-compact. Hence 
$\mathcal{T} \times_{\mathcal{Z}} \mathcal{Y}$
is quasi-compact by
Properties of Stacks, Lemma \ref{stacks-properties-lemma-quasi-compact-stack}.
\end{proof}

\begin{lemma}
\label{lemma-quasi-compact-permanence}
Let $f : \mathcal{X} \to \mathcal{Y}$ and
$g : \mathcal{Y} \to \mathcal{Z}$ be morphisms of algebraic stacks.
If $g \circ f$ is quasi-compact and $g$ is quasi-separated
then $f$ is quasi-compact.
\end{lemma}

\begin{proof}
This is true because $f$ equals the composition
$(1, f) : \mathcal{X} \to \mathcal{X} \times_\mathcal{Z} \mathcal{Y} \to
\mathcal{Y}$.
The first map is quasi-compact by
Lemma \ref{lemma-section-immersion}
because it is a section of the quasi-separated morphism
$\mathcal{X} \times_\mathcal{Z} \mathcal{Y} \to \mathcal{X}$
(a base change of $g$, see
Lemma \ref{lemma-base-change-separated}).
The second map is quasi-compact as it is the base change of $f$, see
Lemma \ref{lemma-base-change-quasi-compact}.
And compositions of quasi-compact
morphisms are quasi-compact, see Lemma \ref{lemma-composition-quasi-compact}.
\end{proof}









\section{Noetherian algebraic stacks}
\label{section-noetherian}

\noindent
We have already defined locally Noetherian algebraic stacks in
Properties of Stacks, Section \ref{stacks-properties-section-types-properties}.

\begin{definition}
\label{definition-noetherian}
Let $\mathcal{X}$ be an algebraic stack. We say $\mathcal{X}$ is
{\it Noetherian} if $\mathcal{X}$ is quasi-compact, quasi-separated
and locally Noetherian.
\end{definition}

\noindent
Note that a Noetherian algebraic stack $X$ is not just quasi-compact
and locally Noetherian, but also quasi-separated. In the language of
Section \ref{section-higher-diagonals}
if we denote $p : \mathcal{X} \to \text{Spec}(\mathbf{Z})$ the
``absolute'' structure morphism (i.e., the structure morphism of
$\mathcal{X}$ viewed as an algebraic stack over $\mathbf{Z}$), then
$$
\mathcal{X}\text{ Noetherian}
\Leftrightarrow
\mathcal{X}\text{ locally Noetherian and }
\Delta_{p, 0}, \Delta_{p, 1}, \Delta_{p, 2}
\text{ quasi-compact}.
$$
This will later mean that an algebraic stack of finite type over a
Noetherian algebraic stack is not automatically Noetherian.








\section{Universally closed morphisms}
\label{section-universally-closed}

\noindent
Let $f$ be a morphism of algebraic stacks which is representable by
algebraic spaces. In
Properties of Spaces,
Section \ref{stacks-properties-section-properties-morphisms}
we have defined what it means for $f$ to be universally closed.
Here is another characterization.

\begin{lemma}
\label{lemma-characterize-representable-universally-closed}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of
algebraic stacks which is representable by algebraic spaces.
The following are equivalent
\begin{enumerate}
\item $f$ is universally closed, and
\item for every morphism of algebraic stacks $\mathcal{Z} \to \mathcal{Y}$
the morphism of topological spaces
$|\mathcal{Z} \times_\mathcal{Y} \mathcal{X}| \to |\mathcal{Z}|$ is closed.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (1), and let $\mathcal{Z} \to \mathcal{Y}$ be as in (2).
Choose a scheme $V$ and a surjective smooth morphism $V \to \mathcal{Y}$.
By assumption the morphism $V \times_\mathcal{Y} \mathcal{X} \to V$
of algebraic spaces is universally closed, in particular the map
$|V \times_\mathcal{Y} \mathcal{X}| \to |V|$ is closed. By
Properties of Stacks, Section \ref{stacks-properties-section-points}
in the commutative diagram
$$
\xymatrix{
|V \times_\mathcal{Y} \mathcal{X}| \ar[r] \ar[d] &
|\mathcal{Z} \times_\mathcal{Y} \mathcal{X}| \ar[d] \\
|V| \ar[r] & |\mathcal{Z}|
}
$$
the horizontal arrows are open and surjective, and moreover
$$
|V \times_\mathcal{Y} \mathcal{X}| \longrightarrow
|V| \times_{|\mathcal{Z}|} |\mathcal{Z} \times_\mathcal{Y} \mathcal{X}|
$$
is surjective. Hence as the left vertical arrow is closed it follows that
the right vertical arrow is closed. This proves (2).
The implication (2) $\Rightarrow$ (1) follows from the definitions.
\end{proof}

\noindent
Thus we may use the following natural definition.

\begin{definition}
\label{definition-closed}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
\begin{enumerate}
\item We say $f$ is {\it closed} if the map of topological
spaces $|\mathcal{X}| \to |\mathcal{Y}|$ is closed.
\item We say $f$ is {\it universally closed} if for every morphism
of algebraic stacks $\mathcal{Z} \to \mathcal{Y}$
the morphism of topological spaces
$$
|\mathcal{Z} \times_\mathcal{Y} \mathcal{X}| \to |\mathcal{Z}|
$$
is closed, i.e., the base change
$\mathcal{Z} \times_\mathcal{Y} \mathcal{X} \to \mathcal{Z}$ is closed.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-base-change-universally-closed}
The base change of a universally closed morphism of algebraic stacks
by any morphism of algebraic stacks is universally closed.
\end{lemma}

\begin{proof}
This is immediate from the definition.
\end{proof}

\begin{lemma}
\label{lemma-composition-universally-closed}
The composition of a pair of (universally) closed morphisms of
algebraic stacks is (universally) closed.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}














\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
