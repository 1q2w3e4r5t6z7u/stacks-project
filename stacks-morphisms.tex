\input{preamble}

% OK, start here.
%
\begin{document}

\title{Morphisms of Algebraic Stacks}


\maketitle

\phantomsection
\label{section-phantom}

\tableofcontents

\section{Introduction}
\label{section-introduction}

\noindent
In this chapter we introduce some types of morphisms of algebraic stacks.
A reference in the case of quasi-separated algebraic stacks with representable
diagonal is \cite{LM-B}.

\medskip\noindent
The goal is to extend the definition of each of the types of morphisms of
algebraic spaces to morphisms of algebraic stacks. Each case is slightly
different and it seems best to treat them all separately.

\medskip\noindent
For morphisms of algebraic stacks which are representable
by algebraic spaces we have already defined a large number of types of
morphisms, see
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
For each corresponding case in this chapter
we have to make sure the definition in the general
case is compatible with the definition given there.




\section{Conventions and abuse of language}
\label{section-conventions}

\noindent
We continue to use the conventions and the abuse of language
introduced in
Properties of Stacks, Section \ref{stacks-properties-section-conventions}.




\section{Properties of diagonals}
\label{section-diagonals}

\noindent
The diagonal of an algebraic stack is closely related to the
$\mathit{Isom}$-sheaves, see
Algebraic Stacks, Lemma \ref{algebraic-lemma-representable-diagonal}.
By the second defining property of an algebraic stack these
$\mathit{Isom}$-sheaves are always algebraic spaces.

\begin{lemma}
\label{lemma-isom-locally-finite-type}
Let $\mathcal{X}$ be an algebraic stack.
Let $T$ be a scheme and let $x, y$ be objects of the fibre category of
$\mathcal{X}$ over $T$. Then the morphism
$\textit{Isom}_{\mathcal{X}}(x, y) \to T$ is locally of finite type.
\end{lemma}

\begin{proof}
By
Algebraic Stacks, Lemma \ref{algebraic-lemma-stack-presentation}
we may assume that $\mathcal{X} = [U/R]$ for some smooth
groupoid in algebraic spaces.
By
Descent of Spaces,
Lemma \ref{spaces-descent-lemma-descending-property-locally-finite-type}
it suffices to check the property fppf locally on $T$.
Thus we may assume that $x, y$ come from morphisms
$x', y' : T \to U$. By
Groupoids in Spaces,
Lemma \ref{spaces-groupoids-lemma-quotient-stack-morphisms}
we see that in this case
$\textit{Isom}_{\mathcal{X}}(x, y) = T \times_{(y', x'), U \times_S U} R$.
Hence it suffices to prove that $R \to U \times_S U$ is
locally of finite type. This follows from the fact that the composition
$s : R \to U \times_S U \to U$ is smooth (hence locally of finite type, see
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-smooth-locally-finite-presentation} and
\ref{spaces-morphisms-lemma-finite-presentation-finite-type})
and
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-permanence-finite-type}.
\end{proof}

\begin{lemma}
\label{lemma-isom-pseudo-torsor-aut}
Let $\mathcal{X}$ be an algebraic stack.
Let $T$ be a scheme and let $x, y$ be objects of the fibre category of
$\mathcal{X}$ over $T$. Then
\begin{enumerate}
\item $\textit{Isom}_{\mathcal{X}}(y, y)$ is a group algebraic space
over $T$, and
\item $\textit{Isom}_{\mathcal{X}}(x, y)$ is a pseudo torsor for
$\textit{Isom}_{\mathcal{X}}(y, y)$ over $T$.
\end{enumerate}
\end{lemma}

\begin{proof}
See
Groupoids in Spaces,
Definitions \ref{spaces-groupoids-definition-group-space} and
\ref{spaces-groupoids-definition-pseudo-torsor}.
The lemma follows immediately from the fact that $\mathcal{X}$ is a
stack in groupoids.
\end{proof}

\noindent
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
The {\it diagonal of $f$} is the morphism
$$
\Delta_f :
\mathcal{X}
\longrightarrow
\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}
$$
Here are two properties that every diagonal morphism has.

\begin{lemma}
\label{lemma-properties-diagonal}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
Then
\begin{enumerate}
\item $\Delta_f$ is representable by algebraic spaces,
and
\item $\Delta_f$ is locally of finite type.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $T$ be a scheme and let
$a : T \to \mathcal{X} \times_{\mathcal{Y}} \mathcal{X}$
be a morphism. By definition of the fibre product and the
$2$-Yoneda lemma the morphism $a$ is given by a triple
$a = (x, x', \alpha)$ where $x, x'$ are objects of $\mathcal{X}$
over $T$, and $\alpha : f(x) \to f(x')$ is a morphism in the fibre
category of $\mathcal{Y}$ over $T$. By definition of an algebraic
stack the sheaves $\mathit{Isom}_{\mathcal{X}}(x, x')$ and
$\mathit{Isom}_{\mathcal{Y}}(f(x), f(x'))$ are algebraic spaces
over $T$. In this language $\alpha$ defines a section of the morphism
$\mathit{Isom}_{\mathcal{X}}(x, x') \to T$. A $T'$-valued point of
$\mathcal{X} \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}, a} T$
for $T' \to T$ a scheme over $T$ is the same thing as an isomorphism
$x|_{T'} \to x'|_{T'}$ whose image under $f$ is $\alpha|_{T'}$.
Thus we see that
\begin{equation}
\label{equation-diagonal}
\vcenter{
\xymatrix{
\mathcal{X} \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}, a} T
\ar[d] \ar[r] &
\mathit{Isom}_{\mathcal{X}}(x, x') \ar[d] \\
T\ar[r]^-\alpha &
\mathit{Isom}_{\mathcal{Y}}(f(x), f(x'))
}
}
\end{equation}
is a fibre square of sheaves over $T$. In particular we see that
$\mathcal{X} \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}, a} T$
is an algebraic space which proves part (1) of the lemma.

\medskip\noindent
To prove the second statement we have to show that the left
vertical arrow of Diagram (\ref{equation-diagonal}) is locally
of finite type. By
Lemma \ref{lemma-isom-locally-finite-type}
the algebraic space $\mathit{Isom}_{\mathcal{X}}(x, x')$ and
is locally of finite type over $T$. Hence the right vertical arrow of
Diagram (\ref{equation-diagonal}) is locally of finite type, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-permanence-finite-type}.
We conclude by
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-base-change-finite-type}.
\end{proof}

\begin{lemma}
\label{lemma-properties-diagonal-representable}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
which is representable by algebraic spaces. Then
\begin{enumerate}
\item $\Delta_f$ is representable
(by schemes),
\item $\Delta_f$ is locally of finite type,
\item $\Delta_f$ is a monomorphism,
\item $\Delta_f$ is separated, and
\item $\Delta_f$ is locally quasi-finite.
\end{enumerate}
\end{lemma}

\begin{proof}
We have already seen in
Lemma \ref{lemma-properties-diagonal}
that $\Delta_f$ is representable by algebraic
spaces. Hence the statements (2) -- (5) make sense, see
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
Also
Lemma \ref{lemma-properties-diagonal}
garantees (2) holds.
Let $T \to \mathcal{X} \times_{\mathcal{Y}} \mathcal{X}$ be a morphism
and contemplate Diagram (\ref{equation-diagonal}). By
Algebraic Stacks, Lemma
\ref{algebraic-lemma-criterion-map-representable-spaces-fibred-in-groupoids}
the right vertical arrow is injective as a map of sheaves, i.e., a
monomorphism of algebraic spaces. Hence also the morphism
$T \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}} \mathcal{X} \to T$
is a monomorphism. Thus (3) holds. We already know that
$T \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}} \mathcal{X} \to T$
is locally of finite type. Thus
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-monomorphism-loc-finite-type-loc-quasi-finite}
allows us to conclude that
$T \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}} \mathcal{X} \to T$
is locally quasi-finite and separated. This proves (4) and (5).
Finally,
Morphisms of Spaces, Proposition
\ref{spaces-morphisms-proposition-locally-quasi-finite-separated-over-scheme}
implies that
$T \times_{\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}} \mathcal{X}$
is a scheme which proves (1).
\end{proof}

\begin{lemma}
\label{lemma-representable-separated-diagonal-closed}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
representable by algebraic spaces. Then the following are equivalent
\begin{enumerate}
\item $f$ is separated,
\item $\Delta_f$ is a closed immersion,
\item $\Delta_f$ is proper, or
\item $\Delta_f$ is universally closed.
\end{enumerate}
\end{lemma}

\begin{proof}
The statements
``$f$ is separated'',
``$\Delta_f$ is a closed immersion'',
``$\Delta_f$ is universally closed'', and
``$\Delta_f$ is proper''
refer to the notions defined in
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
Choose a scheme $V$ and a surjective smooth morphism $V \to \mathcal{Y}$.
Set $U = \mathcal{X} \times_{\mathcal{Y}} V$ which is an algebraic
space by assumption, and the morphism $U \to \mathcal{X}$ is surjective
and smooth. By
Categories, Lemma \ref{categories-lemma-base-change-diagonal}
and
Properties of Stacks,
Lemma \ref{stacks-properties-lemma-check-property-covering}
we see that for any property $P$ (as in that lemma) we have:
$\Delta_f$ has $P$ if and only if $\Delta_{U/V} : U \to  U \times_V U$ has $P$.
Hence the equivalence of (2), (3) and (4) follows from
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-separated-diagonal-proper}
applied to $U \to V$.
Moreover, if (1) holds, then $U \to V$ is separated and we see that
$\Delta_{U/V}$ is a closed immersion, i.e., (2) holds.
Finally, assume (2) holds. Let $T$ be a scheme, and $a : T \to \mathcal{Y}$
a morphism. Set $T' = \mathcal{X} \times_{\mathcal{Y}} T$. To prove
(1) we have to show that the morphism of algebraic spaces $T' \to T$
is separated. Using
Categories, Lemma \ref{categories-lemma-base-change-diagonal}
once more we see that $\Delta_{T'/T}$ is the base change of
$\Delta_f$. Hence our assumption (2) implies that $\Delta_{T'/T}$
is a closed immersion, hence $T' \to T$ is separated as desired.
\end{proof}

\begin{lemma}
\label{lemma-representable-quasi-separated-diagonal-quasi-compact}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
representable by algebraic spaces. Then the following are equivalent
\begin{enumerate}
\item $f$ is quasi-separated,
\item $\Delta_f$ is quasi-compact, or
\item $\Delta_f$ is finite type.
\end{enumerate}
\end{lemma}

\begin{proof}
The statements
``$f$ is quasi-separated'',
``$\Delta_f$ is quasi-compact'', and
``$\Delta_f$ is finite type''
refer to the notions defined in
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
Note that (2) and (3) are equivalent in view of the fact that
$\Delta_f$ is locally of finite type by
Lemma \ref{lemma-properties-diagonal-representable}
(and
Algebraic Stacks, Lemma
\ref{algebraic-lemma-representable-transformations-property-implication}).
Choose a scheme $V$ and a surjective smooth morphism $V \to \mathcal{Y}$.
Set $U = \mathcal{X} \times_{\mathcal{Y}} V$ which is an algebraic
space by assumption, and the morphism $U \to \mathcal{X}$ is surjective
and smooth. By
Categories, Lemma \ref{categories-lemma-base-change-diagonal}
and
Properties of Stacks,
Lemma \ref{stacks-properties-lemma-check-property-covering}
we see that we have: $\Delta_f$ is quasi-compact if and only if
$\Delta_{U/V} : U \to  U \times_V U$ is quasi-compact.
If (1) holds, then $U \to V$ is quasi-separated and we see that
$\Delta_{U/V}$ is quasi-compact, i.e., (2) holds.
Assume (2) holds. Let $T$ be a scheme, and $a : T \to \mathcal{Y}$
a morphism. Set $T' = \mathcal{X} \times_{\mathcal{Y}} T$. To prove
(1) we have to show that the morphism of algebraic spaces $T' \to T$
is quasi-separated. Using
Categories, Lemma \ref{categories-lemma-base-change-diagonal}
once more we see that $\Delta_{T'/T}$ is the base change of
$\Delta_f$. Hence our assumption (2) implies that $\Delta_{T'/T}$
is quasi-compact, hence $T' \to T$ is quasi-separated as desired.
\end{proof}

\begin{lemma}
\label{lemma-representable-locally-separated-diagonal-immersion}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
representable by algebraic spaces. Then the following are equivalent
\begin{enumerate}
\item $f$ is locally separated, and
\item $\Delta_f$ is an immersion.
\end{enumerate}
\end{lemma}

\begin{proof}
The statements ``$f$ is quasi-separated'', and ``$\Delta_f$ is an immersion''
refer to the notions defined in
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
Proof omitted. Hint: Argue as in the proofs of
Lemmas \ref{lemma-representable-separated-diagonal-closed} and
\ref{lemma-representable-quasi-separated-diagonal-quasi-compact}.
\end{proof}






\section{Separation axioms}
\label{section-separated}

\noindent
Let $\mathcal{X} = [U/R]$ be a presentation of an algebraic stack.
Then the properties of the diagonal of $\mathcal{X}$ over $S$, are
the properties of the morphism $j : R \to U \times_S U$. For example,
if $\mathcal{X} = [S/G]$ for some smooth group $G$ in algebraic spaces
over $S$ then $j$ is the structure morphism $G \to U$. Hence the diagonal
is not automatically separated itself (contrary to what happens in the
case of schemes and algebraic spaces). To say that $[S/G]$ is quasi-separated
over $S$ should certainly imply that $G \to S$ is quasi-compact, but we
hesitate to say that $[S/G]$ is quasi-separated over $S$ without also
requiring the morphism $G \to S$ to be quasi-separated. In other words,
requiring the diagonal morphism to be quasi-compact does not really agree
with our intuition for a ``quasi-separated algebraic stack'', and we should
also require the diagonal itself to be quasi-separated.

\medskip\noindent
What about ``separated algebraic stacks''? We have seen in
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-separated-diagonal-proper}
that an algebraic space is separated if and only if the diagonal is proper.
This is the condition that is usually used to define separated algebraic
stacks too. In the example $[S/G] \to S$ above this means that $G \to S$
is a proper group scheme. This means algebraic stacks of the form
$[\text{Spec}(k)/E]$ are proper over $k$ where $E$ is an elliptic curve
over $k$ (insert future reference here). In certain situations it may be
more natural to assume the diagonal is finite.

\begin{definition}
\label{definition-separated}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
\begin{enumerate}
\item We say $f$ is {\it DM} if $\Delta_f$ is unramified\footnote{The
letters DM stand for Deligne-Mumford. If $f$ is DM then given any scheme
$T$ and any morphism $T \to \mathcal{Y}$ the fibre product
$\mathcal{X}_T = \mathcal{X} \times_{\mathcal{Y}} T$
is an algebraic stack over $T$ whose diagonal is unramified.
This implies that $\mathcal{X}_T$ has an unramified
diagonal, which implies that $\mathcal{X}_T$
is a Deligne-Mumford stack by (insert future reference here).
In other words a DM morphism is one whose ``fibres'' are Deligne-Mumford
stacks. This hopefully at least motivates the terminology.}.
\item We say $f$ is {\it quasi-DM} if $\Delta_f$ is
locally quasi-finite\footnote{A word about this terminology
is in order. If $f$ is quasi-DM, then the ``fibres'' $\mathcal{X}_T$ of
$\mathcal{X} \to \mathcal{Y}$ are quasi-DM. It will turn out that an
algebraic stack $\mathcal{X}$ is quasi-DM exactly if there exists a
scheme $U$ and a surjective flat morphism $U \to \mathcal{X}$ of finite
presentation which is locally quasi-finite, see (insert future
reference here). Note the similarity to being Deligne-Mumford, which
is defined in terms of having an \'etale covering by a scheme.}.
\item We say $f$ is {\it separated} if $\Delta_f$ is proper.
\item We say $f$ is {\it quasi-separated} if $\Delta_f$
is quasi-compact and quasi-separated.
\end{enumerate}
\end{definition}

\noindent
In this definition we are using that $\Delta_f$ is representable by algebraic
spaces and we are using
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}
to make sense out of imposing conditions on $\Delta_f$.
We note that these definitions do not conflict with the already
existing notions if $f$ is representable by algebraic spaces, see
Lemmas \ref{lemma-representable-quasi-separated-diagonal-quasi-compact} and
\ref{lemma-representable-separated-diagonal-closed}.
There is an interesting way to characterize these conditions by looking
at higher diagonals, see
Lemma \ref{lemma-definition-separated}.

\begin{definition}
\label{definition-absolute-separated}
Let $\mathcal{X}$ be an algebraic stack over the base scheme $S$.
Denote $p : \mathcal{X} \to S$ the structure morphism.
\begin{enumerate}
\item We say $\mathcal{X}$ is {\it DM over $S$}
if $p : \mathcal{X} \to S$ is DM.
\item We say $\mathcal{X}$ is {\it quasi-DM over $S$}
if $p : \mathcal{X} \to S$ is quasi-DM.
\item We say $\mathcal{X}$ is {\it separated over $S$}
if $p : \mathcal{X} \to S$ is separated.
\item We say $\mathcal{X}$ is {\it quasi-separated over $S$} if
$p : \mathcal{X} \to S$ is quasi-separated.
\item We say $\mathcal{X}$ is {\it DM}
if $\mathcal{X}$ is DM\footnote{We will prove (insert future reference here)
that this is equivalent to $\mathcal{X}$ being a Deligne-Mumford stack.}
over $\text{Spec}(\mathbf{Z})$.
\item We say $\mathcal{X}$ is {\it quasi-DM}
if $\mathcal{X}$ is quasi-DM over $\text{Spec}(\mathbf{Z})$.
\item We say $\mathcal{X}$ is {\it separated} if $\mathcal{X}$
is separated over $\text{Spec}(\mathbf{Z})$.
\item We say $\mathcal{X}$ is {\it quasi-separated} if $\mathcal{X}$
is quasi-separated over $\text{Spec}(\mathbf{Z})$.
\end{enumerate}
In the last 4 definitions we view $\mathcal{X}$
as an algebraic stack over $\text{Spec}(\mathbf{Z})$
via
Algebraic Stacks, Definition \ref{algebraic-definition-viewed-as}.
\end{definition}

\noindent
Thus in each case we have an absolute notion and a notion relative to
our given base scheme (mention of which is usually surpressed by our
abuse of notation introduced in
Properties of Stacks, Section \ref{stacks-properties-section-conventions}).
We will see that (1) $\Leftrightarrow$ (5) and (2) $\Leftrightarrow$ (6) in
Lemma \ref{lemma-separated-implies-morphism-separated}.
We spend some time proving some standard results on these notions.

\begin{lemma}
\label{lemma-trivial-implications}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
If $f$ is separated, then $f$ is quasi-separated.
If $f$ is DM, then $f$ is quasi-DM.
\end{lemma}

\begin{proof}
A proper morphism of algebraic spaces is quasi-compact and quasi-separated, see
Morphisms of Spaces, Definition \ref{spaces-morphisms-definition-proper}.
An unramified morphism of algebraic spaces is locally quasi-finite, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-unramified-quasi-finite}.
\end{proof}

\begin{lemma}
\label{lemma-base-change-separated}
All of the separation axioms listed in
Definition \ref{definition-separated}
are stable under base change.
\end{lemma}

\begin{proof}
Let $f : \mathcal{X} \to \mathcal{Y}$ and
$\mathcal{Y}' \to \mathcal{Y}$ be morphisms of algebraic stacks.
Let $f' : \mathcal{Y}' \times_{\mathcal{Y}} \mathcal{X} \to \mathcal{Y}'$
be the base change of $f$ by $\mathcal{Y}' \to \mathcal{Y}$.
Then $\Delta_{f'}$ is the base change of $\Delta_f$ by the morphism
$\mathcal{X}' \times_{\mathcal{Y}'} \mathcal{X}' \to
\mathcal{X} \times_{\mathcal{Y}} \mathcal{X}$, see
Categories, Lemma \ref{categories-lemma-base-change-diagonal}.
By the results of
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}
each of the properties of the diagonal used in
Definition \ref{definition-separated}
is stable under base change. Hence the lemma is true.
\end{proof}

\begin{lemma}
\label{lemma-change-of-base-separated}
Let $S$ be a scheme. The property of being
quasi-DM over $S$, quasi-separated over $S$, or separated over $S$ (see
Definition \ref{definition-absolute-separated})
is stable under change of base scheme, see
Algebraic Stacks, Definition \ref{algebraic-definition-change-of-base}.
\end{lemma}

\begin{proof}
Follows immediately from
Lemma \ref{lemma-base-change-separated}.
\end{proof}

\begin{lemma}
\label{lemma-fibre-product-after-map}
Let $f : \mathcal{X} \to \mathcal{Z}$, $g : \mathcal{Y} \to \mathcal{Z}$
and $\mathcal{Z} \to \mathcal{T}$ be morphisms of algebraic stacks.
Consider the induced morphism
$i : \mathcal{X} \times_{\mathcal{Z}} \mathcal{Y} \to
\mathcal{X} \times_{\mathcal{T}} \mathcal{Y}$.
Then
\begin{enumerate}
\item $i$ is representable by algebraic spaces and locally of finite type,
\item if $\Delta_{\mathcal{Z}/\mathcal{T}}$ is quasi-separated, then
$i$ is quasi-separated,
\item if $\Delta_{\mathcal{Z}/\mathcal{T}}$ is separated, then
$i$ is separated,
\item if $\mathcal{Z} \to \mathcal{T}$ is DM,
then $i$ is unramified,
\item if $\mathcal{Z} \to \mathcal{T}$ is quasi-DM,
then $i$ is locally quasi-finite,
\item if $\mathcal{Z} \to \mathcal{T}$ is separated, then $i$ is proper, and
\item if $\mathcal{Z} \to \mathcal{T}$ is quasi-separated, then
$i$ is quasi-compact and quasi-separated.
\end{enumerate}
\end{lemma}

\begin{proof}
The following diagram
$$
\xymatrix{
\mathcal{X} \times_\mathcal{Z} \mathcal{Y} \ar[r]_i \ar[d] &
\mathcal{X} \times_\mathcal{T} \mathcal{Y} \ar[d] \\
\mathcal{Z} \ar[r]^-{\Delta_{\mathcal{Z}/\mathcal{T}}} \ar[r] &
\mathcal{Z} \times_\mathcal{T} \mathcal{Z}
}
$$
is a $2$-fibre product diagram, see
Categories, Lemma \ref{categories-lemma-fibre-product-after-map}.
Hence $i$ is the base change of the
diagonal morphism $\Delta_{\mathcal{Z}/\mathcal{T}}$. Thus the lemma follows
from
Lemma \ref{lemma-properties-diagonal},
and the material in
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
\end{proof}

\begin{lemma}
\label{lemma-semi-diagonal}
Let $\mathcal{T}$ be an algebraic stack. Let $g : \mathcal{X} \to \mathcal{Y}$
be a morphism of algebraic stacks over $\mathcal{T}$. Consider the graph
$i : \mathcal{X} \to \mathcal{X} \times_\mathcal{T} \mathcal{Y}$ of $g$. Then
\begin{enumerate}
\item $i$ is representable by algebraic spaces and locally of finite type,
\item if $\mathcal{Y} \to \mathcal{T}$ is DM, then $i$ is unramified,
\item if $\mathcal{Y} \to \mathcal{T}$ is quasi-DM, then $i$ is locally
quasi-finite,
\item if $\mathcal{Y} \to \mathcal{T}$ is separated, then $i$ is proper, and
\item if $\mathcal{Y} \to \mathcal{T}$ is quasi-separated, then $i$ is
quasi-compact and quasi-separated.
\end{enumerate}
\end{lemma}

\begin{proof}
This is a special case of Lemma \ref{lemma-fibre-product-after-map}
applied to the morphism
$\mathcal{X} = \mathcal{X} \times_\mathcal{Y} \mathcal{Y} \to
\mathcal{X}\times_\mathcal{T} \mathcal{Y}$.
\end{proof}

\begin{lemma}
\label{lemma-section-immersion}
Let $f : \mathcal{X} \to \mathcal{T}$ be a morphism of algebraic stacks.
Let $s : \mathcal{T} \to \mathcal{X}$ be a morphism such that
$f \circ s$ is $2$-isomorphic to $\text{id}_\mathcal{T}$. Then
\begin{enumerate}
\item $s$ is representable by algebraic spaces and locally of finite type,
\item if $f$ is DM, then $s$ is unramified,
\item if $f$ is quasi-DM, then $s$ is locally quasi-finite,
\item if $f$ is separated, then $s$ is proper, and
\item if $f$ is quasi-separated, then $s$ is quasi-compact and quasi-separated.
\end{enumerate}
\end{lemma}

\begin{proof}
This is a special case of Lemma \ref{lemma-semi-diagonal} applied to
$g = s$ and $\mathcal{Y} = \mathcal{T}$ in which case
$i : \mathcal{T} \to \mathcal{T} \times_\mathcal{T} \mathcal{X}$
is $2$-isomorphic to $s$.
\end{proof}

\begin{lemma}
\label{lemma-composition-separated}
All of the separation axioms listed in
Defintion \ref{definition-separated}
are stable under composition of morphisms.
\end{lemma}

\begin{proof}
Let $f : \mathcal{X} \to \mathcal{Y}$ and
$g : \mathcal{Y} \to \mathcal{Z}$ be morphisms of algebraic stacks
to which the axiom in question applies.
The diagonal $\Delta_{\mathcal{X}/\mathcal{Z}}$ is the composition
$$
\mathcal{X} \longrightarrow
\mathcal{X} \times_\mathcal{Y} \mathcal{X} \longrightarrow
\mathcal{X} \times_\mathcal{Z} \mathcal{X}.
$$
Our separation axiom is defined by requiring the diagonal
to have some property $\mathcal{P}$. By
Lemma \ref{lemma-fibre-product-after-map}
above we see that the second arrow also has this property.
Hence the lemma follows since the composition of
morphisms which are representable by algebraic spaces with property
$\mathcal{P}$ also is a morphism with property $\mathcal{P}$, see
our general discussion in
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}
and
Morphisms of Spaces, Lemmas
\ref{spaces-morphisms-lemma-composition-unramified},
\ref{spaces-morphisms-lemma-composition-quasi-finite},
\ref{spaces-morphisms-lemma-composition-proper},
\ref{spaces-morphisms-lemma-composition-quasi-compact}, and
\ref{spaces-morphisms-lemma-composition-separated}.
\end{proof}

\begin{lemma}
\label{lemma-separated-over-separated}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
over the base scheme $S$.
\begin{enumerate}
\item If $\mathcal{Y}$ is DM over $S$ and $f$ is DM,
then $\mathcal{X}$ is DM over $S$.
\item If $\mathcal{Y}$ is quasi-DM over $S$ and $f$ is quasi-DM,
then $\mathcal{X}$ is quasi-DM over $S$.
\item If $\mathcal{Y}$ is separated over $S$ and $f$ is separated,
then $\mathcal{X}$ is separated over $S$.
\item If $\mathcal{Y}$ is quasi-separated over $S$ and $f$ is quasi-separated,
then $\mathcal{X}$ is quasi-separated over $S$.
\item If $\mathcal{Y}$ is DM and $f$ is DM,
then $\mathcal{X}$ is DM.
\item If $\mathcal{Y}$ is quasi-DM and $f$ is quasi-DM,
then $\mathcal{X}$ is quasi-DM.
\item If $\mathcal{Y}$ is separated and $f$ is separated,
then $\mathcal{X}$ is separated.
\item If $\mathcal{Y}$ is quasi-separated and $f$ is quasi-separated,
then $\mathcal{X}$ is quasi-separated.
\end{enumerate}
\end{lemma}

\begin{proof}
Parts (1), (2), (3), and (4) follow immediately from 
Lemma \ref{lemma-composition-separated}
and
Definition \ref{definition-absolute-separated}.
For (5), (6), (7), and (8) think of $\mathcal{X}$ and $\mathcal{Y}$ as
algebraic stacks over $\text{Spec}(\mathbf{Z})$ and apply
Lemma \ref{lemma-composition-separated}.
Details omitted.
\end{proof}

\noindent
The following lemma is a bit different to the analogue for algebraic
spaces. To compare take a look at
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-compose-after-separated}.

\begin{lemma}
\label{lemma-compose-after-separated}
Let $f : \mathcal{X} \to \mathcal{Y}$ and
$g : \mathcal{Y} \to \mathcal{Z}$ be morphisms of algebraic stacks.
\begin{enumerate}
\item If $g \circ f$ is DM then so is $f$.
\item If $g \circ f$ is quasi-DM then so is $f$.
\item If $g \circ f$ is separated and $\Delta_g$ is separated, then
$f$ is separated.
\item If $g \circ f$ is quasi-separated and
$\Delta_g$ is quasi-separated, then $f$ is quasi-separated.
\end{enumerate}
\end{lemma}

\begin{proof}
Consider the factorization
$$
\mathcal{X} \to
\mathcal{X} \times_\mathcal{Y} \mathcal{X} \to
\mathcal{X} \times_\mathcal{Z} \mathcal{X}
$$
of the diagonal morphism of $g \circ f$. Both morphisms are representable by
algebraic spaces, see
Lemmas \ref{lemma-properties-diagonal} and
\ref{lemma-fibre-product-after-map}.
Hence for any scheme $T$ and morphism
$T \to \mathcal{X} \times_\mathcal{Y} \mathcal{X}$
we get morphisms of algebraic spaces
$$
A = \mathcal{X} \times_{(\mathcal{X} \times_{\mathcal{Z}} \mathcal{X})} T
\longrightarrow
B = (\mathcal{X} \times_\mathcal{Y} \mathcal{X})
\times_{(\mathcal{X} \times_{\mathcal{Z}} \mathcal{X})} T
\longrightarrow
T.
$$
If $g \circ f$ is DM (resp.\ quasi-DM), then the composition $A \to T$
is unramified (resp.\ locally quasi-finite). Hence (1) (resp.\ (2))
follows on applying
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-permanence-unramified}
(resp.
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-permanence-quasi-finite}).
This proves (1) and (2).

\medskip\noindent
Proof of (3). Assume $g \circ f$ is quasi-separated and $\Delta_g$ is
quasi-separated. Consider the factorization
$$
\mathcal{X} \to
\mathcal{X} \times_\mathcal{Y} \mathcal{X} \to
\mathcal{X} \times_\mathcal{Z} \mathcal{X}
$$
of the diagonal morphism of $g \circ f$. Both morphisms are
representable by algebraic spaces and the second one is quasi-separated, see
Lemmas \ref{lemma-properties-diagonal} and
\ref{lemma-fibre-product-after-map}.
Hence for any scheme $T$ and morphism
$T \to \mathcal{X} \times_\mathcal{Y} \mathcal{X}$
we get morphisms of algebraic spaces
$$
A = \mathcal{X} \times_{(\mathcal{X} \times_{\mathcal{Z}} \mathcal{X})} T
\longrightarrow
B = (\mathcal{X} \times_\mathcal{Y} \mathcal{X})
\times_{(\mathcal{X} \times_{\mathcal{Z}} \mathcal{X})} T
\longrightarrow
T
$$
such that $B \to T$ is quasi-separated.
The composition $A \to T$ is quasi-compact and quasi-separated
as we have assumed that $g \circ f$ is quasi-separated.
Hence $A \to B$ is quasi-separated by
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-compose-after-separated}.
And $A \to B$ is quasi-compact by
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-quasi-compact-permanence}.
Thus $f$ is quasi-separated.

\medskip\noindent
Proof of (4). Assume $g \circ f$ is separated and $\Delta_g$ is
separated. Consider the factorization
$$
\mathcal{X} \to
\mathcal{X} \times_\mathcal{Y} \mathcal{X} \to
\mathcal{X} \times_\mathcal{Z} \mathcal{X}
$$
of the diagonal morphism of $g \circ f$. Both morphisms are
representable by algebraic spaces and the second one is separated, see
Lemmas \ref{lemma-properties-diagonal} and
\ref{lemma-fibre-product-after-map}.
Hence for any scheme $T$ and morphism
$T \to \mathcal{X} \times_\mathcal{Y} \mathcal{X}$
we get morphisms of algebraic spaces
$$
A = \mathcal{X} \times_{(\mathcal{X} \times_{\mathcal{Z}} \mathcal{X})} T
\longrightarrow
B = (\mathcal{X} \times_\mathcal{Y} \mathcal{X})
\times_{(\mathcal{X} \times_{\mathcal{Z}} \mathcal{X})} T
\longrightarrow
T
$$
such that $B \to T$ is separated.
The composition $A \to T$ is proper as we have assumed that
$g \circ f$ is quasi-separated. Hence $A \to B$ is proper by
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-universally-closed-permanence}
which means that $f$ is separated.
\end{proof}

\begin{lemma}
\label{lemma-separated-implies-morphism-separated}
Let $\mathcal{X}$ be an algebraic stack over the base scheme $S$.
\begin{enumerate}
\item
$\mathcal{X}$ is DM $\Leftrightarrow$
$\mathcal{X}$ is DM over $S$.
\item
$\mathcal{X}$ is quasi-DM $\Leftrightarrow$
$\mathcal{X}$ is quasi-DM over $S$.
\item If $\mathcal{X}$ is separated, then
$\mathcal{X}$ is separated over $S$.
\item If $\mathcal{X}$ is quasi-separated, then
$\mathcal{X}$ is quasi-separated over $S$.
\end{enumerate}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
over the base scheme $S$.
\begin{enumerate}
\item[(5)] If $\mathcal{X}$ is DM over $S$, then $f$ is DM.
\item[(6)] If $\mathcal{X}$ is quasi-DM over $S$, then $f$ is quasi-DM.
\item[(7)] If $\mathcal{X}$ is separated over $S$ and
$\Delta_{\mathcal{Y}/S}$ is separated, then $f$ is separated.
\item[(8)] If $\mathcal{X}$ is quasi-separated over $S$ and
$\Delta_{\mathcal{Y}/S}$ is quasi-separated, then $f$ is quasi-separated.
\end{enumerate}
\end{lemma}

\begin{proof}
Parts (5), (6), (7), and (8) follow immediately from
Lemma \ref{lemma-compose-after-separated}
and
Spaces, Definition \ref{spaces-definition-separated}.
To prove (3) and (4) think of $X$ and $Y$ as algebraic stacks over
$\text{Spec}(\mathbf{Z})$ and apply
Lemma \ref{lemma-compose-after-separated}.
Similarly, to prove (1) and (2), think of $\mathcal{X}$ as an algebraic
stack over $\text{Spec}(\mathbf{Z})$ consider the
morphisms
$$
\mathcal{X} \longrightarrow
\mathcal{X} \times_S \mathcal{X} \longrightarrow
\mathcal{X} \times_{\text{Spec}(\mathbf{Z})} \mathcal{X}
$$
Both arrows are representable by algebraic spaces.
The second arrow is unramified and locally quasi-finite as the base change of
the immersion $\Delta_{S/\mathbf{Z}}$. Hence the composition is
unramified (resp.\ locally quasi-finite) if and only if the first arrow
is unramified (resp.\ locally quasi-finite), see
Morphisms of Spaces,
Lemmas \ref{spaces-morphisms-lemma-composition-unramified} and
\ref{spaces-morphisms-lemma-permanence-unramified}
(resp.\ Morphisms of Spaces,
Lemmas \ref{spaces-morphisms-lemma-composition-quasi-finite} and
\ref{spaces-morphisms-lemma-permanence-quasi-finite}).
\end{proof}

\begin{lemma}
\label{lemma-properties-covering-imply-diagonal}
Let $\mathcal{X}$ be an algebraic stack.
Let $W$ be an algebraic space, and let $f : W \to \mathcal{X}$
be a surjective, flat, locally finitely presented morphism.
\begin{enumerate}
\item If $f$ is unramified (i.e., \'etale, i.e., $\mathcal{X}$
is Deligne-Mumford), then $\mathcal{X}$ is DM.
\item If $f$ is locally quasi-finite, then $\mathcal{X}$ is quasi-DM.
\end{enumerate}
\end{lemma}

\begin{proof}
Note that if $f$ is unramified, then it is \'etale by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-unramified-flat-lfp-etale}.
This explains the parenthetical remark in (1).
Assume $f$ is unramified (resp.\ locally quasi-finite). We have to show that
$\Delta_\mathcal{X} : \mathcal{X} \to \mathcal{X} \times \mathcal{X}$
is unramified (resp.\ locally quasi-finite). Note that
$W \times W \to \mathcal{X} \times \mathcal{X}$ is also
surjective, flat, and locally of finite presentation. Hence it suffices to
show that
$$
W \times_{\mathcal{X} \times \mathcal{X}, \Delta_\mathcal{X}} \mathcal{X}
=
W \times_\mathcal{X} W
\longrightarrow
W \times W
$$
is unramified (resp.\ locally quasi-finite), see
Properties of Stacks, Lemma
\ref{stacks-properties-lemma-check-property-covering}.
By assumption the morphism $\text{pr}_i : W \times_\mathcal{X} W \to W$
is unramified (resp.\ locally quasi-finite). Hence
the displayed arrow is unramified (resp.\ locally quasi-finite) by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-permanence-unramified}
(resp.\ Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-permanence-quasi-finite}).
\end{proof}



















\section{Inertia stacks}
\label{section-inertia}

\begin{lemma}
\label{lemma-inertia}
Let $\mathcal{X}$ be an algebraic stack. Then the inertia stack
$\mathcal{I}_{\mathcal{X}}$ is an algebraic stack as well.
The morphism
$$
\mathcal{I}_{\mathcal{X}} \longrightarrow \mathcal{X}
$$
is representable by algebraic spaces and locally of finite type.
More generally, let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism
of algebraic stacks. Then the morphism
$$
\mathcal{I}_{\mathcal{X}/\mathcal{Y}} \longrightarrow \mathcal{X}
$$
is representable by algebraic spaces and locally of finite type.
\end{lemma}

\begin{proof}
The (relative) inertia stack of a stack in groupoids is defined in
Stacks, Section \ref{stacks-section-the-inertia-stack}.
By
Categories, Lemma \ref{categories-lemma-intertia-fibred-category}
there are equivalences
$$
\mathcal{I}_{\mathcal{X}} \to
\mathcal{X} \times_{\Delta, \mathcal{X} \times_S \mathcal{X}, \Delta}
\mathcal{X}
\quad\text{and}\quad
\mathcal{I}_{\mathcal{X}/\mathcal{Y}} \to
\mathcal{X}
\times_{\Delta, \mathcal{X} \times_{\mathcal{Y}} \mathcal{X}, \Delta}
\mathcal{X}
$$
which shows that the inertia stacks are algebraic stacks.
Let $T \to \mathcal{X}$ be a morphism given by
the object $x$ of the fibre category of $\mathcal{X}$ over $T$.
Then we get a $2$-fibre product square
$$
\xymatrix{
\mathit{Isom}_{\mathcal{X}}(x, x) \ar[d] \ar[r] &
\mathcal{I}_{\mathcal{X}} \ar[d] \\
T \ar[r]^x & \mathcal{X}
}
$$
This follows immediately from the definition of $\mathcal{I}_{\mathcal{X}}$.
Since $\mathit{Isom}_{\mathcal{X}}(x, x)$ is always an algebraic space
locally of finite type over $T$ (see
Lemma \ref{lemma-isom-locally-finite-type})
we conclude that $\mathcal{I}_{\mathcal{X}} \to \mathcal{X}$ is representable
by algebraic spaces and locally of finite type. Finally, for
the relative inertia we get
$$
\vcenter{
\xymatrix{
\mathit{Isom}_{\mathcal{X}}(x, x) \ar[d] &
K \ar[l] \ar[d] \ar[r] &
\mathcal{I}_{\mathcal{X}/\mathcal{Y}} \ar[d] \\
\mathit{Isom}_{\mathcal{Y}}(f(x), f(x)) &
T \ar[l]_-e \ar[r]^x & \mathcal{X}
}
}
$$
with both squares $2$-fibre products. This follows from
Categories, Lemma \ref{categories-lemma-relative-inertia-as-fibre-product}.
The left vertical arrow is a morphism of algebraic spaces locally of finite
type over $T$, and hence is locally of finite type, see
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-permanence-finite-type}.
Thus $K$ is an algebraic space and $K \to T$ is locally of finite type.
This proves the assertion on the relative inertia.
\end{proof}

\begin{remark}
\label{remark-inertia-is-group-in-spaces}
Let $\mathcal{X}$ be an algebraic stack. In
Properties of Stacks, Remark \ref{stacks-properties-remark-representable-over}
we have seen that the $2$-category of morphisms
$\mathcal{X}' \to \mathcal{X}$ representable by algebraic spaces
with target $\mathcal{X}$ forms a category.
In this category the inertia stack of $\mathcal{X}$ is
a {\it group object}. Recall that an object of $\mathcal{I}_{\mathcal{X}}$
is just a pair $(x, \alpha)$ where $x$ is an object of $\mathcal{X}$
and $\alpha$ is an automorphism of $x$ in the fibre category of $\mathcal{X}$
that $x$ lives in. The composition
$$
c :
\mathcal{I}_{\mathcal{X}} \times_{\mathcal{X}} \mathcal{I}_{\mathcal{X}}
\longrightarrow
\mathcal{I}_{\mathcal{X}}
$$
is given by the rule on objects
$$
((x, \alpha), (x', \alpha'), \beta) \mapsto
(x, \alpha \circ \beta^{-1} \circ \alpha' \circ \beta)
$$
which makes sense as $\beta : x \to x'$ is an isomorphism in the fibre
category by our definition of fibre products. The neutral element
$e : \mathcal{X} \to \mathcal{I}_{\mathcal{X}}$ is given by the
functor $x \mapsto (x, \text{id}_x)$. We omit the proof that the
axioms of a group object hold.
There is a variant of this remark for relative inertia stacks.
\end{remark}









\section{Higher diagonals}
\label{section-higher-diagonals}

\noindent
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
In this situation it makes sense to consider not only the diagonal
$$
\Delta_f : \mathcal{X} \to \mathcal{X} \times_{\mathcal{Y}} \mathcal{X}
$$
but also the diagonal of the diagonal, i.e., the morphism
$$
\Delta_{\Delta_f} :
\mathcal{X}
\longrightarrow
\mathcal{X} \times_{(\mathcal{X} \times_{\mathcal{Y}} \mathcal{X})} \mathcal{X}
$$
Because of this we sometimes use the following terminology. We denote
$\Delta_{f, 0} = f$ the {\it zeroth diagonal},
we denote $\Delta_{f, 1} = \Delta_f$ the {\it first diagonal}, and
we denote $\Delta_{f, 2} = \Delta_{\Delta_f}$ the {\it second diagonal}.
Note that $\Delta_{f, 1}$ is representable by algebraic spaces and locally of
finite type, see
Lemma \ref{lemma-properties-diagonal}.
Hence $\Delta_{f, 2}$ is representable, a monomorphism, locally of finite type,
separated, and locally quasi-finite, see
Lemma \ref{lemma-properties-diagonal-representable}.

\medskip\noindent
We can describe the second diagonal using the relative inertia stack.
Namely, the fibre product
$\mathcal{X}
\times_{(\mathcal{X} \times_{\mathcal{Y}} \mathcal{X})} \mathcal{X}$
is equivalent to the relative inertia stack
$\mathcal{I}_{\mathcal{X}/\mathcal{Y}}$ by
Categories, Lemma \ref{categories-lemma-intertia-fibred-category}.
Moreover, via this identification the second diagonal becomes the
{\it neutral section}
$$
e : \mathcal{X} \to \mathcal{I}_{\mathcal{X}/\mathcal{Y}}
$$
of the relative inertia stack. Moreover, recall from the proof of
Lemma \ref{lemma-inertia}
that given a morphism $x : T \to \mathcal{X}$ the fibre product
$T \times_{x, \mathcal{X}} \mathcal{I}_{\mathcal{X}/\mathcal{Y}}$
is given as the {\it kernel} $K$ of the homomorphism of group algebraic spaces
$$
\mathit{Isom}_{\mathcal{X}}(x, x)
\longrightarrow
\mathit{Isom}_{\mathcal{Y}}(f(x), f(x))
$$
over $T$. The morphism $e$ corresponds to the neutral section
$e : T \to K$ in this situation.

\begin{lemma}
\label{lemma-second-diagonal}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
Then $f$ is representable by algebraic spaces if and only if
the second diagonal is an isomorphism.
\end{lemma}

\begin{proof}
Namely, $f$ is representable by algebraic spaces if and only if $f$ is
faithful, see
Algebraic Stacks,
Lemma \ref{algebraic-lemma-characterize-representable-by-algebraic-spaces}.
On the other hand, $f$ is faithful if and only if for every object $x$
of $\mathcal{X}$ over a scheme $T$ the functor $f$ induces an injection
$\mathit{Isom}_{\mathcal{X}}(x, x) \to
\mathit{Isom}_{\mathcal{Y}}(f(x), f(x))$,
which happens if and only if the kernel $K$ is trivial, which happens if and
only if $e : T \to K$ is an isomorphism for every $x : T \to \mathcal{X}$.
Since $K = T \times_{x, \mathcal{X}} \mathcal{I}_{\mathcal{X}/\mathcal{Y}}$
as discussed above, this proves the lemma.
\end{proof}

\begin{lemma}
\label{lemma-first-diagonal-separated-second-diagonal-closed}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
Then
\begin{enumerate}
\item $\Delta_{f, 1}$ separated $\Leftrightarrow$
$\Delta_{f, 2}$ closed immersion $\Leftrightarrow$
$\Delta_{f, 2}$ proper $\Leftrightarrow$
$\Delta_{f, 2}$ universally closed,
\item $\Delta_{f, 1}$ quasi-separated $\Leftrightarrow$
$\Delta_{f, 2}$ finite type $\Leftrightarrow$ $\Delta_{f, 2}$ quasi-compact,
and
\item $\Delta_{f, 1}$ locally separated $\Leftrightarrow$
$\Delta_{f, 2}$ immersion.
\end{enumerate}
\end{lemma}

\begin{proof}
Follows from
Lemmas \ref{lemma-representable-separated-diagonal-closed},
\ref{lemma-representable-quasi-separated-diagonal-quasi-compact}, and
\ref{lemma-representable-locally-separated-diagonal-immersion}
applied to $\Delta_{f, 1}$.
\end{proof}

\noindent
The following lemma is kind of cute and it may suggest a generalization
of these conditions to higher algebraic stacks.

\begin{lemma}
\label{lemma-definition-separated}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
Then
\begin{enumerate}
\item $f$ is separated if and only if $\Delta_{f, 1}$ and $\Delta_{f, 2}$
are universally closed, and
\item $f$ is quasi-separated if and only if $\Delta_{f, 1}$ and $\Delta_{f, 2}$
are quasi-compact.
\item $f$ is quasi-DM if and only if $\Delta_{f, 1}$ and $\Delta_{f, 2}$
are locally quasi-finite.
\item $f$ is DM if and only if $\Delta_{f, 1}$ and $\Delta_{f, 2}$
are unramified.
\end{enumerate}
\end{lemma}

\begin{proof}
Proof of (1). Assume that $\Delta_{f, 2}$ and $\Delta_{f, 1}$ are
universally closed. Then $\Delta_{f, 1}$ is separated and universally
closed by
Lemma \ref{lemma-first-diagonal-separated-second-diagonal-closed}.
By
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-universally-closed-quasi-compact}
and
Algebraic Stacks,
Lemma \ref{algebraic-lemma-representable-transformations-property-implication}
we see that $\Delta_{f, 1}$ is quasi-compact.
Hence it is quasi-compact, separated, universally closed and locally of
finite type (by
Lemma \ref{lemma-properties-diagonal})
so proper. This proves ``$\Leftarrow$'' of (1).
The proof of the implication in the other direction is omitted.

\medskip\noindent
Proof of (2). This follows immediately from
Lemma \ref{lemma-first-diagonal-separated-second-diagonal-closed}.

\medskip\noindent
Proof of (3). This follows from the fact that $\Delta_{f, 2}$ is always locally
quasi-finite by
Lemma \ref{lemma-properties-diagonal-representable}
applied to $\Delta_f = \Delta_{f, 1}$.

\medskip\noindent
Proof of (4). This follows from the fact that $\Delta_{f, 2}$ is always
unramified as
Lemma \ref{lemma-properties-diagonal-representable}
applied to $\Delta_f = \Delta_{f, 1}$ shows that
$\Delta_{f, 2}$ is locally of finite type and a monomorphism.
See
More on Morphisms of Spaces,
Lemma \ref{spaces-more-morphisms-lemma-universally-injective-unramified}.
\end{proof}










\section{Quasi-compact morphisms}
\label{section-quasi-compact}

\noindent
Let $f$ be a morphism of algebraic stacks which is representable by
algebraic spaces. In
Properties of Spaces,
Section \ref{stacks-properties-section-properties-morphisms}
we have defined what it means for $f$ to be quasi-compact.
Here is another characterization.

\begin{lemma}
\label{lemma-characterize-representable-quasi-compact}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks
which is representable by algebraic spaces. The following are equivalent:
\begin{enumerate}
\item $f$ is quasi-compact, and
\item for every quasi-compact algebraic stack $\mathcal{Z}$
and any morphism $\mathcal{Z} \to \mathcal{Y}$ the algebraic stack
$\mathcal{Z} \times_\mathcal{Y} \mathcal{X}$ is quasi-compact.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (1), and let $\mathcal{Z} \to \mathcal{Y}$
be a morphism of algebraic stacks with $\mathcal{Z}$ quasi-compact. By
Properties of Stacks,
Lemma \ref{stacks-properties-lemma-quasi-compact-stack}
there exists a quasi-compact scheme $U$ and a surjective smooth
morphism $U \to \mathcal{Z}$. Since $f$ is representable by algebraic
spaces and quasi-compact we see by definition that
$U \times_\mathcal{Y} \mathcal{X}$ is an algebraic space, and that
$U \times_\mathcal{Y} \mathcal{X} \to U$ is quasi-compact.
Hence $U \times_Y X$ is a quasi-compact algebraic space.
The morphism
$U \times_\mathcal{Y} \mathcal{X} \to
\mathcal{Z} \times_\mathcal{Y} \mathcal{X}$
is smooth and surjective (as the base change of the smooth
and surjective morphism $U \to \mathcal{Z}$).
Hence $\mathcal{Z} \times_\mathcal{Y} \mathcal{X}$
is quasi-compact by another application of
Properties of Stacks,
Lemma \ref{stacks-properties-lemma-quasi-compact-stack}

\medskip\noindent
Assume (2). Let $Z \to \mathcal{Y}$ be a morphism, where $Z$ is a scheme.
We have to show that the morphism of algebraic spaces
$p : Z \times_\mathcal{Y} \mathcal{X} \to Z$ is quasi-compact.
Let $U \subset Z$ be affine open. Then
$p^{-1}(U) = U \times_\mathcal{Y} \mathcal{Z}$
and the algebraic space $U \times_\mathcal{Y} \mathcal{Z}$
is quasi-compact by assumption (2). Hence $p$ is quasi-compact, see
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-quasi-compact-local}.
\end{proof}

\noindent
This motivates the following definition.

\begin{definition}
\label{definition-quasi-compact}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
We say $f$ is {\it quasi-compact} if for every quasi-compact
algebraic stack $\mathcal{Z}$ and morphism $\mathcal{Z} \to \mathcal{Y}$
the fibre product $\mathcal{Z} \times_\mathcal{Y} \mathcal{X}$
is quasi-compact.
\end{definition}

\noindent
By
Lemma \ref{lemma-characterize-representable-quasi-compact}
above this agrees with the already existing notion
for morphisms of algebraic stacks representable by algebraic spaces.
In particular this notion agrees with the notions already defined
for morphisms between algebraic stacks and schemes.

\begin{lemma}
\label{lemma-base-change-quasi-compact}
The base change of a quasi-compact morphism of algebraic stacks
by any morphism of algebraic stacks is quasi-compact.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-composition-quasi-compact}
The composition of a pair of quasi-compact morphisms of algebraic stacks
is quasi-compact.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}

\begin{lemma}
\label{lemma-surjection-from-quasi-compact}
Let
$$
\xymatrix{
\mathcal{X} \ar[rr]_f \ar[rd]_p & &
\mathcal{Y} \ar[dl]^q \\
& \mathcal{Z}
}
$$
be a $2$-commutative diagram of morphisms of algebraic stacks.
If $f$ is surjective and $p$ is quasi-compact, then $q$ is quasi-compact.
\end{lemma}

\begin{proof}
Let $\mathcal{T}$ be a quasi-compact algebraic stack, and let
$\mathcal{T} \to \mathcal{Z}$ be a morphism. By
Properties of Stacks,
Lemma \ref{stacks-properties-lemma-base-change-surjective}
the morphism
$\mathcal{T} \times_{\mathcal{Z}} \mathcal{X} \to
\mathcal{T} \times_{\mathcal{Z}} \mathcal{Y}$
is surjective and by assumption
$\mathcal{T} \times_{\mathcal{Z}} \mathcal{X}$
is quasi-compact. Hence 
$\mathcal{T} \times_{\mathcal{Z}} \mathcal{Y}$
is quasi-compact by
Properties of Stacks, Lemma \ref{stacks-properties-lemma-quasi-compact-stack}.
\end{proof}

\begin{lemma}
\label{lemma-quasi-compact-permanence}
Let $f : \mathcal{X} \to \mathcal{Y}$ and
$g : \mathcal{Y} \to \mathcal{Z}$ be morphisms of algebraic stacks.
If $g \circ f$ is quasi-compact and $g$ is quasi-separated
then $f$ is quasi-compact.
\end{lemma}

\begin{proof}
This is true because $f$ equals the composition
$(1, f) : \mathcal{X} \to \mathcal{X} \times_\mathcal{Z} \mathcal{Y} \to
\mathcal{Y}$.
The first map is quasi-compact by
Lemma \ref{lemma-section-immersion}
because it is a section of the quasi-separated morphism
$\mathcal{X} \times_\mathcal{Z} \mathcal{Y} \to \mathcal{X}$
(a base change of $g$, see
Lemma \ref{lemma-base-change-separated}).
The second map is quasi-compact as it is the base change of $f$, see
Lemma \ref{lemma-base-change-quasi-compact}.
And compositions of quasi-compact
morphisms are quasi-compact, see Lemma \ref{lemma-composition-quasi-compact}.
\end{proof}









\section{Noetherian algebraic stacks}
\label{section-noetherian}

\noindent
We have already defined locally Noetherian algebraic stacks in
Properties of Stacks, Section \ref{stacks-properties-section-types-properties}.

\begin{definition}
\label{definition-noetherian}
Let $\mathcal{X}$ be an algebraic stack. We say $\mathcal{X}$ is
{\it Noetherian} if $\mathcal{X}$ is quasi-compact, quasi-separated
and locally Noetherian.
\end{definition}

\noindent
Note that a Noetherian algebraic stack $\mathcal{X}$ is not just quasi-compact
and locally Noetherian, but also quasi-separated. In the language of
Section \ref{section-higher-diagonals}
if we denote $p : \mathcal{X} \to \text{Spec}(\mathbf{Z})$ the
``absolute'' structure morphism (i.e., the structure morphism of
$\mathcal{X}$ viewed as an algebraic stack over $\mathbf{Z}$), then
$$
\mathcal{X}\text{ Noetherian}
\Leftrightarrow
\mathcal{X}\text{ locally Noetherian and }
\Delta_{p, 0}, \Delta_{p, 1}, \Delta_{p, 2}
\text{ quasi-compact}.
$$
This will later mean that an algebraic stack of finite type over a
Noetherian algebraic stack is not automatically Noetherian.








\section{Universally closed morphisms}
\label{section-universally-closed}

\noindent
Let $f$ be a morphism of algebraic stacks which is representable by
algebraic spaces. In
Properties of Spaces,
Section \ref{stacks-properties-section-properties-morphisms}
we have defined what it means for $f$ to be universally closed.
Here is another characterization.

\begin{lemma}
\label{lemma-characterize-representable-universally-closed}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of
algebraic stacks which is representable by algebraic spaces.
The following are equivalent
\begin{enumerate}
\item $f$ is universally closed, and
\item for every morphism of algebraic stacks $\mathcal{Z} \to \mathcal{Y}$
the morphism of topological spaces
$|\mathcal{Z} \times_\mathcal{Y} \mathcal{X}| \to |\mathcal{Z}|$ is closed.
\end{enumerate}
\end{lemma}

\begin{proof}
Assume (1), and let $\mathcal{Z} \to \mathcal{Y}$ be as in (2).
Choose a scheme $V$ and a surjective smooth morphism $V \to \mathcal{Y}$.
By assumption the morphism $V \times_\mathcal{Y} \mathcal{X} \to V$
of algebraic spaces is universally closed, in particular the map
$|V \times_\mathcal{Y} \mathcal{X}| \to |V|$ is closed. By
Properties of Stacks, Section \ref{stacks-properties-section-points}
in the commutative diagram
$$
\xymatrix{
|V \times_\mathcal{Y} \mathcal{X}| \ar[r] \ar[d] &
|\mathcal{Z} \times_\mathcal{Y} \mathcal{X}| \ar[d] \\
|V| \ar[r] & |\mathcal{Z}|
}
$$
the horizontal arrows are open and surjective, and moreover
$$
|V \times_\mathcal{Y} \mathcal{X}| \longrightarrow
|V| \times_{|\mathcal{Z}|} |\mathcal{Z} \times_\mathcal{Y} \mathcal{X}|
$$
is surjective. Hence as the left vertical arrow is closed it follows that
the right vertical arrow is closed. This proves (2).
The implication (2) $\Rightarrow$ (1) follows from the definitions.
\end{proof}

\noindent
Thus we may use the following natural definition.

\begin{definition}
\label{definition-closed}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
\begin{enumerate}
\item We say $f$ is {\it closed} if the map of topological
spaces $|\mathcal{X}| \to |\mathcal{Y}|$ is closed.
\item We say $f$ is {\it universally closed} if for every morphism
of algebraic stacks $\mathcal{Z} \to \mathcal{Y}$
the morphism of topological spaces
$$
|\mathcal{Z} \times_\mathcal{Y} \mathcal{X}| \to |\mathcal{Z}|
$$
is closed, i.e., the base change
$\mathcal{Z} \times_\mathcal{Y} \mathcal{X} \to \mathcal{Z}$ is closed.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-base-change-universally-closed}
The base change of a universally closed morphism of algebraic stacks
by any morphism of algebraic stacks is universally closed.
\end{lemma}

\begin{proof}
This is immediate from the definition.
\end{proof}

\begin{lemma}
\label{lemma-composition-universally-closed}
The composition of a pair of (universally) closed morphisms of
algebraic stacks is (universally) closed.
\end{lemma}

\begin{proof}
Omitted.
\end{proof}












\section{Types of morphisms smooth local on source-and-target}
\label{section-local-source-target}

\noindent
Given a property of morphisms of algebraic spaces which is
{\it smooth local on the source-and-target}, see
Descent of Spaces,
Definition \ref{spaces-descent-definition-local-source-target}
we may use it to define a corresponding
property of morphisms of algebraic stacks, namely by imposing either of
the equivalent conditions of the lemma below.

\begin{lemma}
\label{lemma-local-source-target}
Let $\mathcal{P}$ be a property of morphisms of algebraic spaces
which is smooth local on the source-and-target.
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
Consider commutative diagrams
$$
\xymatrix{
U \ar[d]_a \ar[r]_h & V \ar[d]^b \\
\mathcal{X} \ar[r]^f & \mathcal{Y}
}
$$
where $U$ and $V$ are algebraic spaces and the vertical arrows are smooth.
The following are equivalent
\begin{enumerate}
\item for any diagram as above such that in addition
$U \to \mathcal{X} \times_{\mathcal{Y}} V$ is smooth
the morphism $h$ has property $\mathcal{P}$, and
\item for some diagram as above with $a : U \to \mathcal{X}$ surjective
the morphism $h$ has property $\mathcal{P}$.
\end{enumerate}
If $\mathcal{X}$ and $\mathcal{Y}$ are representable by algebraic spaces,
then this is also equivalent to $f$ (as a morphism of algebraic spaces)
having property $\mathcal{P}$. If $\mathcal{P}$ is also preserved under
any base change, and fppf local on the base, then for morphisms $f$
which are representable by algebraic spaces this
is also equivalent to $f$ having property $\mathcal{P}$ in the sense
of
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}.
\end{lemma}

\begin{proof}
Let us prove the implication (1) $\Rightarrow$ (2). Pick an algebraic
space $V$ and a surjective and smooth morphism $V \to \mathcal{Y}$.
Pick an algebraic space $U$ and a surjective and smooth morphism
$U \to \mathcal{X} \times_{\mathcal{Y}} V$. Note that $U \to \mathcal{X}$
is surjective and smooth as well, as a composition of the base change
$\mathcal{X} \times_{\mathcal{Y}} V \to \mathcal{X}$ and the chosen
map $U \to \mathcal{X} \times_{\mathcal{Y}} V$. Hence we obtain a
diagram as in (1). Thus if (1) holds, then $h : U \to V$ has property
$\mathcal{P}$, which means that (2) holds as $U \to \mathcal{X}$ is surjective.

\medskip\noindent
Conversely, assume (2) holds and let $U, V, a, b, h$ be as in (2).
Next, let $U', V', a', b', h'$ be any diagram as in (1).
Picture
$$
\xymatrix{
U \ar[d] \ar[r]_h & V \ar[d] \\
\mathcal{X} \ar[r]^f & \mathcal{Y}
}
\quad\quad
\xymatrix{
U' \ar[d] \ar[r]_{h'} & V' \ar[d] \\
\mathcal{X} \ar[r]^f & \mathcal{Y}
}
$$
To show that (2) implies (1) we have to prove that $h'$ has $\mathcal{P}$.
To do this consider the commutative diagram
$$
\xymatrix{
U \ar[dd]^h &
U \times_{\mathcal{X}} U' \ar[d] \ar[l] \ar@/^6ex/[dd]^{(h, h')} \ar[r] &
U' \ar[dd]^{h'} \\
& U \times_\mathcal{Y} V' \ar[lu] \ar[d] & \\
V &
V \times_\mathcal{Y} V' \ar[l] \ar[r] &
V'
}
$$
of algebraic spaces. Note that the horizontal arrows are
smooth as base changes of the smooth morphisms
$V \to \mathcal{Y}$, $V' \to \mathcal{Y}$, $U \to \mathcal{X}$, and
$U' \to \mathcal{X}$. Note that
$$
\xymatrix{
U \times_\mathcal{X} U' \ar[d] \ar[r] & U' \ar[d] \\
U \times_\mathcal{Y} V' \ar[r] & \mathcal{X} \times_\mathcal{Y} V'
}
$$
is cartesian, hence the left vertical arrow is smooth as
$U', V', a', b', h'$ is as in (1).
Since $\mathcal{P}$ is local on the target we see
that the base change $U \times_\mathcal{Y} V' \to V \times_\mathcal{Y} V'$
has $\mathcal{P}$ and hence after precomposing by the smooth morphism
$U \times_\mathcal{X} U' \to U \times_\mathcal{Y} V'$ the morphism
we conclude $(h, h')$ has $\mathcal{P}$. Finally, since $U \times_X U' \to U'$
is surjective this implies that $h'$ has $\mathcal{P}$ as $\mathcal{P}$
is local on the source-and-target. This finishes the proof of the equivalence
of (1) and (2).

\medskip\noindent
If $\mathcal{X}$ and $\mathcal{Y}$ are representable, then
Descent on Spaces,
Lemma \ref{spaces-descent-lemma-local-source-target-characterize}
applies which shows that (1) and (2) are equivalent to $f$ having
$\mathcal{P}$.

\medskip\noindent
Finally, suppose $f$ is representable, and $U, V, a, b, h$ are
as in part (2) of the lemma, and that $\mathcal{P}$ is preserved under
arbitrary base change. We have to show that for any scheme
$Z$ and morphism $Z \to \mathcal{X}$ the base change
$Z \times_\mathcal{Y} \mathcal{X} \to Z$
has property $\mathcal{P}$. Consider the diagram
$$
\xymatrix{
Z \times_\mathcal{Y} U \ar[d] \ar[r] &
Z \times_\mathcal{Y} V \ar[d] \\
Z \times_\mathcal{Y} \mathcal{X} \ar[r] &
Z
}
$$
Note that the top horizontal arrow is a base change of $h$ and
hence has property $\mathcal{P}$. The left vertical arrow is smooth
and surjective and the right vertical arrow is smooth. Thus
Descent on Spaces,
Lemma \ref{spaces-descent-lemma-local-source-target-characterize}
kicks in and shows that $Z \times_\mathcal{Y} \mathcal{X} \to Z$
has property $\mathcal{P}$.
\end{proof}

\begin{definition}
\label{definition-P}
Let $\mathcal{P}$ be a property of morphisms of algebraic spaces
which is smooth local on the source-and-target.
We say a morphism $f : \mathcal{X} \to \mathcal{Y}$ of algebraic stacks
{\it has property $\mathcal{P}$} if the equivalent conditions of
Lemma \ref{lemma-local-source-target}
hold.
\end{definition}

\begin{remark}
\label{remark-composition}
Let $\mathcal{P}$ be a property of morphisms of algebraic spaces
which is smooth local on the source-and-target and stable under composition.
Then the property of morphisms of algebraic stacks defined in
Definition \ref{definition-P}
is stable under composition. Namely, let $f : \mathcal{X} \to \mathcal{Y}$
and $g : \mathcal{Y} \to \mathcal{Z}$ be morphisms of algebraic stacks
having propery $\mathcal{P}$. Choose an algebraic space $W$ and a
surjective smooth morphism $W \to \mathcal{Z}$. Choose an algebraic space
$V$ and a surjective smooth morphism $V \to \mathcal{Y} \times_\mathcal{Z} W$.
Finally, choose an algebraic space $U$ and a surjective and smooth morphism
$U \to \mathcal{X} \times_\mathcal{Y} V$. Then the morphisms
$V \to W$ and $U \to V$ have property $\mathcal{P}$ by definition.
Whence $U \to W$ has property $\mathcal{P}$ as we assumed that
$\mathcal{P}$ is stable under composition. Thus, by definition again,
we see that $g \circ f : \mathcal{X} \to \mathcal{Z}$ has
property $\mathcal{P}$.
\end{remark}

\begin{remark}
\label{remark-base-change}
Let $\mathcal{P}$ be a property of morphisms of algebraic spaces
which is smooth local on the source-and-target and stable under base change.
Then the property of morphisms of algebraic stacks defined in
Definition \ref{definition-P}
is stable under base change. Namely, let $f : \mathcal{X} \to \mathcal{Y}$
and $g : \mathcal{Y}' \to \mathcal{Y}$ be morphisms of algebraic stacks
and assume $f$ has propery $\mathcal{P}$. Choose an algebraic space $V$
and a surjective smooth morphism $V \to \mathcal{Y}$. Choose an algebraic
space $U$ and a surjective smooth morphism
$U \to \mathcal{X} \times_\mathcal{Y} V$. Finally, choose an algebraic space
$V'$ and a surjective and smooth morphism
$V' \to \mathcal{Y}' \times_\mathcal{Y} V$. Then the morphism
$U \to V$ has property $\mathcal{P}$ by definition.
Whence $V' \times_V U \to V'$ has property $\mathcal{P}$ as we assumed that
$\mathcal{P}$ is stable under base change. Considering the diagram
$$
\xymatrix{
V' \times_V U \ar[r] \ar[d] &
\mathcal{Y}' \times_\mathcal{Y} \mathcal{X} \ar[r] \ar[d] &
\mathcal{X} \ar[d] \\
V' \ar[r] & \mathcal{Y}' \ar[r] & \mathcal{Y}
}
$$
we see that the left top horizontal arrow is smooth and surjective,
whence by definition we see that the projection
$\mathcal{Y}' \times_\mathcal{Y} \mathcal{X} \to \mathcal{Y}'$ has
property $\mathcal{P}$.
\end{remark}











\section{Morphisms of finite type}
\label{section-finite-type}

\noindent
The property ``locally of finite type'' of morphisms of algebraic spaces
is smooth local on the source-and-target, see
Descent on Spaces, Remark \ref{spaces-descent-remark-list-local-source-target}.
It is also stable under base change and fpqc local on the target, see
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-base-change-finite-type}
and
Descent on Spaces,
Lemma \ref{spaces-descent-lemma-descending-property-locally-finite-type}.
Hence, by
Lemma \ref{lemma-local-source-target}
above, we may define what it means for a morphism of algebraic spaces
to be locally of finite type as follows and it agrees with the already
existing notion defined in
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}
when the morphism is representable by algebraic spaces.

\begin{definition}
\label{definition-locally-finite-type}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
\begin{enumerate}
\item We say $f$
{\it locally of finite type} if the equivalent conditions of
Lemma \ref{lemma-local-source-target}
hold with
$\mathcal{P} = \text{locally of finite type}$.
\item We say $f$ is
{\it of finite type} if it is locally of finite type and quasi-compact.
\end{enumerate}
\end{definition}

\begin{lemma}
\label{lemma-composition-finite-type}
The composition of finite type morphisms is of finite type.
The same holds for locally of finite type.
\end{lemma}

\begin{proof}
Combine
Remark \ref{remark-composition}
with
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-composition-finite-type}.
\end{proof}

\begin{lemma}
\label{lemma-base-change-finite-type}
A base change of a finite type morphism is finite type.
The same holds for locally of finite type.
\end{lemma}

\begin{proof}
Combine
Remark \ref{remark-base-change}
with
Morphisms of Spaces, Lemma \ref{spaces-morphisms-lemma-base-change-finite-type}.
\end{proof}

\begin{lemma}
\label{lemma-immersion-locally-finite-type}
An immersion is locally of finite type.
\end{lemma}

\begin{proof}
Follows from
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-immersion-locally-finite-type}.
\end{proof}










\section{Points of finite type}
\label{section-points-finite-type}

\noindent
Let $\mathcal{X}$ be an algebraic stack.
A finite type point $x \in |\mathcal{X}|$ is a point which can be represented
by a morphism $\text{Spec}(k) \to \mathcal{X}$ which is locally of finite type.
Finite type points are a suitable replacement of closed points for algebraic
spaces and algebraic stacks. There are always ``enough of them'' for example.

\begin{lemma}
\label{lemma-point-finite-type}
Let $\mathcal{X}$ be an algebraic stack.
Let $x \in |\mathcal{X}|$. The following are equivalent:
\begin{enumerate}
\item There exists a morphism $\text{Spec}(k) \to \mathcal{X}$
which is locally of finite type and represents $x$.
\item There exists a scheme $U$, a closed point $u \in U$, and a smooth
morphism $\varphi : U \to \mathcal{X}$ such that $\varphi(u) = x$.
\end{enumerate}
\end{lemma}

\begin{proof}
Let $u \in U$ and $U \to \mathcal{X}$ be as in (2). Then
$\text{Spec}(\kappa(u)) \to U$ is of finite type, and $U \to \mathcal{X}$ is
representable and locally of finite type (by
Morphisms of Spaces,
Lemmas \ref{spaces-morphisms-lemma-etale-locally-finite-presentation} and
\ref{spaces-morphisms-lemma-finite-presentation-finite-type}).
Hence we see (1) holds by
Lemma \ref{lemma-composition-finite-type}.

\medskip\noindent
Conversely, assume $\text{Spec}(k) \to \mathcal{X}$ is locally of finite type
and represents $x$. Let $U \to \mathcal{X}$ be a surjective smooth morphism
where $U$ is a scheme. By assumption
$U \times_\mathcal{X} \text{Spec}(k) \to U$ is a morphism of algebraic
spaces which is locally of finite type. Pick a finite type point $v$ of
$U \times_\mathcal{X} \text{Spec}(k)$ (there exists at least one, see
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-identify-finite-type-points}).
By
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-finite-type-points-morphism}
the image $u \in U$ of $v$ is a finite type point of $U$.
Hence by
Morphisms, Lemma \ref{morphisms-lemma-identify-finite-type-points}
after shrinking $U$ we may assume that $u$ is a closed point of $U$, i.e.,
(2) holds.
\end{proof}

\begin{definition}
\label{definition-finite-type-point}
Let $\mathcal{X}$ be an algebraic stack. We say a point $x \in |\mathcal{X}|$
is a {\it finite type point}\footnote{This is a
slight abuse of language as it would perhaps be more correct to say
``locally finite type point''.} if the equivalent conditions of
Lemma \ref{lemma-point-finite-type}
are satisfied. We denote $\mathcal{X}_{\text{ft-pts}}$
the set of finite type points of $\mathcal{X}$.
\end{definition}

\noindent
We can describe the set of finite type points as follows.

\begin{lemma}
\label{lemma-identify-finite-type-points}
Let $\mathcal{X}$ be an algebraic stack. We have
$$
\mathcal{X}_{\text{ft-pts}} =
\bigcup\nolimits_{\varphi : U \to X\text{ smooth}} |\varphi|(U_0)
$$
where $U_0$ is the set of closed points of $U$.
Here we may let $U$ range over all schemes smooth over $\mathcal{X}$
or over all affine schemes smooth over $\mathcal{X}$.
\end{lemma}

\begin{proof}
Immediate from
Lemma \ref{lemma-point-finite-type}.
\end{proof}

\begin{lemma}
\label{lemma-finite-type-points-morphism}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
If $f$ is locally of finite type, then
$f(\mathcal{X}_{\text{ft-pts}}) \subset \mathcal{Y}_{\text{ft-pts}}$.
\end{lemma}

\begin{proof}
Take $x \in \mathcal{X}_{\text{ft-pts}}$. Represent $x$ by a locally
finite type morphism $x : \text{Spec}(k) \to \mathcal{X}$. Then
$f \circ x$ is locally of finite type by
Lemma \ref{lemma-composition-finite-type}.
Hence $f(x) \in \mathcal{Y}_{\text{ft-pts}}$.
\end{proof}

\begin{lemma}
\label{lemma-finite-type-points-surjective-morphism}
Let $f : \mathcal{X} \to \mathcal{Y}$ be a morphism of algebraic stacks.
If $f$ is locally of finite type and surjective, then
$f(\mathcal{X}_{\text{ft-pts}}) = \mathcal{Y}_{\text{ft-pts}}$.
\end{lemma}

\begin{proof}
We have $f(\mathcal{X}_{\text{ft-pts}}) \subset \mathcal{Y}_{\text{ft-pts}}$ by
Lemma \ref{lemma-finite-type-points-morphism}.
Let $y \in |\mathcal{Y}|$ be a finite type point. Represent $y$ by a morphism
$\text{Spec}(k) \to \mathcal{Y}$ which is locally of finite type.
As $f$ is surjective the algebraic stack
$\mathcal{X}_k = \text{Spec}(k) \times_\mathcal{Y} \mathcal{X}$ is nonempty,
therefore has a finite type point $x \in |\mathcal{X}_k|$ by
Lemma \ref{lemma-identify-finite-type-points}.
Now $\mathcal{X}_k \to \mathcal{X}$ is a morphism which is locally of finite
type as a base change of $\text{Spec}(k) \to \mathcal{Y}$
(Lemma \ref{lemma-base-change-finite-type}).
Hence the image of $x$ in $\mathcal{X}$ is a finite type point by
Lemma \ref{lemma-finite-type-points-morphism}
which maps to $y$ by construction.
\end{proof}

\begin{lemma}
\label{lemma-enough-finite-type-points}
Let $\mathcal{X}$ be an algebraic stack.
For any locally closed subset $T \subset |\mathcal{X}|$ we have
$$
T \not = \emptyset
\Rightarrow
T \cap \mathcal{X}_{\text{ft-pts}} \not = \emptyset.
$$
In particular, for any closed subset $T \subset |\mathcal{X}|$ we
see that $T \cap \mathcal{X}_{\text{ft-pts}}$ is dense in $T$.
\end{lemma}

\begin{proof}
Let $i : \mathcal{Z} \to \mathcal{X}$ be the reduced induced substack
structure on $T$, see
Properties of Stacks,
Remark \ref{stacks-properties-remark-stack-structure-locally-closed-subset}.
An immersion is locally of finite type, see
Lemma \ref{lemma-immersion-locally-finite-type}.
Hence by
Lemma \ref{lemma-finite-type-points-morphism}
we see
$\mathcal{Z}_{\text{ft-pts}} \subset \mathcal{X}_{\text{ft-pts}} \cap T$.
Finally, any nonempty affine scheme $U$ with a smooth morphism towards
$\mathcal{Z}$ has at least one closed point, hence $\mathcal{Z}$ has at least
one finite type point by
Lemma \ref{lemma-identify-finite-type-points}.
The lemma follows.
\end{proof}

\noindent
Here is another, more technical, characterization of a finite type
point on an algebraic stack.

\begin{lemma}
\label{lemma-point-finite-type-monomorphism}
Let $\mathcal{X}$ be an algebraic stack.
Let $x \in |\mathcal{X}|$. The following are equivalent:
\begin{enumerate}
\item $x$ is a finite type point,
\item there exists an algebraic stack $\mathcal{Z}$
whose underlying topological space $|\mathcal{Z}|$ is a singleton,
and a morphism $f : \mathcal{Z} \to \mathcal{X}$ which is
locally of finite type such that $\{x\} = |f|(|\mathcal{Z}|)$, and
\item there exists an algebraic stack $\mathcal{Z}$ and a morphism
$f : \mathcal{Z} \to \mathcal{X}$ with the following properties:
\begin{enumerate}
\item there exists a surjective, flat, locally finitely presented
morphism $z : \text{Spec}(k) \to \mathcal{Z}$ where $k$ is a field,
\item the morphism $f$ is locally of finite type,
\item $f$ is a monomorphism, and
\item $x = f(z)$.
\end{enumerate}
\end{enumerate}
\end{lemma}

\begin{proof}
(All of the morphisms occuring in this paragraph are representable
by algebraic spaces, hence the conventions and results of
Properties of Stacks,
Section \ref{stacks-properties-section-properties-morphisms}
are applicable.)
Assume $x$ is a finite type point. Choose an affine scheme $U$,
a closed point $u \in U$, and a smooth morphism $\varphi : U \to \mathcal{X}$
with $\varphi(u) = x$, see
Lemma \ref{lemma-identify-finite-type-points}.
Set $u = \text{Spec}(\kappa(u))$ as usual. Set $R = u \times_\mathcal{X} u$
(this is an algebraic space). The projection morphisms $R \to u$ are the
compositions
$$
R = u \times_\mathcal{X} u \to
u \times_\mathcal{X} U \to
u \times_\mathcal{X} X = u
$$
where the first arrow is of finite type (a base change of the closed
immersion of schemes $u \to U$) and the second arrow is smooth (a base
change of the smooth morphism $U \to \mathcal{X}$). Hence
$s, t : R \to u$ are locally of finite type (as compositions, see
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-composition-finite-type}).
Since $u$ is the spectrum of a field, it follows that
$s, t$ are flat and locally of finite presentation (by
Morphisms of Spaces, Lemma
\ref{spaces-morphisms-lemma-noetherian-finite-type-finite-presentation}).
We see that $\mathcal{Z} = [u/R]$ is an algebraic stack by
Criteria for Representability,
Theorem \ref{criteria-theorem-flat-groupoid-gives-algebraic-stack}.
By
Algebraic Stacks, Lemma \ref{algebraic-lemma-map-space-into-stack}
we obtain a canonical morphism
$$
f : \mathcal{Z} \longrightarrow \mathcal{X}
$$
which is fully faithful. Hence this morphism is representable by
algebraic spaces, see
Algebraic Stacks, Lemma
\ref{algebraic-lemma-characterize-representable-by-algebraic-spaces}
and a monomorphism, see
Properties of Stacks, Lemma \ref{stacks-properties-lemma-monomorphism}.
By construction the diagram
$$
\xymatrix{
u \ar[d] \ar[r] & U \ar[d] \\
\mathcal{Z} \ar[r]^f & \mathcal{X}
}
$$
is commutative. By
Criteria for Representability,
Lemma \ref{criteria-lemma-flat-quotient-flat-presentation}
the left vertical arrow is surjective, flat, and locally of finite
presentation. Consider
$$
\xymatrix{
u \times_\mathcal{X} U \ar[d] \ar[r] &
\mathcal{Z} \times_\mathcal{X} U \ar[r] \ar[d] & U \ar[d] \\
u \ar[r] & \mathcal{Z} \ar[r]^f & \mathcal{X}
}
$$
As $u \to \mathcal{X}$ is locally of finite type, we see that the base change
$u \times_\mathcal{X} U \to U$ is locally of finite type. Moreover,
$u \times_\mathcal{X} U \to \mathcal{Z} \times_\mathcal{X} U$ is
surjective, flat, and locally of finite presentation as a base change of
$u \to \mathcal{Z}$. Thus
$\{u \times_\mathcal{X} U \to \mathcal{Z} \times_\mathcal{X} U\}$
is an fppf covering of algebraic spaces, and we conclude that
$\mathcal{Z} \times_\mathcal{X} U \to U$ is locally of finite type by
Descent on Spaces, Lemma
\ref{spaces-descent-lemma-locally-finite-presentation-fppf-local-source}.
By definition this means that $f$ is locally of finite type (because the
vertical arrow $\mathcal{Z} \times_\mathcal{X} U \to \mathcal{Z}$ is smooth
as a base change of $U \to \mathcal{X}$ and surjective as $\mathcal{Z}$ has
only one point). In this way we see that (3) holds.

\medskip\noindent
It is clear that (3) implies (2).
If (2) holds then $x$ is a finite type point of $\mathcal{X}$ by
Lemma \ref{lemma-finite-type-points-morphism}
and
Lemma \ref{lemma-enough-finite-type-points}
to see that $\mathcal{Z}_{\text{ft-pts}}$ is nonempty, i.e., the
unique point of $\mathcal{Z}$ is a finite type point of $\mathcal{Z}$.
\end{proof}










\section{Special presentations of algebraic stacks}
\label{section-presentations}

\noindent
The following lemma gives a criterion for when a ``slice''
of a presentation is still flat over the algebraic stack.

\begin{lemma}
\label{lemma-slice}
Let $\mathcal{X}$ be an algebraic stack.
Consider a cartesian diagram
$$
\xymatrix{
U \ar[d] & F \ar[l]^p \ar[d] \\
\mathcal{X} & \text{Spec}(k) \ar[l]
}
$$
where $U$ is an algebraic space, $k$ is a field, and $U \to \mathcal{X}$
is flat and locally of finite presentation. Let
$f_1, \ldots, f_r \in \Gamma(U, \mathcal{O}_U)$
and $z \in |F|$ such that $f_1, \ldots, f_r$ map to a regular sequence
in the local ring $\mathcal{O}_{F, \overline{z}}$.
Then, after replacing $U$ by an open subspace containing $p(z)$, the morphism
$$
V(f_1, \ldots, f_r) \longrightarrow \mathcal{X}
$$
is flat and locally of finite presentation.
\end{lemma}

\begin{proof}
Choose a scheme $W$ and a surjective smooth morphism $W \to \mathcal{X}$.
Choose an extension of fields $k \subset k'$ and a morphism
$w : \text{Spec}(k') \to W$ such that $\text{Spec}(k') \to W \to \mathcal{X}$
is $2$-isomorphic to $\text{Spec}(k') \to \text{Spec}(k) \to \mathcal{X}$.
This is possible as $W \to \mathcal{X}$ is surjective.
Consider the commutative diagram
$$
\xymatrix{
U \ar[d] &
U \times_\mathcal{X} W \ar[l]^-{\text{pr}_0} \ar[d] &
F' \ar[l]^-{p'} \ar[d] \\
\mathcal{X} &
W \ar[l] &
\text{Spec}(k') \ar[l] 
}
$$
both of whose squares are cartesian. By our choice of $w$ we see that
$F' = F \times_{\text{Spec}(k)} \text{Spec}(k')$. Thus $F' \to F$ is
surjective and we can choose a point $z' \in |F'|$ mapping to $z$.
Since $F' \to F$ is flat we see that
$\mathcal{O}_{F, \overline{z}} \to \mathcal{O}_{F', \overline{z}'}$ is
flat, see
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-flat-at-point-etale-local-rings}.
Hence $f_1, \ldots, f_r$ map to a regular sequence in
$\mathcal{O}_{F', \overline{z}'}$, see
Algebra, Lemma \ref{algebra-lemma-flat-increases-depth}.
Note that $U \times_\mathcal{X} W \to W$ is a morphism of algebraic spaces
which is flat and locally of finite presentation. Hence by
More on Morphisms of Spaces, Lemma \ref{spaces-more-morphisms-lemma-slice}
we see that there exists an open subspace $U'$ of $U \times_\mathcal{X} W$
containing $p(z')$ such that the intersection
$U' \cap (V(f_1, \ldots, f_r) \times_\mathcal{X} W)$ is flat and locally
of finite presentation over $W$. Note that
$\text{pr}_0(U')$ is an open subspace of $U$ containing $p(z)$
as $\text{pr}_0$ is smooth hence open. Now we see that
$U' \cap (V(f_1, \ldots, f_r) \times_\mathcal{X} W) \to \mathcal{X}$
is flat and locally of finite presentation as the composition
$$
U' \cap (V(f_1, \ldots, f_r) \times_\mathcal{X} W) \to W \to \mathcal{X}.
$$
Hence
Properties of Stacks,
Lemma \ref{stacks-properties-lemma-check-property-after-precomposing}
implies $\text{pr}_0(U') \cap V(f_1, \ldots, f_r) \to \mathcal{X}$
is flat and locally of finite presentation as desired.
\end{proof}

\begin{lemma}
\label{lemma-quasi-finite-at-point}
Let $\mathcal{X}$ be an algebraic stack. Consider a cartesian diagram
$$
\xymatrix{
U \ar[d] & F \ar[l]^p \ar[d] \\
\mathcal{X} & \text{Spec}(k) \ar[l]
}
$$
where $U$ is an algebraic space, $k$ is a field, and $U \to \mathcal{X}$
is locally of finite type. Let $z \in |F|$ be such that $\dim_z(F) = 0$.
Then, after replacing $U$ by an open subspace containing $p(z)$, the morphism
$$
U \longrightarrow \mathcal{X}
$$
is locally quasi-finite.
\end{lemma}

\begin{proof}
Since $f : U \to \mathcal{X}$ is locally of finite type there exists a
maximal open $W(f) \subset U$ such that the restriction
$f|_{W(f)} : W(f) \to \mathcal{X}$ is locally quasi-finite, see
Properties of Stacks, Remark
\ref{stacks-properties-remark-local-source-apply}
(\ref{stacks-properties-item-loc-quasi-finite}).
Hence all we need to do is prove that $p(z)$ is a point of $W(f)$.
Moreover, the remark referenced above also shows the formation of $W(f)$
commutes with arbitrary base change by a morphism which is representable
by algebraic spaces. Hence it suffices to show that the morphism
$F \to \text{Spec}(k)$ is locally quasi-finite at $z$. This follows
immediately from
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-locally-quasi-finite-rel-dimension-0}.
\end{proof}

\noindent
A quasi-DM stack has a locally quasi-finite ``covering'' by a scheme.

\begin{theorem}
\label{theorem-quasi-DM}
Let $\mathcal{X}$ be an algebraic stack. The following are equivalent
\begin{enumerate}
\item $\mathcal{X}$ is quasi-DM, and
\item there exists a scheme $W$ and a surjective, flat, locally finitely
presented, locally quasi-finite morphism $W \to \mathcal{X}$.
\end{enumerate}
\end{theorem}

\begin{proof}
The implication (2) $\Rightarrow$ (1) is
Lemma \ref{lemma-properties-covering-imply-diagonal}.
Assume (1).
Let $x \in |\mathcal{X}|$ be a finite type point. We will produce a scheme
over $\mathcal{X}$ which ``works'' in a neighbourhood of $x$. At the end
of the proof we will take the disjoint union of all of these to conclude.

\medskip\noindent
Let $U$ be an affine scheme, $U \to \mathcal{X}$ a smooth morphism, and
$u \in U$ a closed point which maps to $x$, see
Lemma \ref{lemma-point-finite-type}.
Denote $u = \text{Spec}(\kappa(u))$ as usual. Consider the following
commutative diagram
$$
\xymatrix{
u \ar[d] & R \ar[l] \ar[d] \\
U \ar[d] & F \ar[d] \ar[l]^p \\
\mathcal{X} & u \ar[l]
}
$$
with both squares fibre product squares, in particular
$R = u \times_\mathcal{X} u$. In the proof of
Lemma \ref{lemma-point-finite-type-monomorphism}
we have seen that $(u, R, s, t, c)$ is a groupoid in algebraic spaces
with $s, t$ locally of finite type. Let $G \to u$ be the stabilizer group
algebraic space (see
Groupoids in Spaces, Definition
\ref{spaces-groupoids-definition-stabilizer-groupoid}).
Note that
$$
G = R \times_{(u \times u)} u =
(u \times_\mathcal{X} u) \times_{(u \times u)} u =
\mathcal{X} \times_{\mathcal{X} \times \mathcal{X}} u.
$$
As $\mathcal{X}$ is quasi-DM we see that
$G$ is locally quasi-finite over $u$. By
More on Groupoids in Spaces, Lemma
\ref{spaces-more-groupoids-lemma-groupoid-on-field-dimension-equal-stabilizer}
we have $\dim(R) = 0$.

\medskip\noindent
Let $e : u \to R$ be the identity of the groupoid. Thus both compositions
$u \to R \to u$ are equal to the identity morphism of $u$.
Note that $R \subset F$ is a closed
subspace as $u \subset U$ is a closed subscheme. Hence we can also think
of $e$ as a point of $F$. Consider the maps of \'etale local rings
$$
\mathcal{O}_{U, u}
\xrightarrow{p^\sharp}
\mathcal{O}_{F, \overline{e}}
\longrightarrow
\mathcal{O}_{R, \overline{e}}
$$
Note that $\mathcal{O}_{R, \overline{e}}$ has dimension $0$ by the result
of the first paragraph. On the other hand, the kernel of the second arrow is 
$p^\sharp(\mathfrak m_u)\mathcal{O}_{F, \overline{e}}$ as
$R$ is cut out in $F$ by $\mathfrak m_u$. Thus we see that
$$
\mathfrak m_{\overline{z}} =
\sqrt{p^\sharp(\mathfrak m_u)\mathcal{O}_{F, \overline{e}}}
$$
On the other hand, as the morphism $U \to \mathcal{X}$ is smooth
we see that $F \to u$ is a smooth morphism of algebraic spaces.
This means that $F$ is a regular algebraic space
(Spaces over Fields, Lemma \ref{spaces-over-fields-lemma-smooth-regular}).
Hence $\mathcal{O}_{F, \overline{e}}$ is a regular local ring
(Properties of Spaces, Lemma \ref{spaces-properties-lemma-regular}).
Note that a regular local ring is Cohen-Macaulay
(Algebra, Lemma \ref{algebra-lemma-regular-ring-CM}).
Let $d = \dim(\mathcal{O}_{F, \overline{e}})$. By
Algebra, Lemma \ref{algebra-lemma-find-sequence-image-regular}
we can find $f_1, \ldots, f_d \in \mathcal{O}_{U, u}$ whose images
$\varphi(f_1), \ldots, \varphi(f_d)$ form a regular sequence
in $\mathcal{O}_{F, \overline{z}}$. By
Lemma \ref{lemma-slice}
after shrinking $U$ we may assume that
$Z = V(f_1, \ldots, f_d) \to \mathcal{X}$ is flat and
locally of finite presentation. Note that by construction
$F_Z = Z \times_\mathcal{X} u$ is a closed subspace of
$F = U \times_\mathcal{X} u$, that $e$ is a point of this closed subspace,
and that
$$
\dim(\mathcal{O}_{F_Z, \overline{e}}) = 0.
$$
By
Morphisms of Spaces,
Lemma \ref{spaces-morphisms-lemma-dimension-fibre-at-a-point}
it follows that $\dim_e(F_Z) = 0$ because the transcendece degree
of $e$ relative to $u$ is zero. Hence it follows from
Lemma \ref{lemma-quasi-finite-at-point}
that after possibly shrinking $U$ the morphism $Z \to \mathcal{X}$
is locally quasi-finite.

\medskip\noindent
We conclude that for every finite type point $x$ of $\mathcal{X}$ there
exists a locally quasi-finite, flat, locally finitely presented
morphism $f_x : Z_x \to \mathcal{X}$ with $x$ in the image of $|f_x|$.
Hence setting $W = \coprod_x Z_x$ and $f = \coprod f_x$ we win.
\end{proof}













\input{chapters}

\bibliography{my}
\bibliographystyle{amsalpha}

\end{document}
